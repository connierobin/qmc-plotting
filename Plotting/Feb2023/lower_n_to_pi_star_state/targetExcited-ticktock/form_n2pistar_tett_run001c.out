Rank =    0  Free Memory = 86384 MB
Rank =    1  Free Memory = 86384 MB
Rank =    2  Free Memory = 86384 MB
Rank =    3  Free Memory = 86384 MB
Rank =    4  Free Memory = 86383 MB
Rank =    5  Free Memory = 86383 MB
Rank =    6  Free Memory = 86383 MB
Rank =    7  Free Memory = 86382 MB
Rank =    8  Free Memory = 86382 MB
Rank =    9  Free Memory = 86382 MB
Rank =   10  Free Memory = 86382 MB
Rank =   11  Free Memory = 86382 MB
Rank =   12  Free Memory = 86381 MB
Rank =   13  Free Memory = 86381 MB
Rank =   14  Free Memory = 86381 MB
Rank =   15  Free Memory = 86369 MB
Rank =   16  Free Memory = 86369 MB
Rank =   17  Free Memory = 86369 MB
Rank =   18  Free Memory = 86369 MB
Rank =   19  Free Memory = 86369 MB
Rank =   20  Free Memory = 86369 MB
Rank =   21  Free Memory = 86369 MB
Rank =   22  Free Memory = 86369 MB
Rank =   23  Free Memory = 86369 MB
Rank =   24  Free Memory = 86369 MB
Rank =   25  Free Memory = 86369 MB
Rank =   26  Free Memory = 86369 MB
Rank =   27  Free Memory = 86369 MB
Rank =   28  Free Memory = 86369 MB
Rank =   29  Free Memory = 86369 MB
Rank =   30  Free Memory = 86369 MB
Rank =   31  Free Memory = 86369 MB
Rank =   32  Free Memory = 87191 MB
Rank =   33  Free Memory = 87191 MB
Rank =   34  Free Memory = 87191 MB
Rank =   35  Free Memory = 87191 MB
Rank =   36  Free Memory = 87191 MB
Rank =   37  Free Memory = 87190 MB
Rank =   38  Free Memory = 87190 MB
Rank =   39  Free Memory = 87190 MB
Rank =   40  Free Memory = 87190 MB
Rank =   41  Free Memory = 87190 MB
Rank =   42  Free Memory = 87190 MB
Rank =   43  Free Memory = 87190 MB
Rank =   44  Free Memory = 87190 MB
Rank =   45  Free Memory = 87190 MB
Rank =   46  Free Memory = 87190 MB
Rank =   47  Free Memory = 87190 MB
Rank =   48  Free Memory = 87190 MB
Rank =   49  Free Memory = 87190 MB
Rank =   50  Free Memory = 87190 MB
Rank =   51  Free Memory = 87190 MB
Rank =   52  Free Memory = 87190 MB
Rank =   53  Free Memory = 87190 MB
Rank =   54  Free Memory = 87190 MB
Rank =   55  Free Memory = 87190 MB
Rank =   56  Free Memory = 87190 MB
Rank =   57  Free Memory = 87190 MB
Rank =   58  Free Memory = 87189 MB
Rank =   59  Free Memory = 87189 MB
Rank =   60  Free Memory = 87189 MB
Rank =   61  Free Memory = 87189 MB
Rank =   62  Free Memory = 87189 MB
Rank =   63  Free Memory = 87189 MB
Rank =   64  Free Memory = 86909 MB
Rank =   65  Free Memory = 86909 MB
Rank =   66  Free Memory = 86909 MB
Rank =   67  Free Memory = 86909 MB
Rank =   68  Free Memory = 86909 MB
Rank =   69  Free Memory = 86909 MB
Rank =   70  Free Memory = 86909 MB
Rank =   71  Free Memory = 86909 MB
Rank =   72  Free Memory = 86909 MB
Rank =   73  Free Memory = 86909 MB
Rank =   74  Free Memory = 86909 MB
Rank =   75  Free Memory = 86909 MB
Rank =   76  Free Memory = 86909 MB
Rank =   77  Free Memory = 86909 MB
Rank =   78  Free Memory = 86909 MB
Rank =   79  Free Memory = 86909 MB
Rank =   80  Free Memory = 86909 MB
Rank =   81  Free Memory = 86909 MB
Rank =   82  Free Memory = 86909 MB
Rank =   83  Free Memory = 86909 MB
Rank =   84  Free Memory = 86909 MB
Rank =   85  Free Memory = 86909 MB
Rank =   86  Free Memory = 86909 MB
Rank =   87  Free Memory = 86909 MB
Rank =   88  Free Memory = 86909 MB
Rank =   89  Free Memory = 86909 MB
Rank =   90  Free Memory = 86909 MB
Rank =   91  Free Memory = 86909 MB
Rank =   92  Free Memory = 86909 MB
Rank =   93  Free Memory = 86909 MB
Rank =   94  Free Memory = 86909 MB
Rank =   95  Free Memory = 86909 MB
Rank =   96  Free Memory = 78758 MB
Rank =   97  Free Memory = 78758 MB
Rank =   98  Free Memory = 78758 MB
Rank =   99  Free Memory = 78758 MB
Rank =  100  Free Memory = 78758 MB
Rank =  101  Free Memory = 78758 MB
Rank =  102  Free Memory = 78758 MB
Rank =  103  Free Memory = 78758 MB
Rank =  104  Free Memory = 78758 MB
Rank =  105  Free Memory = 78758 MB
Rank =  106  Free Memory = 78758 MB
Rank =  107  Free Memory = 78758 MB
Rank =  108  Free Memory = 78758 MB
Rank =  109  Free Memory = 78758 MB
Rank =  110  Free Memory = 78758 MB
Rank =  111  Free Memory = 78758 MB
Rank =  112  Free Memory = 78758 MB
Rank =  113  Free Memory = 78758 MB
Rank =  114  Free Memory = 78758 MB
Rank =  115  Free Memory = 78758 MB
Rank =  116  Free Memory = 78758 MB
Rank =  117  Free Memory = 78758 MB
Rank =  118  Free Memory = 78758 MB
Rank =  119  Free Memory = 78758 MB
Rank =  120  Free Memory = 78758 MB
Rank =  121  Free Memory = 78758 MB
Rank =  122  Free Memory = 78758 MB
Rank =  123  Free Memory = 78758 MB
Rank =  124  Free Memory = 78758 MB
Rank =  125  Free Memory = 78758 MB
Rank =  126  Free Memory = 78758 MB
Rank =  127  Free Memory = 78758 MB
  Input file(s): opt_form_n2pistar_tett_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_tett_run001c.xml

  Project = FORM
  date    = 2023-02-21 13:19:24 PST
  host    = n0110.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 348

  Range of prime numbers to use as seeds over processors and threads = 2357-3391


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.376605e-01    1         1 OFF
     uu_1                 1.767718e-01    1         1 OFF
     uu_2                 7.723728e-02    1         1 OFF
     uu_3                 1.710003e-02    1         1 OFF
     uu_4                -1.910459e-02    1         1 OFF
     uu_5                -4.280304e-02    1         1 OFF
     uu_6                -5.785204e-02    1         1 OFF
     uu_7                -6.393266e-02    1         1 OFF
     uu_8                -5.909683e-02    1         1 OFF
     uu_9                -4.158283e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.949806e-01    1         1 OFF
     ud_1                 1.544390e-01    1         1 OFF
     ud_2                 3.547833e-02    1         1 OFF
     ud_3                -2.628345e-02    1         1 OFF
     ud_4                -6.009293e-02    1         1 OFF
     ud_5                -7.932808e-02    1         1 OFF
     ud_6                -8.808073e-02    1         1 OFF
     ud_7                -8.737225e-02    1         1 OFF
     ud_8                -7.743479e-02    1         1 OFF
     ud_9                -5.391828e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.823946e-01    1         1 OFF
     eC_1                -3.665890e-01    1         1 OFF
     eC_2                -1.701695e-01    1         1 OFF
     eC_3                -7.185681e-02    1         1 OFF
     eC_4                -5.170424e-02    1         1 OFF
     eC_5                 3.187715e-02    1         1 OFF
     eC_6                 1.415405e-01    1         1 OFF
     eC_7                 3.067080e-01    1         1 OFF
     eC_8                 4.123941e-01    1         1 OFF
     eC_9                 2.340638e-01    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.052897e+00    1         1 OFF
     eO_1                -7.482421e-01    1         1 OFF
     eO_2                -3.414708e-01    1         1 OFF
     eO_3                -4.201517e-02    1         1 OFF
     eO_4                 1.479196e-01    1         1 OFF
     eO_5                 3.007146e-01    1         1 OFF
     eO_6                 3.501199e-01    1         1 OFF
     eO_7                 3.647544e-01    1         1 OFF
     eO_8                 3.143343e-01    1         1 OFF
     eO_9                 3.237420e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.436100e-01    1         1 OFF
     eH1_1                -1.410507e-01    1         1 OFF
     eH1_2                -9.420369e-02    1         1 OFF
     eH1_3                -6.742883e-02    1         1 OFF
     eH1_4                 7.012902e-03    1         1 OFF
     eH1_5                 6.648304e-02    1         1 OFF
     eH1_6                 1.029657e-01    1         1 OFF
     eH1_7                 7.841590e-02    1         1 OFF
     eH1_8                 4.345977e-02    1         1 OFF
     eH1_9                 1.390192e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.403491e-01    1         1 OFF
     eH2_1                -1.394467e-01    1         1 OFF
     eH2_2                -9.471563e-02    1         1 OFF
     eH2_3                -6.879321e-02    1         1 OFF
     eH2_4                 5.917576e-03    1         1 OFF
     eH2_5                 6.770114e-02    1         1 OFF
     eH2_6                 1.052555e-01    1         1 OFF
     eH2_7                 7.452344e-02    1         1 OFF
     eH2_8                 3.347000e-02    1         1 OFF
     eH2_9                -2.106280e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.000194e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.4860e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.5988
    reference variance = 0.317017
====================================================
  Execution time = 2.6611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5534e-01
  Total weights = 1.955164206e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443895008928
                                         uncertainty =       0.002490397858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443895008928
                                         uncertainty =       0.002490397858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471108355
  error estimate for blocks of size 2^( 2) =       0.000494882396
  error estimate for blocks of size 2^( 3) =       0.000516996227
  error estimate for blocks of size 2^( 4) =       0.000532623518
  error estimate for blocks of size 2^( 5) =       0.000541796539
  error estimate for blocks of size 2^( 6) =       0.000545517695
  error estimate for blocks of size 2^( 7) =       0.000546920196

      target function =      -0.740950485035
              le_mean =     -22.662022823664
             les_mean =     514.022616136027
             stat err =       0.000541714487
             autocorr =       1.322206500494
   target nu stat err =       0.000541714487
   target dn stat err =       0.004724995765
      target stat err =       0.003876326788
              std dev =       0.666247824497
             le_variance =       0.443886163647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266202282366e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740969738586       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741264043355       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741331355061       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741344858403       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741348504644       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741350165122       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741351590348       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741351735662       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741351759589       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741351849809       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741351893547       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741351990127       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741351992055       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.746443e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740969738586       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741054274244       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741072648092       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741075903871       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741076799215       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741077172757       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741077483714       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741077504970       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741077509801       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741077534793       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741077544381       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741077561328       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741077560975       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.556315e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740969738586       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740991689519       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740996386780       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740997187779       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740997409616       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740997499737       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740997574270       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740997578652       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740997579832       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740997586248       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740997588485       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740997592271       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740997592151       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.151721e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008896 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1403e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001 -7.014772e-01                3 1 ON  0
ci_002 -7.056353e-01                3 1 ON  1
ci_003 -5.478754e-02                3 1 ON  2
ci_004 -5.572755e-02                3 1 ON  3
ci_005 2.316696e-02                 3 1 ON  4
ci_006 2.338856e-02                 3 1 ON  5
ci_007 1.855996e-02                 3 1 ON  6
ci_008 1.881181e-02                 3 1 ON  7
ci_009 -1.497629e-02                3 1 ON  8
ci_010 -1.499419e-02                3 1 ON  9
ci_011 -1.244668e-02                3 1 ON  10
ci_012 -1.198103e-02                3 1 ON  11
ci_013 1.093772e-02                 3 1 ON  12
ci_014 1.099986e-02                 3 1 ON  13
ci_015 1.145180e-02                 3 1 ON  14
ci_016 1.150238e-02                 3 1 ON  15
ci_017 9.586343e-03                 3 1 ON  16
ci_018 9.901287e-03                 3 1 ON  17
ci_019 3.201430e-03                 3 1 ON  18
ci_020 3.284909e-03                 3 1 ON  19
ci_021 -8.325040e-03                3 1 ON  20
ci_022 -8.961198e-03                3 1 ON  21
ci_023 6.168863e-03                 3 1 ON  22
ci_024 6.009163e-03                 3 1 ON  23
ci_025 1.074529e-02                 3 1 ON  24
ci_026 1.061725e-02                 3 1 ON  25
ci_027 6.553323e-03                 3 1 ON  26
ci_028 6.759327e-03                 3 1 ON  27
ci_029 -5.000853e-03                3 1 ON  28
ci_030 -5.123358e-03                3 1 ON  29
ci_031 7.172138e-04                 3 1 ON  30
ci_032 4.328511e-04                 3 1 ON  31
ci_033 3.804599e-03                 3 1 ON  32
ci_034 4.147132e-03                 3 1 ON  33
ci_035 3.046752e-03                 3 1 ON  34
ci_036 2.797275e-03                 3 1 ON  35
ci_037 3.938889e-03                 3 1 ON  36
ci_038 4.295295e-03                 3 1 ON  37
ci_039 4.807650e-03                 3 1 ON  38
ci_040 4.747952e-03                 3 1 ON  39
ci_041 2.878765e-03                 3 1 ON  40
ci_042 3.256595e-03                 3 1 ON  41
ci_043 3.924562e-03                 3 1 ON  42
ci_044 3.736820e-03                 3 1 ON  43
ci_045 3.129648e-03                 3 1 ON  44
ci_046 3.361504e-03                 3 1 ON  45
ci_047 -1.355389e-03                3 1 ON  46
ci_048 -1.729666e-03                3 1 ON  47
ci_049 1.548782e-03                 3 1 ON  48
ci_050 1.476621e-03                 3 1 ON  49
ci_051 -1.419984e-03                3 1 ON  50
ci_052 -1.888054e-03                3 1 ON  51
ci_053 -2.581057e-03                3 1 ON  52
ci_054 -2.578598e-03                3 1 ON  53
ci_055 -1.926625e-03                3 1 ON  54
ci_056 -1.501951e-03                3 1 ON  55
ci_057 -1.385364e-03                3 1 ON  56
ci_058 -1.289396e-03                3 1 ON  57
ci_059 -5.860158e-04                3 1 ON  58
ci_060 -5.550764e-04                3 1 ON  59
ci_061 -9.110390e-04                3 1 ON  60
ci_062 -7.651195e-04                3 1 ON  61
ci_063 -7.311847e-04                3 1 ON  62
ci_064 -1.175931e-03                3 1 ON  63
ci_065 -2.086073e-03                3 1 ON  64
ci_066 -2.093749e-03                3 1 ON  65
ci_067 -1.206676e-03                3 1 ON  66
ci_068 -1.353686e-03                3 1 ON  67
ci_069 3.935048e-04                 3 1 ON  68
ci_070 3.852937e-04                 3 1 ON  69
ci_071 -2.097985e-03                3 1 ON  70
ci_072 -1.618682e-03                3 1 ON  71
ci_073 2.227064e-04                 3 1 ON  72
ci_074 3.103003e-04                 3 1 ON  73
ci_075 -1.518706e-04                3 1 ON  74
ci_076 -1.796161e-04                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6743
    reference variance = 0.454506
====================================================
  Execution time = 2.5812e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5590e-01
  Total weights = 1.9552e+06
  Execution time = 3.6252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445622954897
                                         uncertainty =       0.003099475698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445622954897
                                         uncertainty =       0.003099475698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472011744
  error estimate for blocks of size 2^( 2) =       0.000495736464
  error estimate for blocks of size 2^( 3) =       0.000518082430
  error estimate for blocks of size 2^( 4) =       0.000534368011
  error estimate for blocks of size 2^( 5) =       0.000543127916
  error estimate for blocks of size 2^( 6) =       0.000547956789
  error estimate for blocks of size 2^( 7) =       0.000549802042

      target function =      -0.727635376658
              le_mean =     -22.661088197899
             les_mean =     513.996764438619
             stat err =       0.000543813689
             autocorr =       1.327378146673
   target nu stat err =       0.000543813689
   target dn stat err =       0.015511132661
      target stat err =       0.012127946796
              std dev =       0.667525409856
             le_variance =       0.445590172804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445009911211
                                         uncertainty =       0.003105956142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445009911211
                                         uncertainty =       0.003105956142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471686571
  error estimate for blocks of size 2^( 2) =       0.000495450982
  error estimate for blocks of size 2^( 3) =       0.000517825930
  error estimate for blocks of size 2^( 4) =       0.000534101716
  error estimate for blocks of size 2^( 5) =       0.000542901462
  error estimate for blocks of size 2^( 6) =       0.000547713081
  error estimate for blocks of size 2^( 7) =       0.000549512542

      target function =      -0.739986353767
              le_mean =     -22.661097856598
             les_mean =     513.981890800332
             stat err =       0.000543557200
             autocorr =       1.327955376007
   target nu stat err =       0.000543557200
   target dn stat err =       0.003643630952
      target stat err =       0.003001496673
              std dev =       0.667065546169
             le_variance =       0.444976442886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445238037033
                                         uncertainty =       0.003102807190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445238037033
                                         uncertainty =       0.003102807190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471807634
  error estimate for blocks of size 2^( 2) =       0.000495555350
  error estimate for blocks of size 2^( 3) =       0.000517917923
  error estimate for blocks of size 2^( 4) =       0.000534198452
  error estimate for blocks of size 2^( 5) =       0.000542980327
  error estimate for blocks of size 2^( 6) =       0.000547799293
  error estimate for blocks of size 2^( 7) =       0.000549621948

      target function =      -0.740440165129
              le_mean =     -22.661088118251
             les_mean =     513.980888068453
             stat err =       0.000543650005
             autocorr =       1.327727238712
   target nu stat err =       0.000543650005
   target dn stat err =       0.003600458121
      target stat err =       0.002970873800
              std dev =       0.667236755409
             le_variance =       0.445204887769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445566437543
                                         uncertainty =       0.003099976687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445566437543
                                         uncertainty =       0.003099976687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471981788
  error estimate for blocks of size 2^( 2) =       0.000495709616
  error estimate for blocks of size 2^( 3) =       0.000518057260
  error estimate for blocks of size 2^( 4) =       0.000534342021
  error estimate for blocks of size 2^( 5) =       0.000543103465
  error estimate for blocks of size 2^( 6) =       0.000547929123
  error estimate for blocks of size 2^( 7) =       0.000549776006

      target function =      -0.739006190475
              le_mean =     -22.661088309423
             les_mean =     513.982671673140
             stat err =       0.000543787654
             autocorr =       1.327419529978
   target nu stat err =       0.000543787654
   target dn stat err =       0.003869547057
      target stat err =       0.003172269506
              std dev =       0.667483046404
             le_variance =       0.445533617237


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.727635376658        initial
     2.5000e-01     2.5000e+00             1.7464e-03        -0.739986353767
     1.0000e+00     1.0000e+01             4.5563e-04        -0.740440165129  <--
     4.0000e+00     4.0000e+01             1.1517e-04        -0.739006190475

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3890e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001                -7.014772e-01 3 1  ON 0
ci_002                -7.056353e-01 3 1  ON 1
ci_003                -5.478754e-02 3 1  ON 2
ci_004                -5.572755e-02 3 1  ON 3
ci_005                 2.316696e-02 3 1  ON 4
ci_006                 2.338856e-02 3 1  ON 5
ci_007                 1.855996e-02 3 1  ON 6
ci_008                 1.881181e-02 3 1  ON 7
ci_009                -1.497629e-02 3 1  ON 8
ci_010                -1.499419e-02 3 1  ON 9
ci_011                -1.244668e-02 3 1  ON 10
ci_012                -1.198103e-02 3 1  ON 11
ci_013                 1.093772e-02 3 1  ON 12
ci_014                 1.099986e-02 3 1  ON 13
ci_015                 1.145180e-02 3 1  ON 14
ci_016                 1.150238e-02 3 1  ON 15
ci_017                 9.586343e-03 3 1  ON 16
ci_018                 9.901287e-03 3 1  ON 17
ci_019                 3.201430e-03 3 1  ON 18
ci_020                 3.284909e-03 3 1  ON 19
ci_021                -8.325040e-03 3 1  ON 20
ci_022                -8.961198e-03 3 1  ON 21
ci_023                 6.168863e-03 3 1  ON 22
ci_024                 6.009163e-03 3 1  ON 23
ci_025                 1.074529e-02 3 1  ON 24
ci_026                 1.061725e-02 3 1  ON 25
ci_027                 6.553323e-03 3 1  ON 26
ci_028                 6.759327e-03 3 1  ON 27
ci_029                -5.000853e-03 3 1  ON 28
ci_030                -5.123358e-03 3 1  ON 29
ci_031                 7.172138e-04 3 1  ON 30
ci_032                 4.328511e-04 3 1  ON 31
ci_033                 3.804599e-03 3 1  ON 32
ci_034                 4.147132e-03 3 1  ON 33
ci_035                 3.046752e-03 3 1  ON 34
ci_036                 2.797275e-03 3 1  ON 35
ci_037                 3.938889e-03 3 1  ON 36
ci_038                 4.295295e-03 3 1  ON 37
ci_039                 4.807650e-03 3 1  ON 38
ci_040                 4.747952e-03 3 1  ON 39
ci_041                 2.878765e-03 3 1  ON 40
ci_042                 3.256595e-03 3 1  ON 41
ci_043                 3.924562e-03 3 1  ON 42
ci_044                 3.736820e-03 3 1  ON 43
ci_045                 3.129648e-03 3 1  ON 44
ci_046                 3.361504e-03 3 1  ON 45
ci_047                -1.355389e-03 3 1  ON 46
ci_048                -1.729666e-03 3 1  ON 47
ci_049                 1.548782e-03 3 1  ON 48
ci_050                 1.476621e-03 3 1  ON 49
ci_051                -1.419984e-03 3 1  ON 50
ci_052                -1.888054e-03 3 1  ON 51
ci_053                -2.581057e-03 3 1  ON 52
ci_054                -2.578598e-03 3 1  ON 53
ci_055                -1.926625e-03 3 1  ON 54
ci_056                -1.501951e-03 3 1  ON 55
ci_057                -1.385364e-03 3 1  ON 56
ci_058                -1.289396e-03 3 1  ON 57
ci_059                -5.860158e-04 3 1  ON 58
ci_060                -5.550764e-04 3 1  ON 59
ci_061                -9.110390e-04 3 1  ON 60
ci_062                -7.651195e-04 3 1  ON 61
ci_063                -7.311847e-04 3 1  ON 62
ci_064                -1.175931e-03 3 1  ON 63
ci_065                -2.086073e-03 3 1  ON 64
ci_066                -2.093749e-03 3 1  ON 65
ci_067                -1.206676e-03 3 1  ON 66
ci_068                -1.353686e-03 3 1  ON 67
ci_069                 3.935048e-04 3 1  ON 68
ci_070                 3.852937e-04 3 1  ON 69
ci_071                -2.097985e-03 3 1  ON 70
ci_072                -1.618682e-03 3 1  ON 71
ci_073                 2.227064e-04 3 1  ON 72
ci_074                 3.103003e-04 3 1  ON 73
ci_075                -1.518706e-04 3 1  ON 74
ci_076                -1.796161e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5299e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2637e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6582
    reference variance = 0.532786
====================================================
  Execution time = 2.6204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4954e-01
  Total weights = 1.955033642e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439803257425
                                         uncertainty =       0.002203737339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439803257425
                                         uncertainty =       0.002203737339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468976516
  error estimate for blocks of size 2^( 2) =       0.000492725115
  error estimate for blocks of size 2^( 3) =       0.000514431256
  error estimate for blocks of size 2^( 4) =       0.000530972026
  error estimate for blocks of size 2^( 5) =       0.000541493861
  error estimate for blocks of size 2^( 6) =       0.000545432905
  error estimate for blocks of size 2^( 7) =       0.000544970851

      target function =      -0.745685459204
              le_mean =     -22.661471510366
             les_mean =     513.991833449676
             stat err =       0.000540717411
             autocorr =       1.329347475659
   target nu stat err =       0.000540717411
   target dn stat err =       0.002777151540
      target stat err =       0.002354910053
              std dev =       0.663232949846
             le_variance =       0.439877945762


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266147151037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745691991914       residual = 6.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745901916143       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745950612903       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745954765007       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745955444976       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745955662537       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745955711789       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745955664576       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745955696246       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745955700503       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.037835e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745691991914       residual = 6.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745751910067       residual = 9.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745765100462       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745766161032       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745766327499       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745766380909       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745766391007       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745766379384       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745766386147       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.979960e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745691991914       residual = 6.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745707521421       residual = 9.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745710887165       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745711153116       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745711194349       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745711207596       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745711209964       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745711207093       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745711208705       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 7.736778e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012405 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0961e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -7.015034e-01 3 1  ON 0
ci_002                -7.056558e-01 3 1  ON 1
ci_003                -5.472800e-02 3 1  ON 2
ci_004                -5.579449e-02 3 1  ON 3
ci_005                 2.286897e-02 3 1  ON 4
ci_006                 2.317213e-02 3 1  ON 5
ci_007                 1.842437e-02 3 1  ON 6
ci_008                 1.857167e-02 3 1  ON 7
ci_009                -1.485444e-02 3 1  ON 8
ci_010                -1.485704e-02 3 1  ON 9
ci_011                -1.225148e-02 3 1  ON 10
ci_012                -1.181542e-02 3 1  ON 11
ci_013                 1.083329e-02 3 1  ON 12
ci_014                 1.076937e-02 3 1  ON 13
ci_015                 1.144689e-02 3 1  ON 14
ci_016                 1.136528e-02 3 1  ON 15
ci_017                 9.506025e-03 3 1  ON 16
ci_018                 9.738899e-03 3 1  ON 17
ci_019                 3.037990e-03 3 1  ON 18
ci_020                 3.000893e-03 3 1  ON 19
ci_021                -8.455942e-03 3 1  ON 20
ci_022                -9.209992e-03 3 1  ON 21
ci_023                 6.185296e-03 3 1  ON 22
ci_024                 5.994426e-03 3 1  ON 23
ci_025                 1.085104e-02 3 1  ON 24
ci_026                 1.067003e-02 3 1  ON 25
ci_027                 6.497051e-03 3 1  ON 26
ci_028                 6.784220e-03 3 1  ON 27
ci_029                -5.015329e-03 3 1  ON 28
ci_030                -5.085141e-03 3 1  ON 29
ci_031                 9.833635e-04 3 1  ON 30
ci_032                 6.587178e-04 3 1  ON 31
ci_033                 3.814069e-03 3 1  ON 32
ci_034                 4.147817e-03 3 1  ON 33
ci_035                 2.995591e-03 3 1  ON 34
ci_036                 2.768764e-03 3 1  ON 35
ci_037                 3.898746e-03 3 1  ON 36
ci_038                 4.262579e-03 3 1  ON 37
ci_039                 4.748511e-03 3 1  ON 38
ci_040                 4.734221e-03 3 1  ON 39
ci_041                 2.898685e-03 3 1  ON 40
ci_042                 3.239327e-03 3 1  ON 41
ci_043                 3.894325e-03 3 1  ON 42
ci_044                 3.698483e-03 3 1  ON 43
ci_045                 3.113173e-03 3 1  ON 44
ci_046                 3.313874e-03 3 1  ON 45
ci_047                -1.317801e-03 3 1  ON 46
ci_048                -1.682648e-03 3 1  ON 47
ci_049                 1.421170e-03 3 1  ON 48
ci_050                 1.487048e-03 3 1  ON 49
ci_051                -1.392526e-03 3 1  ON 50
ci_052                -1.799479e-03 3 1  ON 51
ci_053                -2.550283e-03 3 1  ON 52
ci_054                -2.589753e-03 3 1  ON 53
ci_055                -1.917156e-03 3 1  ON 54
ci_056                -1.463670e-03 3 1  ON 55
ci_057                -1.382609e-03 3 1  ON 56
ci_058                -1.252119e-03 3 1  ON 57
ci_059                -4.950567e-04 3 1  ON 58
ci_060                -5.666368e-04 3 1  ON 59
ci_061                -8.249047e-04 3 1  ON 60
ci_062                -7.572690e-04 3 1  ON 61
ci_063                -7.492603e-04 3 1  ON 62
ci_064                -1.250518e-03 3 1  ON 63
ci_065                -2.045671e-03 3 1  ON 64
ci_066                -2.147471e-03 3 1  ON 65
ci_067                -1.235234e-03 3 1  ON 66
ci_068                -1.421841e-03 3 1  ON 67
ci_069                 3.382464e-04 3 1  ON 68
ci_070                 3.275092e-04 3 1  ON 69
ci_071                -2.071573e-03 3 1  ON 70
ci_072                -1.709024e-03 3 1  ON 71
ci_073                 1.885126e-04 3 1  ON 72
ci_074                 3.068686e-04 3 1  ON 73
ci_075                -1.649087e-04 3 1  ON 74
ci_076                -1.572771e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.5834
    reference variance = 0.430486
====================================================
  Execution time = 2.5547e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.6536e-01
  Total weights = 1.9552e+06
  Execution time = 3.6276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453148322329
                                         uncertainty =       0.005254495664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453148322329
                                         uncertainty =       0.005254495664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476001560
  error estimate for blocks of size 2^( 2) =       0.000499654180
  error estimate for blocks of size 2^( 3) =       0.000521766279
  error estimate for blocks of size 2^( 4) =       0.000537534564
  error estimate for blocks of size 2^( 5) =       0.000546766621
  error estimate for blocks of size 2^( 6) =       0.000550965082
  error estimate for blocks of size 2^( 7) =       0.000555043096

      target function =      -0.732205334814
              le_mean =     -22.661428605235
             les_mean =     514.006590077795
             stat err =       0.000547577341
             autocorr =       1.323348365327
   target nu stat err =       0.000547577341
   target dn stat err =       0.006153079228
      target stat err =       0.004903113669
              std dev =       0.673167861487
             le_variance =       0.453154969739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452391567680
                                         uncertainty =       0.005031241526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452391567680
                                         uncertainty =       0.005031241526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475602364
  error estimate for blocks of size 2^( 2) =       0.000499295522
  error estimate for blocks of size 2^( 3) =       0.000521426987
  error estimate for blocks of size 2^( 4) =       0.000537207655
  error estimate for blocks of size 2^( 5) =       0.000546457559
  error estimate for blocks of size 2^( 6) =       0.000550647993
  error estimate for blocks of size 2^( 7) =       0.000554716085

      target function =      -0.715090865756
              le_mean =     -22.661425795344
             les_mean =     514.028174389923
             stat err =       0.000547257323
             autocorr =       1.324021855218
   target nu stat err =       0.000547257323
   target dn stat err =       0.021413807443
      target stat err =       0.016174231157
              std dev =       0.672603313713
             le_variance =       0.452395217618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452669135346
                                         uncertainty =       0.005125662097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452669135346
                                         uncertainty =       0.005125662097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475748954
  error estimate for blocks of size 2^( 2) =       0.000499425773
  error estimate for blocks of size 2^( 3) =       0.000521551037
  error estimate for blocks of size 2^( 4) =       0.000537326849
  error estimate for blocks of size 2^( 5) =       0.000546573915
  error estimate for blocks of size 2^( 6) =       0.000550770896
  error estimate for blocks of size 2^( 7) =       0.000554841695

      target function =      -0.732740085568
              le_mean =     -22.661421129159
             les_mean =     514.005577580676
             stat err =       0.000547378339
             autocorr =       1.323791324389
   target nu stat err =       0.000547378339
   target dn stat err =       0.006011694572
      target stat err =       0.004798969664
              std dev =       0.672810622644
             le_variance =       0.452674133943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453081047733
                                         uncertainty =       0.005237167118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453081047733
                                         uncertainty =       0.005237167118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475966115
  error estimate for blocks of size 2^( 2) =       0.000499621785
  error estimate for blocks of size 2^( 3) =       0.000521735629
  error estimate for blocks of size 2^( 4) =       0.000537504911
  error estimate for blocks of size 2^( 5) =       0.000546738838
  error estimate for blocks of size 2^( 6) =       0.000550937186
  error estimate for blocks of size 2^( 7) =       0.000555014710

      target function =      -0.732675966799
              le_mean =     -22.661427217701
             les_mean =     514.005933020056
             stat err =       0.000547548911
             autocorr =       1.323408041999
   target nu stat err =       0.000547548911
   target dn stat err =       0.006119722829
      target stat err =       0.004883130877
              std dev =       0.673117734388
             le_variance =       0.453087484348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.732205334814        initial
     2.5000e-01     2.5000e+00             1.0378e-03        -0.715090865756
     1.0000e+00     1.0000e+01             2.9800e-04        -0.732740085568  <--
     4.0000e+00     4.0000e+01             7.7368e-05        -0.732675966799

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3677e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -7.015034e-01 3 1  ON 0
ci_002                -7.056558e-01 3 1  ON 1
ci_003                -5.472800e-02 3 1  ON 2
ci_004                -5.579449e-02 3 1  ON 3
ci_005                 2.286897e-02 3 1  ON 4
ci_006                 2.317213e-02 3 1  ON 5
ci_007                 1.842437e-02 3 1  ON 6
ci_008                 1.857167e-02 3 1  ON 7
ci_009                -1.485444e-02 3 1  ON 8
ci_010                -1.485704e-02 3 1  ON 9
ci_011                -1.225148e-02 3 1  ON 10
ci_012                -1.181542e-02 3 1  ON 11
ci_013                 1.083329e-02 3 1  ON 12
ci_014                 1.076937e-02 3 1  ON 13
ci_015                 1.144689e-02 3 1  ON 14
ci_016                 1.136528e-02 3 1  ON 15
ci_017                 9.506025e-03 3 1  ON 16
ci_018                 9.738899e-03 3 1  ON 17
ci_019                 3.037990e-03 3 1  ON 18
ci_020                 3.000893e-03 3 1  ON 19
ci_021                -8.455942e-03 3 1  ON 20
ci_022                -9.209992e-03 3 1  ON 21
ci_023                 6.185296e-03 3 1  ON 22
ci_024                 5.994426e-03 3 1  ON 23
ci_025                 1.085104e-02 3 1  ON 24
ci_026                 1.067003e-02 3 1  ON 25
ci_027                 6.497051e-03 3 1  ON 26
ci_028                 6.784220e-03 3 1  ON 27
ci_029                -5.015329e-03 3 1  ON 28
ci_030                -5.085141e-03 3 1  ON 29
ci_031                 9.833635e-04 3 1  ON 30
ci_032                 6.587178e-04 3 1  ON 31
ci_033                 3.814069e-03 3 1  ON 32
ci_034                 4.147817e-03 3 1  ON 33
ci_035                 2.995591e-03 3 1  ON 34
ci_036                 2.768764e-03 3 1  ON 35
ci_037                 3.898746e-03 3 1  ON 36
ci_038                 4.262579e-03 3 1  ON 37
ci_039                 4.748511e-03 3 1  ON 38
ci_040                 4.734221e-03 3 1  ON 39
ci_041                 2.898685e-03 3 1  ON 40
ci_042                 3.239327e-03 3 1  ON 41
ci_043                 3.894325e-03 3 1  ON 42
ci_044                 3.698483e-03 3 1  ON 43
ci_045                 3.113173e-03 3 1  ON 44
ci_046                 3.313874e-03 3 1  ON 45
ci_047                -1.317801e-03 3 1  ON 46
ci_048                -1.682648e-03 3 1  ON 47
ci_049                 1.421170e-03 3 1  ON 48
ci_050                 1.487048e-03 3 1  ON 49
ci_051                -1.392526e-03 3 1  ON 50
ci_052                -1.799479e-03 3 1  ON 51
ci_053                -2.550283e-03 3 1  ON 52
ci_054                -2.589753e-03 3 1  ON 53
ci_055                -1.917156e-03 3 1  ON 54
ci_056                -1.463670e-03 3 1  ON 55
ci_057                -1.382609e-03 3 1  ON 56
ci_058                -1.252119e-03 3 1  ON 57
ci_059                -4.950567e-04 3 1  ON 58
ci_060                -5.666368e-04 3 1  ON 59
ci_061                -8.249047e-04 3 1  ON 60
ci_062                -7.572690e-04 3 1  ON 61
ci_063                -7.492603e-04 3 1  ON 62
ci_064                -1.250518e-03 3 1  ON 63
ci_065                -2.045671e-03 3 1  ON 64
ci_066                -2.147471e-03 3 1  ON 65
ci_067                -1.235234e-03 3 1  ON 66
ci_068                -1.421841e-03 3 1  ON 67
ci_069                 3.382464e-04 3 1  ON 68
ci_070                 3.275092e-04 3 1  ON 69
ci_071                -2.071573e-03 3 1  ON 70
ci_072                -1.709024e-03 3 1  ON 71
ci_073                 1.885126e-04 3 1  ON 72
ci_074                 3.068686e-04 3 1  ON 73
ci_075                -1.649087e-04 3 1  ON 74
ci_076                -1.572771e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4644e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2629e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6117
    reference variance = 0.330873
====================================================
  Execution time = 2.6236e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5550e-01
  Total weights = 1.955309360e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444714066738
                                         uncertainty =       0.003817923306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444714066738
                                         uncertainty =       0.003817923306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471513050
  error estimate for blocks of size 2^( 2) =       0.000495365398
  error estimate for blocks of size 2^( 3) =       0.000516748339
  error estimate for blocks of size 2^( 4) =       0.000532940003
  error estimate for blocks of size 2^( 5) =       0.000542851232
  error estimate for blocks of size 2^( 6) =       0.000547866942
  error estimate for blocks of size 2^( 7) =       0.000550660348

      target function =      -0.740825833345
              le_mean =     -22.662588665709
             les_mean =     514.048420263640
             stat err =       0.000543579631
             autocorr =       1.329042640768
   target nu stat err =       0.000543579631
   target dn stat err =       0.004546871915
      target stat err =       0.003735877972
              std dev =       0.666820149949
             le_variance =       0.444649112378


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266258866571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740843851874       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741094172540       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741144457714       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741149297411       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741150838137       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741152488203       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741154085752       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741154720711       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741154897525       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741154925519       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741154991947       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741155003422       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.357579e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740843851874       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740915157056       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740928755167       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740930008019       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740930390425       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740930803274       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740931147888       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740931263835       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740931301571       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740931307264       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740931321238       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740931323275       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.441093e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740843851874       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740862321651       residual = 9.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740865789888       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740866105425       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740866200521       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740866303459       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740866385752       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740866412155       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740866421186       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740866422528       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740866425839       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740866426300       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 8.837154e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017346 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1050e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.012135e-01 3 1  ON 0
ci_002                -7.059999e-01 3 1  ON 1
ci_003                -5.467331e-02 3 1  ON 2
ci_004                -5.583502e-02 3 1  ON 3
ci_005                 2.260133e-02 3 1  ON 4
ci_006                 2.285362e-02 3 1  ON 5
ci_007                 1.825331e-02 3 1  ON 6
ci_008                 1.845107e-02 3 1  ON 7
ci_009                -1.451218e-02 3 1  ON 8
ci_010                -1.465285e-02 3 1  ON 9
ci_011                -1.201696e-02 3 1  ON 10
ci_012                -1.166706e-02 3 1  ON 11
ci_013                 1.067906e-02 3 1  ON 12
ci_014                 1.062418e-02 3 1  ON 13
ci_015                 1.127262e-02 3 1  ON 14
ci_016                 1.135197e-02 3 1  ON 15
ci_017                 9.338340e-03 3 1  ON 16
ci_018                 9.673126e-03 3 1  ON 17
ci_019                 2.777941e-03 3 1  ON 18
ci_020                 2.743862e-03 3 1  ON 19
ci_021                -8.472467e-03 3 1  ON 20
ci_022                -9.323836e-03 3 1  ON 21
ci_023                 6.128275e-03 3 1  ON 22
ci_024                 5.934130e-03 3 1  ON 23
ci_025                 1.107060e-02 3 1  ON 24
ci_026                 1.079912e-02 3 1  ON 25
ci_027                 6.490294e-03 3 1  ON 26
ci_028                 6.772471e-03 3 1  ON 27
ci_029                -4.866934e-03 3 1  ON 28
ci_030                -5.021380e-03 3 1  ON 29
ci_031                 1.197719e-03 3 1  ON 30
ci_032                 9.056509e-04 3 1  ON 31
ci_033                 3.820215e-03 3 1  ON 32
ci_034                 4.120913e-03 3 1  ON 33
ci_035                 2.965714e-03 3 1  ON 34
ci_036                 2.706313e-03 3 1  ON 35
ci_037                 3.842573e-03 3 1  ON 36
ci_038                 4.182682e-03 3 1  ON 37
ci_039                 4.752487e-03 3 1  ON 38
ci_040                 4.746585e-03 3 1  ON 39
ci_041                 2.904200e-03 3 1  ON 40
ci_042                 3.239473e-03 3 1  ON 41
ci_043                 3.892176e-03 3 1  ON 42
ci_044                 3.627839e-03 3 1  ON 43
ci_045                 3.042681e-03 3 1  ON 44
ci_046                 3.309598e-03 3 1  ON 45
ci_047                -1.307176e-03 3 1  ON 46
ci_048                -1.660400e-03 3 1  ON 47
ci_049                 1.364816e-03 3 1  ON 48
ci_050                 1.491982e-03 3 1  ON 49
ci_051                -1.455818e-03 3 1  ON 50
ci_052                -1.874932e-03 3 1  ON 51
ci_053                -2.545304e-03 3 1  ON 52
ci_054                -2.571636e-03 3 1  ON 53
ci_055                -1.984891e-03 3 1  ON 54
ci_056                -1.413952e-03 3 1  ON 55
ci_057                -1.419706e-03 3 1  ON 56
ci_058                -1.215059e-03 3 1  ON 57
ci_059                -4.727555e-04 3 1  ON 58
ci_060                -5.742745e-04 3 1  ON 59
ci_061                -8.582895e-04 3 1  ON 60
ci_062                -7.572586e-04 3 1  ON 61
ci_063                -7.384774e-04 3 1  ON 62
ci_064                -1.238018e-03 3 1  ON 63
ci_065                -2.036927e-03 3 1  ON 64
ci_066                -2.125560e-03 3 1  ON 65
ci_067                -1.262974e-03 3 1  ON 66
ci_068                -1.487923e-03 3 1  ON 67
ci_069                 3.034161e-04 3 1  ON 68
ci_070                 3.090137e-04 3 1  ON 69
ci_071                -1.954926e-03 3 1  ON 70
ci_072                -1.780426e-03 3 1  ON 71
ci_073                 2.030177e-04 3 1  ON 72
ci_074                 3.253907e-04 3 1  ON 73
ci_075                -1.225708e-04 3 1  ON 74
ci_076                -6.152929e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.5729
    reference variance = 0.249704
====================================================
  Execution time = 2.5481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.6435e-01
  Total weights = 1.9551e+06
  Execution time = 3.6317e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450076959897
                                         uncertainty =       0.005435000554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450076959897
                                         uncertainty =       0.005435000554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474365687
  error estimate for blocks of size 2^( 2) =       0.000497613273
  error estimate for blocks of size 2^( 3) =       0.000520028750
  error estimate for blocks of size 2^( 4) =       0.000536060189
  error estimate for blocks of size 2^( 5) =       0.000545120214
  error estimate for blocks of size 2^( 6) =       0.000551974496
  error estimate for blocks of size 2^( 7) =       0.000554444137

      target function =      -0.732585710652
              le_mean =     -22.662609944018
             les_mean =     514.059597185687
             stat err =       0.000546899759
             autocorr =       1.329195705960
   target nu stat err =       0.000546899759
   target dn stat err =       0.008742688956
      target stat err =       0.006960599457
              std dev =       0.670854388271
             le_variance =       0.450045610262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448988847996
                                         uncertainty =       0.005058680572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448988847996
                                         uncertainty =       0.005058680572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473792792
  error estimate for blocks of size 2^( 2) =       0.000497090076
  error estimate for blocks of size 2^( 3) =       0.000519539614
  error estimate for blocks of size 2^( 4) =       0.000535600728
  error estimate for blocks of size 2^( 5) =       0.000544663640
  error estimate for blocks of size 2^( 6) =       0.000551499764
  error estimate for blocks of size 2^( 7) =       0.000553946373

      target function =      -0.733680226399
              le_mean =     -22.662622619171
             les_mean =     514.058805957527
             stat err =       0.000546427626
             autocorr =       1.330112572778
   target nu stat err =       0.000546427626
   target dn stat err =       0.008069495929
      target stat err =       0.006447800296
              std dev =       0.670044191711
             le_variance =       0.448959218846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449419776083
                                         uncertainty =       0.005218372183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449419776083
                                         uncertainty =       0.005218372183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474019750
  error estimate for blocks of size 2^( 2) =       0.000497296341
  error estimate for blocks of size 2^( 3) =       0.000519731358
  error estimate for blocks of size 2^( 4) =       0.000535780040
  error estimate for blocks of size 2^( 5) =       0.000544844994
  error estimate for blocks of size 2^( 6) =       0.000551689765
  error estimate for blocks of size 2^( 7) =       0.000554153129

      target function =      -0.729901529714
              le_mean =     -22.662610988294
             les_mean =     514.063032574847
             stat err =       0.000546616982
             autocorr =       1.329760307288
   target nu stat err =       0.000546616982
   target dn stat err =       0.009192613840
      target stat err =       0.007262992219
              std dev =       0.670365159708
             le_variance =       0.449389447351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449985105486
                                         uncertainty =       0.005406081855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449985105486
                                         uncertainty =       0.005406081855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474317351
  error estimate for blocks of size 2^( 2) =       0.000497568435
  error estimate for blocks of size 2^( 3) =       0.000519986411
  error estimate for blocks of size 2^( 4) =       0.000536020051
  error estimate for blocks of size 2^( 5) =       0.000545080937
  error estimate for blocks of size 2^( 6) =       0.000551934291
  error estimate for blocks of size 2^( 7) =       0.000554402963

      target function =      -0.732657143116
              le_mean =     -22.662609462318
             les_mean =     514.059486007572
             stat err =       0.000546859560
             autocorr =       1.329271197297
   target nu stat err =       0.000546859560
   target dn stat err =       0.008705805603
      target stat err =       0.006932780376
              std dev =       0.670786030555
             le_variance =       0.449953898788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.732585710652        initial
     2.5000e-01     2.5000e+00             1.3576e-03        -0.733680226399  <--
     1.0000e+00     1.0000e+01             3.4411e-04        -0.729901529714
     4.0000e+00     4.0000e+01             8.8372e-05        -0.732657143116

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.3643e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.003350e-01 3 1  ON 0
ci_002                -7.070134e-01 3 1  ON 1
ci_003                -5.452557e-02 3 1  ON 2
ci_004                -5.596058e-02 3 1  ON 3
ci_005                 2.193314e-02 3 1  ON 4
ci_006                 2.206322e-02 3 1  ON 5
ci_007                 1.781562e-02 3 1  ON 6
ci_008                 1.814937e-02 3 1  ON 7
ci_009                -1.363953e-02 3 1  ON 8
ci_010                -1.413247e-02 3 1  ON 9
ci_011                -1.141552e-02 3 1  ON 10
ci_012                -1.128850e-02 3 1  ON 11
ci_013                 1.028218e-02 3 1  ON 12
ci_014                 1.025243e-02 3 1  ON 13
ci_015                 1.082000e-02 3 1  ON 14
ci_016                 1.131758e-02 3 1  ON 15
ci_017                 8.906542e-03 3 1  ON 16
ci_018                 9.506313e-03 3 1  ON 17
ci_019                 2.098797e-03 3 1  ON 18
ci_020                 2.073268e-03 3 1  ON 19
ci_021                -8.519941e-03 3 1  ON 20
ci_022                -9.623479e-03 3 1  ON 21
ci_023                 5.982892e-03 3 1  ON 22
ci_024                 5.783691e-03 3 1  ON 23
ci_025                 1.164200e-02 3 1  ON 24
ci_026                 1.113860e-02 3 1  ON 25
ci_027                 6.472862e-03 3 1  ON 26
ci_028                 6.744835e-03 3 1  ON 27
ci_029                -4.482571e-03 3 1  ON 28
ci_030                -4.855809e-03 3 1  ON 29
ci_031                 1.752351e-03 3 1  ON 30
ci_032                 1.549140e-03 3 1  ON 31
ci_033                 3.836207e-03 3 1  ON 32
ci_034                 4.049010e-03 3 1  ON 33
ci_035                 2.887633e-03 3 1  ON 34
ci_036                 2.551089e-03 3 1  ON 35
ci_037                 3.695062e-03 3 1  ON 36
ci_038                 3.977667e-03 3 1  ON 37
ci_039                 4.760881e-03 3 1  ON 38
ci_040                 4.778051e-03 3 1  ON 39
ci_041                 2.917474e-03 3 1  ON 40
ci_042                 3.241387e-03 3 1  ON 41
ci_043                 3.884368e-03 3 1  ON 42
ci_044                 3.444976e-03 3 1  ON 43
ci_045                 2.862185e-03 3 1  ON 44
ci_046                 3.300888e-03 3 1  ON 45
ci_047                -1.275088e-03 3 1  ON 46
ci_048                -1.602428e-03 3 1  ON 47
ci_049                 1.222932e-03 3 1  ON 48
ci_050                 1.504816e-03 3 1  ON 49
ci_051                -1.617408e-03 3 1  ON 50
ci_052                -2.064799e-03 3 1  ON 51
ci_053                -2.537108e-03 3 1  ON 52
ci_054                -2.528751e-03 3 1  ON 53
ci_055                -2.160853e-03 3 1  ON 54
ci_056                -1.283697e-03 3 1  ON 55
ci_057                -1.510951e-03 3 1  ON 56
ci_058                -1.121181e-03 3 1  ON 57
ci_059                -4.166286e-04 3 1  ON 58
ci_060                -5.924289e-04 3 1  ON 59
ci_061                -9.423760e-04 3 1  ON 60
ci_062                -7.567229e-04 3 1  ON 61
ci_063                -7.129921e-04 3 1  ON 62
ci_064                -1.208509e-03 3 1  ON 63
ci_065                -2.011937e-03 3 1  ON 64
ci_066                -2.069358e-03 3 1  ON 65
ci_067                -1.334554e-03 3 1  ON 66
ci_068                -1.662178e-03 3 1  ON 67
ci_069                 2.136222e-04 3 1  ON 68
ci_070                 2.595694e-04 3 1  ON 69
ci_071                -1.654440e-03 3 1  ON 70
ci_072                -1.957308e-03 3 1  ON 71
ci_073                 2.385376e-04 3 1  ON 72
ci_074                 3.694712e-04 3 1  ON 73
ci_075                -1.531503e-05 3 1  ON 74
ci_076                 1.846229e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2617e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6524
    reference variance = 0.191
====================================================
  Execution time = 2.6138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4832e-01
  Total weights = 1.955133003e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439748311823
                                         uncertainty =       0.002434754479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439748311823
                                         uncertainty =       0.002434754479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468861216
  error estimate for blocks of size 2^( 2) =       0.000492940027
  error estimate for blocks of size 2^( 3) =       0.000515024058
  error estimate for blocks of size 2^( 4) =       0.000531407323
  error estimate for blocks of size 2^( 5) =       0.000540203077
  error estimate for blocks of size 2^( 6) =       0.000546580107
  error estimate for blocks of size 2^( 7) =       0.000549679196

      target function =      -0.746696682016
              le_mean =     -22.661809891517
             les_mean =     514.005945068646
             stat err =       0.000541967426
             autocorr =       1.336157795991
   target nu stat err =       0.000541967426
   target dn stat err =       0.002698313520
      target stat err =       0.002299900047
              std dev =       0.663069890706
             le_variance =       0.439661679960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266180989152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746702781392       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747039943249       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747131823557       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747148002502       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747152912260       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747152782465       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747154709292       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747154932017       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747155012239       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747154874275       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747154831671       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747154851869       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747154819085       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747154806623       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 2.946705e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746702781392       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746828799036       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746859136516       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746864021506       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746865196706       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746865101203       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746865477789       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746865469546       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746865482945       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746865448852       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746865445042       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.017821e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746702781392       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746738732924       residual = 7.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746746932815       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746748205283       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746748478162       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746748451745       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746748531700       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746748528240       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746748530327       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746748521901       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.833335e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0937e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -7.003182e-01 3 1  ON 0
ci_002                -7.071908e-01 3 1  ON 1
ci_003                -5.483922e-02 3 1  ON 2
ci_004                -5.510964e-02 3 1  ON 3
ci_005                 2.133786e-02 3 1  ON 4
ci_006                 2.167692e-02 3 1  ON 5
ci_007                 1.728480e-02 3 1  ON 6
ci_008                 1.758057e-02 3 1  ON 7
ci_009                -1.350275e-02 3 1  ON 8
ci_010                -1.353775e-02 3 1  ON 9
ci_011                -1.046760e-02 3 1  ON 10
ci_012                -1.099706e-02 3 1  ON 11
ci_013                 1.005813e-02 3 1  ON 12
ci_014                 1.044450e-02 3 1  ON 13
ci_015                 1.005492e-02 3 1  ON 14
ci_016                 1.104369e-02 3 1  ON 15
ci_017                 8.815417e-03 3 1  ON 16
ci_018                 9.196538e-03 3 1  ON 17
ci_019                 1.080976e-03 3 1  ON 18
ci_020                 1.791056e-03 3 1  ON 19
ci_021                -8.931912e-03 3 1  ON 20
ci_022                -1.008360e-02 3 1  ON 21
ci_023                 5.937323e-03 3 1  ON 22
ci_024                 5.658243e-03 3 1  ON 23
ci_025                 1.181679e-02 3 1  ON 24
ci_026                 1.129472e-02 3 1  ON 25
ci_027                 6.730891e-03 3 1  ON 26
ci_028                 6.700162e-03 3 1  ON 27
ci_029                -4.147627e-03 3 1  ON 28
ci_030                -4.589600e-03 3 1  ON 29
ci_031                 2.602074e-03 3 1  ON 30
ci_032                 1.964463e-03 3 1  ON 31
ci_033                 3.747874e-03 3 1  ON 32
ci_034                 3.806663e-03 3 1  ON 33
ci_035                 2.596844e-03 3 1  ON 34
ci_036                 2.345297e-03 3 1  ON 35
ci_037                 3.388159e-03 3 1  ON 36
ci_038                 4.037553e-03 3 1  ON 37
ci_039                 4.473287e-03 3 1  ON 38
ci_040                 4.474395e-03 3 1  ON 39
ci_041                 2.828672e-03 3 1  ON 40
ci_042                 3.083062e-03 3 1  ON 41
ci_043                 3.509312e-03 3 1  ON 42
ci_044                 3.225331e-03 3 1  ON 43
ci_045                 2.911663e-03 3 1  ON 44
ci_046                 3.354819e-03 3 1  ON 45
ci_047                -1.124633e-03 3 1  ON 46
ci_048                -1.537052e-03 3 1  ON 47
ci_049                 1.213662e-03 3 1  ON 48
ci_050                 1.466090e-03 3 1  ON 49
ci_051                -1.854857e-03 3 1  ON 50
ci_052                -1.782567e-03 3 1  ON 51
ci_053                -2.562161e-03 3 1  ON 52
ci_054                -2.432467e-03 3 1  ON 53
ci_055                -2.001260e-03 3 1  ON 54
ci_056                -1.300789e-03 3 1  ON 55
ci_057                -1.771786e-03 3 1  ON 56
ci_058                -1.290312e-03 3 1  ON 57
ci_059                -5.506431e-04 3 1  ON 58
ci_060                -2.277883e-04 3 1  ON 59
ci_061                -8.183618e-04 3 1  ON 60
ci_062                -6.535871e-04 3 1  ON 61
ci_063                -4.575774e-04 3 1  ON 62
ci_064                -1.047565e-03 3 1  ON 63
ci_065                -2.075051e-03 3 1  ON 64
ci_066                -1.934029e-03 3 1  ON 65
ci_067                -1.495105e-03 3 1  ON 66
ci_068                -1.557991e-03 3 1  ON 67
ci_069                 2.360559e-04 3 1  ON 68
ci_070                 2.989111e-04 3 1  ON 69
ci_071                -1.749322e-03 3 1  ON 70
ci_072                -1.674286e-03 3 1  ON 71
ci_073                 2.439558e-04 3 1  ON 72
ci_074                 4.208857e-04 3 1  ON 73
ci_075                 6.112655e-05 3 1  ON 74
ci_076                 3.966058e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.652
    reference variance = 0.358305
====================================================
  Execution time = 2.7816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4869e-01
  Total weights = 1.9549e+06
  Execution time = 3.6053e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0718985
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440708480946
                                         uncertainty =       0.002162098519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440708480946
                                         uncertainty =       0.002162098519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469464955
  error estimate for blocks of size 2^( 2) =       0.000493566552
  error estimate for blocks of size 2^( 3) =       0.000516146783
  error estimate for blocks of size 2^( 4) =       0.000531986970
  error estimate for blocks of size 2^( 5) =       0.000540962292
  error estimate for blocks of size 2^( 6) =       0.000547785295
  error estimate for blocks of size 2^( 7) =       0.000551867674

      target function =      -0.744900243946
              le_mean =     -22.662376380572
             les_mean =     514.033814695866
             stat err =       0.000543150558
             autocorr =       1.338548472350
   target nu stat err =       0.000543150558
   target dn stat err =       0.002781963751
      target stat err =       0.002357747846
              std dev =       0.663923706642
             le_variance =       0.440794688241

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00480953
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440127985321
                                         uncertainty =       0.002136915931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440127985321
                                         uncertainty =       0.002136915931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469152545
  error estimate for blocks of size 2^( 2) =       0.000493337945
  error estimate for blocks of size 2^( 3) =       0.000515948145
  error estimate for blocks of size 2^( 4) =       0.000531830673
  error estimate for blocks of size 2^( 5) =       0.000540822263
  error estimate for blocks of size 2^( 6) =       0.000547681169
  error estimate for blocks of size 2^( 7) =       0.000551751457

      target function =      -0.724378865007
              le_mean =     -22.662415336181
             les_mean =     514.060831496227
             stat err =       0.000543021390
             autocorr =       1.339694334755
   target nu stat err =       0.000543021390
   target dn stat err =       0.021551829379
      target stat err =       0.016728329703
              std dev =       0.663481892598
             le_variance =       0.440208221805

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0741027
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440085774287
                                         uncertainty =       0.002142954752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440085774287
                                         uncertainty =       0.002142954752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469130928
  error estimate for blocks of size 2^( 2) =       0.000493291748
  error estimate for blocks of size 2^( 3) =       0.000515896760
  error estimate for blocks of size 2^( 4) =       0.000531772156
  error estimate for blocks of size 2^( 5) =       0.000540763748
  error estimate for blocks of size 2^( 6) =       0.000547593031
  error estimate for blocks of size 2^( 7) =       0.000551700072

      target function =      -0.742073817134
              le_mean =     -22.662377558324
             les_mean =     514.037313918562
             stat err =       0.000542957252
             autocorr =       1.339501320915
   target nu stat err =       0.000542957252
   target dn stat err =       0.004624878041
      target stat err =       0.003809715777
              std dev =       0.663451320384
             le_variance =       0.440167654520

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.246888
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440581771408
                                         uncertainty =       0.002158073579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440581771408
                                         uncertainty =       0.002158073579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469397162
  error estimate for blocks of size 2^( 2) =       0.000493507042
  error estimate for blocks of size 2^( 3) =       0.000516089726
  error estimate for blocks of size 2^( 4) =       0.000531935204
  error estimate for blocks of size 2^( 5) =       0.000540913900
  error estimate for blocks of size 2^( 6) =       0.000547739815
  error estimate for blocks of size 2^( 7) =       0.000551826410

      target function =      -0.745110225048
              le_mean =     -22.662370189049
             les_mean =     514.033277416035
             stat err =       0.000543103832
             autocorr =       1.338704784629
   target nu stat err =       0.000543103832
   target dn stat err =       0.002864780048
      target stat err =       0.002424776464
              std dev =       0.663827832789
             le_variance =       0.440667391586


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744900243946        initial
     6.2500e-02     6.2500e-01             2.9467e-03        -0.724378865007
     2.5000e-01     2.5000e+00             1.0178e-03        -0.742073817134
     1.0000e+00     1.0000e+01             2.8333e-04        -0.745110225048  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.5870e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -7.003335e-01 3 1  ON 0
ci_002                -7.070594e-01 3 1  ON 1
ci_003                -5.460614e-02 3 1  ON 2
ci_004                -5.573917e-02 3 1  ON 3
ci_005                 2.176276e-02 3 1  ON 4
ci_006                 2.195297e-02 3 1  ON 5
ci_007                 1.766675e-02 3 1  ON 6
ci_008                 1.798892e-02 3 1  ON 7
ci_009                -1.360123e-02 3 1  ON 8
ci_010                -1.396498e-02 3 1  ON 9
ci_011                -1.114991e-02 3 1  ON 10
ci_012                -1.120717e-02 3 1  ON 11
ci_013                 1.021834e-02 3 1  ON 12
ci_014                 1.030561e-02 3 1  ON 13
ci_015                 1.060695e-02 3 1  ON 14
ci_016                 1.124139e-02 3 1  ON 15
ci_017                 8.880706e-03 3 1  ON 16
ci_018                 9.417766e-03 3 1  ON 17
ci_019                 1.815464e-03 3 1  ON 18
ci_020                 1.995299e-03 3 1  ON 19
ci_021                -8.634960e-03 3 1  ON 20
ci_022                -9.750983e-03 3 1  ON 21
ci_023                 5.970124e-03 3 1  ON 22
ci_024                 5.748076e-03 3 1  ON 23
ci_025                 1.168931e-02 3 1  ON 24
ci_026                 1.118124e-02 3 1  ON 25
ci_027                 6.547131e-03 3 1  ON 26
ci_028                 6.731810e-03 3 1  ON 27
ci_029                -4.388860e-03 3 1  ON 28
ci_030                -4.781490e-03 3 1  ON 29
ci_031                 1.988790e-03 3 1  ON 30
ci_032                 1.664349e-03 3 1  ON 31
ci_033                 3.811756e-03 3 1  ON 32
ci_034                 3.981696e-03 3 1  ON 33
ci_035                 2.804288e-03 3 1  ON 34
ci_036                 2.492365e-03 3 1  ON 35
ci_037                 3.609315e-03 3 1  ON 36
ci_038                 3.993536e-03 3 1  ON 37
ci_039                 4.677795e-03 3 1  ON 38
ci_040                 4.690294e-03 3 1  ON 39
ci_041                 2.891838e-03 3 1  ON 40
ci_042                 3.195428e-03 3 1  ON 41
ci_043                 3.779774e-03 3 1  ON 42
ci_044                 3.383337e-03 3 1  ON 43
ci_045                 2.875695e-03 3 1  ON 44
ci_046                 3.315376e-03 3 1  ON 45
ci_047                -1.231732e-03 3 1  ON 46
ci_048                -1.584194e-03 3 1  ON 47
ci_049                 1.220503e-03 3 1  ON 48
ci_050                 1.493936e-03 3 1  ON 49
ci_051                -1.684470e-03 3 1  ON 50
ci_052                -1.985678e-03 3 1  ON 51
ci_053                -2.542644e-03 3 1  ON 52
ci_054                -2.501369e-03 3 1  ON 53
ci_055                -2.116634e-03 3 1  ON 54
ci_056                -1.288177e-03 3 1  ON 55
ci_057                -1.585442e-03 3 1  ON 56
ci_058                -1.169583e-03 3 1  ON 57
ci_059                -4.557656e-04 3 1  ON 58
ci_060                -4.869726e-04 3 1  ON 59
ci_061                -9.073517e-04 3 1  ON 60
ci_062                -7.279977e-04 3 1  ON 61
ci_063                -6.414245e-04 3 1  ON 62
ci_064                -1.163425e-03 3 1  ON 63
ci_065                -2.029498e-03 3 1  ON 64
ci_066                -2.031229e-03 3 1  ON 65
ci_067                -1.379381e-03 3 1  ON 66
ci_068                -1.632730e-03 3 1  ON 67
ci_069                 2.204253e-04 3 1  ON 68
ci_070                 2.707055e-04 3 1  ON 69
ci_071                -1.681930e-03 3 1  ON 70
ci_072                -1.877363e-03 3 1  ON 71
ci_073                 2.408898e-04 3 1  ON 72
ci_074                 3.849994e-04 3 1  ON 73
ci_075                 5.826905e-06 3 1  ON 74
ci_076                 2.443080e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6817e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2625e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.6908
    reference variance = 0.3775
====================================================
  Execution time = 2.6167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4923e-01
  Total weights = 1.954798874e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439901679696
                                         uncertainty =       0.002226543661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439901679696
                                         uncertainty =       0.002226543661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468985508
  error estimate for blocks of size 2^( 2) =       0.000493010159
  error estimate for blocks of size 2^( 3) =       0.000514997118
  error estimate for blocks of size 2^( 4) =       0.000530815161
  error estimate for blocks of size 2^( 5) =       0.000540878995
  error estimate for blocks of size 2^( 6) =       0.000545631942
  error estimate for blocks of size 2^( 7) =       0.000547192772

      target function =      -0.745950885512
              le_mean =     -22.662124869080
             les_mean =     514.021132040077
             stat err =       0.000541129717
             autocorr =       1.331324496730
   target nu stat err =       0.000541129717
   target dn stat err =       0.002774680313
      target stat err =       0.002356956830
              std dev =       0.663245666563
             le_variance =       0.439894814215


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266212486908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745957336841       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746103240081       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746128188313       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746131265903       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746132936607       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746133439592       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746134098158       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746134268498       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746134422093       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746134415678       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746134394700       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746134412107       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 9.507801e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745957336841       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745998787977       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746005480693       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746006295541       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746006722233       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746006829228       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746006974237       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746007004035       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746007035626       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746007032983       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746007028790       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.644417e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745957336841       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745968065372       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745969768302       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745969974906       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745970081908       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745970107154       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745970142113       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745970148822       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745970156280       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745970155560       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745970154591       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 6.803392e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1011e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -7.005605e-01 3 1  ON 0
ci_002                -7.068655e-01 3 1  ON 1
ci_003                -5.459486e-02 3 1  ON 2
ci_004                -5.568780e-02 3 1  ON 3
ci_005                 2.163385e-02 3 1  ON 4
ci_006                 2.172675e-02 3 1  ON 5
ci_007                 1.761462e-02 3 1  ON 6
ci_008                 1.784798e-02 3 1  ON 7
ci_009                -1.337572e-02 3 1  ON 8
ci_010                -1.396827e-02 3 1  ON 9
ci_011                -1.106175e-02 3 1  ON 10
ci_012                -1.112070e-02 3 1  ON 11
ci_013                 1.011727e-02 3 1  ON 12
ci_014                 1.021944e-02 3 1  ON 13
ci_015                 1.050394e-02 3 1  ON 14
ci_016                 1.123608e-02 3 1  ON 15
ci_017                 8.757718e-03 3 1  ON 16
ci_018                 9.308009e-03 3 1  ON 17
ci_019                 1.551022e-03 3 1  ON 18
ci_020                 1.742876e-03 3 1  ON 19
ci_021                -8.817194e-03 3 1  ON 20
ci_022                -9.930660e-03 3 1  ON 21
ci_023                 5.975024e-03 3 1  ON 22
ci_024                 5.705587e-03 3 1  ON 23
ci_025                 1.179881e-02 3 1  ON 24
ci_026                 1.127483e-02 3 1  ON 25
ci_027                 6.537466e-03 3 1  ON 26
ci_028                 6.687490e-03 3 1  ON 27
ci_029                -4.314711e-03 3 1  ON 28
ci_030                -4.860285e-03 3 1  ON 29
ci_031                 2.057545e-03 3 1  ON 30
ci_032                 1.919763e-03 3 1  ON 31
ci_033                 3.733477e-03 3 1  ON 32
ci_034                 3.940918e-03 3 1  ON 33
ci_035                 2.780260e-03 3 1  ON 34
ci_036                 2.460271e-03 3 1  ON 35
ci_037                 3.543526e-03 3 1  ON 36
ci_038                 3.953014e-03 3 1  ON 37
ci_039                 4.685974e-03 3 1  ON 38
ci_040                 4.678625e-03 3 1  ON 39
ci_041                 2.891536e-03 3 1  ON 40
ci_042                 3.182785e-03 3 1  ON 41
ci_043                 3.847976e-03 3 1  ON 42
ci_044                 3.334235e-03 3 1  ON 43
ci_045                 2.946449e-03 3 1  ON 44
ci_046                 3.232350e-03 3 1  ON 45
ci_047                -1.249537e-03 3 1  ON 46
ci_048                -1.536430e-03 3 1  ON 47
ci_049                 1.174132e-03 3 1  ON 48
ci_050                 1.405526e-03 3 1  ON 49
ci_051                -1.798512e-03 3 1  ON 50
ci_052                -1.942615e-03 3 1  ON 51
ci_053                -2.536906e-03 3 1  ON 52
ci_054                -2.588924e-03 3 1  ON 53
ci_055                -2.078295e-03 3 1  ON 54
ci_056                -1.309700e-03 3 1  ON 55
ci_057                -1.531862e-03 3 1  ON 56
ci_058                -1.163209e-03 3 1  ON 57
ci_059                -4.453570e-04 3 1  ON 58
ci_060                -4.919281e-04 3 1  ON 59
ci_061                -8.530097e-04 3 1  ON 60
ci_062                -8.154430e-04 3 1  ON 61
ci_063                -6.413226e-04 3 1  ON 62
ci_064                -1.164220e-03 3 1  ON 63
ci_065                -1.962336e-03 3 1  ON 64
ci_066                -1.894270e-03 3 1  ON 65
ci_067                -1.358374e-03 3 1  ON 66
ci_068                -1.647126e-03 3 1  ON 67
ci_069                 2.234575e-04 3 1  ON 68
ci_070                 2.852188e-04 3 1  ON 69
ci_071                -1.602813e-03 3 1  ON 70
ci_072                -1.883166e-03 3 1  ON 71
ci_073                 2.266787e-04 3 1  ON 72
ci_074                 3.692491e-04 3 1  ON 73
ci_075                -1.595392e-05 3 1  ON 74
ci_076                 2.972518e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.6807
    reference variance = 0.397692
====================================================
  Execution time = 2.5656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5483e-01
  Total weights = 1.9554e+06
  Execution time = 3.6247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441454336149
                                         uncertainty =       0.002375775066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441454336149
                                         uncertainty =       0.002375775066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469825274
  error estimate for blocks of size 2^( 2) =       0.000493637821
  error estimate for blocks of size 2^( 3) =       0.000516097220
  error estimate for blocks of size 2^( 4) =       0.000532638136
  error estimate for blocks of size 2^( 5) =       0.000542427115
  error estimate for blocks of size 2^( 6) =       0.000548014447
  error estimate for blocks of size 2^( 7) =       0.000552321230

      target function =      -0.733864220793
              le_mean =     -22.662322117169
             les_mean =     514.044930521330
             stat err =       0.000543850232
             autocorr =       1.339941648630
   target nu stat err =       0.000543850232
   target dn stat err =       0.009497154952
      target stat err =       0.007580057613
              std dev =       0.664433273787
             le_variance =       0.441471575315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447501135134
                                         uncertainty =       0.006697258772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447501135134
                                         uncertainty =       0.006697258772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473029964
  error estimate for blocks of size 2^( 2) =       0.000496707942
  error estimate for blocks of size 2^( 3) =       0.000519093322
  error estimate for blocks of size 2^( 4) =       0.000535533070
  error estimate for blocks of size 2^( 5) =       0.000545270599
  error estimate for blocks of size 2^( 6) =       0.000550852864
  error estimate for blocks of size 2^( 7) =       0.000555482715

      target function =      -0.119313346728
              le_mean =     -22.662264012391
             les_mean =     516.755971453157
             stat err =       0.000546784812
             autocorr =       1.336151125453
   target nu stat err =       0.000546784812
   target dn stat err =       2.723313971994
      target stat err =       0.089363717316
              std dev =       0.668965390244
             le_variance =       0.447514693345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441223993758
                                         uncertainty =       0.002364558681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441223993758
                                         uncertainty =       0.002364558681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469702679
  error estimate for blocks of size 2^( 2) =       0.000493525401
  error estimate for blocks of size 2^( 3) =       0.000515992623
  error estimate for blocks of size 2^( 4) =       0.000532535391
  error estimate for blocks of size 2^( 5) =       0.000542324103
  error estimate for blocks of size 2^( 6) =       0.000547910216
  error estimate for blocks of size 2^( 7) =       0.000552211166

      target function =      -0.741201399663
              le_mean =     -22.662318738138
             les_mean =     514.035728511234
             stat err =       0.000543745219
             autocorr =       1.340123519121
   target nu stat err =       0.000543745219
   target dn stat err =       0.003834621159
      target stat err =       0.003168759272
              std dev =       0.664259898316
             le_variance =       0.441241212511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441421188678
                                         uncertainty =       0.002374307738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441421188678
                                         uncertainty =       0.002374307738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469807635
  error estimate for blocks of size 2^( 2) =       0.000493621336
  error estimate for blocks of size 2^( 3) =       0.000516081736
  error estimate for blocks of size 2^( 4) =       0.000532622962
  error estimate for blocks of size 2^( 5) =       0.000542411351
  error estimate for blocks of size 2^( 6) =       0.000547996733
  error estimate for blocks of size 2^( 7) =       0.000552304783

      target function =      -0.740183237770
              le_mean =     -22.662321515659
             les_mean =     514.037108148515
             stat err =       0.000543833958
             autocorr =       1.339962062600
   target nu stat err =       0.000543833958
   target dn stat err =       0.004119191783
      target stat err =       0.003386750370
              std dev =       0.664408329368
             le_variance =       0.441438428134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.733864220793        initial
     2.5000e-01     2.5000e+00             9.5078e-04        -0.119313346728
     1.0000e+00     1.0000e+01             2.6444e-04        -0.741201399663  <--
     4.0000e+00     4.0000e+01             6.8034e-05        -0.740183237770

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3777e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -7.005605e-01 3 1  ON 0
ci_002                -7.068655e-01 3 1  ON 1
ci_003                -5.459486e-02 3 1  ON 2
ci_004                -5.568780e-02 3 1  ON 3
ci_005                 2.163385e-02 3 1  ON 4
ci_006                 2.172675e-02 3 1  ON 5
ci_007                 1.761462e-02 3 1  ON 6
ci_008                 1.784798e-02 3 1  ON 7
ci_009                -1.337572e-02 3 1  ON 8
ci_010                -1.396827e-02 3 1  ON 9
ci_011                -1.106175e-02 3 1  ON 10
ci_012                -1.112070e-02 3 1  ON 11
ci_013                 1.011727e-02 3 1  ON 12
ci_014                 1.021944e-02 3 1  ON 13
ci_015                 1.050394e-02 3 1  ON 14
ci_016                 1.123608e-02 3 1  ON 15
ci_017                 8.757718e-03 3 1  ON 16
ci_018                 9.308009e-03 3 1  ON 17
ci_019                 1.551022e-03 3 1  ON 18
ci_020                 1.742876e-03 3 1  ON 19
ci_021                -8.817194e-03 3 1  ON 20
ci_022                -9.930660e-03 3 1  ON 21
ci_023                 5.975024e-03 3 1  ON 22
ci_024                 5.705587e-03 3 1  ON 23
ci_025                 1.179881e-02 3 1  ON 24
ci_026                 1.127483e-02 3 1  ON 25
ci_027                 6.537466e-03 3 1  ON 26
ci_028                 6.687490e-03 3 1  ON 27
ci_029                -4.314711e-03 3 1  ON 28
ci_030                -4.860285e-03 3 1  ON 29
ci_031                 2.057545e-03 3 1  ON 30
ci_032                 1.919763e-03 3 1  ON 31
ci_033                 3.733477e-03 3 1  ON 32
ci_034                 3.940918e-03 3 1  ON 33
ci_035                 2.780260e-03 3 1  ON 34
ci_036                 2.460271e-03 3 1  ON 35
ci_037                 3.543526e-03 3 1  ON 36
ci_038                 3.953014e-03 3 1  ON 37
ci_039                 4.685974e-03 3 1  ON 38
ci_040                 4.678625e-03 3 1  ON 39
ci_041                 2.891536e-03 3 1  ON 40
ci_042                 3.182785e-03 3 1  ON 41
ci_043                 3.847976e-03 3 1  ON 42
ci_044                 3.334235e-03 3 1  ON 43
ci_045                 2.946449e-03 3 1  ON 44
ci_046                 3.232350e-03 3 1  ON 45
ci_047                -1.249537e-03 3 1  ON 46
ci_048                -1.536430e-03 3 1  ON 47
ci_049                 1.174132e-03 3 1  ON 48
ci_050                 1.405526e-03 3 1  ON 49
ci_051                -1.798512e-03 3 1  ON 50
ci_052                -1.942615e-03 3 1  ON 51
ci_053                -2.536906e-03 3 1  ON 52
ci_054                -2.588924e-03 3 1  ON 53
ci_055                -2.078295e-03 3 1  ON 54
ci_056                -1.309700e-03 3 1  ON 55
ci_057                -1.531862e-03 3 1  ON 56
ci_058                -1.163209e-03 3 1  ON 57
ci_059                -4.453570e-04 3 1  ON 58
ci_060                -4.919281e-04 3 1  ON 59
ci_061                -8.530097e-04 3 1  ON 60
ci_062                -8.154430e-04 3 1  ON 61
ci_063                -6.413226e-04 3 1  ON 62
ci_064                -1.164220e-03 3 1  ON 63
ci_065                -1.962336e-03 3 1  ON 64
ci_066                -1.894270e-03 3 1  ON 65
ci_067                -1.358374e-03 3 1  ON 66
ci_068                -1.647126e-03 3 1  ON 67
ci_069                 2.234575e-04 3 1  ON 68
ci_070                 2.852188e-04 3 1  ON 69
ci_071                -1.602813e-03 3 1  ON 70
ci_072                -1.883166e-03 3 1  ON 71
ci_073                 2.266787e-04 3 1  ON 72
ci_074                 3.692491e-04 3 1  ON 73
ci_075                -1.595392e-05 3 1  ON 74
ci_076                 2.972518e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4803e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2638e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7092
    reference variance = 0.327167
====================================================
  Execution time = 2.6292e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5021e-01
  Total weights = 1.955025661e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440461398702
                                         uncertainty =       0.002143477520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440461398702
                                         uncertainty =       0.002143477520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469298008
  error estimate for blocks of size 2^( 2) =       0.000492900601
  error estimate for blocks of size 2^( 3) =       0.000514991792
  error estimate for blocks of size 2^( 4) =       0.000530960272
  error estimate for blocks of size 2^( 5) =       0.000540439631
  error estimate for blocks of size 2^( 6) =       0.000544826569
  error estimate for blocks of size 2^( 7) =       0.000550737158

      target function =      -0.745141133835
              le_mean =     -22.662060113074
             les_mean =     514.019181442133
             stat err =       0.000541740907
             autocorr =       1.332557136446
   target nu stat err =       0.000541740907
   target dn stat err =       0.002949497506
      target stat err =       0.002490883034
              std dev =       0.663687608232
             le_variance =       0.440481241320


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266206011307e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745148536122       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745290666489       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745318994393       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745321694888       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745322163456       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745321993873       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745322265630       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745322241305       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745322224643       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745322241186       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745322264982       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745322263225       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.121958e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745148536122       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745188957189       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745196563176       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745197250781       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745197352860       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745197303325       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745197366028       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745197357769       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745197354814       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745197358988       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745197364087       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.124846e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745148536122       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745159001236       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745160936993       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745161109221       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745161133526       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745161120704       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745161135990       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745161133809       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745161133157       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745161134201       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 8.044517e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040932 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1087e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -7.005651e-01 3 1  ON 0
ci_002                -7.069199e-01 3 1  ON 1
ci_003                -5.448429e-02 3 1  ON 2
ci_004                -5.548063e-02 3 1  ON 3
ci_005                 2.145645e-02 3 1  ON 4
ci_006                 2.155770e-02 3 1  ON 5
ci_007                 1.743818e-02 3 1  ON 6
ci_008                 1.773510e-02 3 1  ON 7
ci_009                -1.330939e-02 3 1  ON 8
ci_010                -1.379441e-02 3 1  ON 9
ci_011                -1.095031e-02 3 1  ON 10
ci_012                -1.109940e-02 3 1  ON 11
ci_013                 1.005216e-02 3 1  ON 12
ci_014                 1.005968e-02 3 1  ON 13
ci_015                 1.042674e-02 3 1  ON 14
ci_016                 1.092359e-02 3 1  ON 15
ci_017                 8.683225e-03 3 1  ON 16
ci_018                 9.238839e-03 3 1  ON 17
ci_019                 1.279279e-03 3 1  ON 18
ci_020                 1.555179e-03 3 1  ON 19
ci_021                -8.989424e-03 3 1  ON 20
ci_022                -1.006499e-02 3 1  ON 21
ci_023                 5.869671e-03 3 1  ON 22
ci_024                 5.666478e-03 3 1  ON 23
ci_025                 1.193177e-02 3 1  ON 24
ci_026                 1.137185e-02 3 1  ON 25
ci_027                 6.472013e-03 3 1  ON 26
ci_028                 6.705225e-03 3 1  ON 27
ci_029                -4.265974e-03 3 1  ON 28
ci_030                -4.767257e-03 3 1  ON 29
ci_031                 2.143239e-03 3 1  ON 30
ci_032                 2.027241e-03 3 1  ON 31
ci_033                 3.653683e-03 3 1  ON 32
ci_034                 3.852850e-03 3 1  ON 33
ci_035                 2.722731e-03 3 1  ON 34
ci_036                 2.394790e-03 3 1  ON 35
ci_037                 3.558837e-03 3 1  ON 36
ci_038                 3.898037e-03 3 1  ON 37
ci_039                 4.668910e-03 3 1  ON 38
ci_040                 4.645372e-03 3 1  ON 39
ci_041                 2.921119e-03 3 1  ON 40
ci_042                 3.183124e-03 3 1  ON 41
ci_043                 3.788635e-03 3 1  ON 42
ci_044                 3.327803e-03 3 1  ON 43
ci_045                 2.923121e-03 3 1  ON 44
ci_046                 3.222426e-03 3 1  ON 45
ci_047                -1.245846e-03 3 1  ON 46
ci_048                -1.520709e-03 3 1  ON 47
ci_049                 1.152645e-03 3 1  ON 48
ci_050                 1.352759e-03 3 1  ON 49
ci_051                -1.824500e-03 3 1  ON 50
ci_052                -1.945642e-03 3 1  ON 51
ci_053                -2.578705e-03 3 1  ON 52
ci_054                -2.534854e-03 3 1  ON 53
ci_055                -2.053547e-03 3 1  ON 54
ci_056                -1.225464e-03 3 1  ON 55
ci_057                -1.484763e-03 3 1  ON 56
ci_058                -1.137095e-03 3 1  ON 57
ci_059                -4.369301e-04 3 1  ON 58
ci_060                -5.021534e-04 3 1  ON 59
ci_061                -7.877893e-04 3 1  ON 60
ci_062                -7.355304e-04 3 1  ON 61
ci_063                -6.016081e-04 3 1  ON 62
ci_064                -1.133608e-03 3 1  ON 63
ci_065                -1.970282e-03 3 1  ON 64
ci_066                -1.939369e-03 3 1  ON 65
ci_067                -1.370653e-03 3 1  ON 66
ci_068                -1.653885e-03 3 1  ON 67
ci_069                 2.189287e-04 3 1  ON 68
ci_070                 2.678126e-04 3 1  ON 69
ci_071                -1.617237e-03 3 1  ON 70
ci_072                -1.853212e-03 3 1  ON 71
ci_073                 2.267492e-04 3 1  ON 72
ci_074                 3.434718e-04 3 1  ON 73
ci_075                 2.575743e-05 3 1  ON 74
ci_076                 2.573822e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6172
    reference variance = 0.597173
====================================================
  Execution time = 2.5723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5148e-01
  Total weights = 1.9555e+06
  Execution time = 3.6171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440389701348
                                         uncertainty =       0.002338319108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440389701348
                                         uncertainty =       0.002338319108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469236330
  error estimate for blocks of size 2^( 2) =       0.000493491120
  error estimate for blocks of size 2^( 3) =       0.000515703277
  error estimate for blocks of size 2^( 4) =       0.000531745571
  error estimate for blocks of size 2^( 5) =       0.000539538616
  error estimate for blocks of size 2^( 6) =       0.000543491457
  error estimate for blocks of size 2^( 7) =       0.000546638142

      target function =      -0.744321915300
              le_mean =     -22.662134417015
             les_mean =     514.023547158422
             stat err =       0.000540353447
             autocorr =       1.326088757175
   target nu stat err =       0.000540353447
   target dn stat err =       0.003392911700
      target stat err =       0.002839119057
              std dev =       0.663600381786
             le_variance =       0.440365466706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440327530312
                                         uncertainty =       0.002403218619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440327530312
                                         uncertainty =       0.002403218619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469202858
  error estimate for blocks of size 2^( 2) =       0.000493480992
  error estimate for blocks of size 2^( 3) =       0.000515702275
  error estimate for blocks of size 2^( 4) =       0.000531744434
  error estimate for blocks of size 2^( 5) =       0.000539530622
  error estimate for blocks of size 2^( 6) =       0.000543474580
  error estimate for blocks of size 2^( 7) =       0.000546602827

      target function =      -0.694187122734
              le_mean =     -22.662137844108
             les_mean =     514.087334759043
             stat err =       0.000540338116
             autocorr =       1.326202707404
   target nu stat err =       0.000540338116
   target dn stat err =       0.044968782574
      target stat err =       0.032078923795
              std dev =       0.663553045464
             le_variance =       0.440302644144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440321100426
                                         uncertainty =       0.002370176190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440321100426
                                         uncertainty =       0.002370176190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469199618
  error estimate for blocks of size 2^( 2) =       0.000493467781
  error estimate for blocks of size 2^( 3) =       0.000515685596
  error estimate for blocks of size 2^( 4) =       0.000531729549
  error estimate for blocks of size 2^( 5) =       0.000539518051
  error estimate for blocks of size 2^( 6) =       0.000543468158
  error estimate for blocks of size 2^( 7) =       0.000546602792

      target function =      -0.743926110597
              le_mean =     -22.662131711997
             les_mean =     514.023906448353
             stat err =       0.000540329637
             autocorr =       1.326179403161
   target nu stat err =       0.000540329637
   target dn stat err =       0.003661322479
      target stat err =       0.003051036622
              std dev =       0.663548463805
             le_variance =       0.440296563818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440376869566
                                         uncertainty =       0.002341893122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440376869566
                                         uncertainty =       0.002341893122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469229476
  error estimate for blocks of size 2^( 2) =       0.000493485990
  error estimate for blocks of size 2^( 3) =       0.000515699009
  error estimate for blocks of size 2^( 4) =       0.000531741385
  error estimate for blocks of size 2^( 5) =       0.000539533969
  error estimate for blocks of size 2^( 6) =       0.000543486475
  error estimate for blocks of size 2^( 7) =       0.000546631152

      target function =      -0.744437735336
              le_mean =     -22.662133666887
             les_mean =     514.023371450564
             stat err =       0.000540348245
             autocorr =       1.326101968286
   target nu stat err =       0.000540348245
   target dn stat err =       0.003416554399
      target stat err =       0.002858906081
              std dev =       0.663590688654
             le_variance =       0.440352602069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744321915300        initial
     2.5000e-01     2.5000e+00             1.1220e-03        -0.694187122734
     1.0000e+00     1.0000e+01             3.1248e-04        -0.743926110597
     4.0000e+00     4.0000e+01             8.0445e-05        -0.744437735336  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3921e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -7.005624e-01 3 1  ON 0
ci_002                -7.068788e-01 3 1  ON 1
ci_003                -5.456680e-02 3 1  ON 2
ci_004                -5.563534e-02 3 1  ON 3
ci_005                 2.158780e-02 3 1  ON 4
ci_006                 2.168289e-02 3 1  ON 5
ci_007                 1.756912e-02 3 1  ON 6
ci_008                 1.781878e-02 3 1  ON 7
ci_009                -1.335856e-02 3 1  ON 8
ci_010                -1.392337e-02 3 1  ON 9
ci_011                -1.103307e-02 3 1  ON 10
ci_012                -1.111512e-02 3 1  ON 11
ci_013                 1.010045e-02 3 1  ON 12
ci_014                 1.017820e-02 3 1  ON 13
ci_015                 1.048405e-02 3 1  ON 14
ci_016                 1.115563e-02 3 1  ON 15
ci_017                 8.738359e-03 3 1  ON 16
ci_018                 9.290173e-03 3 1  ON 17
ci_019                 1.481123e-03 3 1  ON 18
ci_020                 1.694534e-03 3 1  ON 19
ci_021                -8.861521e-03 3 1  ON 20
ci_022                -9.965195e-03 3 1  ON 21
ci_023                 5.947629e-03 3 1  ON 22
ci_024                 5.695469e-03 3 1  ON 23
ci_025                 1.183285e-02 3 1  ON 24
ci_026                 1.129973e-02 3 1  ON 25
ci_027                 6.520478e-03 3 1  ON 26
ci_028                 6.692078e-03 3 1  ON 27
ci_029                -4.302155e-03 3 1  ON 28
ci_030                -4.836344e-03 3 1  ON 29
ci_031                 2.079539e-03 3 1  ON 30
ci_032                 1.947328e-03 3 1  ON 31
ci_033                 3.712963e-03 3 1  ON 32
ci_034                 3.918278e-03 3 1  ON 33
ci_035                 2.765383e-03 3 1  ON 34
ci_036                 2.443332e-03 3 1  ON 35
ci_037                 3.547467e-03 3 1  ON 36
ci_038                 3.938789e-03 3 1  ON 37
ci_039                 4.681484e-03 3 1  ON 38
ci_040                 4.669903e-03 3 1  ON 39
ci_041                 2.899128e-03 3 1  ON 40
ci_042                 3.182866e-03 3 1  ON 41
ci_043                 3.832734e-03 3 1  ON 42
ci_044                 3.332561e-03 3 1  ON 43
ci_045                 2.940441e-03 3 1  ON 44
ci_046                 3.229734e-03 3 1  ON 45
ci_047                -1.248682e-03 3 1  ON 46
ci_048                -1.532340e-03 3 1  ON 47
ci_049                 1.168612e-03 3 1  ON 48
ci_050                 1.391897e-03 3 1  ON 49
ci_051                -1.805244e-03 3 1  ON 50
ci_052                -1.943393e-03 3 1  ON 51
ci_053                -2.547617e-03 3 1  ON 52
ci_054                -2.575009e-03 3 1  ON 53
ci_055                -2.071925e-03 3 1  ON 54
ci_056                -1.288044e-03 3 1  ON 55
ci_057                -1.519648e-03 3 1  ON 56
ci_058                -1.156478e-03 3 1  ON 57
ci_059                -4.431999e-04 3 1  ON 58
ci_060                -4.945648e-04 3 1  ON 59
ci_061                -8.361421e-04 3 1  ON 60
ci_062                -7.948474e-04 3 1  ON 61
ci_063                -6.310082e-04 3 1  ON 62
ci_064                -1.156186e-03 3 1  ON 63
ci_065                -1.964404e-03 3 1  ON 64
ci_066                -1.905864e-03 3 1  ON 65
ci_067                -1.361529e-03 3 1  ON 66
ci_068                -1.648862e-03 3 1  ON 67
ci_069                 2.222816e-04 3 1  ON 68
ci_070                 2.807033e-04 3 1  ON 69
ci_071                -1.606591e-03 3 1  ON 70
ci_072                -1.875420e-03 3 1  ON 71
ci_073                 2.267840e-04 3 1  ON 72
ci_074                 3.626198e-04 3 1  ON 73
ci_075                -5.190233e-06 3 1  ON 74
ci_076                 2.869664e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5024e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2642e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6639
    reference variance = 0.338906
====================================================
  Execution time = 2.6250e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.6415e-01
  Total weights = 1.955076384e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448570657675
                                         uncertainty =       0.007594970998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448570657675
                                         uncertainty =       0.007594970998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473559896
  error estimate for blocks of size 2^( 2) =       0.000497623847
  error estimate for blocks of size 2^( 3) =       0.000519603597
  error estimate for blocks of size 2^( 4) =       0.000535685480
  error estimate for blocks of size 2^( 5) =       0.000545391237
  error estimate for blocks of size 2^( 6) =       0.000549621218
  error estimate for blocks of size 2^( 7) =       0.000554047588

      target function =      -0.733770029803
              le_mean =     -22.661143258662
             les_mean =     513.991559313149
             stat err =       0.000546186381
             autocorr =       1.330245813209
   target nu stat err =       0.000546186381
   target dn stat err =       0.012454624498
      target stat err =       0.009909022353
              std dev =       0.669714827175
             le_variance =       0.448517949738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266114325866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733901968630       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734110067500       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734130827396       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734133755635       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734134542051       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734135614917       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734136147810       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.734136333255       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734136367951       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.734136373821       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734136366851       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734136369943       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 8.779071e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733901968630       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733955927942       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.733961227002       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.733961965964       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.733962163153       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.733962428586       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.733962554777       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.733962598074       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.733962605962       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.733962607268       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.733962605593       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.733962606313       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 2.271850e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733901968630       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733915584994       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.733916916690       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.733917101846       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.733917151172       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.733917217337       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.733917248441       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.733917259074       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.733917260998       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.733917261314       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.733917260900       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.733917261077       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 5.729897e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0977e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -7.006959e-01 3 1  ON 0
ci_002                -7.067514e-01 3 1  ON 1
ci_003                -5.456084e-02 3 1  ON 2
ci_004                -5.560647e-02 3 1  ON 3
ci_005                 2.156631e-02 3 1  ON 4
ci_006                 2.165914e-02 3 1  ON 5
ci_007                 1.753262e-02 3 1  ON 6
ci_008                 1.781741e-02 3 1  ON 7
ci_009                -1.335623e-02 3 1  ON 8
ci_010                -1.387661e-02 3 1  ON 9
ci_011                -1.098980e-02 3 1  ON 10
ci_012                -1.110134e-02 3 1  ON 11
ci_013                 1.008705e-02 3 1  ON 12
ci_014                 1.014423e-02 3 1  ON 13
ci_015                 1.058051e-02 3 1  ON 14
ci_016                 1.112944e-02 3 1  ON 15
ci_017                 8.716065e-03 3 1  ON 16
ci_018                 9.218898e-03 3 1  ON 17
ci_019                 1.420402e-03 3 1  ON 18
ci_020                 1.551596e-03 3 1  ON 19
ci_021                -8.927700e-03 3 1  ON 20
ci_022                -1.000259e-02 3 1  ON 21
ci_023                 5.925758e-03 3 1  ON 22
ci_024                 5.579041e-03 3 1  ON 23
ci_025                 1.184279e-02 3 1  ON 24
ci_026                 1.152692e-02 3 1  ON 25
ci_027                 6.537783e-03 3 1  ON 26
ci_028                 6.668228e-03 3 1  ON 27
ci_029                -4.310584e-03 3 1  ON 28
ci_030                -4.800231e-03 3 1  ON 29
ci_031                 2.115378e-03 3 1  ON 30
ci_032                 1.976290e-03 3 1  ON 31
ci_033                 3.705176e-03 3 1  ON 32
ci_034                 3.746759e-03 3 1  ON 33
ci_035                 2.770447e-03 3 1  ON 34
ci_036                 2.429081e-03 3 1  ON 35
ci_037                 3.538605e-03 3 1  ON 36
ci_038                 3.975846e-03 3 1  ON 37
ci_039                 4.672271e-03 3 1  ON 38
ci_040                 4.628850e-03 3 1  ON 39
ci_041                 2.893682e-03 3 1  ON 40
ci_042                 3.201421e-03 3 1  ON 41
ci_043                 3.826586e-03 3 1  ON 42
ci_044                 3.332617e-03 3 1  ON 43
ci_045                 2.945702e-03 3 1  ON 44
ci_046                 3.281143e-03 3 1  ON 45
ci_047                -1.242892e-03 3 1  ON 46
ci_048                -1.540602e-03 3 1  ON 47
ci_049                 1.174056e-03 3 1  ON 48
ci_050                 1.469145e-03 3 1  ON 49
ci_051                -1.777534e-03 3 1  ON 50
ci_052                -1.996116e-03 3 1  ON 51
ci_053                -2.540656e-03 3 1  ON 52
ci_054                -2.566894e-03 3 1  ON 53
ci_055                -2.097626e-03 3 1  ON 54
ci_056                -1.259981e-03 3 1  ON 55
ci_057                -1.533120e-03 3 1  ON 56
ci_058                -1.170235e-03 3 1  ON 57
ci_059                -4.370632e-04 3 1  ON 58
ci_060                -4.856178e-04 3 1  ON 59
ci_061                -8.318900e-04 3 1  ON 60
ci_062                -7.615151e-04 3 1  ON 61
ci_063                -6.373072e-04 3 1  ON 62
ci_064                -1.086391e-03 3 1  ON 63
ci_065                -1.965509e-03 3 1  ON 64
ci_066                -1.921953e-03 3 1  ON 65
ci_067                -1.381263e-03 3 1  ON 66
ci_068                -1.656970e-03 3 1  ON 67
ci_069                 2.109042e-04 3 1  ON 68
ci_070                 2.590076e-04 3 1  ON 69
ci_071                -1.612878e-03 3 1  ON 70
ci_072                -1.905731e-03 3 1  ON 71
ci_073                 2.217823e-04 3 1  ON 72
ci_074                 3.620459e-04 3 1  ON 73
ci_075                 1.285223e-05 3 1  ON 74
ci_076                 2.939623e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6537
    reference variance = 0.438311
====================================================
  Execution time = 2.5669e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4628e-01
  Total weights = 1.9551e+06
  Execution time = 3.6132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708532950
                                         uncertainty =       0.002564185687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708532950
                                         uncertainty =       0.002564185687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467789224
  error estimate for blocks of size 2^( 2) =       0.000491593833
  error estimate for blocks of size 2^( 3) =       0.000514236127
  error estimate for blocks of size 2^( 4) =       0.000530517178
  error estimate for blocks of size 2^( 5) =       0.000540005360
  error estimate for blocks of size 2^( 6) =       0.000544322537
  error estimate for blocks of size 2^( 7) =       0.000547572429

      target function =      -0.748417461132
              le_mean =     -22.660948733348
             les_mean =     513.964810954446
             stat err =       0.000540604376
             autocorr =       1.335545496962
   target nu stat err =       0.000540604376
   target dn stat err =       0.002929475611
      target stat err =       0.002491734153
              std dev =       0.661553864668
             le_variance =       0.437653515857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437731487560
                                         uncertainty =       0.002560799878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437731487560
                                         uncertainty =       0.002560799878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467801434
  error estimate for blocks of size 2^( 2) =       0.000491609863
  error estimate for blocks of size 2^( 3) =       0.000514241025
  error estimate for blocks of size 2^( 4) =       0.000530539685
  error estimate for blocks of size 2^( 5) =       0.000540022503
  error estimate for blocks of size 2^( 6) =       0.000544304857
  error estimate for blocks of size 2^( 7) =       0.000547588593

      target function =      -0.701190951827
              le_mean =     -22.660960881288
             les_mean =     514.023004328947
             stat err =       0.000540613909
             autocorr =       1.335522882837
   target nu stat err =       0.000540613909
   target dn stat err =       0.057299989955
      target stat err =       0.041687739138
              std dev =       0.661571132103
             le_variance =       0.437676362831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437649811468
                                         uncertainty =       0.002561287788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437649811468
                                         uncertainty =       0.002561287788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467757816
  error estimate for blocks of size 2^( 2) =       0.000491564242
  error estimate for blocks of size 2^( 3) =       0.000514206898
  error estimate for blocks of size 2^( 4) =       0.000530488550
  error estimate for blocks of size 2^( 5) =       0.000539975584
  error estimate for blocks of size 2^( 6) =       0.000544286457
  error estimate for blocks of size 2^( 7) =       0.000547540215

      target function =      -0.748379030599
              le_mean =     -22.660950012973
             les_mean =     513.964915587408
             stat err =       0.000540572701
             autocorr =       1.335568336625
   target nu stat err =       0.000540572701
   target dn stat err =       0.002918364923
      target stat err =       0.002482574779
              std dev =       0.661509447393
             le_variance =       0.437594748990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437700417757
                                         uncertainty =       0.002563814853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437700417757
                                         uncertainty =       0.002563814853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467784884
  error estimate for blocks of size 2^( 2) =       0.000491589736
  error estimate for blocks of size 2^( 3) =       0.000514232101
  error estimate for blocks of size 2^( 4) =       0.000530513239
  error estimate for blocks of size 2^( 5) =       0.000540001310
  error estimate for blocks of size 2^( 6) =       0.000544317772
  error estimate for blocks of size 2^( 7) =       0.000547568238

      target function =      -0.748440265725
              le_mean =     -22.660948802893
             les_mean =     513.964786509363
             stat err =       0.000540600140
             autocorr =       1.335549347138
   target nu stat err =       0.000540600140
   target dn stat err =       0.002927189710
      target stat err =       0.002490047784
              std dev =       0.661547727341
             le_variance =       0.437645395550


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748417461132        initial
     1.0000e+00     1.0000e+01             8.7791e-04        -0.701190951827
     4.0000e+00     4.0000e+01             2.2718e-04        -0.748379030599
     1.6000e+01     1.6000e+02             5.7299e-05        -0.748440265725  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.3737e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -7.005958e-01 3 1  ON 0
ci_002                -7.068469e-01 3 1  ON 1
ci_003                -5.456529e-02 3 1  ON 2
ci_004                -5.562811e-02 3 1  ON 3
ci_005                 2.158237e-02 3 1  ON 4
ci_006                 2.167691e-02 3 1  ON 5
ci_007                 1.755992e-02 3 1  ON 6
ci_008                 1.781845e-02 3 1  ON 7
ci_009                -1.335798e-02 3 1  ON 8
ci_010                -1.391158e-02 3 1  ON 9
ci_011                -1.102217e-02 3 1  ON 10
ci_012                -1.111165e-02 3 1  ON 11
ci_013                 1.009707e-02 3 1  ON 12
ci_014                 1.016964e-02 3 1  ON 13
ci_015                 1.050837e-02 3 1  ON 14
ci_016                 1.114904e-02 3 1  ON 15
ci_017                 8.732745e-03 3 1  ON 16
ci_018                 9.272215e-03 3 1  ON 17
ci_019                 1.465836e-03 3 1  ON 18
ci_020                 1.658517e-03 3 1  ON 19
ci_021                -8.878188e-03 3 1  ON 20
ci_022                -9.974633e-03 3 1  ON 21
ci_023                 5.942113e-03 3 1  ON 22
ci_024                 5.666059e-03 3 1  ON 23
ci_025                 1.183534e-02 3 1  ON 24
ci_026                 1.135703e-02 3 1  ON 25
ci_027                 6.524842e-03 3 1  ON 26
ci_028                 6.686051e-03 3 1  ON 27
ci_029                -4.304287e-03 3 1  ON 28
ci_030                -4.827244e-03 3 1  ON 29
ci_031                 2.088556e-03 3 1  ON 30
ci_032                 1.954617e-03 3 1  ON 31
ci_033                 3.711003e-03 3 1  ON 32
ci_034                 3.875016e-03 3 1  ON 33
ci_035                 2.766669e-03 3 1  ON 34
ci_036                 2.439738e-03 3 1  ON 35
ci_037                 3.545233e-03 3 1  ON 36
ci_038                 3.948145e-03 3 1  ON 37
ci_039                 4.679155e-03 3 1  ON 38
ci_040                 4.659527e-03 3 1  ON 39
ci_041                 2.897755e-03 3 1  ON 40
ci_042                 3.187554e-03 3 1  ON 41
ci_043                 3.831182e-03 3 1  ON 42
ci_044                 3.332576e-03 3 1  ON 43
ci_045                 2.941765e-03 3 1  ON 44
ci_046                 3.242697e-03 3 1  ON 45
ci_047                -1.247224e-03 3 1  ON 46
ci_048                -1.534432e-03 3 1  ON 47
ci_049                 1.169986e-03 3 1  ON 48
ci_050                 1.411410e-03 3 1  ON 49
ci_051                -1.798266e-03 3 1  ON 50
ci_052                -1.956706e-03 3 1  ON 51
ci_053                -2.545858e-03 3 1  ON 52
ci_054                -2.572964e-03 3 1  ON 53
ci_055                -2.078423e-03 3 1  ON 54
ci_056                -1.280975e-03 3 1  ON 55
ci_057                -1.523052e-03 3 1  ON 56
ci_058                -1.159959e-03 3 1  ON 57
ci_059                -4.416489e-04 3 1  ON 58
ci_060                -4.923074e-04 3 1  ON 59
ci_061                -8.350727e-04 3 1  ON 60
ci_062                -7.864473e-04 3 1  ON 61
ci_063                -6.325936e-04 3 1  ON 62
ci_064                -1.138566e-03 3 1  ON 63
ci_065                -1.964685e-03 3 1  ON 64
ci_066                -1.909924e-03 3 1  ON 65
ci_067                -1.366509e-03 3 1  ON 66
ci_068                -1.650906e-03 3 1  ON 67
ci_069                 2.194170e-04 3 1  ON 68
ci_070                 2.752343e-04 3 1  ON 69
ci_071                -1.608175e-03 3 1  ON 70
ci_072                -1.883085e-03 3 1  ON 71
ci_073                 2.255195e-04 3 1  ON 72
ci_074                 3.624753e-04 3 1  ON 73
ci_075                -6.360404e-07 3 1  ON 74
ci_076                 2.887297e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2644e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6277
    reference variance = 0.333624
====================================================
  Execution time = 2.6316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5492e-01
  Total weights = 1.955136925e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445062642323
                                         uncertainty =       0.003330487743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445062642323
                                         uncertainty =       0.003330487743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471752022
  error estimate for blocks of size 2^( 2) =       0.000495712594
  error estimate for blocks of size 2^( 3) =       0.000517685668
  error estimate for blocks of size 2^( 4) =       0.000533651998
  error estimate for blocks of size 2^( 5) =       0.000543968486
  error estimate for blocks of size 2^( 6) =       0.000548002672
  error estimate for blocks of size 2^( 7) =       0.000550047516

      target function =      -0.741294661598
              le_mean =     -22.661786721759
             les_mean =     514.011500574844
             stat err =       0.000543917668
             autocorr =       1.329348322129
   target nu stat err =       0.000543917668
   target dn stat err =       0.003475921355
      target stat err =       0.002881805148
              std dev =       0.667158107605
             le_variance =       0.445099940543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266178672176e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741304891316       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741315221183       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741316987733       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741317247239       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741317350431       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741317430374       residual = 9.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741317458066       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741317465534       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741317475753       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741317481358       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741317481247       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741317480948       residual = 1.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 8.792952e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741304891316       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741307496451       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741307939989       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741308004891       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741308030590       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741308050355       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741308057179       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741308059012       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741308061538       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741308062899       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741308062868       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741308062794       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 2.199681e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741304891316       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741305544032       residual = 6.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741305655035       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741305671262       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741305677681       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741305682608       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741305684308       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741305684764       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741305685394       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741305685732       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741305685723       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741305685705       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.4000e+01 is 5.500113e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1043e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -7.005769e-01 3 1  ON 0
ci_002                -7.068689e-01 3 1  ON 1
ci_003                -5.456243e-02 3 1  ON 2
ci_004                -5.561090e-02 3 1  ON 3
ci_005                 2.157619e-02 3 1  ON 4
ci_006                 2.166825e-02 3 1  ON 5
ci_007                 1.754926e-02 3 1  ON 6
ci_008                 1.780773e-02 3 1  ON 7
ci_009                -1.335312e-02 3 1  ON 8
ci_010                -1.390887e-02 3 1  ON 9
ci_011                -1.101165e-02 3 1  ON 10
ci_012                -1.110539e-02 3 1  ON 11
ci_013                 1.008577e-02 3 1  ON 12
ci_014                 1.016019e-02 3 1  ON 13
ci_015                 1.049783e-02 3 1  ON 14
ci_016                 1.114455e-02 3 1  ON 15
ci_017                 8.724977e-03 3 1  ON 16
ci_018                 9.270428e-03 3 1  ON 17
ci_019                 1.450197e-03 3 1  ON 18
ci_020                 1.643883e-03 3 1  ON 19
ci_021                -8.888705e-03 3 1  ON 20
ci_022                -9.979549e-03 3 1  ON 21
ci_023                 5.937994e-03 3 1  ON 22
ci_024                 5.662085e-03 3 1  ON 23
ci_025                 1.184892e-02 3 1  ON 24
ci_026                 1.136703e-02 3 1  ON 25
ci_027                 6.524030e-03 3 1  ON 26
ci_028                 6.679056e-03 3 1  ON 27
ci_029                -4.302751e-03 3 1  ON 28
ci_030                -4.824570e-03 3 1  ON 29
ci_031                 2.099548e-03 3 1  ON 30
ci_032                 1.958108e-03 3 1  ON 31
ci_033                 3.706169e-03 3 1  ON 32
ci_034                 3.877364e-03 3 1  ON 33
ci_035                 2.766743e-03 3 1  ON 34
ci_036                 2.437434e-03 3 1  ON 35
ci_037                 3.547251e-03 3 1  ON 36
ci_038                 3.944923e-03 3 1  ON 37
ci_039                 4.682967e-03 3 1  ON 38
ci_040                 4.656764e-03 3 1  ON 39
ci_041                 2.896592e-03 3 1  ON 40
ci_042                 3.186387e-03 3 1  ON 41
ci_043                 3.831228e-03 3 1  ON 42
ci_044                 3.333662e-03 3 1  ON 43
ci_045                 2.944891e-03 3 1  ON 44
ci_046                 3.239941e-03 3 1  ON 45
ci_047                -1.246573e-03 3 1  ON 46
ci_048                -1.530469e-03 3 1  ON 47
ci_049                 1.178155e-03 3 1  ON 48
ci_050                 1.405829e-03 3 1  ON 49
ci_051                -1.794844e-03 3 1  ON 50
ci_052                -1.952750e-03 3 1  ON 51
ci_053                -2.547936e-03 3 1  ON 52
ci_054                -2.573960e-03 3 1  ON 53
ci_055                -2.075844e-03 3 1  ON 54
ci_056                -1.281927e-03 3 1  ON 55
ci_057                -1.519118e-03 3 1  ON 56
ci_058                -1.160917e-03 3 1  ON 57
ci_059                -4.403807e-04 3 1  ON 58
ci_060                -4.927481e-04 3 1  ON 59
ci_061                -8.346817e-04 3 1  ON 60
ci_062                -7.824771e-04 3 1  ON 61
ci_063                -6.333128e-04 3 1  ON 62
ci_064                -1.136024e-03 3 1  ON 63
ci_065                -1.962516e-03 3 1  ON 64
ci_066                -1.913207e-03 3 1  ON 65
ci_067                -1.372689e-03 3 1  ON 66
ci_068                -1.650104e-03 3 1  ON 67
ci_069                 2.192475e-04 3 1  ON 68
ci_070                 2.835654e-04 3 1  ON 69
ci_071                -1.611080e-03 3 1  ON 70
ci_072                -1.881079e-03 3 1  ON 71
ci_073                 2.231734e-04 3 1  ON 72
ci_074                 3.626238e-04 3 1  ON 73
ci_075                -2.446043e-06 3 1  ON 74
ci_076                 2.920079e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6996
    reference variance = 0.303305
====================================================
  Execution time = 2.7461e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5543e-01
  Total weights = 1.9549e+06
  Execution time = 3.6030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445226152133
                                         uncertainty =       0.002972474729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445226152133
                                         uncertainty =       0.002972474729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471863860
  error estimate for blocks of size 2^( 2) =       0.000495590049
  error estimate for blocks of size 2^( 3) =       0.000517780324
  error estimate for blocks of size 2^( 4) =       0.000534105597
  error estimate for blocks of size 2^( 5) =       0.000543273608
  error estimate for blocks of size 2^( 6) =       0.000547854455
  error estimate for blocks of size 2^( 7) =       0.000550853456

      target function =      -0.740879552743
              le_mean =     -22.662169618627
             les_mean =     514.029366350103
             stat err =       0.000544021779
             autocorr =       1.329226955998
   target nu stat err =       0.000544021779
   target dn stat err =       0.003763651549
      target stat err =       0.003108921149
              std dev =       0.667316271101
             le_variance =       0.445311005676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445203927050
                                         uncertainty =       0.002971052585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445203927050
                                         uncertainty =       0.002971052585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471852045
  error estimate for blocks of size 2^( 2) =       0.000495579985
  error estimate for blocks of size 2^( 3) =       0.000517771520
  error estimate for blocks of size 2^( 4) =       0.000534096577
  error estimate for blocks of size 2^( 5) =       0.000543263658
  error estimate for blocks of size 2^( 6) =       0.000547844408
  error estimate for blocks of size 2^( 7) =       0.000550844843

      target function =      -0.740888806189
              le_mean =     -22.662169962535
             les_mean =     514.029370486040
             stat err =       0.000544012372
             autocorr =       1.329247549964
   target nu stat err =       0.000544012372
   target dn stat err =       0.003768492345
      target stat err =       0.003112849380
              std dev =       0.667299562083
             le_variance =       0.445288705556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445214850117
                                         uncertainty =       0.002971757008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445214850117
                                         uncertainty =       0.002971757008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471857852
  error estimate for blocks of size 2^( 2) =       0.000495584923
  error estimate for blocks of size 2^( 3) =       0.000517775834
  error estimate for blocks of size 2^( 4) =       0.000534101000
  error estimate for blocks of size 2^( 5) =       0.000543268541
  error estimate for blocks of size 2^( 6) =       0.000547849339
  error estimate for blocks of size 2^( 7) =       0.000550849069

      target function =      -0.740885402510
              le_mean =     -22.662169777659
             les_mean =     514.029366323904
             stat err =       0.000544016987
             autocorr =       1.329237388527
   target nu stat err =       0.000544016987
   target dn stat err =       0.003766055102
      target stat err =       0.003110881816
              std dev =       0.667307774470
             le_variance =       0.445299665868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445224724296
                                         uncertainty =       0.002972384483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445224724296
                                         uncertainty =       0.002972384483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471863101
  error estimate for blocks of size 2^( 2) =       0.000495589400
  error estimate for blocks of size 2^( 3) =       0.000517779755
  error estimate for blocks of size 2^( 4) =       0.000534105015
  error estimate for blocks of size 2^( 5) =       0.000543272967
  error estimate for blocks of size 2^( 6) =       0.000547853808
  error estimate for blocks of size 2^( 7) =       0.000550852901

      target function =      -0.740880418415
              le_mean =     -22.662169636934
             les_mean =     514.029366109744
             stat err =       0.000544021173
             autocorr =       1.329228268280
   target nu stat err =       0.000544021173
   target dn stat err =       0.003763948127
      target stat err =       0.003109164249
              std dev =       0.667315197722
             le_variance =       0.445309573111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740879552743        initial
     4.0000e+00     4.0000e+01             8.7930e-05        -0.740888806189  <--
     1.6000e+01     1.6000e+02             2.1997e-05        -0.740885402510
     6.4000e+01     6.4000e+02             5.5001e-06        -0.740880418415

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.5523e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -7.005202e-01 3 1  ON 0
ci_002                -7.069348e-01 3 1  ON 1
ci_003                -5.455390e-02 3 1  ON 2
ci_004                -5.555946e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                 2.164261e-02 3 1  ON 5
ci_007                 1.751761e-02 3 1  ON 6
ci_008                 1.777595e-02 3 1  ON 7
ci_009                -1.333870e-02 3 1  ON 8
ci_010                -1.390086e-02 3 1  ON 9
ci_011                -1.098044e-02 3 1  ON 10
ci_012                -1.108685e-02 3 1  ON 11
ci_013                 1.005220e-02 3 1  ON 12
ci_014                 1.013216e-02 3 1  ON 13
ci_015                 1.046649e-02 3 1  ON 14
ci_016                 1.113119e-02 3 1  ON 15
ci_017                 8.701914e-03 3 1  ON 16
ci_018                 9.265132e-03 3 1  ON 17
ci_019                 1.403725e-03 3 1  ON 18
ci_020                 1.600384e-03 3 1  ON 19
ci_021                -8.919949e-03 3 1  ON 20
ci_022                -9.994158e-03 3 1  ON 21
ci_023                 5.925776e-03 3 1  ON 22
ci_024                 5.650310e-03 3 1  ON 23
ci_025                 1.188926e-02 3 1  ON 24
ci_026                 1.139676e-02 3 1  ON 25
ci_027                 6.521620e-03 3 1  ON 26
ci_028                 6.658344e-03 3 1  ON 27
ci_029                -4.298184e-03 3 1  ON 28
ci_030                -4.816631e-03 3 1  ON 29
ci_031                 2.132214e-03 3 1  ON 30
ci_032                 1.968490e-03 3 1  ON 31
ci_033                 3.691804e-03 3 1  ON 32
ci_034                 3.884336e-03 3 1  ON 33
ci_035                 2.766958e-03 3 1  ON 34
ci_036                 2.430597e-03 3 1  ON 35
ci_037                 3.553229e-03 3 1  ON 36
ci_038                 3.935351e-03 3 1  ON 37
ci_039                 4.694253e-03 3 1  ON 38
ci_040                 4.648592e-03 3 1  ON 39
ci_041                 2.893142e-03 3 1  ON 40
ci_042                 3.182935e-03 3 1  ON 41
ci_043                 3.831345e-03 3 1  ON 42
ci_044                 3.336889e-03 3 1  ON 43
ci_045                 2.954174e-03 3 1  ON 44
ci_046                 3.231757e-03 3 1  ON 45
ci_047                -1.244640e-03 3 1  ON 46
ci_048                -1.518728e-03 3 1  ON 47
ci_049                 1.202381e-03 3 1  ON 48
ci_050                 1.389271e-03 3 1  ON 49
ci_051                -1.784672e-03 3 1  ON 50
ci_052                -1.941000e-03 3 1  ON 51
ci_053                -2.554118e-03 3 1  ON 52
ci_054                -2.576921e-03 3 1  ON 53
ci_055                -2.068167e-03 3 1  ON 54
ci_056                -1.284757e-03 3 1  ON 55
ci_057                -1.507448e-03 3 1  ON 56
ci_058                -1.163754e-03 3 1  ON 57
ci_059                -4.366139e-04 3 1  ON 58
ci_060                -4.940436e-04 3 1  ON 59
ci_061                -8.335248e-04 3 1  ON 60
ci_062                -7.707004e-04 3 1  ON 61
ci_063                -6.354727e-04 3 1  ON 62
ci_064                -1.128497e-03 3 1  ON 63
ci_065                -1.956075e-03 3 1  ON 64
ci_066                -1.922940e-03 3 1  ON 65
ci_067                -1.391044e-03 3 1  ON 66
ci_068                -1.647728e-03 3 1  ON 67
ci_069                 2.187453e-04 3 1  ON 68
ci_070                 3.082669e-04 3 1  ON 69
ci_071                -1.619701e-03 3 1  ON 70
ci_072                -1.875114e-03 3 1  ON 71
ci_073                 2.162183e-04 3 1  ON 72
ci_074                 3.630640e-04 3 1  ON 73
ci_075                -7.817628e-06 3 1  ON 74
ci_076                 3.017161e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6577e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2647e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6255
    reference variance = 0.388965
====================================================
  Execution time = 2.6360e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5377e-01
  Total weights = 1.954914887e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440756270307
                                         uncertainty =       0.002136005793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440756270307
                                         uncertainty =       0.002136005793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469481825
  error estimate for blocks of size 2^( 2) =       0.000493709038
  error estimate for blocks of size 2^( 3) =       0.000516057627
  error estimate for blocks of size 2^( 4) =       0.000531994111
  error estimate for blocks of size 2^( 5) =       0.000541682913
  error estimate for blocks of size 2^( 6) =       0.000546325050
  error estimate for blocks of size 2^( 7) =       0.000547072327

      target function =      -0.742232912425
              le_mean =     -22.662246954097
             les_mean =     514.031210303536
             stat err =       0.000541768600
             autocorr =       1.331649996849
   target nu stat err =       0.000541768600
   target dn stat err =       0.003185660750
      target stat err =       0.002659690805
              std dev =       0.663947564585
             le_variance =       0.440826368518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266224695410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742241505666       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742274697843       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742280507393       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742281271486       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742281447483       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742281600913       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742281658700       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742281661640       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742281668799       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.744070e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742241505666       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742250098215       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742251575630       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742251768444       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742251811945       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742251849705       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742251863419       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742251863992       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742251865716       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 7.054328e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742241505666       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742243673032       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742244043960       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742244092271       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742244103112       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742244112512       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742244115893       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742244116027       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742244116454       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 1.776149e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064135 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1104e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -7.005280e-01 3 1  ON 0
ci_002                -7.069414e-01 3 1  ON 1
ci_003                -5.451564e-02 3 1  ON 2
ci_004                -5.552297e-02 3 1  ON 3
ci_005                 2.151088e-02 3 1  ON 4
ci_006                 2.159791e-02 3 1  ON 5
ci_007                 1.749697e-02 3 1  ON 6
ci_008                 1.773343e-02 3 1  ON 7
ci_009                -1.331260e-02 3 1  ON 8
ci_010                -1.389652e-02 3 1  ON 9
ci_011                -1.095574e-02 3 1  ON 10
ci_012                -1.104086e-02 3 1  ON 11
ci_013                 1.002219e-02 3 1  ON 12
ci_014                 1.011695e-02 3 1  ON 13
ci_015                 1.043124e-02 3 1  ON 14
ci_016                 1.109973e-02 3 1  ON 15
ci_017                 8.690714e-03 3 1  ON 16
ci_018                 9.240654e-03 3 1  ON 17
ci_019                 1.333181e-03 3 1  ON 18
ci_020                 1.545979e-03 3 1  ON 19
ci_021                -8.941292e-03 3 1  ON 20
ci_022                -1.000514e-02 3 1  ON 21
ci_023                 5.922957e-03 3 1  ON 22
ci_024                 5.641059e-03 3 1  ON 23
ci_025                 1.190271e-02 3 1  ON 24
ci_026                 1.140442e-02 3 1  ON 25
ci_027                 6.524698e-03 3 1  ON 26
ci_028                 6.651468e-03 3 1  ON 27
ci_029                -4.287392e-03 3 1  ON 28
ci_030                -4.805946e-03 3 1  ON 29
ci_031                 2.178157e-03 3 1  ON 30
ci_032                 2.007430e-03 3 1  ON 31
ci_033                 3.680226e-03 3 1  ON 32
ci_034                 3.873368e-03 3 1  ON 33
ci_035                 2.749389e-03 3 1  ON 34
ci_036                 2.421417e-03 3 1  ON 35
ci_037                 3.542277e-03 3 1  ON 36
ci_038                 3.902943e-03 3 1  ON 37
ci_039                 4.681084e-03 3 1  ON 38
ci_040                 4.641149e-03 3 1  ON 39
ci_041                 2.893245e-03 3 1  ON 40
ci_042                 3.171259e-03 3 1  ON 41
ci_043                 3.809013e-03 3 1  ON 42
ci_044                 3.341949e-03 3 1  ON 43
ci_045                 2.955344e-03 3 1  ON 44
ci_046                 3.218466e-03 3 1  ON 45
ci_047                -1.246040e-03 3 1  ON 46
ci_048                -1.512336e-03 3 1  ON 47
ci_049                 1.197542e-03 3 1  ON 48
ci_050                 1.371245e-03 3 1  ON 49
ci_051                -1.784118e-03 3 1  ON 50
ci_052                -1.937997e-03 3 1  ON 51
ci_053                -2.561433e-03 3 1  ON 52
ci_054                -2.578195e-03 3 1  ON 53
ci_055                -2.069634e-03 3 1  ON 54
ci_056                -1.290729e-03 3 1  ON 55
ci_057                -1.512456e-03 3 1  ON 56
ci_058                -1.156006e-03 3 1  ON 57
ci_059                -4.382248e-04 3 1  ON 58
ci_060                -4.914712e-04 3 1  ON 59
ci_061                -8.304714e-04 3 1  ON 60
ci_062                -7.595301e-04 3 1  ON 61
ci_063                -6.498099e-04 3 1  ON 62
ci_064                -1.122364e-03 3 1  ON 63
ci_065                -1.940068e-03 3 1  ON 64
ci_066                -1.919625e-03 3 1  ON 65
ci_067                -1.382740e-03 3 1  ON 66
ci_068                -1.659754e-03 3 1  ON 67
ci_069                 2.202638e-04 3 1  ON 68
ci_070                 2.996047e-04 3 1  ON 69
ci_071                -1.620560e-03 3 1  ON 70
ci_072                -1.887512e-03 3 1  ON 71
ci_073                 2.276309e-04 3 1  ON 72
ci_074                 3.535836e-04 3 1  ON 73
ci_075                -3.935080e-06 3 1  ON 74
ci_076                 2.902469e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.699
    reference variance = 0.385677
====================================================
  Execution time = 2.5629e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5074e-01
  Total weights = 1.9552e+06
  Execution time = 3.6092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441352559912
                                         uncertainty =       0.002758157239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441352559912
                                         uncertainty =       0.002758157239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469725415
  error estimate for blocks of size 2^( 2) =       0.000493619730
  error estimate for blocks of size 2^( 3) =       0.000515882107
  error estimate for blocks of size 2^( 4) =       0.000531764584
  error estimate for blocks of size 2^( 5) =       0.000541943642
  error estimate for blocks of size 2^( 6) =       0.000546132658
  error estimate for blocks of size 2^( 7) =       0.000549636873

      target function =      -0.744616013336
              le_mean =     -22.662379695707
             les_mean =     514.034310134092
             stat err =       0.000542369439
             autocorr =       1.333221482680
   target nu stat err =       0.000542369439
   target dn stat err =       0.003059930553
      target stat err =       0.002576735388
              std dev =       0.664292052882
             le_variance =       0.441283931522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441248570038
                                         uncertainty =       0.002759864816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441248570038
                                         uncertainty =       0.002759864816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469670076
  error estimate for blocks of size 2^( 2) =       0.000493572817
  error estimate for blocks of size 2^( 3) =       0.000515842951
  error estimate for blocks of size 2^( 4) =       0.000531728605
  error estimate for blocks of size 2^( 5) =       0.000541910450
  error estimate for blocks of size 2^( 6) =       0.000546093217
  error estimate for blocks of size 2^( 7) =       0.000549603922

      target function =      -0.744794307637
              le_mean =     -22.662378638945
             les_mean =     514.034044644391
             stat err =       0.000542334049
             autocorr =       1.333361650327
   target nu stat err =       0.000542334049
   target dn stat err =       0.003057594804
      target stat err =       0.002576061027
              std dev =       0.664213791424
             le_variance =       0.441179960718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441297766414
                                         uncertainty =       0.002759019689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441297766414
                                         uncertainty =       0.002759019689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469696257
  error estimate for blocks of size 2^( 2) =       0.000493594934
  error estimate for blocks of size 2^( 3) =       0.000515861330
  error estimate for blocks of size 2^( 4) =       0.000531745449
  error estimate for blocks of size 2^( 5) =       0.000541925963
  error estimate for blocks of size 2^( 6) =       0.000546111750
  error estimate for blocks of size 2^( 7) =       0.000549619285

      target function =      -0.744748197635
              le_mean =     -22.662378965343
             les_mean =     514.034115703131
             stat err =       0.000542350612
             autocorr =       1.333294444083
   target nu stat err =       0.000542350612
   target dn stat err =       0.003058042560
      target stat err =       0.002576113049
              std dev =       0.664250817357
             le_variance =       0.441229148360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441345512403
                                         uncertainty =       0.002758262918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441345512403
                                         uncertainty =       0.002758262918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469721665
  error estimate for blocks of size 2^( 2) =       0.000493616528
  error estimate for blocks of size 2^( 3) =       0.000515879410
  error estimate for blocks of size 2^( 4) =       0.000531762092
  error estimate for blocks of size 2^( 5) =       0.000541941332
  error estimate for blocks of size 2^( 6) =       0.000546129949
  error estimate for blocks of size 2^( 7) =       0.000549634575

      target function =      -0.744668601972
              le_mean =     -22.662379578808
             les_mean =     514.034240647876
             stat err =       0.000542366987
             autocorr =       1.333230714239
   target nu stat err =       0.000542366987
   target dn stat err =       0.003059182224
      target stat err =       0.002576492075
              std dev =       0.664286749394
             le_variance =       0.441276885420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744616013336        initial
     1.0000e+00     1.0000e+01             2.7441e-04        -0.744794307637  <--
     4.0000e+00     4.0000e+01             7.0543e-05        -0.744748197635
     1.6000e+01     1.6000e+02             1.7761e-05        -0.744668601972

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3665e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -7.005509e-01 3 1  ON 0
ci_002                -7.069604e-01 3 1  ON 1
ci_003                -5.440270e-02 3 1  ON 2
ci_004                -5.541532e-02 3 1  ON 3
ci_005                 2.137672e-02 3 1  ON 4
ci_006                 2.147029e-02 3 1  ON 5
ci_007                 1.743778e-02 3 1  ON 6
ci_008                 1.761116e-02 3 1  ON 7
ci_009                -1.323763e-02 3 1  ON 8
ci_010                -1.388428e-02 3 1  ON 9
ci_011                -1.088469e-02 3 1  ON 10
ci_012                -1.090855e-02 3 1  ON 11
ci_013                 9.935783e-03 3 1  ON 12
ci_014                 1.007331e-02 3 1  ON 13
ci_015                 1.032952e-02 3 1  ON 14
ci_016                 1.100880e-02 3 1  ON 15
ci_017                 8.658615e-03 3 1  ON 16
ci_018                 9.170290e-03 3 1  ON 17
ci_019                 1.129318e-03 3 1  ON 18
ci_020                 1.388789e-03 3 1  ON 19
ci_021                -9.002942e-03 3 1  ON 20
ci_022                -1.003688e-02 3 1  ON 21
ci_023                 5.914888e-03 3 1  ON 22
ci_024                 5.614606e-03 3 1  ON 23
ci_025                 1.194198e-02 3 1  ON 24
ci_026                 1.142663e-02 3 1  ON 25
ci_027                 6.533471e-03 3 1  ON 26
ci_028                 6.631879e-03 3 1  ON 27
ci_029                -4.256412e-03 3 1  ON 28
ci_030                -4.775150e-03 3 1  ON 29
ci_031                 2.310912e-03 3 1  ON 30
ci_032                 2.119953e-03 3 1  ON 31
ci_033                 3.646841e-03 3 1  ON 32
ci_034                 3.841885e-03 3 1  ON 33
ci_035                 2.699126e-03 3 1  ON 34
ci_036                 2.395064e-03 3 1  ON 35
ci_037                 3.510669e-03 3 1  ON 36
ci_038                 3.809559e-03 3 1  ON 37
ci_039                 4.643524e-03 3 1  ON 38
ci_040                 4.619994e-03 3 1  ON 39
ci_041                 2.893548e-03 3 1  ON 40
ci_042                 3.137840e-03 3 1  ON 41
ci_043                 3.744907e-03 3 1  ON 42
ci_044                 3.356426e-03 3 1  ON 43
ci_045                 2.958818e-03 3 1  ON 44
ci_046                 3.180364e-03 3 1  ON 45
ci_047                -1.249983e-03 3 1  ON 46
ci_048                -1.494067e-03 3 1  ON 47
ci_049                 1.183661e-03 3 1  ON 48
ci_050                 1.319477e-03 3 1  ON 49
ci_051                -1.782467e-03 3 1  ON 50
ci_052                -1.929094e-03 3 1  ON 51
ci_053                -2.582816e-03 3 1  ON 52
ci_054                -2.582121e-03 3 1  ON 53
ci_055                -2.073935e-03 3 1  ON 54
ci_056                -1.307837e-03 3 1  ON 55
ci_057                -1.526747e-03 3 1  ON 56
ci_058                -1.133797e-03 3 1  ON 57
ci_059                -4.428136e-04 3 1  ON 58
ci_060                -4.840453e-04 3 1  ON 59
ci_061                -8.216310e-04 3 1  ON 60
ci_062                -7.272199e-04 3 1  ON 61
ci_063                -6.911913e-04 3 1  ON 62
ci_064                -1.104789e-03 3 1  ON 63
ci_065                -1.893979e-03 3 1  ON 64
ci_066                -1.910102e-03 3 1  ON 65
ci_067                -1.358885e-03 3 1  ON 66
ci_068                -1.694579e-03 3 1  ON 67
ci_069                 2.246606e-04 3 1  ON 68
ci_070                 2.746950e-04 3 1  ON 69
ci_071                -1.623042e-03 3 1  ON 70
ci_072                -1.923047e-03 3 1  ON 71
ci_073                 2.601343e-04 3 1  ON 72
ci_074                 3.265095e-04 3 1  ON 73
ci_075                 7.340709e-06 3 1  ON 74
ci_076                 2.573408e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4774e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2648e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6832
    reference variance = 0.339212
====================================================
  Execution time = 2.6182e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5621e-01
  Total weights = 1.954864160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441596934933
                                         uncertainty =       0.002990885599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441596934933
                                         uncertainty =       0.002990885599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469863191
  error estimate for blocks of size 2^( 2) =       0.000493513619
  error estimate for blocks of size 2^( 3) =       0.000516038913
  error estimate for blocks of size 2^( 4) =       0.000532312146
  error estimate for blocks of size 2^( 5) =       0.000542519994
  error estimate for blocks of size 2^( 6) =       0.000548407282
  error estimate for blocks of size 2^( 7) =       0.000552963600

      target function =      -0.740232999886
              le_mean =     -22.662660579582
             les_mean =     514.052397911230
             stat err =       0.000544050756
             autocorr =       1.340713514687
   target nu stat err =       0.000544050756
   target dn stat err =       0.005749845748
      target stat err =       0.004694941608
              std dev =       0.664486897848
             le_variance =       0.441542837412


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266266057958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740261918236       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740433536199       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740458617848       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740460502176       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740460671783       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740462572991       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740464743370       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740465273861       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740465013674       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740465363310       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740465460205       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740465458133       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.488889e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740261918236       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740310866512       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740317597031       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740318025312       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740318054836       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740318553353       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740319025031       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740319120782       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740319058961       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740319138382       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740319153117       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740319151548       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.753553e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740261918236       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740274601841       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740276314301       residual = 9.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740276417437       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740276424087       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740276550201       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740276663060       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740276684624       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740276669516       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740276688783       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740276691920       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740276691484       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 9.406823e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0973e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -7.009263e-01 3 1  ON 0
ci_002                -7.066364e-01 3 1  ON 1
ci_003                -5.425399e-02 3 1  ON 2
ci_004                -5.534771e-02 3 1  ON 3
ci_005                 2.113916e-02 3 1  ON 4
ci_006                 2.132585e-02 3 1  ON 5
ci_007                 1.742314e-02 3 1  ON 6
ci_008                 1.745108e-02 3 1  ON 7
ci_009                -1.314421e-02 3 1  ON 8
ci_010                -1.372559e-02 3 1  ON 9
ci_011                -1.079224e-02 3 1  ON 10
ci_012                -1.082782e-02 3 1  ON 11
ci_013                 9.899629e-03 3 1  ON 12
ci_014                 1.004760e-02 3 1  ON 13
ci_015                 1.024652e-02 3 1  ON 14
ci_016                 1.087948e-02 3 1  ON 15
ci_017                 8.616968e-03 3 1  ON 16
ci_018                 9.128461e-03 3 1  ON 17
ci_019                 9.584381e-04 3 1  ON 18
ci_020                 1.179970e-03 3 1  ON 19
ci_021                -9.050892e-03 3 1  ON 20
ci_022                -9.927235e-03 3 1  ON 21
ci_023                 5.945039e-03 3 1  ON 22
ci_024                 5.543094e-03 3 1  ON 23
ci_025                 1.206829e-02 3 1  ON 24
ci_026                 1.151524e-02 3 1  ON 25
ci_027                 6.406798e-03 3 1  ON 26
ci_028                 6.604474e-03 3 1  ON 27
ci_029                -4.176050e-03 3 1  ON 28
ci_030                -4.770130e-03 3 1  ON 29
ci_031                 2.417780e-03 3 1  ON 30
ci_032                 2.145188e-03 3 1  ON 31
ci_033                 3.619288e-03 3 1  ON 32
ci_034                 3.743607e-03 3 1  ON 33
ci_035                 2.698401e-03 3 1  ON 34
ci_036                 2.324079e-03 3 1  ON 35
ci_037                 3.544797e-03 3 1  ON 36
ci_038                 3.726507e-03 3 1  ON 37
ci_039                 4.595820e-03 3 1  ON 38
ci_040                 4.515126e-03 3 1  ON 39
ci_041                 2.882335e-03 3 1  ON 40
ci_042                 3.262017e-03 3 1  ON 41
ci_043                 3.832377e-03 3 1  ON 42
ci_044                 3.345327e-03 3 1  ON 43
ci_045                 2.967466e-03 3 1  ON 44
ci_046                 3.128160e-03 3 1  ON 45
ci_047                -1.174261e-03 3 1  ON 46
ci_048                -1.471526e-03 3 1  ON 47
ci_049                 1.122106e-03 3 1  ON 48
ci_050                 1.221830e-03 3 1  ON 49
ci_051                -1.747489e-03 3 1  ON 50
ci_052                -1.894206e-03 3 1  ON 51
ci_053                -2.528601e-03 3 1  ON 52
ci_054                -2.655332e-03 3 1  ON 53
ci_055                -2.164200e-03 3 1  ON 54
ci_056                -1.261466e-03 3 1  ON 55
ci_057                -1.460473e-03 3 1  ON 56
ci_058                -1.078088e-03 3 1  ON 57
ci_059                -5.011733e-04 3 1  ON 58
ci_060                -4.821475e-04 3 1  ON 59
ci_061                -5.949407e-04 3 1  ON 60
ci_062                -7.224805e-04 3 1  ON 61
ci_063                -6.551581e-04 3 1  ON 62
ci_064                -1.089675e-03 3 1  ON 63
ci_065                -1.941124e-03 3 1  ON 64
ci_066                -1.901593e-03 3 1  ON 65
ci_067                -1.272657e-03 3 1  ON 66
ci_068                -1.641456e-03 3 1  ON 67
ci_069                 2.368520e-04 3 1  ON 68
ci_070                 2.723409e-04 3 1  ON 69
ci_071                -1.589979e-03 3 1  ON 70
ci_072                -1.918355e-03 3 1  ON 71
ci_073                 2.025760e-04 3 1  ON 72
ci_074                 2.937485e-04 3 1  ON 73
ci_075                 2.829554e-05 3 1  ON 74
ci_076                 2.917706e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6672
    reference variance = 0.499273
====================================================
  Execution time = 2.5548e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5173e-01
  Total weights = 1.9554e+06
  Execution time = 3.6097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441804428721
                                         uncertainty =       0.002415847527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441804428721
                                         uncertainty =       0.002415847527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469974898
  error estimate for blocks of size 2^( 2) =       0.000494190553
  error estimate for blocks of size 2^( 3) =       0.000516982892
  error estimate for blocks of size 2^( 4) =       0.000533598973
  error estimate for blocks of size 2^( 5) =       0.000542995291
  error estimate for blocks of size 2^( 6) =       0.000548399784
  error estimate for blocks of size 2^( 7) =       0.000549805915

      target function =      -0.737620778322
              le_mean =     -22.661451896586
             les_mean =     514.000835175133
             stat err =       0.000543699991
             autocorr =       1.338348840832
   target nu stat err =       0.000543699991
   target dn stat err =       0.007107625568
      target stat err =       0.005736738752
              std dev =       0.664644874385
             le_variance =       0.441752809046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441482276992
                                         uncertainty =       0.002389419143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441482276992
                                         uncertainty =       0.002389419143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469803922
  error estimate for blocks of size 2^( 2) =       0.000494058375
  error estimate for blocks of size 2^( 3) =       0.000516875288
  error estimate for blocks of size 2^( 4) =       0.000533503441
  error estimate for blocks of size 2^( 5) =       0.000542903119
  error estimate for blocks of size 2^( 6) =       0.000548311400
  error estimate for blocks of size 2^( 7) =       0.000549726175

      target function =      -0.728828192358
              le_mean =     -22.661448669001
             les_mean =     514.011490814462
             stat err =       0.000543611034
             autocorr =       1.338884921422
   target nu stat err =       0.000543611034
   target dn stat err =       0.017733355110
      target stat err =       0.013915737234
              std dev =       0.664403077691
             le_variance =       0.441431449646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441594639471
                                         uncertainty =       0.002401092962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441594639471
                                         uncertainty =       0.002401092962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469863544
  error estimate for blocks of size 2^( 2) =       0.000494100485
  error estimate for blocks of size 2^( 3) =       0.000516906125
  error estimate for blocks of size 2^( 4) =       0.000533531298
  error estimate for blocks of size 2^( 5) =       0.000542933142
  error estimate for blocks of size 2^( 6) =       0.000548334675
  error estimate for blocks of size 2^( 7) =       0.000549737609

      target function =      -0.743419072562
              le_mean =     -22.661449744608
             les_mean =     513.993615260974
             stat err =       0.000543634181
             autocorr =       1.338659148313
   target nu stat err =       0.000543634181
   target dn stat err =       0.003137212551
      target stat err =       0.002626813565
              std dev =       0.664487396484
             le_variance =       0.441543500086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441774304074
                                         uncertainty =       0.002413865357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441774304074
                                         uncertainty =       0.002413865357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469958907
  error estimate for blocks of size 2^( 2) =       0.000494177306
  error estimate for blocks of size 2^( 3) =       0.000516971538
  error estimate for blocks of size 2^( 4) =       0.000533589268
  error estimate for blocks of size 2^( 5) =       0.000542987211
  error estimate for blocks of size 2^( 6) =       0.000548390216
  error estimate for blocks of size 2^( 7) =       0.000549795457

      target function =      -0.743732533685
              le_mean =     -22.661451656081
             les_mean =     513.993317764151
             stat err =       0.000543690538
             autocorr =       1.338393381150
   target nu stat err =       0.000543690538
   target dn stat err =       0.003122202219
      target stat err =       0.002617063909
              std dev =       0.664622259556
             le_variance =       0.441722747897


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737620778322        initial
     2.5000e-01     2.5000e+00             1.4889e-03        -0.728828192358
     1.0000e+00     1.0000e+01             3.7536e-04        -0.743419072562
     4.0000e+00     4.0000e+01             9.4068e-05        -0.743732533685  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3605e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -7.006450e-01 3 1  ON 0
ci_002                -7.068795e-01 3 1  ON 1
ci_003                -5.436506e-02 3 1  ON 2
ci_004                -5.539827e-02 3 1  ON 3
ci_005                 2.131501e-02 3 1  ON 4
ci_006                 2.143291e-02 3 1  ON 5
ci_007                 1.743394e-02 3 1  ON 6
ci_008                 1.756991e-02 3 1  ON 7
ci_009                -1.321349e-02 3 1  ON 8
ci_010                -1.384330e-02 3 1  ON 9
ci_011                -1.086076e-02 3 1  ON 10
ci_012                -1.088781e-02 3 1  ON 11
ci_013                 9.926359e-03 3 1  ON 12
ci_014                 1.006665e-02 3 1  ON 13
ci_015                 1.030816e-02 3 1  ON 14
ci_016                 1.097548e-02 3 1  ON 15
ci_017                 8.647862e-03 3 1  ON 16
ci_018                 9.159506e-03 3 1  ON 17
ci_019                 1.085375e-03 3 1  ON 18
ci_020                 1.335141e-03 3 1  ON 19
ci_021                -9.015230e-03 3 1  ON 20
ci_022                -1.000868e-02 3 1  ON 21
ci_023                 5.922653e-03 3 1  ON 22
ci_024                 5.596121e-03 3 1  ON 23
ci_025                 1.197436e-02 3 1  ON 24
ci_026                 1.144943e-02 3 1  ON 25
ci_027                 6.500557e-03 3 1  ON 26
ci_028                 6.624764e-03 3 1  ON 27
ci_029                -4.235750e-03 3 1  ON 28
ci_030                -4.773948e-03 3 1  ON 29
ci_031                 2.338339e-03 3 1  ON 30
ci_032                 2.126466e-03 3 1  ON 31
ci_033                 3.639754e-03 3 1  ON 32
ci_034                 3.816580e-03 3 1  ON 33
ci_035                 2.698967e-03 3 1  ON 34
ci_036                 2.376634e-03 3 1  ON 35
ci_037                 3.519396e-03 3 1  ON 36
ci_038                 3.788147e-03 3 1  ON 37
ci_039                 4.631093e-03 3 1  ON 38
ci_040                 4.592794e-03 3 1  ON 39
ci_041                 2.890608e-03 3 1  ON 40
ci_042                 3.170062e-03 3 1  ON 41
ci_043                 3.767511e-03 3 1  ON 42
ci_044                 3.353635e-03 3 1  ON 43
ci_045                 2.961050e-03 3 1  ON 44
ci_046                 3.166868e-03 3 1  ON 45
ci_047                -1.230352e-03 3 1  ON 46
ci_048                -1.488233e-03 3 1  ON 47
ci_049                 1.167789e-03 3 1  ON 48
ci_050                 1.294215e-03 3 1  ON 49
ci_051                -1.773440e-03 3 1  ON 50
ci_052                -1.920123e-03 3 1  ON 51
ci_053                -2.568825e-03 3 1  ON 52
ci_054                -2.600975e-03 3 1  ON 53
ci_055                -2.097145e-03 3 1  ON 54
ci_056                -1.295960e-03 3 1  ON 55
ci_057                -1.509602e-03 3 1  ON 56
ci_058                -1.119379e-03 3 1  ON 57
ci_059                -4.579804e-04 3 1  ON 58
ci_060                -4.835723e-04 3 1  ON 59
ci_061                -7.631509e-04 3 1  ON 60
ci_062                -7.260529e-04 3 1  ON 61
ci_063                -6.818805e-04 3 1  ON 62
ci_064                -1.100911e-03 3 1  ON 63
ci_065                -1.906124e-03 3 1  ON 64
ci_066                -1.907964e-03 3 1  ON 65
ci_067                -1.336683e-03 3 1  ON 66
ci_068                -1.680892e-03 3 1  ON 67
ci_069                 2.277991e-04 3 1  ON 68
ci_070                 2.740772e-04 3 1  ON 69
ci_071                -1.614520e-03 3 1  ON 70
ci_072                -1.921865e-03 3 1  ON 71
ci_073                 2.451624e-04 3 1  ON 72
ci_074                 3.180399e-04 3 1  ON 73
ci_075                 1.276399e-05 3 1  ON 74
ci_076                 2.662664e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.5941
    reference variance = 0.338556
====================================================
  Execution time = 2.6051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5016e-01
  Total weights = 1.954564134e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440395795144
                                         uncertainty =       0.002686948960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440395795144
                                         uncertainty =       0.002686948960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469267685
  error estimate for blocks of size 2^( 2) =       0.000493322388
  error estimate for blocks of size 2^( 3) =       0.000515144941
  error estimate for blocks of size 2^( 4) =       0.000530596410
  error estimate for blocks of size 2^( 5) =       0.000540115009
  error estimate for blocks of size 2^( 6) =       0.000545631173
  error estimate for blocks of size 2^( 7) =       0.000546662299

      target function =      -0.745184336658
              le_mean =     -22.662341104836
             les_mean =     514.031866279973
             stat err =       0.000540751223
             autocorr =       1.327864386906
   target nu stat err =       0.000540751223
   target dn stat err =       0.003202110571
      target stat err =       0.002693640721
              std dev =       0.663644724315
             le_variance =       0.440424320111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266234110484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745193096820       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745230922007       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745236195422       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745236663357       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745237125404       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745237361735       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745237566282       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745237636858       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745237639894       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745237640453       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745237638813       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745237641403       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.942096e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745193096820       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745202903146       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745204245212       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745204361361       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745204477622       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745204535531       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745204584452       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745204600952       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745204601563       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745204601659       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745204601239       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745204601812       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 7.568478e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745193096820       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745195571298       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745195908306       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745195937281       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745195966390       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745195980788       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745195992877       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745195996931       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745195997075       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745195997096       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745195996991       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745195997129       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 1.905938e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073852 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0809e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -7.007100e-01 3 1  ON 0
ci_002                -7.068242e-01 3 1  ON 1
ci_003                -5.433950e-02 3 1  ON 2
ci_004                -5.541071e-02 3 1  ON 3
ci_005                 2.127353e-02 3 1  ON 4
ci_006                 2.138287e-02 3 1  ON 5
ci_007                 1.740410e-02 3 1  ON 6
ci_008                 1.753676e-02 3 1  ON 7
ci_009                -1.320336e-02 3 1  ON 8
ci_010                -1.382365e-02 3 1  ON 9
ci_011                -1.083793e-02 3 1  ON 10
ci_012                -1.087609e-02 3 1  ON 11
ci_013                 9.901426e-03 3 1  ON 12
ci_014                 1.006601e-02 3 1  ON 13
ci_015                 1.029328e-02 3 1  ON 14
ci_016                 1.094133e-02 3 1  ON 15
ci_017                 8.631551e-03 3 1  ON 16
ci_018                 9.146766e-03 3 1  ON 17
ci_019                 1.009691e-03 3 1  ON 18
ci_020                 1.281614e-03 3 1  ON 19
ci_021                -9.048547e-03 3 1  ON 20
ci_022                -1.003544e-02 3 1  ON 21
ci_023                 5.912571e-03 3 1  ON 22
ci_024                 5.553280e-03 3 1  ON 23
ci_025                 1.197435e-02 3 1  ON 24
ci_026                 1.144118e-02 3 1  ON 25
ci_027                 6.497455e-03 3 1  ON 26
ci_028                 6.607524e-03 3 1  ON 27
ci_029                -4.194909e-03 3 1  ON 28
ci_030                -4.767857e-03 3 1  ON 29
ci_031                 2.352022e-03 3 1  ON 30
ci_032                 2.174352e-03 3 1  ON 31
ci_033                 3.642827e-03 3 1  ON 32
ci_034                 3.794863e-03 3 1  ON 33
ci_035                 2.699979e-03 3 1  ON 34
ci_036                 2.367883e-03 3 1  ON 35
ci_037                 3.527576e-03 3 1  ON 36
ci_038                 3.792885e-03 3 1  ON 37
ci_039                 4.602401e-03 3 1  ON 38
ci_040                 4.588098e-03 3 1  ON 39
ci_041                 2.885601e-03 3 1  ON 40
ci_042                 3.166564e-03 3 1  ON 41
ci_043                 3.742248e-03 3 1  ON 42
ci_044                 3.352137e-03 3 1  ON 43
ci_045                 2.937861e-03 3 1  ON 44
ci_046                 3.167323e-03 3 1  ON 45
ci_047                -1.240694e-03 3 1  ON 46
ci_048                -1.475904e-03 3 1  ON 47
ci_049                 1.154213e-03 3 1  ON 48
ci_050                 1.291906e-03 3 1  ON 49
ci_051                -1.772307e-03 3 1  ON 50
ci_052                -1.914476e-03 3 1  ON 51
ci_053                -2.559743e-03 3 1  ON 52
ci_054                -2.599189e-03 3 1  ON 53
ci_055                -2.077713e-03 3 1  ON 54
ci_056                -1.296709e-03 3 1  ON 55
ci_057                -1.486165e-03 3 1  ON 56
ci_058                -1.126783e-03 3 1  ON 57
ci_059                -4.717948e-04 3 1  ON 58
ci_060                -5.011590e-04 3 1  ON 59
ci_061                -7.537317e-04 3 1  ON 60
ci_062                -7.253170e-04 3 1  ON 61
ci_063                -6.801800e-04 3 1  ON 62
ci_064                -1.086270e-03 3 1  ON 63
ci_065                -1.879139e-03 3 1  ON 64
ci_066                -1.895171e-03 3 1  ON 65
ci_067                -1.333657e-03 3 1  ON 66
ci_068                -1.661998e-03 3 1  ON 67
ci_069                 2.428763e-04 3 1  ON 68
ci_070                 2.740380e-04 3 1  ON 69
ci_071                -1.600687e-03 3 1  ON 70
ci_072                -1.910654e-03 3 1  ON 71
ci_073                 2.336276e-04 3 1  ON 72
ci_074                 3.217316e-04 3 1  ON 73
ci_075                 1.513286e-05 3 1  ON 74
ci_076                 2.509509e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7276
    reference variance = 0.403441
====================================================
  Execution time = 2.5202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5031e-01
  Total weights = 1.9550e+06
  Execution time = 3.5892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436161804055
                                         uncertainty =       0.001669485077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436161804055
                                         uncertainty =       0.001669485077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466970366
  error estimate for blocks of size 2^( 2) =       0.000491357144
  error estimate for blocks of size 2^( 3) =       0.000514008620
  error estimate for blocks of size 2^( 4) =       0.000530624314
  error estimate for blocks of size 2^( 5) =       0.000540216133
  error estimate for blocks of size 2^( 6) =       0.000546878573
  error estimate for blocks of size 2^( 7) =       0.000548597588

      target function =      -0.744266243226
              le_mean =     -22.661743705534
             les_mean =     514.005876094696
             stat err =       0.000541579152
             autocorr =       1.345071075022
   target nu stat err =       0.000541579152
   target dn stat err =       0.005928017773
      target stat err =       0.004883650815
              std dev =       0.660395825129
             le_variance =       0.436122645848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436050529902
                                         uncertainty =       0.001671400912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436050529902
                                         uncertainty =       0.001671400912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466910817
  error estimate for blocks of size 2^( 2) =       0.000491307420
  error estimate for blocks of size 2^( 3) =       0.000513968031
  error estimate for blocks of size 2^( 4) =       0.000530589070
  error estimate for blocks of size 2^( 5) =       0.000540183938
  error estimate for blocks of size 2^( 6) =       0.000546845836
  error estimate for blocks of size 2^( 7) =       0.000548560278

      target function =      -0.745422488367
              le_mean =     -22.661743104589
             les_mean =     514.004442973341
             stat err =       0.000541544781
             autocorr =       1.345243425859
   target nu stat err =       0.000541544781
   target dn stat err =       0.005440685483
      target stat err =       0.004502191703
              std dev =       0.660311609661
             le_variance =       0.436011421853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436102385491
                                         uncertainty =       0.001670412642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436102385491
                                         uncertainty =       0.001670412642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466938569
  error estimate for blocks of size 2^( 2) =       0.000491330423
  error estimate for blocks of size 2^( 3) =       0.000513986647
  error estimate for blocks of size 2^( 4) =       0.000530605192
  error estimate for blocks of size 2^( 5) =       0.000540198614
  error estimate for blocks of size 2^( 6) =       0.000546860625
  error estimate for blocks of size 2^( 7) =       0.000548577390

      target function =      -0.745223730080
              le_mean =     -22.661743169257
             les_mean =     514.004685739055
             stat err =       0.000541560455
             autocorr =       1.345161389509
   target nu stat err =       0.000541560455
   target dn stat err =       0.005651194252
      target stat err =       0.004670937104
              std dev =       0.660350857038
             le_variance =       0.436063254390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436154069275
                                         uncertainty =       0.001669594829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436154069275
                                         uncertainty =       0.001669594829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466966227
  error estimate for blocks of size 2^( 2) =       0.000491353643
  error estimate for blocks of size 2^( 3) =       0.000514005724
  error estimate for blocks of size 2^( 4) =       0.000530621814
  error estimate for blocks of size 2^( 5) =       0.000540213844
  error estimate for blocks of size 2^( 6) =       0.000546876135
  error estimate for blocks of size 2^( 7) =       0.000548594903

      target function =      -0.744723694066
              le_mean =     -22.661743587230
             les_mean =     514.005312304623
             stat err =       0.000541576674
             autocorr =       1.345082610091
   target nu stat err =       0.000541576674
   target dn stat err =       0.005871992500
      target stat err =       0.004844083617
              std dev =       0.660389971625
             le_variance =       0.436114914623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744266243226        initial
     1.0000e+00     1.0000e+01             2.9421e-04        -0.745422488367  <--
     4.0000e+00     4.0000e+01             7.5685e-05        -0.745223730080
     1.6000e+01     1.6000e+02             1.9059e-05        -0.744723694066

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3242e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -7.009042e-01 3 1  ON 0
ci_002                -7.066579e-01 3 1  ON 1
ci_003                -5.426435e-02 3 1  ON 2
ci_004                -5.544740e-02 3 1  ON 3
ci_005                 2.115537e-02 3 1  ON 4
ci_006                 2.123972e-02 3 1  ON 5
ci_007                 1.731845e-02 3 1  ON 6
ci_008                 1.744109e-02 3 1  ON 7
ci_009                -1.317421e-02 3 1  ON 8
ci_010                -1.376714e-02 3 1  ON 9
ci_011                -1.077235e-02 3 1  ON 10
ci_012                -1.084239e-02 3 1  ON 11
ci_013                 9.829993e-03 3 1  ON 12
ci_014                 1.006432e-02 3 1  ON 13
ci_015                 1.025028e-02 3 1  ON 14
ci_016                 1.084261e-02 3 1  ON 15
ci_017                 8.584765e-03 3 1  ON 16
ci_018                 9.110231e-03 3 1  ON 17
ci_019                 7.911658e-04 3 1  ON 18
ci_020                 1.127204e-03 3 1  ON 19
ci_021                -9.144641e-03 3 1  ON 20
ci_022                -1.011253e-02 3 1  ON 21
ci_023                 5.883835e-03 3 1  ON 22
ci_024                 5.431037e-03 3 1  ON 23
ci_025                 1.197507e-02 3 1  ON 24
ci_026                 1.141771e-02 3 1  ON 25
ci_027                 6.488663e-03 3 1  ON 26
ci_028                 6.558324e-03 3 1  ON 27
ci_029                -4.077790e-03 3 1  ON 28
ci_030                -4.750246e-03 3 1  ON 29
ci_031                 2.391768e-03 3 1  ON 30
ci_032                 2.312637e-03 3 1  ON 31
ci_033                 3.651729e-03 3 1  ON 32
ci_034                 3.732533e-03 3 1  ON 33
ci_035                 2.702614e-03 3 1  ON 34
ci_036                 2.342944e-03 3 1  ON 35
ci_037                 3.550988e-03 3 1  ON 36
ci_038                 3.806577e-03 3 1  ON 37
ci_039                 4.520864e-03 3 1  ON 38
ci_040                 4.574772e-03 3 1  ON 39
ci_041                 2.871518e-03 3 1  ON 40
ci_042                 3.156542e-03 3 1  ON 41
ci_043                 3.669498e-03 3 1  ON 42
ci_044                 3.347872e-03 3 1  ON 43
ci_045                 2.871201e-03 3 1  ON 44
ci_046                 3.168843e-03 3 1  ON 45
ci_047                -1.270147e-03 3 1  ON 46
ci_048                -1.440690e-03 3 1  ON 47
ci_049                 1.115229e-03 3 1  ON 48
ci_050                 1.285111e-03 3 1  ON 49
ci_051                -1.768979e-03 3 1  ON 50
ci_052                -1.898144e-03 3 1  ON 51
ci_053                -2.533680e-03 3 1  ON 52
ci_054                -2.594154e-03 3 1  ON 53
ci_055                -2.021528e-03 3 1  ON 54
ci_056                -1.299078e-03 3 1  ON 55
ci_057                -1.419152e-03 3 1  ON 56
ci_058                -1.147955e-03 3 1  ON 57
ci_059                -5.109871e-04 3 1  ON 58
ci_060                -5.513358e-04 3 1  ON 59
ci_061                -7.265693e-04 3 1  ON 60
ci_062                -7.231734e-04 3 1  ON 61
ci_063                -6.754229e-04 3 1  ON 62
ci_064                -1.044052e-03 3 1  ON 63
ci_065                -1.802036e-03 3 1  ON 64
ci_066                -1.858339e-03 3 1  ON 65
ci_067                -1.325154e-03 3 1  ON 66
ci_068                -1.607592e-03 3 1  ON 67
ci_069                 2.859470e-04 3 1  ON 68
ci_070                 2.737781e-04 3 1  ON 69
ci_071                -1.560839e-03 3 1  ON 70
ci_072                -1.878452e-03 3 1  ON 71
ci_073                 2.007002e-04 3 1  ON 72
ci_074                 3.322373e-04 3 1  ON 73
ci_075                 2.189136e-05 3 1  ON 74
ci_076                 2.071076e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4056e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6694
    reference variance = 0.903282
====================================================
  Execution time = 2.6064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5865e-01
  Total weights = 1.955053640e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447968726669
                                         uncertainty =       0.005877379763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447968726669
                                         uncertainty =       0.005877379763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473289566
  error estimate for blocks of size 2^( 2) =       0.000496772606
  error estimate for blocks of size 2^( 3) =       0.000518843884
  error estimate for blocks of size 2^( 4) =       0.000534523215
  error estimate for blocks of size 2^( 5) =       0.000543122150
  error estimate for blocks of size 2^( 6) =       0.000547519032
  error estimate for blocks of size 2^( 7) =       0.000552148701

      target function =      -0.738256144977
              le_mean =     -22.662648074299
             les_mean =     514.054272006718
             stat err =       0.000544328275
             autocorr =       1.322720021002
   target nu stat err =       0.000544328275
   target dn stat err =       0.006226982118
      target stat err =       0.005051586948
              std dev =       0.669332523350
             le_variance =       0.448006026814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266264807430e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738290129544       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738412748172       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738442802885       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738448106913       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738451597516       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738454326073       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738455110675       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738455455170       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738455414292       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738455527427       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738455470923       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738455482966       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.745529e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738290129544       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738325005049       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738333105704       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738334484032       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738335350206       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738335932740       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738336079648       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738336147617       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738336134915       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738336157014       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738336145830       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738336147672       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.393260e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738290129544       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738299159174       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738301223300       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738301570761       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738301786125       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738301924752       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738301958454       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738301974377       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738301971082       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738301976227       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738301973631       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738301974027       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.100441e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078726 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0775e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -7.013435e-01 3 1  ON 0
ci_002                -7.062674e-01 3 1  ON 1
ci_003                -5.419988e-02 3 1  ON 2
ci_004                -5.528923e-02 3 1  ON 3
ci_005                 2.102328e-02 3 1  ON 4
ci_006                 2.106645e-02 3 1  ON 5
ci_007                 1.724301e-02 3 1  ON 6
ci_008                 1.727864e-02 3 1  ON 7
ci_009                -1.307948e-02 3 1  ON 8
ci_010                -1.360138e-02 3 1  ON 9
ci_011                -1.064790e-02 3 1  ON 10
ci_012                -1.081852e-02 3 1  ON 11
ci_013                 9.655260e-03 3 1  ON 12
ci_014                 9.848883e-03 3 1  ON 13
ci_015                 1.018434e-02 3 1  ON 14
ci_016                 1.073253e-02 3 1  ON 15
ci_017                 8.529501e-03 3 1  ON 16
ci_018                 9.028359e-03 3 1  ON 17
ci_019                 6.311382e-04 3 1  ON 18
ci_020                 1.107769e-03 3 1  ON 19
ci_021                -9.294860e-03 3 1  ON 20
ci_022                -1.028711e-02 3 1  ON 21
ci_023                 5.804425e-03 3 1  ON 22
ci_024                 5.413979e-03 3 1  ON 23
ci_025                 1.202962e-02 3 1  ON 24
ci_026                 1.155111e-02 3 1  ON 25
ci_027                 6.416029e-03 3 1  ON 26
ci_028                 6.555010e-03 3 1  ON 27
ci_029                -4.040237e-03 3 1  ON 28
ci_030                -4.709097e-03 3 1  ON 29
ci_031                 2.516348e-03 3 1  ON 30
ci_032                 2.479041e-03 3 1  ON 31
ci_033                 3.684915e-03 3 1  ON 32
ci_034                 3.704056e-03 3 1  ON 33
ci_035                 2.662498e-03 3 1  ON 34
ci_036                 2.287882e-03 3 1  ON 35
ci_037                 3.452372e-03 3 1  ON 36
ci_038                 3.747146e-03 3 1  ON 37
ci_039                 4.494708e-03 3 1  ON 38
ci_040                 4.574970e-03 3 1  ON 39
ci_041                 2.842931e-03 3 1  ON 40
ci_042                 3.141506e-03 3 1  ON 41
ci_043                 3.645533e-03 3 1  ON 42
ci_044                 3.392176e-03 3 1  ON 43
ci_045                 2.804241e-03 3 1  ON 44
ci_046                 3.098878e-03 3 1  ON 45
ci_047                -1.215508e-03 3 1  ON 46
ci_048                -1.399209e-03 3 1  ON 47
ci_049                 1.124638e-03 3 1  ON 48
ci_050                 1.241387e-03 3 1  ON 49
ci_051                -1.699409e-03 3 1  ON 50
ci_052                -1.854925e-03 3 1  ON 51
ci_053                -2.581278e-03 3 1  ON 52
ci_054                -2.529038e-03 3 1  ON 53
ci_055                -2.043597e-03 3 1  ON 54
ci_056                -1.295940e-03 3 1  ON 55
ci_057                -1.413294e-03 3 1  ON 56
ci_058                -1.185340e-03 3 1  ON 57
ci_059                -5.023888e-04 3 1  ON 58
ci_060                -5.113569e-04 3 1  ON 59
ci_061                -7.198754e-04 3 1  ON 60
ci_062                -6.956433e-04 3 1  ON 61
ci_063                -7.077330e-04 3 1  ON 62
ci_064                -1.145098e-03 3 1  ON 63
ci_065                -1.816162e-03 3 1  ON 64
ci_066                -1.963500e-03 3 1  ON 65
ci_067                -1.323164e-03 3 1  ON 66
ci_068                -1.597665e-03 3 1  ON 67
ci_069                 2.565127e-04 3 1  ON 68
ci_070                 2.766523e-04 3 1  ON 69
ci_071                -1.600051e-03 3 1  ON 70
ci_072                -1.860729e-03 3 1  ON 71
ci_073                 2.007617e-04 3 1  ON 72
ci_074                 2.881841e-04 3 1  ON 73
ci_075                 4.302005e-05 3 1  ON 74
ci_076                 1.976598e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.698
    reference variance = 0.409895
====================================================
  Execution time = 2.7285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5035e-01
  Total weights = 1.9549e+06
  Execution time = 3.6075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439596534345
                                         uncertainty =       0.002092022534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439596534345
                                         uncertainty =       0.002092022534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468832318
  error estimate for blocks of size 2^( 2) =       0.000492613705
  error estimate for blocks of size 2^( 3) =       0.000515095062
  error estimate for blocks of size 2^( 4) =       0.000531111637
  error estimate for blocks of size 2^( 5) =       0.000539733727
  error estimate for blocks of size 2^( 6) =       0.000546139882
  error estimate for blocks of size 2^( 7) =       0.000548903651

      target function =      -0.744966207256
              le_mean =     -22.662117650891
             les_mean =     514.022004274396
             stat err =       0.000541472224
             autocorr =       1.333881610471
   target nu stat err =       0.000541472224
   target dn stat err =       0.002829178956
      target stat err =       0.002394247084
              std dev =       0.663029022073
             le_variance =       0.439607484111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439376479742
                                         uncertainty =       0.002094542705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439376479742
                                         uncertainty =       0.002094542705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468714815
  error estimate for blocks of size 2^( 2) =       0.000492527027
  error estimate for blocks of size 2^( 3) =       0.000515026088
  error estimate for blocks of size 2^( 4) =       0.000531044410
  error estimate for blocks of size 2^( 5) =       0.000539648117
  error estimate for blocks of size 2^( 6) =       0.000546060586
  error estimate for blocks of size 2^( 7) =       0.000548852047

      target function =      -0.745054581277
              le_mean =     -22.662121411437
             les_mean =     514.022066739313
             stat err =       0.000541401290
             autocorr =       1.334200842498
   target nu stat err =       0.000541401290
   target dn stat err =       0.002863820695
      target stat err =       0.002422310552
              std dev =       0.662862848378
             le_variance =       0.439387155760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439468149178
                                         uncertainty =       0.002091511371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439468149178
                                         uncertainty =       0.002091511371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468763813
  error estimate for blocks of size 2^( 2) =       0.000492561017
  error estimate for blocks of size 2^( 3) =       0.000515054288
  error estimate for blocks of size 2^( 4) =       0.000531068503
  error estimate for blocks of size 2^( 5) =       0.000539677720
  error estimate for blocks of size 2^( 6) =       0.000546091274
  error estimate for blocks of size 2^( 7) =       0.000548899247

      target function =      -0.712588866564
              le_mean =     -22.662113424389
             les_mean =     514.062126613936
             stat err =       0.000541434186
             autocorr =       1.334084047078
   target nu stat err =       0.000541434186
   target dn stat err =       0.030695436091
      target stat err =       0.023050892259
              std dev =       0.662932141385
             le_variance =       0.439479024082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439574636200
                                         uncertainty =       0.002091969677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439574636200
                                         uncertainty =       0.002091969677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468820634
  error estimate for blocks of size 2^( 2) =       0.000492604368
  error estimate for blocks of size 2^( 3) =       0.000515087036
  error estimate for blocks of size 2^( 4) =       0.000531103691
  error estimate for blocks of size 2^( 5) =       0.000539724394
  error estimate for blocks of size 2^( 6) =       0.000546130914
  error estimate for blocks of size 2^( 7) =       0.000548897850

      target function =      -0.745118196694
              le_mean =     -22.662117125876
             les_mean =     514.021795231207
             stat err =       0.000541464212
             autocorr =       1.333908621864
   target nu stat err =       0.000541464212
   target dn stat err =       0.002804145125
      target stat err =       0.002375312917
              std dev =       0.663012498680
             le_variance =       0.439585573406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744966207256        initial
     2.5000e-01     2.5000e+00             1.7455e-03        -0.745054581277
     1.0000e+00     1.0000e+01             4.3933e-04        -0.712588866564
     4.0000e+00     4.0000e+01             1.1004e-04        -0.745118196694  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.5318e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -7.010142e-01 3 1  ON 0
ci_002                -7.065604e-01 3 1  ON 1
ci_003                -5.424789e-02 3 1  ON 2
ci_004                -5.540746e-02 3 1  ON 3
ci_005                 2.112100e-02 3 1  ON 4
ci_006                 2.119486e-02 3 1  ON 5
ci_007                 1.729893e-02 3 1  ON 6
ci_008                 1.739922e-02 3 1  ON 7
ci_009                -1.314972e-02 3 1  ON 8
ci_010                -1.372439e-02 3 1  ON 9
ci_011                -1.074021e-02 3 1  ON 10
ci_012                -1.083618e-02 3 1  ON 11
ci_013                 9.784968e-03 3 1  ON 12
ci_014                 1.000886e-02 3 1  ON 13
ci_015                 1.023334e-02 3 1  ON 14
ci_016                 1.081436e-02 3 1  ON 15
ci_017                 8.570487e-03 3 1  ON 16
ci_018                 9.089119e-03 3 1  ON 17
ci_019                 7.500200e-04 3 1  ON 18
ci_020                 1.122233e-03 3 1  ON 19
ci_021                -9.183202e-03 3 1  ON 20
ci_022                -1.015744e-02 3 1  ON 21
ci_023                 5.863243e-03 3 1  ON 22
ci_024                 5.426641e-03 3 1  ON 23
ci_025                 1.198903e-02 3 1  ON 24
ci_026                 1.145206e-02 3 1  ON 25
ci_027                 6.469783e-03 3 1  ON 26
ci_028                 6.557492e-03 3 1  ON 27
ci_029                -4.068134e-03 3 1  ON 28
ci_030                -4.739725e-03 3 1  ON 29
ci_031                 2.423753e-03 3 1  ON 30
ci_032                 2.355413e-03 3 1  ON 31
ci_033                 3.660260e-03 3 1  ON 32
ci_034                 3.725187e-03 3 1  ON 33
ci_035                 2.692236e-03 3 1  ON 34
ci_036                 2.328683e-03 3 1  ON 35
ci_037                 3.525564e-03 3 1  ON 36
ci_038                 3.791324e-03 3 1  ON 37
ci_039                 4.514009e-03 3 1  ON 38
ci_040                 4.574826e-03 3 1  ON 39
ci_041                 2.864116e-03 3 1  ON 40
ci_042                 3.152664e-03 3 1  ON 41
ci_043                 3.663329e-03 3 1  ON 42
ci_044                 3.359293e-03 3 1  ON 43
ci_045                 2.853939e-03 3 1  ON 44
ci_046                 3.150802e-03 3 1  ON 45
ci_047                -1.255984e-03 3 1  ON 46
ci_048                -1.429938e-03 3 1  ON 47
ci_049                 1.117667e-03 3 1  ON 48
ci_050                 1.273797e-03 3 1  ON 49
ci_051                -1.751098e-03 3 1  ON 50
ci_052                -1.887045e-03 3 1  ON 51
ci_053                -2.545908e-03 3 1  ON 52
ci_054                -2.577369e-03 3 1  ON 53
ci_055                -2.027206e-03 3 1  ON 54
ci_056                -1.298256e-03 3 1  ON 55
ci_057                -1.417635e-03 3 1  ON 56
ci_058                -1.157622e-03 3 1  ON 57
ci_059                -5.087871e-04 3 1  ON 58
ci_060                -5.409847e-04 3 1  ON 59
ci_061                -7.248649e-04 3 1  ON 60
ci_062                -7.160804e-04 3 1  ON 61
ci_063                -6.836656e-04 3 1  ON 62
ci_064                -1.070037e-03 3 1  ON 63
ci_065                -1.805679e-03 3 1  ON 64
ci_066                -1.885509e-03 3 1  ON 65
ci_067                -1.324621e-03 3 1  ON 66
ci_068                -1.605015e-03 3 1  ON 67
ci_069                 2.783450e-04 3 1  ON 68
ci_070                 2.745045e-04 3 1  ON 69
ci_071                -1.570942e-03 3 1  ON 70
ci_072                -1.873933e-03 3 1  ON 71
ci_073                 2.007185e-04 3 1  ON 72
ci_074                 3.208232e-04 3 1  ON 73
ci_075                 2.732539e-05 3 1  ON 74
ci_076                 2.046715e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6098e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6772
    reference variance = 0.331911
====================================================
  Execution time = 2.6055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5091e-01
  Total weights = 1.955220439e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440613506611
                                         uncertainty =       0.002065811658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440613506611
                                         uncertainty =       0.002065811658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469396257
  error estimate for blocks of size 2^( 2) =       0.000493584168
  error estimate for blocks of size 2^( 3) =       0.000515527583
  error estimate for blocks of size 2^( 4) =       0.000531344422
  error estimate for blocks of size 2^( 5) =       0.000541076278
  error estimate for blocks of size 2^( 6) =       0.000547539847
  error estimate for blocks of size 2^( 7) =       0.000550696625

      target function =      -0.744582115270
              le_mean =     -22.662963280447
             les_mean =     514.060810045248
             stat err =       0.000542664293
             autocorr =       1.336543960762
   target nu stat err =       0.000542664293
   target dn stat err =       0.002827062255
      target stat err =       0.002393492934
              std dev =       0.663826553268
             le_variance =       0.440665692824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266296328045e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744588786683       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744621307944       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744626265882       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744626712895       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744626908829       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744626991106       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744627026694       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744627022305       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744627016780       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.431957e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744588786683       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744597207460       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744598469162       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744598581366       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744598630636       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744598651055       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744598659502       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744598658206       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744598656911       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 6.255184e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744588786683       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744590910848       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744591227673       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744591255748       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744591268082       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744591273176       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744591275259       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744591274923       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744591274604       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 1.575150e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081895 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0790e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -7.010233e-01 3 1  ON 0
ci_002                -7.065617e-01 3 1  ON 1
ci_003                -5.422738e-02 3 1  ON 2
ci_004                -5.537382e-02 3 1  ON 3
ci_005                 2.108499e-02 3 1  ON 4
ci_006                 2.116863e-02 3 1  ON 5
ci_007                 1.727538e-02 3 1  ON 6
ci_008                 1.737033e-02 3 1  ON 7
ci_009                -1.315049e-02 3 1  ON 8
ci_010                -1.368123e-02 3 1  ON 9
ci_011                -1.073095e-02 3 1  ON 10
ci_012                -1.082793e-02 3 1  ON 11
ci_013                 9.768667e-03 3 1  ON 12
ci_014                 9.955935e-03 3 1  ON 13
ci_015                 1.020007e-02 3 1  ON 14
ci_016                 1.078948e-02 3 1  ON 15
ci_017                 8.585409e-03 3 1  ON 16
ci_018                 9.065985e-03 3 1  ON 17
ci_019                 6.891023e-04 3 1  ON 18
ci_020                 1.059681e-03 3 1  ON 19
ci_021                -9.185054e-03 3 1  ON 20
ci_022                -1.017302e-02 3 1  ON 21
ci_023                 5.844012e-03 3 1  ON 22
ci_024                 5.415870e-03 3 1  ON 23
ci_025                 1.201000e-02 3 1  ON 24
ci_026                 1.147939e-02 3 1  ON 25
ci_027                 6.455069e-03 3 1  ON 26
ci_028                 6.560906e-03 3 1  ON 27
ci_029                -4.059354e-03 3 1  ON 28
ci_030                -4.722071e-03 3 1  ON 29
ci_031                 2.456370e-03 3 1  ON 30
ci_032                 2.385567e-03 3 1  ON 31
ci_033                 3.676960e-03 3 1  ON 32
ci_034                 3.714903e-03 3 1  ON 33
ci_035                 2.681419e-03 3 1  ON 34
ci_036                 2.326190e-03 3 1  ON 35
ci_037                 3.497914e-03 3 1  ON 36
ci_038                 3.808587e-03 3 1  ON 37
ci_039                 4.505305e-03 3 1  ON 38
ci_040                 4.574748e-03 3 1  ON 39
ci_041                 2.863651e-03 3 1  ON 40
ci_042                 3.146757e-03 3 1  ON 41
ci_043                 3.640625e-03 3 1  ON 42
ci_044                 3.361280e-03 3 1  ON 43
ci_045                 2.820414e-03 3 1  ON 44
ci_046                 3.134022e-03 3 1  ON 45
ci_047                -1.251723e-03 3 1  ON 46
ci_048                -1.422242e-03 3 1  ON 47
ci_049                 1.121188e-03 3 1  ON 48
ci_050                 1.254708e-03 3 1  ON 49
ci_051                -1.764412e-03 3 1  ON 50
ci_052                -1.894922e-03 3 1  ON 51
ci_053                -2.532265e-03 3 1  ON 52
ci_054                -2.579235e-03 3 1  ON 53
ci_055                -2.038965e-03 3 1  ON 54
ci_056                -1.298734e-03 3 1  ON 55
ci_057                -1.411045e-03 3 1  ON 56
ci_058                -1.157107e-03 3 1  ON 57
ci_059                -5.187212e-04 3 1  ON 58
ci_060                -5.332778e-04 3 1  ON 59
ci_061                -7.173898e-04 3 1  ON 60
ci_062                -6.935871e-04 3 1  ON 61
ci_063                -6.821094e-04 3 1  ON 62
ci_064                -1.061698e-03 3 1  ON 63
ci_065                -1.798792e-03 3 1  ON 64
ci_066                -1.875080e-03 3 1  ON 65
ci_067                -1.335173e-03 3 1  ON 66
ci_068                -1.608674e-03 3 1  ON 67
ci_069                 2.703849e-04 3 1  ON 68
ci_070                 2.657894e-04 3 1  ON 69
ci_071                -1.591207e-03 3 1  ON 70
ci_072                -1.875146e-03 3 1  ON 71
ci_073                 1.801014e-04 3 1  ON 72
ci_074                 3.322082e-04 3 1  ON 73
ci_075                 2.591442e-05 3 1  ON 74
ci_076                 2.110264e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.573
    reference variance = 0.625171
====================================================
  Execution time = 2.5548e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5239e-01
  Total weights = 1.9549e+06
  Execution time = 3.5850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441474105878
                                         uncertainty =       0.002192394178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441474105878
                                         uncertainty =       0.002192394178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469875783
  error estimate for blocks of size 2^( 2) =       0.000493885562
  error estimate for blocks of size 2^( 3) =       0.000516053706
  error estimate for blocks of size 2^( 4) =       0.000532536319
  error estimate for blocks of size 2^( 5) =       0.000540856568
  error estimate for blocks of size 2^( 6) =       0.000545764336
  error estimate for blocks of size 2^( 7) =       0.000547523060

      target function =      -0.743076128965
              le_mean =     -22.661265740630
             les_mean =     513.985696673640
             stat err =       0.000541670071
             autocorr =       1.328934432939
   target nu stat err =       0.000541670071
   target dn stat err =       0.002825296675
      target stat err =       0.002376487518
              std dev =       0.664504705607
             le_variance =       0.441566503773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441392702595
                                         uncertainty =       0.002191442557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441392702595
                                         uncertainty =       0.002191442557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469833044
  error estimate for blocks of size 2^( 2) =       0.000493848128
  error estimate for blocks of size 2^( 3) =       0.000516019651
  error estimate for blocks of size 2^( 4) =       0.000532506521
  error estimate for blocks of size 2^( 5) =       0.000540830153
  error estimate for blocks of size 2^( 6) =       0.000545731596
  error estimate for blocks of size 2^( 7) =       0.000547487577

      target function =      -0.743466272261
              le_mean =     -22.661265049439
             les_mean =     513.985186612042
             stat err =       0.000541638962
             autocorr =       1.329023555806
   target nu stat err =       0.000541638962
   target dn stat err =       0.002819483605
      target stat err =       0.002374305598
              std dev =       0.664444262263
             le_variance =       0.441486177654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441431030743
                                         uncertainty =       0.002191885658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441431030743
                                         uncertainty =       0.002191885658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469853158
  error estimate for blocks of size 2^( 2) =       0.000493865691
  error estimate for blocks of size 2^( 3) =       0.000516035765
  error estimate for blocks of size 2^( 4) =       0.000532520636
  error estimate for blocks of size 2^( 5) =       0.000540842478
  error estimate for blocks of size 2^( 6) =       0.000545747277
  error estimate for blocks of size 2^( 7) =       0.000547503861

      target function =      -0.740472261669
              le_mean =     -22.661265112160
             les_mean =     513.988864082310
             stat err =       0.000541653563
             autocorr =       1.328981413723
   target nu stat err =       0.000541653563
   target dn stat err =       0.004397050296
      target stat err =       0.003605145884
              std dev =       0.664472709033
             le_variance =       0.441523981050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441468537269
                                         uncertainty =       0.002192327870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441468537269
                                         uncertainty =       0.002192327870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469872858
  error estimate for blocks of size 2^( 2) =       0.000493882984
  error estimate for blocks of size 2^( 3) =       0.000516051362
  error estimate for blocks of size 2^( 4) =       0.000532534235
  error estimate for blocks of size 2^( 5) =       0.000540854687
  error estimate for blocks of size 2^( 6) =       0.000545762019
  error estimate for blocks of size 2^( 7) =       0.000547520460

      target function =      -0.743180031800
              le_mean =     -22.661265639173
             les_mean =     513.985564577646
             stat err =       0.000541667850
             autocorr =       1.328940086001
   target nu stat err =       0.000541667850
   target dn stat err =       0.002816035027
      target stat err =       0.002369824790
              std dev =       0.664500567774
             le_variance =       0.441561004572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743076128965        initial
     1.0000e+00     1.0000e+01             2.4320e-04        -0.743466272261  <--
     4.0000e+00     4.0000e+01             6.2552e-05        -0.740472261669
     1.6000e+01     1.6000e+02             1.5751e-05        -0.743180031800

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3537e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -7.010497e-01 3 1  ON 0
ci_002                -7.065654e-01 3 1  ON 1
ci_003                -5.416686e-02 3 1  ON 2
ci_004                -5.527478e-02 3 1  ON 3
ci_005                 2.098226e-02 3 1  ON 4
ci_006                 2.109376e-02 3 1  ON 5
ci_007                 1.720774e-02 3 1  ON 6
ci_008                 1.728748e-02 3 1  ON 7
ci_009                -1.315286e-02 3 1  ON 8
ci_010                -1.355734e-02 3 1  ON 9
ci_011                -1.070422e-02 3 1  ON 10
ci_012                -1.080444e-02 3 1  ON 11
ci_013                 9.721760e-03 3 1  ON 12
ci_014                 9.803855e-03 3 1  ON 13
ci_015                 1.010406e-02 3 1  ON 14
ci_016                 1.071747e-02 3 1  ON 15
ci_017                 8.628586e-03 3 1  ON 16
ci_018                 8.999587e-03 3 1  ON 17
ci_019                 5.130534e-04 3 1  ON 18
ci_020                 8.790368e-04 3 1  ON 19
ci_021                -9.190408e-03 3 1  ON 20
ci_022                -1.021795e-02 3 1  ON 21
ci_023                 5.789049e-03 3 1  ON 22
ci_024                 5.385088e-03 3 1  ON 23
ci_025                 1.207086e-02 3 1  ON 24
ci_026                 1.155857e-02 3 1  ON 25
ci_027                 6.413188e-03 3 1  ON 26
ci_028                 6.570607e-03 3 1  ON 27
ci_029                -4.034174e-03 3 1  ON 28
ci_030                -4.671275e-03 3 1  ON 29
ci_031                 2.550427e-03 3 1  ON 30
ci_032                 2.472657e-03 3 1  ON 31
ci_033                 3.725175e-03 3 1  ON 32
ci_034                 3.685375e-03 3 1  ON 33
ci_035                 2.650485e-03 3 1  ON 34
ci_036                 2.318919e-03 3 1  ON 35
ci_037                 3.418297e-03 3 1  ON 36
ci_038                 3.857913e-03 3 1  ON 37
ci_039                 4.480619e-03 3 1  ON 38
ci_040                 4.574487e-03 3 1  ON 39
ci_041                 2.862340e-03 3 1  ON 40
ci_042                 3.129872e-03 3 1  ON 41
ci_043                 3.575293e-03 3 1  ON 42
ci_044                 3.366962e-03 3 1  ON 43
ci_045                 2.723985e-03 3 1  ON 44
ci_046                 3.085882e-03 3 1  ON 45
ci_047                -1.239625e-03 3 1  ON 46
ci_048                -1.400235e-03 3 1  ON 47
ci_049                 1.131231e-03 3 1  ON 48
ci_050                 1.200104e-03 3 1  ON 49
ci_051                -1.802477e-03 3 1  ON 50
ci_052                -1.917495e-03 3 1  ON 51
ci_053                -2.492943e-03 3 1  ON 52
ci_054                -2.584769e-03 3 1  ON 53
ci_055                -2.072887e-03 3 1  ON 54
ci_056                -1.300159e-03 3 1  ON 55
ci_057                -1.392188e-03 3 1  ON 56
ci_058                -1.155529e-03 3 1  ON 57
ci_059                -5.468980e-04 3 1  ON 58
ci_060                -5.112812e-04 3 1  ON 59
ci_061                -6.958438e-04 3 1  ON 60
ci_062                -6.287819e-04 3 1  ON 61
ci_063                -6.777020e-04 3 1  ON 62
ci_064                -1.037927e-03 3 1  ON 63
ci_065                -1.778930e-03 3 1  ON 64
ci_066                -1.845033e-03 3 1  ON 65
ci_067                -1.365516e-03 3 1  ON 66
ci_068                -1.619191e-03 3 1  ON 67
ci_069                 2.474995e-04 3 1  ON 68
ci_070                 2.407485e-04 3 1  ON 69
ci_071                -1.649224e-03 3 1  ON 70
ci_072                -1.878418e-03 3 1  ON 71
ci_073                 1.213148e-04 3 1  ON 72
ci_074                 3.645511e-04 3 1  ON 73
ci_075                 2.184775e-05 3 1  ON 74
ci_076                 2.293958e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4334e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6568
    reference variance = 0.857292
====================================================
  Execution time = 2.6114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5461e-01
  Total weights = 1.955166920e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440279819006
                                         uncertainty =       0.002262857180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440279819006
                                         uncertainty =       0.002262857180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469198776
  error estimate for blocks of size 2^( 2) =       0.000493854278
  error estimate for blocks of size 2^( 3) =       0.000516016769
  error estimate for blocks of size 2^( 4) =       0.000531560115
  error estimate for blocks of size 2^( 5) =       0.000540569802
  error estimate for blocks of size 2^( 6) =       0.000546261829
  error estimate for blocks of size 2^( 7) =       0.000549764040

      target function =      -0.741535412523
              le_mean =     -22.661652359791
             les_mean =     514.005102150872
             stat err =       0.000542038946
             autocorr =       1.334588088743
   target nu stat err =       0.000542038946
   target dn stat err =       0.004698867132
      target stat err =       0.003859354531
              std dev =       0.663547272012
             le_variance =       0.440294982195


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266165235979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741554672270       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741699704826       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741731650473       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741736453190       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741738709393       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741741032172       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741742206483       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741742533821       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741742639940       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741742616240       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741742594307       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741742608318       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.635142e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741554672270       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741595960582       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741604519510       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741605769019       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741606308241       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741606812666       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741607063862       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741607127725       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741607145067       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741607137834       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741607134015       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741607136435       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.118374e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741554672270       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741565365111       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741567542045       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741567857176       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741567989707       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741568110401       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741568170512       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741568185376       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741568189127       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741568187310       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741568186465       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741568187006       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.031741e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0833e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -7.014616e-01 3 1  ON 0
ci_002                -7.061628e-01 3 1  ON 1
ci_003                -5.430406e-02 3 1  ON 2
ci_004                -5.538650e-02 3 1  ON 3
ci_005                 2.087705e-02 3 1  ON 4
ci_006                 2.089476e-02 3 1  ON 5
ci_007                 1.708949e-02 3 1  ON 6
ci_008                 1.715820e-02 3 1  ON 7
ci_009                -1.311822e-02 3 1  ON 8
ci_010                -1.343603e-02 3 1  ON 9
ci_011                -1.062170e-02 3 1  ON 10
ci_012                -1.067357e-02 3 1  ON 11
ci_013                 9.633446e-03 3 1  ON 12
ci_014                 9.789775e-03 3 1  ON 13
ci_015                 9.984017e-03 3 1  ON 14
ci_016                 1.063590e-02 3 1  ON 15
ci_017                 8.699867e-03 3 1  ON 16
ci_018                 8.991185e-03 3 1  ON 17
ci_019                 2.575178e-04 3 1  ON 18
ci_020                 5.524538e-04 3 1  ON 19
ci_021                -9.202667e-03 3 1  ON 20
ci_022                -1.031102e-02 3 1  ON 21
ci_023                 5.767272e-03 3 1  ON 22
ci_024                 5.327101e-03 3 1  ON 23
ci_025                 1.212878e-02 3 1  ON 24
ci_026                 1.164567e-02 3 1  ON 25
ci_027                 6.362474e-03 3 1  ON 26
ci_028                 6.407340e-03 3 1  ON 27
ci_029                -3.952472e-03 3 1  ON 28
ci_030                -4.692708e-03 3 1  ON 29
ci_031                 2.720368e-03 3 1  ON 30
ci_032                 2.714042e-03 3 1  ON 31
ci_033                 3.689911e-03 3 1  ON 32
ci_034                 3.687430e-03 3 1  ON 33
ci_035                 2.627319e-03 3 1  ON 34
ci_036                 2.292466e-03 3 1  ON 35
ci_037                 3.407717e-03 3 1  ON 36
ci_038                 3.828388e-03 3 1  ON 37
ci_039                 4.446436e-03 3 1  ON 38
ci_040                 4.542926e-03 3 1  ON 39
ci_041                 2.867232e-03 3 1  ON 40
ci_042                 3.088681e-03 3 1  ON 41
ci_043                 3.577717e-03 3 1  ON 42
ci_044                 3.353255e-03 3 1  ON 43
ci_045                 2.690327e-03 3 1  ON 44
ci_046                 2.949179e-03 3 1  ON 45
ci_047                -1.196381e-03 3 1  ON 46
ci_048                -1.388868e-03 3 1  ON 47
ci_049                 1.142749e-03 3 1  ON 48
ci_050                 1.146694e-03 3 1  ON 49
ci_051                -1.785441e-03 3 1  ON 50
ci_052                -1.920083e-03 3 1  ON 51
ci_053                -2.459911e-03 3 1  ON 52
ci_054                -2.559765e-03 3 1  ON 53
ci_055                -2.035691e-03 3 1  ON 54
ci_056                -1.365318e-03 3 1  ON 55
ci_057                -1.336513e-03 3 1  ON 56
ci_058                -1.151150e-03 3 1  ON 57
ci_059                -5.066001e-04 3 1  ON 58
ci_060                -4.547056e-04 3 1  ON 59
ci_061                -6.362390e-04 3 1  ON 60
ci_062                -6.607921e-04 3 1  ON 61
ci_063                -6.458468e-04 3 1  ON 62
ci_064                -1.059891e-03 3 1  ON 63
ci_065                -1.819486e-03 3 1  ON 64
ci_066                -1.758530e-03 3 1  ON 65
ci_067                -1.386821e-03 3 1  ON 66
ci_068                -1.637508e-03 3 1  ON 67
ci_069                 2.407865e-04 3 1  ON 68
ci_070                 2.197266e-04 3 1  ON 69
ci_071                -1.663366e-03 3 1  ON 70
ci_072                -2.028881e-03 3 1  ON 71
ci_073                 6.999074e-05 3 1  ON 72
ci_074                 3.479269e-04 3 1  ON 73
ci_075                -3.601262e-06 3 1  ON 74
ci_076                 2.486132e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.5903
    reference variance = 0.428461
====================================================
  Execution time = 2.5316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5380e-01
  Total weights = 1.9551e+06
  Execution time = 3.6141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441652147338
                                         uncertainty =       0.002502387006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441652147338
                                         uncertainty =       0.002502387006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469908899
  error estimate for blocks of size 2^( 2) =       0.000493637211
  error estimate for blocks of size 2^( 3) =       0.000516438295
  error estimate for blocks of size 2^( 4) =       0.000532081290
  error estimate for blocks of size 2^( 5) =       0.000540778579
  error estimate for blocks of size 2^( 6) =       0.000546947472
  error estimate for blocks of size 2^( 7) =       0.000549158918

      target function =      -0.739453504578
              le_mean =     -22.661928031537
             les_mean =     514.020172829095
             stat err =       0.000542241565
             autocorr =       1.331552425282
   target nu stat err =       0.000542241565
   target dn stat err =       0.004428126524
      target stat err =       0.003623741382
              std dev =       0.664551538215
             le_variance =       0.441628746943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441468264222
                                         uncertainty =       0.002507428132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441468264222
                                         uncertainty =       0.002507428132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469810857
  error estimate for blocks of size 2^( 2) =       0.000493566024
  error estimate for blocks of size 2^( 3) =       0.000516387151
  error estimate for blocks of size 2^( 4) =       0.000532046148
  error estimate for blocks of size 2^( 5) =       0.000540743320
  error estimate for blocks of size 2^( 6) =       0.000546890368
  error estimate for blocks of size 2^( 7) =       0.000549078635

      target function =      -0.741676702486
              le_mean =     -22.661927300598
             les_mean =     514.017401519093
             stat err =       0.000542189618
             autocorr =       1.331853011918
   target nu stat err =       0.000542189618
   target dn stat err =       0.003587593292
      target stat err =       0.002973741599
              std dev =       0.664412885519
             le_variance =       0.441444482444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441521512439
                                         uncertainty =       0.002504116639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441521512439
                                         uncertainty =       0.002504116639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469839286
  error estimate for blocks of size 2^( 2) =       0.000493582891
  error estimate for blocks of size 2^( 3) =       0.000516395652
  error estimate for blocks of size 2^( 4) =       0.000532048634
  error estimate for blocks of size 2^( 5) =       0.000540745845
  error estimate for blocks of size 2^( 6) =       0.000546903368
  error estimate for blocks of size 2^( 7) =       0.000549101825

      target function =      -0.742149860237
              le_mean =     -22.661925355985
             les_mean =     514.016732067786
             stat err =       0.000542199918
             autocorr =       1.331742438695
   target nu stat err =       0.000542199918
   target dn stat err =       0.003469903595
      target stat err =       0.002883730436
              std dev =       0.664453090239
             le_variance =       0.441497909128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441631210068
                                         uncertainty =       0.002502564554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441631210068
                                         uncertainty =       0.002502564554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469897748
  error estimate for blocks of size 2^( 2) =       0.000493628246
  error estimate for blocks of size 2^( 3) =       0.000516431088
  error estimate for blocks of size 2^( 4) =       0.000532076588
  error estimate for blocks of size 2^( 5) =       0.000540773459
  error estimate for blocks of size 2^( 6) =       0.000546941112
  error estimate for blocks of size 2^( 7) =       0.000549151046

      target function =      -0.740600080508
              le_mean =     -22.661927916638
             les_mean =     514.018756037035
             stat err =       0.000542235551
             autocorr =       1.331586088376
   target nu stat err =       0.000542235551
   target dn stat err =       0.003701428747
      target stat err =       0.003055685542
              std dev =       0.664535768030
             le_variance =       0.441607786991


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739453504578        initial
     2.5000e-01     2.5000e+00             1.6351e-03        -0.741676702486
     1.0000e+00     1.0000e+01             4.1184e-04        -0.742149860237  <--
     4.0000e+00     4.0000e+01             1.0317e-04        -0.740600080508

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3380e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -7.014616e-01 3 1  ON 0
ci_002                -7.061628e-01 3 1  ON 1
ci_003                -5.430406e-02 3 1  ON 2
ci_004                -5.538650e-02 3 1  ON 3
ci_005                 2.087705e-02 3 1  ON 4
ci_006                 2.089476e-02 3 1  ON 5
ci_007                 1.708949e-02 3 1  ON 6
ci_008                 1.715820e-02 3 1  ON 7
ci_009                -1.311822e-02 3 1  ON 8
ci_010                -1.343603e-02 3 1  ON 9
ci_011                -1.062170e-02 3 1  ON 10
ci_012                -1.067357e-02 3 1  ON 11
ci_013                 9.633446e-03 3 1  ON 12
ci_014                 9.789775e-03 3 1  ON 13
ci_015                 9.984017e-03 3 1  ON 14
ci_016                 1.063590e-02 3 1  ON 15
ci_017                 8.699867e-03 3 1  ON 16
ci_018                 8.991185e-03 3 1  ON 17
ci_019                 2.575178e-04 3 1  ON 18
ci_020                 5.524538e-04 3 1  ON 19
ci_021                -9.202667e-03 3 1  ON 20
ci_022                -1.031102e-02 3 1  ON 21
ci_023                 5.767272e-03 3 1  ON 22
ci_024                 5.327101e-03 3 1  ON 23
ci_025                 1.212878e-02 3 1  ON 24
ci_026                 1.164567e-02 3 1  ON 25
ci_027                 6.362474e-03 3 1  ON 26
ci_028                 6.407340e-03 3 1  ON 27
ci_029                -3.952472e-03 3 1  ON 28
ci_030                -4.692708e-03 3 1  ON 29
ci_031                 2.720368e-03 3 1  ON 30
ci_032                 2.714042e-03 3 1  ON 31
ci_033                 3.689911e-03 3 1  ON 32
ci_034                 3.687430e-03 3 1  ON 33
ci_035                 2.627319e-03 3 1  ON 34
ci_036                 2.292466e-03 3 1  ON 35
ci_037                 3.407717e-03 3 1  ON 36
ci_038                 3.828388e-03 3 1  ON 37
ci_039                 4.446436e-03 3 1  ON 38
ci_040                 4.542926e-03 3 1  ON 39
ci_041                 2.867232e-03 3 1  ON 40
ci_042                 3.088681e-03 3 1  ON 41
ci_043                 3.577717e-03 3 1  ON 42
ci_044                 3.353255e-03 3 1  ON 43
ci_045                 2.690327e-03 3 1  ON 44
ci_046                 2.949179e-03 3 1  ON 45
ci_047                -1.196381e-03 3 1  ON 46
ci_048                -1.388868e-03 3 1  ON 47
ci_049                 1.142749e-03 3 1  ON 48
ci_050                 1.146694e-03 3 1  ON 49
ci_051                -1.785441e-03 3 1  ON 50
ci_052                -1.920083e-03 3 1  ON 51
ci_053                -2.459911e-03 3 1  ON 52
ci_054                -2.559765e-03 3 1  ON 53
ci_055                -2.035691e-03 3 1  ON 54
ci_056                -1.365318e-03 3 1  ON 55
ci_057                -1.336513e-03 3 1  ON 56
ci_058                -1.151150e-03 3 1  ON 57
ci_059                -5.066001e-04 3 1  ON 58
ci_060                -4.547056e-04 3 1  ON 59
ci_061                -6.362390e-04 3 1  ON 60
ci_062                -6.607921e-04 3 1  ON 61
ci_063                -6.458468e-04 3 1  ON 62
ci_064                -1.059891e-03 3 1  ON 63
ci_065                -1.819486e-03 3 1  ON 64
ci_066                -1.758530e-03 3 1  ON 65
ci_067                -1.386821e-03 3 1  ON 66
ci_068                -1.637508e-03 3 1  ON 67
ci_069                 2.407865e-04 3 1  ON 68
ci_070                 2.197266e-04 3 1  ON 69
ci_071                -1.663366e-03 3 1  ON 70
ci_072                -2.028881e-03 3 1  ON 71
ci_073                 6.999074e-05 3 1  ON 72
ci_074                 3.479269e-04 3 1  ON 73
ci_075                -3.601262e-06 3 1  ON 74
ci_076                 2.486132e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4219e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2650e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.5922
    reference variance = 0.370608
====================================================
  Execution time = 2.6054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5373e-01
  Total weights = 1.954915519e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443672258067
                                         uncertainty =       0.003271659752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443672258067
                                         uncertainty =       0.003271659752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470984128
  error estimate for blocks of size 2^( 2) =       0.000494806616
  error estimate for blocks of size 2^( 3) =       0.000516781361
  error estimate for blocks of size 2^( 4) =       0.000531961227
  error estimate for blocks of size 2^( 5) =       0.000541823591
  error estimate for blocks of size 2^( 6) =       0.000547469238
  error estimate for blocks of size 2^( 7) =       0.000550310249

      target function =      -0.742262797515
              le_mean =     -22.662737027993
             les_mean =     514.053382741690
             stat err =       0.000542891076
             autocorr =       1.328656946730
   target nu stat err =       0.000542891076
   target dn stat err =       0.003994950458
      target stat err =       0.003307836086
              std dev =       0.666072141313
             le_variance =       0.443652097433


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266273702799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742276669627       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742436995177       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742458323117       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742461771864       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742462013708       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742462664017       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742462994936       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742462992411       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742463038100       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742463040665       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742463018004       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742463019484       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 9.876887e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742276669627       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742322369250       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742328208519       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742329108100       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742329165615       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742329329038       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742329397581       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742329388834       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742329397098       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742329397562       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742329392678       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742329393257       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.760633e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742276669627       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742288509308       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742290004143       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742290231171       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742290245283       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742290286067       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742290302163       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742290299532       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742290301415       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742290301525       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742290300362       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742290300515       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 7.111640e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0748e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -7.013421e-01 3 1  ON 0
ci_002                -7.063174e-01 3 1  ON 1
ci_003                -5.424489e-02 3 1  ON 2
ci_004                -5.535884e-02 3 1  ON 3
ci_005                 2.066737e-02 3 1  ON 4
ci_006                 2.078250e-02 3 1  ON 5
ci_007                 1.698813e-02 3 1  ON 6
ci_008                 1.703227e-02 3 1  ON 7
ci_009                -1.302976e-02 3 1  ON 8
ci_010                -1.335691e-02 3 1  ON 9
ci_011                -1.051208e-02 3 1  ON 10
ci_012                -1.062872e-02 3 1  ON 11
ci_013                 9.490858e-03 3 1  ON 12
ci_014                 9.684687e-03 3 1  ON 13
ci_015                 9.875047e-03 3 1  ON 14
ci_016                 1.055424e-02 3 1  ON 15
ci_017                 8.671007e-03 3 1  ON 16
ci_018                 8.746694e-03 3 1  ON 17
ci_019                 1.443640e-04 3 1  ON 18
ci_020                 2.763905e-04 3 1  ON 19
ci_021                -9.220790e-03 3 1  ON 20
ci_022                -1.039980e-02 3 1  ON 21
ci_023                 5.754273e-03 3 1  ON 22
ci_024                 5.123681e-03 3 1  ON 23
ci_025                 1.214461e-02 3 1  ON 24
ci_026                 1.178672e-02 3 1  ON 25
ci_027                 6.364428e-03 3 1  ON 26
ci_028                 6.436014e-03 3 1  ON 27
ci_029                -3.942926e-03 3 1  ON 28
ci_030                -4.698242e-03 3 1  ON 29
ci_031                 2.892692e-03 3 1  ON 30
ci_032                 2.753168e-03 3 1  ON 31
ci_033                 3.731471e-03 3 1  ON 32
ci_034                 3.661889e-03 3 1  ON 33
ci_035                 2.618721e-03 3 1  ON 34
ci_036                 2.259406e-03 3 1  ON 35
ci_037                 3.410468e-03 3 1  ON 36
ci_038                 3.847818e-03 3 1  ON 37
ci_039                 4.431148e-03 3 1  ON 38
ci_040                 4.508054e-03 3 1  ON 39
ci_041                 2.782150e-03 3 1  ON 40
ci_042                 3.061498e-03 3 1  ON 41
ci_043                 3.601280e-03 3 1  ON 42
ci_044                 3.385013e-03 3 1  ON 43
ci_045                 2.632178e-03 3 1  ON 44
ci_046                 2.764263e-03 3 1  ON 45
ci_047                -1.180035e-03 3 1  ON 46
ci_048                -1.365368e-03 3 1  ON 47
ci_049                 1.102344e-03 3 1  ON 48
ci_050                 8.884769e-04 3 1  ON 49
ci_051                -1.733538e-03 3 1  ON 50
ci_052                -1.926807e-03 3 1  ON 51
ci_053                -2.566118e-03 3 1  ON 52
ci_054                -2.617981e-03 3 1  ON 53
ci_055                -1.953760e-03 3 1  ON 54
ci_056                -1.344549e-03 3 1  ON 55
ci_057                -1.348855e-03 3 1  ON 56
ci_058                -1.093733e-03 3 1  ON 57
ci_059                -4.842145e-04 3 1  ON 58
ci_060                -4.717606e-04 3 1  ON 59
ci_061                -6.418147e-04 3 1  ON 60
ci_062                -5.003747e-04 3 1  ON 61
ci_063                -6.371640e-04 3 1  ON 62
ci_064                -9.030418e-04 3 1  ON 63
ci_065                -1.816133e-03 3 1  ON 64
ci_066                -1.741980e-03 3 1  ON 65
ci_067                -1.413849e-03 3 1  ON 66
ci_068                -1.637576e-03 3 1  ON 67
ci_069                 1.952216e-04 3 1  ON 68
ci_070                 2.078079e-04 3 1  ON 69
ci_071                -1.644211e-03 3 1  ON 70
ci_072                -2.029174e-03 3 1  ON 71
ci_073                 1.360231e-04 3 1  ON 72
ci_074                 3.594786e-04 3 1  ON 73
ci_075                 6.518844e-06 3 1  ON 74
ci_076                 2.293817e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6695
    reference variance = 0.824009
====================================================
  Execution time = 2.5477e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4969e-01
  Total weights = 1.9550e+06
  Execution time = 3.6214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440938152614
                                         uncertainty =       0.002014086908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440938152614
                                         uncertainty =       0.002014086908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469588298
  error estimate for blocks of size 2^( 2) =       0.000493382694
  error estimate for blocks of size 2^( 3) =       0.000515691597
  error estimate for blocks of size 2^( 4) =       0.000531040727
  error estimate for blocks of size 2^( 5) =       0.000541917457
  error estimate for blocks of size 2^( 6) =       0.000546506819
  error estimate for blocks of size 2^( 7) =       0.000550354447

      target function =      -0.742593891525
              le_mean =     -22.660989994837
             les_mean =     513.973780683086
             stat err =       0.000542454862
             autocorr =       1.334420422757
   target nu stat err =       0.000542454862
   target dn stat err =       0.003973690002
      target stat err =       0.003285120817
              std dev =       0.664098140427
             le_variance =       0.441026340118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440665408958
                                         uncertainty =       0.002017676172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440665408958
                                         uncertainty =       0.002017676172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469441625
  error estimate for blocks of size 2^( 2) =       0.000493268494
  error estimate for blocks of size 2^( 3) =       0.000515596067
  error estimate for blocks of size 2^( 4) =       0.000530958875
  error estimate for blocks of size 2^( 5) =       0.000541844028
  error estimate for blocks of size 2^( 6) =       0.000546416284
  error estimate for blocks of size 2^( 7) =       0.000550253690

      target function =      -0.740885054362
              le_mean =     -22.660997156076
             les_mean =     513.976203488204
             stat err =       0.000542368219
             autocorr =       1.334827901487
   target nu stat err =       0.000542368219
   target dn stat err =       0.004842801405
      target stat err =       0.003964154440
              std dev =       0.663890713115
             le_variance =       0.440750878961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440750220758
                                         uncertainty =       0.002015041896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440750220758
                                         uncertainty =       0.002015041896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469487411
  error estimate for blocks of size 2^( 2) =       0.000493299640
  error estimate for blocks of size 2^( 3) =       0.000515621562
  error estimate for blocks of size 2^( 4) =       0.000530979124
  error estimate for blocks of size 2^( 5) =       0.000541863097
  error estimate for blocks of size 2^( 6) =       0.000546439537
  error estimate for blocks of size 2^( 7) =       0.000550281184

      target function =      -0.745128357020
              le_mean =     -22.660991996319
             les_mean =     513.970774320643
             stat err =       0.000542390735
             autocorr =       1.334678370943
   target nu stat err =       0.000542390735
   target dn stat err =       0.002668556922
      target stat err =       0.002264422269
              std dev =       0.663955463934
             le_variance =       0.440836858088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440909600414
                                         uncertainty =       0.002014273015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440909600414
                                         uncertainty =       0.002014273015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469572989
  error estimate for blocks of size 2^( 2) =       0.000493369257
  error estimate for blocks of size 2^( 3) =       0.000515679525
  error estimate for blocks of size 2^( 4) =       0.000531029953
  error estimate for blocks of size 2^( 5) =       0.000541907267
  error estimate for blocks of size 2^( 6) =       0.000546489853
  error estimate for blocks of size 2^( 7) =       0.000550337918

      target function =      -0.745114179943
              le_mean =     -22.660990108027
             les_mean =     513.970706094511
             stat err =       0.000542441248
             autocorr =       1.334440447711
   target nu stat err =       0.000542441248
   target dn stat err =       0.002657934304
      target stat err =       0.002255959145
              std dev =       0.664076490087
             le_variance =       0.440997584687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742593891525        initial
     2.5000e-01     2.5000e+00             9.8769e-04        -0.740885054362
     1.0000e+00     1.0000e+01             2.7606e-04        -0.745128357020  <--
     4.0000e+00     4.0000e+01             7.1116e-05        -0.745114179943

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3606e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -7.013421e-01 3 1  ON 0
ci_002                -7.063174e-01 3 1  ON 1
ci_003                -5.424489e-02 3 1  ON 2
ci_004                -5.535884e-02 3 1  ON 3
ci_005                 2.066737e-02 3 1  ON 4
ci_006                 2.078250e-02 3 1  ON 5
ci_007                 1.698813e-02 3 1  ON 6
ci_008                 1.703227e-02 3 1  ON 7
ci_009                -1.302976e-02 3 1  ON 8
ci_010                -1.335691e-02 3 1  ON 9
ci_011                -1.051208e-02 3 1  ON 10
ci_012                -1.062872e-02 3 1  ON 11
ci_013                 9.490858e-03 3 1  ON 12
ci_014                 9.684687e-03 3 1  ON 13
ci_015                 9.875047e-03 3 1  ON 14
ci_016                 1.055424e-02 3 1  ON 15
ci_017                 8.671007e-03 3 1  ON 16
ci_018                 8.746694e-03 3 1  ON 17
ci_019                 1.443640e-04 3 1  ON 18
ci_020                 2.763905e-04 3 1  ON 19
ci_021                -9.220790e-03 3 1  ON 20
ci_022                -1.039980e-02 3 1  ON 21
ci_023                 5.754273e-03 3 1  ON 22
ci_024                 5.123681e-03 3 1  ON 23
ci_025                 1.214461e-02 3 1  ON 24
ci_026                 1.178672e-02 3 1  ON 25
ci_027                 6.364428e-03 3 1  ON 26
ci_028                 6.436014e-03 3 1  ON 27
ci_029                -3.942926e-03 3 1  ON 28
ci_030                -4.698242e-03 3 1  ON 29
ci_031                 2.892692e-03 3 1  ON 30
ci_032                 2.753168e-03 3 1  ON 31
ci_033                 3.731471e-03 3 1  ON 32
ci_034                 3.661889e-03 3 1  ON 33
ci_035                 2.618721e-03 3 1  ON 34
ci_036                 2.259406e-03 3 1  ON 35
ci_037                 3.410468e-03 3 1  ON 36
ci_038                 3.847818e-03 3 1  ON 37
ci_039                 4.431148e-03 3 1  ON 38
ci_040                 4.508054e-03 3 1  ON 39
ci_041                 2.782150e-03 3 1  ON 40
ci_042                 3.061498e-03 3 1  ON 41
ci_043                 3.601280e-03 3 1  ON 42
ci_044                 3.385013e-03 3 1  ON 43
ci_045                 2.632178e-03 3 1  ON 44
ci_046                 2.764263e-03 3 1  ON 45
ci_047                -1.180035e-03 3 1  ON 46
ci_048                -1.365368e-03 3 1  ON 47
ci_049                 1.102344e-03 3 1  ON 48
ci_050                 8.884769e-04 3 1  ON 49
ci_051                -1.733538e-03 3 1  ON 50
ci_052                -1.926807e-03 3 1  ON 51
ci_053                -2.566118e-03 3 1  ON 52
ci_054                -2.617981e-03 3 1  ON 53
ci_055                -1.953760e-03 3 1  ON 54
ci_056                -1.344549e-03 3 1  ON 55
ci_057                -1.348855e-03 3 1  ON 56
ci_058                -1.093733e-03 3 1  ON 57
ci_059                -4.842145e-04 3 1  ON 58
ci_060                -4.717606e-04 3 1  ON 59
ci_061                -6.418147e-04 3 1  ON 60
ci_062                -5.003747e-04 3 1  ON 61
ci_063                -6.371640e-04 3 1  ON 62
ci_064                -9.030418e-04 3 1  ON 63
ci_065                -1.816133e-03 3 1  ON 64
ci_066                -1.741980e-03 3 1  ON 65
ci_067                -1.413849e-03 3 1  ON 66
ci_068                -1.637576e-03 3 1  ON 67
ci_069                 1.952216e-04 3 1  ON 68
ci_070                 2.078079e-04 3 1  ON 69
ci_071                -1.644211e-03 3 1  ON 70
ci_072                -2.029174e-03 3 1  ON 71
ci_073                 1.360231e-04 3 1  ON 72
ci_074                 3.594786e-04 3 1  ON 73
ci_075                 6.518844e-06 3 1  ON 74
ci_076                 2.293817e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2649e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6256
    reference variance = 0.421317
====================================================
  Execution time = 2.6102e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5189e-01
  Total weights = 1.955259362e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441902882881
                                         uncertainty =       0.002891417399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441902882881
                                         uncertainty =       0.002891417399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470029000
  error estimate for blocks of size 2^( 2) =       0.000493795657
  error estimate for blocks of size 2^( 3) =       0.000515581055
  error estimate for blocks of size 2^( 4) =       0.000532389594
  error estimate for blocks of size 2^( 5) =       0.000540574845
  error estimate for blocks of size 2^( 6) =       0.000546635328
  error estimate for blocks of size 2^( 7) =       0.000548385428

      target function =      -0.743765024772
              le_mean =     -22.661730523676
             les_mean =     514.005918670707
             stat err =       0.000541996299
             autocorr =       1.329668357922
   target nu stat err =       0.000541996299
   target dn stat err =       0.003307711019
      target stat err =       0.002765671098
              std dev =       0.664721386344
             le_variance =       0.441854521463


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266173052368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743774489782       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743879337375       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743904017889       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743906745073       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743906624376       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743906678958       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743906597578       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743906572089       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743906573935       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743906564465       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.095303e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743774489782       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743804381672       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743811044162       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743811743123       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743811702030       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743811714400       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743811694331       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743811689726       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743811690425       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743811688577       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.039231e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743774489782       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743782234533       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743783932933       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743784108401       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743784097331       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743784100323       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743784095346       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743784094322       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743784094509       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743784094082       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 7.812788e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0811e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -7.013313e-01 3 1  ON 0
ci_002                -7.063461e-01 3 1  ON 1
ci_003                -5.426025e-02 3 1  ON 2
ci_004                -5.538644e-02 3 1  ON 3
ci_005                 2.054304e-02 3 1  ON 4
ci_006                 2.058456e-02 3 1  ON 5
ci_007                 1.683247e-02 3 1  ON 6
ci_008                 1.686573e-02 3 1  ON 7
ci_009                -1.296908e-02 3 1  ON 8
ci_010                -1.328718e-02 3 1  ON 9
ci_011                -1.048285e-02 3 1  ON 10
ci_012                -1.057457e-02 3 1  ON 11
ci_013                 9.428242e-03 3 1  ON 12
ci_014                 9.571830e-03 3 1  ON 13
ci_015                 9.847262e-03 3 1  ON 14
ci_016                 1.046122e-02 3 1  ON 15
ci_017                 8.670800e-03 3 1  ON 16
ci_018                 8.738933e-03 3 1  ON 17
ci_019                 1.440222e-04 3 1  ON 18
ci_020                -2.753259e-05 3 1  ON 19
ci_021                -9.429954e-03 3 1  ON 20
ci_022                -1.037172e-02 3 1  ON 21
ci_023                 5.759179e-03 3 1  ON 22
ci_024                 5.069200e-03 3 1  ON 23
ci_025                 1.218611e-02 3 1  ON 24
ci_026                 1.195703e-02 3 1  ON 25
ci_027                 6.352151e-03 3 1  ON 26
ci_028                 6.415834e-03 3 1  ON 27
ci_029                -3.902202e-03 3 1  ON 28
ci_030                -4.667764e-03 3 1  ON 29
ci_031                 3.057739e-03 3 1  ON 30
ci_032                 2.819873e-03 3 1  ON 31
ci_033                 3.729452e-03 3 1  ON 32
ci_034                 3.647909e-03 3 1  ON 33
ci_035                 2.637076e-03 3 1  ON 34
ci_036                 2.172764e-03 3 1  ON 35
ci_037                 3.420891e-03 3 1  ON 36
ci_038                 3.820535e-03 3 1  ON 37
ci_039                 4.435363e-03 3 1  ON 38
ci_040                 4.451398e-03 3 1  ON 39
ci_041                 2.790550e-03 3 1  ON 40
ci_042                 3.009727e-03 3 1  ON 41
ci_043                 3.610483e-03 3 1  ON 42
ci_044                 3.318614e-03 3 1  ON 43
ci_045                 2.600026e-03 3 1  ON 44
ci_046                 2.721229e-03 3 1  ON 45
ci_047                -1.205072e-03 3 1  ON 46
ci_048                -1.322475e-03 3 1  ON 47
ci_049                 1.136129e-03 3 1  ON 48
ci_050                 9.049774e-04 3 1  ON 49
ci_051                -1.737920e-03 3 1  ON 50
ci_052                -1.798774e-03 3 1  ON 51
ci_053                -2.526110e-03 3 1  ON 52
ci_054                -2.683842e-03 3 1  ON 53
ci_055                -1.918813e-03 3 1  ON 54
ci_056                -1.327280e-03 3 1  ON 55
ci_057                -1.270866e-03 3 1  ON 56
ci_058                -1.149002e-03 3 1  ON 57
ci_059                -4.405317e-04 3 1  ON 58
ci_060                -4.693500e-04 3 1  ON 59
ci_061                -5.991737e-04 3 1  ON 60
ci_062                -5.047123e-04 3 1  ON 61
ci_063                -6.613521e-04 3 1  ON 62
ci_064                -9.345440e-04 3 1  ON 63
ci_065                -1.795026e-03 3 1  ON 64
ci_066                -1.801008e-03 3 1  ON 65
ci_067                -1.402636e-03 3 1  ON 66
ci_068                -1.651821e-03 3 1  ON 67
ci_069                 2.088705e-04 3 1  ON 68
ci_070                 2.124139e-04 3 1  ON 69
ci_071                -1.576489e-03 3 1  ON 70
ci_072                -2.098641e-03 3 1  ON 71
ci_073                 1.392363e-04 3 1  ON 72
ci_074                 3.149030e-04 3 1  ON 73
ci_075                 4.623239e-05 3 1  ON 74
ci_076                 2.659929e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6678
    reference variance = 0.472904
====================================================
  Execution time = 2.7289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5904e-01
  Total weights = 1.9553e+06
  Execution time = 3.5989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444803395125
                                         uncertainty =       0.002827372734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444803395125
                                         uncertainty =       0.002827372734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471590157
  error estimate for blocks of size 2^( 2) =       0.000495637187
  error estimate for blocks of size 2^( 3) =       0.000518232559
  error estimate for blocks of size 2^( 4) =       0.000533604914
  error estimate for blocks of size 2^( 5) =       0.000542079451
  error estimate for blocks of size 2^( 6) =       0.000545094107
  error estimate for blocks of size 2^( 7) =       0.000548271489

      target function =      -0.739393088991
              le_mean =     -22.662363045773
             les_mean =     514.039964078334
             stat err =       0.000542262490
             autocorr =       1.322177200631
   target nu stat err =       0.000542262490
   target dn stat err =       0.004510275351
      target stat err =       0.003690972584
              std dev =       0.666929196387
             le_variance =       0.444794552993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444530833500
                                         uncertainty =       0.002776435964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444530833500
                                         uncertainty =       0.002776435964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471445377
  error estimate for blocks of size 2^( 2) =       0.000495524809
  error estimate for blocks of size 2^( 3) =       0.000518144367
  error estimate for blocks of size 2^( 4) =       0.000533523707
  error estimate for blocks of size 2^( 5) =       0.000542012383
  error estimate for blocks of size 2^( 6) =       0.000545028233
  error estimate for blocks of size 2^( 7) =       0.000548185597

      target function =      -0.730851062557
              le_mean =     -22.662369133414
             les_mean =     514.050894522955
             stat err =       0.000542187480
             autocorr =       1.322623412804
   target nu stat err =       0.000542187480
   target dn stat err =       0.007862370074
      target stat err =       0.006232765295
              std dev =       0.666724446582
             le_variance =       0.444521487670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444630155430
                                         uncertainty =       0.002797280517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444630155430
                                         uncertainty =       0.002797280517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471498167
  error estimate for blocks of size 2^( 2) =       0.000495563011
  error estimate for blocks of size 2^( 3) =       0.000518174706
  error estimate for blocks of size 2^( 4) =       0.000533550846
  error estimate for blocks of size 2^( 5) =       0.000542033225
  error estimate for blocks of size 2^( 6) =       0.000545050198
  error estimate for blocks of size 2^( 7) =       0.000548212741

      target function =      -0.738891719098
              le_mean =     -22.662363710934
             les_mean =     514.040615435661
             stat err =       0.000542211753
             autocorr =       1.322445659109
   target nu stat err =       0.000542211753
   target dn stat err =       0.004505303072
      target stat err =       0.003682068812
              std dev =       0.666799103009
             le_variance =       0.444621043774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444778541223
                                         uncertainty =       0.002823329270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444778541223
                                         uncertainty =       0.002823329270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471576964
  error estimate for blocks of size 2^( 2) =       0.000495626326
  error estimate for blocks of size 2^( 3) =       0.000518223790
  error estimate for blocks of size 2^( 4) =       0.000533596585
  error estimate for blocks of size 2^( 5) =       0.000542072168
  error estimate for blocks of size 2^( 6) =       0.000545087213
  error estimate for blocks of size 2^( 7) =       0.000548262900

      target function =      -0.739394011565
              le_mean =     -22.662362860743
             les_mean =     514.039954588371
             stat err =       0.000542254717
             autocorr =       1.322213270980
   target nu stat err =       0.000542254717
   target dn stat err =       0.004506397791
      target stat err =       0.003687887721
              std dev =       0.666910538438
             le_variance =       0.444769666279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739393088991        initial
     2.5000e-01     2.5000e+00             1.0953e-03        -0.730851062557
     1.0000e+00     1.0000e+01             3.0392e-04        -0.738891719098
     4.0000e+00     4.0000e+01             7.8128e-05        -0.739394011565  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.5542e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -7.013394e-01 3 1  ON 0
ci_002                -7.063247e-01 3 1  ON 1
ci_003                -5.424864e-02 3 1  ON 2
ci_004                -5.536575e-02 3 1  ON 3
ci_005                 2.063510e-02 3 1  ON 4
ci_006                 2.073114e-02 3 1  ON 5
ci_007                 1.694793e-02 3 1  ON 6
ci_008                 1.698934e-02 3 1  ON 7
ci_009                -1.301408e-02 3 1  ON 8
ci_010                -1.333887e-02 3 1  ON 9
ci_011                -1.050451e-02 3 1  ON 10
ci_012                -1.061477e-02 3 1  ON 11
ci_013                 9.474714e-03 3 1  ON 12
ci_014                 9.655611e-03 3 1  ON 13
ci_015                 9.867885e-03 3 1  ON 14
ci_016                 1.053036e-02 3 1  ON 15
ci_017                 8.670919e-03 3 1  ON 16
ci_018                 8.744675e-03 3 1  ON 17
ci_019                 1.442899e-04 3 1  ON 18
ci_020                 1.982626e-04 3 1  ON 19
ci_021                -9.274527e-03 3 1  ON 20
ci_022                -1.039262e-02 3 1  ON 21
ci_023                 5.755546e-03 3 1  ON 22
ci_024                 5.109583e-03 3 1  ON 23
ci_025                 1.215529e-02 3 1  ON 24
ci_026                 1.183050e-02 3 1  ON 25
ci_027                 6.361258e-03 3 1  ON 26
ci_028                 6.430764e-03 3 1  ON 27
ci_029                -3.932413e-03 3 1  ON 28
ci_030                -4.690405e-03 3 1  ON 29
ci_031                 2.935108e-03 3 1  ON 30
ci_032                 2.770315e-03 3 1  ON 31
ci_033                 3.730951e-03 3 1  ON 32
ci_034                 3.658268e-03 3 1  ON 33
ci_035                 2.623503e-03 3 1  ON 34
ci_036                 2.236905e-03 3 1  ON 35
ci_037                 3.413158e-03 3 1  ON 36
ci_038                 3.840784e-03 3 1  ON 37
ci_039                 4.432232e-03 3 1  ON 38
ci_040                 4.493318e-03 3 1  ON 39
ci_041                 2.784326e-03 3 1  ON 40
ci_042                 3.048063e-03 3 1  ON 41
ci_043                 3.603657e-03 3 1  ON 42
ci_044                 3.367938e-03 3 1  ON 43
ci_045                 2.623891e-03 3 1  ON 44
ci_046                 2.753173e-03 3 1  ON 45
ci_047                -1.186573e-03 3 1  ON 46
ci_048                -1.354226e-03 3 1  ON 47
ci_049                 1.111079e-03 3 1  ON 48
ci_050                 8.927477e-04 3 1  ON 49
ci_051                -1.734691e-03 3 1  ON 50
ci_052                -1.893913e-03 3 1  ON 51
ci_053                -2.555794e-03 3 1  ON 52
ci_054                -2.634916e-03 3 1  ON 53
ci_055                -1.944757e-03 3 1  ON 54
ci_056                -1.340098e-03 3 1  ON 55
ci_057                -1.328676e-03 3 1  ON 56
ci_058                -1.108034e-03 3 1  ON 57
ci_059                -4.728862e-04 3 1  ON 58
ci_060                -4.711434e-04 3 1  ON 59
ci_061                -6.308169e-04 3 1  ON 60
ci_062                -5.015110e-04 3 1  ON 61
ci_063                -6.433717e-04 3 1  ON 62
ci_064                -9.111470e-04 3 1  ON 63
ci_065                -1.810686e-03 3 1  ON 64
ci_066                -1.757199e-03 3 1  ON 65
ci_067                -1.410949e-03 3 1  ON 66
ci_068                -1.641236e-03 3 1  ON 67
ci_069                 1.987644e-04 3 1  ON 68
ci_070                 2.089834e-04 3 1  ON 69
ci_071                -1.626748e-03 3 1  ON 70
ci_072                -2.047100e-03 3 1  ON 71
ci_073                 1.368785e-04 3 1  ON 72
ci_074                 3.479218e-04 3 1  ON 73
ci_075                 1.677457e-05 3 1  ON 74
ci_076                 2.388300e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2649e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.72
    reference variance = 0.407328
====================================================
  Execution time = 2.6091e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4682e-01
  Total weights = 1.954866363e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437044054882
                                         uncertainty =       0.002001171792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437044054882
                                         uncertainty =       0.002001171792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467434504
  error estimate for blocks of size 2^( 2) =       0.000491822975
  error estimate for blocks of size 2^( 3) =       0.000513987215
  error estimate for blocks of size 2^( 4) =       0.000529456847
  error estimate for blocks of size 2^( 5) =       0.000539515802
  error estimate for blocks of size 2^( 6) =       0.000543788544
  error estimate for blocks of size 2^( 7) =       0.000547844084

      target function =      -0.747927306331
              le_mean =     -22.661480744602
             les_mean =     513.989528658675
             stat err =       0.000540151319
             autocorr =       1.335332284069
   target nu stat err =       0.000540151319
   target dn stat err =       0.002649952176
      target stat err =       0.002267054190
              std dev =       0.661052214622
             le_variance =       0.436990030457


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266148074460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747933217691       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747952449702       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747956614255       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747956745025       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747956824118       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747956813378       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747956827699       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747956833743       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747956812696       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747956808221       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747956812369       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747956819734       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.299093e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747933217691       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747938198844       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747939257528       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747939289687       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747939309283       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747939306313       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747939309757       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747939311207       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747939305982       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747939305017       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747939306133       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747939307810       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 5.912142e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747933217691       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747934474292       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747934740064       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747934748067       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747934752954       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747934752193       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747934753046       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747934753404       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747934752100       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747934751870       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747934752153       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747934752562       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 1.488680e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0786e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -7.013602e-01 3 1  ON 0
ci_002                -7.063074e-01 3 1  ON 1
ci_003                -5.423176e-02 3 1  ON 2
ci_004                -5.539250e-02 3 1  ON 3
ci_005                 2.060871e-02 3 1  ON 4
ci_006                 2.069898e-02 3 1  ON 5
ci_007                 1.691479e-02 3 1  ON 6
ci_008                 1.696833e-02 3 1  ON 7
ci_009                -1.300098e-02 3 1  ON 8
ci_010                -1.332045e-02 3 1  ON 9
ci_011                -1.049782e-02 3 1  ON 10
ci_012                -1.061118e-02 3 1  ON 11
ci_013                 9.452574e-03 3 1  ON 12
ci_014                 9.627021e-03 3 1  ON 13
ci_015                 9.869318e-03 3 1  ON 14
ci_016                 1.050249e-02 3 1  ON 15
ci_017                 8.658365e-03 3 1  ON 16
ci_018                 8.726382e-03 3 1  ON 17
ci_019                 9.948439e-05 3 1  ON 18
ci_020                 1.924703e-04 3 1  ON 19
ci_021                -9.299274e-03 3 1  ON 20
ci_022                -1.042765e-02 3 1  ON 21
ci_023                 5.754291e-03 3 1  ON 22
ci_024                 5.108709e-03 3 1  ON 23
ci_025                 1.217202e-02 3 1  ON 24
ci_026                 1.184355e-02 3 1  ON 25
ci_027                 6.348916e-03 3 1  ON 26
ci_028                 6.424640e-03 3 1  ON 27
ci_029                -3.918280e-03 3 1  ON 28
ci_030                -4.679434e-03 3 1  ON 29
ci_031                 2.978279e-03 3 1  ON 30
ci_032                 2.829437e-03 3 1  ON 31
ci_033                 3.718409e-03 3 1  ON 32
ci_034                 3.649565e-03 3 1  ON 33
ci_035                 2.612061e-03 3 1  ON 34
ci_036                 2.227611e-03 3 1  ON 35
ci_037                 3.416355e-03 3 1  ON 36
ci_038                 3.844459e-03 3 1  ON 37
ci_039                 4.417565e-03 3 1  ON 38
ci_040                 4.489345e-03 3 1  ON 39
ci_041                 2.786863e-03 3 1  ON 40
ci_042                 3.060801e-03 3 1  ON 41
ci_043                 3.592722e-03 3 1  ON 42
ci_044                 3.373708e-03 3 1  ON 43
ci_045                 2.635331e-03 3 1  ON 44
ci_046                 2.736885e-03 3 1  ON 45
ci_047                -1.186344e-03 3 1  ON 46
ci_048                -1.358418e-03 3 1  ON 47
ci_049                 1.107712e-03 3 1  ON 48
ci_050                 8.952707e-04 3 1  ON 49
ci_051                -1.724018e-03 3 1  ON 50
ci_052                -1.887915e-03 3 1  ON 51
ci_053                -2.560523e-03 3 1  ON 52
ci_054                -2.636986e-03 3 1  ON 53
ci_055                -1.946999e-03 3 1  ON 54
ci_056                -1.336196e-03 3 1  ON 55
ci_057                -1.326784e-03 3 1  ON 56
ci_058                -1.109041e-03 3 1  ON 57
ci_059                -4.754238e-04 3 1  ON 58
ci_060                -4.539043e-04 3 1  ON 59
ci_061                -6.196729e-04 3 1  ON 60
ci_062                -5.030274e-04 3 1  ON 61
ci_063                -6.437284e-04 3 1  ON 62
ci_064                -9.260522e-04 3 1  ON 63
ci_065                -1.808077e-03 3 1  ON 64
ci_066                -1.754690e-03 3 1  ON 65
ci_067                -1.406968e-03 3 1  ON 66
ci_068                -1.623891e-03 3 1  ON 67
ci_069                 2.016642e-04 3 1  ON 68
ci_070                 2.052405e-04 3 1  ON 69
ci_071                -1.641714e-03 3 1  ON 70
ci_072                -2.035017e-03 3 1  ON 71
ci_073                 1.360664e-04 3 1  ON 72
ci_074                 3.488644e-04 3 1  ON 73
ci_075                 3.435280e-05 3 1  ON 74
ci_076                 2.398996e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6512
    reference variance = 0.336091
====================================================
  Execution time = 2.5271e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5330e-01
  Total weights = 1.9553e+06
  Execution time = 3.5856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442680054121
                                         uncertainty =       0.003417875386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442680054121
                                         uncertainty =       0.003417875386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470464827
  error estimate for blocks of size 2^( 2) =       0.000494739673
  error estimate for blocks of size 2^( 3) =       0.000517144543
  error estimate for blocks of size 2^( 4) =       0.000532520500
  error estimate for blocks of size 2^( 5) =       0.000541572542
  error estimate for blocks of size 2^( 6) =       0.000546886562
  error estimate for blocks of size 2^( 7) =       0.000548048872

      target function =      -0.742651983034
              le_mean =     -22.662359832853
             les_mean =     514.035794720351
             stat err =       0.000542257119
             autocorr =       1.328483618705
   target nu stat err =       0.000542257119
   target dn stat err =       0.005113508405
      target stat err =       0.004209145998
              std dev =       0.665337739453
             le_variance =       0.442674307541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442637215254
                                         uncertainty =       0.003429165870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442637215254
                                         uncertainty =       0.003429165870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470442014
  error estimate for blocks of size 2^( 2) =       0.000494722487
  error estimate for blocks of size 2^( 3) =       0.000517132969
  error estimate for blocks of size 2^( 4) =       0.000532512446
  error estimate for blocks of size 2^( 5) =       0.000541568250
  error estimate for blocks of size 2^( 6) =       0.000546880929
  error estimate for blocks of size 2^( 7) =       0.000548034738

      target function =      -0.742597569215
              le_mean =     -22.662360900827
             les_mean =     514.035909599954
             stat err =       0.000542249091
             autocorr =       1.328573125162
   target nu stat err =       0.000542249091
   target dn stat err =       0.005141535505
      target stat err =       0.004231149467
              std dev =       0.665305477061
             le_variance =       0.442631377807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442657188538
                                         uncertainty =       0.003423688296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442657188538
                                         uncertainty =       0.003423688296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470452651
  error estimate for blocks of size 2^( 2) =       0.000494730407
  error estimate for blocks of size 2^( 3) =       0.000517138198
  error estimate for blocks of size 2^( 4) =       0.000532516017
  error estimate for blocks of size 2^( 5) =       0.000541570023
  error estimate for blocks of size 2^( 6) =       0.000546883344
  error estimate for blocks of size 2^( 7) =       0.000548041302

      target function =      -0.742564484380
              le_mean =     -22.662360269474
             les_mean =     514.035921738492
             stat err =       0.000542252672
             autocorr =       1.328530594605
   target nu stat err =       0.000542252672
   target dn stat err =       0.005128533432
      target stat err =       0.004220285000
              std dev =       0.665320519755
             le_variance =       0.442651394007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442677083263
                                         uncertainty =       0.003418604818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442677083263
                                         uncertainty =       0.003418604818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470463245
  error estimate for blocks of size 2^( 2) =       0.000494738459
  error estimate for blocks of size 2^( 3) =       0.000517143694
  error estimate for blocks of size 2^( 4) =       0.000532519884
  error estimate for blocks of size 2^( 5) =       0.000541572181
  error estimate for blocks of size 2^( 6) =       0.000546886105
  error estimate for blocks of size 2^( 7) =       0.000548047884

      target function =      -0.742651379747
              le_mean =     -22.662359880027
             les_mean =     514.035797579869
             stat err =       0.000542256513
             autocorr =       1.328489585542
   target nu stat err =       0.000542256513
   target dn stat err =       0.005115220573
      target stat err =       0.004210520715
              std dev =       0.665335502308
             le_variance =       0.442671330632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742651983034        initial  <--
     1.0000e+00     1.0000e+01             2.2991e-04        -0.742597569215
     4.0000e+00     4.0000e+01             5.9121e-05        -0.742564484380
     1.6000e+01     1.6000e+02             1.4887e-05        -0.742651379747

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2258
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -7.013394e-01 3 1  ON 0
ci_002                -7.063247e-01 3 1  ON 1
ci_003                -5.424864e-02 3 1  ON 2
ci_004                -5.536575e-02 3 1  ON 3
ci_005                 2.063510e-02 3 1  ON 4
ci_006                 2.073114e-02 3 1  ON 5
ci_007                 1.694793e-02 3 1  ON 6
ci_008                 1.698934e-02 3 1  ON 7
ci_009                -1.301408e-02 3 1  ON 8
ci_010                -1.333887e-02 3 1  ON 9
ci_011                -1.050451e-02 3 1  ON 10
ci_012                -1.061477e-02 3 1  ON 11
ci_013                 9.474714e-03 3 1  ON 12
ci_014                 9.655611e-03 3 1  ON 13
ci_015                 9.867885e-03 3 1  ON 14
ci_016                 1.053036e-02 3 1  ON 15
ci_017                 8.670919e-03 3 1  ON 16
ci_018                 8.744675e-03 3 1  ON 17
ci_019                 1.442899e-04 3 1  ON 18
ci_020                 1.982626e-04 3 1  ON 19
ci_021                -9.274527e-03 3 1  ON 20
ci_022                -1.039262e-02 3 1  ON 21
ci_023                 5.755546e-03 3 1  ON 22
ci_024                 5.109583e-03 3 1  ON 23
ci_025                 1.215529e-02 3 1  ON 24
ci_026                 1.183050e-02 3 1  ON 25
ci_027                 6.361258e-03 3 1  ON 26
ci_028                 6.430764e-03 3 1  ON 27
ci_029                -3.932413e-03 3 1  ON 28
ci_030                -4.690405e-03 3 1  ON 29
ci_031                 2.935108e-03 3 1  ON 30
ci_032                 2.770315e-03 3 1  ON 31
ci_033                 3.730951e-03 3 1  ON 32
ci_034                 3.658268e-03 3 1  ON 33
ci_035                 2.623503e-03 3 1  ON 34
ci_036                 2.236905e-03 3 1  ON 35
ci_037                 3.413158e-03 3 1  ON 36
ci_038                 3.840784e-03 3 1  ON 37
ci_039                 4.432232e-03 3 1  ON 38
ci_040                 4.493318e-03 3 1  ON 39
ci_041                 2.784326e-03 3 1  ON 40
ci_042                 3.048063e-03 3 1  ON 41
ci_043                 3.603657e-03 3 1  ON 42
ci_044                 3.367938e-03 3 1  ON 43
ci_045                 2.623891e-03 3 1  ON 44
ci_046                 2.753173e-03 3 1  ON 45
ci_047                -1.186573e-03 3 1  ON 46
ci_048                -1.354226e-03 3 1  ON 47
ci_049                 1.111079e-03 3 1  ON 48
ci_050                 8.927477e-04 3 1  ON 49
ci_051                -1.734691e-03 3 1  ON 50
ci_052                -1.893913e-03 3 1  ON 51
ci_053                -2.555794e-03 3 1  ON 52
ci_054                -2.634916e-03 3 1  ON 53
ci_055                -1.944757e-03 3 1  ON 54
ci_056                -1.340098e-03 3 1  ON 55
ci_057                -1.328676e-03 3 1  ON 56
ci_058                -1.108034e-03 3 1  ON 57
ci_059                -4.728862e-04 3 1  ON 58
ci_060                -4.711434e-04 3 1  ON 59
ci_061                -6.308169e-04 3 1  ON 60
ci_062                -5.015110e-04 3 1  ON 61
ci_063                -6.433717e-04 3 1  ON 62
ci_064                -9.111470e-04 3 1  ON 63
ci_065                -1.810686e-03 3 1  ON 64
ci_066                -1.757199e-03 3 1  ON 65
ci_067                -1.410949e-03 3 1  ON 66
ci_068                -1.641236e-03 3 1  ON 67
ci_069                 1.987644e-04 3 1  ON 68
ci_070                 2.089834e-04 3 1  ON 69
ci_071                -1.626748e-03 3 1  ON 70
ci_072                -2.047100e-03 3 1  ON 71
ci_073                 1.368785e-04 3 1  ON 72
ci_074                 3.479218e-04 3 1  ON 73
ci_075                 1.677457e-05 3 1  ON 74
ci_076                 2.388300e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6504
    reference variance = 0.252172
====================================================
  Execution time = 2.6059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4601e-01
  Total weights = 1.954582549e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435811775695
                                         uncertainty =       0.001485172125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435811775695
                                         uncertainty =       0.001485172125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466803321
  error estimate for blocks of size 2^( 2) =       0.000491081085
  error estimate for blocks of size 2^( 3) =       0.000513457140
  error estimate for blocks of size 2^( 4) =       0.000529444672
  error estimate for blocks of size 2^( 5) =       0.000538814704
  error estimate for blocks of size 2^( 6) =       0.000543707954
  error estimate for blocks of size 2^( 7) =       0.000543558410

      target function =      -0.748597438246
              le_mean =     -22.661343856788
             les_mean =     513.982510455515
             stat err =       0.000538881435
             autocorr =       1.332657565413
   target nu stat err =       0.000538881435
   target dn stat err =       0.002681592543
      target stat err =       0.002295404920
              std dev =       0.660159587798
             le_variance =       0.435810681362


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266134385679e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748603517971       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748608749067       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748609305235       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748609391287       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748609411336       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748609415902       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748609422717       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748609419120       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748609418414       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748609418845       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748609418403       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748609418422       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.504003e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748603517971       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748604830744       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748604970061       residual = 7.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748604991584       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748604996593       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748604997726       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748604999423       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748604998525       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748604998349       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748604998457       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748604998346       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748604998351       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 6.285278e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748603517971       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748603846479       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748603881325       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748603886706       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748603887958       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748603888241       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748603888665       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748603888441       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748603888397       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748603888424       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748603888396       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748603888397       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+02 is 1.572907e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104936 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0767e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -7.013407e-01 3 1  ON 0
ci_002                -7.063244e-01 3 1  ON 1
ci_003                -5.424332e-02 3 1  ON 2
ci_004                -5.536262e-02 3 1  ON 3
ci_005                 2.063311e-02 3 1  ON 4
ci_006                 2.072680e-02 3 1  ON 5
ci_007                 1.694552e-02 3 1  ON 6
ci_008                 1.698631e-02 3 1  ON 7
ci_009                -1.301420e-02 3 1  ON 8
ci_010                -1.333726e-02 3 1  ON 9
ci_011                -1.050200e-02 3 1  ON 10
ci_012                -1.061154e-02 3 1  ON 11
ci_013                 9.472020e-03 3 1  ON 12
ci_014                 9.654259e-03 3 1  ON 13
ci_015                 9.866019e-03 3 1  ON 14
ci_016                 1.052860e-02 3 1  ON 15
ci_017                 8.670921e-03 3 1  ON 16
ci_018                 8.740945e-03 3 1  ON 17
ci_019                 1.409273e-04 3 1  ON 18
ci_020                 1.934953e-04 3 1  ON 19
ci_021                -9.279490e-03 3 1  ON 20
ci_022                -1.039537e-02 3 1  ON 21
ci_023                 5.753795e-03 3 1  ON 22
ci_024                 5.111072e-03 3 1  ON 23
ci_025                 1.215653e-02 3 1  ON 24
ci_026                 1.183416e-02 3 1  ON 25
ci_027                 6.360724e-03 3 1  ON 26
ci_028                 6.431322e-03 3 1  ON 27
ci_029                -3.934390e-03 3 1  ON 28
ci_030                -4.688870e-03 3 1  ON 29
ci_031                 2.939790e-03 3 1  ON 30
ci_032                 2.775313e-03 3 1  ON 31
ci_033                 3.731027e-03 3 1  ON 32
ci_034                 3.656885e-03 3 1  ON 33
ci_035                 2.623318e-03 3 1  ON 34
ci_036                 2.236465e-03 3 1  ON 35
ci_037                 3.414716e-03 3 1  ON 36
ci_038                 3.840919e-03 3 1  ON 37
ci_039                 4.433524e-03 3 1  ON 38
ci_040                 4.492655e-03 3 1  ON 39
ci_041                 2.785256e-03 3 1  ON 40
ci_042                 3.047774e-03 3 1  ON 41
ci_043                 3.603329e-03 3 1  ON 42
ci_044                 3.367716e-03 3 1  ON 43
ci_045                 2.622029e-03 3 1  ON 44
ci_046                 2.757946e-03 3 1  ON 45
ci_047                -1.186475e-03 3 1  ON 46
ci_048                -1.354099e-03 3 1  ON 47
ci_049                 1.111140e-03 3 1  ON 48
ci_050                 8.918709e-04 3 1  ON 49
ci_051                -1.734635e-03 3 1  ON 50
ci_052                -1.894629e-03 3 1  ON 51
ci_053                -2.560408e-03 3 1  ON 52
ci_054                -2.634938e-03 3 1  ON 53
ci_055                -1.943618e-03 3 1  ON 54
ci_056                -1.339224e-03 3 1  ON 55
ci_057                -1.329114e-03 3 1  ON 56
ci_058                -1.107590e-03 3 1  ON 57
ci_059                -4.727733e-04 3 1  ON 58
ci_060                -4.710467e-04 3 1  ON 59
ci_061                -6.304571e-04 3 1  ON 60
ci_062                -5.016457e-04 3 1  ON 61
ci_063                -6.454129e-04 3 1  ON 62
ci_064                -9.095986e-04 3 1  ON 63
ci_065                -1.815014e-03 3 1  ON 64
ci_066                -1.758017e-03 3 1  ON 65
ci_067                -1.412505e-03 3 1  ON 66
ci_068                -1.637800e-03 3 1  ON 67
ci_069                 2.050497e-04 3 1  ON 68
ci_070                 2.096673e-04 3 1  ON 69
ci_071                -1.627401e-03 3 1  ON 70
ci_072                -2.049605e-03 3 1  ON 71
ci_073                 1.359309e-04 3 1  ON 72
ci_074                 3.472412e-04 3 1  ON 73
ci_075                 2.033502e-05 3 1  ON 74
ci_076                 2.382688e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6009
    reference variance = 0.421223
====================================================
  Execution time = 2.5248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5417e-01
  Total weights = 1.9554e+06
  Execution time = 3.6043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445016863842
                                         uncertainty =       0.002618205603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445016863842
                                         uncertainty =       0.002618205603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471703462
  error estimate for blocks of size 2^( 2) =       0.000495484831
  error estimate for blocks of size 2^( 3) =       0.000517343741
  error estimate for blocks of size 2^( 4) =       0.000534169104
  error estimate for blocks of size 2^( 5) =       0.000545204931
  error estimate for blocks of size 2^( 6) =       0.000550577965
  error estimate for blocks of size 2^( 7) =       0.000553478751

      target function =      -0.741906554360
              le_mean =     -22.662362263351
             les_mean =     514.036839242292
             stat err =       0.000545857688
             autocorr =       1.339123818318
   target nu stat err =       0.000545857688
   target dn stat err =       0.003079492771
      target stat err =       0.002574815417
              std dev =       0.667089433549
             le_variance =       0.445008312352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445006166975
                                         uncertainty =       0.002617524592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445006166975
                                         uncertainty =       0.002617524592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471697778
  error estimate for blocks of size 2^( 2) =       0.000495479623
  error estimate for blocks of size 2^( 3) =       0.000517338894
  error estimate for blocks of size 2^( 4) =       0.000534164584
  error estimate for blocks of size 2^( 5) =       0.000545200155
  error estimate for blocks of size 2^( 6) =       0.000550573460
  error estimate for blocks of size 2^( 7) =       0.000553474780

      target function =      -0.741917143102
              le_mean =     -22.662362146594
             les_mean =     514.036820932687
             stat err =       0.000545853245
             autocorr =       1.339134291001
   target nu stat err =       0.000545853245
   target dn stat err =       0.003078955042
      target stat err =       0.002574460008
              std dev =       0.667081395144
             le_variance =       0.444997587748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445011481596
                                         uncertainty =       0.002617862827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445011481596
                                         uncertainty =       0.002617862827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471700602
  error estimate for blocks of size 2^( 2) =       0.000495482211
  error estimate for blocks of size 2^( 3) =       0.000517341302
  error estimate for blocks of size 2^( 4) =       0.000534166828
  error estimate for blocks of size 2^( 5) =       0.000545202528
  error estimate for blocks of size 2^( 6) =       0.000550575698
  error estimate for blocks of size 2^( 7) =       0.000553476751

      target function =      -0.741912099466
              le_mean =     -22.662362202431
             les_mean =     514.036829663948
             stat err =       0.000545855451
             autocorr =       1.339129083888
   target nu stat err =       0.000545855451
   target dn stat err =       0.003079217078
      target stat err =       0.002574633994
              std dev =       0.667085388999
             le_variance =       0.445002916216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445016188732
                                         uncertainty =       0.002618162613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445016188732
                                         uncertainty =       0.002618162613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471703103
  error estimate for blocks of size 2^( 2) =       0.000495484502
  error estimate for blocks of size 2^( 3) =       0.000517343435
  error estimate for blocks of size 2^( 4) =       0.000534168818
  error estimate for blocks of size 2^( 5) =       0.000545204630
  error estimate for blocks of size 2^( 6) =       0.000550577680
  error estimate for blocks of size 2^( 7) =       0.000553478500

      target function =      -0.741907275816
              le_mean =     -22.662362255480
             les_mean =     514.036837998567
             stat err =       0.000545857407
             autocorr =       1.339124478077
   target nu stat err =       0.000545857407
   target dn stat err =       0.003079457653
      target stat err =       0.002574792411
              std dev =       0.667088926236
             le_variance =       0.445007635507


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741906554360        initial
     1.0000e+01     1.0000e+02             2.5040e-05        -0.741917143102  <--
     4.0000e+01     4.0000e+02             6.2853e-06        -0.741912099466
     1.6000e+02     1.6000e+03             1.5729e-06        -0.741907275816

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.3274e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -7.013445e-01 3 1  ON 0
ci_002                -7.063235e-01 3 1  ON 1
ci_003                -5.422740e-02 3 1  ON 2
ci_004                -5.535325e-02 3 1  ON 3
ci_005                 2.062717e-02 3 1  ON 4
ci_006                 2.071387e-02 3 1  ON 5
ci_007                 1.693832e-02 3 1  ON 6
ci_008                 1.697726e-02 3 1  ON 7
ci_009                -1.301457e-02 3 1  ON 8
ci_010                -1.333247e-02 3 1  ON 9
ci_011                -1.049450e-02 3 1  ON 10
ci_012                -1.060189e-02 3 1  ON 11
ci_013                 9.463975e-03 3 1  ON 12
ci_014                 9.650215e-03 3 1  ON 13
ci_015                 9.860442e-03 3 1  ON 14
ci_016                 1.052337e-02 3 1  ON 15
ci_017                 8.670931e-03 3 1  ON 16
ci_018                 8.729808e-03 3 1  ON 17
ci_019                 1.308801e-04 3 1  ON 18
ci_020                 1.792486e-04 3 1  ON 19
ci_021                -9.294323e-03 3 1  ON 20
ci_022                -1.040360e-02 3 1  ON 21
ci_023                 5.748567e-03 3 1  ON 22
ci_024                 5.115513e-03 3 1  ON 23
ci_025                 1.216025e-02 3 1  ON 24
ci_026                 1.184509e-02 3 1  ON 25
ci_027                 6.359130e-03 3 1  ON 26
ci_028                 6.432983e-03 3 1  ON 27
ci_029                -3.940291e-03 3 1  ON 28
ci_030                -4.684286e-03 3 1  ON 29
ci_031                 2.953781e-03 3 1  ON 30
ci_032                 2.790244e-03 3 1  ON 31
ci_033                 3.731252e-03 3 1  ON 32
ci_034                 3.652751e-03 3 1  ON 33
ci_035                 2.622765e-03 3 1  ON 34
ci_036                 2.235150e-03 3 1  ON 35
ci_037                 3.419368e-03 3 1  ON 36
ci_038                 3.841315e-03 3 1  ON 37
ci_039                 4.437378e-03 3 1  ON 38
ci_040                 4.490675e-03 3 1  ON 39
ci_041                 2.788037e-03 3 1  ON 40
ci_042                 3.046915e-03 3 1  ON 41
ci_043                 3.602354e-03 3 1  ON 42
ci_044                 3.367055e-03 3 1  ON 43
ci_045                 2.616469e-03 3 1  ON 44
ci_046                 2.772195e-03 3 1  ON 45
ci_047                -1.186185e-03 3 1  ON 46
ci_048                -1.353721e-03 3 1  ON 47
ci_049                 1.111319e-03 3 1  ON 48
ci_050                 8.892555e-04 3 1  ON 49
ci_051                -1.734467e-03 3 1  ON 50
ci_052                -1.896762e-03 3 1  ON 51
ci_053                -2.574184e-03 3 1  ON 52
ci_054                -2.635011e-03 3 1  ON 53
ci_055                -1.940212e-03 3 1  ON 54
ci_056                -1.336614e-03 3 1  ON 55
ci_057                -1.330422e-03 3 1  ON 56
ci_058                -1.106265e-03 3 1  ON 57
ci_059                -4.724353e-04 3 1  ON 58
ci_060                -4.707580e-04 3 1  ON 59
ci_061                -6.293826e-04 3 1  ON 60
ci_062                -5.020516e-04 3 1  ON 61
ci_063                -6.515092e-04 3 1  ON 62
ci_064                -9.049856e-04 3 1  ON 63
ci_065                -1.827929e-03 3 1  ON 64
ci_066                -1.760458e-03 3 1  ON 65
ci_067                -1.417153e-03 3 1  ON 66
ci_068                -1.627540e-03 3 1  ON 67
ci_069                 2.238044e-04 3 1  ON 68
ci_070                 2.117086e-04 3 1  ON 69
ci_071                -1.629348e-03 3 1  ON 70
ci_072                -2.057080e-03 3 1  ON 71
ci_073                 1.331026e-04 3 1  ON 72
ci_074                 3.452112e-04 3 1  ON 73
ci_075                 3.095988e-05 3 1  ON 74
ci_076                 2.365932e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4046e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2650e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7409
    reference variance = 0.222441
====================================================
  Execution time = 2.6234e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5289e-01
  Total weights = 1.955088957e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443266911949
                                         uncertainty =       0.002481839492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443266911949
                                         uncertainty =       0.002481839492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470751044
  error estimate for blocks of size 2^( 2) =       0.000494675766
  error estimate for blocks of size 2^( 3) =       0.000516583176
  error estimate for blocks of size 2^( 4) =       0.000532361209
  error estimate for blocks of size 2^( 5) =       0.000541470576
  error estimate for blocks of size 2^( 6) =       0.000545511236
  error estimate for blocks of size 2^( 7) =       0.000548314714

      target function =      -0.742954741919
              le_mean =     -22.661931047532
             les_mean =     514.016005794619
             stat err =       0.000541914434
             autocorr =       1.325192147947
   target nu stat err =       0.000541914434
   target dn stat err =       0.002816238862
      target stat err =       0.002370988844
              std dev =       0.665742510836
             le_variance =       0.443213090734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266193104753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742961364904       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742973968812       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742976206076       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742976452396       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742976497855       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742976613044       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742976641934       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742976645945       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742976672236       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742976668207       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742976663808       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742976664260       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 9.897370e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742961364904       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742964561207       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742965124578       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742965186267       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742965197487       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742965226091       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742965233151       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742965234111       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742965240597       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742965239527       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742965238457       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742965238567       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.503199e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742961364904       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742962166864       residual = 5.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742962307961       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742962323389       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742962326185       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742962333324       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742962335079       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742962335316       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742962336932       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742962336661       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742962336395       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742962336422       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 6.276298e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109757 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0946e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -7.013614e-01 3 1  ON 0
ci_002                -7.063116e-01 3 1  ON 1
ci_003                -5.420454e-02 3 1  ON 2
ci_004                -5.534694e-02 3 1  ON 3
ci_005                 2.060887e-02 3 1  ON 4
ci_006                 2.069929e-02 3 1  ON 5
ci_007                 1.692737e-02 3 1  ON 6
ci_008                 1.696372e-02 3 1  ON 7
ci_009                -1.300711e-02 3 1  ON 8
ci_010                -1.331364e-02 3 1  ON 9
ci_011                -1.048744e-02 3 1  ON 10
ci_012                -1.059013e-02 3 1  ON 11
ci_013                 9.454817e-03 3 1  ON 12
ci_014                 9.638774e-03 3 1  ON 13
ci_015                 9.855671e-03 3 1  ON 14
ci_016                 1.051854e-02 3 1  ON 15
ci_017                 8.666406e-03 3 1  ON 16
ci_018                 8.732019e-03 3 1  ON 17
ci_019                 1.058481e-04 3 1  ON 18
ci_020                 1.619632e-04 3 1  ON 19
ci_021                -9.316148e-03 3 1  ON 20
ci_022                -1.039802e-02 3 1  ON 21
ci_023                 5.740788e-03 3 1  ON 22
ci_024                 5.120969e-03 3 1  ON 23
ci_025                 1.217656e-02 3 1  ON 24
ci_026                 1.185728e-02 3 1  ON 25
ci_027                 6.357180e-03 3 1  ON 26
ci_028                 6.431794e-03 3 1  ON 27
ci_029                -3.930268e-03 3 1  ON 28
ci_030                -4.676275e-03 3 1  ON 29
ci_031                 2.956297e-03 3 1  ON 30
ci_032                 2.806238e-03 3 1  ON 31
ci_033                 3.722669e-03 3 1  ON 32
ci_034                 3.646221e-03 3 1  ON 33
ci_035                 2.615971e-03 3 1  ON 34
ci_036                 2.231815e-03 3 1  ON 35
ci_037                 3.418514e-03 3 1  ON 36
ci_038                 3.827124e-03 3 1  ON 37
ci_039                 4.432827e-03 3 1  ON 38
ci_040                 4.487754e-03 3 1  ON 39
ci_041                 2.787129e-03 3 1  ON 40
ci_042                 3.041838e-03 3 1  ON 41
ci_043                 3.603684e-03 3 1  ON 42
ci_044                 3.362560e-03 3 1  ON 43
ci_045                 2.613966e-03 3 1  ON 44
ci_046                 2.769793e-03 3 1  ON 45
ci_047                -1.185250e-03 3 1  ON 46
ci_048                -1.352947e-03 3 1  ON 47
ci_049                 1.108131e-03 3 1  ON 48
ci_050                 8.987283e-04 3 1  ON 49
ci_051                -1.724785e-03 3 1  ON 50
ci_052                -1.888957e-03 3 1  ON 51
ci_053                -2.574231e-03 3 1  ON 52
ci_054                -2.633042e-03 3 1  ON 53
ci_055                -1.933238e-03 3 1  ON 54
ci_056                -1.342676e-03 3 1  ON 55
ci_057                -1.320052e-03 3 1  ON 56
ci_058                -1.105864e-03 3 1  ON 57
ci_059                -4.713134e-04 3 1  ON 58
ci_060                -4.724969e-04 3 1  ON 59
ci_061                -6.340077e-04 3 1  ON 60
ci_062                -5.071073e-04 3 1  ON 61
ci_063                -6.524756e-04 3 1  ON 62
ci_064                -9.037655e-04 3 1  ON 63
ci_065                -1.825416e-03 3 1  ON 64
ci_066                -1.759712e-03 3 1  ON 65
ci_067                -1.414681e-03 3 1  ON 66
ci_068                -1.628047e-03 3 1  ON 67
ci_069                 2.243837e-04 3 1  ON 68
ci_070                 2.095094e-04 3 1  ON 69
ci_071                -1.626759e-03 3 1  ON 70
ci_072                -2.051727e-03 3 1  ON 71
ci_073                 1.336020e-04 3 1  ON 72
ci_074                 3.472255e-04 3 1  ON 73
ci_075                 3.153270e-05 3 1  ON 74
ci_076                 2.330768e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6056
    reference variance = 0.339757
====================================================
  Execution time = 2.5299e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4759e-01
  Total weights = 1.9549e+06
  Execution time = 3.6003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438568091528
                                         uncertainty =       0.001817152712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438568091528
                                         uncertainty =       0.001817152712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468229415
  error estimate for blocks of size 2^( 2) =       0.000491965377
  error estimate for blocks of size 2^( 3) =       0.000514716869
  error estimate for blocks of size 2^( 4) =       0.000530665541
  error estimate for blocks of size 2^( 5) =       0.000540231905
  error estimate for blocks of size 2^( 6) =       0.000544857532
  error estimate for blocks of size 2^( 7) =       0.000549584160

      target function =      -0.747284886668
              le_mean =     -22.662320955271
             les_mean =     514.028404167834
             stat err =       0.000541334785
             autocorr =       1.336640087215
   target nu stat err =       0.000541334785
   target dn stat err =       0.002430343133
      target stat err =       0.002092225257
              std dev =       0.662176389272
             le_variance =       0.438477570510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438548795791
                                         uncertainty =       0.001817107265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438548795791
                                         uncertainty =       0.001817107265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468219075
  error estimate for blocks of size 2^( 2) =       0.000491958691
  error estimate for blocks of size 2^( 3) =       0.000514712456
  error estimate for blocks of size 2^( 4) =       0.000530661000
  error estimate for blocks of size 2^( 5) =       0.000540228351
  error estimate for blocks of size 2^( 6) =       0.000544851704
  error estimate for blocks of size 2^( 7) =       0.000549579299

      target function =      -0.747324736348
              le_mean =     -22.662321668786
             les_mean =     514.028388245971
             stat err =       0.000541330089
             autocorr =       1.336675934459
   target nu stat err =       0.000541330089
   target dn stat err =       0.002424392937
      target stat err =       0.002087735476
              std dev =       0.662161765956
             le_variance =       0.438458204295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438558114160
                                         uncertainty =       0.001817124277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438558114160
                                         uncertainty =       0.001817124277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468224069
  error estimate for blocks of size 2^( 2) =       0.000491961889
  error estimate for blocks of size 2^( 3) =       0.000514714537
  error estimate for blocks of size 2^( 4) =       0.000530663140
  error estimate for blocks of size 2^( 5) =       0.000540230032
  error estimate for blocks of size 2^( 6) =       0.000544854510
  error estimate for blocks of size 2^( 7) =       0.000549581639

      target function =      -0.747317693020
              le_mean =     -22.662321291759
             les_mean =     514.028379676454
             stat err =       0.000541332330
             autocorr =       1.336658489744
   target nu stat err =       0.000541332330
   target dn stat err =       0.002426945667
      target stat err =       0.002089715451
              std dev =       0.662168828702
             le_variance =       0.438467557705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438566817391
                                         uncertainty =       0.001817148618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438566817391
                                         uncertainty =       0.001817148618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468228733
  error estimate for blocks of size 2^( 2) =       0.000491964928
  error estimate for blocks of size 2^( 3) =       0.000514716565
  error estimate for blocks of size 2^( 4) =       0.000530665228
  error estimate for blocks of size 2^( 5) =       0.000540231660
  error estimate for blocks of size 2^( 6) =       0.000544857143
  error estimate for blocks of size 2^( 7) =       0.000549583835

      target function =      -0.747289946572
              le_mean =     -22.662320994390
             les_mean =     514.028399810515
             stat err =       0.000541334467
             autocorr =       1.336642413800
   target nu stat err =       0.000541334467
   target dn stat err =       0.002429870836
      target stat err =       0.002091879033
              std dev =       0.662175423851
             le_variance =       0.438476291953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747284886668        initial
     2.5000e+00     2.5000e+01             9.8974e-05        -0.747324736348  <--
     1.0000e+01     1.0000e+02             2.5032e-05        -0.747317693020
     4.0000e+01     4.0000e+02             6.2763e-06        -0.747289946572

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.3289e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -7.014120e-01 3 1  ON 0
ci_002                -7.062756e-01 3 1  ON 1
ci_003                -5.413635e-02 3 1  ON 2
ci_004                -5.532819e-02 3 1  ON 3
ci_005                 2.055511e-02 3 1  ON 4
ci_006                 2.065641e-02 3 1  ON 5
ci_007                 1.689508e-02 3 1  ON 6
ci_008                 1.692377e-02 3 1  ON 7
ci_009                -1.298515e-02 3 1  ON 8
ci_010                -1.325810e-02 3 1  ON 9
ci_011                -1.046663e-02 3 1  ON 10
ci_012                -1.055541e-02 3 1  ON 11
ci_013                 9.427833e-03 3 1  ON 12
ci_014                 9.605025e-03 3 1  ON 13
ci_015                 9.841566e-03 3 1  ON 14
ci_016                 1.050424e-02 3 1  ON 15
ci_017                 8.653079e-03 3 1  ON 16
ci_018                 8.738580e-03 3 1  ON 17
ci_019                 3.190636e-05 3 1  ON 18
ci_020                 1.108645e-04 3 1  ON 19
ci_021                -9.380594e-03 3 1  ON 20
ci_022                -1.038157e-02 3 1  ON 21
ci_023                 5.717886e-03 3 1  ON 22
ci_024                 5.137004e-03 3 1  ON 23
ci_025                 1.222479e-02 3 1  ON 24
ci_026                 1.189329e-02 3 1  ON 25
ci_027                 6.351461e-03 3 1  ON 26
ci_028                 6.428308e-03 3 1  ON 27
ci_029                -3.900700e-03 3 1  ON 28
ci_030                -4.652606e-03 3 1  ON 29
ci_031                 2.963786e-03 3 1  ON 30
ci_032                 2.853434e-03 3 1  ON 31
ci_033                 3.697360e-03 3 1  ON 32
ci_034                 3.626946e-03 3 1  ON 33
ci_035                 2.595972e-03 3 1  ON 34
ci_036                 2.221986e-03 3 1  ON 35
ci_037                 3.415989e-03 3 1  ON 36
ci_038                 3.785240e-03 3 1  ON 37
ci_039                 4.419476e-03 3 1  ON 38
ci_040                 4.479171e-03 3 1  ON 39
ci_041                 2.784463e-03 3 1  ON 40
ci_042                 3.026905e-03 3 1  ON 41
ci_043                 3.607620e-03 3 1  ON 42
ci_044                 3.349300e-03 3 1  ON 43
ci_045                 2.606586e-03 3 1  ON 44
ci_046                 2.762715e-03 3 1  ON 45
ci_047                -1.182506e-03 3 1  ON 46
ci_048                -1.350651e-03 3 1  ON 47
ci_049                 1.098753e-03 3 1  ON 48
ci_050                 9.265987e-04 3 1  ON 49
ci_051                -1.696212e-03 3 1  ON 50
ci_052                -1.865924e-03 3 1  ON 51
ci_053                -2.574374e-03 3 1  ON 52
ci_054                -2.627270e-03 3 1  ON 53
ci_055                -1.912625e-03 3 1  ON 54
ci_056                -1.360558e-03 3 1  ON 55
ci_057                -1.289529e-03 3 1  ON 56
ci_058                -1.104685e-03 3 1  ON 57
ci_059                -4.680158e-04 3 1  ON 58
ci_060                -4.775984e-04 3 1  ON 59
ci_061                -6.476307e-04 3 1  ON 60
ci_062                -5.220204e-04 3 1  ON 61
ci_063                -6.553374e-04 3 1  ON 62
ci_064                -9.001777e-04 3 1  ON 63
ci_065                -1.818017e-03 3 1  ON 64
ci_066                -1.757514e-03 3 1  ON 65
ci_067                -1.407415e-03 3 1  ON 66
ci_068                -1.629547e-03 3 1  ON 67
ci_069                 2.260794e-04 3 1  ON 68
ci_070                 2.030203e-04 3 1  ON 69
ci_071                -1.619129e-03 3 1  ON 70
ci_072                -2.035913e-03 3 1  ON 71
ci_073                 1.350794e-04 3 1  ON 72
ci_074                 3.531497e-04 3 1  ON 73
ci_075                 3.320788e-05 3 1  ON 74
ci_076                 2.227217e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4241e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7139
    reference variance = 0.376152
====================================================
  Execution time = 2.6132e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4769e-01
  Total weights = 1.954955855e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437035009823
                                         uncertainty =       0.002601754543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437035009823
                                         uncertainty =       0.002601754543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467465920
  error estimate for blocks of size 2^( 2) =       0.000491363268
  error estimate for blocks of size 2^( 3) =       0.000513404991
  error estimate for blocks of size 2^( 4) =       0.000530569311
  error estimate for blocks of size 2^( 5) =       0.000538754145
  error estimate for blocks of size 2^( 6) =       0.000543199970
  error estimate for blocks of size 2^( 7) =       0.000543746289

      target function =      -0.747215286018
              le_mean =     -22.661962303873
             les_mean =     514.012221855024
             stat err =       0.000539067429
             autocorr =       1.329799834249
   target nu stat err =       0.000539067429
   target dn stat err =       0.003302765481
      target stat err =       0.002787075562
              std dev =       0.661096644263
             le_variance =       0.437048773056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266196230387e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747224667419       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747251725333       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747257508671       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747257697979       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747257888352       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747258036942       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747258001396       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747257974574       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747257969697       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747257981154       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747257977478       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747257973854       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 2.797370e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747224667419       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747231814705       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747233304749       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747233348604       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747233396208       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747233431618       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747233421748       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747233415439       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747233414374       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747233417040       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747233416101       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747233415305       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 7.302625e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747224667419       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747226479882       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747226855209       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747226865928       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747226877826       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747226886560       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747226884032       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747226882483       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747226882227       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747226882880       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747226882645       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747226882453       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.846083e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114591 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0845e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -7.014503e-01 3 1  ON 0
ci_002                -7.062493e-01 3 1  ON 1
ci_003                -5.407464e-02 3 1  ON 2
ci_004                -5.531545e-02 3 1  ON 3
ci_005                 2.052876e-02 3 1  ON 4
ci_006                 2.062986e-02 3 1  ON 5
ci_007                 1.685965e-02 3 1  ON 6
ci_008                 1.686971e-02 3 1  ON 7
ci_009                -1.295774e-02 3 1  ON 8
ci_010                -1.320037e-02 3 1  ON 9
ci_011                -1.044492e-02 3 1  ON 10
ci_012                -1.053148e-02 3 1  ON 11
ci_013                 9.414183e-03 3 1  ON 12
ci_014                 9.558477e-03 3 1  ON 13
ci_015                 9.844829e-03 3 1  ON 14
ci_016                 1.045790e-02 3 1  ON 15
ci_017                 8.691046e-03 3 1  ON 16
ci_018                 8.741831e-03 3 1  ON 17
ci_019                -2.580503e-05 3 1  ON 18
ci_020                 8.762294e-05 3 1  ON 19
ci_021                -9.433203e-03 3 1  ON 20
ci_022                -1.037591e-02 3 1  ON 21
ci_023                 5.698755e-03 3 1  ON 22
ci_024                 5.150559e-03 3 1  ON 23
ci_025                 1.229782e-02 3 1  ON 24
ci_026                 1.188800e-02 3 1  ON 25
ci_027                 6.338980e-03 3 1  ON 26
ci_028                 6.417488e-03 3 1  ON 27
ci_029                -3.895541e-03 3 1  ON 28
ci_030                -4.620984e-03 3 1  ON 29
ci_031                 3.026921e-03 3 1  ON 30
ci_032                 2.831248e-03 3 1  ON 31
ci_033                 3.682725e-03 3 1  ON 32
ci_034                 3.605986e-03 3 1  ON 33
ci_035                 2.570742e-03 3 1  ON 34
ci_036                 2.225867e-03 3 1  ON 35
ci_037                 3.433150e-03 3 1  ON 36
ci_038                 3.768591e-03 3 1  ON 37
ci_039                 4.426865e-03 3 1  ON 38
ci_040                 4.473881e-03 3 1  ON 39
ci_041                 2.777576e-03 3 1  ON 40
ci_042                 3.031312e-03 3 1  ON 41
ci_043                 3.616363e-03 3 1  ON 42
ci_044                 3.346229e-03 3 1  ON 43
ci_045                 2.572281e-03 3 1  ON 44
ci_046                 2.781802e-03 3 1  ON 45
ci_047                -1.185043e-03 3 1  ON 46
ci_048                -1.345086e-03 3 1  ON 47
ci_049                 1.121318e-03 3 1  ON 48
ci_050                 9.294678e-04 3 1  ON 49
ci_051                -1.690959e-03 3 1  ON 50
ci_052                -1.848160e-03 3 1  ON 51
ci_053                -2.583125e-03 3 1  ON 52
ci_054                -2.616245e-03 3 1  ON 53
ci_055                -1.904684e-03 3 1  ON 54
ci_056                -1.344153e-03 3 1  ON 55
ci_057                -1.297445e-03 3 1  ON 56
ci_058                -1.088374e-03 3 1  ON 57
ci_059                -4.680284e-04 3 1  ON 58
ci_060                -4.402633e-04 3 1  ON 59
ci_061                -6.382559e-04 3 1  ON 60
ci_062                -5.173545e-04 3 1  ON 61
ci_063                -6.792134e-04 3 1  ON 62
ci_064                -8.927402e-04 3 1  ON 63
ci_065                -1.819097e-03 3 1  ON 64
ci_066                -1.748281e-03 3 1  ON 65
ci_067                -1.414166e-03 3 1  ON 66
ci_068                -1.624927e-03 3 1  ON 67
ci_069                 2.279962e-04 3 1  ON 68
ci_070                 2.194852e-04 3 1  ON 69
ci_071                -1.588548e-03 3 1  ON 70
ci_072                -2.030032e-03 3 1  ON 71
ci_073                 1.380948e-04 3 1  ON 72
ci_074                 3.331541e-04 3 1  ON 73
ci_075                 2.990268e-05 3 1  ON 74
ci_076                 2.362581e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5925
    reference variance = 0.420267
====================================================
  Execution time = 2.7319e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5015e-01
  Total weights = 1.9551e+06
  Execution time = 3.6121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442038283616
                                         uncertainty =       0.002634600555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442038283616
                                         uncertainty =       0.002634600555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470090669
  error estimate for blocks of size 2^( 2) =       0.000494278750
  error estimate for blocks of size 2^( 3) =       0.000517003891
  error estimate for blocks of size 2^( 4) =       0.000533218712
  error estimate for blocks of size 2^( 5) =       0.000543044878
  error estimate for blocks of size 2^( 6) =       0.000546915575
  error estimate for blocks of size 2^( 7) =       0.000549545397

      target function =      -0.743983473343
              le_mean =     -22.662159738046
             les_mean =     514.025108464707
             stat err =       0.000543181140
             autocorr =       1.335137835523
   target nu stat err =       0.000543181140
   target dn stat err =       0.003442896612
      target stat err =       0.002877316952
              std dev =       0.664808599812
             le_variance =       0.441970474384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441987543899
                                         uncertainty =       0.002640204538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441987543899
                                         uncertainty =       0.002640204538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470063801
  error estimate for blocks of size 2^( 2) =       0.000494254958
  error estimate for blocks of size 2^( 3) =       0.000516982797
  error estimate for blocks of size 2^( 4) =       0.000533197563
  error estimate for blocks of size 2^( 5) =       0.000543021332
  error estimate for blocks of size 2^( 6) =       0.000546895963
  error estimate for blocks of size 2^( 7) =       0.000549529406

      target function =      -0.745388381840
              le_mean =     -22.662158980688
             les_mean =     514.023361468571
             stat err =       0.000543161066
             autocorr =       1.335191776637
   target nu stat err =       0.000543161066
   target dn stat err =       0.003079847621
      target stat err =       0.002597203878
              std dev =       0.664770601950
             le_variance =       0.441919953217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442010179712
                                         uncertainty =       0.002637520861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442010179712
                                         uncertainty =       0.002637520861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470075784
  error estimate for blocks of size 2^( 2) =       0.000494265502
  error estimate for blocks of size 2^( 3) =       0.000516992123
  error estimate for blocks of size 2^( 4) =       0.000533206904
  error estimate for blocks of size 2^( 5) =       0.000543031817
  error estimate for blocks of size 2^( 6) =       0.000546904496
  error estimate for blocks of size 2^( 7) =       0.000549536213

      target function =      -0.745341206161
              le_mean =     -22.662159108842
             les_mean =     514.023424721237
             stat err =       0.000543169858
             autocorr =       1.335166925348
   target nu stat err =       0.000543169858
   target dn stat err =       0.003087108064
      target stat err =       0.002602684389
              std dev =       0.664787548430
             le_variance =       0.441942484547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442034536334
                                         uncertainty =       0.002634966079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442034536334
                                         uncertainty =       0.002634966079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470088684
  error estimate for blocks of size 2^( 2) =       0.000494276961
  error estimate for blocks of size 2^( 3) =       0.000517002291
  error estimate for blocks of size 2^( 4) =       0.000533217097
  error estimate for blocks of size 2^( 5) =       0.000543043122
  error estimate for blocks of size 2^( 6) =       0.000546914025
  error estimate for blocks of size 2^( 7) =       0.000549544224

      target function =      -0.745190484644
              le_mean =     -22.662159601072
             les_mean =     514.023630703619
             stat err =       0.000543179617
             autocorr =       1.335141623392
   target nu stat err =       0.000543179617
   target dn stat err =       0.003096445044
      target stat err =       0.002609118005
              std dev =       0.664805792316
             le_variance =       0.441966741497


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743983473343        initial
     6.2500e-01     6.2500e+00             2.7974e-04        -0.745388381840  <--
     2.5000e+00     2.5000e+01             7.3026e-05        -0.745341206161
     1.0000e+01     1.0000e+02             1.8461e-05        -0.745190484644

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.5381e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -7.015654e-01 3 1  ON 0
ci_002                -7.061684e-01 3 1  ON 1
ci_003                -5.389352e-02 3 1  ON 2
ci_004                -5.527883e-02 3 1  ON 3
ci_005                 2.045584e-02 3 1  ON 4
ci_006                 2.055611e-02 3 1  ON 5
ci_007                 1.676056e-02 3 1  ON 6
ci_008                 1.671798e-02 3 1  ON 7
ci_009                -1.288126e-02 3 1  ON 8
ci_010                -1.303879e-02 3 1  ON 9
ci_011                -1.038430e-02 3 1  ON 10
ci_012                -1.046452e-02 3 1  ON 11
ci_013                 9.376205e-03 3 1  ON 12
ci_014                 9.427519e-03 3 1  ON 13
ci_015                 9.853952e-03 3 1  ON 14
ci_016                 1.032668e-02 3 1  ON 15
ci_017                 8.797929e-03 3 1  ON 16
ci_018                 8.750827e-03 3 1  ON 17
ci_019                -1.891944e-04 3 1  ON 18
ci_020                 2.197365e-05 3 1  ON 19
ci_021                -9.582165e-03 3 1  ON 20
ci_022                -1.035970e-02 3 1  ON 21
ci_023                 5.645510e-03 3 1  ON 22
ci_024                 5.188304e-03 3 1  ON 23
ci_025                 1.250453e-02 3 1  ON 24
ci_026                 1.187327e-02 3 1  ON 25
ci_027                 6.304560e-03 3 1  ON 26
ci_028                 6.387590e-03 3 1  ON 27
ci_029                -3.880910e-03 3 1  ON 28
ci_030                -4.531915e-03 3 1  ON 29
ci_031                 3.205160e-03 3 1  ON 30
ci_032                 2.768761e-03 3 1  ON 31
ci_033                 3.641819e-03 3 1  ON 32
ci_034                 3.546617e-03 3 1  ON 33
ci_035                 2.500607e-03 3 1  ON 34
ci_036                 2.236431e-03 3 1  ON 35
ci_037                 3.481407e-03 3 1  ON 36
ci_038                 3.721465e-03 3 1  ON 37
ci_039                 4.447227e-03 3 1  ON 38
ci_040                 4.459278e-03 3 1  ON 39
ci_041                 2.758500e-03 3 1  ON 40
ci_042                 3.043576e-03 3 1  ON 41
ci_043                 3.641010e-03 3 1  ON 42
ci_044                 3.337208e-03 3 1  ON 43
ci_045                 2.476731e-03 3 1  ON 44
ci_046                 2.835717e-03 3 1  ON 45
ci_047                -1.191971e-03 3 1  ON 46
ci_048                -1.329182e-03 3 1  ON 47
ci_049                 1.184452e-03 3 1  ON 48
ci_050                 9.374080e-04 3 1  ON 49
ci_051                -1.676196e-03 3 1  ON 50
ci_052                -1.797832e-03 3 1  ON 51
ci_053                -2.607954e-03 3 1  ON 52
ci_054                -2.584961e-03 3 1  ON 53
ci_055                -1.882609e-03 3 1  ON 54
ci_056                -1.297943e-03 3 1  ON 55
ci_057                -1.319657e-03 3 1  ON 56
ci_058                -1.042851e-03 3 1  ON 57
ci_059                -4.681515e-04 3 1  ON 58
ci_060                -3.368405e-04 3 1  ON 59
ci_061                -6.118564e-04 3 1  ON 60
ci_062                -5.043429e-04 3 1  ON 61
ci_063                -7.465906e-04 3 1  ON 62
ci_064                -8.722603e-04 3 1  ON 63
ci_065                -1.822135e-03 3 1  ON 64
ci_066                -1.722873e-03 3 1  ON 65
ci_067                -1.433449e-03 3 1  ON 66
ci_068                -1.612016e-03 3 1  ON 67
ci_069                 2.333275e-04 3 1  ON 68
ci_070                 2.651845e-04 3 1  ON 69
ci_071                -1.502585e-03 3 1  ON 70
ci_072                -2.013430e-03 3 1  ON 71
ci_073                 1.464592e-04 3 1  ON 72
ci_074                 2.775774e-04 3 1  ON 73
ci_075                 2.061703e-05 3 1  ON 74
ci_076                 2.740906e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6232e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6193
    reference variance = 0.352286
====================================================
  Execution time = 2.6111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4975e-01
  Total weights = 1.954794216e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439948529248
                                         uncertainty =       0.001995347837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439948529248
                                         uncertainty =       0.001995347837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469043443
  error estimate for blocks of size 2^( 2) =       0.000493249737
  error estimate for blocks of size 2^( 3) =       0.000516182737
  error estimate for blocks of size 2^( 4) =       0.000531998340
  error estimate for blocks of size 2^( 5) =       0.000542054008
  error estimate for blocks of size 2^( 6) =       0.000547731190
  error estimate for blocks of size 2^( 7) =       0.000550714046

      target function =      -0.745517094744
              le_mean =     -22.661288364963
             les_mean =     513.983735536359
             stat err =       0.000543124396
             autocorr =       1.340826190329
   target nu stat err =       0.000543124396
   target dn stat err =       0.002766136458
      target stat err =       0.002345180609
              std dev =       0.663327597896
             le_variance =       0.440003502131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266128836496e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745523536776       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745620726820       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745632553577       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745634431390       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745634905131       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745634892490       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745635025691       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745635276131       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745635315147       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745635299450       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745635317531       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745635338322       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 7.634205e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745523536776       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745552973307       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745556260140       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745556755149       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745556874819       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745556858577       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745556890166       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745556944084       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745556949274       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745556945122       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745556947977       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745556951347       residual = 1.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 2.095446e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745523536776       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745531306679       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745532150203       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745532275101       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745532304925       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745532299852       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745532307657       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745532320486       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745532321449       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745532320437       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745532321063       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 5.518549e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119272 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0815e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -7.017323e-01 3 1  ON 0
ci_002                -7.060387e-01 3 1  ON 1
ci_003                -5.388915e-02 3 1  ON 2
ci_004                -5.507377e-02 3 1  ON 3
ci_005                 2.047073e-02 3 1  ON 4
ci_006                 2.036449e-02 3 1  ON 5
ci_007                 1.655101e-02 3 1  ON 6
ci_008                 1.659840e-02 3 1  ON 7
ci_009                -1.267379e-02 3 1  ON 8
ci_010                -1.290603e-02 3 1  ON 9
ci_011                -1.040534e-02 3 1  ON 10
ci_012                -1.031766e-02 3 1  ON 11
ci_013                 9.232204e-03 3 1  ON 12
ci_014                 9.350786e-03 3 1  ON 13
ci_015                 9.864747e-03 3 1  ON 14
ci_016                 1.014085e-02 3 1  ON 15
ci_017                 8.657283e-03 3 1  ON 16
ci_018                 8.807402e-03 3 1  ON 17
ci_019                -3.743105e-04 3 1  ON 18
ci_020                -1.825115e-04 3 1  ON 19
ci_021                -9.708025e-03 3 1  ON 20
ci_022                -1.054057e-02 3 1  ON 21
ci_023                 5.687500e-03 3 1  ON 22
ci_024                 5.120269e-03 3 1  ON 23
ci_025                 1.256394e-02 3 1  ON 24
ci_026                 1.201418e-02 3 1  ON 25
ci_027                 6.285782e-03 3 1  ON 26
ci_028                 6.414339e-03 3 1  ON 27
ci_029                -3.948408e-03 3 1  ON 28
ci_030                -4.568870e-03 3 1  ON 29
ci_031                 3.403672e-03 3 1  ON 30
ci_032                 2.927902e-03 3 1  ON 31
ci_033                 3.648819e-03 3 1  ON 32
ci_034                 3.546732e-03 3 1  ON 33
ci_035                 2.447068e-03 3 1  ON 34
ci_036                 2.287214e-03 3 1  ON 35
ci_037                 3.492117e-03 3 1  ON 36
ci_038                 3.620241e-03 3 1  ON 37
ci_039                 4.478928e-03 3 1  ON 38
ci_040                 4.424340e-03 3 1  ON 39
ci_041                 2.770633e-03 3 1  ON 40
ci_042                 2.930498e-03 3 1  ON 41
ci_043                 3.726147e-03 3 1  ON 42
ci_044                 3.323172e-03 3 1  ON 43
ci_045                 2.513632e-03 3 1  ON 44
ci_046                 2.801452e-03 3 1  ON 45
ci_047                -1.150306e-03 3 1  ON 46
ci_048                -1.321609e-03 3 1  ON 47
ci_049                 1.117888e-03 3 1  ON 48
ci_050                 9.167240e-04 3 1  ON 49
ci_051                -1.685425e-03 3 1  ON 50
ci_052                -1.704329e-03 3 1  ON 51
ci_053                -2.539666e-03 3 1  ON 52
ci_054                -2.517102e-03 3 1  ON 53
ci_055                -1.788664e-03 3 1  ON 54
ci_056                -1.189286e-03 3 1  ON 55
ci_057                -1.255569e-03 3 1  ON 56
ci_058                -1.033494e-03 3 1  ON 57
ci_059                -5.192811e-04 3 1  ON 58
ci_060                -2.909783e-04 3 1  ON 59
ci_061                -5.917798e-04 3 1  ON 60
ci_062                -5.190112e-04 3 1  ON 61
ci_063                -6.929213e-04 3 1  ON 62
ci_064                -7.576428e-04 3 1  ON 63
ci_065                -1.726647e-03 3 1  ON 64
ci_066                -1.641212e-03 3 1  ON 65
ci_067                -1.432371e-03 3 1  ON 66
ci_068                -1.663504e-03 3 1  ON 67
ci_069                 2.063440e-04 3 1  ON 68
ci_070                 2.818927e-04 3 1  ON 69
ci_071                -1.529762e-03 3 1  ON 70
ci_072                -2.220706e-03 3 1  ON 71
ci_073                 1.846955e-04 3 1  ON 72
ci_074                 2.646211e-04 3 1  ON 73
ci_075                 2.045963e-04 3 1  ON 74
ci_076                 2.069217e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6291
    reference variance = 0.354656
====================================================
  Execution time = 2.5239e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5275e-01
  Total weights = 1.9554e+06
  Execution time = 3.6172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442319877974
                                         uncertainty =       0.002216427597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442319877974
                                         uncertainty =       0.002216427597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470225087
  error estimate for blocks of size 2^( 2) =       0.000494497247
  error estimate for blocks of size 2^( 3) =       0.000516924858
  error estimate for blocks of size 2^( 4) =       0.000533181017
  error estimate for blocks of size 2^( 5) =       0.000544007141
  error estimate for blocks of size 2^( 6) =       0.000547147277
  error estimate for blocks of size 2^( 7) =       0.000550814822

      target function =      -0.742650173131
              le_mean =     -22.661497019821
             les_mean =     513.996704231897
             stat err =       0.000543787564
             autocorr =       1.337355760389
   target nu stat err =       0.000543787564
   target dn stat err =       0.002830651683
      target stat err =       0.002379458918
              std dev =       0.664998694840
             le_variance =       0.442223264139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442099942631
                                         uncertainty =       0.002199523111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442099942631
                                         uncertainty =       0.002199523111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470108344
  error estimate for blocks of size 2^( 2) =       0.000494398804
  error estimate for blocks of size 2^( 3) =       0.000516833904
  error estimate for blocks of size 2^( 4) =       0.000533100523
  error estimate for blocks of size 2^( 5) =       0.000543929285
  error estimate for blocks of size 2^( 6) =       0.000547074260
  error estimate for blocks of size 2^( 7) =       0.000550770822

      target function =      -0.730034613671
              le_mean =     -22.661500079764
             les_mean =     514.012344629277
             stat err =       0.000543718723
             autocorr =       1.337681299875
   target nu stat err =       0.000543718723
   target dn stat err =       0.016028593914
      target stat err =       0.012622239104
              std dev =       0.664833596336
             le_variance =       0.442003710817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442152587818
                                         uncertainty =       0.002207968460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442152587818
                                         uncertainty =       0.002207968460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470136274
  error estimate for blocks of size 2^( 2) =       0.000494421046
  error estimate for blocks of size 2^( 3) =       0.000516854408
  error estimate for blocks of size 2^( 4) =       0.000533116504
  error estimate for blocks of size 2^( 5) =       0.000543947061
  error estimate for blocks of size 2^( 6) =       0.000547092959
  error estimate for blocks of size 2^( 7) =       0.000550777570

      target function =      -0.741270944314
              le_mean =     -22.661494303982
             les_mean =     513.998273584885
             stat err =       0.000543733523
             autocorr =       1.337595184825
   target nu stat err =       0.000543733523
   target dn stat err =       0.003608535211
      target stat err =       0.002985631906
              std dev =       0.664873095510
             le_variance =       0.442056233133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442294630294
                                         uncertainty =       0.002215214503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442294630294
                                         uncertainty =       0.002215214503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470211683
  error estimate for blocks of size 2^( 2) =       0.000494485574
  error estimate for blocks of size 2^( 3) =       0.000516913780
  error estimate for blocks of size 2^( 4) =       0.000533170905
  error estimate for blocks of size 2^( 5) =       0.000543997529
  error estimate for blocks of size 2^( 6) =       0.000547138455
  error estimate for blocks of size 2^( 7) =       0.000550808762

      target function =      -0.742713939830
              le_mean =     -22.661496009279
             les_mean =     513.996580086114
             stat err =       0.000543778913
             autocorr =       1.337389450497
   target nu stat err =       0.000543778913
   target dn stat err =       0.002828473996
      target stat err =       0.002378132758
              std dev =       0.664979739158
             le_variance =       0.442198053490


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742650173131        initial
     1.5625e-01     1.5625e+00             7.6342e-04        -0.730034613671
     6.2500e-01     6.2500e+00             2.0954e-04        -0.741270944314
     2.5000e+00     2.5000e+01             5.5185e-05        -0.742713939830  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.3262e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -7.016072e-01 3 1  ON 0
ci_002                -7.061362e-01 3 1  ON 1
ci_003                -5.389221e-02 3 1  ON 2
ci_004                -5.522642e-02 3 1  ON 3
ci_005                 2.045974e-02 3 1  ON 4
ci_006                 2.050533e-02 3 1  ON 5
ci_007                 1.670537e-02 3 1  ON 6
ci_008                 1.668646e-02 3 1  ON 7
ci_009                -1.282665e-02 3 1  ON 8
ci_010                -1.300376e-02 3 1  ON 9
ci_011                -1.038968e-02 3 1  ON 10
ci_012                -1.042580e-02 3 1  ON 11
ci_013                 9.338438e-03 3 1  ON 12
ci_014                 9.407337e-03 3 1  ON 13
ci_015                 9.856843e-03 3 1  ON 14
ci_016                 1.027806e-02 3 1  ON 15
ci_017                 8.760952e-03 3 1  ON 16
ci_018                 8.765626e-03 3 1  ON 17
ci_019                -2.376074e-04 3 1  ON 18
ci_020                -3.143312e-05 3 1  ON 19
ci_021                -9.614977e-03 3 1  ON 20
ci_022                -1.040709e-02 3 1  ON 21
ci_023                 5.656638e-03 3 1  ON 22
ci_024                 5.170382e-03 3 1  ON 23
ci_025                 1.251994e-02 3 1  ON 24
ci_026                 1.191008e-02 3 1  ON 25
ci_027                 6.299622e-03 3 1  ON 26
ci_028                 6.394608e-03 3 1  ON 27
ci_029                -3.898722e-03 3 1  ON 28
ci_030                -4.541602e-03 3 1  ON 29
ci_031                 3.257066e-03 3 1  ON 30
ci_032                 2.810388e-03 3 1  ON 31
ci_033                 3.643649e-03 3 1  ON 32
ci_034                 3.546631e-03 3 1  ON 33
ci_035                 2.486324e-03 3 1  ON 34
ci_036                 2.249909e-03 3 1  ON 35
ci_037                 3.484335e-03 3 1  ON 36
ci_038                 3.694957e-03 3 1  ON 37
ci_039                 4.455550e-03 3 1  ON 38
ci_040                 4.450042e-03 3 1  ON 39
ci_041                 2.761763e-03 3 1  ON 40
ci_042                 3.013658e-03 3 1  ON 41
ci_043                 3.663373e-03 3 1  ON 42
ci_044                 3.333553e-03 3 1  ON 43
ci_045                 2.486366e-03 3 1  ON 44
ci_046                 2.826739e-03 3 1  ON 45
ci_047                -1.180917e-03 3 1  ON 46
ci_048                -1.327199e-03 3 1  ON 47
ci_049                 1.166905e-03 3 1  ON 48
ci_050                 9.319057e-04 3 1  ON 49
ci_051                -1.678745e-03 3 1  ON 50
ci_052                -1.773365e-03 3 1  ON 51
ci_053                -2.590009e-03 3 1  ON 52
ci_054                -2.567096e-03 3 1  ON 53
ci_055                -1.858050e-03 3 1  ON 54
ci_056                -1.269499e-03 3 1  ON 55
ci_057                -1.302722e-03 3 1  ON 56
ci_058                -1.040442e-03 3 1  ON 57
ci_059                -4.816846e-04 3 1  ON 58
ci_060                -3.247721e-04 3 1  ON 59
ci_061                -6.065789e-04 3 1  ON 60
ci_062                -5.081699e-04 3 1  ON 61
ci_063                -7.324705e-04 3 1  ON 62
ci_064                -8.421774e-04 3 1  ON 63
ci_065                -1.797102e-03 3 1  ON 64
ci_066                -1.701532e-03 3 1  ON 65
ci_067                -1.433125e-03 3 1  ON 66
ci_068                -1.625463e-03 3 1  ON 67
ci_069                 2.262331e-04 3 1  ON 68
ci_070                 2.695437e-04 3 1  ON 69
ci_071                -1.509910e-03 3 1  ON 70
ci_072                -2.068000e-03 3 1  ON 71
ci_073                 1.565230e-04 3 1  ON 72
ci_074                 2.741205e-04 3 1  ON 73
ci_075                 6.895400e-05 3 1  ON 74
ci_076                 2.564893e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4082e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2650e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6008
    reference variance = 0.299379
====================================================
  Execution time = 2.6110e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5125e-01
  Total weights = 1.955233914e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440335936063
                                         uncertainty =       0.002042198434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440335936063
                                         uncertainty =       0.002042198434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469175906
  error estimate for blocks of size 2^( 2) =       0.000493250227
  error estimate for blocks of size 2^( 3) =       0.000514730765
  error estimate for blocks of size 2^( 4) =       0.000530096880
  error estimate for blocks of size 2^( 5) =       0.000540209284
  error estimate for blocks of size 2^( 6) =       0.000545218075
  error estimate for blocks of size 2^( 7) =       0.000545454482

      target function =      -0.744294741803
              le_mean =     -22.661949799043
             les_mean =     514.015213711014
             stat err =       0.000540244680
             autocorr =       1.325896410511
   target nu stat err =       0.000540244680
   target dn stat err =       0.002971195582
      target stat err =       0.002501829256
              std dev =       0.663514929703
             le_variance =       0.440252061939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266194979904e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744302181671       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744338821572       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744350471333       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744351399005       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744351470673       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744351442619       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744351400769       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744351411030       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744351422018       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 3.425670e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744302181671       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744311874039       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744314883418       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744315116748       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744315133280       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744315125914       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744315115752       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744315118279       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744315120878       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 8.958226e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744302181671       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744304640488       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744305399058       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744305457453       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744305461490       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744305459627       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744305457108       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744305457737       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744305458377       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.265618e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122410 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0806e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -7.016139e-01 3 1  ON 0
ci_002                -7.061390e-01 3 1  ON 1
ci_003                -5.386540e-02 3 1  ON 2
ci_004                -5.519748e-02 3 1  ON 3
ci_005                 2.044522e-02 3 1  ON 4
ci_006                 2.045112e-02 3 1  ON 5
ci_007                 1.667931e-02 3 1  ON 6
ci_008                 1.669739e-02 3 1  ON 7
ci_009                -1.281337e-02 3 1  ON 8
ci_010                -1.297486e-02 3 1  ON 9
ci_011                -1.036614e-02 3 1  ON 10
ci_012                -1.038762e-02 3 1  ON 11
ci_013                 9.290264e-03 3 1  ON 12
ci_014                 9.370708e-03 3 1  ON 13
ci_015                 9.803010e-03 3 1  ON 14
ci_016                 1.022577e-02 3 1  ON 15
ci_017                 8.727333e-03 3 1  ON 16
ci_018                 8.781319e-03 3 1  ON 17
ci_019                -3.271896e-04 3 1  ON 18
ci_020                -9.991798e-05 3 1  ON 19
ci_021                -9.660964e-03 3 1  ON 20
ci_022                -1.046824e-02 3 1  ON 21
ci_023                 5.621141e-03 3 1  ON 22
ci_024                 5.154347e-03 3 1  ON 23
ci_025                 1.256489e-02 3 1  ON 24
ci_026                 1.194051e-02 3 1  ON 25
ci_027                 6.281286e-03 3 1  ON 26
ci_028                 6.407886e-03 3 1  ON 27
ci_029                -3.900288e-03 3 1  ON 28
ci_030                -4.525651e-03 3 1  ON 29
ci_031                 3.346172e-03 3 1  ON 30
ci_032                 2.854710e-03 3 1  ON 31
ci_033                 3.609850e-03 3 1  ON 32
ci_034                 3.564518e-03 3 1  ON 33
ci_035                 2.456400e-03 3 1  ON 34
ci_036                 2.215504e-03 3 1  ON 35
ci_037                 3.450357e-03 3 1  ON 36
ci_038                 3.642240e-03 3 1  ON 37
ci_039                 4.456783e-03 3 1  ON 38
ci_040                 4.449165e-03 3 1  ON 39
ci_041                 2.767509e-03 3 1  ON 40
ci_042                 2.998736e-03 3 1  ON 41
ci_043                 3.654672e-03 3 1  ON 42
ci_044                 3.318842e-03 3 1  ON 43
ci_045                 2.475958e-03 3 1  ON 44
ci_046                 2.829743e-03 3 1  ON 45
ci_047                -1.185059e-03 3 1  ON 46
ci_048                -1.277537e-03 3 1  ON 47
ci_049                 1.162320e-03 3 1  ON 48
ci_050                 9.592165e-04 3 1  ON 49
ci_051                -1.662435e-03 3 1  ON 50
ci_052                -1.795325e-03 3 1  ON 51
ci_053                -2.573960e-03 3 1  ON 52
ci_054                -2.561819e-03 3 1  ON 53
ci_055                -1.822833e-03 3 1  ON 54
ci_056                -1.290542e-03 3 1  ON 55
ci_057                -1.290467e-03 3 1  ON 56
ci_058                -1.031719e-03 3 1  ON 57
ci_059                -4.762098e-04 3 1  ON 58
ci_060                -3.189466e-04 3 1  ON 59
ci_061                -6.105951e-04 3 1  ON 60
ci_062                -4.718773e-04 3 1  ON 61
ci_063                -7.343421e-04 3 1  ON 62
ci_064                -8.181979e-04 3 1  ON 63
ci_065                -1.783403e-03 3 1  ON 64
ci_066                -1.702887e-03 3 1  ON 65
ci_067                -1.455440e-03 3 1  ON 66
ci_068                -1.624396e-03 3 1  ON 67
ci_069                 2.160508e-04 3 1  ON 68
ci_070                 2.464599e-04 3 1  ON 69
ci_071                -1.545511e-03 3 1  ON 70
ci_072                -2.068285e-03 3 1  ON 71
ci_073                 1.490801e-04 3 1  ON 72
ci_074                 2.673447e-04 3 1  ON 73
ci_075                 4.685315e-05 3 1  ON 74
ci_076                 2.937863e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.5984
    reference variance = 0.734348
====================================================
  Execution time = 2.5241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5188e-01
  Total weights = 1.9550e+06
  Execution time = 3.6128e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441421464496
                                         uncertainty =       0.002713267075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441421464496
                                         uncertainty =       0.002713267075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469814096
  error estimate for blocks of size 2^( 2) =       0.000493923281
  error estimate for blocks of size 2^( 3) =       0.000516040820
  error estimate for blocks of size 2^( 4) =       0.000532717276
  error estimate for blocks of size 2^( 5) =       0.000543172370
  error estimate for blocks of size 2^( 6) =       0.000548144471
  error estimate for blocks of size 2^( 7) =       0.000548471176

      target function =      -0.743764121999
              le_mean =     -22.662693577541
             les_mean =     514.049580873953
             stat err =       0.000543126323
             autocorr =       1.336440467524
   target nu stat err =       0.000543126323
   target dn stat err =       0.003004073314
      target stat err =       0.002527981309
              std dev =       0.664417466624
             le_variance =       0.441450569955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441302554796
                                         uncertainty =       0.002708562343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441302554796
                                         uncertainty =       0.002708562343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469751936
  error estimate for blocks of size 2^( 2) =       0.000493867933
  error estimate for blocks of size 2^( 3) =       0.000515990751
  error estimate for blocks of size 2^( 4) =       0.000532659126
  error estimate for blocks of size 2^( 5) =       0.000543116967
  error estimate for blocks of size 2^( 6) =       0.000548085011
  error estimate for blocks of size 2^( 7) =       0.000548400632

      target function =      -0.633696697824
              le_mean =     -22.662690503834
             les_mean =     514.190379834425
             stat err =       0.000543065434
             autocorr =       1.336494465255
   target nu stat err =       0.000543065434
   target dn stat err =       0.133924688051
      target stat err =       0.080788194988
              std dev =       0.664329558951
             le_variance =       0.441333762896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441350830037
                                         uncertainty =       0.002710940057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441350830037
                                         uncertainty =       0.002710940057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469777110
  error estimate for blocks of size 2^( 2) =       0.000493890147
  error estimate for blocks of size 2^( 3) =       0.000516010473
  error estimate for blocks of size 2^( 4) =       0.000532682313
  error estimate for blocks of size 2^( 5) =       0.000543138643
  error estimate for blocks of size 2^( 6) =       0.000548108951
  error estimate for blocks of size 2^( 7) =       0.000548427951

      target function =      -0.743669175624
              le_mean =     -22.662692538879
             les_mean =     514.049649917760
             stat err =       0.000543089465
             autocorr =       1.336469503331
   target nu stat err =       0.000543089465
   target dn stat err =       0.003004160225
      target stat err =       0.002527409508
              std dev =       0.664365159584
             le_variance =       0.441381065269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441411937259
                                         uncertainty =       0.002712947751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441411937259
                                         uncertainty =       0.002712947751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469809103
  error estimate for blocks of size 2^( 2) =       0.000493918789
  error estimate for blocks of size 2^( 3) =       0.000516036684
  error estimate for blocks of size 2^( 4) =       0.000532712536
  error estimate for blocks of size 2^( 5) =       0.000543167792
  error estimate for blocks of size 2^( 6) =       0.000548139707
  error estimate for blocks of size 2^( 7) =       0.000548465397

      target function =      -0.743776568673
              le_mean =     -22.662693402220
             les_mean =     514.049557716911
             stat err =       0.000543121358
             autocorr =       1.336444437678
   target nu stat err =       0.000543121358
   target dn stat err =       0.003002213637
      target stat err =       0.002526583918
              std dev =       0.664410405550
             le_variance =       0.441441187003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743764121999        initial
     6.2500e-01     6.2500e+00             3.4257e-04        -0.633696697824
     2.5000e+00     2.5000e+01             8.9582e-05        -0.743669175624
     1.0000e+01     1.0000e+02             2.2656e-05        -0.743776568673  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.3295e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -7.016089e-01 3 1  ON 0
ci_002                -7.061370e-01 3 1  ON 1
ci_003                -5.388548e-02 3 1  ON 2
ci_004                -5.521916e-02 3 1  ON 3
ci_005                 2.045606e-02 3 1  ON 4
ci_006                 2.049158e-02 3 1  ON 5
ci_007                 1.669877e-02 3 1  ON 6
ci_008                 1.668924e-02 3 1  ON 7
ci_009                -1.282328e-02 3 1  ON 8
ci_010                -1.299646e-02 3 1  ON 9
ci_011                -1.038372e-02 3 1  ON 10
ci_012                -1.041614e-02 3 1  ON 11
ci_013                 9.326249e-03 3 1  ON 12
ci_014                 9.398064e-03 3 1  ON 13
ci_015                 9.843222e-03 3 1  ON 14
ci_016                 1.026484e-02 3 1  ON 15
ci_017                 8.752438e-03 3 1  ON 16
ci_018                 8.769596e-03 3 1  ON 17
ci_019                -2.602636e-04 3 1  ON 18
ci_020                -4.876224e-05 3 1  ON 19
ci_021                -9.626609e-03 3 1  ON 20
ci_022                -1.042255e-02 3 1  ON 21
ci_023                 5.647635e-03 3 1  ON 22
ci_024                 5.166318e-03 3 1  ON 23
ci_025                 1.253129e-02 3 1  ON 24
ci_026                 1.191777e-02 3 1  ON 25
ci_027                 6.294967e-03 3 1  ON 26
ci_028                 6.397979e-03 3 1  ON 27
ci_029                -3.899114e-03 3 1  ON 28
ci_030                -4.537571e-03 3 1  ON 29
ci_031                 3.279611e-03 3 1  ON 30
ci_032                 2.821589e-03 3 1  ON 31
ci_033                 3.635094e-03 3 1  ON 32
ci_034                 3.551163e-03 3 1  ON 33
ci_035                 2.478729e-03 3 1  ON 34
ci_036                 2.241173e-03 3 1  ON 35
ci_037                 3.475740e-03 3 1  ON 36
ci_038                 3.681609e-03 3 1  ON 37
ci_039                 4.455860e-03 3 1  ON 38
ci_040                 4.449820e-03 3 1  ON 39
ci_041                 2.763222e-03 3 1  ON 40
ci_042                 3.009872e-03 3 1  ON 41
ci_043                 3.661172e-03 3 1  ON 42
ci_044                 3.329836e-03 3 1  ON 43
ci_045                 2.483721e-03 3 1  ON 44
ci_046                 2.827501e-03 3 1  ON 45
ci_047                -1.181969e-03 3 1  ON 46
ci_048                -1.314578e-03 3 1  ON 47
ci_049                 1.165744e-03 3 1  ON 48
ci_050                 9.388302e-04 3 1  ON 49
ci_051                -1.674621e-03 3 1  ON 50
ci_052                -1.778929e-03 3 1  ON 51
ci_053                -2.585940e-03 3 1  ON 52
ci_054                -2.565757e-03 3 1  ON 53
ci_055                -1.849134e-03 3 1  ON 54
ci_056                -1.274820e-03 3 1  ON 55
ci_057                -1.299613e-03 3 1  ON 56
ci_058                -1.038229e-03 3 1  ON 57
ci_059                -4.802989e-04 3 1  ON 58
ci_060                -3.232965e-04 3 1  ON 59
ci_061                -6.076004e-04 3 1  ON 60
ci_062                -4.989758e-04 3 1  ON 61
ci_063                -7.329367e-04 3 1  ON 62
ci_064                -8.361008e-04 3 1  ON 63
ci_065                -1.793640e-03 3 1  ON 64
ci_066                -1.701877e-03 3 1  ON 65
ci_067                -1.438771e-03 3 1  ON 66
ci_068                -1.625190e-03 3 1  ON 67
ci_069                 2.236557e-04 3 1  ON 68
ci_070                 2.636994e-04 3 1  ON 69
ci_071                -1.518927e-03 3 1  ON 70
ci_072                -2.068086e-03 3 1  ON 71
ci_073                 1.546380e-04 3 1  ON 72
ci_074                 2.724037e-04 3 1  ON 73
ci_075                 6.335642e-05 3 1  ON 74
ci_076                 2.659340e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2647e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6211
    reference variance = 0.447811
====================================================
  Execution time = 2.6119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5083e-01
  Total weights = 1.955367505e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441718331958
                                         uncertainty =       0.002200213069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441718331958
                                         uncertainty =       0.002200213069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470191073
  error estimate for blocks of size 2^( 2) =       0.000494146077
  error estimate for blocks of size 2^( 3) =       0.000516520562
  error estimate for blocks of size 2^( 4) =       0.000532726239
  error estimate for blocks of size 2^( 5) =       0.000541691080
  error estimate for blocks of size 2^( 6) =       0.000545514655
  error estimate for blocks of size 2^( 7) =       0.000548741638

      target function =      -0.744636759219
              le_mean =     -22.661756798632
             les_mean =     514.006047919727
             stat err =       0.000542168403
             autocorr =       1.329595843910
   target nu stat err =       0.000542168403
   target dn stat err =       0.002698909865
      target stat err =       0.002288004404
              std dev =       0.664950592059
             le_variance =       0.442159289880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266175679863e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744642637261       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744650678525       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744652167426       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744652257501       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744652276815       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744652307366       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744652290480       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744652298622       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744652301902       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744652302732       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744652302574       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 9.484371e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744642637261       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744644676679       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744645051548       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744645073981       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744645078730       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744645086308       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744645082095       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744645084115       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744645084930       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744645085131       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744645085090       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.398490e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744642637261       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744643148967       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744643242850       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744643248453       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744643249635       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744643251526       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744643250473       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744643250977       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744643251181       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744643251230       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744643251220       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 6.013593e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126590 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0829e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -7.016144e-01 3 1  ON 0
ci_002                -7.061350e-01 3 1  ON 1
ci_003                -5.386936e-02 3 1  ON 2
ci_004                -5.521308e-02 3 1  ON 3
ci_005                 2.044242e-02 3 1  ON 4
ci_006                 2.048075e-02 3 1  ON 5
ci_007                 1.669369e-02 3 1  ON 6
ci_008                 1.667412e-02 3 1  ON 7
ci_009                -1.282487e-02 3 1  ON 8
ci_010                -1.298861e-02 3 1  ON 9
ci_011                -1.037154e-02 3 1  ON 10
ci_012                -1.041240e-02 3 1  ON 11
ci_013                 9.317824e-03 3 1  ON 12
ci_014                 9.394423e-03 3 1  ON 13
ci_015                 9.836157e-03 3 1  ON 14
ci_016                 1.025597e-02 3 1  ON 15
ci_017                 8.754414e-03 3 1  ON 16
ci_018                 8.769089e-03 3 1  ON 17
ci_019                -2.813782e-04 3 1  ON 18
ci_020                -7.274714e-05 3 1  ON 19
ci_021                -9.630220e-03 3 1  ON 20
ci_022                -1.042465e-02 3 1  ON 21
ci_023                 5.643118e-03 3 1  ON 22
ci_024                 5.164053e-03 3 1  ON 23
ci_025                 1.253103e-02 3 1  ON 24
ci_026                 1.193252e-02 3 1  ON 25
ci_027                 6.298804e-03 3 1  ON 26
ci_028                 6.393675e-03 3 1  ON 27
ci_029                -3.895430e-03 3 1  ON 28
ci_030                -4.537326e-03 3 1  ON 29
ci_031                 3.286419e-03 3 1  ON 30
ci_032                 2.828259e-03 3 1  ON 31
ci_033                 3.632805e-03 3 1  ON 32
ci_034                 3.548288e-03 3 1  ON 33
ci_035                 2.478471e-03 3 1  ON 34
ci_036                 2.236159e-03 3 1  ON 35
ci_037                 3.473782e-03 3 1  ON 36
ci_038                 3.673211e-03 3 1  ON 37
ci_039                 4.455899e-03 3 1  ON 38
ci_040                 4.450442e-03 3 1  ON 39
ci_041                 2.759225e-03 3 1  ON 40
ci_042                 3.008346e-03 3 1  ON 41
ci_043                 3.659095e-03 3 1  ON 42
ci_044                 3.326184e-03 3 1  ON 43
ci_045                 2.481905e-03 3 1  ON 44
ci_046                 2.829893e-03 3 1  ON 45
ci_047                -1.178609e-03 3 1  ON 46
ci_048                -1.309578e-03 3 1  ON 47
ci_049                 1.162232e-03 3 1  ON 48
ci_050                 9.361285e-04 3 1  ON 49
ci_051                -1.671330e-03 3 1  ON 50
ci_052                -1.770338e-03 3 1  ON 51
ci_053                -2.588394e-03 3 1  ON 52
ci_054                -2.569802e-03 3 1  ON 53
ci_055                -1.850919e-03 3 1  ON 54
ci_056                -1.272580e-03 3 1  ON 55
ci_057                -1.293248e-03 3 1  ON 56
ci_058                -1.035397e-03 3 1  ON 57
ci_059                -4.764971e-04 3 1  ON 58
ci_060                -3.209274e-04 3 1  ON 59
ci_061                -6.096808e-04 3 1  ON 60
ci_062                -4.997290e-04 3 1  ON 61
ci_063                -7.273850e-04 3 1  ON 62
ci_064                -8.334334e-04 3 1  ON 63
ci_065                -1.796881e-03 3 1  ON 64
ci_066                -1.698937e-03 3 1  ON 65
ci_067                -1.443456e-03 3 1  ON 66
ci_068                -1.616570e-03 3 1  ON 67
ci_069                 2.270540e-04 3 1  ON 68
ci_070                 2.558358e-04 3 1  ON 69
ci_071                -1.518875e-03 3 1  ON 70
ci_072                -2.068828e-03 3 1  ON 71
ci_073                 1.554915e-04 3 1  ON 72
ci_074                 2.744803e-04 3 1  ON 73
ci_075                 6.276812e-05 3 1  ON 74
ci_076                 2.657626e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6692
    reference variance = 0.423327
====================================================
  Execution time = 2.5422e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5252e-01
  Total weights = 1.9552e+06
  Execution time = 3.6089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441006139435
                                         uncertainty =       0.002348810921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441006139435
                                         uncertainty =       0.002348810921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469669252
  error estimate for blocks of size 2^( 2) =       0.000493798192
  error estimate for blocks of size 2^( 3) =       0.000515939827
  error estimate for blocks of size 2^( 4) =       0.000531938215
  error estimate for blocks of size 2^( 5) =       0.000541851841
  error estimate for blocks of size 2^( 6) =       0.000545821763
  error estimate for blocks of size 2^( 7) =       0.000547657326

      target function =      -0.743226712341
              le_mean =     -22.661161964042
             les_mean =     513.980804403518
             stat err =       0.000541817286
             autocorr =       1.330826546093
   target nu stat err =       0.000541817286
   target dn stat err =       0.003267868876
      target stat err =       0.002727713296
              std dev =       0.664212626318
             le_variance =       0.441178412960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440986631523
                                         uncertainty =       0.002348309449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440986631523
                                         uncertainty =       0.002348309449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469658787
  error estimate for blocks of size 2^( 2) =       0.000493789866
  error estimate for blocks of size 2^( 3) =       0.000515932877
  error estimate for blocks of size 2^( 4) =       0.000531931274
  error estimate for blocks of size 2^( 5) =       0.000541843866
  error estimate for blocks of size 2^( 6) =       0.000545811983
  error estimate for blocks of size 2^( 7) =       0.000547649209

      target function =      -0.743218240301
              le_mean =     -22.661162199336
             les_mean =     513.980825380582
             stat err =       0.000541809083
             autocorr =       1.330845555265
   target nu stat err =       0.000541809083
   target dn stat err =       0.003280233026
      target stat err =       0.002737483681
              std dev =       0.664197826430
             le_variance =       0.441158752635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440996140297
                                         uncertainty =       0.002348556658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440996140297
                                         uncertainty =       0.002348556658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469663889
  error estimate for blocks of size 2^( 2) =       0.000493793915
  error estimate for blocks of size 2^( 3) =       0.000515936249
  error estimate for blocks of size 2^( 4) =       0.000531934641
  error estimate for blocks of size 2^( 5) =       0.000541847748
  error estimate for blocks of size 2^( 6) =       0.000545816760
  error estimate for blocks of size 2^( 7) =       0.000547653175

      target function =      -0.743235309869
              le_mean =     -22.661162069908
             les_mean =     513.980798605690
             stat err =       0.000541813081
             autocorr =       1.330836282347
   target nu stat err =       0.000541813081
   target dn stat err =       0.003273898331
      target stat err =       0.002732569025
              std dev =       0.664205041403
             le_variance =       0.441168337026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441004871056
                                         uncertainty =       0.002348778854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441004871056
                                         uncertainty =       0.002348778854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469668572
  error estimate for blocks of size 2^( 2) =       0.000493797648
  error estimate for blocks of size 2^( 3) =       0.000515939369
  error estimate for blocks of size 2^( 4) =       0.000531937756
  error estimate for blocks of size 2^( 5) =       0.000541851317
  error estimate for blocks of size 2^( 6) =       0.000545821122
  error estimate for blocks of size 2^( 7) =       0.000547656794

      target function =      -0.743243033520
              le_mean =     -22.661161975974
             les_mean =     513.980784905849
             stat err =       0.000541816747
             autocorr =       1.330827752446
   target nu stat err =       0.000541816747
   target dn stat err =       0.003268466434
      target stat err =       0.002728305356
              std dev =       0.664211664276
             le_variance =       0.441177134960


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743226712341        initial
     2.5000e+00     2.5000e+01             9.4844e-05        -0.743218240301
     1.0000e+01     1.0000e+02             2.3985e-05        -0.743235309869
     4.0000e+01     4.0000e+02             6.0136e-06        -0.743243033520  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 4.3513e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -7.016102e-01 3 1  ON 0
ci_002                -7.061365e-01 3 1  ON 1
ci_003                -5.388144e-02 3 1  ON 2
ci_004                -5.521764e-02 3 1  ON 3
ci_005                 2.045264e-02 3 1  ON 4
ci_006                 2.048886e-02 3 1  ON 5
ci_007                 1.669750e-02 3 1  ON 6
ci_008                 1.668544e-02 3 1  ON 7
ci_009                -1.282368e-02 3 1  ON 8
ci_010                -1.299449e-02 3 1  ON 9
ci_011                -1.038066e-02 3 1  ON 10
ci_012                -1.041520e-02 3 1  ON 11
ci_013                 9.324135e-03 3 1  ON 12
ci_014                 9.397150e-03 3 1  ON 13
ci_015                 9.841451e-03 3 1  ON 14
ci_016                 1.026261e-02 3 1  ON 15
ci_017                 8.752933e-03 3 1  ON 16
ci_018                 8.769468e-03 3 1  ON 17
ci_019                -2.655578e-04 3 1  ON 18
ci_020                -5.477584e-05 3 1  ON 19
ci_021                -9.627515e-03 3 1  ON 20
ci_022                -1.042308e-02 3 1  ON 21
ci_023                 5.646502e-03 3 1  ON 22
ci_024                 5.165750e-03 3 1  ON 23
ci_025                 1.253123e-02 3 1  ON 24
ci_026                 1.192147e-02 3 1  ON 25
ci_027                 6.295930e-03 3 1  ON 26
ci_028                 6.396899e-03 3 1  ON 27
ci_029                -3.898190e-03 3 1  ON 28
ci_030                -4.537510e-03 3 1  ON 29
ci_031                 3.281318e-03 3 1  ON 30
ci_032                 2.823261e-03 3 1  ON 31
ci_033                 3.634520e-03 3 1  ON 32
ci_034                 3.550442e-03 3 1  ON 33
ci_035                 2.478665e-03 3 1  ON 34
ci_036                 2.239915e-03 3 1  ON 35
ci_037                 3.475249e-03 3 1  ON 36
ci_038                 3.679503e-03 3 1  ON 37
ci_039                 4.455869e-03 3 1  ON 38
ci_040                 4.449976e-03 3 1  ON 39
ci_041                 2.762219e-03 3 1  ON 40
ci_042                 3.009489e-03 3 1  ON 41
ci_043                 3.660651e-03 3 1  ON 42
ci_044                 3.328921e-03 3 1  ON 43
ci_045                 2.483266e-03 3 1  ON 44
ci_046                 2.828101e-03 3 1  ON 45
ci_047                -1.181126e-03 3 1  ON 46
ci_048                -1.313323e-03 3 1  ON 47
ci_049                 1.164862e-03 3 1  ON 48
ci_050                 9.381524e-04 3 1  ON 49
ci_051                -1.673796e-03 3 1  ON 50
ci_052                -1.776775e-03 3 1  ON 51
ci_053                -2.586555e-03 3 1  ON 52
ci_054                -2.566771e-03 3 1  ON 53
ci_055                -1.849582e-03 3 1  ON 54
ci_056                -1.274258e-03 3 1  ON 55
ci_057                -1.298015e-03 3 1  ON 56
ci_058                -1.037519e-03 3 1  ON 57
ci_059                -4.793449e-04 3 1  ON 58
ci_060                -3.227021e-04 3 1  ON 59
ci_061                -6.081222e-04 3 1  ON 60
ci_062                -4.991646e-04 3 1  ON 61
ci_063                -7.315441e-04 3 1  ON 62
ci_064                -8.354318e-04 3 1  ON 63
ci_065                -1.794453e-03 3 1  ON 64
ci_066                -1.701140e-03 3 1  ON 65
ci_067                -1.439946e-03 3 1  ON 66
ci_068                -1.623028e-03 3 1  ON 67
ci_069                 2.245081e-04 3 1  ON 68
ci_070                 2.617270e-04 3 1  ON 69
ci_071                -1.518914e-03 3 1  ON 70
ci_072                -2.068272e-03 3 1  ON 71
ci_073                 1.548525e-04 3 1  ON 72
ci_074                 2.729250e-04 3 1  ON 73
ci_075                 6.320886e-05 3 1  ON 74
ci_076                 2.658911e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2647e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7275
    reference variance = 0.52446
====================================================
  Execution time = 2.6076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4954e-01
  Total weights = 1.955014476e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439678285260
                                         uncertainty =       0.002145771460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439678285260
                                         uncertainty =       0.002145771460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468943735
  error estimate for blocks of size 2^( 2) =       0.000493387601
  error estimate for blocks of size 2^( 3) =       0.000515913696
  error estimate for blocks of size 2^( 4) =       0.000532062076
  error estimate for blocks of size 2^( 5) =       0.000542051370
  error estimate for blocks of size 2^( 6) =       0.000549645938
  error estimate for blocks of size 2^( 7) =       0.000550653885

      target function =      -0.745688826513
              le_mean =     -22.661495911834
             les_mean =     513.992936992874
             stat err =       0.000543603317
             autocorr =       1.343763128044
   target nu stat err =       0.000543603317
   target dn stat err =       0.002559245711
      target stat err =       0.002183357611
              std dev =       0.663186589752
             le_variance =       0.439816452827


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266149591183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745694252745       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745696874923       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745697219349       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745697227438       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745697246967       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745697266585       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745697270318       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745697270018       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745697271118       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745697271572       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745697271983       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745697272287       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.211659e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745694252745       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745694910593       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745694996830       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745694998840       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745695003726       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745695008626       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745695009549       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745695009472       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745695009746       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745695009858       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745695009960       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745695010035       residual = 1.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 5.545354e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745694252745       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745694417352       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745694438919       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745694439421       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745694440643       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745694441867       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745694442098       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745694442078       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745694442146       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745694442175       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745694442200       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745694442219       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+02 is 1.387355e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0785e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -7.016070e-01 3 1  ON 0
ci_002                -7.061407e-01 3 1  ON 1
ci_003                -5.387882e-02 3 1  ON 2
ci_004                -5.521469e-02 3 1  ON 3
ci_005                 2.044979e-02 3 1  ON 4
ci_006                 2.048656e-02 3 1  ON 5
ci_007                 1.669264e-02 3 1  ON 6
ci_008                 1.668107e-02 3 1  ON 7
ci_009                -1.282376e-02 3 1  ON 8
ci_010                -1.299416e-02 3 1  ON 9
ci_011                -1.037883e-02 3 1  ON 10
ci_012                -1.041118e-02 3 1  ON 11
ci_013                 9.322978e-03 3 1  ON 12
ci_014                 9.393836e-03 3 1  ON 13
ci_015                 9.840080e-03 3 1  ON 14
ci_016                 1.026030e-02 3 1  ON 15
ci_017                 8.752053e-03 3 1  ON 16
ci_018                 8.770038e-03 3 1  ON 17
ci_019                -2.711031e-04 3 1  ON 18
ci_020                -5.875909e-05 3 1  ON 19
ci_021                -9.632564e-03 3 1  ON 20
ci_022                -1.042400e-02 3 1  ON 21
ci_023                 5.644208e-03 3 1  ON 22
ci_024                 5.165391e-03 3 1  ON 23
ci_025                 1.253439e-02 3 1  ON 24
ci_026                 1.192080e-02 3 1  ON 25
ci_027                 6.294758e-03 3 1  ON 26
ci_028                 6.396190e-03 3 1  ON 27
ci_029                -3.897787e-03 3 1  ON 28
ci_030                -4.536554e-03 3 1  ON 29
ci_031                 3.281755e-03 3 1  ON 30
ci_032                 2.827394e-03 3 1  ON 31
ci_033                 3.633396e-03 3 1  ON 32
ci_034                 3.550683e-03 3 1  ON 33
ci_035                 2.477969e-03 3 1  ON 34
ci_036                 2.240046e-03 3 1  ON 35
ci_037                 3.475497e-03 3 1  ON 36
ci_038                 3.678524e-03 3 1  ON 37
ci_039                 4.456090e-03 3 1  ON 38
ci_040                 4.450372e-03 3 1  ON 39
ci_041                 2.762263e-03 3 1  ON 40
ci_042                 3.009708e-03 3 1  ON 41
ci_043                 3.659042e-03 3 1  ON 42
ci_044                 3.328700e-03 3 1  ON 43
ci_045                 2.482813e-03 3 1  ON 44
ci_046                 2.826741e-03 3 1  ON 45
ci_047                -1.179578e-03 3 1  ON 46
ci_048                -1.312862e-03 3 1  ON 47
ci_049                 1.164125e-03 3 1  ON 48
ci_050                 9.370863e-04 3 1  ON 49
ci_051                -1.672978e-03 3 1  ON 50
ci_052                -1.774830e-03 3 1  ON 51
ci_053                -2.587520e-03 3 1  ON 52
ci_054                -2.568372e-03 3 1  ON 53
ci_055                -1.849443e-03 3 1  ON 54
ci_056                -1.272724e-03 3 1  ON 55
ci_057                -1.297259e-03 3 1  ON 56
ci_058                -1.037608e-03 3 1  ON 57
ci_059                -4.778680e-04 3 1  ON 58
ci_060                -3.231527e-04 3 1  ON 59
ci_061                -6.057877e-04 3 1  ON 60
ci_062                -5.004267e-04 3 1  ON 61
ci_063                -7.320260e-04 3 1  ON 62
ci_064                -8.354869e-04 3 1  ON 63
ci_065                -1.794587e-03 3 1  ON 64
ci_066                -1.698803e-03 3 1  ON 65
ci_067                -1.441374e-03 3 1  ON 66
ci_068                -1.620912e-03 3 1  ON 67
ci_069                 2.229174e-04 3 1  ON 68
ci_070                 2.614629e-04 3 1  ON 69
ci_071                -1.518459e-03 3 1  ON 70
ci_072                -2.066801e-03 3 1  ON 71
ci_073                 1.543089e-04 3 1  ON 72
ci_074                 2.737983e-04 3 1  ON 73
ci_075                 6.363377e-05 3 1  ON 74
ci_076                 2.654690e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7175
    reference variance = 0.289769
====================================================
  Execution time = 2.7261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4965e-01
  Total weights = 1.9554e+06
  Execution time = 3.5953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440661289539
                                         uncertainty =       0.003164166337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440661289539
                                         uncertainty =       0.003164166337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469392393
  error estimate for blocks of size 2^( 2) =       0.000493607724
  error estimate for blocks of size 2^( 3) =       0.000515386662
  error estimate for blocks of size 2^( 4) =       0.000530856759
  error estimate for blocks of size 2^( 5) =       0.000541154475
  error estimate for blocks of size 2^( 6) =       0.000544747373
  error estimate for blocks of size 2^( 7) =       0.000547246198

      target function =      -0.745543519925
              le_mean =     -22.661219083340
             les_mean =     513.980555431425
             stat err =       0.000541001201
             autocorr =       1.328386231236
   target nu stat err =       0.000541001201
   target dn stat err =       0.003727675185
      target stat err =       0.003113466108
              std dev =       0.663821087599
             le_variance =       0.440658436341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440654100500
                                         uncertainty =       0.003163773257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440654100500
                                         uncertainty =       0.003163773257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469388637
  error estimate for blocks of size 2^( 2) =       0.000493604340
  error estimate for blocks of size 2^( 3) =       0.000515383521
  error estimate for blocks of size 2^( 4) =       0.000530853950
  error estimate for blocks of size 2^( 5) =       0.000541151503
  error estimate for blocks of size 2^( 6) =       0.000544744576
  error estimate for blocks of size 2^( 7) =       0.000547242915

      target function =      -0.745622283221
              le_mean =     -22.661219382019
             les_mean =     513.980472922307
             stat err =       0.000540998236
             autocorr =       1.328392927345
   target nu stat err =       0.000540998236
   target dn stat err =       0.003725923030
      target stat err =       0.003112702379
              std dev =       0.663815775892
             le_variance =       0.440651384323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440657672829
                                         uncertainty =       0.003163968151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440657672829
                                         uncertainty =       0.003163968151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469390503
  error estimate for blocks of size 2^( 2) =       0.000493606021
  error estimate for blocks of size 2^( 3) =       0.000515385083
  error estimate for blocks of size 2^( 4) =       0.000530855347
  error estimate for blocks of size 2^( 5) =       0.000541152980
  error estimate for blocks of size 2^( 6) =       0.000544745958
  error estimate for blocks of size 2^( 7) =       0.000547244554

      target function =      -0.745596944524
              le_mean =     -22.661219231701
             les_mean =     513.980497007548
             stat err =       0.000540999710
             autocorr =       1.328389601806
   target nu stat err =       0.000540999710
   target dn stat err =       0.003726193155
      target stat err =       0.003112711718
              std dev =       0.663818415143
             le_variance =       0.440654888282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440660835861
                                         uncertainty =       0.003164141426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440660835861
                                         uncertainty =       0.003164141426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469392155
  error estimate for blocks of size 2^( 2) =       0.000493607510
  error estimate for blocks of size 2^( 3) =       0.000515386464
  error estimate for blocks of size 2^( 4) =       0.000530856581
  error estimate for blocks of size 2^( 5) =       0.000541154286
  error estimate for blocks of size 2^( 6) =       0.000544747192
  error estimate for blocks of size 2^( 7) =       0.000547245991

      target function =      -0.745561035358
              le_mean =     -22.661219102202
             les_mean =     513.980534926210
             stat err =       0.000541001013
             autocorr =       1.328386647058
   target nu stat err =       0.000541001013
   target dn stat err =       0.003727142335
      target stat err =       0.003113180943
              std dev =       0.663820752346
             le_variance =       0.440657991245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745543519925        initial
     1.0000e+01     1.0000e+02             2.2117e-05        -0.745622283221  <--
     4.0000e+01     4.0000e+02             5.5454e-06        -0.745596944524
     1.6000e+02     1.6000e+03             1.3874e-06        -0.745561035358

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.5265e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -7.015971e-01 3 1  ON 0
ci_002                -7.061533e-01 3 1  ON 1
ci_003                -5.387097e-02 3 1  ON 2
ci_004                -5.520589e-02 3 1  ON 3
ci_005                 2.044128e-02 3 1  ON 4
ci_006                 2.047968e-02 3 1  ON 5
ci_007                 1.667811e-02 3 1  ON 6
ci_008                 1.666801e-02 3 1  ON 7
ci_009                -1.282401e-02 3 1  ON 8
ci_010                -1.299320e-02 3 1  ON 9
ci_011                -1.037335e-02 3 1  ON 10
ci_012                -1.039916e-02 3 1  ON 11
ci_013                 9.319522e-03 3 1  ON 12
ci_014                 9.383938e-03 3 1  ON 13
ci_015                 9.835981e-03 3 1  ON 14
ci_016                 1.025340e-02 3 1  ON 15
ci_017                 8.749428e-03 3 1  ON 16
ci_018                 8.771741e-03 3 1  ON 17
ci_019                -2.876743e-04 3 1  ON 18
ci_020                -7.066247e-05 3 1  ON 19
ci_021                -9.647650e-03 3 1  ON 20
ci_022                -1.042675e-02 3 1  ON 21
ci_023                 5.637360e-03 3 1  ON 22
ci_024                 5.164319e-03 3 1  ON 23
ci_025                 1.254385e-02 3 1  ON 24
ci_026                 1.191879e-02 3 1  ON 25
ci_027                 6.291260e-03 3 1  ON 26
ci_028                 6.394076e-03 3 1  ON 27
ci_029                -3.896582e-03 3 1  ON 28
ci_030                -4.533700e-03 3 1  ON 29
ci_031                 3.283063e-03 3 1  ON 30
ci_032                 2.839746e-03 3 1  ON 31
ci_033                 3.630038e-03 3 1  ON 32
ci_034                 3.551405e-03 3 1  ON 33
ci_035                 2.475890e-03 3 1  ON 34
ci_036                 2.240436e-03 3 1  ON 35
ci_037                 3.476239e-03 3 1  ON 36
ci_038                 3.675600e-03 3 1  ON 37
ci_039                 4.456750e-03 3 1  ON 38
ci_040                 4.451556e-03 3 1  ON 39
ci_041                 2.762394e-03 3 1  ON 40
ci_042                 3.010362e-03 3 1  ON 41
ci_043                 3.654234e-03 3 1  ON 42
ci_044                 3.328041e-03 3 1  ON 43
ci_045                 2.481461e-03 3 1  ON 44
ci_046                 2.822678e-03 3 1  ON 45
ci_047                -1.174960e-03 3 1  ON 46
ci_048                -1.311484e-03 3 1  ON 47
ci_049                 1.161922e-03 3 1  ON 48
ci_050                 9.339027e-04 3 1  ON 49
ci_051                -1.670533e-03 3 1  ON 50
ci_052                -1.769019e-03 3 1  ON 51
ci_053                -2.590402e-03 3 1  ON 52
ci_054                -2.573158e-03 3 1  ON 53
ci_055                -1.849026e-03 3 1  ON 54
ci_056                -1.268141e-03 3 1  ON 55
ci_057                -1.295001e-03 3 1  ON 56
ci_058                -1.037875e-03 3 1  ON 57
ci_059                -4.734591e-04 3 1  ON 58
ci_060                -3.244985e-04 3 1  ON 59
ci_061                -5.988139e-04 3 1  ON 60
ci_062                -5.041963e-04 3 1  ON 61
ci_063                -7.334664e-04 3 1  ON 62
ci_064                -8.356533e-04 3 1  ON 63
ci_065                -1.794988e-03 3 1  ON 64
ci_066                -1.691822e-03 3 1  ON 65
ci_067                -1.445639e-03 3 1  ON 66
ci_068                -1.614593e-03 3 1  ON 67
ci_069                 2.181661e-04 3 1  ON 68
ci_070                 2.606740e-04 3 1  ON 69
ci_071                -1.517099e-03 3 1  ON 70
ci_072                -2.062406e-03 3 1  ON 71
ci_073                 1.526857e-04 3 1  ON 72
ci_074                 2.764041e-04 3 1  ON 73
ci_075                 6.490285e-05 3 1  ON 74
ci_076                 2.642082e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6056e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2650e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6417
    reference variance = 0.366274
====================================================
  Execution time = 2.6333e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4690e-01
  Total weights = 1.955296236e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437030999260
                                         uncertainty =       0.001967881857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437030999260
                                         uncertainty =       0.001967881857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467439556
  error estimate for blocks of size 2^( 2) =       0.000491640776
  error estimate for blocks of size 2^( 3) =       0.000514128025
  error estimate for blocks of size 2^( 4) =       0.000529676287
  error estimate for blocks of size 2^( 5) =       0.000538613583
  error estimate for blocks of size 2^( 6) =       0.000543507737
  error estimate for blocks of size 2^( 7) =       0.000544474542

      target function =      -0.747860742817
              le_mean =     -22.661448927229
             les_mean =     513.988166471126
             stat err =       0.000539068037
             autocorr =       1.329952844753
   target nu stat err =       0.000539068037
   target dn stat err =       0.002689523977
      target stat err =       0.002297771122
              std dev =       0.661059359850
             le_variance =       0.436999477246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266144892723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747866816906       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747874691139       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747875869231       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747875940320       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747875956705       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747875971959       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747875968042       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747875968290       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747875974343       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747875973219       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747875970531       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747875968975       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 8.795311e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747866816906       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747868813571       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747869109875       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747869127584       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747869131638       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747869135427       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747869134429       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747869134493       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747869135985       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747869135689       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747869135030       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.224108e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747866816906       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747867317860       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747867392047       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747867396470       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747867397481       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747867398427       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747867398176       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747867398192       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747867398564       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747867398489       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747867398325       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 5.576349e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1028e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -7.015929e-01 3 1  ON 0
ci_002                -7.061604e-01 3 1  ON 1
ci_003                -5.386236e-02 3 1  ON 2
ci_004                -5.519852e-02 3 1  ON 3
ci_005                 2.043831e-02 3 1  ON 4
ci_006                 2.046811e-02 3 1  ON 5
ci_007                 1.667355e-02 3 1  ON 6
ci_008                 1.666068e-02 3 1  ON 7
ci_009                -1.281088e-02 3 1  ON 8
ci_010                -1.299042e-02 3 1  ON 9
ci_011                -1.036555e-02 3 1  ON 10
ci_012                -1.038825e-02 3 1  ON 11
ci_013                 9.306864e-03 3 1  ON 12
ci_014                 9.372553e-03 3 1  ON 13
ci_015                 9.836204e-03 3 1  ON 14
ci_016                 1.023512e-02 3 1  ON 15
ci_017                 8.749184e-03 3 1  ON 16
ci_018                 8.766200e-03 3 1  ON 17
ci_019                -3.024036e-04 3 1  ON 18
ci_020                -9.290355e-05 3 1  ON 19
ci_021                -9.650485e-03 3 1  ON 20
ci_022                -1.043640e-02 3 1  ON 21
ci_023                 5.628960e-03 3 1  ON 22
ci_024                 5.161411e-03 3 1  ON 23
ci_025                 1.254777e-02 3 1  ON 24
ci_026                 1.192993e-02 3 1  ON 25
ci_027                 6.286846e-03 3 1  ON 26
ci_028                 6.394994e-03 3 1  ON 27
ci_029                -3.895126e-03 3 1  ON 28
ci_030                -4.532846e-03 3 1  ON 29
ci_031                 3.298070e-03 3 1  ON 30
ci_032                 2.849624e-03 3 1  ON 31
ci_033                 3.627832e-03 3 1  ON 32
ci_034                 3.549122e-03 3 1  ON 33
ci_035                 2.473710e-03 3 1  ON 34
ci_036                 2.238740e-03 3 1  ON 35
ci_037                 3.472015e-03 3 1  ON 36
ci_038                 3.678877e-03 3 1  ON 37
ci_039                 4.452783e-03 3 1  ON 38
ci_040                 4.448313e-03 3 1  ON 39
ci_041                 2.765091e-03 3 1  ON 40
ci_042                 3.007701e-03 3 1  ON 41
ci_043                 3.652775e-03 3 1  ON 42
ci_044                 3.326297e-03 3 1  ON 43
ci_045                 2.481834e-03 3 1  ON 44
ci_046                 2.814575e-03 3 1  ON 45
ci_047                -1.178454e-03 3 1  ON 46
ci_048                -1.304474e-03 3 1  ON 47
ci_049                 1.151288e-03 3 1  ON 48
ci_050                 9.386827e-04 3 1  ON 49
ci_051                -1.673221e-03 3 1  ON 50
ci_052                -1.764765e-03 3 1  ON 51
ci_053                -2.588748e-03 3 1  ON 52
ci_054                -2.575031e-03 3 1  ON 53
ci_055                -1.845680e-03 3 1  ON 54
ci_056                -1.267646e-03 3 1  ON 55
ci_057                -1.296096e-03 3 1  ON 56
ci_058                -1.037593e-03 3 1  ON 57
ci_059                -4.684723e-04 3 1  ON 58
ci_060                -3.213352e-04 3 1  ON 59
ci_061                -5.933440e-04 3 1  ON 60
ci_062                -4.992093e-04 3 1  ON 61
ci_063                -7.400829e-04 3 1  ON 62
ci_064                -8.438327e-04 3 1  ON 63
ci_065                -1.793010e-03 3 1  ON 64
ci_066                -1.696727e-03 3 1  ON 65
ci_067                -1.440864e-03 3 1  ON 66
ci_068                -1.614187e-03 3 1  ON 67
ci_069                 2.171568e-04 3 1  ON 68
ci_070                 2.559121e-04 3 1  ON 69
ci_071                -1.517537e-03 3 1  ON 70
ci_072                -2.063983e-03 3 1  ON 71
ci_073                 1.529545e-04 3 1  ON 72
ci_074                 2.720405e-04 3 1  ON 73
ci_075                 6.951521e-05 3 1  ON 74
ci_076                 2.673003e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6983
    reference variance = 0.387242
====================================================
  Execution time = 2.5380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5110e-01
  Total weights = 1.9553e+06
  Execution time = 3.6084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441571249345
                                         uncertainty =       0.003829537709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441571249345
                                         uncertainty =       0.003829537709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469889099
  error estimate for blocks of size 2^( 2) =       0.000493725745
  error estimate for blocks of size 2^( 3) =       0.000516449510
  error estimate for blocks of size 2^( 4) =       0.000531446749
  error estimate for blocks of size 2^( 5) =       0.000542957320
  error estimate for blocks of size 2^( 6) =       0.000547686810
  error estimate for blocks of size 2^( 7) =       0.000553251043

      target function =      -0.744416213858
              le_mean =     -22.662337991662
             les_mean =     514.032649967773
             stat err =       0.000543835480
             autocorr =       1.339504993988
   target nu stat err =       0.000543835480
   target dn stat err =       0.004655096225
      target stat err =       0.003857877729
              std dev =       0.664523536007
             le_variance =       0.441591529907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441562207625
                                         uncertainty =       0.003833185720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441562207625
                                         uncertainty =       0.003833185720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469884292
  error estimate for blocks of size 2^( 2) =       0.000493722196
  error estimate for blocks of size 2^( 3) =       0.000516447025
  error estimate for blocks of size 2^( 4) =       0.000531445333
  error estimate for blocks of size 2^( 5) =       0.000542955711
  error estimate for blocks of size 2^( 6) =       0.000547687383
  error estimate for blocks of size 2^( 7) =       0.000553252155

      target function =      -0.744221261943
              le_mean =     -22.662338005785
             les_mean =     514.032888644203
             stat err =       0.000543835146
             autocorr =       1.339530747670
   target nu stat err =       0.000543835146
   target dn stat err =       0.004670371320
      target stat err =       0.003868231039
              std dev =       0.664516738705
             le_variance =       0.441582496019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441566540624
                                         uncertainty =       0.003831376388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441566540624
                                         uncertainty =       0.003831376388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469886596
  error estimate for blocks of size 2^( 2) =       0.000493723877
  error estimate for blocks of size 2^( 3) =       0.000516448188
  error estimate for blocks of size 2^( 4) =       0.000531445972
  error estimate for blocks of size 2^( 5) =       0.000542956438
  error estimate for blocks of size 2^( 6) =       0.000547687032
  error estimate for blocks of size 2^( 7) =       0.000553251519

      target function =      -0.744377554425
              le_mean =     -22.662337986268
             les_mean =     514.032696887714
             stat err =       0.000543835240
             autocorr =       1.339518080020
   target nu stat err =       0.000543835240
   target dn stat err =       0.004660960241
      target stat err =       0.003862224548
              std dev =       0.664519996173
             le_variance =       0.441586825314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441570645214
                                         uncertainty =       0.003829767845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441570645214
                                         uncertainty =       0.003829767845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469888777
  error estimate for blocks of size 2^( 2) =       0.000493725504
  error estimate for blocks of size 2^( 3) =       0.000516449337
  error estimate for blocks of size 2^( 4) =       0.000531446645
  error estimate for blocks of size 2^( 5) =       0.000542957203
  error estimate for blocks of size 2^( 6) =       0.000547686831
  error estimate for blocks of size 2^( 7) =       0.000553251096

      target function =      -0.744414046186
              le_mean =     -22.662337989064
             les_mean =     514.032652490525
             stat err =       0.000543835444
             autocorr =       1.339506643554
   target nu stat err =       0.000543835444
   target dn stat err =       0.004655805534
      target stat err =       0.003858429243
              std dev =       0.664523081844
             le_variance =       0.441590926304


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744416213858        initial  <--
     2.5000e+00     2.5000e+01             8.7953e-05        -0.744221261943
     1.0000e+01     1.0000e+02             2.2241e-05        -0.744377554425
     4.0000e+01     4.0000e+02             5.5763e-06        -0.744414046186

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4017
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -7.015971e-01 3 1  ON 0
ci_002                -7.061533e-01 3 1  ON 1
ci_003                -5.387097e-02 3 1  ON 2
ci_004                -5.520589e-02 3 1  ON 3
ci_005                 2.044128e-02 3 1  ON 4
ci_006                 2.047968e-02 3 1  ON 5
ci_007                 1.667811e-02 3 1  ON 6
ci_008                 1.666801e-02 3 1  ON 7
ci_009                -1.282401e-02 3 1  ON 8
ci_010                -1.299320e-02 3 1  ON 9
ci_011                -1.037335e-02 3 1  ON 10
ci_012                -1.039916e-02 3 1  ON 11
ci_013                 9.319522e-03 3 1  ON 12
ci_014                 9.383938e-03 3 1  ON 13
ci_015                 9.835981e-03 3 1  ON 14
ci_016                 1.025340e-02 3 1  ON 15
ci_017                 8.749428e-03 3 1  ON 16
ci_018                 8.771741e-03 3 1  ON 17
ci_019                -2.876743e-04 3 1  ON 18
ci_020                -7.066247e-05 3 1  ON 19
ci_021                -9.647650e-03 3 1  ON 20
ci_022                -1.042675e-02 3 1  ON 21
ci_023                 5.637360e-03 3 1  ON 22
ci_024                 5.164319e-03 3 1  ON 23
ci_025                 1.254385e-02 3 1  ON 24
ci_026                 1.191879e-02 3 1  ON 25
ci_027                 6.291260e-03 3 1  ON 26
ci_028                 6.394076e-03 3 1  ON 27
ci_029                -3.896582e-03 3 1  ON 28
ci_030                -4.533700e-03 3 1  ON 29
ci_031                 3.283063e-03 3 1  ON 30
ci_032                 2.839746e-03 3 1  ON 31
ci_033                 3.630038e-03 3 1  ON 32
ci_034                 3.551405e-03 3 1  ON 33
ci_035                 2.475890e-03 3 1  ON 34
ci_036                 2.240436e-03 3 1  ON 35
ci_037                 3.476239e-03 3 1  ON 36
ci_038                 3.675600e-03 3 1  ON 37
ci_039                 4.456750e-03 3 1  ON 38
ci_040                 4.451556e-03 3 1  ON 39
ci_041                 2.762394e-03 3 1  ON 40
ci_042                 3.010362e-03 3 1  ON 41
ci_043                 3.654234e-03 3 1  ON 42
ci_044                 3.328041e-03 3 1  ON 43
ci_045                 2.481461e-03 3 1  ON 44
ci_046                 2.822678e-03 3 1  ON 45
ci_047                -1.174960e-03 3 1  ON 46
ci_048                -1.311484e-03 3 1  ON 47
ci_049                 1.161922e-03 3 1  ON 48
ci_050                 9.339027e-04 3 1  ON 49
ci_051                -1.670533e-03 3 1  ON 50
ci_052                -1.769019e-03 3 1  ON 51
ci_053                -2.590402e-03 3 1  ON 52
ci_054                -2.573158e-03 3 1  ON 53
ci_055                -1.849026e-03 3 1  ON 54
ci_056                -1.268141e-03 3 1  ON 55
ci_057                -1.295001e-03 3 1  ON 56
ci_058                -1.037875e-03 3 1  ON 57
ci_059                -4.734591e-04 3 1  ON 58
ci_060                -3.244985e-04 3 1  ON 59
ci_061                -5.988139e-04 3 1  ON 60
ci_062                -5.041963e-04 3 1  ON 61
ci_063                -7.334664e-04 3 1  ON 62
ci_064                -8.356533e-04 3 1  ON 63
ci_065                -1.794988e-03 3 1  ON 64
ci_066                -1.691822e-03 3 1  ON 65
ci_067                -1.445639e-03 3 1  ON 66
ci_068                -1.614593e-03 3 1  ON 67
ci_069                 2.181661e-04 3 1  ON 68
ci_070                 2.606740e-04 3 1  ON 69
ci_071                -1.517099e-03 3 1  ON 70
ci_072                -2.062406e-03 3 1  ON 71
ci_073                 1.526857e-04 3 1  ON 72
ci_074                 2.764041e-04 3 1  ON 73
ci_075                 6.490285e-05 3 1  ON 74
ci_076                 2.642082e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4435e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.616
    reference variance = 0.267109
====================================================
  Execution time = 2.6178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4822e-01
  Total weights = 1.954949366e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439416924118
                                         uncertainty =       0.002235043098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439416924118
                                         uncertainty =       0.002235043098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468694670
  error estimate for blocks of size 2^( 2) =       0.000492878856
  error estimate for blocks of size 2^( 3) =       0.000515383690
  error estimate for blocks of size 2^( 4) =       0.000531647923
  error estimate for blocks of size 2^( 5) =       0.000542161761
  error estimate for blocks of size 2^( 6) =       0.000546408692
  error estimate for blocks of size 2^( 7) =       0.000549572672

      target function =      -0.746774885596
              le_mean =     -22.661604259152
             les_mean =     513.996527777505
             stat err =       0.000542447762
             autocorr =       1.339478703129
   target nu stat err =       0.000542447762
   target dn stat err =       0.002529883870
      target stat err =       0.002166248165
              std dev =       0.662834359599
             le_variance =       0.439349388264


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266160425915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746780206736       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746781188888       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746781398347       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746781424711       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746781437064       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746781445249       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746781449199       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746781449201       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746781448636       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746781448028       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746781447643       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 8.344799e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746780206736       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746780452631       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746780505040       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746780511632       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746780514720       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746780516763       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746780517749       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746780517749       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746780517607       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746780517455       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746780517359       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+02 is 2.088650e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746780206736       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746780268232       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746780281337       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746780282985       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746780283757       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746780284267       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746780284515       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746780284514       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746780284478       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746780284441       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746780284417       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+02 is 5.223158e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0854e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -7.015959e-01 3 1  ON 0
ci_002                -7.061549e-01 3 1  ON 1
ci_003                -5.387030e-02 3 1  ON 2
ci_004                -5.520396e-02 3 1  ON 3
ci_005                 2.044029e-02 3 1  ON 4
ci_006                 2.047829e-02 3 1  ON 5
ci_007                 1.667692e-02 3 1  ON 6
ci_008                 1.666733e-02 3 1  ON 7
ci_009                -1.282278e-02 3 1  ON 8
ci_010                -1.299260e-02 3 1  ON 9
ci_011                -1.037232e-02 3 1  ON 10
ci_012                -1.039709e-02 3 1  ON 11
ci_013                 9.319506e-03 3 1  ON 12
ci_014                 9.383786e-03 3 1  ON 13
ci_015                 9.835131e-03 3 1  ON 14
ci_016                 1.025214e-02 3 1  ON 15
ci_017                 8.749440e-03 3 1  ON 16
ci_018                 8.771311e-03 3 1  ON 17
ci_019                -2.884098e-04 3 1  ON 18
ci_020                -7.275112e-05 3 1  ON 19
ci_021                -9.648720e-03 3 1  ON 20
ci_022                -1.042782e-02 3 1  ON 21
ci_023                 5.635832e-03 3 1  ON 22
ci_024                 5.164213e-03 3 1  ON 23
ci_025                 1.254489e-02 3 1  ON 24
ci_026                 1.191915e-02 3 1  ON 25
ci_027                 6.291068e-03 3 1  ON 26
ci_028                 6.393657e-03 3 1  ON 27
ci_029                -3.895761e-03 3 1  ON 28
ci_030                -4.532856e-03 3 1  ON 29
ci_031                 3.284045e-03 3 1  ON 30
ci_032                 2.841118e-03 3 1  ON 31
ci_033                 3.628795e-03 3 1  ON 32
ci_034                 3.551642e-03 3 1  ON 33
ci_035                 2.475475e-03 3 1  ON 34
ci_036                 2.239967e-03 3 1  ON 35
ci_037                 3.476649e-03 3 1  ON 36
ci_038                 3.675231e-03 3 1  ON 37
ci_039                 4.457114e-03 3 1  ON 38
ci_040                 4.451270e-03 3 1  ON 39
ci_041                 2.762905e-03 3 1  ON 40
ci_042                 3.010526e-03 3 1  ON 41
ci_043                 3.653493e-03 3 1  ON 42
ci_044                 3.327327e-03 3 1  ON 43
ci_045                 2.482109e-03 3 1  ON 44
ci_046                 2.822437e-03 3 1  ON 45
ci_047                -1.174537e-03 3 1  ON 46
ci_048                -1.311070e-03 3 1  ON 47
ci_049                 1.161935e-03 3 1  ON 48
ci_050                 9.341005e-04 3 1  ON 49
ci_051                -1.669885e-03 3 1  ON 50
ci_052                -1.769112e-03 3 1  ON 51
ci_053                -2.590146e-03 3 1  ON 52
ci_054                -2.572742e-03 3 1  ON 53
ci_055                -1.848856e-03 3 1  ON 54
ci_056                -1.268209e-03 3 1  ON 55
ci_057                -1.294940e-03 3 1  ON 56
ci_058                -1.037265e-03 3 1  ON 57
ci_059                -4.738008e-04 3 1  ON 58
ci_060                -3.243853e-04 3 1  ON 59
ci_061                -5.988530e-04 3 1  ON 60
ci_062                -5.051871e-04 3 1  ON 61
ci_063                -7.338494e-04 3 1  ON 62
ci_064                -8.357850e-04 3 1  ON 63
ci_065                -1.794844e-03 3 1  ON 64
ci_066                -1.692100e-03 3 1  ON 65
ci_067                -1.445421e-03 3 1  ON 66
ci_068                -1.614732e-03 3 1  ON 67
ci_069                 2.176337e-04 3 1  ON 68
ci_070                 2.611418e-04 3 1  ON 69
ci_071                -1.516646e-03 3 1  ON 70
ci_072                -2.062835e-03 3 1  ON 71
ci_073                 1.527587e-04 3 1  ON 72
ci_074                 2.765119e-04 3 1  ON 73
ci_075                 6.532984e-05 3 1  ON 74
ci_076                 2.636830e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.6567
    reference variance = 0.421752
====================================================
  Execution time = 2.5263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5550e-01
  Total weights = 1.9555e+06
  Execution time = 3.6077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442362160576
                                         uncertainty =       0.002355618083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442362160576
                                         uncertainty =       0.002355618083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470277303
  error estimate for blocks of size 2^( 2) =       0.000494670235
  error estimate for blocks of size 2^( 3) =       0.000517085562
  error estimate for blocks of size 2^( 4) =       0.000533135651
  error estimate for blocks of size 2^( 5) =       0.000543168540
  error estimate for blocks of size 2^( 6) =       0.000547014185
  error estimate for blocks of size 2^( 7) =       0.000547768920

      target function =      -0.740837716126
              le_mean =     -22.663207276042
             les_mean =     514.076456717927
             stat err =       0.000542771824
             autocorr =       1.332068479377
   target nu stat err =       0.000542771824
   target dn stat err =       0.003370569161
      target stat err =       0.002800475042
              std dev =       0.665072540057
             le_variance =       0.442321483538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442359234995
                                         uncertainty =       0.002355546052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442359234995
                                         uncertainty =       0.002355546052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470275748
  error estimate for blocks of size 2^( 2) =       0.000494668902
  error estimate for blocks of size 2^( 3) =       0.000517084364
  error estimate for blocks of size 2^( 4) =       0.000533134518
  error estimate for blocks of size 2^( 5) =       0.000543167336
  error estimate for blocks of size 2^( 6) =       0.000547012993
  error estimate for blocks of size 2^( 7) =       0.000547768105

      target function =      -0.740844490388
              le_mean =     -22.663207252424
             les_mean =     514.076447306171
             stat err =       0.000542770738
             autocorr =       1.332071957232
   target nu stat err =       0.000542770738
   target dn stat err =       0.003370200095
      target stat err =       0.002800231931
              std dev =       0.665070341092
             le_variance =       0.442318558600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442360693892
                                         uncertainty =       0.002355581823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442360693892
                                         uncertainty =       0.002355581823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470276524
  error estimate for blocks of size 2^( 2) =       0.000494669567
  error estimate for blocks of size 2^( 3) =       0.000517084961
  error estimate for blocks of size 2^( 4) =       0.000533135083
  error estimate for blocks of size 2^( 5) =       0.000543167936
  error estimate for blocks of size 2^( 6) =       0.000547013587
  error estimate for blocks of size 2^( 7) =       0.000547768511

      target function =      -0.740835496186
              le_mean =     -22.663207264096
             les_mean =     514.076458912011
             stat err =       0.000542771279
             autocorr =       1.332070220720
   target nu stat err =       0.000542771279
   target dn stat err =       0.003370389951
      target stat err =       0.002800316277
              std dev =       0.665071437652
             le_variance =       0.442320017180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442361976961
                                         uncertainty =       0.002355613535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442361976961
                                         uncertainty =       0.002355613535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470277205
  error estimate for blocks of size 2^( 2) =       0.000494670151
  error estimate for blocks of size 2^( 3) =       0.000517085487
  error estimate for blocks of size 2^( 4) =       0.000533135580
  error estimate for blocks of size 2^( 5) =       0.000543168465
  error estimate for blocks of size 2^( 6) =       0.000547014110
  error estimate for blocks of size 2^( 7) =       0.000547768869

      target function =      -0.740837812810
              le_mean =     -22.663207274495
             les_mean =     514.076456528864
             stat err =       0.000542771756
             autocorr =       1.332068697560
   target nu stat err =       0.000542771756
   target dn stat err =       0.003370545814
      target stat err =       0.002800457211
              std dev =       0.665072402047
             le_variance =       0.442321299965


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740837716126        initial
     2.5000e+01     2.5000e+02             8.3448e-06        -0.740844490388  <--
     1.0000e+02     1.0000e+03             2.0886e-06        -0.740835496186
     4.0000e+02     4.0000e+03             5.2232e-07        -0.740837812810

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 4.3298e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -7.015921e-01 3 1  ON 0
ci_002                -7.061599e-01 3 1  ON 1
ci_003                -5.386830e-02 3 1  ON 2
ci_004                -5.519817e-02 3 1  ON 3
ci_005                 2.043732e-02 3 1  ON 4
ci_006                 2.047413e-02 3 1  ON 5
ci_007                 1.667337e-02 3 1  ON 6
ci_008                 1.666528e-02 3 1  ON 7
ci_009                -1.281909e-02 3 1  ON 8
ci_010                -1.299081e-02 3 1  ON 9
ci_011                -1.036924e-02 3 1  ON 10
ci_012                -1.039087e-02 3 1  ON 11
ci_013                 9.319457e-03 3 1  ON 12
ci_014                 9.383334e-03 3 1  ON 13
ci_015                 9.832583e-03 3 1  ON 14
ci_016                 1.024838e-02 3 1  ON 15
ci_017                 8.749477e-03 3 1  ON 16
ci_018                 8.770024e-03 3 1  ON 17
ci_019                -2.906129e-04 3 1  ON 18
ci_020                -7.900727e-05 3 1  ON 19
ci_021                -9.651927e-03 3 1  ON 20
ci_022                -1.043102e-02 3 1  ON 21
ci_023                 5.631257e-03 3 1  ON 22
ci_024                 5.163895e-03 3 1  ON 23
ci_025                 1.254801e-02 3 1  ON 24
ci_026                 1.192023e-02 3 1  ON 25
ci_027                 6.290493e-03 3 1  ON 26
ci_028                 6.392404e-03 3 1  ON 27
ci_029                -3.893301e-03 3 1  ON 28
ci_030                -4.530330e-03 3 1  ON 29
ci_031                 3.286988e-03 3 1  ON 30
ci_032                 2.845228e-03 3 1  ON 31
ci_033                 3.625072e-03 3 1  ON 32
ci_034                 3.552352e-03 3 1  ON 33
ci_035                 2.474234e-03 3 1  ON 34
ci_036                 2.238562e-03 3 1  ON 35
ci_037                 3.477877e-03 3 1  ON 36
ci_038                 3.674125e-03 3 1  ON 37
ci_039                 4.458204e-03 3 1  ON 38
ci_040                 4.450414e-03 3 1  ON 39
ci_041                 2.764432e-03 3 1  ON 40
ci_042                 3.011016e-03 3 1  ON 41
ci_043                 3.651272e-03 3 1  ON 42
ci_044                 3.325188e-03 3 1  ON 43
ci_045                 2.484049e-03 3 1  ON 44
ci_046                 2.821718e-03 3 1  ON 45
ci_047                -1.173270e-03 3 1  ON 46
ci_048                -1.309832e-03 3 1  ON 47
ci_049                 1.161973e-03 3 1  ON 48
ci_050                 9.346930e-04 3 1  ON 49
ci_051                -1.667943e-03 3 1  ON 50
ci_052                -1.769391e-03 3 1  ON 51
ci_053                -2.589381e-03 3 1  ON 52
ci_054                -2.571498e-03 3 1  ON 53
ci_055                -1.848348e-03 3 1  ON 54
ci_056                -1.268412e-03 3 1  ON 55
ci_057                -1.294757e-03 3 1  ON 56
ci_058                -1.035440e-03 3 1  ON 57
ci_059                -4.748236e-04 3 1  ON 58
ci_060                -3.240463e-04 3 1  ON 59
ci_061                -5.989702e-04 3 1  ON 60
ci_062                -5.081543e-04 3 1  ON 61
ci_063                -7.349965e-04 3 1  ON 62
ci_064                -8.361796e-04 3 1  ON 63
ci_065                -1.794413e-03 3 1  ON 64
ci_066                -1.692930e-03 3 1  ON 65
ci_067                -1.444771e-03 3 1  ON 66
ci_068                -1.615147e-03 3 1  ON 67
ci_069                 2.160393e-04 3 1  ON 68
ci_070                 2.625422e-04 3 1  ON 69
ci_071                -1.515289e-03 3 1  ON 70
ci_072                -2.064120e-03 3 1  ON 71
ci_073                 1.529774e-04 3 1  ON 72
ci_074                 2.768342e-04 3 1  ON 73
ci_075                 6.660883e-05 3 1  ON 74
ci_076                 2.621103e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7237
    reference variance = 0.329765
====================================================
  Execution time = 2.6019e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5607e-01
  Total weights = 1.955302039e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445975560816
                                         uncertainty =       0.006982224741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445975560816
                                         uncertainty =       0.006982224741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472232870
  error estimate for blocks of size 2^( 2) =       0.000496154481
  error estimate for blocks of size 2^( 3) =       0.000517792498
  error estimate for blocks of size 2^( 4) =       0.000532980245
  error estimate for blocks of size 2^( 5) =       0.000542131013
  error estimate for blocks of size 2^( 6) =       0.000545503570
  error estimate for blocks of size 2^( 7) =       0.000547130658

      target function =      -0.740324074380
              le_mean =     -22.661409999143
             les_mean =     513.995568232171
             stat err =       0.000541936372
             autocorr =       1.316995142886
   target nu stat err =       0.000541936372
   target dn stat err =       0.007831509320
      target stat err =       0.006360756650
              std dev =       0.667838128879
             le_variance =       0.446007766384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266140999914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740378309664       residual = 9.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740386954811       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740388800483       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740389148691       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740389225025       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740389345512       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740389366492       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740389372790       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740389385600       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740389392482       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740389389261       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740389389032       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740389389638       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 5.694128e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740378309664       residual = 9.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740380486195       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740380949469       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740381036586       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740381055638       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740381085733       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740381090867       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740381092418       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740381095601       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740381097292       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740381096487       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740381096433       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 1.424201e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740378309664       residual = 9.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740378854758       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740378970693       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740378992476       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740378997237       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740379004760       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740379006036       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740379006422       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740379007217       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740379007638       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740379007437       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740379007423       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+02 is 3.561141e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0722e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -7.016064e-01 3 1  ON 0
ci_002                -7.061469e-01 3 1  ON 1
ci_003                -5.385826e-02 3 1  ON 2
ci_004                -5.520139e-02 3 1  ON 3
ci_005                 2.043179e-02 3 1  ON 4
ci_006                 2.046995e-02 3 1  ON 5
ci_007                 1.666997e-02 3 1  ON 6
ci_008                 1.666209e-02 3 1  ON 7
ci_009                -1.281575e-02 3 1  ON 8
ci_010                -1.299234e-02 3 1  ON 9
ci_011                -1.036441e-02 3 1  ON 10
ci_012                -1.039032e-02 3 1  ON 11
ci_013                 9.317821e-03 3 1  ON 12
ci_014                 9.380474e-03 3 1  ON 13
ci_015                 9.829710e-03 3 1  ON 14
ci_016                 1.024112e-02 3 1  ON 15
ci_017                 8.755950e-03 3 1  ON 16
ci_018                 8.767674e-03 3 1  ON 17
ci_019                -2.940127e-04 3 1  ON 18
ci_020                -8.126337e-05 3 1  ON 19
ci_021                -9.656671e-03 3 1  ON 20
ci_022                -1.042713e-02 3 1  ON 21
ci_023                 5.624619e-03 3 1  ON 22
ci_024                 5.163990e-03 3 1  ON 23
ci_025                 1.255538e-02 3 1  ON 24
ci_026                 1.192380e-02 3 1  ON 25
ci_027                 6.287780e-03 3 1  ON 26
ci_028                 6.391891e-03 3 1  ON 27
ci_029                -3.889865e-03 3 1  ON 28
ci_030                -4.532562e-03 3 1  ON 29
ci_031                 3.291144e-03 3 1  ON 30
ci_032                 2.835607e-03 3 1  ON 31
ci_033                 3.625371e-03 3 1  ON 32
ci_034                 3.549400e-03 3 1  ON 33
ci_035                 2.474231e-03 3 1  ON 34
ci_036                 2.235729e-03 3 1  ON 35
ci_037                 3.478560e-03 3 1  ON 36
ci_038                 3.667601e-03 3 1  ON 37
ci_039                 4.464302e-03 3 1  ON 38
ci_040                 4.451511e-03 3 1  ON 39
ci_041                 2.764352e-03 3 1  ON 40
ci_042                 3.015999e-03 3 1  ON 41
ci_043                 3.651211e-03 3 1  ON 42
ci_044                 3.327640e-03 3 1  ON 43
ci_045                 2.485240e-03 3 1  ON 44
ci_046                 2.825232e-03 3 1  ON 45
ci_047                -1.172709e-03 3 1  ON 46
ci_048                -1.309560e-03 3 1  ON 47
ci_049                 1.154887e-03 3 1  ON 48
ci_050                 9.308873e-04 3 1  ON 49
ci_051                -1.672392e-03 3 1  ON 50
ci_052                -1.766936e-03 3 1  ON 51
ci_053                -2.591295e-03 3 1  ON 52
ci_054                -2.568238e-03 3 1  ON 53
ci_055                -1.848195e-03 3 1  ON 54
ci_056                -1.273853e-03 3 1  ON 55
ci_057                -1.292244e-03 3 1  ON 56
ci_058                -1.033832e-03 3 1  ON 57
ci_059                -4.734211e-04 3 1  ON 58
ci_060                -3.227488e-04 3 1  ON 59
ci_061                -5.967926e-04 3 1  ON 60
ci_062                -5.103358e-04 3 1  ON 61
ci_063                -7.355689e-04 3 1  ON 62
ci_064                -8.404643e-04 3 1  ON 63
ci_065                -1.794192e-03 3 1  ON 64
ci_066                -1.691877e-03 3 1  ON 65
ci_067                -1.444523e-03 3 1  ON 66
ci_068                -1.604525e-03 3 1  ON 67
ci_069                 2.160978e-04 3 1  ON 68
ci_070                 2.614419e-04 3 1  ON 69
ci_071                -1.517061e-03 3 1  ON 70
ci_072                -2.062267e-03 3 1  ON 71
ci_073                 1.543650e-04 3 1  ON 72
ci_074                 2.772828e-04 3 1  ON 73
ci_075                 6.722226e-05 3 1  ON 74
ci_076                 2.639890e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7219
    reference variance = 0.43835
====================================================
  Execution time = 2.5659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5376e-01
  Total weights = 1.9550e+06
  Execution time = 3.6205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442880177449
                                         uncertainty =       0.002895348096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442880177449
                                         uncertainty =       0.002895348096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470576347
  error estimate for blocks of size 2^( 2) =       0.000494289797
  error estimate for blocks of size 2^( 3) =       0.000516259175
  error estimate for blocks of size 2^( 4) =       0.000532359650
  error estimate for blocks of size 2^( 5) =       0.000542239288
  error estimate for blocks of size 2^( 6) =       0.000548171971
  error estimate for blocks of size 2^( 7) =       0.000549071889

      target function =      -0.742238961284
              le_mean =     -22.661374674851
             les_mean =     513.991659247241
             stat err =       0.000542960699
             autocorr =       1.331302059899
   target nu stat err =       0.000542960699
   target dn stat err =       0.003479774572
      target stat err =       0.002890088184
              std dev =       0.665495451352
             le_variance =       0.442884195771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442871687332
                                         uncertainty =       0.002894550931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442871687332
                                         uncertainty =       0.002894550931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470571900
  error estimate for blocks of size 2^( 2) =       0.000494285969
  error estimate for blocks of size 2^( 3) =       0.000516255970
  error estimate for blocks of size 2^( 4) =       0.000532356456
  error estimate for blocks of size 2^( 5) =       0.000542235649
  error estimate for blocks of size 2^( 6) =       0.000548169474
  error estimate for blocks of size 2^( 7) =       0.000549067621

      target function =      -0.742204129536
              le_mean =     -22.661374592751
             les_mean =     513.991698352603
             stat err =       0.000542957300
             autocorr =       1.331310547111
   target nu stat err =       0.000542957300
   target dn stat err =       0.003483953282
      target stat err =       0.002893145124
              std dev =       0.665489163651
             le_variance =       0.442875826936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442875861327
                                         uncertainty =       0.002894944465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442875861327
                                         uncertainty =       0.002894944465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470574086
  error estimate for blocks of size 2^( 2) =       0.000494287850
  error estimate for blocks of size 2^( 3) =       0.000516257541
  error estimate for blocks of size 2^( 4) =       0.000532358005
  error estimate for blocks of size 2^( 5) =       0.000542237421
  error estimate for blocks of size 2^( 6) =       0.000548170683
  error estimate for blocks of size 2^( 7) =       0.000549069689

      target function =      -0.742221338356
              le_mean =     -22.661374640939
             les_mean =     513.991679378532
             stat err =       0.000542958950
             autocorr =       1.331306270177
   target nu stat err =       0.000542958950
   target dn stat err =       0.003481746130
      target stat err =       0.002891521456
              std dev =       0.665492254329
             le_variance =       0.442879940572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442879631734
                                         uncertainty =       0.002895297225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442879631734
                                         uncertainty =       0.002895297225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470576061
  error estimate for blocks of size 2^( 2) =       0.000494289550
  error estimate for blocks of size 2^( 3) =       0.000516258967
  error estimate for blocks of size 2^( 4) =       0.000532359442
  error estimate for blocks of size 2^( 5) =       0.000542239052
  error estimate for blocks of size 2^( 6) =       0.000548171807
  error estimate for blocks of size 2^( 7) =       0.000549071611

      target function =      -0.742240022618
              le_mean =     -22.661374669833
             les_mean =     513.991657712308
             stat err =       0.000542960478
             autocorr =       1.331302590534
   target nu stat err =       0.000542960478
   target dn stat err =       0.003479989395
      target stat err =       0.002890267077
              std dev =       0.665495047078
             le_variance =       0.442883657686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742238961284        initial
     6.2500e+00     6.2500e+01             5.6941e-05        -0.742204129536
     2.5000e+01     2.5000e+02             1.4242e-05        -0.742221338356
     1.0000e+02     1.0000e+03             3.5611e-06        -0.742240022618  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+02     and shift_s =   1.0000e+03
*****************************************************************************

  Execution time = 4.3737e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -7.015957e-01 3 1  ON 0
ci_002                -7.061566e-01 3 1  ON 1
ci_003                -5.386579e-02 3 1  ON 2
ci_004                -5.519898e-02 3 1  ON 3
ci_005                 2.043593e-02 3 1  ON 4
ci_006                 2.047309e-02 3 1  ON 5
ci_007                 1.667252e-02 3 1  ON 6
ci_008                 1.666449e-02 3 1  ON 7
ci_009                -1.281825e-02 3 1  ON 8
ci_010                -1.299119e-02 3 1  ON 9
ci_011                -1.036803e-02 3 1  ON 10
ci_012                -1.039073e-02 3 1  ON 11
ci_013                 9.319048e-03 3 1  ON 12
ci_014                 9.382618e-03 3 1  ON 13
ci_015                 9.831864e-03 3 1  ON 14
ci_016                 1.024656e-02 3 1  ON 15
ci_017                 8.751098e-03 3 1  ON 16
ci_018                 8.769435e-03 3 1  ON 17
ci_019                -2.914637e-04 3 1  ON 18
ci_020                -7.957184e-05 3 1  ON 19
ci_021                -9.653114e-03 3 1  ON 20
ci_022                -1.043005e-02 3 1  ON 21
ci_023                 5.629595e-03 3 1  ON 22
ci_024                 5.163919e-03 3 1  ON 23
ci_025                 1.254986e-02 3 1  ON 24
ci_026                 1.192112e-02 3 1  ON 25
ci_027                 6.289814e-03 3 1  ON 26
ci_028                 6.392276e-03 3 1  ON 27
ci_029                -3.892441e-03 3 1  ON 28
ci_030                -4.530889e-03 3 1  ON 29
ci_031                 3.288028e-03 3 1  ON 30
ci_032                 2.842820e-03 3 1  ON 31
ci_033                 3.625147e-03 3 1  ON 32
ci_034                 3.551613e-03 3 1  ON 33
ci_035                 2.474233e-03 3 1  ON 34
ci_036                 2.237853e-03 3 1  ON 35
ci_037                 3.478048e-03 3 1  ON 36
ci_038                 3.672492e-03 3 1  ON 37
ci_039                 4.459731e-03 3 1  ON 38
ci_040                 4.450689e-03 3 1  ON 39
ci_041                 2.764412e-03 3 1  ON 40
ci_042                 3.012263e-03 3 1  ON 41
ci_043                 3.651256e-03 3 1  ON 42
ci_044                 3.325802e-03 3 1  ON 43
ci_045                 2.484347e-03 3 1  ON 44
ci_046                 2.822597e-03 3 1  ON 45
ci_047                -1.173129e-03 3 1  ON 46
ci_048                -1.309764e-03 3 1  ON 47
ci_049                 1.160198e-03 3 1  ON 48
ci_050                 9.337401e-04 3 1  ON 49
ci_051                -1.669056e-03 3 1  ON 50
ci_052                -1.768776e-03 3 1  ON 51
ci_053                -2.589861e-03 3 1  ON 52
ci_054                -2.570682e-03 3 1  ON 53
ci_055                -1.848309e-03 3 1  ON 54
ci_056                -1.269774e-03 3 1  ON 55
ci_057                -1.294128e-03 3 1  ON 56
ci_058                -1.035038e-03 3 1  ON 57
ci_059                -4.744725e-04 3 1  ON 58
ci_060                -3.237215e-04 3 1  ON 59
ci_061                -5.984247e-04 3 1  ON 60
ci_062                -5.087005e-04 3 1  ON 61
ci_063                -7.351399e-04 3 1  ON 62
ci_064                -8.372522e-04 3 1  ON 63
ci_065                -1.794358e-03 3 1  ON 64
ci_066                -1.692666e-03 3 1  ON 65
ci_067                -1.444708e-03 3 1  ON 66
ci_068                -1.612488e-03 3 1  ON 67
ci_069                 2.160538e-04 3 1  ON 68
ci_070                 2.622667e-04 3 1  ON 69
ci_071                -1.515733e-03 3 1  ON 70
ci_072                -2.063656e-03 3 1  ON 71
ci_073                 1.533253e-04 3 1  ON 72
ci_074                 2.769466e-04 3 1  ON 73
ci_075                 6.676238e-05 3 1  ON 74
ci_076                 2.625807e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4489e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6099
    reference variance = 0.328542
====================================================
  Execution time = 2.8543e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -2.2660e+01
  VMC Evar = 4.4888e-01
  Total weights = 1.955015272e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438648814918
                                         uncertainty =       0.001985735209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438648814918
                                         uncertainty =       0.001985735209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468328697
  error estimate for blocks of size 2^( 2) =       0.000492329102
  error estimate for blocks of size 2^( 3) =       0.000515142446
  error estimate for blocks of size 2^( 4) =       0.000530873703
  error estimate for blocks of size 2^( 5) =       0.000540054809
  error estimate for blocks of size 2^( 6) =       0.000545045763
  error estimate for blocks of size 2^( 7) =       0.000545334454

      target function =      -0.746207947390
              le_mean =     -22.660100245648
             les_mean =     513.929023984645
             stat err =       0.000540327182
             autocorr =       1.331104317162
   target nu stat err =       0.000540327182
   target dn stat err =       0.003126338893
      target stat err =       0.002631285877
              std dev =       0.662316794889
             le_variance =       0.438663536793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266010024565e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746216322945       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746216983134       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746217092946       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746217093747       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746217091859       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746217092709       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746217092690       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746217092986       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746217093254       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746217093530       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746217093485       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 6.754994e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746216322945       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746216488221       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746216515694       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746216515892       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746216515420       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746216515632       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746216515627       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746216515702       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746216515768       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746216515837       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746216515826       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+02 is 1.690702e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746216322945       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746216364278       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746216371148       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746216371197       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746216371079       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746216371132       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746216371132       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746216371150       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746216371166       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746216371184       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746216371181       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+02 is 4.227979e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149293 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3228e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -7.015947e-01 3 1  ON 0
ci_002                -7.061578e-01 3 1  ON 1
ci_003                -5.386490e-02 3 1  ON 2
ci_004                -5.519884e-02 3 1  ON 3
ci_005                 2.043487e-02 3 1  ON 4
ci_006                 2.047260e-02 3 1  ON 5
ci_007                 1.667162e-02 3 1  ON 6
ci_008                 1.666367e-02 3 1  ON 7
ci_009                -1.281720e-02 3 1  ON 8
ci_010                -1.299130e-02 3 1  ON 9
ci_011                -1.036718e-02 3 1  ON 10
ci_012                -1.039019e-02 3 1  ON 11
ci_013                 9.317418e-03 3 1  ON 12
ci_014                 9.382201e-03 3 1  ON 13
ci_015                 9.830173e-03 3 1  ON 14
ci_016                 1.024571e-02 3 1  ON 15
ci_017                 8.750179e-03 3 1  ON 16
ci_018                 8.769457e-03 3 1  ON 17
ci_019                -2.931017e-04 3 1  ON 18
ci_020                -8.051232e-05 3 1  ON 19
ci_021                -9.654641e-03 3 1  ON 20
ci_022                -1.043101e-02 3 1  ON 21
ci_023                 5.629186e-03 3 1  ON 22
ci_024                 5.163570e-03 3 1  ON 23
ci_025                 1.254962e-02 3 1  ON 24
ci_026                 1.192125e-02 3 1  ON 25
ci_027                 6.289944e-03 3 1  ON 26
ci_028                 6.392125e-03 3 1  ON 27
ci_029                -3.892400e-03 3 1  ON 28
ci_030                -4.530897e-03 3 1  ON 29
ci_031                 3.289010e-03 3 1  ON 30
ci_032                 2.843177e-03 3 1  ON 31
ci_033                 3.624834e-03 3 1  ON 32
ci_034                 3.550365e-03 3 1  ON 33
ci_035                 2.473953e-03 3 1  ON 34
ci_036                 2.237809e-03 3 1  ON 35
ci_037                 3.478111e-03 3 1  ON 36
ci_038                 3.671814e-03 3 1  ON 37
ci_039                 4.459967e-03 3 1  ON 38
ci_040                 4.450460e-03 3 1  ON 39
ci_041                 2.764783e-03 3 1  ON 40
ci_042                 3.012478e-03 3 1  ON 41
ci_043                 3.651600e-03 3 1  ON 42
ci_044                 3.326113e-03 3 1  ON 43
ci_045                 2.484022e-03 3 1  ON 44
ci_046                 2.822823e-03 3 1  ON 45
ci_047                -1.173161e-03 3 1  ON 46
ci_048                -1.309944e-03 3 1  ON 47
ci_049                 1.160018e-03 3 1  ON 48
ci_050                 9.337497e-04 3 1  ON 49
ci_051                -1.669106e-03 3 1  ON 50
ci_052                -1.768663e-03 3 1  ON 51
ci_053                -2.590461e-03 3 1  ON 52
ci_054                -2.570813e-03 3 1  ON 53
ci_055                -1.848124e-03 3 1  ON 54
ci_056                -1.269670e-03 3 1  ON 55
ci_057                -1.293844e-03 3 1  ON 56
ci_058                -1.034943e-03 3 1  ON 57
ci_059                -4.742130e-04 3 1  ON 58
ci_060                -3.238112e-04 3 1  ON 59
ci_061                -5.983614e-04 3 1  ON 60
ci_062                -5.091139e-04 3 1  ON 61
ci_063                -7.354378e-04 3 1  ON 62
ci_064                -8.373575e-04 3 1  ON 63
ci_065                -1.794490e-03 3 1  ON 64
ci_066                -1.692345e-03 3 1  ON 65
ci_067                -1.443549e-03 3 1  ON 66
ci_068                -1.611925e-03 3 1  ON 67
ci_069                 2.158376e-04 3 1  ON 68
ci_070                 2.621692e-04 3 1  ON 69
ci_071                -1.515934e-03 3 1  ON 70
ci_072                -2.062806e-03 3 1  ON 71
ci_073                 1.529512e-04 3 1  ON 72
ci_074                 2.766599e-04 3 1  ON 73
ci_075                 6.660514e-05 3 1  ON 74
ci_076                 2.621731e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7365
    reference variance = 0.430235
====================================================
  Execution time = 2.7240e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4959e-01
  Total weights = 1.9552e+06
  Execution time = 3.6085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440261729533
                                         uncertainty =       0.002110094355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440261729533
                                         uncertainty =       0.002110094355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469161099
  error estimate for blocks of size 2^( 2) =       0.000492784882
  error estimate for blocks of size 2^( 3) =       0.000514741747
  error estimate for blocks of size 2^( 4) =       0.000530699349
  error estimate for blocks of size 2^( 5) =       0.000539309788
  error estimate for blocks of size 2^( 6) =       0.000544189142
  error estimate for blocks of size 2^( 7) =       0.000542454550

      target function =      -0.745645631875
              le_mean =     -22.661149138380
             les_mean =     513.977267184324
             stat err =       0.000539163207
             autocorr =       1.320676668456
   target nu stat err =       0.000539163207
   target dn stat err =       0.002681365100
      target stat err =       0.002277191843
              std dev =       0.663493989652
             le_variance =       0.440224274304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440259380492
                                         uncertainty =       0.002109839491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440259380492
                                         uncertainty =       0.002109839491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469159847
  error estimate for blocks of size 2^( 2) =       0.000492783817
  error estimate for blocks of size 2^( 3) =       0.000514740852
  error estimate for blocks of size 2^( 4) =       0.000530698524
  error estimate for blocks of size 2^( 5) =       0.000539308975
  error estimate for blocks of size 2^( 6) =       0.000544188149
  error estimate for blocks of size 2^( 7) =       0.000542453920

      target function =      -0.745646897476
              le_mean =     -22.661149129040
             les_mean =     513.977265218961
             stat err =       0.000539162392
             autocorr =       1.320679725806
   target nu stat err =       0.000539162392
   target dn stat err =       0.002681091428
      target stat err =       0.002276982378
              std dev =       0.663492218463
             le_variance =       0.440221923960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440260552430
                                         uncertainty =       0.002109966704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440260552430
                                         uncertainty =       0.002109966704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469160472
  error estimate for blocks of size 2^( 2) =       0.000492784348
  error estimate for blocks of size 2^( 3) =       0.000514741299
  error estimate for blocks of size 2^( 4) =       0.000530698935
  error estimate for blocks of size 2^( 5) =       0.000539309381
  error estimate for blocks of size 2^( 6) =       0.000544188645
  error estimate for blocks of size 2^( 7) =       0.000542454234

      target function =      -0.745646298681
              le_mean =     -22.661149133572
             les_mean =     513.977266153914
             stat err =       0.000539162799
             autocorr =       1.320678200109
   target nu stat err =       0.000539162799
   target dn stat err =       0.002681227795
      target stat err =       0.002277086939
              std dev =       0.663493102111
             le_variance =       0.440223096549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440261582227
                                         uncertainty =       0.002110078387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440261582227
                                         uncertainty =       0.002110078387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469161021
  error estimate for blocks of size 2^( 2) =       0.000492784816
  error estimate for blocks of size 2^( 3) =       0.000514741691
  error estimate for blocks of size 2^( 4) =       0.000530699297
  error estimate for blocks of size 2^( 5) =       0.000539309737
  error estimate for blocks of size 2^( 6) =       0.000544189080
  error estimate for blocks of size 2^( 7) =       0.000542454510

      target function =      -0.745645718743
              le_mean =     -22.661149137764
             les_mean =     513.977267050557
             stat err =       0.000539163156
             autocorr =       1.320676860056
   target nu stat err =       0.000539163156
   target dn stat err =       0.002681347898
      target stat err =       0.002277178719
              std dev =       0.663493878583
             le_variance =       0.440224126917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745645631875        initial
     2.5000e+01     2.5000e+02             6.7550e-06        -0.745646897476  <--
     1.0000e+02     1.0000e+03             1.6907e-06        -0.745646298681
     4.0000e+02     4.0000e+03             4.2280e-07        -0.745645718743

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 4.5321e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -7.015919e-01 3 1  ON 0
ci_002                -7.061614e-01 3 1  ON 1
ci_003                -5.386223e-02 3 1  ON 2
ci_004                -5.519844e-02 3 1  ON 3
ci_005                 2.043168e-02 3 1  ON 4
ci_006                 2.047115e-02 3 1  ON 5
ci_007                 1.666891e-02 3 1  ON 6
ci_008                 1.666122e-02 3 1  ON 7
ci_009                -1.281405e-02 3 1  ON 8
ci_010                -1.299162e-02 3 1  ON 9
ci_011                -1.036461e-02 3 1  ON 10
ci_012                -1.038856e-02 3 1  ON 11
ci_013                 9.312536e-03 3 1  ON 12
ci_014                 9.380953e-03 3 1  ON 13
ci_015                 9.825109e-03 3 1  ON 14
ci_016                 1.024317e-02 3 1  ON 15
ci_017                 8.747427e-03 3 1  ON 16
ci_018                 8.769521e-03 3 1  ON 17
ci_019                -2.980079e-04 3 1  ON 18
ci_020                -8.332926e-05 3 1  ON 19
ci_021                -9.659213e-03 3 1  ON 20
ci_022                -1.043392e-02 3 1  ON 21
ci_023                 5.627961e-03 3 1  ON 22
ci_024                 5.162526e-03 3 1  ON 23
ci_025                 1.254892e-02 3 1  ON 24
ci_026                 1.192164e-02 3 1  ON 25
ci_027                 6.290336e-03 3 1  ON 26
ci_028                 6.391673e-03 3 1  ON 27
ci_029                -3.892280e-03 3 1  ON 28
ci_030                -4.530921e-03 3 1  ON 29
ci_031                 3.291951e-03 3 1  ON 30
ci_032                 2.844249e-03 3 1  ON 31
ci_033                 3.623898e-03 3 1  ON 32
ci_034                 3.546625e-03 3 1  ON 33
ci_035                 2.473112e-03 3 1  ON 34
ci_036                 2.237677e-03 3 1  ON 35
ci_037                 3.478299e-03 3 1  ON 36
ci_038                 3.669784e-03 3 1  ON 37
ci_039                 4.460672e-03 3 1  ON 38
ci_040                 4.449776e-03 3 1  ON 39
ci_041                 2.765893e-03 3 1  ON 40
ci_042                 3.013119e-03 3 1  ON 41
ci_043                 3.652630e-03 3 1  ON 42
ci_044                 3.327042e-03 3 1  ON 43
ci_045                 2.483050e-03 3 1  ON 44
ci_046                 2.823497e-03 3 1  ON 45
ci_047                -1.173255e-03 3 1  ON 46
ci_048                -1.310484e-03 3 1  ON 47
ci_049                 1.159480e-03 3 1  ON 48
ci_050                 9.337782e-04 3 1  ON 49
ci_051                -1.669255e-03 3 1  ON 50
ci_052                -1.768324e-03 3 1  ON 51
ci_053                -2.592259e-03 3 1  ON 52
ci_054                -2.571204e-03 3 1  ON 53
ci_055                -1.847569e-03 3 1  ON 54
ci_056                -1.269358e-03 3 1  ON 55
ci_057                -1.292995e-03 3 1  ON 56
ci_058                -1.034660e-03 3 1  ON 57
ci_059                -4.734360e-04 3 1  ON 58
ci_060                -3.240796e-04 3 1  ON 59
ci_061                -5.981715e-04 3 1  ON 60
ci_062                -5.103519e-04 3 1  ON 61
ci_063                -7.363303e-04 3 1  ON 62
ci_064                -8.376728e-04 3 1  ON 63
ci_065                -1.794885e-03 3 1  ON 64
ci_066                -1.691385e-03 3 1  ON 65
ci_067                -1.440077e-03 3 1  ON 66
ci_068                -1.610241e-03 3 1  ON 67
ci_069                 2.151901e-04 3 1  ON 68
ci_070                 2.618770e-04 3 1  ON 69
ci_071                -1.516535e-03 3 1  ON 70
ci_072                -2.060260e-03 3 1  ON 71
ci_073                 1.518316e-04 3 1  ON 72
ci_074                 2.758019e-04 3 1  ON 73
ci_075                 6.613418e-05 3 1  ON 74
ci_076                 2.609523e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8555e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.719
    reference variance = 0.451842
====================================================
  Execution time = 2.6141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4694e-01
  Total weights = 1.955105658e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437690156877
                                         uncertainty =       0.001829255434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437690156877
                                         uncertainty =       0.001829255434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467797648
  error estimate for blocks of size 2^( 2) =       0.000491614410
  error estimate for blocks of size 2^( 3) =       0.000513771358
  error estimate for blocks of size 2^( 4) =       0.000530397161
  error estimate for blocks of size 2^( 5) =       0.000539385271
  error estimate for blocks of size 2^( 6) =       0.000544465552
  error estimate for blocks of size 2^( 7) =       0.000546315501

      target function =      -0.747830056820
              le_mean =     -22.661460867895
             les_mean =     513.988746661323
             stat err =       0.000540140871
             autocorr =       1.333208313034
   target nu stat err =       0.000540140871
   target dn stat err =       0.002397902219
      target stat err =       0.002066473683
              std dev =       0.661565778562
             le_variance =       0.437669279364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266146086790e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747834811540       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747838106688       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747838679525       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747838721411       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747838729724       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747838754061       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747838755896       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747838761510       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747838763294       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747838766208       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747838766903       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747838767089       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 3.133026e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747834811540       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747835640023       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747835783654       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747835794118       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747835796190       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747835802269       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747835802713       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747835804107       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747835804552       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747835805273       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747835805443       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747835805488       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 7.868611e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747834811540       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747835018957       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747835054891       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747835057506       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747835058024       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747835059543       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747835059653       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747835060002       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747835060112       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747835060292       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747835060334       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747835060346       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+02 is 1.969418e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0834e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -7.015873e-01 3 1  ON 0
ci_002                -7.061670e-01 3 1  ON 1
ci_003                -5.386456e-02 3 1  ON 2
ci_004                -5.519323e-02 3 1  ON 3
ci_005                 2.042674e-02 3 1  ON 4
ci_006                 2.046723e-02 3 1  ON 5
ci_007                 1.666488e-02 3 1  ON 6
ci_008                 1.665704e-02 3 1  ON 7
ci_009                -1.281220e-02 3 1  ON 8
ci_010                -1.298605e-02 3 1  ON 9
ci_011                -1.036002e-02 3 1  ON 10
ci_012                -1.038821e-02 3 1  ON 11
ci_013                 9.306008e-03 3 1  ON 12
ci_014                 9.376542e-03 3 1  ON 13
ci_015                 9.818954e-03 3 1  ON 14
ci_016                 1.023995e-02 3 1  ON 15
ci_017                 8.747126e-03 3 1  ON 16
ci_018                 8.766109e-03 3 1  ON 17
ci_019                -3.058765e-04 3 1  ON 18
ci_020                -8.540364e-05 3 1  ON 19
ci_021                -9.661908e-03 3 1  ON 20
ci_022                -1.043971e-02 3 1  ON 21
ci_023                 5.626549e-03 3 1  ON 22
ci_024                 5.164839e-03 3 1  ON 23
ci_025                 1.255387e-02 3 1  ON 24
ci_026                 1.192291e-02 3 1  ON 25
ci_027                 6.289570e-03 3 1  ON 26
ci_028                 6.390255e-03 3 1  ON 27
ci_029                -3.891034e-03 3 1  ON 28
ci_030                -4.528135e-03 3 1  ON 29
ci_031                 3.296200e-03 3 1  ON 30
ci_032                 2.849597e-03 3 1  ON 31
ci_033                 3.626548e-03 3 1  ON 32
ci_034                 3.547278e-03 3 1  ON 33
ci_035                 2.472044e-03 3 1  ON 34
ci_036                 2.236352e-03 3 1  ON 35
ci_037                 3.472826e-03 3 1  ON 36
ci_038                 3.670800e-03 3 1  ON 37
ci_039                 4.462382e-03 3 1  ON 38
ci_040                 4.448877e-03 3 1  ON 39
ci_041                 2.764671e-03 3 1  ON 40
ci_042                 3.013954e-03 3 1  ON 41
ci_043                 3.649214e-03 3 1  ON 42
ci_044                 3.326722e-03 3 1  ON 43
ci_045                 2.484254e-03 3 1  ON 44
ci_046                 2.823126e-03 3 1  ON 45
ci_047                -1.172882e-03 3 1  ON 46
ci_048                -1.311370e-03 3 1  ON 47
ci_049                 1.157337e-03 3 1  ON 48
ci_050                 9.372595e-04 3 1  ON 49
ci_051                -1.669441e-03 3 1  ON 50
ci_052                -1.768015e-03 3 1  ON 51
ci_053                -2.591812e-03 3 1  ON 52
ci_054                -2.570173e-03 3 1  ON 53
ci_055                -1.845235e-03 3 1  ON 54
ci_056                -1.269477e-03 3 1  ON 55
ci_057                -1.294161e-03 3 1  ON 56
ci_058                -1.032616e-03 3 1  ON 57
ci_059                -4.721473e-04 3 1  ON 58
ci_060                -3.245150e-04 3 1  ON 59
ci_061                -5.970229e-04 3 1  ON 60
ci_062                -5.096418e-04 3 1  ON 61
ci_063                -7.346780e-04 3 1  ON 62
ci_064                -8.364957e-04 3 1  ON 63
ci_065                -1.797068e-03 3 1  ON 64
ci_066                -1.691408e-03 3 1  ON 65
ci_067                -1.442643e-03 3 1  ON 66
ci_068                -1.611049e-03 3 1  ON 67
ci_069                 2.158022e-04 3 1  ON 68
ci_070                 2.607665e-04 3 1  ON 69
ci_071                -1.519112e-03 3 1  ON 70
ci_072                -2.059955e-03 3 1  ON 71
ci_073                 1.516421e-04 3 1  ON 72
ci_074                 2.749881e-04 3 1  ON 73
ci_075                 6.606332e-05 3 1  ON 74
ci_076                 2.634957e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.559
    reference variance = 0.409466
====================================================
  Execution time = 2.5544e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5196e-01
  Total weights = 1.9554e+06
  Execution time = 3.6147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438240623163
                                         uncertainty =       0.001965697968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438240623163
                                         uncertainty =       0.001965697968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468348146
  error estimate for blocks of size 2^( 2) =       0.000492373693
  error estimate for blocks of size 2^( 3) =       0.000515482377
  error estimate for blocks of size 2^( 4) =       0.000531432296
  error estimate for blocks of size 2^( 5) =       0.000539735648
  error estimate for blocks of size 2^( 6) =       0.000545454641
  error estimate for blocks of size 2^( 7) =       0.000547739302

      target function =      -0.743701512468
              le_mean =     -22.661138979546
             les_mean =     513.979174651905
             stat err =       0.000541090472
             autocorr =       1.334756864230
   target nu stat err =       0.000541090472
   target dn stat err =       0.003932404251
      target stat err =       0.003262100873
              std dev =       0.662344299294
             le_variance =       0.438699970807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438237149843
                                         uncertainty =       0.001966362394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438237149843
                                         uncertainty =       0.001966362394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468346516
  error estimate for blocks of size 2^( 2) =       0.000492373101
  error estimate for blocks of size 2^( 3) =       0.000515482810
  error estimate for blocks of size 2^( 4) =       0.000531433096
  error estimate for blocks of size 2^( 5) =       0.000539736653
  error estimate for blocks of size 2^( 6) =       0.000545457496
  error estimate for blocks of size 2^( 7) =       0.000547743817

      target function =      -0.743656011560
              le_mean =     -22.661138837480
             les_mean =     513.979223691727
             stat err =       0.000541092765
             autocorr =       1.334777468971
   target nu stat err =       0.000541092765
   target dn stat err =       0.003968158761
      target stat err =       0.003290388128
              std dev =       0.662341994599
             le_variance =       0.438696917809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438238791907
                                         uncertainty =       0.001966021095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438238791907
                                         uncertainty =       0.001966021095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468347281
  error estimate for blocks of size 2^( 2) =       0.000492373352
  error estimate for blocks of size 2^( 3) =       0.000515482550
  error estimate for blocks of size 2^( 4) =       0.000531432650
  error estimate for blocks of size 2^( 5) =       0.000539736104
  error estimate for blocks of size 2^( 6) =       0.000545456017
  error estimate for blocks of size 2^( 7) =       0.000547741514

      target function =      -0.743685754294
              le_mean =     -22.661138906234
             les_mean =     513.979190511292
             stat err =       0.000541091571
             autocorr =       1.334767216715
   target nu stat err =       0.000541091571
   target dn stat err =       0.003948412566
      target stat err =       0.003274805644
              std dev =       0.662343076471
             le_variance =       0.438698350949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438240384929
                                         uncertainty =       0.001965737310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438240384929
                                         uncertainty =       0.001965737310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468348032
  error estimate for blocks of size 2^( 2) =       0.000492373646
  error estimate for blocks of size 2^( 3) =       0.000515482394
  error estimate for blocks of size 2^( 4) =       0.000531432335
  error estimate for blocks of size 2^( 5) =       0.000539735700
  error estimate for blocks of size 2^( 6) =       0.000545454807
  error estimate for blocks of size 2^( 7) =       0.000547739573

      target function =      -0.743700253350
              le_mean =     -22.661138970132
             les_mean =     513.979175753594
             stat err =       0.000541090604
             autocorr =       1.334758159310
   target nu stat err =       0.000541090604
   target dn stat err =       0.003934186304
      target stat err =       0.003263519412
              std dev =       0.662344139439
             le_variance =       0.438699759050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743701512468        initial  <--
     6.2500e+00     6.2500e+01             3.1330e-05        -0.743656011560
     2.5000e+01     2.5000e+02             7.8686e-06        -0.743685754294
     1.0000e+02     1.0000e+03             1.9694e-06        -0.743700253350

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6388
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -7.015919e-01 3 1  ON 0
ci_002                -7.061614e-01 3 1  ON 1
ci_003                -5.386223e-02 3 1  ON 2
ci_004                -5.519844e-02 3 1  ON 3
ci_005                 2.043168e-02 3 1  ON 4
ci_006                 2.047115e-02 3 1  ON 5
ci_007                 1.666891e-02 3 1  ON 6
ci_008                 1.666122e-02 3 1  ON 7
ci_009                -1.281405e-02 3 1  ON 8
ci_010                -1.299162e-02 3 1  ON 9
ci_011                -1.036461e-02 3 1  ON 10
ci_012                -1.038856e-02 3 1  ON 11
ci_013                 9.312536e-03 3 1  ON 12
ci_014                 9.380953e-03 3 1  ON 13
ci_015                 9.825109e-03 3 1  ON 14
ci_016                 1.024317e-02 3 1  ON 15
ci_017                 8.747427e-03 3 1  ON 16
ci_018                 8.769521e-03 3 1  ON 17
ci_019                -2.980079e-04 3 1  ON 18
ci_020                -8.332926e-05 3 1  ON 19
ci_021                -9.659213e-03 3 1  ON 20
ci_022                -1.043392e-02 3 1  ON 21
ci_023                 5.627961e-03 3 1  ON 22
ci_024                 5.162526e-03 3 1  ON 23
ci_025                 1.254892e-02 3 1  ON 24
ci_026                 1.192164e-02 3 1  ON 25
ci_027                 6.290336e-03 3 1  ON 26
ci_028                 6.391673e-03 3 1  ON 27
ci_029                -3.892280e-03 3 1  ON 28
ci_030                -4.530921e-03 3 1  ON 29
ci_031                 3.291951e-03 3 1  ON 30
ci_032                 2.844249e-03 3 1  ON 31
ci_033                 3.623898e-03 3 1  ON 32
ci_034                 3.546625e-03 3 1  ON 33
ci_035                 2.473112e-03 3 1  ON 34
ci_036                 2.237677e-03 3 1  ON 35
ci_037                 3.478299e-03 3 1  ON 36
ci_038                 3.669784e-03 3 1  ON 37
ci_039                 4.460672e-03 3 1  ON 38
ci_040                 4.449776e-03 3 1  ON 39
ci_041                 2.765893e-03 3 1  ON 40
ci_042                 3.013119e-03 3 1  ON 41
ci_043                 3.652630e-03 3 1  ON 42
ci_044                 3.327042e-03 3 1  ON 43
ci_045                 2.483050e-03 3 1  ON 44
ci_046                 2.823497e-03 3 1  ON 45
ci_047                -1.173255e-03 3 1  ON 46
ci_048                -1.310484e-03 3 1  ON 47
ci_049                 1.159480e-03 3 1  ON 48
ci_050                 9.337782e-04 3 1  ON 49
ci_051                -1.669255e-03 3 1  ON 50
ci_052                -1.768324e-03 3 1  ON 51
ci_053                -2.592259e-03 3 1  ON 52
ci_054                -2.571204e-03 3 1  ON 53
ci_055                -1.847569e-03 3 1  ON 54
ci_056                -1.269358e-03 3 1  ON 55
ci_057                -1.292995e-03 3 1  ON 56
ci_058                -1.034660e-03 3 1  ON 57
ci_059                -4.734360e-04 3 1  ON 58
ci_060                -3.240796e-04 3 1  ON 59
ci_061                -5.981715e-04 3 1  ON 60
ci_062                -5.103519e-04 3 1  ON 61
ci_063                -7.363303e-04 3 1  ON 62
ci_064                -8.376728e-04 3 1  ON 63
ci_065                -1.794885e-03 3 1  ON 64
ci_066                -1.691385e-03 3 1  ON 65
ci_067                -1.440077e-03 3 1  ON 66
ci_068                -1.610241e-03 3 1  ON 67
ci_069                 2.151901e-04 3 1  ON 68
ci_070                 2.618770e-04 3 1  ON 69
ci_071                -1.516535e-03 3 1  ON 70
ci_072                -2.060260e-03 3 1  ON 71
ci_073                 1.518316e-04 3 1  ON 72
ci_074                 2.758019e-04 3 1  ON 73
ci_075                 6.613418e-05 3 1  ON 74
ci_076                 2.609523e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6575
    reference variance = 0.368801
====================================================
  Execution time = 2.6160e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5121e-01
  Total weights = 1.955392055e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441320544144
                                         uncertainty =       0.002837979130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441320544144
                                         uncertainty =       0.002837979130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469754287
  error estimate for blocks of size 2^( 2) =       0.000493664102
  error estimate for blocks of size 2^( 3) =       0.000516518842
  error estimate for blocks of size 2^( 4) =       0.000533247852
  error estimate for blocks of size 2^( 5) =       0.000543080639
  error estimate for blocks of size 2^( 6) =       0.000548018211
  error estimate for blocks of size 2^( 7) =       0.000550929800

      target function =      -0.744309927320
              le_mean =     -22.660689602446
             les_mean =     513.958060687527
             stat err =       0.000543819126
             autocorr =       1.340193325987
   target nu stat err =       0.000543819126
   target dn stat err =       0.003488768476
      target stat err =       0.002910342851
              std dev =       0.664332882966
             le_variance =       0.441338179390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266068960245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744320279307       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744320683648       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744320759628       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744320766786       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744320770206       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744320774148       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744320773507       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744320774205       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744320774427       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744320774170       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744320773948       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744320773947       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 5.647535e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744320279307       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744320380451       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744320399451       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744320401241       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744320402096       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744320403081       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744320402921       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744320403095       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744320403150       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744320403086       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744320403030       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744320403030       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+02 is 1.412539e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744320279307       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744320304597       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744320309347       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744320309794       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744320310008       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744320310255       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744320310214       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744320310258       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744320310272       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744320310256       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744320310242       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744320310244       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+03 is 3.531758e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158912 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0888e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -7.015926e-01 3 1  ON 0
ci_002                -7.061608e-01 3 1  ON 1
ci_003                -5.386216e-02 3 1  ON 2
ci_004                -5.519804e-02 3 1  ON 3
ci_005                 2.043111e-02 3 1  ON 4
ci_006                 2.047064e-02 3 1  ON 5
ci_007                 1.666830e-02 3 1  ON 6
ci_008                 1.666069e-02 3 1  ON 7
ci_009                -1.281394e-02 3 1  ON 8
ci_010                -1.299130e-02 3 1  ON 9
ci_011                -1.036478e-02 3 1  ON 10
ci_012                -1.038822e-02 3 1  ON 11
ci_013                 9.312405e-03 3 1  ON 12
ci_014                 9.380805e-03 3 1  ON 13
ci_015                 9.824976e-03 3 1  ON 14
ci_016                 1.024283e-02 3 1  ON 15
ci_017                 8.747522e-03 3 1  ON 16
ci_018                 8.769492e-03 3 1  ON 17
ci_019                -2.986730e-04 3 1  ON 18
ci_020                -8.474180e-05 3 1  ON 19
ci_021                -9.659492e-03 3 1  ON 20
ci_022                -1.043357e-02 3 1  ON 21
ci_023                 5.627829e-03 3 1  ON 22
ci_024                 5.162540e-03 3 1  ON 23
ci_025                 1.254906e-02 3 1  ON 24
ci_026                 1.192234e-02 3 1  ON 25
ci_027                 6.290364e-03 3 1  ON 26
ci_028                 6.391642e-03 3 1  ON 27
ci_029                -3.892111e-03 3 1  ON 28
ci_030                -4.530900e-03 3 1  ON 29
ci_031                 3.292636e-03 3 1  ON 30
ci_032                 2.844115e-03 3 1  ON 31
ci_033                 3.623677e-03 3 1  ON 32
ci_034                 3.546622e-03 3 1  ON 33
ci_035                 2.473005e-03 3 1  ON 34
ci_036                 2.237497e-03 3 1  ON 35
ci_037                 3.478497e-03 3 1  ON 36
ci_038                 3.669829e-03 3 1  ON 37
ci_039                 4.460625e-03 3 1  ON 38
ci_040                 4.449336e-03 3 1  ON 39
ci_041                 2.765724e-03 3 1  ON 40
ci_042                 3.012902e-03 3 1  ON 41
ci_043                 3.652444e-03 3 1  ON 42
ci_044                 3.327253e-03 3 1  ON 43
ci_045                 2.482556e-03 3 1  ON 44
ci_046                 2.823284e-03 3 1  ON 45
ci_047                -1.173202e-03 3 1  ON 46
ci_048                -1.310618e-03 3 1  ON 47
ci_049                 1.159539e-03 3 1  ON 48
ci_050                 9.337989e-04 3 1  ON 49
ci_051                -1.669188e-03 3 1  ON 50
ci_052                -1.768140e-03 3 1  ON 51
ci_053                -2.592552e-03 3 1  ON 52
ci_054                -2.571260e-03 3 1  ON 53
ci_055                -1.847590e-03 3 1  ON 54
ci_056                -1.268973e-03 3 1  ON 55
ci_057                -1.293134e-03 3 1  ON 56
ci_058                -1.034786e-03 3 1  ON 57
ci_059                -4.734929e-04 3 1  ON 58
ci_060                -3.239241e-04 3 1  ON 59
ci_061                -5.978845e-04 3 1  ON 60
ci_062                -5.103228e-04 3 1  ON 61
ci_063                -7.360780e-04 3 1  ON 62
ci_064                -8.376352e-04 3 1  ON 63
ci_065                -1.795140e-03 3 1  ON 64
ci_066                -1.691444e-03 3 1  ON 65
ci_067                -1.440311e-03 3 1  ON 66
ci_068                -1.610666e-03 3 1  ON 67
ci_069                 2.148548e-04 3 1  ON 68
ci_070                 2.618038e-04 3 1  ON 69
ci_071                -1.516522e-03 3 1  ON 70
ci_072                -2.060272e-03 3 1  ON 71
ci_073                 1.519227e-04 3 1  ON 72
ci_074                 2.758959e-04 3 1  ON 73
ci_075                 6.625005e-05 3 1  ON 74
ci_076                 2.610278e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6997
    reference variance = 0.354267
====================================================
  Execution time = 2.5384e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5055e-01
  Total weights = 1.9551e+06
  Execution time = 3.6268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441827498569
                                         uncertainty =       0.002330576714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441827498569
                                         uncertainty =       0.002330576714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469954038
  error estimate for blocks of size 2^( 2) =       0.000493632633
  error estimate for blocks of size 2^( 3) =       0.000516144531
  error estimate for blocks of size 2^( 4) =       0.000531558239
  error estimate for blocks of size 2^( 5) =       0.000540929459
  error estimate for blocks of size 2^( 6) =       0.000546430978
  error estimate for blocks of size 2^( 7) =       0.000548114343

      target function =      -0.744861491760
              le_mean =     -22.661623096567
             les_mean =     513.999711652295
             stat err =       0.000541758255
             autocorr =       1.328924488074
   target nu stat err =       0.000541758255
   target dn stat err =       0.002707416293
      target stat err =       0.002295496411
              std dev =       0.664615373652
             le_variance =       0.441713594894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441826422168
                                         uncertainty =       0.002330548231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441826422168
                                         uncertainty =       0.002330548231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469953466
  error estimate for blocks of size 2^( 2) =       0.000493632179
  error estimate for blocks of size 2^( 3) =       0.000516144167
  error estimate for blocks of size 2^( 4) =       0.000531557892
  error estimate for blocks of size 2^( 5) =       0.000540929058
  error estimate for blocks of size 2^( 6) =       0.000546430555
  error estimate for blocks of size 2^( 7) =       0.000548113975

      target function =      -0.744862169606
              le_mean =     -22.661623123510
             les_mean =     513.999712045266
             stat err =       0.000541757870
             autocorr =       1.328925835237
   target nu stat err =       0.000541757870
   target dn stat err =       0.002707528054
      target stat err =       0.002295588812
              std dev =       0.664614565018
             le_variance =       0.441712520034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441826959832
                                         uncertainty =       0.002330562459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441826959832
                                         uncertainty =       0.002330562459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469953751
  error estimate for blocks of size 2^( 2) =       0.000493632406
  error estimate for blocks of size 2^( 3) =       0.000516144349
  error estimate for blocks of size 2^( 4) =       0.000531558065
  error estimate for blocks of size 2^( 5) =       0.000540929259
  error estimate for blocks of size 2^( 6) =       0.000546430766
  error estimate for blocks of size 2^( 7) =       0.000548114158

      target function =      -0.744861889833
              le_mean =     -22.661623110015
             les_mean =     513.999711775477
             stat err =       0.000541758062
             autocorr =       1.328925162008
   target nu stat err =       0.000541758062
   target dn stat err =       0.002707471680
      target stat err =       0.002295542573
              std dev =       0.664614968932
             le_variance =       0.441713056928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441827431189
                                         uncertainty =       0.002330574931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441827431189
                                         uncertainty =       0.002330574931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469954002
  error estimate for blocks of size 2^( 2) =       0.000493632605
  error estimate for blocks of size 2^( 3) =       0.000516144508
  error estimate for blocks of size 2^( 4) =       0.000531558217
  error estimate for blocks of size 2^( 5) =       0.000540929434
  error estimate for blocks of size 2^( 6) =       0.000546430951
  error estimate for blocks of size 2^( 7) =       0.000548114320

      target function =      -0.744861547556
              le_mean =     -22.661623098245
             les_mean =     513.999711660175
             stat err =       0.000541758231
             autocorr =       1.328924572314
   target nu stat err =       0.000541758231
   target dn stat err =       0.002707423164
      target stat err =       0.002295502176
              std dev =       0.664615323033
             le_variance =       0.441713527611


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744861491760        initial
     6.2500e+01     6.2500e+02             5.6475e-06        -0.744862169606  <--
     2.5000e+02     2.5000e+03             1.4125e-06        -0.744861889833
     1.0000e+03     1.0000e+04             3.5318e-07        -0.744861547556

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 4.3558e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -7.015947e-01 3 1  ON 0
ci_002                -7.061590e-01 3 1  ON 1
ci_003                -5.386197e-02 3 1  ON 2
ci_004                -5.519682e-02 3 1  ON 3
ci_005                 2.042940e-02 3 1  ON 4
ci_006                 2.046910e-02 3 1  ON 5
ci_007                 1.666646e-02 3 1  ON 6
ci_008                 1.665908e-02 3 1  ON 7
ci_009                -1.281361e-02 3 1  ON 8
ci_010                -1.299035e-02 3 1  ON 9
ci_011                -1.036526e-02 3 1  ON 10
ci_012                -1.038720e-02 3 1  ON 11
ci_013                 9.312014e-03 3 1  ON 12
ci_014                 9.380363e-03 3 1  ON 13
ci_015                 9.824580e-03 3 1  ON 14
ci_016                 1.024183e-02 3 1  ON 15
ci_017                 8.747805e-03 3 1  ON 16
ci_018                 8.769406e-03 3 1  ON 17
ci_019                -3.006669e-04 3 1  ON 18
ci_020                -8.897679e-05 3 1  ON 19
ci_021                -9.660327e-03 3 1  ON 20
ci_022                -1.043251e-02 3 1  ON 21
ci_023                 5.627433e-03 3 1  ON 22
ci_024                 5.162583e-03 3 1  ON 23
ci_025                 1.254948e-02 3 1  ON 24
ci_026                 1.192443e-02 3 1  ON 25
ci_027                 6.290450e-03 3 1  ON 26
ci_028                 6.391552e-03 3 1  ON 27
ci_029                -3.891604e-03 3 1  ON 28
ci_030                -4.530839e-03 3 1  ON 29
ci_031                 3.294690e-03 3 1  ON 30
ci_032                 2.843714e-03 3 1  ON 31
ci_033                 3.623016e-03 3 1  ON 32
ci_034                 3.546613e-03 3 1  ON 33
ci_035                 2.472684e-03 3 1  ON 34
ci_036                 2.236957e-03 3 1  ON 35
ci_037                 3.479088e-03 3 1  ON 36
ci_038                 3.669966e-03 3 1  ON 37
ci_039                 4.460483e-03 3 1  ON 38
ci_040                 4.448018e-03 3 1  ON 39
ci_041                 2.765217e-03 3 1  ON 40
ci_042                 3.012250e-03 3 1  ON 41
ci_043                 3.651885e-03 3 1  ON 42
ci_044                 3.327885e-03 3 1  ON 43
ci_045                 2.481075e-03 3 1  ON 44
ci_046                 2.822644e-03 3 1  ON 45
ci_047                -1.173042e-03 3 1  ON 46
ci_048                -1.311020e-03 3 1  ON 47
ci_049                 1.159713e-03 3 1  ON 48
ci_050                 9.338609e-04 3 1  ON 49
ci_051                -1.668988e-03 3 1  ON 50
ci_052                -1.767587e-03 3 1  ON 51
ci_053                -2.593432e-03 3 1  ON 52
ci_054                -2.571426e-03 3 1  ON 53
ci_055                -1.847651e-03 3 1  ON 54
ci_056                -1.267820e-03 3 1  ON 55
ci_057                -1.293551e-03 3 1  ON 56
ci_058                -1.035164e-03 3 1  ON 57
ci_059                -4.736636e-04 3 1  ON 58
ci_060                -3.234578e-04 3 1  ON 59
ci_061                -5.970241e-04 3 1  ON 60
ci_062                -5.102356e-04 3 1  ON 61
ci_063                -7.353217e-04 3 1  ON 62
ci_064                -8.375225e-04 3 1  ON 63
ci_065                -1.795907e-03 3 1  ON 64
ci_066                -1.691619e-03 3 1  ON 65
ci_067                -1.441011e-03 3 1  ON 66
ci_068                -1.611940e-03 3 1  ON 67
ci_069                 2.138496e-04 3 1  ON 68
ci_070                 2.615843e-04 3 1  ON 69
ci_071                -1.516482e-03 3 1  ON 70
ci_072                -2.060307e-03 3 1  ON 71
ci_073                 1.521959e-04 3 1  ON 72
ci_074                 2.761778e-04 3 1  ON 73
ci_075                 6.659748e-05 3 1  ON 74
ci_076                 2.612540e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.63
    reference variance = 0.493271
====================================================
  Execution time = 2.6171e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4550e-01
  Total weights = 1.955409418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436131404315
                                         uncertainty =       0.001797722887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436131404315
                                         uncertainty =       0.001797722887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466987755
  error estimate for blocks of size 2^( 2) =       0.000491044543
  error estimate for blocks of size 2^( 3) =       0.000513834685
  error estimate for blocks of size 2^( 4) =       0.000530177146
  error estimate for blocks of size 2^( 5) =       0.000540897151
  error estimate for blocks of size 2^( 6) =       0.000544054616
  error estimate for blocks of size 2^( 7) =       0.000547291949

      target function =      -0.749039412961
              le_mean =     -22.662531278064
             les_mean =     514.035819876175
             stat err =       0.000540605215
             autocorr =       1.340137858339
   target nu stat err =       0.000540605215
   target dn stat err =       0.002303104474
      target stat err =       0.002001173203
              std dev =       0.660420416993
             le_variance =       0.436155127181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266253127806e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749043822992       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749045098107       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749045390521       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749045417983       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749045427251       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749045423174       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749045424463       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749045424621       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749045426370       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749045427381       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749045427460       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749045427624       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 1.287758e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749043822992       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749044142510       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749044215706       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749044222573       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749044224889       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749044223867       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749044224189       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749044224228       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749044224664       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749044224916       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749044224935       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 3.225555e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749043822992       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749043902918       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749043921222       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749043922939       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749043923518       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749043923263       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749043923343       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749043923353       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749043923462       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749043923524       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749043923529       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+02 is 8.067804e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0947e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -7.015924e-01 3 1  ON 0
ci_002                -7.061619e-01 3 1  ON 1
ci_003                -5.386055e-02 3 1  ON 2
ci_004                -5.519472e-02 3 1  ON 3
ci_005                 2.042780e-02 3 1  ON 4
ci_006                 2.046737e-02 3 1  ON 5
ci_007                 1.666455e-02 3 1  ON 6
ci_008                 1.665749e-02 3 1  ON 7
ci_009                -1.281200e-02 3 1  ON 8
ci_010                -1.298992e-02 3 1  ON 9
ci_011                -1.036389e-02 3 1  ON 10
ci_012                -1.038594e-02 3 1  ON 11
ci_013                 9.310919e-03 3 1  ON 12
ci_014                 9.379323e-03 3 1  ON 13
ci_015                 9.821685e-03 3 1  ON 14
ci_016                 1.024102e-02 3 1  ON 15
ci_017                 8.746524e-03 3 1  ON 16
ci_018                 8.768837e-03 3 1  ON 17
ci_019                -3.038925e-04 3 1  ON 18
ci_020                -9.051146e-05 3 1  ON 19
ci_021                -9.662971e-03 3 1  ON 20
ci_022                -1.043510e-02 3 1  ON 21
ci_023                 5.625791e-03 3 1  ON 22
ci_024                 5.161570e-03 3 1  ON 23
ci_025                 1.254925e-02 3 1  ON 24
ci_026                 1.192526e-02 3 1  ON 25
ci_027                 6.289771e-03 3 1  ON 26
ci_028                 6.392039e-03 3 1  ON 27
ci_029                -3.891094e-03 3 1  ON 28
ci_030                -4.531275e-03 3 1  ON 29
ci_031                 3.295835e-03 3 1  ON 30
ci_032                 2.846555e-03 3 1  ON 31
ci_033                 3.623488e-03 3 1  ON 32
ci_034                 3.545751e-03 3 1  ON 33
ci_035                 2.471853e-03 3 1  ON 34
ci_036                 2.236177e-03 3 1  ON 35
ci_037                 3.478673e-03 3 1  ON 36
ci_038                 3.668820e-03 3 1  ON 37
ci_039                 4.459587e-03 3 1  ON 38
ci_040                 4.448067e-03 3 1  ON 39
ci_041                 2.764477e-03 3 1  ON 40
ci_042                 3.012910e-03 3 1  ON 41
ci_043                 3.651246e-03 3 1  ON 42
ci_044                 3.328000e-03 3 1  ON 43
ci_045                 2.482325e-03 3 1  ON 44
ci_046                 2.822761e-03 3 1  ON 45
ci_047                -1.173068e-03 3 1  ON 46
ci_048                -1.310825e-03 3 1  ON 47
ci_049                 1.159082e-03 3 1  ON 48
ci_050                 9.335187e-04 3 1  ON 49
ci_051                -1.668155e-03 3 1  ON 50
ci_052                -1.767147e-03 3 1  ON 51
ci_053                -2.593472e-03 3 1  ON 52
ci_054                -2.572461e-03 3 1  ON 53
ci_055                -1.847302e-03 3 1  ON 54
ci_056                -1.267501e-03 3 1  ON 55
ci_057                -1.293844e-03 3 1  ON 56
ci_058                -1.035099e-03 3 1  ON 57
ci_059                -4.726613e-04 3 1  ON 58
ci_060                -3.235884e-04 3 1  ON 59
ci_061                -5.968500e-04 3 1  ON 60
ci_062                -5.104102e-04 3 1  ON 61
ci_063                -7.352987e-04 3 1  ON 62
ci_064                -8.375438e-04 3 1  ON 63
ci_065                -1.795632e-03 3 1  ON 64
ci_066                -1.692480e-03 3 1  ON 65
ci_067                -1.440705e-03 3 1  ON 66
ci_068                -1.612933e-03 3 1  ON 67
ci_069                 2.131901e-04 3 1  ON 68
ci_070                 2.620632e-04 3 1  ON 69
ci_071                -1.516100e-03 3 1  ON 70
ci_072                -2.059468e-03 3 1  ON 71
ci_073                 1.526573e-04 3 1  ON 72
ci_074                 2.764394e-04 3 1  ON 73
ci_075                 6.680960e-05 3 1  ON 74
ci_076                 2.609517e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.5651
    reference variance = 0.308573
====================================================
  Execution time = 2.5362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4615e-01
  Total weights = 1.9548e+06
  Execution time = 3.6109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437673341918
                                         uncertainty =       0.002264077115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437673341918
                                         uncertainty =       0.002264077115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467809843
  error estimate for blocks of size 2^( 2) =       0.000491647279
  error estimate for blocks of size 2^( 3) =       0.000514050617
  error estimate for blocks of size 2^( 4) =       0.000529746316
  error estimate for blocks of size 2^( 5) =       0.000538657719
  error estimate for blocks of size 2^( 6) =       0.000545606896
  error estimate for blocks of size 2^( 7) =       0.000547587588

      target function =      -0.748479193186
              le_mean =     -22.661491725926
             les_mean =     513.989359032060
             stat err =       0.000540399630
             autocorr =       1.334416413000
   target nu stat err =       0.000540399630
   target dn stat err =       0.002540144115
      target stat err =       0.002182944427
              std dev =       0.661583024558
             le_variance =       0.437692098383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437669141241
                                         uncertainty =       0.002264011530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437669141241
                                         uncertainty =       0.002264011530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467807575
  error estimate for blocks of size 2^( 2) =       0.000491645337
  error estimate for blocks of size 2^( 3) =       0.000514048872
  error estimate for blocks of size 2^( 4) =       0.000529744572
  error estimate for blocks of size 2^( 5) =       0.000538655786
  error estimate for blocks of size 2^( 6) =       0.000545605118
  error estimate for blocks of size 2^( 7) =       0.000547585930

      target function =      -0.748499531554
              le_mean =     -22.661491707816
             les_mean =     513.989333621891
             stat err =       0.000540397851
             autocorr =       1.334420567858
   target nu stat err =       0.000540397851
   target dn stat err =       0.002537584934
      target stat err =       0.002181023055
              std dev =       0.661579817058
             le_variance =       0.437687854339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437671233227
                                         uncertainty =       0.002264044112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437671233227
                                         uncertainty =       0.002264044112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467808704
  error estimate for blocks of size 2^( 2) =       0.000491646304
  error estimate for blocks of size 2^( 3) =       0.000514049741
  error estimate for blocks of size 2^( 4) =       0.000529745440
  error estimate for blocks of size 2^( 5) =       0.000538656749
  error estimate for blocks of size 2^( 6) =       0.000545606004
  error estimate for blocks of size 2^( 7) =       0.000547586756

      target function =      -0.748489743432
              le_mean =     -22.661491716400
             les_mean =     513.989345844791
             stat err =       0.000540398737
             autocorr =       1.334418499305
   target nu stat err =       0.000540398737
   target dn stat err =       0.002538810039
      target stat err =       0.002181942562
              std dev =       0.661581414463
             le_variance =       0.437689967963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437673077817
                                         uncertainty =       0.002264072984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437673077817
                                         uncertainty =       0.002264072984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467809700
  error estimate for blocks of size 2^( 2) =       0.000491647157
  error estimate for blocks of size 2^( 3) =       0.000514050507
  error estimate for blocks of size 2^( 4) =       0.000529746206
  error estimate for blocks of size 2^( 5) =       0.000538657598
  error estimate for blocks of size 2^( 6) =       0.000545606784
  error estimate for blocks of size 2^( 7) =       0.000547587483

      target function =      -0.748480555336
              le_mean =     -22.661491724688
             les_mean =     513.989357329075
             stat err =       0.000540399518
             autocorr =       1.334416673989
   target nu stat err =       0.000540399518
   target dn stat err =       0.002539971256
      target stat err =       0.002182814589
              std dev =       0.661582822906
             le_variance =       0.437691831564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748479193186        initial
     1.5625e+01     1.5625e+02             1.2878e-05        -0.748499531554  <--
     6.2500e+01     6.2500e+02             3.2256e-06        -0.748489743432
     2.5000e+02     2.5000e+03             8.0678e-07        -0.748480555336

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 4.3461e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -7.015856e-01 3 1  ON 0
ci_002                -7.061704e-01 3 1  ON 1
ci_003                -5.385630e-02 3 1  ON 2
ci_004                -5.518845e-02 3 1  ON 3
ci_005                 2.042303e-02 3 1  ON 4
ci_006                 2.046220e-02 3 1  ON 5
ci_007                 1.665883e-02 3 1  ON 6
ci_008                 1.665277e-02 3 1  ON 7
ci_009                -1.280721e-02 3 1  ON 8
ci_010                -1.298863e-02 3 1  ON 9
ci_011                -1.035980e-02 3 1  ON 10
ci_012                -1.038219e-02 3 1  ON 11
ci_013                 9.307651e-03 3 1  ON 12
ci_014                 9.376207e-03 3 1  ON 13
ci_015                 9.813018e-03 3 1  ON 14
ci_016                 1.023859e-02 3 1  ON 15
ci_017                 8.742694e-03 3 1  ON 16
ci_018                 8.767150e-03 3 1  ON 17
ci_019                -3.135445e-04 3 1  ON 18
ci_020                -9.510835e-05 3 1  ON 19
ci_021                -9.670893e-03 3 1  ON 20
ci_022                -1.044283e-02 3 1  ON 21
ci_023                 5.620869e-03 3 1  ON 22
ci_024                 5.158555e-03 3 1  ON 23
ci_025                 1.254853e-02 3 1  ON 24
ci_026                 1.192774e-02 3 1  ON 25
ci_027                 6.287744e-03 3 1  ON 26
ci_028                 6.393500e-03 3 1  ON 27
ci_029                -3.889566e-03 3 1  ON 28
ci_030                -4.532577e-03 3 1  ON 29
ci_031                 3.299263e-03 3 1  ON 30
ci_032                 2.855064e-03 3 1  ON 31
ci_033                 3.624906e-03 3 1  ON 32
ci_034                 3.543170e-03 3 1  ON 33
ci_035                 2.469389e-03 3 1  ON 34
ci_036                 2.233826e-03 3 1  ON 35
ci_037                 3.477431e-03 3 1  ON 36
ci_038                 3.665379e-03 3 1  ON 37
ci_039                 4.456904e-03 3 1  ON 38
ci_040                 4.448219e-03 3 1  ON 39
ci_041                 2.762269e-03 3 1  ON 40
ci_042                 3.014880e-03 3 1  ON 41
ci_043                 3.649339e-03 3 1  ON 42
ci_044                 3.328332e-03 3 1  ON 43
ci_045                 2.486064e-03 3 1  ON 44
ci_046                 2.823110e-03 3 1  ON 45
ci_047                -1.173151e-03 3 1  ON 46
ci_048                -1.310231e-03 3 1  ON 47
ci_049                 1.157199e-03 3 1  ON 48
ci_050                 9.324969e-04 3 1  ON 49
ci_051                -1.665666e-03 3 1  ON 50
ci_052                -1.765831e-03 3 1  ON 51
ci_053                -2.593587e-03 3 1  ON 52
ci_054                -2.575546e-03 3 1  ON 53
ci_055                -1.846264e-03 3 1  ON 54
ci_056                -1.266550e-03 3 1  ON 55
ci_057                -1.294712e-03 3 1  ON 56
ci_058                -1.034909e-03 3 1  ON 57
ci_059                -4.696610e-04 3 1  ON 58
ci_060                -3.239851e-04 3 1  ON 59
ci_061                -5.963338e-04 3 1  ON 60
ci_062                -5.109064e-04 3 1  ON 61
ci_063                -7.352257e-04 3 1  ON 62
ci_064                -8.375965e-04 3 1  ON 63
ci_065                -1.794805e-03 3 1  ON 64
ci_066                -1.695049e-03 3 1  ON 65
ci_067                -1.439791e-03 3 1  ON 66
ci_068                -1.615891e-03 3 1  ON 67
ci_069                 2.112177e-04 3 1  ON 68
ci_070                 2.635007e-04 3 1  ON 69
ci_071                -1.514943e-03 3 1  ON 70
ci_072                -2.056946e-03 3 1  ON 71
ci_073                 1.540393e-04 3 1  ON 72
ci_074                 2.772332e-04 3 1  ON 73
ci_075                 6.745036e-05 3 1  ON 74
ci_076                 2.600479e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4418e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6872
    reference variance = 0.259942
====================================================
  Execution time = 2.6262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4837e-01
  Total weights = 1.955191222e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438179178877
                                         uncertainty =       0.001842128250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438179178877
                                         uncertainty =       0.001842128250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468054280
  error estimate for blocks of size 2^( 2) =       0.000491993224
  error estimate for blocks of size 2^( 3) =       0.000514030378
  error estimate for blocks of size 2^( 4) =       0.000530697093
  error estimate for blocks of size 2^( 5) =       0.000538586945
  error estimate for blocks of size 2^( 6) =       0.000540953507
  error estimate for blocks of size 2^( 7) =       0.000544593591

      target function =      -0.746663228883
              le_mean =     -22.662516220069
             les_mean =     514.038010752404
             stat err =       0.000538707784
             autocorr =       1.324689397708
   target nu stat err =       0.000538707784
   target dn stat err =       0.002563266175
      target stat err =       0.002193870094
              std dev =       0.661928710604
             le_variance =       0.438149617922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266251622007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746668741144       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746673813286       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746674584273       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746674611592       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746674602590       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746674606717       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746674602006       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746674600754       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746674599867       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 6.189927e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746668741144       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746670020550       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746670214078       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746670220849       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746670218585       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746670219621       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746670218442       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746670218135       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746670217916       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 1.558618e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746668741144       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746669061714       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746669110145       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746669111834       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746669111267       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746669111526       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746669111232       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746669111155       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746669111101       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 3.903569e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166441 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1001e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -7.015873e-01 3 1  ON 0
ci_002                -7.061698e-01 3 1  ON 1
ci_003                -5.385318e-02 3 1  ON 2
ci_004                -5.518511e-02 3 1  ON 3
ci_005                 2.041605e-02 3 1  ON 4
ci_006                 2.045842e-02 3 1  ON 5
ci_007                 1.665265e-02 3 1  ON 6
ci_008                 1.664522e-02 3 1  ON 7
ci_009                -1.280495e-02 3 1  ON 8
ci_010                -1.298783e-02 3 1  ON 9
ci_011                -1.035786e-02 3 1  ON 10
ci_012                -1.038015e-02 3 1  ON 11
ci_013                 9.297294e-03 3 1  ON 12
ci_014                 9.367042e-03 3 1  ON 13
ci_015                 9.809360e-03 3 1  ON 14
ci_016                 1.023706e-02 3 1  ON 15
ci_017                 8.742064e-03 3 1  ON 16
ci_018                 8.768237e-03 3 1  ON 17
ci_019                -3.291307e-04 3 1  ON 18
ci_020                -1.049988e-04 3 1  ON 19
ci_021                -9.676156e-03 3 1  ON 20
ci_022                -1.045056e-02 3 1  ON 21
ci_023                 5.615306e-03 3 1  ON 22
ci_024                 5.152427e-03 3 1  ON 23
ci_025                 1.255997e-02 3 1  ON 24
ci_026                 1.193273e-02 3 1  ON 25
ci_027                 6.287027e-03 3 1  ON 26
ci_028                 6.395385e-03 3 1  ON 27
ci_029                -3.893198e-03 3 1  ON 28
ci_030                -4.529523e-03 3 1  ON 29
ci_031                 3.309210e-03 3 1  ON 30
ci_032                 2.861002e-03 3 1  ON 31
ci_033                 3.624314e-03 3 1  ON 32
ci_034                 3.539804e-03 3 1  ON 33
ci_035                 2.469010e-03 3 1  ON 34
ci_036                 2.232795e-03 3 1  ON 35
ci_037                 3.474842e-03 3 1  ON 36
ci_038                 3.669268e-03 3 1  ON 37
ci_039                 4.455883e-03 3 1  ON 38
ci_040                 4.449578e-03 3 1  ON 39
ci_041                 2.763718e-03 3 1  ON 40
ci_042                 3.011772e-03 3 1  ON 41
ci_043                 3.647636e-03 3 1  ON 42
ci_044                 3.328767e-03 3 1  ON 43
ci_045                 2.485391e-03 3 1  ON 44
ci_046                 2.823313e-03 3 1  ON 45
ci_047                -1.172102e-03 3 1  ON 46
ci_048                -1.309013e-03 3 1  ON 47
ci_049                 1.155483e-03 3 1  ON 48
ci_050                 9.317977e-04 3 1  ON 49
ci_051                -1.663158e-03 3 1  ON 50
ci_052                -1.757114e-03 3 1  ON 51
ci_053                -2.592230e-03 3 1  ON 52
ci_054                -2.573687e-03 3 1  ON 53
ci_055                -1.843348e-03 3 1  ON 54
ci_056                -1.265839e-03 3 1  ON 55
ci_057                -1.292915e-03 3 1  ON 56
ci_058                -1.036427e-03 3 1  ON 57
ci_059                -4.723096e-04 3 1  ON 58
ci_060                -3.256380e-04 3 1  ON 59
ci_061                -5.970672e-04 3 1  ON 60
ci_062                -5.102078e-04 3 1  ON 61
ci_063                -7.369809e-04 3 1  ON 62
ci_064                -8.360978e-04 3 1  ON 63
ci_065                -1.795070e-03 3 1  ON 64
ci_066                -1.697516e-03 3 1  ON 65
ci_067                -1.439679e-03 3 1  ON 66
ci_068                -1.620050e-03 3 1  ON 67
ci_069                 2.113526e-04 3 1  ON 68
ci_070                 2.611245e-04 3 1  ON 69
ci_071                -1.517172e-03 3 1  ON 70
ci_072                -2.058385e-03 3 1  ON 71
ci_073                 1.529007e-04 3 1  ON 72
ci_074                 2.758387e-04 3 1  ON 73
ci_075                 7.109008e-05 3 1  ON 74
ci_076                 2.593742e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6093
    reference variance = 0.262192
====================================================
  Execution time = 2.7229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4814e-01
  Total weights = 1.9550e+06
  Execution time = 3.6282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438774200895
                                         uncertainty =       0.001870327878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438774200895
                                         uncertainty =       0.001870327878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468370409
  error estimate for blocks of size 2^( 2) =       0.000492688852
  error estimate for blocks of size 2^( 3) =       0.000515344468
  error estimate for blocks of size 2^( 4) =       0.000532166661
  error estimate for blocks of size 2^( 5) =       0.000541619705
  error estimate for blocks of size 2^( 6) =       0.000546833102
  error estimate for blocks of size 2^( 7) =       0.000549977739

      target function =      -0.746836097626
              le_mean =     -22.661595962016
             les_mean =     513.996076483746
             stat err =       0.000542649302
             autocorr =       1.342330934347
   target nu stat err =       0.000542649302
   target dn stat err =       0.002657248320
      target stat err =       0.002267575790
              std dev =       0.662375784607
             le_variance =       0.438741680033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438767935870
                                         uncertainty =       0.001870700092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438767935870
                                         uncertainty =       0.001870700092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468367068
  error estimate for blocks of size 2^( 2) =       0.000492686454
  error estimate for blocks of size 2^( 3) =       0.000515342464
  error estimate for blocks of size 2^( 4) =       0.000532164954
  error estimate for blocks of size 2^( 5) =       0.000541616630
  error estimate for blocks of size 2^( 6) =       0.000546831051
  error estimate for blocks of size 2^( 7) =       0.000549975750

      target function =      -0.746810394112
              le_mean =     -22.661596663298
             les_mean =     513.996139434795
             stat err =       0.000542647096
             autocorr =       1.342339176248
   target nu stat err =       0.000542647096
   target dn stat err =       0.002669603057
      target stat err =       0.002277237439
              std dev =       0.662371059321
             le_variance =       0.438735420227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438770984205
                                         uncertainty =       0.001870514669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438770984205
                                         uncertainty =       0.001870514669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468368693
  error estimate for blocks of size 2^( 2) =       0.000492687611
  error estimate for blocks of size 2^( 3) =       0.000515343425
  error estimate for blocks of size 2^( 4) =       0.000532165766
  error estimate for blocks of size 2^( 5) =       0.000541618124
  error estimate for blocks of size 2^( 6) =       0.000546832035
  error estimate for blocks of size 2^( 7) =       0.000549976704

      target function =      -0.746834061591
              le_mean =     -22.661596309074
             les_mean =     513.996094657540
             stat err =       0.000542648157
             autocorr =       1.342335104734
   target nu stat err =       0.000542648157
   target dn stat err =       0.002663252262
      target stat err =       0.002272332184
              std dev =       0.662373358499
             le_variance =       0.438738466049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438773791468
                                         uncertainty =       0.001870351161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438773791468
                                         uncertainty =       0.001870351161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468370191
  error estimate for blocks of size 2^( 2) =       0.000492688693
  error estimate for blocks of size 2^( 3) =       0.000515344334
  error estimate for blocks of size 2^( 4) =       0.000532166544
  error estimate for blocks of size 2^( 5) =       0.000541619503
  error estimate for blocks of size 2^( 6) =       0.000546832964
  error estimate for blocks of size 2^( 7) =       0.000549977605

      target function =      -0.746837064746
              le_mean =     -22.661596004632
             les_mean =     513.996077236774
             stat err =       0.000542649154
             autocorr =       1.342331456152
   target nu stat err =       0.000542649154
   target dn stat err =       0.002657976211
      target stat err =       0.002268159513
              std dev =       0.662375475809
             le_variance =       0.438741270953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746836097626        initial
     3.9062e+00     3.9062e+01             6.1899e-05        -0.746810394112
     1.5625e+01     1.5625e+02             1.5586e-05        -0.746834061591
     6.2500e+01     6.2500e+02             3.9036e-06        -0.746837064746  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 4.5362e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -7.015860e-01 3 1  ON 0
ci_002                -7.061702e-01 3 1  ON 1
ci_003                -5.385552e-02 3 1  ON 2
ci_004                -5.518762e-02 3 1  ON 3
ci_005                 2.042128e-02 3 1  ON 4
ci_006                 2.046125e-02 3 1  ON 5
ci_007                 1.665728e-02 3 1  ON 6
ci_008                 1.665088e-02 3 1  ON 7
ci_009                -1.280664e-02 3 1  ON 8
ci_010                -1.298843e-02 3 1  ON 9
ci_011                -1.035931e-02 3 1  ON 10
ci_012                -1.038168e-02 3 1  ON 11
ci_013                 9.305056e-03 3 1  ON 12
ci_014                 9.373911e-03 3 1  ON 13
ci_015                 9.812102e-03 3 1  ON 14
ci_016                 1.023821e-02 3 1  ON 15
ci_017                 8.742537e-03 3 1  ON 16
ci_018                 8.767422e-03 3 1  ON 17
ci_019                -3.174481e-04 3 1  ON 18
ci_020                -9.758561e-05 3 1  ON 19
ci_021                -9.672211e-03 3 1  ON 20
ci_022                -1.044476e-02 3 1  ON 21
ci_023                 5.619475e-03 3 1  ON 22
ci_024                 5.157020e-03 3 1  ON 23
ci_025                 1.255140e-02 3 1  ON 24
ci_026                 1.192899e-02 3 1  ON 25
ci_027                 6.287564e-03 3 1  ON 26
ci_028                 6.393973e-03 3 1  ON 27
ci_029                -3.890476e-03 3 1  ON 28
ci_030                -4.531812e-03 3 1  ON 29
ci_031                 3.301754e-03 3 1  ON 30
ci_032                 2.856551e-03 3 1  ON 31
ci_033                 3.624758e-03 3 1  ON 32
ci_034                 3.542327e-03 3 1  ON 33
ci_035                 2.469294e-03 3 1  ON 34
ci_036                 2.233568e-03 3 1  ON 35
ci_037                 3.476783e-03 3 1  ON 36
ci_038                 3.666353e-03 3 1  ON 37
ci_039                 4.456648e-03 3 1  ON 38
ci_040                 4.448559e-03 3 1  ON 39
ci_041                 2.762632e-03 3 1  ON 40
ci_042                 3.014101e-03 3 1  ON 41
ci_043                 3.648913e-03 3 1  ON 42
ci_044                 3.328441e-03 3 1  ON 43
ci_045                 2.485895e-03 3 1  ON 44
ci_046                 2.823161e-03 3 1  ON 45
ci_047                -1.172888e-03 3 1  ON 46
ci_048                -1.309925e-03 3 1  ON 47
ci_049                 1.156769e-03 3 1  ON 48
ci_050                 9.323217e-04 3 1  ON 49
ci_051                -1.665038e-03 3 1  ON 50
ci_052                -1.763648e-03 3 1  ON 51
ci_053                -2.593247e-03 3 1  ON 52
ci_054                -2.575080e-03 3 1  ON 53
ci_055                -1.845533e-03 3 1  ON 54
ci_056                -1.266372e-03 3 1  ON 55
ci_057                -1.294262e-03 3 1  ON 56
ci_058                -1.035289e-03 3 1  ON 57
ci_059                -4.703249e-04 3 1  ON 58
ci_060                -3.243995e-04 3 1  ON 59
ci_061                -5.965176e-04 3 1  ON 60
ci_062                -5.107313e-04 3 1  ON 61
ci_063                -7.356651e-04 3 1  ON 62
ci_064                -8.372210e-04 3 1  ON 63
ci_065                -1.794871e-03 3 1  ON 64
ci_066                -1.695667e-03 3 1  ON 65
ci_067                -1.439763e-03 3 1  ON 66
ci_068                -1.616933e-03 3 1  ON 67
ci_069                 2.112516e-04 3 1  ON 68
ci_070                 2.629053e-04 3 1  ON 69
ci_071                -1.515501e-03 3 1  ON 70
ci_072                -2.057307e-03 3 1  ON 71
ci_073                 1.537539e-04 3 1  ON 72
ci_074                 2.768837e-04 3 1  ON 73
ci_075                 6.836218e-05 3 1  ON 74
ci_076                 2.598791e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6369e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.5128
    reference variance = 0.969926
====================================================
  Execution time = 2.6242e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4914e-01
  Total weights = 1.955152674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441116779382
                                         uncertainty =       0.002658737121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441116779382
                                         uncertainty =       0.002658737121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469620142
  error estimate for blocks of size 2^( 2) =       0.000493858231
  error estimate for blocks of size 2^( 3) =       0.000515644697
  error estimate for blocks of size 2^( 4) =       0.000531743247
  error estimate for blocks of size 2^( 5) =       0.000541997193
  error estimate for blocks of size 2^( 6) =       0.000546395742
  error estimate for blocks of size 2^( 7) =       0.000551114545

      target function =      -0.746026891877
              le_mean =     -22.662207549377
             les_mean =     514.024786654724
             stat err =       0.000542812682
             autocorr =       1.336000252403
   target nu stat err =       0.000542812682
   target dn stat err =       0.003005768784
      target stat err =       0.002542404098
              std dev =       0.664143173895
             le_variance =       0.441086155432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266220754938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746034552341       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746036991406       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746037383530       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746037418584       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746037432232       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746037437354       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746037441263       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746037440145       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746037441705       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746037440660       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746037441236       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746037441350       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 1.726851e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746034552341       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746035163484       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746035261617       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746035270383       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746035273795       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746035275073       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746035276047       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746035275766       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746035276156       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746035275895       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746035276039       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746035276067       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 4.325095e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746034552341       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746034705213       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746034729753       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746034731944       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746034732797       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746034733117       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746034733360       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746034733290       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746034733387       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746034733322       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746034733357       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746034733365       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+02 is 1.081773e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1010e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -7.015838e-01 3 1  ON 0
ci_002                -7.061730e-01 3 1  ON 1
ci_003                -5.385451e-02 3 1  ON 2
ci_004                -5.518582e-02 3 1  ON 3
ci_005                 2.041836e-02 3 1  ON 4
ci_006                 2.045950e-02 3 1  ON 5
ci_007                 1.665736e-02 3 1  ON 6
ci_008                 1.664816e-02 3 1  ON 7
ci_009                -1.280462e-02 3 1  ON 8
ci_010                -1.298874e-02 3 1  ON 9
ci_011                -1.035757e-02 3 1  ON 10
ci_012                -1.038087e-02 3 1  ON 11
ci_013                 9.303210e-03 3 1  ON 12
ci_014                 9.371505e-03 3 1  ON 13
ci_015                 9.811873e-03 3 1  ON 14
ci_016                 1.023488e-02 3 1  ON 15
ci_017                 8.742594e-03 3 1  ON 16
ci_018                 8.766666e-03 3 1  ON 17
ci_019                -3.213338e-04 3 1  ON 18
ci_020                -1.019107e-04 3 1  ON 19
ci_021                -9.675796e-03 3 1  ON 20
ci_022                -1.044485e-02 3 1  ON 21
ci_023                 5.618940e-03 3 1  ON 22
ci_024                 5.157103e-03 3 1  ON 23
ci_025                 1.255241e-02 3 1  ON 24
ci_026                 1.193043e-02 3 1  ON 25
ci_027                 6.287013e-03 3 1  ON 26
ci_028                 6.394086e-03 3 1  ON 27
ci_029                -3.891206e-03 3 1  ON 28
ci_030                -4.530142e-03 3 1  ON 29
ci_031                 3.304671e-03 3 1  ON 30
ci_032                 2.857926e-03 3 1  ON 31
ci_033                 3.622870e-03 3 1  ON 32
ci_034                 3.539728e-03 3 1  ON 33
ci_035                 2.468886e-03 3 1  ON 34
ci_036                 2.234039e-03 3 1  ON 35
ci_037                 3.476239e-03 3 1  ON 36
ci_038                 3.665734e-03 3 1  ON 37
ci_039                 4.457606e-03 3 1  ON 38
ci_040                 4.447782e-03 3 1  ON 39
ci_041                 2.762495e-03 3 1  ON 40
ci_042                 3.013742e-03 3 1  ON 41
ci_043                 3.647813e-03 3 1  ON 42
ci_044                 3.328133e-03 3 1  ON 43
ci_045                 2.486772e-03 3 1  ON 44
ci_046                 2.824593e-03 3 1  ON 45
ci_047                -1.172766e-03 3 1  ON 46
ci_048                -1.309624e-03 3 1  ON 47
ci_049                 1.154718e-03 3 1  ON 48
ci_050                 9.338776e-04 3 1  ON 49
ci_051                -1.665905e-03 3 1  ON 50
ci_052                -1.763071e-03 3 1  ON 51
ci_053                -2.592554e-03 3 1  ON 52
ci_054                -2.575175e-03 3 1  ON 53
ci_055                -1.844980e-03 3 1  ON 54
ci_056                -1.265966e-03 3 1  ON 55
ci_057                -1.294205e-03 3 1  ON 56
ci_058                -1.035601e-03 3 1  ON 57
ci_059                -4.711452e-04 3 1  ON 58
ci_060                -3.249733e-04 3 1  ON 59
ci_061                -5.957757e-04 3 1  ON 60
ci_062                -5.101934e-04 3 1  ON 61
ci_063                -7.361743e-04 3 1  ON 62
ci_064                -8.368827e-04 3 1  ON 63
ci_065                -1.791776e-03 3 1  ON 64
ci_066                -1.696585e-03 3 1  ON 65
ci_067                -1.440351e-03 3 1  ON 66
ci_068                -1.616995e-03 3 1  ON 67
ci_069                 2.104608e-04 3 1  ON 68
ci_070                 2.630635e-04 3 1  ON 69
ci_071                -1.515064e-03 3 1  ON 70
ci_072                -2.057877e-03 3 1  ON 71
ci_073                 1.533773e-04 3 1  ON 72
ci_074                 2.771512e-04 3 1  ON 73
ci_075                 6.910645e-05 3 1  ON 74
ci_076                 2.609471e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6124
    reference variance = 0.260085
====================================================
  Execution time = 2.5839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4674e-01
  Total weights = 1.9547e+06
  Execution time = 3.6220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438406308735
                                         uncertainty =       0.001886554701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438406308735
                                         uncertainty =       0.001886554701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468253363
  error estimate for blocks of size 2^( 2) =       0.000492307208
  error estimate for blocks of size 2^( 3) =       0.000514782018
  error estimate for blocks of size 2^( 4) =       0.000530935924
  error estimate for blocks of size 2^( 5) =       0.000540519612
  error estimate for blocks of size 2^( 6) =       0.000544491593
  error estimate for blocks of size 2^( 7) =       0.000546525558

      target function =      -0.747970971702
              le_mean =     -22.660969030997
             les_mean =     513.966275839303
             stat err =       0.000540618172
             autocorr =       1.332967220219
   target nu stat err =       0.000540618172
   target dn stat err =       0.002292857682
      target stat err =       0.001983067562
              std dev =       0.662210255953
             le_variance =       0.438522423089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438399882836
                                         uncertainty =       0.001886305562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438399882836
                                         uncertainty =       0.001886305562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468249942
  error estimate for blocks of size 2^( 2) =       0.000492304343
  error estimate for blocks of size 2^( 3) =       0.000514779474
  error estimate for blocks of size 2^( 4) =       0.000530933448
  error estimate for blocks of size 2^( 5) =       0.000540517010
  error estimate for blocks of size 2^( 6) =       0.000544488780
  error estimate for blocks of size 2^( 7) =       0.000546522461

      target function =      -0.747992685844
              le_mean =     -22.660969150822
             les_mean =     513.966254949844
             stat err =       0.000540615425
             autocorr =       1.332973147512
   target nu stat err =       0.000540615425
   target dn stat err =       0.002292614579
      target stat err =       0.001982985674
              std dev =       0.662205418741
             le_variance =       0.438516016610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438403081977
                                         uncertainty =       0.001886429468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438403081977
                                         uncertainty =       0.001886429468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468251645
  error estimate for blocks of size 2^( 2) =       0.000492305769
  error estimate for blocks of size 2^( 3) =       0.000514780739
  error estimate for blocks of size 2^( 4) =       0.000530934680
  error estimate for blocks of size 2^( 5) =       0.000540518305
  error estimate for blocks of size 2^( 6) =       0.000544490181
  error estimate for blocks of size 2^( 7) =       0.000546524001

      target function =      -0.747990447225
              le_mean =     -22.660969090782
             les_mean =     513.966254941319
             stat err =       0.000540616792
             autocorr =       1.332970192918
   target nu stat err =       0.000540616792
   target dn stat err =       0.002292616861
      target stat err =       0.001982976414
              std dev =       0.662207826945
             le_variance =       0.438519206068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438405904359
                                         uncertainty =       0.001886538991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438405904359
                                         uncertainty =       0.001886538991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468253147
  error estimate for blocks of size 2^( 2) =       0.000492307028
  error estimate for blocks of size 2^( 3) =       0.000514781858
  error estimate for blocks of size 2^( 4) =       0.000530935768
  error estimate for blocks of size 2^( 5) =       0.000540519448
  error estimate for blocks of size 2^( 6) =       0.000544491416
  error estimate for blocks of size 2^( 7) =       0.000546525362

      target function =      -0.747976256297
              le_mean =     -22.660969038477
             les_mean =     513.966269772353
             stat err =       0.000540617999
             autocorr =       1.332967591844
   target nu stat err =       0.000540617999
   target dn stat err =       0.002292772122
      target stat err =       0.001983026969
              std dev =       0.662209951550
             le_variance =       0.438522019932


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747970971702        initial
     1.5625e+01     1.5625e+02             1.7269e-05        -0.747992685844  <--
     6.2500e+01     6.2500e+02             4.3251e-06        -0.747990447225
     2.5000e+02     2.5000e+03             1.0818e-06        -0.747976256297

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 4.3929e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -7.015769e-01 3 1  ON 0
ci_002                -7.061814e-01 3 1  ON 1
ci_003                -5.385148e-02 3 1  ON 2
ci_004                -5.518044e-02 3 1  ON 3
ci_005                 2.040962e-02 3 1  ON 4
ci_006                 2.045425e-02 3 1  ON 5
ci_007                 1.665760e-02 3 1  ON 6
ci_008                 1.664001e-02 3 1  ON 7
ci_009                -1.279857e-02 3 1  ON 8
ci_010                -1.298967e-02 3 1  ON 9
ci_011                -1.035237e-02 3 1  ON 10
ci_012                -1.037844e-02 3 1  ON 11
ci_013                 9.297684e-03 3 1  ON 12
ci_014                 9.364307e-03 3 1  ON 13
ci_015                 9.811188e-03 3 1  ON 14
ci_016                 1.022491e-02 3 1  ON 15
ci_017                 8.742769e-03 3 1  ON 16
ci_018                 8.764403e-03 3 1  ON 17
ci_019                -3.329607e-04 3 1  ON 18
ci_020                -1.148541e-04 3 1  ON 19
ci_021                -9.686525e-03 3 1  ON 20
ci_022                -1.044510e-02 3 1  ON 21
ci_023                 5.617340e-03 3 1  ON 22
ci_024                 5.157354e-03 3 1  ON 23
ci_025                 1.255544e-02 3 1  ON 24
ci_026                 1.193475e-02 3 1  ON 25
ci_027                 6.285364e-03 3 1  ON 26
ci_028                 6.394425e-03 3 1  ON 27
ci_029                -3.893390e-03 3 1  ON 28
ci_030                -4.525145e-03 3 1  ON 29
ci_031                 3.313399e-03 3 1  ON 30
ci_032                 2.862039e-03 3 1  ON 31
ci_033                 3.617222e-03 3 1  ON 32
ci_034                 3.531954e-03 3 1  ON 33
ci_035                 2.467666e-03 3 1  ON 34
ci_036                 2.235447e-03 3 1  ON 35
ci_037                 3.474611e-03 3 1  ON 36
ci_038                 3.663881e-03 3 1  ON 37
ci_039                 4.460471e-03 3 1  ON 38
ci_040                 4.445459e-03 3 1  ON 39
ci_041                 2.762087e-03 3 1  ON 40
ci_042                 3.012668e-03 3 1  ON 41
ci_043                 3.644524e-03 3 1  ON 42
ci_044                 3.327209e-03 3 1  ON 43
ci_045                 2.489397e-03 3 1  ON 44
ci_046                 2.828877e-03 3 1  ON 45
ci_047                -1.172399e-03 3 1  ON 46
ci_048                -1.308723e-03 3 1  ON 47
ci_049                 1.148581e-03 3 1  ON 48
ci_050                 9.385313e-04 3 1  ON 49
ci_051                -1.668499e-03 3 1  ON 50
ci_052                -1.761343e-03 3 1  ON 51
ci_053                -2.590482e-03 3 1  ON 52
ci_054                -2.575461e-03 3 1  ON 53
ci_055                -1.843324e-03 3 1  ON 54
ci_056                -1.264751e-03 3 1  ON 55
ci_057                -1.294033e-03 3 1  ON 56
ci_058                -1.036534e-03 3 1  ON 57
ci_059                -4.735971e-04 3 1  ON 58
ci_060                -3.266885e-04 3 1  ON 59
ci_061                -5.935566e-04 3 1  ON 60
ci_062                -5.085843e-04 3 1  ON 61
ci_063                -7.376984e-04 3 1  ON 62
ci_064                -8.358717e-04 3 1  ON 63
ci_065                -1.782516e-03 3 1  ON 64
ci_066                -1.699332e-03 3 1  ON 65
ci_067                -1.442111e-03 3 1  ON 66
ci_068                -1.617180e-03 3 1  ON 67
ci_069                 2.080949e-04 3 1  ON 68
ci_070                 2.635365e-04 3 1  ON 69
ci_071                -1.513757e-03 3 1  ON 70
ci_072                -2.059583e-03 3 1  ON 71
ci_073                 1.522508e-04 3 1  ON 72
ci_074                 2.779510e-04 3 1  ON 73
ci_075                 7.133255e-05 3 1  ON 74
ci_076                 2.641421e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4945e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2650e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.6604
    reference variance = 0.280532
====================================================
  Execution time = 2.6117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5306e-01
  Total weights = 1.954992799e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441768158812
                                         uncertainty =       0.003039035082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441768158812
                                         uncertainty =       0.003039035082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469973074
  error estimate for blocks of size 2^( 2) =       0.000494275789
  error estimate for blocks of size 2^( 3) =       0.000515865403
  error estimate for blocks of size 2^( 4) =       0.000531219961
  error estimate for blocks of size 2^( 5) =       0.000540120182
  error estimate for blocks of size 2^( 6) =       0.000544266096
  error estimate for blocks of size 2^( 7) =       0.000544402663

      target function =      -0.742794707354
              le_mean =     -22.661436056748
             les_mean =     513.993739811592
             stat err =       0.000540002226
             autocorr =       1.320216471489
   target nu stat err =       0.000540002226
   target dn stat err =       0.005391331692
      target stat err =       0.004428707728
              std dev =       0.664642294617
             le_variance =       0.441749379794


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266143605675e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742820363272       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742828907392       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742830122735       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742830304220       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742830368604       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742830389353       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742830405809       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742830404307       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742830414492       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742830415052       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742830411926       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742830411283       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 6.108827e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742820363272       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742822519189       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742822824533       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742822869958       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742822886003       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742822891071       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742822895113       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742822894728       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742822897252       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742822897371       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742822896601       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742822896443       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 1.527727e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742820363272       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742820903509       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742820979939       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742820991299       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742820995306       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742820996566       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742820997572       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742820997475       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742820998105       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742820998133       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742820997941       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742820997902       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 3.819646e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176062 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0910e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -7.015640e-01 3 1  ON 0
ci_002                -7.061967e-01 3 1  ON 1
ci_003                -5.384063e-02 3 1  ON 2
ci_004                -5.517903e-02 3 1  ON 3
ci_005                 2.040245e-02 3 1  ON 4
ci_006                 2.044516e-02 3 1  ON 5
ci_007                 1.664689e-02 3 1  ON 6
ci_008                 1.663600e-02 3 1  ON 7
ci_009                -1.279616e-02 3 1  ON 8
ci_010                -1.298281e-02 3 1  ON 9
ci_011                -1.035187e-02 3 1  ON 10
ci_012                -1.037202e-02 3 1  ON 11
ci_013                 9.287886e-03 3 1  ON 12
ci_014                 9.362812e-03 3 1  ON 13
ci_015                 9.802634e-03 3 1  ON 14
ci_016                 1.021629e-02 3 1  ON 15
ci_017                 8.740029e-03 3 1  ON 16
ci_018                 8.756516e-03 3 1  ON 17
ci_019                -3.476068e-04 3 1  ON 18
ci_020                -1.200355e-04 3 1  ON 19
ci_021                -9.694538e-03 3 1  ON 20
ci_022                -1.045090e-02 3 1  ON 21
ci_023                 5.611545e-03 3 1  ON 22
ci_024                 5.148410e-03 3 1  ON 23
ci_025                 1.256041e-02 3 1  ON 24
ci_026                 1.193975e-02 3 1  ON 25
ci_027                 6.289758e-03 3 1  ON 26
ci_028                 6.395368e-03 3 1  ON 27
ci_029                -3.891742e-03 3 1  ON 28
ci_030                -4.524405e-03 3 1  ON 29
ci_031                 3.308592e-03 3 1  ON 30
ci_032                 2.866716e-03 3 1  ON 31
ci_033                 3.616625e-03 3 1  ON 32
ci_034                 3.529015e-03 3 1  ON 33
ci_035                 2.465246e-03 3 1  ON 34
ci_036                 2.232760e-03 3 1  ON 35
ci_037                 3.470549e-03 3 1  ON 36
ci_038                 3.661815e-03 3 1  ON 37
ci_039                 4.458864e-03 3 1  ON 38
ci_040                 4.446172e-03 3 1  ON 39
ci_041                 2.764231e-03 3 1  ON 40
ci_042                 3.014932e-03 3 1  ON 41
ci_043                 3.638602e-03 3 1  ON 42
ci_044                 3.323130e-03 3 1  ON 43
ci_045                 2.488685e-03 3 1  ON 44
ci_046                 2.829394e-03 3 1  ON 45
ci_047                -1.171655e-03 3 1  ON 46
ci_048                -1.308341e-03 3 1  ON 47
ci_049                 1.144719e-03 3 1  ON 48
ci_050                 9.306199e-04 3 1  ON 49
ci_051                -1.665151e-03 3 1  ON 50
ci_052                -1.758717e-03 3 1  ON 51
ci_053                -2.597271e-03 3 1  ON 52
ci_054                -2.574397e-03 3 1  ON 53
ci_055                -1.832282e-03 3 1  ON 54
ci_056                -1.267940e-03 3 1  ON 55
ci_057                -1.294266e-03 3 1  ON 56
ci_058                -1.038150e-03 3 1  ON 57
ci_059                -4.760160e-04 3 1  ON 58
ci_060                -3.293860e-04 3 1  ON 59
ci_061                -5.939645e-04 3 1  ON 60
ci_062                -5.090866e-04 3 1  ON 61
ci_063                -7.399090e-04 3 1  ON 62
ci_064                -8.297464e-04 3 1  ON 63
ci_065                -1.785323e-03 3 1  ON 64
ci_066                -1.699408e-03 3 1  ON 65
ci_067                -1.440158e-03 3 1  ON 66
ci_068                -1.613510e-03 3 1  ON 67
ci_069                 2.064405e-04 3 1  ON 68
ci_070                 2.649731e-04 3 1  ON 69
ci_071                -1.512414e-03 3 1  ON 70
ci_072                -2.061281e-03 3 1  ON 71
ci_073                 1.532199e-04 3 1  ON 72
ci_074                 2.789120e-04 3 1  ON 73
ci_075                 7.375112e-05 3 1  ON 74
ci_076                 2.706352e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.6447
    reference variance = 0.256748
====================================================
  Execution time = 2.5528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5265e-01
  Total weights = 1.9553e+06
  Execution time = 3.6357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444191547561
                                         uncertainty =       0.003337899782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444191547561
                                         uncertainty =       0.003337899782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471291432
  error estimate for blocks of size 2^( 2) =       0.000495222907
  error estimate for blocks of size 2^( 3) =       0.000516989175
  error estimate for blocks of size 2^( 4) =       0.000532709776
  error estimate for blocks of size 2^( 5) =       0.000542168623
  error estimate for blocks of size 2^( 6) =       0.000548990962
  error estimate for blocks of size 2^( 7) =       0.000551141082

      target function =      -0.743160939724
              le_mean =     -22.661318361969
             les_mean =     513.987969455527
             stat err =       0.000543752611
             autocorr =       1.331139657194
   target nu stat err =       0.000543752611
   target dn stat err =       0.003996807102
      target stat err =       0.003310434007
              std dev =       0.666506734661
             le_variance =       0.444231227349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444276467736
                                         uncertainty =       0.003409959980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444276467736
                                         uncertainty =       0.003409959980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471336381
  error estimate for blocks of size 2^( 2) =       0.000495267058
  error estimate for blocks of size 2^( 3) =       0.000517032423
  error estimate for blocks of size 2^( 4) =       0.000532755312
  error estimate for blocks of size 2^( 5) =       0.000542215675
  error estimate for blocks of size 2^( 6) =       0.000549038756
  error estimate for blocks of size 2^( 7) =       0.000551191726

      target function =      -0.743008779342
              le_mean =     -22.661318058218
             les_mean =     513.988141805171
             stat err =       0.000543800367
             autocorr =       1.331119566836
   target nu stat err =       0.000543800367
   target dn stat err =       0.004075682344
      target stat err =       0.003372315883
              std dev =       0.666570302370
             le_variance =       0.444315968002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444233257793
                                         uncertainty =       0.003373299643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444233257793
                                         uncertainty =       0.003373299643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471313510
  error estimate for blocks of size 2^( 2) =       0.000495244600
  error estimate for blocks of size 2^( 3) =       0.000517010434
  error estimate for blocks of size 2^( 4) =       0.000532732190
  error estimate for blocks of size 2^( 5) =       0.000542191786
  error estimate for blocks of size 2^( 6) =       0.000549014504
  error estimate for blocks of size 2^( 7) =       0.000551166054

      target function =      -0.743103020292
              le_mean =     -22.661318204335
             les_mean =     513.988033074303
             stat err =       0.000543776133
             autocorr =       1.331130109376
   target nu stat err =       0.000543776133
   target dn stat err =       0.004035285559
      target stat err =       0.003340768404
              std dev =       0.666537957762
             le_variance =       0.444272849137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444196685983
                                         uncertainty =       0.003342259589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444196685983
                                         uncertainty =       0.003342259589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471294152
  error estimate for blocks of size 2^( 2) =       0.000495225581
  error estimate for blocks of size 2^( 3) =       0.000516991796
  error estimate for blocks of size 2^( 4) =       0.000532712541
  error estimate for blocks of size 2^( 5) =       0.000542171481
  error estimate for blocks of size 2^( 6) =       0.000548993868
  error estimate for blocks of size 2^( 7) =       0.000551144167

      target function =      -0.743154544590
              le_mean =     -22.661318341565
             les_mean =     513.987976339414
             stat err =       0.000543755514
             autocorr =       1.331138508275
   target nu stat err =       0.000543755514
   target dn stat err =       0.004001541618
      target stat err =       0.003314172882
              std dev =       0.666510581199
             le_variance =       0.444236354850


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743160939724        initial  <--
     3.9062e+00     3.9062e+01             6.1088e-05        -0.743008779342
     1.5625e+01     1.5625e+02             1.5277e-05        -0.743103020292
     6.2500e+01     6.2500e+02             3.8196e-06        -0.743154544590

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7012
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -7.015769e-01 3 1  ON 0
ci_002                -7.061814e-01 3 1  ON 1
ci_003                -5.385148e-02 3 1  ON 2
ci_004                -5.518044e-02 3 1  ON 3
ci_005                 2.040962e-02 3 1  ON 4
ci_006                 2.045425e-02 3 1  ON 5
ci_007                 1.665760e-02 3 1  ON 6
ci_008                 1.664001e-02 3 1  ON 7
ci_009                -1.279857e-02 3 1  ON 8
ci_010                -1.298967e-02 3 1  ON 9
ci_011                -1.035237e-02 3 1  ON 10
ci_012                -1.037844e-02 3 1  ON 11
ci_013                 9.297684e-03 3 1  ON 12
ci_014                 9.364307e-03 3 1  ON 13
ci_015                 9.811188e-03 3 1  ON 14
ci_016                 1.022491e-02 3 1  ON 15
ci_017                 8.742769e-03 3 1  ON 16
ci_018                 8.764403e-03 3 1  ON 17
ci_019                -3.329607e-04 3 1  ON 18
ci_020                -1.148541e-04 3 1  ON 19
ci_021                -9.686525e-03 3 1  ON 20
ci_022                -1.044510e-02 3 1  ON 21
ci_023                 5.617340e-03 3 1  ON 22
ci_024                 5.157354e-03 3 1  ON 23
ci_025                 1.255544e-02 3 1  ON 24
ci_026                 1.193475e-02 3 1  ON 25
ci_027                 6.285364e-03 3 1  ON 26
ci_028                 6.394425e-03 3 1  ON 27
ci_029                -3.893390e-03 3 1  ON 28
ci_030                -4.525145e-03 3 1  ON 29
ci_031                 3.313399e-03 3 1  ON 30
ci_032                 2.862039e-03 3 1  ON 31
ci_033                 3.617222e-03 3 1  ON 32
ci_034                 3.531954e-03 3 1  ON 33
ci_035                 2.467666e-03 3 1  ON 34
ci_036                 2.235447e-03 3 1  ON 35
ci_037                 3.474611e-03 3 1  ON 36
ci_038                 3.663881e-03 3 1  ON 37
ci_039                 4.460471e-03 3 1  ON 38
ci_040                 4.445459e-03 3 1  ON 39
ci_041                 2.762087e-03 3 1  ON 40
ci_042                 3.012668e-03 3 1  ON 41
ci_043                 3.644524e-03 3 1  ON 42
ci_044                 3.327209e-03 3 1  ON 43
ci_045                 2.489397e-03 3 1  ON 44
ci_046                 2.828877e-03 3 1  ON 45
ci_047                -1.172399e-03 3 1  ON 46
ci_048                -1.308723e-03 3 1  ON 47
ci_049                 1.148581e-03 3 1  ON 48
ci_050                 9.385313e-04 3 1  ON 49
ci_051                -1.668499e-03 3 1  ON 50
ci_052                -1.761343e-03 3 1  ON 51
ci_053                -2.590482e-03 3 1  ON 52
ci_054                -2.575461e-03 3 1  ON 53
ci_055                -1.843324e-03 3 1  ON 54
ci_056                -1.264751e-03 3 1  ON 55
ci_057                -1.294033e-03 3 1  ON 56
ci_058                -1.036534e-03 3 1  ON 57
ci_059                -4.735971e-04 3 1  ON 58
ci_060                -3.266885e-04 3 1  ON 59
ci_061                -5.935566e-04 3 1  ON 60
ci_062                -5.085843e-04 3 1  ON 61
ci_063                -7.376984e-04 3 1  ON 62
ci_064                -8.358717e-04 3 1  ON 63
ci_065                -1.782516e-03 3 1  ON 64
ci_066                -1.699332e-03 3 1  ON 65
ci_067                -1.442111e-03 3 1  ON 66
ci_068                -1.617180e-03 3 1  ON 67
ci_069                 2.080949e-04 3 1  ON 68
ci_070                 2.635365e-04 3 1  ON 69
ci_071                -1.513757e-03 3 1  ON 70
ci_072                -2.059583e-03 3 1  ON 71
ci_073                 1.522508e-04 3 1  ON 72
ci_074                 2.779510e-04 3 1  ON 73
ci_075                 7.133255e-05 3 1  ON 74
ci_076                 2.641421e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4617e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2650e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6133
    reference variance = 0.440716
====================================================
  Execution time = 2.6146e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4926e-01
  Total weights = 1.955072257e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439346235083
                                         uncertainty =       0.002044178216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439346235083
                                         uncertainty =       0.002044178216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468699078
  error estimate for blocks of size 2^( 2) =       0.000492995812
  error estimate for blocks of size 2^( 3) =       0.000515499251
  error estimate for blocks of size 2^( 4) =       0.000531652827
  error estimate for blocks of size 2^( 5) =       0.000540252613
  error estimate for blocks of size 2^( 6) =       0.000546138924
  error estimate for blocks of size 2^( 7) =       0.000550337881

      target function =      -0.745934884634
              le_mean =     -22.662783133812
             les_mean =     514.050996748832
             stat err =       0.000542095561
             autocorr =       1.337714713014
   target nu stat err =       0.000542095561
   target dn stat err =       0.002602479497
      target stat err =       0.002222680562
              std dev =       0.662840593055
             le_variance =       0.439357651802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266278313381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745940559115       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745941062113       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745941192438       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745941197589       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745941202565       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745941206834       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745941207211       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745941207856       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745941207601       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745941207528       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745941207539       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 5.617769e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745940559115       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745940684980       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745940717577       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745940718864       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745940720108       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745940721174       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745940721269       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745940721430       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745940721366       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745940721348       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745940721351       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+02 is 1.405507e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745940559115       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745940590589       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745940598739       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745940599061       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745940599372       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745940599638       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745940599661       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745940599702       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745940599686       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745940599681       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745940599684       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+02 is 3.514434e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0860e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -7.015762e-01 3 1  ON 0
ci_002                -7.061823e-01 3 1  ON 1
ci_003                -5.385141e-02 3 1  ON 2
ci_004                -5.517973e-02 3 1  ON 3
ci_005                 2.040919e-02 3 1  ON 4
ci_006                 2.045343e-02 3 1  ON 5
ci_007                 1.665717e-02 3 1  ON 6
ci_008                 1.663946e-02 3 1  ON 7
ci_009                -1.279830e-02 3 1  ON 8
ci_010                -1.298920e-02 3 1  ON 9
ci_011                -1.035179e-02 3 1  ON 10
ci_012                -1.037809e-02 3 1  ON 11
ci_013                 9.296999e-03 3 1  ON 12
ci_014                 9.363494e-03 3 1  ON 13
ci_015                 9.810425e-03 3 1  ON 14
ci_016                 1.022415e-02 3 1  ON 15
ci_017                 8.742758e-03 3 1  ON 16
ci_018                 8.764658e-03 3 1  ON 17
ci_019                -3.338878e-04 3 1  ON 18
ci_020                -1.162596e-04 3 1  ON 19
ci_021                -9.687366e-03 3 1  ON 20
ci_022                -1.044590e-02 3 1  ON 21
ci_023                 5.617288e-03 3 1  ON 22
ci_024                 5.157144e-03 3 1  ON 23
ci_025                 1.255606e-02 3 1  ON 24
ci_026                 1.193483e-02 3 1  ON 25
ci_027                 6.284958e-03 3 1  ON 26
ci_028                 6.394051e-03 3 1  ON 27
ci_029                -3.893477e-03 3 1  ON 28
ci_030                -4.525133e-03 3 1  ON 29
ci_031                 3.313918e-03 3 1  ON 30
ci_032                 2.863302e-03 3 1  ON 31
ci_033                 3.617642e-03 3 1  ON 32
ci_034                 3.531960e-03 3 1  ON 33
ci_035                 2.467585e-03 3 1  ON 34
ci_036                 2.235521e-03 3 1  ON 35
ci_037                 3.474448e-03 3 1  ON 36
ci_038                 3.663593e-03 3 1  ON 37
ci_039                 4.460369e-03 3 1  ON 38
ci_040                 4.445576e-03 3 1  ON 39
ci_041                 2.762108e-03 3 1  ON 40
ci_042                 3.012577e-03 3 1  ON 41
ci_043                 3.644356e-03 3 1  ON 42
ci_044                 3.326681e-03 3 1  ON 43
ci_045                 2.489403e-03 3 1  ON 44
ci_046                 2.828780e-03 3 1  ON 45
ci_047                -1.172225e-03 3 1  ON 46
ci_048                -1.308425e-03 3 1  ON 47
ci_049                 1.148177e-03 3 1  ON 48
ci_050                 9.383491e-04 3 1  ON 49
ci_051                -1.668254e-03 3 1  ON 50
ci_052                -1.761488e-03 3 1  ON 51
ci_053                -2.590477e-03 3 1  ON 52
ci_054                -2.575293e-03 3 1  ON 53
ci_055                -1.842970e-03 3 1  ON 54
ci_056                -1.264764e-03 3 1  ON 55
ci_057                -1.293857e-03 3 1  ON 56
ci_058                -1.036599e-03 3 1  ON 57
ci_059                -4.734133e-04 3 1  ON 58
ci_060                -3.268546e-04 3 1  ON 59
ci_061                -5.934481e-04 3 1  ON 60
ci_062                -5.085345e-04 3 1  ON 61
ci_063                -7.376742e-04 3 1  ON 62
ci_064                -8.361951e-04 3 1  ON 63
ci_065                -1.782525e-03 3 1  ON 64
ci_066                -1.699139e-03 3 1  ON 65
ci_067                -1.442378e-03 3 1  ON 66
ci_068                -1.617089e-03 3 1  ON 67
ci_069                 2.077025e-04 3 1  ON 68
ci_070                 2.636737e-04 3 1  ON 69
ci_071                -1.513855e-03 3 1  ON 70
ci_072                -2.059432e-03 3 1  ON 71
ci_073                 1.521002e-04 3 1  ON 72
ci_074                 2.777434e-04 3 1  ON 73
ci_075                 7.130013e-05 3 1  ON 74
ci_076                 2.640536e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6661
    reference variance = 0.309943
====================================================
  Execution time = 2.5371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.9671e-01
  Total weights = 1.9551e+06
  Execution time = 3.6165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591538298
                                         uncertainty =       0.003552857626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591538298
                                         uncertainty =       0.003552857626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471014178
  error estimate for blocks of size 2^( 2) =       0.000494966288
  error estimate for blocks of size 2^( 3) =       0.000516958021
  error estimate for blocks of size 2^( 4) =       0.000532648883
  error estimate for blocks of size 2^( 5) =       0.000541473058
  error estimate for blocks of size 2^( 6) =       0.000546283096
  error estimate for blocks of size 2^( 7) =       0.000548857817

      target function =      -0.707841057027
              le_mean =     -22.661606380601
             les_mean =     514.044936607227
             stat err =       0.000542315714
             autocorr =       1.325673019596
   target nu stat err =       0.000542315714
   target dn stat err =       0.039158187745
      target stat err =       0.029008780873
              std dev =       0.666114637900
             le_variance =       0.443708710824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443592296929
                                         uncertainty =       0.003553485194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443592296929
                                         uncertainty =       0.003553485194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471014587
  error estimate for blocks of size 2^( 2) =       0.000494966729
  error estimate for blocks of size 2^( 3) =       0.000516958517
  error estimate for blocks of size 2^( 4) =       0.000532649375
  error estimate for blocks of size 2^( 5) =       0.000541473389
  error estimate for blocks of size 2^( 6) =       0.000546283234
  error estimate for blocks of size 2^( 7) =       0.000548857770

      target function =      -0.707255715058
              le_mean =     -22.661606414498
             les_mean =     514.045673124267
             stat err =       0.000542315942
             autocorr =       1.325671828722
   target nu stat err =       0.000542315942
   target dn stat err =       0.039867054910
      target stat err =       0.029486628296
              std dev =       0.666115217373
             le_variance =       0.443709482815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591916278
                                         uncertainty =       0.003553171318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591916278
                                         uncertainty =       0.003553171318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471014382
  error estimate for blocks of size 2^( 2) =       0.000494966508
  error estimate for blocks of size 2^( 3) =       0.000516958268
  error estimate for blocks of size 2^( 4) =       0.000532649128
  error estimate for blocks of size 2^( 5) =       0.000541473223
  error estimate for blocks of size 2^( 6) =       0.000546283164
  error estimate for blocks of size 2^( 7) =       0.000548857792

      target function =      -0.707550183803
              le_mean =     -22.661606397466
             les_mean =     514.045302559816
             stat err =       0.000542315827
             autocorr =       1.325672424641
   target nu stat err =       0.000542315827
   target dn stat err =       0.039510458155
      target stat err =       0.029246448586
              std dev =       0.666114926640
             le_variance =       0.443709095492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591585372
                                         uncertainty =       0.003552896808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591585372
                                         uncertainty =       0.003552896808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471014203
  error estimate for blocks of size 2^( 2) =       0.000494966315
  error estimate for blocks of size 2^( 3) =       0.000516958051
  error estimate for blocks of size 2^( 4) =       0.000532648914
  error estimate for blocks of size 2^( 5) =       0.000541473079
  error estimate for blocks of size 2^( 6) =       0.000546283105
  error estimate for blocks of size 2^( 7) =       0.000548857814

      target function =      -0.707804910630
              le_mean =     -22.661606382698
             les_mean =     514.044982079055
             stat err =       0.000542315728
             autocorr =       1.325672945313
   target nu stat err =       0.000542315728
   target dn stat err =       0.039201963834
      target stat err =       0.029038337108
              std dev =       0.666114673862
             le_variance =       0.443708758735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707841057027        initial  <--
     3.9062e+01     3.9062e+02             5.6178e-06        -0.707255715058
     1.5625e+02     1.5625e+03             1.4055e-06        -0.707550183803
     6.2500e+02     6.2500e+03             3.5144e-07        -0.707804910630

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4642
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -7.015769e-01 3 1  ON 0
ci_002                -7.061814e-01 3 1  ON 1
ci_003                -5.385148e-02 3 1  ON 2
ci_004                -5.518044e-02 3 1  ON 3
ci_005                 2.040962e-02 3 1  ON 4
ci_006                 2.045425e-02 3 1  ON 5
ci_007                 1.665760e-02 3 1  ON 6
ci_008                 1.664001e-02 3 1  ON 7
ci_009                -1.279857e-02 3 1  ON 8
ci_010                -1.298967e-02 3 1  ON 9
ci_011                -1.035237e-02 3 1  ON 10
ci_012                -1.037844e-02 3 1  ON 11
ci_013                 9.297684e-03 3 1  ON 12
ci_014                 9.364307e-03 3 1  ON 13
ci_015                 9.811188e-03 3 1  ON 14
ci_016                 1.022491e-02 3 1  ON 15
ci_017                 8.742769e-03 3 1  ON 16
ci_018                 8.764403e-03 3 1  ON 17
ci_019                -3.329607e-04 3 1  ON 18
ci_020                -1.148541e-04 3 1  ON 19
ci_021                -9.686525e-03 3 1  ON 20
ci_022                -1.044510e-02 3 1  ON 21
ci_023                 5.617340e-03 3 1  ON 22
ci_024                 5.157354e-03 3 1  ON 23
ci_025                 1.255544e-02 3 1  ON 24
ci_026                 1.193475e-02 3 1  ON 25
ci_027                 6.285364e-03 3 1  ON 26
ci_028                 6.394425e-03 3 1  ON 27
ci_029                -3.893390e-03 3 1  ON 28
ci_030                -4.525145e-03 3 1  ON 29
ci_031                 3.313399e-03 3 1  ON 30
ci_032                 2.862039e-03 3 1  ON 31
ci_033                 3.617222e-03 3 1  ON 32
ci_034                 3.531954e-03 3 1  ON 33
ci_035                 2.467666e-03 3 1  ON 34
ci_036                 2.235447e-03 3 1  ON 35
ci_037                 3.474611e-03 3 1  ON 36
ci_038                 3.663881e-03 3 1  ON 37
ci_039                 4.460471e-03 3 1  ON 38
ci_040                 4.445459e-03 3 1  ON 39
ci_041                 2.762087e-03 3 1  ON 40
ci_042                 3.012668e-03 3 1  ON 41
ci_043                 3.644524e-03 3 1  ON 42
ci_044                 3.327209e-03 3 1  ON 43
ci_045                 2.489397e-03 3 1  ON 44
ci_046                 2.828877e-03 3 1  ON 45
ci_047                -1.172399e-03 3 1  ON 46
ci_048                -1.308723e-03 3 1  ON 47
ci_049                 1.148581e-03 3 1  ON 48
ci_050                 9.385313e-04 3 1  ON 49
ci_051                -1.668499e-03 3 1  ON 50
ci_052                -1.761343e-03 3 1  ON 51
ci_053                -2.590482e-03 3 1  ON 52
ci_054                -2.575461e-03 3 1  ON 53
ci_055                -1.843324e-03 3 1  ON 54
ci_056                -1.264751e-03 3 1  ON 55
ci_057                -1.294033e-03 3 1  ON 56
ci_058                -1.036534e-03 3 1  ON 57
ci_059                -4.735971e-04 3 1  ON 58
ci_060                -3.266885e-04 3 1  ON 59
ci_061                -5.935566e-04 3 1  ON 60
ci_062                -5.085843e-04 3 1  ON 61
ci_063                -7.376984e-04 3 1  ON 62
ci_064                -8.358717e-04 3 1  ON 63
ci_065                -1.782516e-03 3 1  ON 64
ci_066                -1.699332e-03 3 1  ON 65
ci_067                -1.442111e-03 3 1  ON 66
ci_068                -1.617180e-03 3 1  ON 67
ci_069                 2.080949e-04 3 1  ON 68
ci_070                 2.635365e-04 3 1  ON 69
ci_071                -1.513757e-03 3 1  ON 70
ci_072                -2.059583e-03 3 1  ON 71
ci_073                 1.522508e-04 3 1  ON 72
ci_074                 2.779510e-04 3 1  ON 73
ci_075                 7.133255e-05 3 1  ON 74
ci_076                 2.641421e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2649e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.5919
    reference variance = 0.443301
====================================================
  Execution time = 2.6254e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5071e-01
  Total weights = 1.955144022e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441087001033
                                         uncertainty =       0.002130766871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441087001033
                                         uncertainty =       0.002130766871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469621341
  error estimate for blocks of size 2^( 2) =       0.000493490718
  error estimate for blocks of size 2^( 3) =       0.000515511701
  error estimate for blocks of size 2^( 4) =       0.000531090935
  error estimate for blocks of size 2^( 5) =       0.000539261154
  error estimate for blocks of size 2^( 6) =       0.000544460907
  error estimate for blocks of size 2^( 7) =       0.000546748861

      target function =      -0.744736291508
              le_mean =     -22.661864810487
             les_mean =     514.010821895357
             stat err =       0.000540390464
             autocorr =       1.324096703934
   target nu stat err =       0.000540390464
   target dn stat err =       0.002858031822
      target stat err =       0.002414519297
              std dev =       0.664144869944
             le_variance =       0.441088408273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266186481049e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744743173785       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744743281504       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744743297046       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744743299217       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744743299662       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744743299864       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744743299862       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744743299812       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744743299815       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744743299831       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+02 is 7.345563e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744743173785       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744743200717       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744743204603       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744743205146       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744743205255       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744743205309       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744743205307       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744743205293       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744743205295       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744743205299       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+03 is 1.836446e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744743173785       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744743180518       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744743181490       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744743181625       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744743181653       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744743181666       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744743181666       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744743181667       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744743181665       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744743181664       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+03 is 4.591149e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0970e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -7.015769e-01 3 1  ON 0
ci_002                -7.061814e-01 3 1  ON 1
ci_003                -5.385130e-02 3 1  ON 2
ci_004                -5.518039e-02 3 1  ON 3
ci_005                 2.040953e-02 3 1  ON 4
ci_006                 2.045416e-02 3 1  ON 5
ci_007                 1.665747e-02 3 1  ON 6
ci_008                 1.663994e-02 3 1  ON 7
ci_009                -1.279852e-02 3 1  ON 8
ci_010                -1.298957e-02 3 1  ON 9
ci_011                -1.035226e-02 3 1  ON 10
ci_012                -1.037831e-02 3 1  ON 11
ci_013                 9.297651e-03 3 1  ON 12
ci_014                 9.364236e-03 3 1  ON 13
ci_015                 9.811158e-03 3 1  ON 14
ci_016                 1.022483e-02 3 1  ON 15
ci_017                 8.742694e-03 3 1  ON 16
ci_018                 8.764354e-03 3 1  ON 17
ci_019                -3.330472e-04 3 1  ON 18
ci_020                -1.149417e-04 3 1  ON 19
ci_021                -9.686607e-03 3 1  ON 20
ci_022                -1.044516e-02 3 1  ON 21
ci_023                 5.617248e-03 3 1  ON 22
ci_024                 5.157378e-03 3 1  ON 23
ci_025                 1.255547e-02 3 1  ON 24
ci_026                 1.193476e-02 3 1  ON 25
ci_027                 6.285328e-03 3 1  ON 26
ci_028                 6.394422e-03 3 1  ON 27
ci_029                -3.893393e-03 3 1  ON 28
ci_030                -4.525072e-03 3 1  ON 29
ci_031                 3.313455e-03 3 1  ON 30
ci_032                 2.862079e-03 3 1  ON 31
ci_033                 3.617189e-03 3 1  ON 32
ci_034                 3.531913e-03 3 1  ON 33
ci_035                 2.467644e-03 3 1  ON 34
ci_036                 2.235465e-03 3 1  ON 35
ci_037                 3.474586e-03 3 1  ON 36
ci_038                 3.663847e-03 3 1  ON 37
ci_039                 4.460457e-03 3 1  ON 38
ci_040                 4.445444e-03 3 1  ON 39
ci_041                 2.761976e-03 3 1  ON 40
ci_042                 3.012661e-03 3 1  ON 41
ci_043                 3.644504e-03 3 1  ON 42
ci_044                 3.327222e-03 3 1  ON 43
ci_045                 2.489355e-03 3 1  ON 44
ci_046                 2.828900e-03 3 1  ON 45
ci_047                -1.172358e-03 3 1  ON 46
ci_048                -1.308656e-03 3 1  ON 47
ci_049                 1.148604e-03 3 1  ON 48
ci_050                 9.385022e-04 3 1  ON 49
ci_051                -1.668521e-03 3 1  ON 50
ci_052                -1.761303e-03 3 1  ON 51
ci_053                -2.590425e-03 3 1  ON 52
ci_054                -2.575458e-03 3 1  ON 53
ci_055                -1.843298e-03 3 1  ON 54
ci_056                -1.264789e-03 3 1  ON 55
ci_057                -1.293947e-03 3 1  ON 56
ci_058                -1.036506e-03 3 1  ON 57
ci_059                -4.736007e-04 3 1  ON 58
ci_060                -3.267350e-04 3 1  ON 59
ci_061                -5.935035e-04 3 1  ON 60
ci_062                -5.085716e-04 3 1  ON 61
ci_063                -7.376468e-04 3 1  ON 62
ci_064                -8.358910e-04 3 1  ON 63
ci_065                -1.782489e-03 3 1  ON 64
ci_066                -1.699320e-03 3 1  ON 65
ci_067                -1.442108e-03 3 1  ON 66
ci_068                -1.617210e-03 3 1  ON 67
ci_069                 2.080182e-04 3 1  ON 68
ci_070                 2.635602e-04 3 1  ON 69
ci_071                -1.513767e-03 3 1  ON 70
ci_072                -2.059562e-03 3 1  ON 71
ci_073                 1.522514e-04 3 1  ON 72
ci_074                 2.779568e-04 3 1  ON 73
ci_075                 7.130576e-05 3 1  ON 74
ci_076                 2.640983e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7043
    reference variance = 0.312608
====================================================
  Execution time = 2.7739e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4920e-01
  Total weights = 1.9550e+06
  Execution time = 3.6447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440968892568
                                         uncertainty =       0.001892239918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440968892568
                                         uncertainty =       0.001892239918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469526135
  error estimate for blocks of size 2^( 2) =       0.000493536970
  error estimate for blocks of size 2^( 3) =       0.000515596391
  error estimate for blocks of size 2^( 4) =       0.000531498968
  error estimate for blocks of size 2^( 5) =       0.000540156370
  error estimate for blocks of size 2^( 6) =       0.000545059399
  error estimate for blocks of size 2^( 7) =       0.000545246522

      target function =      -0.745985244896
              le_mean =     -22.662754460182
             les_mean =     514.049635894154
             stat err =       0.000540490315
             autocorr =       1.325123296821
   target nu stat err =       0.000540490315
   target dn stat err =       0.002537833095
      target stat err =       0.002171212051
              std dev =       0.664010228248
             le_variance =       0.440909583218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440968793086
                                         uncertainty =       0.001892243963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440968793086
                                         uncertainty =       0.001892243963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469526082
  error estimate for blocks of size 2^( 2) =       0.000493536937
  error estimate for blocks of size 2^( 3) =       0.000515596366
  error estimate for blocks of size 2^( 4) =       0.000531498949
  error estimate for blocks of size 2^( 5) =       0.000540156344
  error estimate for blocks of size 2^( 6) =       0.000545059372
  error estimate for blocks of size 2^( 7) =       0.000545246499

      target function =      -0.745986049571
              le_mean =     -22.662754463263
             les_mean =     514.049635055019
             stat err =       0.000540490291
             autocorr =       1.325123479927
   target nu stat err =       0.000540490291
   target dn stat err =       0.002537955715
      target stat err =       0.002171313563
              std dev =       0.664010153381
             le_variance =       0.440909483793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440968842811
                                         uncertainty =       0.001892241940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440968842811
                                         uncertainty =       0.001892241940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469526109
  error estimate for blocks of size 2^( 2) =       0.000493536953
  error estimate for blocks of size 2^( 3) =       0.000515596379
  error estimate for blocks of size 2^( 4) =       0.000531498959
  error estimate for blocks of size 2^( 5) =       0.000540156357
  error estimate for blocks of size 2^( 6) =       0.000545059385
  error estimate for blocks of size 2^( 7) =       0.000545246511

      target function =      -0.745985839819
              le_mean =     -22.662754461725
             les_mean =     514.049635240613
             stat err =       0.000540490303
             autocorr =       1.325123388360
   target nu stat err =       0.000540490303
   target dn stat err =       0.002537894316
      target stat err =       0.002171263816
              std dev =       0.664010190802
             le_variance =       0.440909533489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440968886347
                                         uncertainty =       0.001892240170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440968886347
                                         uncertainty =       0.001892240170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469526132
  error estimate for blocks of size 2^( 2) =       0.000493536968
  error estimate for blocks of size 2^( 3) =       0.000515596390
  error estimate for blocks of size 2^( 4) =       0.000531498967
  error estimate for blocks of size 2^( 5) =       0.000540156368
  error estimate for blocks of size 2^( 6) =       0.000545059397
  error estimate for blocks of size 2^( 7) =       0.000545246521

      target function =      -0.745985355349
              le_mean =     -22.662754460375
             les_mean =     514.049635768620
             stat err =       0.000540490313
             autocorr =       1.325123308258
   target nu stat err =       0.000540490313
   target dn stat err =       0.002537840719
      target stat err =       0.002171218701
              std dev =       0.664010223566
             le_variance =       0.440909577000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745985244896        initial
     3.9062e+02     3.9062e+03             7.3456e-07        -0.745986049571  <--
     1.5625e+03     1.5625e+04             1.8364e-07        -0.745985839819
     6.2500e+03     6.2500e+04             4.5911e-08        -0.745985355349

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 4.5913e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -7.015770e-01 3 1  ON 0
ci_002                -7.061815e-01 3 1  ON 1
ci_003                -5.385075e-02 3 1  ON 2
ci_004                -5.518024e-02 3 1  ON 3
ci_005                 2.040928e-02 3 1  ON 4
ci_006                 2.045388e-02 3 1  ON 5
ci_007                 1.665707e-02 3 1  ON 6
ci_008                 1.663972e-02 3 1  ON 7
ci_009                -1.279840e-02 3 1  ON 8
ci_010                -1.298926e-02 3 1  ON 9
ci_011                -1.035190e-02 3 1  ON 10
ci_012                -1.037789e-02 3 1  ON 11
ci_013                 9.297553e-03 3 1  ON 12
ci_014                 9.364020e-03 3 1  ON 13
ci_015                 9.811070e-03 3 1  ON 14
ci_016                 1.022458e-02 3 1  ON 15
ci_017                 8.742470e-03 3 1  ON 16
ci_018                 8.764205e-03 3 1  ON 17
ci_019                -3.333065e-04 3 1  ON 18
ci_020                -1.152045e-04 3 1  ON 19
ci_021                -9.686852e-03 3 1  ON 20
ci_022                -1.044536e-02 3 1  ON 21
ci_023                 5.616972e-03 3 1  ON 22
ci_024                 5.157449e-03 3 1  ON 23
ci_025                 1.255554e-02 3 1  ON 24
ci_026                 1.193479e-02 3 1  ON 25
ci_027                 6.285223e-03 3 1  ON 26
ci_028                 6.394414e-03 3 1  ON 27
ci_029                -3.893403e-03 3 1  ON 28
ci_030                -4.524852e-03 3 1  ON 29
ci_031                 3.313625e-03 3 1  ON 30
ci_032                 2.862200e-03 3 1  ON 31
ci_033                 3.617088e-03 3 1  ON 32
ci_034                 3.531791e-03 3 1  ON 33
ci_035                 2.467579e-03 3 1  ON 34
ci_036                 2.235520e-03 3 1  ON 35
ci_037                 3.474509e-03 3 1  ON 36
ci_038                 3.663745e-03 3 1  ON 37
ci_039                 4.460412e-03 3 1  ON 38
ci_040                 4.445400e-03 3 1  ON 39
ci_041                 2.761642e-03 3 1  ON 40
ci_042                 3.012641e-03 3 1  ON 41
ci_043                 3.644445e-03 3 1  ON 42
ci_044                 3.327261e-03 3 1  ON 43
ci_045                 2.489229e-03 3 1  ON 44
ci_046                 2.828966e-03 3 1  ON 45
ci_047                -1.172234e-03 3 1  ON 46
ci_048                -1.308458e-03 3 1  ON 47
ci_049                 1.148675e-03 3 1  ON 48
ci_050                 9.384150e-04 3 1  ON 49
ci_051                -1.668588e-03 3 1  ON 50
ci_052                -1.761186e-03 3 1  ON 51
ci_053                -2.590256e-03 3 1  ON 52
ci_054                -2.575449e-03 3 1  ON 53
ci_055                -1.843220e-03 3 1  ON 54
ci_056                -1.264901e-03 3 1  ON 55
ci_057                -1.293689e-03 3 1  ON 56
ci_058                -1.036422e-03 3 1  ON 57
ci_059                -4.736118e-04 3 1  ON 58
ci_060                -3.268745e-04 3 1  ON 59
ci_061                -5.933442e-04 3 1  ON 60
ci_062                -5.085333e-04 3 1  ON 61
ci_063                -7.374920e-04 3 1  ON 62
ci_064                -8.359488e-04 3 1  ON 63
ci_065                -1.782406e-03 3 1  ON 64
ci_066                -1.699286e-03 3 1  ON 65
ci_067                -1.442099e-03 3 1  ON 66
ci_068                -1.617302e-03 3 1  ON 67
ci_069                 2.077880e-04 3 1  ON 68
ci_070                 2.636313e-04 3 1  ON 69
ci_071                -1.513798e-03 3 1  ON 70
ci_072                -2.059499e-03 3 1  ON 71
ci_073                 1.522530e-04 3 1  ON 72
ci_074                 2.779741e-04 3 1  ON 73
ci_075                 7.122539e-05 3 1  ON 74
ci_076                 2.639667e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6889e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2649e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6122
    reference variance = 0.561818
====================================================
  Execution time = 2.6361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4976e-01
  Total weights = 1.955002664e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440017072230
                                         uncertainty =       0.002320174468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440017072230
                                         uncertainty =       0.002320174468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469114777
  error estimate for blocks of size 2^( 2) =       0.000493114595
  error estimate for blocks of size 2^( 3) =       0.000515067743
  error estimate for blocks of size 2^( 4) =       0.000530609418
  error estimate for blocks of size 2^( 5) =       0.000539078313
  error estimate for blocks of size 2^( 6) =       0.000543446594
  error estimate for blocks of size 2^( 7) =       0.000545373405

      target function =      -0.745505853219
              le_mean =     -22.661636915890
             les_mean =     513.999549558973
             stat err =       0.000539626933
             autocorr =       1.323210710077
   target nu stat err =       0.000539626933
   target dn stat err =       0.003071091133
      target stat err =       0.002588114901
              std dev =       0.663428479933
             le_variance =       0.440137347986


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266163691589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745513905289       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745514130193       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745514164133       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745514167770       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745514168939       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745514168199       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745514168444       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745514168723       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745514168823       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745514168852       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745514168906       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+01 is 2.498002e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745513905289       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745513961535       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745513970022       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745513970931       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745513971224       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745513971038       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745513971099       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745513971169       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745513971195       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745513971202       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745513971215       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+02 is 6.246902e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745513905289       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745513919352       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745513921473       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745513921700       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745513921774       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745513921727       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745513921745       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745513921764       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745513921766       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745513921769       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745513921774       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+03 is 1.561844e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1127e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -7.015767e-01 3 1  ON 0
ci_002                -7.061819e-01 3 1  ON 1
ci_003                -5.385042e-02 3 1  ON 2
ci_004                -5.518021e-02 3 1  ON 3
ci_005                 2.040896e-02 3 1  ON 4
ci_006                 2.045359e-02 3 1  ON 5
ci_007                 1.665694e-02 3 1  ON 6
ci_008                 1.663938e-02 3 1  ON 7
ci_009                -1.279800e-02 3 1  ON 8
ci_010                -1.298906e-02 3 1  ON 9
ci_011                -1.035151e-02 3 1  ON 10
ci_012                -1.037789e-02 3 1  ON 11
ci_013                 9.297375e-03 3 1  ON 12
ci_014                 9.363808e-03 3 1  ON 13
ci_015                 9.810851e-03 3 1  ON 14
ci_016                 1.022448e-02 3 1  ON 15
ci_017                 8.742419e-03 3 1  ON 16
ci_018                 8.763960e-03 3 1  ON 17
ci_019                -3.337316e-04 3 1  ON 18
ci_020                -1.158292e-04 3 1  ON 19
ci_021                -9.687133e-03 3 1  ON 20
ci_022                -1.044560e-02 3 1  ON 21
ci_023                 5.616951e-03 3 1  ON 22
ci_024                 5.157458e-03 3 1  ON 23
ci_025                 1.255564e-02 3 1  ON 24
ci_026                 1.193481e-02 3 1  ON 25
ci_027                 6.285102e-03 3 1  ON 26
ci_028                 6.394485e-03 3 1  ON 27
ci_029                -3.893489e-03 3 1  ON 28
ci_030                -4.524683e-03 3 1  ON 29
ci_031                 3.313835e-03 3 1  ON 30
ci_032                 2.862391e-03 3 1  ON 31
ci_033                 3.617208e-03 3 1  ON 32
ci_034                 3.531974e-03 3 1  ON 33
ci_035                 2.467451e-03 3 1  ON 34
ci_036                 2.235513e-03 3 1  ON 35
ci_037                 3.474297e-03 3 1  ON 36
ci_038                 3.663701e-03 3 1  ON 37
ci_039                 4.460348e-03 3 1  ON 38
ci_040                 4.445398e-03 3 1  ON 39
ci_041                 2.761752e-03 3 1  ON 40
ci_042                 3.012601e-03 3 1  ON 41
ci_043                 3.644399e-03 3 1  ON 42
ci_044                 3.327269e-03 3 1  ON 43
ci_045                 2.489193e-03 3 1  ON 44
ci_046                 2.828966e-03 3 1  ON 45
ci_047                -1.172212e-03 3 1  ON 46
ci_048                -1.308402e-03 3 1  ON 47
ci_049                 1.148684e-03 3 1  ON 48
ci_050                 9.384601e-04 3 1  ON 49
ci_051                -1.668557e-03 3 1  ON 50
ci_052                -1.761226e-03 3 1  ON 51
ci_053                -2.590386e-03 3 1  ON 52
ci_054                -2.575277e-03 3 1  ON 53
ci_055                -1.843349e-03 3 1  ON 54
ci_056                -1.265004e-03 3 1  ON 55
ci_057                -1.293792e-03 3 1  ON 56
ci_058                -1.036462e-03 3 1  ON 57
ci_059                -4.735459e-04 3 1  ON 58
ci_060                -3.269471e-04 3 1  ON 59
ci_061                -5.934586e-04 3 1  ON 60
ci_062                -5.084327e-04 3 1  ON 61
ci_063                -7.376618e-04 3 1  ON 62
ci_064                -8.359717e-04 3 1  ON 63
ci_065                -1.782327e-03 3 1  ON 64
ci_066                -1.699452e-03 3 1  ON 65
ci_067                -1.442122e-03 3 1  ON 66
ci_068                -1.617319e-03 3 1  ON 67
ci_069                 2.077145e-04 3 1  ON 68
ci_070                 2.634373e-04 3 1  ON 69
ci_071                -1.513746e-03 3 1  ON 70
ci_072                -2.059412e-03 3 1  ON 71
ci_073                 1.522101e-04 3 1  ON 72
ci_074                 2.778802e-04 3 1  ON 73
ci_075                 7.131814e-05 3 1  ON 74
ci_076                 2.640044e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6994
    reference variance = 0.473705
====================================================
  Execution time = 2.5710e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5769e-01
  Total weights = 1.9551e+06
  Execution time = 3.6499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446340962151
                                         uncertainty =       0.003296661700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446340962151
                                         uncertainty =       0.003296661700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472404001
  error estimate for blocks of size 2^( 2) =       0.000495923936
  error estimate for blocks of size 2^( 3) =       0.000517492732
  error estimate for blocks of size 2^( 4) =       0.000533751374
  error estimate for blocks of size 2^( 5) =       0.000542516924
  error estimate for blocks of size 2^( 6) =       0.000546293797
  error estimate for blocks of size 2^( 7) =       0.000545762626

      target function =      -0.739056753859
              le_mean =     -22.661341747424
             les_mean =     513.994095466852
             stat err =       0.000542081180
             autocorr =       1.316744539988
   target nu stat err =       0.000542081180
   target dn stat err =       0.003944987667
      target stat err =       0.003233282423
              std dev =       0.668080144539
             le_variance =       0.446331079527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446340593757
                                         uncertainty =       0.003296651431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446340593757
                                         uncertainty =       0.003296651431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472403807
  error estimate for blocks of size 2^( 2) =       0.000495923797
  error estimate for blocks of size 2^( 3) =       0.000517492623
  error estimate for blocks of size 2^( 4) =       0.000533751294
  error estimate for blocks of size 2^( 5) =       0.000542516817
  error estimate for blocks of size 2^( 6) =       0.000546293692
  error estimate for blocks of size 2^( 7) =       0.000545762493

      target function =      -0.739057029130
              le_mean =     -22.661341756491
             les_mean =     513.994095535636
             stat err =       0.000542081074
             autocorr =       1.316745102462
   target nu stat err =       0.000542081074
   target dn stat err =       0.003945054604
      target stat err =       0.003233337843
              std dev =       0.668079870740
             le_variance =       0.446330713688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446340777755
                                         uncertainty =       0.003296656561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446340777755
                                         uncertainty =       0.003296656561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472403904
  error estimate for blocks of size 2^( 2) =       0.000495923866
  error estimate for blocks of size 2^( 3) =       0.000517492678
  error estimate for blocks of size 2^( 4) =       0.000533751334
  error estimate for blocks of size 2^( 5) =       0.000542516870
  error estimate for blocks of size 2^( 6) =       0.000546293744
  error estimate for blocks of size 2^( 7) =       0.000545762559

      target function =      -0.739056895550
              le_mean =     -22.661341751945
             les_mean =     513.994095495655
             stat err =       0.000542081127
             autocorr =       1.316744821397
   target nu stat err =       0.000542081127
   target dn stat err =       0.003945020923
      target stat err =       0.003233309999
              std dev =       0.668080007491
             le_variance =       0.446330896409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446340939086
                                         uncertainty =       0.003296661057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446340939086
                                         uncertainty =       0.003296661057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472403988
  error estimate for blocks of size 2^( 2) =       0.000495923927
  error estimate for blocks of size 2^( 3) =       0.000517492726
  error estimate for blocks of size 2^( 4) =       0.000533751369
  error estimate for blocks of size 2^( 5) =       0.000542516918
  error estimate for blocks of size 2^( 6) =       0.000546293790
  error estimate for blocks of size 2^( 7) =       0.000545762618

      target function =      -0.739056772007
              le_mean =     -22.661341747987
             les_mean =     513.994095469846
             stat err =       0.000542081174
             autocorr =       1.316744575170
   target nu stat err =       0.000542081174
   target dn stat err =       0.003944991801
      target stat err =       0.003233285855
              std dev =       0.668080127397
             le_variance =       0.446331056622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739056753859        initial
     9.7656e+01     9.7656e+02             2.4980e-06        -0.739057029130  <--
     3.9062e+02     3.9062e+03             6.2469e-07        -0.739056895550
     1.5625e+03     1.5625e+04             1.5618e-07        -0.739056772007

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 4.3907e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -7.015757e-01 3 1  ON 0
ci_002                -7.061831e-01 3 1  ON 1
ci_003                -5.384944e-02 3 1  ON 2
ci_004                -5.518011e-02 3 1  ON 3
ci_005                 2.040798e-02 3 1  ON 4
ci_006                 2.045271e-02 3 1  ON 5
ci_007                 1.665653e-02 3 1  ON 6
ci_008                 1.663834e-02 3 1  ON 7
ci_009                -1.279680e-02 3 1  ON 8
ci_010                -1.298848e-02 3 1  ON 9
ci_011                -1.035031e-02 3 1  ON 10
ci_012                -1.037789e-02 3 1  ON 11
ci_013                 9.296841e-03 3 1  ON 12
ci_014                 9.363171e-03 3 1  ON 13
ci_015                 9.810194e-03 3 1  ON 14
ci_016                 1.022419e-02 3 1  ON 15
ci_017                 8.742267e-03 3 1  ON 16
ci_018                 8.763224e-03 3 1  ON 17
ci_019                -3.350062e-04 3 1  ON 18
ci_020                -1.177026e-04 3 1  ON 19
ci_021                -9.687975e-03 3 1  ON 20
ci_022                -1.044633e-02 3 1  ON 21
ci_023                 5.616887e-03 3 1  ON 22
ci_024                 5.157484e-03 3 1  ON 23
ci_025                 1.255596e-02 3 1  ON 24
ci_026                 1.193490e-02 3 1  ON 25
ci_027                 6.284742e-03 3 1  ON 26
ci_028                 6.394698e-03 3 1  ON 27
ci_029                -3.893745e-03 3 1  ON 28
ci_030                -4.524176e-03 3 1  ON 29
ci_031                 3.314464e-03 3 1  ON 30
ci_032                 2.862966e-03 3 1  ON 31
ci_033                 3.617567e-03 3 1  ON 32
ci_034                 3.532521e-03 3 1  ON 33
ci_035                 2.467068e-03 3 1  ON 34
ci_036                 2.235494e-03 3 1  ON 35
ci_037                 3.473661e-03 3 1  ON 36
ci_038                 3.663567e-03 3 1  ON 37
ci_039                 4.460156e-03 3 1  ON 38
ci_040                 4.445392e-03 3 1  ON 39
ci_041                 2.762080e-03 3 1  ON 40
ci_042                 3.012480e-03 3 1  ON 41
ci_043                 3.644260e-03 3 1  ON 42
ci_044                 3.327291e-03 3 1  ON 43
ci_045                 2.489085e-03 3 1  ON 44
ci_046                 2.828965e-03 3 1  ON 45
ci_047                -1.172149e-03 3 1  ON 46
ci_048                -1.308237e-03 3 1  ON 47
ci_049                 1.148713e-03 3 1  ON 48
ci_050                 9.385952e-04 3 1  ON 49
ci_051                -1.668466e-03 3 1  ON 50
ci_052                -1.761346e-03 3 1  ON 51
ci_053                -2.590778e-03 3 1  ON 52
ci_054                -2.574759e-03 3 1  ON 53
ci_055                -1.843736e-03 3 1  ON 54
ci_056                -1.265315e-03 3 1  ON 55
ci_057                -1.294101e-03 3 1  ON 56
ci_058                -1.036581e-03 3 1  ON 57
ci_059                -4.733483e-04 3 1  ON 58
ci_060                -3.271647e-04 3 1  ON 59
ci_061                -5.938015e-04 3 1  ON 60
ci_062                -5.081311e-04 3 1  ON 61
ci_063                -7.381710e-04 3 1  ON 62
ci_064                -8.360401e-04 3 1  ON 63
ci_065                -1.782091e-03 3 1  ON 64
ci_066                -1.699950e-03 3 1  ON 65
ci_067                -1.442190e-03 3 1  ON 66
ci_068                -1.617368e-03 3 1  ON 67
ci_069                 2.074938e-04 3 1  ON 68
ci_070                 2.628553e-04 3 1  ON 69
ci_071                -1.513590e-03 3 1  ON 70
ci_072                -2.059153e-03 3 1  ON 71
ci_073                 1.520814e-04 3 1  ON 72
ci_074                 2.775986e-04 3 1  ON 73
ci_075                 7.159626e-05 3 1  ON 74
ci_076                 2.641173e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5040e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2650e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7236
    reference variance = 0.424006
====================================================
  Execution time = 2.6351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4904e-01
  Total weights = 1.954789624e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7597e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439159831586
                                         uncertainty =       0.002350226208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439159831586
                                         uncertainty =       0.002350226208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468566901
  error estimate for blocks of size 2^( 2) =       0.000492482602
  error estimate for blocks of size 2^( 3) =       0.000514946158
  error estimate for blocks of size 2^( 4) =       0.000531115525
  error estimate for blocks of size 2^( 5) =       0.000541432135
  error estimate for blocks of size 2^( 6) =       0.000546965663
  error estimate for blocks of size 2^( 7) =       0.000551689200

      target function =      -0.746100648227
              le_mean =     -22.662104926087
             les_mean =     514.020043139435
             stat err =       0.000542800631
             autocorr =       1.341953518173
   target nu stat err =       0.000542800631
   target dn stat err =       0.003179390429
      target stat err =       0.002681452424
              std dev =       0.662653665741
             le_variance =       0.439109880720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266210492609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746109179245       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746110139915       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746110372580       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746110388395       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746110389878       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746110390610       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746110390465       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746110390696       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746110390348       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746110390191       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+01 is 7.522292e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746109179245       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746109419773       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746109477987       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746109481941       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746109482311       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746109482495       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746109482458       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746109482516       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746109482429       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746109482390       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+01 is 1.882936e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746109179245       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746109239399       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746109253956       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746109254944       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746109255036       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746109255083       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746109255073       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746109255088       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746109255066       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746109255056       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+02 is 4.708819e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1120e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -7.015762e-01 3 1  ON 0
ci_002                -7.061828e-01 3 1  ON 1
ci_003                -5.384979e-02 3 1  ON 2
ci_004                -5.517983e-02 3 1  ON 3
ci_005                 2.040701e-02 3 1  ON 4
ci_006                 2.045235e-02 3 1  ON 5
ci_007                 1.665541e-02 3 1  ON 6
ci_008                 1.663681e-02 3 1  ON 7
ci_009                -1.279544e-02 3 1  ON 8
ci_010                -1.298746e-02 3 1  ON 9
ci_011                -1.035004e-02 3 1  ON 10
ci_012                -1.037659e-02 3 1  ON 11
ci_013                 9.295306e-03 3 1  ON 12
ci_014                 9.362074e-03 3 1  ON 13
ci_015                 9.809873e-03 3 1  ON 14
ci_016                 1.022406e-02 3 1  ON 15
ci_017                 8.740384e-03 3 1  ON 16
ci_018                 8.762254e-03 3 1  ON 17
ci_019                -3.365743e-04 3 1  ON 18
ci_020                -1.180351e-04 3 1  ON 19
ci_021                -9.689714e-03 3 1  ON 20
ci_022                -1.044786e-02 3 1  ON 21
ci_023                 5.616674e-03 3 1  ON 22
ci_024                 5.157102e-03 3 1  ON 23
ci_025                 1.255721e-02 3 1  ON 24
ci_026                 1.193602e-02 3 1  ON 25
ci_027                 6.284458e-03 3 1  ON 26
ci_028                 6.394243e-03 3 1  ON 27
ci_029                -3.892816e-03 3 1  ON 28
ci_030                -4.524043e-03 3 1  ON 29
ci_031                 3.315864e-03 3 1  ON 30
ci_032                 2.864198e-03 3 1  ON 31
ci_033                 3.617579e-03 3 1  ON 32
ci_034                 3.534147e-03 3 1  ON 33
ci_035                 2.466832e-03 3 1  ON 34
ci_036                 2.234839e-03 3 1  ON 35
ci_037                 3.473240e-03 3 1  ON 36
ci_038                 3.662201e-03 3 1  ON 37
ci_039                 4.460093e-03 3 1  ON 38
ci_040                 4.444994e-03 3 1  ON 39
ci_041                 2.762088e-03 3 1  ON 40
ci_042                 3.012564e-03 3 1  ON 41
ci_043                 3.643542e-03 3 1  ON 42
ci_044                 3.327178e-03 3 1  ON 43
ci_045                 2.489629e-03 3 1  ON 44
ci_046                 2.829004e-03 3 1  ON 45
ci_047                -1.171002e-03 3 1  ON 46
ci_048                -1.307675e-03 3 1  ON 47
ci_049                 1.148337e-03 3 1  ON 48
ci_050                 9.383549e-04 3 1  ON 49
ci_051                -1.668437e-03 3 1  ON 50
ci_052                -1.761240e-03 3 1  ON 51
ci_053                -2.589799e-03 3 1  ON 52
ci_054                -2.575217e-03 3 1  ON 53
ci_055                -1.843384e-03 3 1  ON 54
ci_056                -1.264775e-03 3 1  ON 55
ci_057                -1.294074e-03 3 1  ON 56
ci_058                -1.036952e-03 3 1  ON 57
ci_059                -4.734228e-04 3 1  ON 58
ci_060                -3.273690e-04 3 1  ON 59
ci_061                -5.938491e-04 3 1  ON 60
ci_062                -5.082088e-04 3 1  ON 61
ci_063                -7.381911e-04 3 1  ON 62
ci_064                -8.354093e-04 3 1  ON 63
ci_065                -1.781003e-03 3 1  ON 64
ci_066                -1.700077e-03 3 1  ON 65
ci_067                -1.442183e-03 3 1  ON 66
ci_068                -1.616885e-03 3 1  ON 67
ci_069                 2.077640e-04 3 1  ON 68
ci_070                 2.635109e-04 3 1  ON 69
ci_071                -1.514052e-03 3 1  ON 70
ci_072                -2.058908e-03 3 1  ON 71
ci_073                 1.518160e-04 3 1  ON 72
ci_074                 2.775347e-04 3 1  ON 73
ci_075                 7.180584e-05 3 1  ON 74
ci_076                 2.644101e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6181
    reference variance = 0.267625
====================================================
  Execution time = 2.5534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4555e-01
  Total weights = 1.9550e+06
  Execution time = 3.6394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438614447629
                                         uncertainty =       0.002344441424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438614447629
                                         uncertainty =       0.002344441424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468263392
  error estimate for blocks of size 2^( 2) =       0.000492616251
  error estimate for blocks of size 2^( 3) =       0.000514762648
  error estimate for blocks of size 2^( 4) =       0.000530274539
  error estimate for blocks of size 2^( 5) =       0.000539511909
  error estimate for blocks of size 2^( 6) =       0.000544316100
  error estimate for blocks of size 2^( 7) =       0.000547751955

      target function =      -0.748994040068
              le_mean =     -22.662699030303
             les_mean =     514.043479383464
             stat err =       0.000540463626
             autocorr =       1.332148154427
   target nu stat err =       0.000540463626
   target dn stat err =       0.002680664578
      target stat err =       0.002302069427
              std dev =       0.662224439428
             le_variance =       0.438541208176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438613078959
                                         uncertainty =       0.002344454456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438613078959
                                         uncertainty =       0.002344454456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468262662
  error estimate for blocks of size 2^( 2) =       0.000492615732
  error estimate for blocks of size 2^( 3) =       0.000514762277
  error estimate for blocks of size 2^( 4) =       0.000530274327
  error estimate for blocks of size 2^( 5) =       0.000539511729
  error estimate for blocks of size 2^( 6) =       0.000544316109
  error estimate for blocks of size 2^( 7) =       0.000547751990

      target function =      -0.748999872287
              le_mean =     -22.662699007216
             les_mean =     514.043471302512
             stat err =       0.000540463539
             autocorr =       1.332151878952
   target nu stat err =       0.000540463539
   target dn stat err =       0.002680846658
      target stat err =       0.002302249770
              std dev =       0.662223407145
             le_variance =       0.438539840971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438613760638
                                         uncertainty =       0.002344447899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438613760638
                                         uncertainty =       0.002344447899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468263025
  error estimate for blocks of size 2^( 2) =       0.000492615990
  error estimate for blocks of size 2^( 3) =       0.000514762461
  error estimate for blocks of size 2^( 4) =       0.000530274432
  error estimate for blocks of size 2^( 5) =       0.000539511818
  error estimate for blocks of size 2^( 6) =       0.000544316104
  error estimate for blocks of size 2^( 7) =       0.000547751972

      target function =      -0.748997470329
              le_mean =     -22.662699018528
             les_mean =     514.043474712500
             stat err =       0.000540463581
             autocorr =       1.332150020810
   target nu stat err =       0.000540463581
   target dn stat err =       0.002680752792
      target stat err =       0.002302160387
              std dev =       0.662223921282
             le_variance =       0.438540521918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438614361540
                                         uncertainty =       0.002344442229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438614361540
                                         uncertainty =       0.002344442229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468263346
  error estimate for blocks of size 2^( 2) =       0.000492616218
  error estimate for blocks of size 2^( 3) =       0.000514762624
  error estimate for blocks of size 2^( 4) =       0.000530274525
  error estimate for blocks of size 2^( 5) =       0.000539511898
  error estimate for blocks of size 2^( 6) =       0.000544316100
  error estimate for blocks of size 2^( 7) =       0.000547751957

      target function =      -0.748994548776
              le_mean =     -22.662699028808
             les_mean =     514.043478702191
             stat err =       0.000540463620
             autocorr =       1.332148387967
   target nu stat err =       0.000540463620
   target dn stat err =       0.002680675068
      target stat err =       0.002302080842
              std dev =       0.662224374498
             le_variance =       0.438541122179


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748994040068        initial
     2.4414e+01     2.4414e+02             7.5223e-06        -0.748999872287  <--
     9.7656e+01     9.7656e+02             1.8829e-06        -0.748997470329
     3.9062e+02     3.9062e+03             4.7088e-07        -0.748994548776

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 4.3673e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -7.015775e-01 3 1  ON 0
ci_002                -7.061820e-01 3 1  ON 1
ci_003                -5.385082e-02 3 1  ON 2
ci_004                -5.517900e-02 3 1  ON 3
ci_005                 2.040409e-02 3 1  ON 4
ci_006                 2.045125e-02 3 1  ON 5
ci_007                 1.665204e-02 3 1  ON 6
ci_008                 1.663223e-02 3 1  ON 7
ci_009                -1.279136e-02 3 1  ON 8
ci_010                -1.298438e-02 3 1  ON 9
ci_011                -1.034922e-02 3 1  ON 10
ci_012                -1.037269e-02 3 1  ON 11
ci_013                 9.290708e-03 3 1  ON 12
ci_014                 9.358788e-03 3 1  ON 13
ci_015                 9.808910e-03 3 1  ON 14
ci_016                 1.022368e-02 3 1  ON 15
ci_017                 8.734745e-03 3 1  ON 16
ci_018                 8.759347e-03 3 1  ON 17
ci_019                -3.412711e-04 3 1  ON 18
ci_020                -1.190312e-04 3 1  ON 19
ci_021                -9.694926e-03 3 1  ON 20
ci_022                -1.045244e-02 3 1  ON 21
ci_023                 5.616037e-03 3 1  ON 22
ci_024                 5.155959e-03 3 1  ON 23
ci_025                 1.256098e-02 3 1  ON 24
ci_026                 1.193939e-02 3 1  ON 25
ci_027                 6.283606e-03 3 1  ON 26
ci_028                 6.392879e-03 3 1  ON 27
ci_029                -3.890033e-03 3 1  ON 28
ci_030                -4.523647e-03 3 1  ON 29
ci_031                 3.320056e-03 3 1  ON 30
ci_032                 2.867889e-03 3 1  ON 31
ci_033                 3.617614e-03 3 1  ON 32
ci_034                 3.539016e-03 3 1  ON 33
ci_035                 2.466127e-03 3 1  ON 34
ci_036                 2.232878e-03 3 1  ON 35
ci_037                 3.471979e-03 3 1  ON 36
ci_038                 3.658110e-03 3 1  ON 37
ci_039                 4.459904e-03 3 1  ON 38
ci_040                 4.443802e-03 3 1  ON 39
ci_041                 2.762112e-03 3 1  ON 40
ci_042                 3.012818e-03 3 1  ON 41
ci_043                 3.641393e-03 3 1  ON 42
ci_044                 3.326839e-03 3 1  ON 43
ci_045                 2.491258e-03 3 1  ON 44
ci_046                 2.829119e-03 3 1  ON 45
ci_047                -1.167568e-03 3 1  ON 46
ci_048                -1.305991e-03 3 1  ON 47
ci_049                 1.147212e-03 3 1  ON 48
ci_050                 9.376356e-04 3 1  ON 49
ci_051                -1.668352e-03 3 1  ON 50
ci_052                -1.760923e-03 3 1  ON 51
ci_053                -2.586870e-03 3 1  ON 52
ci_054                -2.576587e-03 3 1  ON 53
ci_055                -1.842330e-03 3 1  ON 54
ci_056                -1.263155e-03 3 1  ON 55
ci_057                -1.293993e-03 3 1  ON 56
ci_058                -1.038062e-03 3 1  ON 57
ci_059                -4.736458e-04 3 1  ON 58
ci_060                -3.279801e-04 3 1  ON 59
ci_061                -5.939915e-04 3 1  ON 60
ci_062                -5.084412e-04 3 1  ON 61
ci_063                -7.382519e-04 3 1  ON 62
ci_064                -8.335200e-04 3 1  ON 63
ci_065                -1.777742e-03 3 1  ON 64
ci_066                -1.700457e-03 3 1  ON 65
ci_067                -1.442162e-03 3 1  ON 66
ci_068                -1.615439e-03 3 1  ON 67
ci_069                 2.085728e-04 3 1  ON 68
ci_070                 2.654743e-04 3 1  ON 69
ci_071                -1.515436e-03 3 1  ON 70
ci_072                -2.058174e-03 3 1  ON 71
ci_073                 1.510216e-04 3 1  ON 72
ci_074                 2.773432e-04 3 1  ON 73
ci_075                 7.243341e-05 3 1  ON 74
ci_076                 2.652868e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2650e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6929
    reference variance = 0.431293
====================================================
  Execution time = 2.6531e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5141e-01
  Total weights = 1.955381480e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440563117888
                                         uncertainty =       0.002712061478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440563117888
                                         uncertainty =       0.002712061478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469342011
  error estimate for blocks of size 2^( 2) =       0.000493161824
  error estimate for blocks of size 2^( 3) =       0.000515393834
  error estimate for blocks of size 2^( 4) =       0.000531522651
  error estimate for blocks of size 2^( 5) =       0.000542096038
  error estimate for blocks of size 2^( 6) =       0.000545872716
  error estimate for blocks of size 2^( 7) =       0.000549739530

      target function =      -0.744152200125
              le_mean =     -22.662424803174
             les_mean =     514.036911260397
             stat err =       0.000542307734
             autocorr =       1.335096743230
   target nu stat err =       0.000542307734
   target dn stat err =       0.004327809466
      target stat err =       0.003591056815
              std dev =       0.663749836757
             le_variance =       0.440563845796


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266242480317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744168539498       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744172542362       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744173335902       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744173446974       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744173517559       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744173574459       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744173602621       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744173604979       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744173604920       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744173611209       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744173612236       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 4.789032e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744168539498       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744169546060       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744169745011       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744169772807       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744169790429       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744169804586       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744169811557       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744169812133       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744169812118       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744169813674       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744169813925       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+01 is 1.197361e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744168539498       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744168791507       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744168841280       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744168848230       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744168852635       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744168856170       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744168857908       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744168858051       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744168858047       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744168858435       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744168858498       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+01 is 2.993468e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195775 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1224e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -7.015659e-01 3 1  ON 0
ci_002                -7.061940e-01 3 1  ON 1
ci_003                -5.384800e-02 3 1  ON 2
ci_004                -5.518457e-02 3 1  ON 3
ci_005                 2.039746e-02 3 1  ON 4
ci_006                 2.044675e-02 3 1  ON 5
ci_007                 1.664634e-02 3 1  ON 6
ci_008                 1.662685e-02 3 1  ON 7
ci_009                -1.278844e-02 3 1  ON 8
ci_010                -1.298101e-02 3 1  ON 9
ci_011                -1.034511e-02 3 1  ON 10
ci_012                -1.037074e-02 3 1  ON 11
ci_013                 9.287381e-03 3 1  ON 12
ci_014                 9.358385e-03 3 1  ON 13
ci_015                 9.802213e-03 3 1  ON 14
ci_016                 1.022337e-02 3 1  ON 15
ci_017                 8.732249e-03 3 1  ON 16
ci_018                 8.753635e-03 3 1  ON 17
ci_019                -3.460853e-04 3 1  ON 18
ci_020                -1.252246e-04 3 1  ON 19
ci_021                -9.700940e-03 3 1  ON 20
ci_022                -1.046191e-02 3 1  ON 21
ci_023                 5.613178e-03 3 1  ON 22
ci_024                 5.155199e-03 3 1  ON 23
ci_025                 1.256771e-02 3 1  ON 24
ci_026                 1.194229e-02 3 1  ON 25
ci_027                 6.283212e-03 3 1  ON 26
ci_028                 6.394366e-03 3 1  ON 27
ci_029                -3.888705e-03 3 1  ON 28
ci_030                -4.523579e-03 3 1  ON 29
ci_031                 3.324769e-03 3 1  ON 30
ci_032                 2.872435e-03 3 1  ON 31
ci_033                 3.616416e-03 3 1  ON 32
ci_034                 3.536627e-03 3 1  ON 33
ci_035                 2.465425e-03 3 1  ON 34
ci_036                 2.231850e-03 3 1  ON 35
ci_037                 3.470976e-03 3 1  ON 36
ci_038                 3.656687e-03 3 1  ON 37
ci_039                 4.459338e-03 3 1  ON 38
ci_040                 4.443763e-03 3 1  ON 39
ci_041                 2.763281e-03 3 1  ON 40
ci_042                 3.011204e-03 3 1  ON 41
ci_043                 3.641785e-03 3 1  ON 42
ci_044                 3.325378e-03 3 1  ON 43
ci_045                 2.493062e-03 3 1  ON 44
ci_046                 2.824835e-03 3 1  ON 45
ci_047                -1.166475e-03 3 1  ON 46
ci_048                -1.308156e-03 3 1  ON 47
ci_049                 1.143691e-03 3 1  ON 48
ci_050                 9.394562e-04 3 1  ON 49
ci_051                -1.668726e-03 3 1  ON 50
ci_052                -1.759671e-03 3 1  ON 51
ci_053                -2.589403e-03 3 1  ON 52
ci_054                -2.577941e-03 3 1  ON 53
ci_055                -1.839833e-03 3 1  ON 54
ci_056                -1.264815e-03 3 1  ON 55
ci_057                -1.292620e-03 3 1  ON 56
ci_058                -1.039105e-03 3 1  ON 57
ci_059                -4.739549e-04 3 1  ON 58
ci_060                -3.295103e-04 3 1  ON 59
ci_061                -5.934677e-04 3 1  ON 60
ci_062                -5.098436e-04 3 1  ON 61
ci_063                -7.361601e-04 3 1  ON 62
ci_064                -8.315168e-04 3 1  ON 63
ci_065                -1.778411e-03 3 1  ON 64
ci_066                -1.698123e-03 3 1  ON 65
ci_067                -1.442448e-03 3 1  ON 66
ci_068                -1.619488e-03 3 1  ON 67
ci_069                 2.082063e-04 3 1  ON 68
ci_070                 2.642838e-04 3 1  ON 69
ci_071                -1.515275e-03 3 1  ON 70
ci_072                -2.058693e-03 3 1  ON 71
ci_073                 1.494910e-04 3 1  ON 72
ci_074                 2.781596e-04 3 1  ON 73
ci_075                 7.411014e-05 3 1  ON 74
ci_076                 2.654147e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6861
    reference variance = 0.32677
====================================================
  Execution time = 2.5382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5131e-01
  Total weights = 1.9552e+06
  Execution time = 3.6251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440691700107
                                         uncertainty =       0.002008919170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440691700107
                                         uncertainty =       0.002008919170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469459316
  error estimate for blocks of size 2^( 2) =       0.000493132098
  error estimate for blocks of size 2^( 3) =       0.000514753931
  error estimate for blocks of size 2^( 4) =       0.000531789123
  error estimate for blocks of size 2^( 5) =       0.000540584720
  error estimate for blocks of size 2^( 6) =       0.000545655576
  error estimate for blocks of size 2^( 7) =       0.000550599361

      target function =      -0.744241150834
              le_mean =     -22.661870899526
             les_mean =     514.011698834323
             stat err =       0.000542157195
             autocorr =       1.333688874428
   target nu stat err =       0.000542157195
   target dn stat err =       0.003486265313
      target stat err =       0.002912513423
              std dev =       0.663915731627
             le_variance =       0.440784098702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440685265094
                                         uncertainty =       0.002010356507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440685265094
                                         uncertainty =       0.002010356507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469455855
  error estimate for blocks of size 2^( 2) =       0.000493129778
  error estimate for blocks of size 2^( 3) =       0.000514752303
  error estimate for blocks of size 2^( 4) =       0.000531787846
  error estimate for blocks of size 2^( 5) =       0.000540582807
  error estimate for blocks of size 2^( 6) =       0.000545653518
  error estimate for blocks of size 2^( 7) =       0.000550597242

      target function =      -0.744190927248
              le_mean =     -22.661871075053
             les_mean =     514.011768124732
             stat err =       0.000542155353
             autocorr =       1.333699474626
   target nu stat err =       0.000542155353
   target dn stat err =       0.003497962899
      target stat err =       0.002921492179
              std dev =       0.663910837456
             le_variance =       0.440777600091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440688424618
                                         uncertainty =       0.002009636096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440688424618
                                         uncertainty =       0.002009636096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469457555
  error estimate for blocks of size 2^( 2) =       0.000493130911
  error estimate for blocks of size 2^( 3) =       0.000514753093
  error estimate for blocks of size 2^( 4) =       0.000531788459
  error estimate for blocks of size 2^( 5) =       0.000540583734
  error estimate for blocks of size 2^( 6) =       0.000545654519
  error estimate for blocks of size 2^( 7) =       0.000550598279

      target function =      -0.744225959432
              le_mean =     -22.661870985186
             les_mean =     514.011721252765
             stat err =       0.000542156248
             autocorr =       1.333694220924
   target nu stat err =       0.000542156248
   target dn stat err =       0.003491884395
      target stat err =       0.002916895200
              std dev =       0.663913240836
             le_variance =       0.440780791358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440691285683
                                         uncertainty =       0.002009008299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440691285683
                                         uncertainty =       0.002009008299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469459093
  error estimate for blocks of size 2^( 2) =       0.000493131948
  error estimate for blocks of size 2^( 3) =       0.000514753824
  error estimate for blocks of size 2^( 4) =       0.000531789038
  error estimate for blocks of size 2^( 5) =       0.000540584594
  error estimate for blocks of size 2^( 6) =       0.000545655442
  error estimate for blocks of size 2^( 7) =       0.000550599224

      target function =      -0.744239961267
              le_mean =     -22.661870909920
             les_mean =     514.011700755043
             stat err =       0.000542157074
             autocorr =       1.333689545813
   target nu stat err =       0.000542157074
   target dn stat err =       0.003486953718
      target stat err =       0.002913055393
              std dev =       0.663915416523
             le_variance =       0.440783680296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744241150834        initial  <--
     6.1035e+00     6.1035e+01             4.7890e-05        -0.744190927248
     2.4414e+01     2.4414e+02             1.1974e-05        -0.744225959432
     9.7656e+01     9.7656e+02             2.9935e-06        -0.744239961267

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5391
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -7.015775e-01 3 1  ON 0
ci_002                -7.061820e-01 3 1  ON 1
ci_003                -5.385082e-02 3 1  ON 2
ci_004                -5.517900e-02 3 1  ON 3
ci_005                 2.040409e-02 3 1  ON 4
ci_006                 2.045125e-02 3 1  ON 5
ci_007                 1.665204e-02 3 1  ON 6
ci_008                 1.663223e-02 3 1  ON 7
ci_009                -1.279136e-02 3 1  ON 8
ci_010                -1.298438e-02 3 1  ON 9
ci_011                -1.034922e-02 3 1  ON 10
ci_012                -1.037269e-02 3 1  ON 11
ci_013                 9.290708e-03 3 1  ON 12
ci_014                 9.358788e-03 3 1  ON 13
ci_015                 9.808910e-03 3 1  ON 14
ci_016                 1.022368e-02 3 1  ON 15
ci_017                 8.734745e-03 3 1  ON 16
ci_018                 8.759347e-03 3 1  ON 17
ci_019                -3.412711e-04 3 1  ON 18
ci_020                -1.190312e-04 3 1  ON 19
ci_021                -9.694926e-03 3 1  ON 20
ci_022                -1.045244e-02 3 1  ON 21
ci_023                 5.616037e-03 3 1  ON 22
ci_024                 5.155959e-03 3 1  ON 23
ci_025                 1.256098e-02 3 1  ON 24
ci_026                 1.193939e-02 3 1  ON 25
ci_027                 6.283606e-03 3 1  ON 26
ci_028                 6.392879e-03 3 1  ON 27
ci_029                -3.890033e-03 3 1  ON 28
ci_030                -4.523647e-03 3 1  ON 29
ci_031                 3.320056e-03 3 1  ON 30
ci_032                 2.867889e-03 3 1  ON 31
ci_033                 3.617614e-03 3 1  ON 32
ci_034                 3.539016e-03 3 1  ON 33
ci_035                 2.466127e-03 3 1  ON 34
ci_036                 2.232878e-03 3 1  ON 35
ci_037                 3.471979e-03 3 1  ON 36
ci_038                 3.658110e-03 3 1  ON 37
ci_039                 4.459904e-03 3 1  ON 38
ci_040                 4.443802e-03 3 1  ON 39
ci_041                 2.762112e-03 3 1  ON 40
ci_042                 3.012818e-03 3 1  ON 41
ci_043                 3.641393e-03 3 1  ON 42
ci_044                 3.326839e-03 3 1  ON 43
ci_045                 2.491258e-03 3 1  ON 44
ci_046                 2.829119e-03 3 1  ON 45
ci_047                -1.167568e-03 3 1  ON 46
ci_048                -1.305991e-03 3 1  ON 47
ci_049                 1.147212e-03 3 1  ON 48
ci_050                 9.376356e-04 3 1  ON 49
ci_051                -1.668352e-03 3 1  ON 50
ci_052                -1.760923e-03 3 1  ON 51
ci_053                -2.586870e-03 3 1  ON 52
ci_054                -2.576587e-03 3 1  ON 53
ci_055                -1.842330e-03 3 1  ON 54
ci_056                -1.263155e-03 3 1  ON 55
ci_057                -1.293993e-03 3 1  ON 56
ci_058                -1.038062e-03 3 1  ON 57
ci_059                -4.736458e-04 3 1  ON 58
ci_060                -3.279801e-04 3 1  ON 59
ci_061                -5.939915e-04 3 1  ON 60
ci_062                -5.084412e-04 3 1  ON 61
ci_063                -7.382519e-04 3 1  ON 62
ci_064                -8.335200e-04 3 1  ON 63
ci_065                -1.777742e-03 3 1  ON 64
ci_066                -1.700457e-03 3 1  ON 65
ci_067                -1.442162e-03 3 1  ON 66
ci_068                -1.615439e-03 3 1  ON 67
ci_069                 2.085728e-04 3 1  ON 68
ci_070                 2.654743e-04 3 1  ON 69
ci_071                -1.515436e-03 3 1  ON 70
ci_072                -2.058174e-03 3 1  ON 71
ci_073                 1.510216e-04 3 1  ON 72
ci_074                 2.773432e-04 3 1  ON 73
ci_075                 7.243341e-05 3 1  ON 74
ci_076                 2.652868e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4770e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6374
    reference variance = 0.384899
====================================================
  Execution time = 2.6401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5576e-01
  Total weights = 1.955065804e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442087828363
                                         uncertainty =       0.003824118857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442087828363
                                         uncertainty =       0.003824118857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470157630
  error estimate for blocks of size 2^( 2) =       0.000494435594
  error estimate for blocks of size 2^( 3) =       0.000516922061
  error estimate for blocks of size 2^( 4) =       0.000534057944
  error estimate for blocks of size 2^( 5) =       0.000543136169
  error estimate for blocks of size 2^( 6) =       0.000546638526
  error estimate for blocks of size 2^( 7) =       0.000548408316

      target function =      -0.740604399983
              le_mean =     -22.661590000846
             les_mean =     514.003421593031
             stat err =       0.000543060239
             autocorr =       1.334163440444
   target nu stat err =       0.000543060239
   target dn stat err =       0.004971176830
      target stat err =       0.004067544284
              std dev =       0.664903296553
             le_variance =       0.442096393767


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266159000085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740625697130       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740626264644       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740626371235       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740626386789       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740626392165       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740626392760       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740626393986       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740626393668       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740626393494       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740626393292       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740626393496       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740626393516       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+01 is 5.268857e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740625697130       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740625839095       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740625865751       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740625869640       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740625870984       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740625871133       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740625871439       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740625871359       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740625871316       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740625871265       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740625871317       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740625871321       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+02 is 1.317825e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740625697130       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740625732627       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740625739291       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740625740264       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740625740599       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740625740637       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740625740713       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740625740692       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740625740683       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740625740669       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740625740682       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740625740686       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+02 is 3.294945e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200578 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1186e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -7.015771e-01 3 1  ON 0
ci_002                -7.061825e-01 3 1  ON 1
ci_003                -5.385040e-02 3 1  ON 2
ci_004                -5.517894e-02 3 1  ON 3
ci_005                 2.040344e-02 3 1  ON 4
ci_006                 2.045054e-02 3 1  ON 5
ci_007                 1.665134e-02 3 1  ON 6
ci_008                 1.663207e-02 3 1  ON 7
ci_009                -1.279116e-02 3 1  ON 8
ci_010                -1.298393e-02 3 1  ON 9
ci_011                -1.034878e-02 3 1  ON 10
ci_012                -1.037265e-02 3 1  ON 11
ci_013                 9.290428e-03 3 1  ON 12
ci_014                 9.358120e-03 3 1  ON 13
ci_015                 9.808651e-03 3 1  ON 14
ci_016                 1.022312e-02 3 1  ON 15
ci_017                 8.734544e-03 3 1  ON 16
ci_018                 8.759192e-03 3 1  ON 17
ci_019                -3.425889e-04 3 1  ON 18
ci_020                -1.196284e-04 3 1  ON 19
ci_021                -9.694817e-03 3 1  ON 20
ci_022                -1.045265e-02 3 1  ON 21
ci_023                 5.615414e-03 3 1  ON 22
ci_024                 5.155769e-03 3 1  ON 23
ci_025                 1.256100e-02 3 1  ON 24
ci_026                 1.194005e-02 3 1  ON 25
ci_027                 6.283547e-03 3 1  ON 26
ci_028                 6.392630e-03 3 1  ON 27
ci_029                -3.890091e-03 3 1  ON 28
ci_030                -4.523708e-03 3 1  ON 29
ci_031                 3.321138e-03 3 1  ON 30
ci_032                 2.868230e-03 3 1  ON 31
ci_033                 3.617662e-03 3 1  ON 32
ci_034                 3.538818e-03 3 1  ON 33
ci_035                 2.465975e-03 3 1  ON 34
ci_036                 2.232896e-03 3 1  ON 35
ci_037                 3.472057e-03 3 1  ON 36
ci_038                 3.657779e-03 3 1  ON 37
ci_039                 4.459831e-03 3 1  ON 38
ci_040                 4.443427e-03 3 1  ON 39
ci_041                 2.762048e-03 3 1  ON 40
ci_042                 3.012898e-03 3 1  ON 41
ci_043                 3.640846e-03 3 1  ON 42
ci_044                 3.326783e-03 3 1  ON 43
ci_045                 2.491228e-03 3 1  ON 44
ci_046                 2.829099e-03 3 1  ON 45
ci_047                -1.167568e-03 3 1  ON 46
ci_048                -1.305840e-03 3 1  ON 47
ci_049                 1.147364e-03 3 1  ON 48
ci_050                 9.374409e-04 3 1  ON 49
ci_051                -1.668326e-03 3 1  ON 50
ci_052                -1.761090e-03 3 1  ON 51
ci_053                -2.586550e-03 3 1  ON 52
ci_054                -2.576298e-03 3 1  ON 53
ci_055                -1.842245e-03 3 1  ON 54
ci_056                -1.263232e-03 3 1  ON 55
ci_057                -1.293962e-03 3 1  ON 56
ci_058                -1.037942e-03 3 1  ON 57
ci_059                -4.734761e-04 3 1  ON 58
ci_060                -3.281420e-04 3 1  ON 59
ci_061                -5.941177e-04 3 1  ON 60
ci_062                -5.082990e-04 3 1  ON 61
ci_063                -7.385027e-04 3 1  ON 62
ci_064                -8.335075e-04 3 1  ON 63
ci_065                -1.777340e-03 3 1  ON 64
ci_066                -1.700784e-03 3 1  ON 65
ci_067                -1.441986e-03 3 1  ON 66
ci_068                -1.615647e-03 3 1  ON 67
ci_069                 2.082218e-04 3 1  ON 68
ci_070                 2.651970e-04 3 1  ON 69
ci_071                -1.515304e-03 3 1  ON 70
ci_072                -2.058237e-03 3 1  ON 71
ci_073                 1.511574e-04 3 1  ON 72
ci_074                 2.772045e-04 3 1  ON 73
ci_075                 7.264761e-05 3 1  ON 74
ci_076                 2.652429e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6587
    reference variance = 0.272835
====================================================
  Execution time = 2.7436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5259e-01
  Total weights = 1.9551e+06
  Execution time = 3.6342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441032718682
                                         uncertainty =       0.002209611415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441032718682
                                         uncertainty =       0.002209611415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469657447
  error estimate for blocks of size 2^( 2) =       0.000493268540
  error estimate for blocks of size 2^( 3) =       0.000515457219
  error estimate for blocks of size 2^( 4) =       0.000530962164
  error estimate for blocks of size 2^( 5) =       0.000540470740
  error estimate for blocks of size 2^( 6) =       0.000545248540
  error estimate for blocks of size 2^( 7) =       0.000547871316

      target function =      -0.743194398928
              le_mean =     -22.662021198202
             les_mean =     514.019795543125
             stat err =       0.000541138190
             autocorr =       1.327559339792
   target nu stat err =       0.000541138190
   target dn stat err =       0.003282760027
      target stat err =       0.002742636982
              std dev =       0.664195931758
             le_variance =       0.441156235763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441031827482
                                         uncertainty =       0.002209703790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441031827482
                                         uncertainty =       0.002209703790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469656964
  error estimate for blocks of size 2^( 2) =       0.000493268213
  error estimate for blocks of size 2^( 3) =       0.000515456997
  error estimate for blocks of size 2^( 4) =       0.000530962033
  error estimate for blocks of size 2^( 5) =       0.000540470555
  error estimate for blocks of size 2^( 6) =       0.000545248355
  error estimate for blocks of size 2^( 7) =       0.000547870916

      target function =      -0.743196557028
              le_mean =     -22.662021154180
             les_mean =     514.019790899342
             stat err =       0.000541137965
             autocorr =       1.327560969460
   target nu stat err =       0.000541137965
   target dn stat err =       0.003283075449
      target stat err =       0.002742903481
              std dev =       0.664195247635
             le_variance =       0.441155326981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441032272367
                                         uncertainty =       0.002209657612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441032272367
                                         uncertainty =       0.002209657612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469657205
  error estimate for blocks of size 2^( 2) =       0.000493268377
  error estimate for blocks of size 2^( 3) =       0.000515457107
  error estimate for blocks of size 2^( 4) =       0.000530962098
  error estimate for blocks of size 2^( 5) =       0.000540470647
  error estimate for blocks of size 2^( 6) =       0.000545248447
  error estimate for blocks of size 2^( 7) =       0.000547871115

      target function =      -0.743195491823
              le_mean =     -22.662021176127
             les_mean =     514.019793201380
             stat err =       0.000541138077
             autocorr =       1.327560155225
   target nu stat err =       0.000541138077
   target dn stat err =       0.003282917531
      target stat err =       0.002742770166
              std dev =       0.664195589154
             le_variance =       0.441155780652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441032662831
                                         uncertainty =       0.002209617189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441032662831
                                         uncertainty =       0.002209617189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469657417
  error estimate for blocks of size 2^( 2) =       0.000493268520
  error estimate for blocks of size 2^( 3) =       0.000515457205
  error estimate for blocks of size 2^( 4) =       0.000530962156
  error estimate for blocks of size 2^( 5) =       0.000540470728
  error estimate for blocks of size 2^( 6) =       0.000545248528
  error estimate for blocks of size 2^( 7) =       0.000547871291

      target function =      -0.743194537104
              le_mean =     -22.662021195436
             les_mean =     514.019795248208
             stat err =       0.000541138176
             autocorr =       1.327559441756
   target nu stat err =       0.000541138176
   target dn stat err =       0.003282779686
      target stat err =       0.002742653618
              std dev =       0.664195888886
             le_variance =       0.441156178812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743194398928        initial
     6.1035e+01     6.1035e+02             5.2689e-06        -0.743196557028  <--
     2.4414e+02     2.4414e+03             1.3178e-06        -0.743195491823
     9.7656e+02     9.7656e+03             3.2949e-07        -0.743194537104

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 4.5541e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -7.015760e-01 3 1  ON 0
ci_002                -7.061840e-01 3 1  ON 1
ci_003                -5.384914e-02 3 1  ON 2
ci_004                -5.517874e-02 3 1  ON 3
ci_005                 2.040149e-02 3 1  ON 4
ci_006                 2.044840e-02 3 1  ON 5
ci_007                 1.664922e-02 3 1  ON 6
ci_008                 1.663158e-02 3 1  ON 7
ci_009                -1.279054e-02 3 1  ON 8
ci_010                -1.298258e-02 3 1  ON 9
ci_011                -1.034746e-02 3 1  ON 10
ci_012                -1.037252e-02 3 1  ON 11
ci_013                 9.289591e-03 3 1  ON 12
ci_014                 9.356117e-03 3 1  ON 13
ci_015                 9.807872e-03 3 1  ON 14
ci_016                 1.022146e-02 3 1  ON 15
ci_017                 8.733942e-03 3 1  ON 16
ci_018                 8.758729e-03 3 1  ON 17
ci_019                -3.465399e-04 3 1  ON 18
ci_020                -1.214187e-04 3 1  ON 19
ci_021                -9.694493e-03 3 1  ON 20
ci_022                -1.045331e-02 3 1  ON 21
ci_023                 5.613545e-03 3 1  ON 22
ci_024                 5.155201e-03 3 1  ON 23
ci_025                 1.256108e-02 3 1  ON 24
ci_026                 1.194204e-02 3 1  ON 25
ci_027                 6.283371e-03 3 1  ON 26
ci_028                 6.391884e-03 3 1  ON 27
ci_029                -3.890268e-03 3 1  ON 28
ci_030                -4.523891e-03 3 1  ON 29
ci_031                 3.324382e-03 3 1  ON 30
ci_032                 2.869251e-03 3 1  ON 31
ci_033                 3.617806e-03 3 1  ON 32
ci_034                 3.538225e-03 3 1  ON 33
ci_035                 2.465518e-03 3 1  ON 34
ci_036                 2.232951e-03 3 1  ON 35
ci_037                 3.472288e-03 3 1  ON 36
ci_038                 3.656786e-03 3 1  ON 37
ci_039                 4.459610e-03 3 1  ON 38
ci_040                 4.442303e-03 3 1  ON 39
ci_041                 2.761858e-03 3 1  ON 40
ci_042                 3.013139e-03 3 1  ON 41
ci_043                 3.639209e-03 3 1  ON 42
ci_044                 3.326618e-03 3 1  ON 43
ci_045                 2.491140e-03 3 1  ON 44
ci_046                 2.829037e-03 3 1  ON 45
ci_047                -1.167566e-03 3 1  ON 46
ci_048                -1.305386e-03 3 1  ON 47
ci_049                 1.147822e-03 3 1  ON 48
ci_050                 9.368574e-04 3 1  ON 49
ci_051                -1.668250e-03 3 1  ON 50
ci_052                -1.761591e-03 3 1  ON 51
ci_053                -2.585594e-03 3 1  ON 52
ci_054                -2.575433e-03 3 1  ON 53
ci_055                -1.841990e-03 3 1  ON 54
ci_056                -1.263462e-03 3 1  ON 55
ci_057                -1.293867e-03 3 1  ON 56
ci_058                -1.037583e-03 3 1  ON 57
ci_059                -4.729676e-04 3 1  ON 58
ci_060                -3.286270e-04 3 1  ON 59
ci_061                -5.944958e-04 3 1  ON 60
ci_062                -5.078727e-04 3 1  ON 61
ci_063                -7.392544e-04 3 1  ON 62
ci_064                -8.334699e-04 3 1  ON 63
ci_065                -1.776133e-03 3 1  ON 64
ci_066                -1.701761e-03 3 1  ON 65
ci_067                -1.441459e-03 3 1  ON 66
ci_068                -1.616273e-03 3 1  ON 67
ci_069                 2.071696e-04 3 1  ON 68
ci_070                 2.643658e-04 3 1  ON 69
ci_071                -1.514909e-03 3 1  ON 70
ci_072                -2.058426e-03 3 1  ON 71
ci_073                 1.515644e-04 3 1  ON 72
ci_074                 2.767887e-04 3 1  ON 73
ci_075                 7.328972e-05 3 1  ON 74
ci_076                 2.651116e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7286
    reference variance = 0.265621
====================================================
  Execution time = 2.6346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4739e-01
  Total weights = 1.955191196e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436327354880
                                         uncertainty =       0.001665803063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436327354880
                                         uncertainty =       0.001665803063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467054384
  error estimate for blocks of size 2^( 2) =       0.000491399705
  error estimate for blocks of size 2^( 3) =       0.000514186042
  error estimate for blocks of size 2^( 4) =       0.000530922765
  error estimate for blocks of size 2^( 5) =       0.000539455328
  error estimate for blocks of size 2^( 6) =       0.000544159595
  error estimate for blocks of size 2^( 7) =       0.000545605167

      target function =      -0.747472168927
              le_mean =     -22.662469837225
             les_mean =     514.034925672956
             stat err =       0.000540035714
             autocorr =       1.336934274113
   target nu stat err =       0.000540035714
   target dn stat err =       0.002772943134
      target stat err =       0.002365786032
              std dev =       0.660514644414
             le_variance =       0.436279595485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266246983723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747478713957       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747480287573       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747480506557       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747480516496       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747480515862       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747480519399       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747480528948       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747480529728       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747480529816       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747480530307       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747480530151       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 1.507763e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747478713957       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747479108302       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747479163117       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747479165595       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747479165435       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747479166322       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747479168705       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747479168897       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747479168919       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747479169041       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747479169003       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+01 is 3.778256e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747478713957       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747478812602       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747478826310       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747478826929       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747478826889       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747478827112       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747478827706       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747478827755       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747478827760       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747478827791       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747478827781       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+02 is 9.451185e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1061e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -7.015740e-01 3 1  ON 0
ci_002                -7.061864e-01 3 1  ON 1
ci_003                -5.384878e-02 3 1  ON 2
ci_004                -5.517790e-02 3 1  ON 3
ci_005                 2.039960e-02 3 1  ON 4
ci_006                 2.044634e-02 3 1  ON 5
ci_007                 1.664779e-02 3 1  ON 6
ci_008                 1.663115e-02 3 1  ON 7
ci_009                -1.278925e-02 3 1  ON 8
ci_010                -1.297880e-02 3 1  ON 9
ci_011                -1.034615e-02 3 1  ON 10
ci_012                -1.037105e-02 3 1  ON 11
ci_013                 9.290017e-03 3 1  ON 12
ci_014                 9.355387e-03 3 1  ON 13
ci_015                 9.808302e-03 3 1  ON 14
ci_016                 1.022099e-02 3 1  ON 15
ci_017                 8.733208e-03 3 1  ON 16
ci_018                 8.757779e-03 3 1  ON 17
ci_019                -3.491862e-04 3 1  ON 18
ci_020                -1.244157e-04 3 1  ON 19
ci_021                -9.695655e-03 3 1  ON 20
ci_022                -1.045350e-02 3 1  ON 21
ci_023                 5.612823e-03 3 1  ON 22
ci_024                 5.155594e-03 3 1  ON 23
ci_025                 1.256186e-02 3 1  ON 24
ci_026                 1.194341e-02 3 1  ON 25
ci_027                 6.283579e-03 3 1  ON 26
ci_028                 6.391923e-03 3 1  ON 27
ci_029                -3.890633e-03 3 1  ON 28
ci_030                -4.523011e-03 3 1  ON 29
ci_031                 3.326747e-03 3 1  ON 30
ci_032                 2.872076e-03 3 1  ON 31
ci_033                 3.616961e-03 3 1  ON 32
ci_034                 3.537633e-03 3 1  ON 33
ci_035                 2.465829e-03 3 1  ON 34
ci_036                 2.233308e-03 3 1  ON 35
ci_037                 3.472014e-03 3 1  ON 36
ci_038                 3.655685e-03 3 1  ON 37
ci_039                 4.458852e-03 3 1  ON 38
ci_040                 4.442773e-03 3 1  ON 39
ci_041                 2.762073e-03 3 1  ON 40
ci_042                 3.012468e-03 3 1  ON 41
ci_043                 3.639087e-03 3 1  ON 42
ci_044                 3.326654e-03 3 1  ON 43
ci_045                 2.490927e-03 3 1  ON 44
ci_046                 2.828200e-03 3 1  ON 45
ci_047                -1.167420e-03 3 1  ON 46
ci_048                -1.305690e-03 3 1  ON 47
ci_049                 1.146910e-03 3 1  ON 48
ci_050                 9.360846e-04 3 1  ON 49
ci_051                -1.666972e-03 3 1  ON 50
ci_052                -1.760697e-03 3 1  ON 51
ci_053                -2.584495e-03 3 1  ON 52
ci_054                -2.575163e-03 3 1  ON 53
ci_055                -1.842186e-03 3 1  ON 54
ci_056                -1.263198e-03 3 1  ON 55
ci_057                -1.293478e-03 3 1  ON 56
ci_058                -1.036930e-03 3 1  ON 57
ci_059                -4.726999e-04 3 1  ON 58
ci_060                -3.286929e-04 3 1  ON 59
ci_061                -5.945983e-04 3 1  ON 60
ci_062                -5.089401e-04 3 1  ON 61
ci_063                -7.391082e-04 3 1  ON 62
ci_064                -8.318956e-04 3 1  ON 63
ci_065                -1.776756e-03 3 1  ON 64
ci_066                -1.700352e-03 3 1  ON 65
ci_067                -1.441430e-03 3 1  ON 66
ci_068                -1.616379e-03 3 1  ON 67
ci_069                 2.076299e-04 3 1  ON 68
ci_070                 2.653832e-04 3 1  ON 69
ci_071                -1.513537e-03 3 1  ON 70
ci_072                -2.058220e-03 3 1  ON 71
ci_073                 1.520609e-04 3 1  ON 72
ci_074                 2.766193e-04 3 1  ON 73
ci_075                 7.454761e-05 3 1  ON 74
ci_076                 2.659136e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.6844
    reference variance = 0.664933
====================================================
  Execution time = 2.5336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4490e-01
  Total weights = 1.9554e+06
  Execution time = 3.6225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437270295981
                                         uncertainty =       0.001773923922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437270295981
                                         uncertainty =       0.001773923922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467609358
  error estimate for blocks of size 2^( 2) =       0.000491705520
  error estimate for blocks of size 2^( 3) =       0.000514231765
  error estimate for blocks of size 2^( 4) =       0.000529729485
  error estimate for blocks of size 2^( 5) =       0.000539106720
  error estimate for blocks of size 2^( 6) =       0.000544391521
  error estimate for blocks of size 2^( 7) =       0.000546601311

      target function =      -0.749529270471
              le_mean =     -22.662239965002
             les_mean =     514.022020114107
             stat err =       0.000539957259
             autocorr =       1.333375219971
   target nu stat err =       0.000539957259
   target dn stat err =       0.002289631757
      target stat err =       0.001991929894
              std dev =       0.661299496619
             le_variance =       0.437317024228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437267401732
                                         uncertainty =       0.001774004958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437267401732
                                         uncertainty =       0.001774004958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467607807
  error estimate for blocks of size 2^( 2) =       0.000491704320
  error estimate for blocks of size 2^( 3) =       0.000514230952
  error estimate for blocks of size 2^( 4) =       0.000529729000
  error estimate for blocks of size 2^( 5) =       0.000539106459
  error estimate for blocks of size 2^( 6) =       0.000544391343
  error estimate for blocks of size 2^( 7) =       0.000546601218

      target function =      -0.749531247610
              le_mean =     -22.662239912822
             les_mean =     514.022015364342
             stat err =       0.000539957005
             autocorr =       1.333382813774
   target nu stat err =       0.000539957005
   target dn stat err =       0.002289869192
      target stat err =       0.001992127652
              std dev =       0.661297302224
             le_variance =       0.437314121929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437268842506
                                         uncertainty =       0.001773964435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437268842506
                                         uncertainty =       0.001773964435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467608579
  error estimate for blocks of size 2^( 2) =       0.000491704917
  error estimate for blocks of size 2^( 3) =       0.000514231356
  error estimate for blocks of size 2^( 4) =       0.000529729240
  error estimate for blocks of size 2^( 5) =       0.000539106587
  error estimate for blocks of size 2^( 6) =       0.000544391430
  error estimate for blocks of size 2^( 7) =       0.000546601263

      target function =      -0.749530953546
              le_mean =     -22.662239938425
             les_mean =     514.022016880299
             stat err =       0.000539957130
             autocorr =       1.333379027272
   target nu stat err =       0.000539957130
   target dn stat err =       0.002289744981
      target stat err =       0.001992027947
              std dev =       0.661298394616
             le_variance =       0.437315566721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437270113837
                                         uncertainty =       0.001773928978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437270113837
                                         uncertainty =       0.001773928978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467609261
  error estimate for blocks of size 2^( 2) =       0.000491705445
  error estimate for blocks of size 2^( 3) =       0.000514231714
  error estimate for blocks of size 2^( 4) =       0.000529729454
  error estimate for blocks of size 2^( 5) =       0.000539106703
  error estimate for blocks of size 2^( 6) =       0.000544391510
  error estimate for blocks of size 2^( 7) =       0.000546601305

      target function =      -0.749529533274
              le_mean =     -22.662239961627
             les_mean =     514.022019644337
             stat err =       0.000539957243
             autocorr =       1.333375696305
   target nu stat err =       0.000539957243
   target dn stat err =       0.002289645473
      target stat err =       0.001991942070
              std dev =       0.661299358521
             le_variance =       0.437316841580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749529270471        initial
     1.5259e+01     1.5259e+02             1.5078e-05        -0.749531247610  <--
     6.1035e+01     6.1035e+02             3.7783e-06        -0.749530953546
     2.4414e+02     2.4414e+03             9.4512e-07        -0.749529533274

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 4.3494e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -7.015680e-01 3 1  ON 0
ci_002                -7.061935e-01 3 1  ON 1
ci_003                -5.384772e-02 3 1  ON 2
ci_004                -5.517538e-02 3 1  ON 3
ci_005                 2.039396e-02 3 1  ON 4
ci_006                 2.044018e-02 3 1  ON 5
ci_007                 1.664353e-02 3 1  ON 6
ci_008                 1.662990e-02 3 1  ON 7
ci_009                -1.278538e-02 3 1  ON 8
ci_010                -1.296750e-02 3 1  ON 9
ci_011                -1.034222e-02 3 1  ON 10
ci_012                -1.036665e-02 3 1  ON 11
ci_013                 9.291293e-03 3 1  ON 12
ci_014                 9.353204e-03 3 1  ON 13
ci_015                 9.809589e-03 3 1  ON 14
ci_016                 1.021961e-02 3 1  ON 15
ci_017                 8.731013e-03 3 1  ON 16
ci_018                 8.754936e-03 3 1  ON 17
ci_019                -3.571046e-04 3 1  ON 18
ci_020                -1.333836e-04 3 1  ON 19
ci_021                -9.699131e-03 3 1  ON 20
ci_022                -1.045406e-02 3 1  ON 21
ci_023                 5.610664e-03 3 1  ON 22
ci_024                 5.156770e-03 3 1  ON 23
ci_025                 1.256420e-02 3 1  ON 24
ci_026                 1.194748e-02 3 1  ON 25
ci_027                 6.284201e-03 3 1  ON 26
ci_028                 6.392038e-03 3 1  ON 27
ci_029                -3.891725e-03 3 1  ON 28
ci_030                -4.520377e-03 3 1  ON 29
ci_031                 3.333825e-03 3 1  ON 30
ci_032                 2.880528e-03 3 1  ON 31
ci_033                 3.614434e-03 3 1  ON 32
ci_034                 3.535863e-03 3 1  ON 33
ci_035                 2.466759e-03 3 1  ON 34
ci_036                 2.234375e-03 3 1  ON 35
ci_037                 3.471194e-03 3 1  ON 36
ci_038                 3.652391e-03 3 1  ON 37
ci_039                 4.456586e-03 3 1  ON 38
ci_040                 4.444179e-03 3 1  ON 39
ci_041                 2.762717e-03 3 1  ON 40
ci_042                 3.010463e-03 3 1  ON 41
ci_043                 3.638723e-03 3 1  ON 42
ci_044                 3.326764e-03 3 1  ON 43
ci_045                 2.490293e-03 3 1  ON 44
ci_046                 2.825697e-03 3 1  ON 45
ci_047                -1.166985e-03 3 1  ON 46
ci_048                -1.306601e-03 3 1  ON 47
ci_049                 1.144180e-03 3 1  ON 48
ci_050                 9.337733e-04 3 1  ON 49
ci_051                -1.663148e-03 3 1  ON 50
ci_052                -1.758022e-03 3 1  ON 51
ci_053                -2.581210e-03 3 1  ON 52
ci_054                -2.574355e-03 3 1  ON 53
ci_055                -1.842770e-03 3 1  ON 54
ci_056                -1.262407e-03 3 1  ON 55
ci_057                -1.292313e-03 3 1  ON 56
ci_058                -1.034976e-03 3 1  ON 57
ci_059                -4.718994e-04 3 1  ON 58
ci_060                -3.288897e-04 3 1  ON 59
ci_061                -5.949050e-04 3 1  ON 60
ci_062                -5.121333e-04 3 1  ON 61
ci_063                -7.386708e-04 3 1  ON 62
ci_064                -8.271848e-04 3 1  ON 63
ci_065                -1.778620e-03 3 1  ON 64
ci_066                -1.696136e-03 3 1  ON 65
ci_067                -1.441342e-03 3 1  ON 66
ci_068                -1.616695e-03 3 1  ON 67
ci_069                 2.090065e-04 3 1  ON 68
ci_070                 2.684261e-04 3 1  ON 69
ci_071                -1.509435e-03 3 1  ON 70
ci_072                -2.057605e-03 3 1  ON 71
ci_073                 1.535453e-04 3 1  ON 72
ci_074                 2.761121e-04 3 1  ON 73
ci_075                 7.831050e-05 3 1  ON 74
ci_076                 2.683128e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4565e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6221
    reference variance = 0.274033
====================================================
  Execution time = 2.6097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5051e-01
  Total weights = 1.954981216e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440639337939
                                         uncertainty =       0.002116828305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440639337939
                                         uncertainty =       0.002116828305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469346941
  error estimate for blocks of size 2^( 2) =       0.000493683484
  error estimate for blocks of size 2^( 3) =       0.000516691696
  error estimate for blocks of size 2^( 4) =       0.000533482788
  error estimate for blocks of size 2^( 5) =       0.000543972034
  error estimate for blocks of size 2^( 6) =       0.000550455753
  error estimate for blocks of size 2^( 7) =       0.000553246636

      target function =      -0.744897085673
              le_mean =     -22.662270188446
             les_mean =     514.029004112860
             stat err =       0.000545289303
             autocorr =       1.349789273497
   target nu stat err =       0.000545289303
   target dn stat err =       0.002790651783
      target stat err =       0.002364844406
              std dev =       0.663756809775
             le_variance =       0.440573102523


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266227018845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744903688229       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744910976024       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744912369304       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744912579301       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744912638324       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744912638864       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744912632461       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744912630976       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744912630939       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744912630220       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744912630960       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744912631364       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 6.455628e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744903688229       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744905527086       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744905877135       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744905929738       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744905944440       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744905944523       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744905942915       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744905942549       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744905942540       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744905942362       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744905942548       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 1.628557e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744903688229       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744904149012       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744904236633       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744904249790       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744904253462       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744904253480       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744904253078       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744904252986       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744904252984       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744904252940       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744904252986       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+01 is 4.079968e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0878e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -7.015670e-01 3 1  ON 0
ci_002                -7.061973e-01 3 1  ON 1
ci_003                -5.384570e-02 3 1  ON 2
ci_004                -5.516144e-02 3 1  ON 3
ci_005                 2.038803e-02 3 1  ON 4
ci_006                 2.043090e-02 3 1  ON 5
ci_007                 1.662725e-02 3 1  ON 6
ci_008                 1.661542e-02 3 1  ON 7
ci_009                -1.278143e-02 3 1  ON 8
ci_010                -1.296385e-02 3 1  ON 9
ci_011                -1.034132e-02 3 1  ON 10
ci_012                -1.036048e-02 3 1  ON 11
ci_013                 9.284921e-03 3 1  ON 12
ci_014                 9.350554e-03 3 1  ON 13
ci_015                 9.805041e-03 3 1  ON 14
ci_016                 1.021441e-02 3 1  ON 15
ci_017                 8.725212e-03 3 1  ON 16
ci_018                 8.752605e-03 3 1  ON 17
ci_019                -3.712798e-04 3 1  ON 18
ci_020                -1.430030e-04 3 1  ON 19
ci_021                -9.703907e-03 3 1  ON 20
ci_022                -1.046081e-02 3 1  ON 21
ci_023                 5.611026e-03 3 1  ON 22
ci_024                 5.153668e-03 3 1  ON 23
ci_025                 1.256967e-02 3 1  ON 24
ci_026                 1.195708e-02 3 1  ON 25
ci_027                 6.284308e-03 3 1  ON 26
ci_028                 6.388151e-03 3 1  ON 27
ci_029                -3.892461e-03 3 1  ON 28
ci_030                -4.516223e-03 3 1  ON 29
ci_031                 3.341542e-03 3 1  ON 30
ci_032                 2.889452e-03 3 1  ON 31
ci_033                 3.608692e-03 3 1  ON 32
ci_034                 3.528342e-03 3 1  ON 33
ci_035                 2.464838e-03 3 1  ON 34
ci_036                 2.232510e-03 3 1  ON 35
ci_037                 3.469532e-03 3 1  ON 36
ci_038                 3.647717e-03 3 1  ON 37
ci_039                 4.455707e-03 3 1  ON 38
ci_040                 4.444846e-03 3 1  ON 39
ci_041                 2.762399e-03 3 1  ON 40
ci_042                 3.006015e-03 3 1  ON 41
ci_043                 3.636192e-03 3 1  ON 42
ci_044                 3.326036e-03 3 1  ON 43
ci_045                 2.493218e-03 3 1  ON 44
ci_046                 2.831960e-03 3 1  ON 45
ci_047                -1.166382e-03 3 1  ON 46
ci_048                -1.303434e-03 3 1  ON 47
ci_049                 1.143575e-03 3 1  ON 48
ci_050                 9.344199e-04 3 1  ON 49
ci_051                -1.660520e-03 3 1  ON 50
ci_052                -1.762219e-03 3 1  ON 51
ci_053                -2.581371e-03 3 1  ON 52
ci_054                -2.578391e-03 3 1  ON 53
ci_055                -1.842531e-03 3 1  ON 54
ci_056                -1.263999e-03 3 1  ON 55
ci_057                -1.289185e-03 3 1  ON 56
ci_058                -1.033974e-03 3 1  ON 57
ci_059                -4.737903e-04 3 1  ON 58
ci_060                -3.269357e-04 3 1  ON 59
ci_061                -5.922558e-04 3 1  ON 60
ci_062                -5.115893e-04 3 1  ON 61
ci_063                -7.341828e-04 3 1  ON 62
ci_064                -8.258155e-04 3 1  ON 63
ci_065                -1.781691e-03 3 1  ON 64
ci_066                -1.693156e-03 3 1  ON 65
ci_067                -1.443919e-03 3 1  ON 66
ci_068                -1.608579e-03 3 1  ON 67
ci_069                 2.060797e-04 3 1  ON 68
ci_070                 2.651354e-04 3 1  ON 69
ci_071                -1.507244e-03 3 1  ON 70
ci_072                -2.053043e-03 3 1  ON 71
ci_073                 1.573859e-04 3 1  ON 72
ci_074                 2.752119e-04 3 1  ON 73
ci_075                 8.236096e-05 3 1  ON 74
ci_076                 2.674184e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6824
    reference variance = 0.310807
====================================================
  Execution time = 2.5581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5637e-01
  Total weights = 1.9551e+06
  Execution time = 3.6070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445615648859
                                         uncertainty =       0.005883537848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445615648859
                                         uncertainty =       0.005883537848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472028221
  error estimate for blocks of size 2^( 2) =       0.000496156057
  error estimate for blocks of size 2^( 3) =       0.000518234100
  error estimate for blocks of size 2^( 4) =       0.000533972267
  error estimate for blocks of size 2^( 5) =       0.000542275116
  error estimate for blocks of size 2^( 6) =       0.000546539702
  error estimate for blocks of size 2^( 7) =       0.000551571317

      target function =      -0.740089830496
              le_mean =     -22.661624144463
             les_mean =     514.005583536630
             stat err =       0.000543589600
             autocorr =       1.326191835071
   target nu stat err =       0.000543589600
   target dn stat err =       0.006645370604
      target stat err =       0.005404849043
              std dev =       0.667548712148
             le_variance =       0.445621283090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445608832868
                                         uncertainty =       0.005885414548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445608832868
                                         uncertainty =       0.005885414548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472024619
  error estimate for blocks of size 2^( 2) =       0.000496154269
  error estimate for blocks of size 2^( 3) =       0.000518233654
  error estimate for blocks of size 2^( 4) =       0.000533971952
  error estimate for blocks of size 2^( 5) =       0.000542275376
  error estimate for blocks of size 2^( 6) =       0.000546539362
  error estimate for blocks of size 2^( 7) =       0.000551571202

      target function =      -0.740106020819
              le_mean =     -22.661624454409
             les_mean =     514.005577543681
             stat err =       0.000543589473
             autocorr =       1.326211453359
   target nu stat err =       0.000543589473
   target dn stat err =       0.006646218724
      target stat err =       0.005405768142
              std dev =       0.667543618406
             le_variance =       0.445614482474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445612119452
                                         uncertainty =       0.005884475877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445612119452
                                         uncertainty =       0.005884475877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472026356
  error estimate for blocks of size 2^( 2) =       0.000496155108
  error estimate for blocks of size 2^( 3) =       0.000518233830
  error estimate for blocks of size 2^( 4) =       0.000533972065
  error estimate for blocks of size 2^( 5) =       0.000542275211
  error estimate for blocks of size 2^( 6) =       0.000546539491
  error estimate for blocks of size 2^( 7) =       0.000551571214

      target function =      -0.740102575566
              le_mean =     -22.661624291105
             les_mean =     514.005574412776
             stat err =       0.000543589495
             autocorr =       1.326201803532
   target nu stat err =       0.000543589495
   target dn stat err =       0.006645604086
      target stat err =       0.005405222874
              std dev =       0.667546074430
             le_variance =       0.445617761487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445615196597
                                         uncertainty =       0.005883655164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445615196597
                                         uncertainty =       0.005883655164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472027982
  error estimate for blocks of size 2^( 2) =       0.000496155932
  error estimate for blocks of size 2^( 3) =       0.000518234061
  error estimate for blocks of size 2^( 4) =       0.000533972236
  error estimate for blocks of size 2^( 5) =       0.000542275123
  error estimate for blocks of size 2^( 6) =       0.000546539670
  error estimate for blocks of size 2^( 7) =       0.000551571298

      target function =      -0.740092297779
              le_mean =     -22.661624161738
             les_mean =     514.005581267182
             stat err =       0.000543589582
             autocorr =       1.326193088314
   target nu stat err =       0.000543589582
   target dn stat err =       0.006645379266
      target stat err =       0.005404891961
              std dev =       0.667548374139
             le_variance =       0.445620831816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740089830496        initial
     3.8147e+00     3.8147e+01             6.4556e-05        -0.740106020819  <--
     1.5259e+01     1.5259e+02             1.6286e-05        -0.740102575566
     6.1035e+01     6.1035e+02             4.0800e-06        -0.740092297779

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.3625e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -7.015634e-01 3 1  ON 0
ci_002                -7.062089e-01 3 1  ON 1
ci_003                -5.383968e-02 3 1  ON 2
ci_004                -5.511988e-02 3 1  ON 3
ci_005                 2.037047e-02 3 1  ON 4
ci_006                 2.040342e-02 3 1  ON 5
ci_007                 1.657898e-02 3 1  ON 6
ci_008                 1.657252e-02 3 1  ON 7
ci_009                -1.276973e-02 3 1  ON 8
ci_010                -1.295303e-02 3 1  ON 9
ci_011                -1.033865e-02 3 1  ON 10
ci_012                -1.034218e-02 3 1  ON 11
ci_013                 9.265988e-03 3 1  ON 12
ci_014                 9.342680e-03 3 1  ON 13
ci_015                 9.791521e-03 3 1  ON 14
ci_016                 1.019898e-02 3 1  ON 15
ci_017                 8.708001e-03 3 1  ON 16
ci_018                 8.745681e-03 3 1  ON 17
ci_019                -4.133906e-04 3 1  ON 18
ci_020                -1.716173e-04 3 1  ON 19
ci_021                -9.718117e-03 3 1  ON 20
ci_022                -1.048089e-02 3 1  ON 21
ci_023                 5.612100e-03 3 1  ON 22
ci_024                 5.144496e-03 3 1  ON 23
ci_025                 1.258591e-02 3 1  ON 24
ci_026                 1.198564e-02 3 1  ON 25
ci_027                 6.284595e-03 3 1  ON 26
ci_028                 6.376647e-03 3 1  ON 27
ci_029                -3.894589e-03 3 1  ON 28
ci_030                -4.503877e-03 3 1  ON 29
ci_031                 3.364462e-03 3 1  ON 30
ci_032                 2.916007e-03 3 1  ON 31
ci_033                 3.591696e-03 3 1  ON 32
ci_034                 3.506087e-03 3 1  ON 33
ci_035                 2.459188e-03 3 1  ON 34
ci_036                 2.226997e-03 3 1  ON 35
ci_037                 3.464619e-03 3 1  ON 36
ci_038                 3.633805e-03 3 1  ON 37
ci_039                 4.453126e-03 3 1  ON 38
ci_040                 4.446872e-03 3 1  ON 39
ci_041                 2.761441e-03 3 1  ON 40
ci_042                 2.992847e-03 3 1  ON 41
ci_043                 3.628662e-03 3 1  ON 42
ci_044                 3.323859e-03 3 1  ON 43
ci_045                 2.501851e-03 3 1  ON 44
ci_046                 2.850500e-03 3 1  ON 45
ci_047                -1.164618e-03 3 1  ON 46
ci_048                -1.294018e-03 3 1  ON 47
ci_049                 1.141783e-03 3 1  ON 48
ci_050                 9.363148e-04 3 1  ON 49
ci_051                -1.652732e-03 3 1  ON 50
ci_052                -1.774644e-03 3 1  ON 51
ci_053                -2.581866e-03 3 1  ON 52
ci_054                -2.590335e-03 3 1  ON 53
ci_055                -1.841857e-03 3 1  ON 54
ci_056                -1.268680e-03 3 1  ON 55
ci_057                -1.279918e-03 3 1  ON 56
ci_058                -1.030985e-03 3 1  ON 57
ci_059                -4.794422e-04 3 1  ON 58
ci_060                -3.211371e-04 3 1  ON 59
ci_061                -5.843168e-04 3 1  ON 60
ci_062                -5.099754e-04 3 1  ON 61
ci_063                -7.208577e-04 3 1  ON 62
ci_064                -8.217458e-04 3 1  ON 63
ci_065                -1.790738e-03 3 1  ON 64
ci_066                -1.684273e-03 3 1  ON 65
ci_067                -1.451556e-03 3 1  ON 66
ci_068                -1.584494e-03 3 1  ON 67
ci_069                 1.974089e-04 3 1  ON 68
ci_070                 2.553437e-04 3 1  ON 69
ci_071                -1.500671e-03 3 1  ON 70
ci_072                -2.039441e-03 3 1  ON 71
ci_073                 1.688615e-04 3 1  ON 72
ci_074                 2.725716e-04 3 1  ON 73
ci_075                 9.440325e-05 3 1  ON 74
ci_076                 2.647694e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4519e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.6289
    reference variance = 0.279688
====================================================
  Execution time = 2.6054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4606e-01
  Total weights = 1.954974659e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437173235650
                                         uncertainty =       0.002073736016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437173235650
                                         uncertainty =       0.002073736016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467529232
  error estimate for blocks of size 2^( 2) =       0.000491222115
  error estimate for blocks of size 2^( 3) =       0.000513840722
  error estimate for blocks of size 2^( 4) =       0.000529392781
  error estimate for blocks of size 2^( 5) =       0.000538108977
  error estimate for blocks of size 2^( 6) =       0.000542096726
  error estimate for blocks of size 2^( 7) =       0.000544387274

      target function =      -0.748561173592
              le_mean =     -22.661898726985
             les_mean =     514.007715391303
             stat err =       0.000538496439
             autocorr =       1.326624863794
   target nu stat err =       0.000538496439
   target dn stat err =       0.002341131695
      target stat err =       0.002026221778
              std dev =       0.661186180270
             le_variance =       0.437167164980


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266189872698e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748565724956       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748589615844       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748594904251       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748595575136       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748595784432       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748596020087       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748596158796       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748596196510       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748596234379       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748596206719       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748596210241       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748596210351       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 2.223880e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748565724956       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748571925687       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748573273443       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748573441131       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748573493033       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748573550632       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748573583767       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748573592764       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748573601296       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748573594431       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748573595398       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 5.724825e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748565724956       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748567290075       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748567628634       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748567670542       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748567683488       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748567697801       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748567705985       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748567708208       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748567710280       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748567708570       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748567708818       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 1.442111e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0829e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -7.016100e-01 3 1  ON 0
ci_002                -7.061720e-01 3 1  ON 1
ci_003                -5.382548e-02 3 1  ON 2
ci_004                -5.506735e-02 3 1  ON 3
ci_005                 2.033878e-02 3 1  ON 4
ci_006                 2.037580e-02 3 1  ON 5
ci_007                 1.655234e-02 3 1  ON 6
ci_008                 1.654515e-02 3 1  ON 7
ci_009                -1.275021e-02 3 1  ON 8
ci_010                -1.294768e-02 3 1  ON 9
ci_011                -1.030612e-02 3 1  ON 10
ci_012                -1.031514e-02 3 1  ON 11
ci_013                 9.236847e-03 3 1  ON 12
ci_014                 9.317078e-03 3 1  ON 13
ci_015                 9.766241e-03 3 1  ON 14
ci_016                 1.017629e-02 3 1  ON 15
ci_017                 8.690250e-03 3 1  ON 16
ci_018                 8.740277e-03 3 1  ON 17
ci_019                -4.706389e-04 3 1  ON 18
ci_020                -2.177822e-04 3 1  ON 19
ci_021                -9.768406e-03 3 1  ON 20
ci_022                -1.049403e-02 3 1  ON 21
ci_023                 5.624374e-03 3 1  ON 22
ci_024                 5.155664e-03 3 1  ON 23
ci_025                 1.262995e-02 3 1  ON 24
ci_026                 1.200662e-02 3 1  ON 25
ci_027                 6.295445e-03 3 1  ON 26
ci_028                 6.367021e-03 3 1  ON 27
ci_029                -3.885928e-03 3 1  ON 28
ci_030                -4.491716e-03 3 1  ON 29
ci_031                 3.394850e-03 3 1  ON 30
ci_032                 2.941320e-03 3 1  ON 31
ci_033                 3.574834e-03 3 1  ON 32
ci_034                 3.493768e-03 3 1  ON 33
ci_035                 2.460241e-03 3 1  ON 34
ci_036                 2.232542e-03 3 1  ON 35
ci_037                 3.472795e-03 3 1  ON 36
ci_038                 3.637452e-03 3 1  ON 37
ci_039                 4.445581e-03 3 1  ON 38
ci_040                 4.440872e-03 3 1  ON 39
ci_041                 2.760110e-03 3 1  ON 40
ci_042                 2.985302e-03 3 1  ON 41
ci_043                 3.591284e-03 3 1  ON 42
ci_044                 3.313606e-03 3 1  ON 43
ci_045                 2.498505e-03 3 1  ON 44
ci_046                 2.850127e-03 3 1  ON 45
ci_047                -1.160591e-03 3 1  ON 46
ci_048                -1.293107e-03 3 1  ON 47
ci_049                 1.140911e-03 3 1  ON 48
ci_050                 9.365060e-04 3 1  ON 49
ci_051                -1.642385e-03 3 1  ON 50
ci_052                -1.762574e-03 3 1  ON 51
ci_053                -2.578448e-03 3 1  ON 52
ci_054                -2.595409e-03 3 1  ON 53
ci_055                -1.811951e-03 3 1  ON 54
ci_056                -1.260062e-03 3 1  ON 55
ci_057                -1.290907e-03 3 1  ON 56
ci_058                -1.007054e-03 3 1  ON 57
ci_059                -4.729737e-04 3 1  ON 58
ci_060                -3.245020e-04 3 1  ON 59
ci_061                -5.738823e-04 3 1  ON 60
ci_062                -5.151108e-04 3 1  ON 61
ci_063                -7.311608e-04 3 1  ON 62
ci_064                -8.278964e-04 3 1  ON 63
ci_065                -1.794624e-03 3 1  ON 64
ci_066                -1.692373e-03 3 1  ON 65
ci_067                -1.460944e-03 3 1  ON 66
ci_068                -1.578202e-03 3 1  ON 67
ci_069                 1.884443e-04 3 1  ON 68
ci_070                 2.571237e-04 3 1  ON 69
ci_071                -1.506210e-03 3 1  ON 70
ci_072                -2.006777e-03 3 1  ON 71
ci_073                 1.793170e-04 3 1  ON 72
ci_074                 2.588822e-04 3 1  ON 73
ci_075                 1.090323e-04 3 1  ON 74
ci_076                 2.681715e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.6468
    reference variance = 0.642958
====================================================
  Execution time = 2.5120e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5460e-01
  Total weights = 1.9553e+06
  Execution time = 3.6149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444252123410
                                         uncertainty =       0.003729487997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444252123410
                                         uncertainty =       0.003729487997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471303023
  error estimate for blocks of size 2^( 2) =       0.000495248407
  error estimate for blocks of size 2^( 3) =       0.000517690794
  error estimate for blocks of size 2^( 4) =       0.000534068827
  error estimate for blocks of size 2^( 5) =       0.000542526640
  error estimate for blocks of size 2^( 6) =       0.000547639162
  error estimate for blocks of size 2^( 7) =       0.000550603054

      target function =      -0.741197866013
              le_mean =     -22.661499496801
             les_mean =     513.998595613647
             stat err =       0.000543709421
             autocorr =       1.330862735579
   target nu stat err =       0.000543709421
   target dn stat err =       0.004052447272
      target stat err =       0.003338497817
              std dev =       0.666523127150
             le_variance =       0.444253079026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444200089498
                                         uncertainty =       0.003728846579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444200089498
                                         uncertainty =       0.003728846579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471275391
  error estimate for blocks of size 2^( 2) =       0.000495226752
  error estimate for blocks of size 2^( 3) =       0.000517674203
  error estimate for blocks of size 2^( 4) =       0.000534053451
  error estimate for blocks of size 2^( 5) =       0.000542515759
  error estimate for blocks of size 2^( 6) =       0.000547624658
  error estimate for blocks of size 2^( 7) =       0.000550589205

      target function =      -0.741271760487
              le_mean =     -22.661498190620
             les_mean =     513.998445508877
             stat err =       0.000543695768
             autocorr =       1.330951963505
   target nu stat err =       0.000543695768
   target dn stat err =       0.004018779562
      target stat err =       0.003312284882
              std dev =       0.666484048931
             le_variance =       0.444200987479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444224335227
                                         uncertainty =       0.003729199893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444224335227
                                         uncertainty =       0.003729199893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471288261
  error estimate for blocks of size 2^( 2) =       0.000495236808
  error estimate for blocks of size 2^( 3) =       0.000517681877
  error estimate for blocks of size 2^( 4) =       0.000534060608
  error estimate for blocks of size 2^( 5) =       0.000542520776
  error estimate for blocks of size 2^( 6) =       0.000547631402
  error estimate for blocks of size 2^( 7) =       0.000550595619

      target function =      -0.741615122101
              le_mean =     -22.661498710588
             les_mean =     513.998045932132
             stat err =       0.000543702101
             autocorr =       1.330910272959
   target nu stat err =       0.000543702101
   target dn stat err =       0.004007167635
      target stat err =       0.003306037614
              std dev =       0.666502251093
             le_variance =       0.444225250712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444248503565
                                         uncertainty =       0.003729451108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444248503565
                                         uncertainty =       0.003729451108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471301100
  error estimate for blocks of size 2^( 2) =       0.000495246876
  error estimate for blocks of size 2^( 3) =       0.000517689597
  error estimate for blocks of size 2^( 4) =       0.000534067714
  error estimate for blocks of size 2^( 5) =       0.000542525821
  error estimate for blocks of size 2^( 6) =       0.000547638112
  error estimate for blocks of size 2^( 7) =       0.000550602021

      target function =      -0.741340385654
              le_mean =     -22.661499380055
             les_mean =     513.998414724729
             stat err =       0.000543708417
             autocorr =       1.330868681639
   target nu stat err =       0.000543708417
   target dn stat err =       0.004031660249
      target stat err =       0.003323173404
              std dev =       0.666520407945
             le_variance =       0.444249454207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741197866013        initial
     9.5367e-01     9.5367e+00             2.2239e-04        -0.741271760487
     3.8147e+00     3.8147e+01             5.7248e-05        -0.741615122101  <--
     1.5259e+01     1.5259e+02             1.4421e-05        -0.741340385654

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.3236e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -7.016100e-01 3 1  ON 0
ci_002                -7.061720e-01 3 1  ON 1
ci_003                -5.382548e-02 3 1  ON 2
ci_004                -5.506735e-02 3 1  ON 3
ci_005                 2.033878e-02 3 1  ON 4
ci_006                 2.037580e-02 3 1  ON 5
ci_007                 1.655234e-02 3 1  ON 6
ci_008                 1.654515e-02 3 1  ON 7
ci_009                -1.275021e-02 3 1  ON 8
ci_010                -1.294768e-02 3 1  ON 9
ci_011                -1.030612e-02 3 1  ON 10
ci_012                -1.031514e-02 3 1  ON 11
ci_013                 9.236847e-03 3 1  ON 12
ci_014                 9.317078e-03 3 1  ON 13
ci_015                 9.766241e-03 3 1  ON 14
ci_016                 1.017629e-02 3 1  ON 15
ci_017                 8.690250e-03 3 1  ON 16
ci_018                 8.740277e-03 3 1  ON 17
ci_019                -4.706389e-04 3 1  ON 18
ci_020                -2.177822e-04 3 1  ON 19
ci_021                -9.768406e-03 3 1  ON 20
ci_022                -1.049403e-02 3 1  ON 21
ci_023                 5.624374e-03 3 1  ON 22
ci_024                 5.155664e-03 3 1  ON 23
ci_025                 1.262995e-02 3 1  ON 24
ci_026                 1.200662e-02 3 1  ON 25
ci_027                 6.295445e-03 3 1  ON 26
ci_028                 6.367021e-03 3 1  ON 27
ci_029                -3.885928e-03 3 1  ON 28
ci_030                -4.491716e-03 3 1  ON 29
ci_031                 3.394850e-03 3 1  ON 30
ci_032                 2.941320e-03 3 1  ON 31
ci_033                 3.574834e-03 3 1  ON 32
ci_034                 3.493768e-03 3 1  ON 33
ci_035                 2.460241e-03 3 1  ON 34
ci_036                 2.232542e-03 3 1  ON 35
ci_037                 3.472795e-03 3 1  ON 36
ci_038                 3.637452e-03 3 1  ON 37
ci_039                 4.445581e-03 3 1  ON 38
ci_040                 4.440872e-03 3 1  ON 39
ci_041                 2.760110e-03 3 1  ON 40
ci_042                 2.985302e-03 3 1  ON 41
ci_043                 3.591284e-03 3 1  ON 42
ci_044                 3.313606e-03 3 1  ON 43
ci_045                 2.498505e-03 3 1  ON 44
ci_046                 2.850127e-03 3 1  ON 45
ci_047                -1.160591e-03 3 1  ON 46
ci_048                -1.293107e-03 3 1  ON 47
ci_049                 1.140911e-03 3 1  ON 48
ci_050                 9.365060e-04 3 1  ON 49
ci_051                -1.642385e-03 3 1  ON 50
ci_052                -1.762574e-03 3 1  ON 51
ci_053                -2.578448e-03 3 1  ON 52
ci_054                -2.595409e-03 3 1  ON 53
ci_055                -1.811951e-03 3 1  ON 54
ci_056                -1.260062e-03 3 1  ON 55
ci_057                -1.290907e-03 3 1  ON 56
ci_058                -1.007054e-03 3 1  ON 57
ci_059                -4.729737e-04 3 1  ON 58
ci_060                -3.245020e-04 3 1  ON 59
ci_061                -5.738823e-04 3 1  ON 60
ci_062                -5.151108e-04 3 1  ON 61
ci_063                -7.311608e-04 3 1  ON 62
ci_064                -8.278964e-04 3 1  ON 63
ci_065                -1.794624e-03 3 1  ON 64
ci_066                -1.692373e-03 3 1  ON 65
ci_067                -1.460944e-03 3 1  ON 66
ci_068                -1.578202e-03 3 1  ON 67
ci_069                 1.884443e-04 3 1  ON 68
ci_070                 2.571237e-04 3 1  ON 69
ci_071                -1.506210e-03 3 1  ON 70
ci_072                -2.006777e-03 3 1  ON 71
ci_073                 1.793170e-04 3 1  ON 72
ci_074                 2.588822e-04 3 1  ON 73
ci_075                 1.090323e-04 3 1  ON 74
ci_076                 2.681715e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4081e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.5846
    reference variance = 0.611447
====================================================
  Execution time = 2.6031e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5077e-01
  Total weights = 1.955512273e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441112713319
                                         uncertainty =       0.002603217708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441112713319
                                         uncertainty =       0.002603217708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469659633
  error estimate for blocks of size 2^( 2) =       0.000493872948
  error estimate for blocks of size 2^( 3) =       0.000516290659
  error estimate for blocks of size 2^( 4) =       0.000532086287
  error estimate for blocks of size 2^( 5) =       0.000542170382
  error estimate for blocks of size 2^( 6) =       0.000548211061
  error estimate for blocks of size 2^( 7) =       0.000552423960

      target function =      -0.744688448650
              le_mean =     -22.662230832977
             les_mean =     514.027474020222
             stat err =       0.000543722923
             autocorr =       1.340259258643
   target nu stat err =       0.000543722923
   target dn stat err =       0.002868077747
      target stat err =       0.002424403070
              std dev =       0.664199023141
             le_variance =       0.441160342341


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266223083298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744695454109       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744720268975       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744725394020       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744725843411       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744726146823       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744726377040       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744726339295       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744726330071       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744726317122       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744726320607       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744726316623       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744726315990       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 2.198975e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744695454109       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744701888046       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744703193477       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744703305801       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744703380773       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744703436630       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744703426572       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744703424271       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744703421107       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744703422028       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744703421052       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744703420917       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 5.562312e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744695454109       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744697077655       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744697405538       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744697433611       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744697452293       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744697466145       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744697463594       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744697463019       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744697462233       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744697462466       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744697462224       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 1.395829e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0830e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -7.016327e-01 3 1  ON 0
ci_002                -7.061621e-01 3 1  ON 1
ci_003                -5.376986e-02 3 1  ON 2
ci_004                -5.502268e-02 3 1  ON 3
ci_005                 2.030127e-02 3 1  ON 4
ci_006                 2.034183e-02 3 1  ON 5
ci_007                 1.651183e-02 3 1  ON 6
ci_008                 1.651184e-02 3 1  ON 7
ci_009                -1.273612e-02 3 1  ON 8
ci_010                -1.294825e-02 3 1  ON 9
ci_011                -1.026966e-02 3 1  ON 10
ci_012                -1.029448e-02 3 1  ON 11
ci_013                 9.223993e-03 3 1  ON 12
ci_014                 9.320200e-03 3 1  ON 13
ci_015                 9.761308e-03 3 1  ON 14
ci_016                 1.012948e-02 3 1  ON 15
ci_017                 8.674432e-03 3 1  ON 16
ci_018                 8.708671e-03 3 1  ON 17
ci_019                -5.183073e-04 3 1  ON 18
ci_020                -2.617201e-04 3 1  ON 19
ci_021                -9.780429e-03 3 1  ON 20
ci_022                -1.052700e-02 3 1  ON 21
ci_023                 5.614505e-03 3 1  ON 22
ci_024                 5.166148e-03 3 1  ON 23
ci_025                 1.264548e-02 3 1  ON 24
ci_026                 1.204170e-02 3 1  ON 25
ci_027                 6.295995e-03 3 1  ON 26
ci_028                 6.381135e-03 3 1  ON 27
ci_029                -3.877267e-03 3 1  ON 28
ci_030                -4.494900e-03 3 1  ON 29
ci_031                 3.428136e-03 3 1  ON 30
ci_032                 2.972809e-03 3 1  ON 31
ci_033                 3.584653e-03 3 1  ON 32
ci_034                 3.475898e-03 3 1  ON 33
ci_035                 2.453279e-03 3 1  ON 34
ci_036                 2.232479e-03 3 1  ON 35
ci_037                 3.454983e-03 3 1  ON 36
ci_038                 3.632444e-03 3 1  ON 37
ci_039                 4.437579e-03 3 1  ON 38
ci_040                 4.435623e-03 3 1  ON 39
ci_041                 2.769264e-03 3 1  ON 40
ci_042                 2.982509e-03 3 1  ON 41
ci_043                 3.593629e-03 3 1  ON 42
ci_044                 3.303891e-03 3 1  ON 43
ci_045                 2.483629e-03 3 1  ON 44
ci_046                 2.871735e-03 3 1  ON 45
ci_047                -1.148018e-03 3 1  ON 46
ci_048                -1.289084e-03 3 1  ON 47
ci_049                 1.123218e-03 3 1  ON 48
ci_050                 9.346232e-04 3 1  ON 49
ci_051                -1.645543e-03 3 1  ON 50
ci_052                -1.737765e-03 3 1  ON 51
ci_053                -2.565627e-03 3 1  ON 52
ci_054                -2.591391e-03 3 1  ON 53
ci_055                -1.787033e-03 3 1  ON 54
ci_056                -1.274206e-03 3 1  ON 55
ci_057                -1.288300e-03 3 1  ON 56
ci_058                -1.007730e-03 3 1  ON 57
ci_059                -4.660799e-04 3 1  ON 58
ci_060                -3.129136e-04 3 1  ON 59
ci_061                -5.735300e-04 3 1  ON 60
ci_062                -5.111119e-04 3 1  ON 61
ci_063                -7.376816e-04 3 1  ON 62
ci_064                -8.190884e-04 3 1  ON 63
ci_065                -1.788972e-03 3 1  ON 64
ci_066                -1.685641e-03 3 1  ON 65
ci_067                -1.475532e-03 3 1  ON 66
ci_068                -1.569546e-03 3 1  ON 67
ci_069                 1.821932e-04 3 1  ON 68
ci_070                 2.627610e-04 3 1  ON 69
ci_071                -1.498286e-03 3 1  ON 70
ci_072                -2.004343e-03 3 1  ON 71
ci_073                 1.812317e-04 3 1  ON 72
ci_074                 2.578173e-04 3 1  ON 73
ci_075                 1.106863e-04 3 1  ON 74
ci_076                 2.565841e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.659
    reference variance = 0.358619
====================================================
  Execution time = 2.7264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4862e-01
  Total weights = 1.9553e+06
  Execution time = 3.6158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440157942682
                                         uncertainty =       0.002383937233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440157942682
                                         uncertainty =       0.002383937233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469210597
  error estimate for blocks of size 2^( 2) =       0.000492958109
  error estimate for blocks of size 2^( 3) =       0.000515342900
  error estimate for blocks of size 2^( 4) =       0.000531010220
  error estimate for blocks of size 2^( 5) =       0.000538179232
  error estimate for blocks of size 2^( 6) =       0.000540924165
  error estimate for blocks of size 2^( 7) =       0.000544706510

      target function =      -0.746389804333
              le_mean =     -22.661807101143
             les_mean =     514.006188752100
             stat err =       0.000538705032
             autocorr =       1.318154875126
   target nu stat err =       0.000538705032
   target dn stat err =       0.003154824078
      target stat err =       0.002661597995
              std dev =       0.663563990059
             le_variance =       0.440317168903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440084728066
                                         uncertainty =       0.002381088951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440084728066
                                         uncertainty =       0.002381088951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469171510
  error estimate for blocks of size 2^( 2) =       0.000492925777
  error estimate for blocks of size 2^( 3) =       0.000515313503
  error estimate for blocks of size 2^( 4) =       0.000530982865
  error estimate for blocks of size 2^( 5) =       0.000538147154
  error estimate for blocks of size 2^( 6) =       0.000540890556
  error estimate for blocks of size 2^( 7) =       0.000544674504

      target function =      -0.746501760190
              le_mean =     -22.661806879552
             les_mean =     514.006042622049
             stat err =       0.000538673770
             autocorr =       1.318221504775
   target nu stat err =       0.000538673770
   target dn stat err =       0.003150329708
      target stat err =       0.002658763900
              std dev =       0.663508713160
             le_variance =       0.440243812439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440119070015
                                         uncertainty =       0.002382472379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440119070015
                                         uncertainty =       0.002382472379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469189847
  error estimate for blocks of size 2^( 2) =       0.000492940850
  error estimate for blocks of size 2^( 3) =       0.000515327190
  error estimate for blocks of size 2^( 4) =       0.000530995590
  error estimate for blocks of size 2^( 5) =       0.000538162187
  error estimate for blocks of size 2^( 6) =       0.000540906381
  error estimate for blocks of size 2^( 7) =       0.000544689566

      target function =      -0.746481657378
              le_mean =     -22.661806817148
             les_mean =     514.006064219641
             stat err =       0.000538688431
             autocorr =       1.318190223253
   target nu stat err =       0.000538688431
   target dn stat err =       0.003151887829
      target stat err =       0.002659877055
              std dev =       0.663534644944
             le_variance =       0.440278225041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440152932049
                                         uncertainty =       0.002383753632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440152932049
                                         uncertainty =       0.002383753632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469207923
  error estimate for blocks of size 2^( 2) =       0.000492955885
  error estimate for blocks of size 2^( 3) =       0.000515340870
  error estimate for blocks of size 2^( 4) =       0.000531008325
  error estimate for blocks of size 2^( 5) =       0.000538177011
  error estimate for blocks of size 2^( 6) =       0.000540921863
  error estimate for blocks of size 2^( 7) =       0.000544704284

      target function =      -0.746288881167
              le_mean =     -22.661807054546
             les_mean =     514.006309351429
             stat err =       0.000538702871
             autocorr =       1.318159324385
   target nu stat err =       0.000538702871
   target dn stat err =       0.003158153547
      target stat err =       0.002663564077
              std dev =       0.663560207841
             le_variance =       0.440312149431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746389804333        initial
     9.5367e-01     9.5367e+00             2.1990e-04        -0.746501760190  <--
     3.8147e+00     3.8147e+01             5.5623e-05        -0.746481657378
     1.5259e+01     1.5259e+02             1.3958e-05        -0.746288881167

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 4.5388e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -7.016999e-01 3 1  ON 0
ci_002                -7.061321e-01 3 1  ON 1
ci_003                -5.360558e-02 3 1  ON 2
ci_004                -5.489054e-02 3 1  ON 3
ci_005                 2.019446e-02 3 1  ON 4
ci_006                 2.024500e-02 3 1  ON 5
ci_007                 1.639572e-02 3 1  ON 6
ci_008                 1.641615e-02 3 1  ON 7
ci_009                -1.269597e-02 3 1  ON 8
ci_010                -1.295012e-02 3 1  ON 9
ci_011                -1.016514e-02 3 1  ON 10
ci_012                -1.023512e-02 3 1  ON 11
ci_013                 9.187330e-03 3 1  ON 12
ci_014                 9.329594e-03 3 1  ON 13
ci_015                 9.747266e-03 3 1  ON 14
ci_016                 9.994391e-03 3 1  ON 15
ci_017                 8.629223e-03 3 1  ON 16
ci_018                 8.617695e-03 3 1  ON 17
ci_019                -6.559447e-04 3 1  ON 18
ci_020                -3.884097e-04 3 1  ON 19
ci_021                -9.815116e-03 3 1  ON 20
ci_022                -1.062203e-02 3 1  ON 21
ci_023                 5.586381e-03 3 1  ON 22
ci_024                 5.196050e-03 3 1  ON 23
ci_025                 1.269057e-02 3 1  ON 24
ci_026                 1.214301e-02 3 1  ON 25
ci_027                 6.297659e-03 3 1  ON 26
ci_028                 6.421193e-03 3 1  ON 27
ci_029                -3.852411e-03 3 1  ON 28
ci_030                -4.504139e-03 3 1  ON 29
ci_031                 3.524026e-03 3 1  ON 30
ci_032                 3.063690e-03 3 1  ON 31
ci_033                 3.612956e-03 3 1  ON 32
ci_034                 3.424267e-03 3 1  ON 33
ci_035                 2.433297e-03 3 1  ON 34
ci_036                 2.232107e-03 3 1  ON 35
ci_037                 3.403804e-03 3 1  ON 36
ci_038                 3.618284e-03 3 1  ON 37
ci_039                 4.414775e-03 3 1  ON 38
ci_040                 4.420714e-03 3 1  ON 39
ci_041                 2.795466e-03 3 1  ON 40
ci_042                 2.974540e-03 3 1  ON 41
ci_043                 3.600195e-03 3 1  ON 42
ci_044                 3.276062e-03 3 1  ON 43
ci_045                 2.440863e-03 3 1  ON 44
ci_046                 2.934024e-03 3 1  ON 45
ci_047                -1.112229e-03 3 1  ON 46
ci_048                -1.277620e-03 3 1  ON 47
ci_049                 1.072598e-03 3 1  ON 48
ci_050                 9.292387e-04 3 1  ON 49
ci_051                -1.654491e-03 3 1  ON 50
ci_052                -1.666330e-03 3 1  ON 51
ci_053                -2.528945e-03 3 1  ON 52
ci_054                -2.580069e-03 3 1  ON 53
ci_055                -1.715184e-03 3 1  ON 54
ci_056                -1.315114e-03 3 1  ON 55
ci_057                -1.280814e-03 3 1  ON 56
ci_058                -1.009652e-03 3 1  ON 57
ci_059                -4.464361e-04 3 1  ON 58
ci_060                -2.799019e-04 3 1  ON 59
ci_061                -5.723985e-04 3 1  ON 60
ci_062                -4.997149e-04 3 1  ON 61
ci_063                -7.564655e-04 3 1  ON 62
ci_064                -7.937897e-04 3 1  ON 63
ci_065                -1.772657e-03 3 1  ON 64
ci_066                -1.666215e-03 3 1  ON 65
ci_067                -1.517623e-03 3 1  ON 66
ci_068                -1.544616e-03 3 1  ON 67
ci_069                 1.642512e-04 3 1  ON 68
ci_070                 2.789451e-04 3 1  ON 69
ci_071                -1.475460e-03 3 1  ON 70
ci_072                -1.997386e-03 3 1  ON 71
ci_073                 1.866459e-04 3 1  ON 72
ci_074                 2.547334e-04 3 1  ON 73
ci_075                 1.153733e-04 3 1  ON 74
ci_076                 2.233950e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7538
    reference variance = 1.10577
====================================================
  Execution time = 2.6140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5106e-01
  Total weights = 1.955181358e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440913223450
                                         uncertainty =       0.002372978509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440913223450
                                         uncertainty =       0.002372978509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469565919
  error estimate for blocks of size 2^( 2) =       0.000493542647
  error estimate for blocks of size 2^( 3) =       0.000515151144
  error estimate for blocks of size 2^( 4) =       0.000531466714
  error estimate for blocks of size 2^( 5) =       0.000539095254
  error estimate for blocks of size 2^( 6) =       0.000543952969
  error estimate for blocks of size 2^( 7) =       0.000546840083

      target function =      -0.744445058157
              le_mean =     -22.661306593354
             les_mean =     513.985871951115
             stat err =       0.000540338755
             autocorr =       1.324155834835
   target nu stat err =       0.000540338755
   target dn stat err =       0.002675186854
      target stat err =       0.002266102222
              std dev =       0.664066491212
             le_variance =       0.440984304751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266130659335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744451031992       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744517521630       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744530076058       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744532531788       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744533221127       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744533428988       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744533832244       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744533816100       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744533847496       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744533871917       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744533843087       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 6.682746e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744451031992       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744470082806       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744473468020       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744474116097       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744474289764       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744474338753       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744474427612       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744474418380       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744474423878       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744474429099       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 1.870730e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744451031992       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744455975216       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744456837735       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744457001844       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744457045202       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744457057178       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744457078503       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744457075945       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744457077178       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744457078427       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 4.818417e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242190 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0898e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -7.018430e-01 3 1  ON 0
ci_002                -7.060100e-01 3 1  ON 1
ci_003                -5.358408e-02 3 1  ON 2
ci_004                -5.489654e-02 3 1  ON 3
ci_005                 2.004393e-02 3 1  ON 4
ci_006                 2.012570e-02 3 1  ON 5
ci_007                 1.631124e-02 3 1  ON 6
ci_008                 1.625666e-02 3 1  ON 7
ci_009                -1.264402e-02 3 1  ON 8
ci_010                -1.288221e-02 3 1  ON 9
ci_011                -1.010719e-02 3 1  ON 10
ci_012                -1.019911e-02 3 1  ON 11
ci_013                 9.115885e-03 3 1  ON 12
ci_014                 9.181977e-03 3 1  ON 13
ci_015                 9.652701e-03 3 1  ON 14
ci_016                 9.867713e-03 3 1  ON 15
ci_017                 8.628772e-03 3 1  ON 16
ci_018                 8.587009e-03 3 1  ON 17
ci_019                -7.721966e-04 3 1  ON 18
ci_020                -5.754827e-04 3 1  ON 19
ci_021                -9.959560e-03 3 1  ON 20
ci_022                -1.071418e-02 3 1  ON 21
ci_023                 5.572202e-03 3 1  ON 22
ci_024                 5.138564e-03 3 1  ON 23
ci_025                 1.282619e-02 3 1  ON 24
ci_026                 1.218066e-02 3 1  ON 25
ci_027                 6.249171e-03 3 1  ON 26
ci_028                 6.357466e-03 3 1  ON 27
ci_029                -3.845650e-03 3 1  ON 28
ci_030                -4.488088e-03 3 1  ON 29
ci_031                 3.582780e-03 3 1  ON 30
ci_032                 3.172297e-03 3 1  ON 31
ci_033                 3.583051e-03 3 1  ON 32
ci_034                 3.451453e-03 3 1  ON 33
ci_035                 2.369291e-03 3 1  ON 34
ci_036                 2.223873e-03 3 1  ON 35
ci_037                 3.426287e-03 3 1  ON 36
ci_038                 3.552333e-03 3 1  ON 37
ci_039                 4.415475e-03 3 1  ON 38
ci_040                 4.414260e-03 3 1  ON 39
ci_041                 2.816164e-03 3 1  ON 40
ci_042                 2.976121e-03 3 1  ON 41
ci_043                 3.541242e-03 3 1  ON 42
ci_044                 3.206514e-03 3 1  ON 43
ci_045                 2.433280e-03 3 1  ON 44
ci_046                 2.887984e-03 3 1  ON 45
ci_047                -1.115305e-03 3 1  ON 46
ci_048                -1.265543e-03 3 1  ON 47
ci_049                 1.033766e-03 3 1  ON 48
ci_050                 9.039714e-04 3 1  ON 49
ci_051                -1.671084e-03 3 1  ON 50
ci_052                -1.661176e-03 3 1  ON 51
ci_053                -2.543760e-03 3 1  ON 52
ci_054                -2.549051e-03 3 1  ON 53
ci_055                -1.654437e-03 3 1  ON 54
ci_056                -1.404534e-03 3 1  ON 55
ci_057                -1.212168e-03 3 1  ON 56
ci_058                -1.049520e-03 3 1  ON 57
ci_059                -4.222666e-04 3 1  ON 58
ci_060                -2.430830e-04 3 1  ON 59
ci_061                -5.470130e-04 3 1  ON 60
ci_062                -5.341155e-04 3 1  ON 61
ci_063                -6.697897e-04 3 1  ON 62
ci_064                -7.327948e-04 3 1  ON 63
ci_065                -1.801654e-03 3 1  ON 64
ci_066                -1.717212e-03 3 1  ON 65
ci_067                -1.576748e-03 3 1  ON 66
ci_068                -1.526583e-03 3 1  ON 67
ci_069                 1.929583e-04 3 1  ON 68
ci_070                 2.961827e-04 3 1  ON 69
ci_071                -1.457688e-03 3 1  ON 70
ci_072                -1.975233e-03 3 1  ON 71
ci_073                 1.603328e-04 3 1  ON 72
ci_074                 2.373357e-04 3 1  ON 73
ci_075                 1.107124e-04 3 1  ON 74
ci_076                 2.025742e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.6626
    reference variance = 0.372054
====================================================
  Execution time = 2.5742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5242e-01
  Total weights = 1.9554e+06
  Execution time = 3.6236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441035858625
                                         uncertainty =       0.001942582236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441035858625
                                         uncertainty =       0.001942582236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469686720
  error estimate for blocks of size 2^( 2) =       0.000493262197
  error estimate for blocks of size 2^( 3) =       0.000516132427
  error estimate for blocks of size 2^( 4) =       0.000532323653
  error estimate for blocks of size 2^( 5) =       0.000541299637
  error estimate for blocks of size 2^( 6) =       0.000546735199
  error estimate for blocks of size 2^( 7) =       0.000549601457

      target function =      -0.742620533198
              le_mean =     -22.662928511090
             les_mean =     514.061629611968
             stat err =       0.000542489986
             autocorr =       1.334033972054
   target nu stat err =       0.000542489986
   target dn stat err =       0.003292987747
      target stat err =       0.002750641026
              std dev =       0.664237330072
             le_variance =       0.441211230661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440934756523
                                         uncertainty =       0.001930616927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440934756523
                                         uncertainty =       0.001930616927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469634689
  error estimate for blocks of size 2^( 2) =       0.000493236817
  error estimate for blocks of size 2^( 3) =       0.000516127845
  error estimate for blocks of size 2^( 4) =       0.000532345240
  error estimate for blocks of size 2^( 5) =       0.000541332956
  error estimate for blocks of size 2^( 6) =       0.000546778118
  error estimate for blocks of size 2^( 7) =       0.000549663083

      target function =      -0.743198943612
              le_mean =     -22.662932654380
             les_mean =     514.061110676065
             stat err =       0.000542529850
             autocorr =       1.334525690051
   target nu stat err =       0.000542529850
   target dn stat err =       0.002995669083
      target stat err =       0.002518315742
              std dev =       0.664163747121
             le_variance =       0.441113482990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440966683905
                                         uncertainty =       0.001935551165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440966683905
                                         uncertainty =       0.001935551165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469650887
  error estimate for blocks of size 2^( 2) =       0.000493241819
  error estimate for blocks of size 2^( 3) =       0.000516124229
  error estimate for blocks of size 2^( 4) =       0.000532329740
  error estimate for blocks of size 2^( 5) =       0.000541312808
  error estimate for blocks of size 2^( 6) =       0.000546753585
  error estimate for blocks of size 2^( 7) =       0.000549629956

      target function =      -0.743254152113
              le_mean =     -22.662929311103
             les_mean =     514.060891389719
             stat err =       0.000542506522
             autocorr =       1.334318888043
   target nu stat err =       0.000542506522
   target dn stat err =       0.003021712316
      target stat err =       0.002539335495
              std dev =       0.664186654115
             le_variance =       0.441143911505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441025230833
                                         uncertainty =       0.001941633056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441025230833
                                         uncertainty =       0.001941633056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469681188
  error estimate for blocks of size 2^( 2) =       0.000493258660
  error estimate for blocks of size 2^( 3) =       0.000516130523
  error estimate for blocks of size 2^( 4) =       0.000532323613
  error estimate for blocks of size 2^( 5) =       0.000541300465
  error estimate for blocks of size 2^( 6) =       0.000546736810
  error estimate for blocks of size 2^( 7) =       0.000549604536

      target function =      -0.742936829838
              le_mean =     -22.662928495397
             les_mean =     514.061241826390
             stat err =       0.000542491356
             autocorr =       1.334072133892
   target nu stat err =       0.000542491356
   target dn stat err =       0.003203462063
      target stat err =       0.002681639070
              std dev =       0.664229506543
             le_variance =       0.441200837362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742620533198        initial
     2.3842e-01     2.3842e+00             6.6827e-04        -0.743198943612
     9.5367e-01     9.5367e+00             1.8707e-04        -0.743254152113  <--
     3.8147e+00     3.8147e+01             4.8184e-05        -0.742936829838

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 4.3917e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -7.018430e-01 3 1  ON 0
ci_002                -7.060100e-01 3 1  ON 1
ci_003                -5.358408e-02 3 1  ON 2
ci_004                -5.489654e-02 3 1  ON 3
ci_005                 2.004393e-02 3 1  ON 4
ci_006                 2.012570e-02 3 1  ON 5
ci_007                 1.631124e-02 3 1  ON 6
ci_008                 1.625666e-02 3 1  ON 7
ci_009                -1.264402e-02 3 1  ON 8
ci_010                -1.288221e-02 3 1  ON 9
ci_011                -1.010719e-02 3 1  ON 10
ci_012                -1.019911e-02 3 1  ON 11
ci_013                 9.115885e-03 3 1  ON 12
ci_014                 9.181977e-03 3 1  ON 13
ci_015                 9.652701e-03 3 1  ON 14
ci_016                 9.867713e-03 3 1  ON 15
ci_017                 8.628772e-03 3 1  ON 16
ci_018                 8.587009e-03 3 1  ON 17
ci_019                -7.721966e-04 3 1  ON 18
ci_020                -5.754827e-04 3 1  ON 19
ci_021                -9.959560e-03 3 1  ON 20
ci_022                -1.071418e-02 3 1  ON 21
ci_023                 5.572202e-03 3 1  ON 22
ci_024                 5.138564e-03 3 1  ON 23
ci_025                 1.282619e-02 3 1  ON 24
ci_026                 1.218066e-02 3 1  ON 25
ci_027                 6.249171e-03 3 1  ON 26
ci_028                 6.357466e-03 3 1  ON 27
ci_029                -3.845650e-03 3 1  ON 28
ci_030                -4.488088e-03 3 1  ON 29
ci_031                 3.582780e-03 3 1  ON 30
ci_032                 3.172297e-03 3 1  ON 31
ci_033                 3.583051e-03 3 1  ON 32
ci_034                 3.451453e-03 3 1  ON 33
ci_035                 2.369291e-03 3 1  ON 34
ci_036                 2.223873e-03 3 1  ON 35
ci_037                 3.426287e-03 3 1  ON 36
ci_038                 3.552333e-03 3 1  ON 37
ci_039                 4.415475e-03 3 1  ON 38
ci_040                 4.414260e-03 3 1  ON 39
ci_041                 2.816164e-03 3 1  ON 40
ci_042                 2.976121e-03 3 1  ON 41
ci_043                 3.541242e-03 3 1  ON 42
ci_044                 3.206514e-03 3 1  ON 43
ci_045                 2.433280e-03 3 1  ON 44
ci_046                 2.887984e-03 3 1  ON 45
ci_047                -1.115305e-03 3 1  ON 46
ci_048                -1.265543e-03 3 1  ON 47
ci_049                 1.033766e-03 3 1  ON 48
ci_050                 9.039714e-04 3 1  ON 49
ci_051                -1.671084e-03 3 1  ON 50
ci_052                -1.661176e-03 3 1  ON 51
ci_053                -2.543760e-03 3 1  ON 52
ci_054                -2.549051e-03 3 1  ON 53
ci_055                -1.654437e-03 3 1  ON 54
ci_056                -1.404534e-03 3 1  ON 55
ci_057                -1.212168e-03 3 1  ON 56
ci_058                -1.049520e-03 3 1  ON 57
ci_059                -4.222666e-04 3 1  ON 58
ci_060                -2.430830e-04 3 1  ON 59
ci_061                -5.470130e-04 3 1  ON 60
ci_062                -5.341155e-04 3 1  ON 61
ci_063                -6.697897e-04 3 1  ON 62
ci_064                -7.327948e-04 3 1  ON 63
ci_065                -1.801654e-03 3 1  ON 64
ci_066                -1.717212e-03 3 1  ON 65
ci_067                -1.576748e-03 3 1  ON 66
ci_068                -1.526583e-03 3 1  ON 67
ci_069                 1.929583e-04 3 1  ON 68
ci_070                 2.961827e-04 3 1  ON 69
ci_071                -1.457688e-03 3 1  ON 70
ci_072                -1.975233e-03 3 1  ON 71
ci_073                 1.603328e-04 3 1  ON 72
ci_074                 2.373357e-04 3 1  ON 73
ci_075                 1.107124e-04 3 1  ON 74
ci_076                 2.025742e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4839e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6346
    reference variance = 0.670778
====================================================
  Execution time = 2.6187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5446e-01
  Total weights = 1.955113664e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443273353273
                                         uncertainty =       0.003146809397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443273353273
                                         uncertainty =       0.003146809397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470826969
  error estimate for blocks of size 2^( 2) =       0.000495013232
  error estimate for blocks of size 2^( 3) =       0.000517060045
  error estimate for blocks of size 2^( 4) =       0.000532347199
  error estimate for blocks of size 2^( 5) =       0.000541953496
  error estimate for blocks of size 2^( 6) =       0.000546218770
  error estimate for blocks of size 2^( 7) =       0.000547800842

      target function =      -0.741666530769
              le_mean =     -22.661528286458
             les_mean =     513.999324621919
             stat err =       0.000542080077
             autocorr =       1.325574768189
   target nu stat err =       0.000542080077
   target dn stat err =       0.003822720664
      target stat err =       0.003159136259
              std dev =       0.665849885390
             le_variance =       0.443356069874


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266152828646e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741679087297       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741775270819       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741792831504       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741793890466       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741794132204       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741794578131       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741794668240       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741794629299       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741794614230       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741794646178       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741794660478       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741794661049       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 6.721333e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741679087297       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741706586018       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741711338218       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741711592313       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741711649239       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741711756707       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741711773071       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741711762889       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741711759954       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741711768036       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741711770445       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 1.900582e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741679087297       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741686217911       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741687430071       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741687492507       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741687506425       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741687532930       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741687536604       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741687534059       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741687533388       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741687535407       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741687535922       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 4.910959e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251795 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0912e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -7.018819e-01 3 1  ON 0
ci_002                -7.059905e-01 3 1  ON 1
ci_003                -5.355565e-02 3 1  ON 2
ci_004                -5.500175e-02 3 1  ON 3
ci_005                 1.994898e-02 3 1  ON 4
ci_006                 2.000599e-02 3 1  ON 5
ci_007                 1.623417e-02 3 1  ON 6
ci_008                 1.606660e-02 3 1  ON 7
ci_009                -1.263132e-02 3 1  ON 8
ci_010                -1.270430e-02 3 1  ON 9
ci_011                -1.010092e-02 3 1  ON 10
ci_012                -1.007202e-02 3 1  ON 11
ci_013                 8.943916e-03 3 1  ON 12
ci_014                 9.076322e-03 3 1  ON 13
ci_015                 9.558978e-03 3 1  ON 14
ci_016                 9.730217e-03 3 1  ON 15
ci_017                 8.631098e-03 3 1  ON 16
ci_018                 8.647594e-03 3 1  ON 17
ci_019                -8.298713e-04 3 1  ON 18
ci_020                -7.195276e-04 3 1  ON 19
ci_021                -1.008745e-02 3 1  ON 20
ci_022                -1.077746e-02 3 1  ON 21
ci_023                 5.464865e-03 3 1  ON 22
ci_024                 5.016334e-03 3 1  ON 23
ci_025                 1.279651e-02 3 1  ON 24
ci_026                 1.217909e-02 3 1  ON 25
ci_027                 6.227187e-03 3 1  ON 26
ci_028                 6.363616e-03 3 1  ON 27
ci_029                -3.841862e-03 3 1  ON 28
ci_030                -4.371727e-03 3 1  ON 29
ci_031                 3.722057e-03 3 1  ON 30
ci_032                 3.233624e-03 3 1  ON 31
ci_033                 3.597966e-03 3 1  ON 32
ci_034                 3.416688e-03 3 1  ON 33
ci_035                 2.361882e-03 3 1  ON 34
ci_036                 2.183035e-03 3 1  ON 35
ci_037                 3.318315e-03 3 1  ON 36
ci_038                 3.546819e-03 3 1  ON 37
ci_039                 4.389998e-03 3 1  ON 38
ci_040                 4.387006e-03 3 1  ON 39
ci_041                 2.769149e-03 3 1  ON 40
ci_042                 3.012583e-03 3 1  ON 41
ci_043                 3.471537e-03 3 1  ON 42
ci_044                 3.200383e-03 3 1  ON 43
ci_045                 2.449114e-03 3 1  ON 44
ci_046                 2.843125e-03 3 1  ON 45
ci_047                -1.106543e-03 3 1  ON 46
ci_048                -1.293312e-03 3 1  ON 47
ci_049                 1.043316e-03 3 1  ON 48
ci_050                 1.019486e-03 3 1  ON 49
ci_051                -1.602948e-03 3 1  ON 50
ci_052                -1.604791e-03 3 1  ON 51
ci_053                -2.537449e-03 3 1  ON 52
ci_054                -2.423331e-03 3 1  ON 53
ci_055                -1.566470e-03 3 1  ON 54
ci_056                -1.333534e-03 3 1  ON 55
ci_057                -1.190078e-03 3 1  ON 56
ci_058                -1.015970e-03 3 1  ON 57
ci_059                -3.965663e-04 3 1  ON 58
ci_060                -2.069592e-04 3 1  ON 59
ci_061                -5.734930e-04 3 1  ON 60
ci_062                -5.512123e-04 3 1  ON 61
ci_063                -7.390993e-04 3 1  ON 62
ci_064                -6.819148e-04 3 1  ON 63
ci_065                -1.803516e-03 3 1  ON 64
ci_066                -1.753730e-03 3 1  ON 65
ci_067                -1.667772e-03 3 1  ON 66
ci_068                -1.567491e-03 3 1  ON 67
ci_069                 2.086567e-04 3 1  ON 68
ci_070                 2.857063e-04 3 1  ON 69
ci_071                -1.486647e-03 3 1  ON 70
ci_072                -1.949771e-03 3 1  ON 71
ci_073                 1.662995e-04 3 1  ON 72
ci_074                 1.947624e-04 3 1  ON 73
ci_075                 1.575452e-04 3 1  ON 74
ci_076                 2.185560e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.5874
    reference variance = 0.338447
====================================================
  Execution time = 2.5638e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.9011e-01
  Total weights = 1.9550e+06
  Execution time = 3.6203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478482238623
                                         uncertainty =       0.035061674747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478482238623
                                         uncertainty =       0.035061674747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489125735
  error estimate for blocks of size 2^( 2) =       0.000512535149
  error estimate for blocks of size 2^( 3) =       0.000534043815
  error estimate for blocks of size 2^( 4) =       0.000549078656
  error estimate for blocks of size 2^( 5) =       0.000556544063
  error estimate for blocks of size 2^( 6) =       0.000559914732
  error estimate for blocks of size 2^( 7) =       0.000561164131

      target function =      -0.712600567947
              le_mean =     -22.662931819438
             les_mean =     514.098763820629
             stat err =       0.000556675395
             autocorr =       1.295278106583
   target nu stat err =       0.000556675395
   target dn stat err =       0.036422171584
      target stat err =       0.027394918013
              std dev =       0.691728248692
             le_variance =       0.478487970039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478774543933
                                         uncertainty =       0.035287793661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478774543933
                                         uncertainty =       0.035287793661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489275769
  error estimate for blocks of size 2^( 2) =       0.000512703823
  error estimate for blocks of size 2^( 3) =       0.000534227242
  error estimate for blocks of size 2^( 4) =       0.000549285113
  error estimate for blocks of size 2^( 5) =       0.000556715435
  error estimate for blocks of size 2^( 6) =       0.000560034368
  error estimate for blocks of size 2^( 7) =       0.000561254924

      target function =      -0.554816188779
              le_mean =     -22.662928571332
             les_mean =     514.326695122235
             stat err =       0.000556822460
             autocorr =       1.295167903290
   target nu stat err =       0.000556822460
   target dn stat err =       0.225513547083
      target stat err =       0.106419750935
              std dev =       0.691940427720
             le_variance =       0.478781555513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478546687390
                                         uncertainty =       0.035189737941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478546687390
                                         uncertainty =       0.035189737941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489159040
  error estimate for blocks of size 2^( 2) =       0.000512578947
  error estimate for blocks of size 2^( 3) =       0.000534097470
  error estimate for blocks of size 2^( 4) =       0.000549142064
  error estimate for blocks of size 2^( 5) =       0.000556602055
  error estimate for blocks of size 2^( 6) =       0.000559962679
  error estimate for blocks of size 2^( 7) =       0.000561194410

      target function =      -0.709206022258
              le_mean =     -22.662934309064
             les_mean =     514.103404150960
             stat err =       0.000556725302
             autocorr =       1.295333960582
   target nu stat err =       0.000556725302
   target dn stat err =       0.036702448719
      target stat err =       0.027343648735
              std dev =       0.691775347848
             le_variance =       0.478553131890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478488287294
                                         uncertainty =       0.035078087976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478488287294
                                         uncertainty =       0.035078087976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489128875
  error estimate for blocks of size 2^( 2) =       0.000512539651
  error estimate for blocks of size 2^( 3) =       0.000534049901
  error estimate for blocks of size 2^( 4) =       0.000549086061
  error estimate for blocks of size 2^( 5) =       0.000556550622
  error estimate for blocks of size 2^( 6) =       0.000559920484
  error estimate for blocks of size 2^( 7) =       0.000561167829

      target function =      -0.712516119455
              le_mean =     -22.662931851258
             les_mean =     514.098876547490
             stat err =       0.000556681249
             autocorr =       1.295288720919
   target nu stat err =       0.000556681249
   target dn stat err =       0.036439964425
      target stat err =       0.027401831614
              std dev =       0.691732688197
             le_variance =       0.478494111920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712600567947        initial  <--
     2.3842e-01     2.3842e+00             6.7213e-04        -0.554816188779
     9.5367e-01     9.5367e+00             1.9006e-04        -0.709206022258
     3.8147e+00     3.8147e+01             4.9110e-05        -0.712516119455

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7461
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -7.018430e-01 3 1  ON 0
ci_002                -7.060100e-01 3 1  ON 1
ci_003                -5.358408e-02 3 1  ON 2
ci_004                -5.489654e-02 3 1  ON 3
ci_005                 2.004393e-02 3 1  ON 4
ci_006                 2.012570e-02 3 1  ON 5
ci_007                 1.631124e-02 3 1  ON 6
ci_008                 1.625666e-02 3 1  ON 7
ci_009                -1.264402e-02 3 1  ON 8
ci_010                -1.288221e-02 3 1  ON 9
ci_011                -1.010719e-02 3 1  ON 10
ci_012                -1.019911e-02 3 1  ON 11
ci_013                 9.115885e-03 3 1  ON 12
ci_014                 9.181977e-03 3 1  ON 13
ci_015                 9.652701e-03 3 1  ON 14
ci_016                 9.867713e-03 3 1  ON 15
ci_017                 8.628772e-03 3 1  ON 16
ci_018                 8.587009e-03 3 1  ON 17
ci_019                -7.721966e-04 3 1  ON 18
ci_020                -5.754827e-04 3 1  ON 19
ci_021                -9.959560e-03 3 1  ON 20
ci_022                -1.071418e-02 3 1  ON 21
ci_023                 5.572202e-03 3 1  ON 22
ci_024                 5.138564e-03 3 1  ON 23
ci_025                 1.282619e-02 3 1  ON 24
ci_026                 1.218066e-02 3 1  ON 25
ci_027                 6.249171e-03 3 1  ON 26
ci_028                 6.357466e-03 3 1  ON 27
ci_029                -3.845650e-03 3 1  ON 28
ci_030                -4.488088e-03 3 1  ON 29
ci_031                 3.582780e-03 3 1  ON 30
ci_032                 3.172297e-03 3 1  ON 31
ci_033                 3.583051e-03 3 1  ON 32
ci_034                 3.451453e-03 3 1  ON 33
ci_035                 2.369291e-03 3 1  ON 34
ci_036                 2.223873e-03 3 1  ON 35
ci_037                 3.426287e-03 3 1  ON 36
ci_038                 3.552333e-03 3 1  ON 37
ci_039                 4.415475e-03 3 1  ON 38
ci_040                 4.414260e-03 3 1  ON 39
ci_041                 2.816164e-03 3 1  ON 40
ci_042                 2.976121e-03 3 1  ON 41
ci_043                 3.541242e-03 3 1  ON 42
ci_044                 3.206514e-03 3 1  ON 43
ci_045                 2.433280e-03 3 1  ON 44
ci_046                 2.887984e-03 3 1  ON 45
ci_047                -1.115305e-03 3 1  ON 46
ci_048                -1.265543e-03 3 1  ON 47
ci_049                 1.033766e-03 3 1  ON 48
ci_050                 9.039714e-04 3 1  ON 49
ci_051                -1.671084e-03 3 1  ON 50
ci_052                -1.661176e-03 3 1  ON 51
ci_053                -2.543760e-03 3 1  ON 52
ci_054                -2.549051e-03 3 1  ON 53
ci_055                -1.654437e-03 3 1  ON 54
ci_056                -1.404534e-03 3 1  ON 55
ci_057                -1.212168e-03 3 1  ON 56
ci_058                -1.049520e-03 3 1  ON 57
ci_059                -4.222666e-04 3 1  ON 58
ci_060                -2.430830e-04 3 1  ON 59
ci_061                -5.470130e-04 3 1  ON 60
ci_062                -5.341155e-04 3 1  ON 61
ci_063                -6.697897e-04 3 1  ON 62
ci_064                -7.327948e-04 3 1  ON 63
ci_065                -1.801654e-03 3 1  ON 64
ci_066                -1.717212e-03 3 1  ON 65
ci_067                -1.576748e-03 3 1  ON 66
ci_068                -1.526583e-03 3 1  ON 67
ci_069                 1.929583e-04 3 1  ON 68
ci_070                 2.961827e-04 3 1  ON 69
ci_071                -1.457688e-03 3 1  ON 70
ci_072                -1.975233e-03 3 1  ON 71
ci_073                 1.603328e-04 3 1  ON 72
ci_074                 2.373357e-04 3 1  ON 73
ci_075                 1.107124e-04 3 1  ON 74
ci_076                 2.025742e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4675e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6853
    reference variance = 0.276229
====================================================
  Execution time = 2.5932e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4273e-01
  Total weights = 1.955643133e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435183467470
                                         uncertainty =       0.001940872746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435183467470
                                         uncertainty =       0.001940872746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466425208
  error estimate for blocks of size 2^( 2) =       0.000490632173
  error estimate for blocks of size 2^( 3) =       0.000512863623
  error estimate for blocks of size 2^( 4) =       0.000528797865
  error estimate for blocks of size 2^( 5) =       0.000538348627
  error estimate for blocks of size 2^( 6) =       0.000543484777
  error estimate for blocks of size 2^( 7) =       0.000546409595

      target function =      -0.751327688413
              le_mean =     -22.661665178031
             les_mean =     513.993794119320
             stat err =       0.000539260216
             autocorr =       1.336696267747
   target nu stat err =       0.000539260216
   target dn stat err =       0.002077987254
      target stat err =       0.001831639326
              std dev =       0.659624854306
             le_variance =       0.435104948418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266166517803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751331221972       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751337230741       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751338042214       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751338156351       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751338159586       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751338160609       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751338162565       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751338165562       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751338165743       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751338166825       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 9.339395e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751331221972       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751332746392       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751332950372       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751332978944       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751332979721       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751332979971       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751332980458       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751332981199       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751332981246       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751332981513       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 2.363659e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751331221972       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751331604492       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751331655556       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751331662701       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751331662894       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751331662955       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751331663077       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751331663262       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751331663274       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751331663340       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 5.927433e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0718e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -7.018457e-01 3 1  ON 0
ci_002                -7.060085e-01 3 1  ON 1
ci_003                -5.358642e-02 3 1  ON 2
ci_004                -5.489832e-02 3 1  ON 3
ci_005                 2.003592e-02 3 1  ON 4
ci_006                 2.011567e-02 3 1  ON 5
ci_007                 1.630023e-02 3 1  ON 6
ci_008                 1.625254e-02 3 1  ON 7
ci_009                -1.264177e-02 3 1  ON 8
ci_010                -1.287879e-02 3 1  ON 9
ci_011                -1.009918e-02 3 1  ON 10
ci_012                -1.019125e-02 3 1  ON 11
ci_013                 9.110121e-03 3 1  ON 12
ci_014                 9.170680e-03 3 1  ON 13
ci_015                 9.642575e-03 3 1  ON 14
ci_016                 9.850874e-03 3 1  ON 15
ci_017                 8.631382e-03 3 1  ON 16
ci_018                 8.589287e-03 3 1  ON 17
ci_019                -7.958332e-04 3 1  ON 18
ci_020                -5.893406e-04 3 1  ON 19
ci_021                -9.971890e-03 3 1  ON 20
ci_022                -1.071546e-02 3 1  ON 21
ci_023                 5.572891e-03 3 1  ON 22
ci_024                 5.136943e-03 3 1  ON 23
ci_025                 1.283201e-02 3 1  ON 24
ci_026                 1.218223e-02 3 1  ON 25
ci_027                 6.246034e-03 3 1  ON 26
ci_028                 6.357277e-03 3 1  ON 27
ci_029                -3.840069e-03 3 1  ON 28
ci_030                -4.487925e-03 3 1  ON 29
ci_031                 3.598791e-03 3 1  ON 30
ci_032                 3.173250e-03 3 1  ON 31
ci_033                 3.583283e-03 3 1  ON 32
ci_034                 3.452302e-03 3 1  ON 33
ci_035                 2.366715e-03 3 1  ON 34
ci_036                 2.224702e-03 3 1  ON 35
ci_037                 3.428200e-03 3 1  ON 36
ci_038                 3.548510e-03 3 1  ON 37
ci_039                 4.416126e-03 3 1  ON 38
ci_040                 4.414226e-03 3 1  ON 39
ci_041                 2.818706e-03 3 1  ON 40
ci_042                 2.975680e-03 3 1  ON 41
ci_043                 3.538817e-03 3 1  ON 42
ci_044                 3.205948e-03 3 1  ON 43
ci_045                 2.433052e-03 3 1  ON 44
ci_046                 2.882756e-03 3 1  ON 45
ci_047                -1.118232e-03 3 1  ON 46
ci_048                -1.263593e-03 3 1  ON 47
ci_049                 1.034919e-03 3 1  ON 48
ci_050                 9.045243e-04 3 1  ON 49
ci_051                -1.673167e-03 3 1  ON 50
ci_052                -1.659169e-03 3 1  ON 51
ci_053                -2.545116e-03 3 1  ON 52
ci_054                -2.545014e-03 3 1  ON 53
ci_055                -1.649716e-03 3 1  ON 54
ci_056                -1.401360e-03 3 1  ON 55
ci_057                -1.208677e-03 3 1  ON 56
ci_058                -1.053426e-03 3 1  ON 57
ci_059                -4.231119e-04 3 1  ON 58
ci_060                -2.448443e-04 3 1  ON 59
ci_061                -5.430783e-04 3 1  ON 60
ci_062                -5.368795e-04 3 1  ON 61
ci_063                -6.683787e-04 3 1  ON 62
ci_064                -7.322000e-04 3 1  ON 63
ci_065                -1.801484e-03 3 1  ON 64
ci_066                -1.718673e-03 3 1  ON 65
ci_067                -1.572317e-03 3 1  ON 66
ci_068                -1.520930e-03 3 1  ON 67
ci_069                 1.890480e-04 3 1  ON 68
ci_070                 2.993728e-04 3 1  ON 69
ci_071                -1.454486e-03 3 1  ON 70
ci_072                -1.976982e-03 3 1  ON 71
ci_073                 1.608008e-04 3 1  ON 72
ci_074                 2.320689e-04 3 1  ON 73
ci_075                 1.134412e-04 3 1  ON 74
ci_076                 2.041738e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6934
    reference variance = 0.796859
====================================================
  Execution time = 2.5322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5547e-01
  Total weights = 1.9550e+06
  Execution time = 3.6060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442627525864
                                         uncertainty =       0.002507956760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442627525864
                                         uncertainty =       0.002507956760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470498676
  error estimate for blocks of size 2^( 2) =       0.000494281376
  error estimate for blocks of size 2^( 3) =       0.000516207154
  error estimate for blocks of size 2^( 4) =       0.000532346040
  error estimate for blocks of size 2^( 5) =       0.000542675473
  error estimate for blocks of size 2^( 6) =       0.000547862304
  error estimate for blocks of size 2^( 7) =       0.000549040105

      target function =      -0.740847981249
              le_mean =     -22.662984917571
             les_mean =     514.066355627544
             stat err =       0.000542980980
             autocorr =       1.331841131196
   target nu stat err =       0.000542980980
   target dn stat err =       0.004452873375
      target stat err =       0.003662875837
              std dev =       0.665385608961
             le_variance =       0.442738008613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442612765350
                                         uncertainty =       0.002509049959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442612765350
                                         uncertainty =       0.002509049959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470490803
  error estimate for blocks of size 2^( 2) =       0.000494275248
  error estimate for blocks of size 2^( 3) =       0.000516201913
  error estimate for blocks of size 2^( 4) =       0.000532340636
  error estimate for blocks of size 2^( 5) =       0.000542671471
  error estimate for blocks of size 2^( 6) =       0.000547856461
  error estimate for blocks of size 2^( 7) =       0.000549035710

      target function =      -0.740574068001
              le_mean =     -22.662984514730
             les_mean =     514.066674427798
             stat err =       0.000542976070
             autocorr =       1.331861615706
   target nu stat err =       0.000542976070
   target dn stat err =       0.004508985448
      target stat err =       0.003705115908
              std dev =       0.665374474279
             le_variance =       0.442723191022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442619954878
                                         uncertainty =       0.002508508900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442619954878
                                         uncertainty =       0.002508508900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470494638
  error estimate for blocks of size 2^( 2) =       0.000494278229
  error estimate for blocks of size 2^( 3) =       0.000516204480
  error estimate for blocks of size 2^( 4) =       0.000532343266
  error estimate for blocks of size 2^( 5) =       0.000542673399
  error estimate for blocks of size 2^( 6) =       0.000547859315
  error estimate for blocks of size 2^( 7) =       0.000549037886

      target function =      -0.740829197212
              le_mean =     -22.662984709985
             les_mean =     514.066369141377
             stat err =       0.000542978466
             autocorr =       1.331851659507
   target nu stat err =       0.000542978466
   target dn stat err =       0.004475481682
      target stat err =       0.003680798896
              std dev =       0.665379898169
             le_variance =       0.442730408888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442626565752
                                         uncertainty =       0.002508025702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442626565752
                                         uncertainty =       0.002508025702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470498164
  error estimate for blocks of size 2^( 2) =       0.000494280976
  error estimate for blocks of size 2^( 3) =       0.000516206813
  error estimate for blocks of size 2^( 4) =       0.000532345687
  error estimate for blocks of size 2^( 5) =       0.000542675208
  error estimate for blocks of size 2^( 6) =       0.000547861924
  error estimate for blocks of size 2^( 7) =       0.000549039822

      target function =      -0.740848128905
              le_mean =     -22.662984889707
             les_mean =     514.066354155343
             stat err =       0.000542980660
             autocorr =       1.331842460033
   target nu stat err =       0.000542980660
   target dn stat err =       0.004455671713
      target stat err =       0.003665118360
              std dev =       0.665384884793
             le_variance =       0.442737044911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740847981249        initial
     2.3842e+00     2.3842e+01             9.3394e-05        -0.740574068001
     9.5367e+00     9.5367e+01             2.3637e-05        -0.740829197212
     3.8147e+01     3.8147e+02             5.9274e-06        -0.740848128905  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 4.3399e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -7.018436e-01 3 1  ON 0
ci_002                -7.060097e-01 3 1  ON 1
ci_003                -5.358466e-02 3 1  ON 2
ci_004                -5.489698e-02 3 1  ON 3
ci_005                 2.004192e-02 3 1  ON 4
ci_006                 2.012318e-02 3 1  ON 5
ci_007                 1.630848e-02 3 1  ON 6
ci_008                 1.625563e-02 3 1  ON 7
ci_009                -1.264346e-02 3 1  ON 8
ci_010                -1.288135e-02 3 1  ON 9
ci_011                -1.010518e-02 3 1  ON 10
ci_012                -1.019714e-02 3 1  ON 11
ci_013                 9.114439e-03 3 1  ON 12
ci_014                 9.179143e-03 3 1  ON 13
ci_015                 9.650162e-03 3 1  ON 14
ci_016                 9.863491e-03 3 1  ON 15
ci_017                 8.629425e-03 3 1  ON 16
ci_018                 8.587579e-03 3 1  ON 17
ci_019                -7.781241e-04 3 1  ON 18
ci_020                -5.789578e-04 3 1  ON 19
ci_021                -9.962652e-03 3 1  ON 20
ci_022                -1.071451e-02 3 1  ON 21
ci_023                 5.572375e-03 3 1  ON 22
ci_024                 5.138157e-03 3 1  ON 23
ci_025                 1.282765e-02 3 1  ON 24
ci_026                 1.218105e-02 3 1  ON 25
ci_027                 6.248383e-03 3 1  ON 26
ci_028                 6.357418e-03 3 1  ON 27
ci_029                -3.844250e-03 3 1  ON 28
ci_030                -4.488047e-03 3 1  ON 29
ci_031                 3.586795e-03 3 1  ON 30
ci_032                 3.172536e-03 3 1  ON 31
ci_033                 3.583109e-03 3 1  ON 32
ci_034                 3.451666e-03 3 1  ON 33
ci_035                 2.368645e-03 3 1  ON 34
ci_036                 2.224081e-03 3 1  ON 35
ci_037                 3.426767e-03 3 1  ON 36
ci_038                 3.551374e-03 3 1  ON 37
ci_039                 4.415638e-03 3 1  ON 38
ci_040                 4.414252e-03 3 1  ON 39
ci_041                 2.816802e-03 3 1  ON 40
ci_042                 2.976010e-03 3 1  ON 41
ci_043                 3.540634e-03 3 1  ON 42
ci_044                 3.206373e-03 3 1  ON 43
ci_045                 2.433223e-03 3 1  ON 44
ci_046                 2.886672e-03 3 1  ON 45
ci_047                -1.116040e-03 3 1  ON 46
ci_048                -1.265053e-03 3 1  ON 47
ci_049                 1.034055e-03 3 1  ON 48
ci_050                 9.041101e-04 3 1  ON 49
ci_051                -1.671607e-03 3 1  ON 50
ci_052                -1.660673e-03 3 1  ON 51
ci_053                -2.544100e-03 3 1  ON 52
ci_054                -2.548038e-03 3 1  ON 53
ci_055                -1.653252e-03 3 1  ON 54
ci_056                -1.403737e-03 3 1  ON 55
ci_057                -1.211292e-03 3 1  ON 56
ci_058                -1.050500e-03 3 1  ON 57
ci_059                -4.224789e-04 3 1  ON 58
ci_060                -2.435253e-04 3 1  ON 59
ci_061                -5.460259e-04 3 1  ON 60
ci_062                -5.348089e-04 3 1  ON 61
ci_063                -6.694356e-04 3 1  ON 62
ci_064                -7.326454e-04 3 1  ON 63
ci_065                -1.801611e-03 3 1  ON 64
ci_066                -1.717578e-03 3 1  ON 65
ci_067                -1.575636e-03 3 1  ON 66
ci_068                -1.525165e-03 3 1  ON 67
ci_069                 1.919776e-04 3 1  ON 68
ci_070                 2.969830e-04 3 1  ON 69
ci_071                -1.456885e-03 3 1  ON 70
ci_072                -1.975671e-03 3 1  ON 71
ci_073                 1.604503e-04 3 1  ON 72
ci_074                 2.360136e-04 3 1  ON 73
ci_075                 1.113968e-04 3 1  ON 74
ci_076                 2.029756e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4134e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6514
    reference variance = 0.279878
====================================================
  Execution time = 2.6017e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4511e-01
  Total weights = 1.954996008e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436805620012
                                         uncertainty =       0.001700953977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436805620012
                                         uncertainty =       0.001700953977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467326938
  error estimate for blocks of size 2^( 2) =       0.000491371943
  error estimate for blocks of size 2^( 3) =       0.000513806156
  error estimate for blocks of size 2^( 4) =       0.000529289102
  error estimate for blocks of size 2^( 5) =       0.000538763451
  error estimate for blocks of size 2^( 6) =       0.000544683409
  error estimate for blocks of size 2^( 7) =       0.000547760889

      target function =      -0.749339942050
              le_mean =     -22.661515528904
             les_mean =     513.989399921563
             stat err =       0.000540124213
             autocorr =       1.335812985579
   target nu stat err =       0.000540124213
   target dn stat err =       0.002223403391
      target stat err =       0.001936623379
              std dev =       0.660900094069
             le_variance =       0.436788934340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266151552890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749344019654       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749345615540       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749345904112       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749345937012       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749345960152       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749345954600       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749345956356       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749345964084       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749345965066       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749345965567       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749345965582       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 1.758028e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749344019654       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749344420150       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749344492431       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749344500665       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749344506450       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749344505056       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749344505495       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749344507419       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749344507663       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749344507787       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749344507790       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 4.408433e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749344019654       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749344119874       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749344137953       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749344140012       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749344141458       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749344141109       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749344141219       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749344141699       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749344141760       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749344141791       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749344141792       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+02 is 1.102946e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0771e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -7.018478e-01 3 1  ON 0
ci_002                -7.060060e-01 3 1  ON 1
ci_003                -5.358503e-02 3 1  ON 2
ci_004                -5.489492e-02 3 1  ON 3
ci_005                 2.003928e-02 3 1  ON 4
ci_006                 2.012129e-02 3 1  ON 5
ci_007                 1.630544e-02 3 1  ON 6
ci_008                 1.625458e-02 3 1  ON 7
ci_009                -1.264157e-02 3 1  ON 8
ci_010                -1.287949e-02 3 1  ON 9
ci_011                -1.010297e-02 3 1  ON 10
ci_012                -1.019544e-02 3 1  ON 11
ci_013                 9.111169e-03 3 1  ON 12
ci_014                 9.178391e-03 3 1  ON 13
ci_015                 9.646960e-03 3 1  ON 14
ci_016                 9.862048e-03 3 1  ON 15
ci_017                 8.628605e-03 3 1  ON 16
ci_018                 8.587536e-03 3 1  ON 17
ci_019                -7.825325e-04 3 1  ON 18
ci_020                -5.821954e-04 3 1  ON 19
ci_021                -9.964874e-03 3 1  ON 20
ci_022                -1.071560e-02 3 1  ON 21
ci_023                 5.571653e-03 3 1  ON 22
ci_024                 5.138061e-03 3 1  ON 23
ci_025                 1.282817e-02 3 1  ON 24
ci_026                 1.218390e-02 3 1  ON 25
ci_027                 6.247418e-03 3 1  ON 26
ci_028                 6.358089e-03 3 1  ON 27
ci_029                -3.842414e-03 3 1  ON 28
ci_030                -4.488236e-03 3 1  ON 29
ci_031                 3.588664e-03 3 1  ON 30
ci_032                 3.175445e-03 3 1  ON 31
ci_033                 3.581896e-03 3 1  ON 32
ci_034                 3.451769e-03 3 1  ON 33
ci_035                 2.367420e-03 3 1  ON 34
ci_036                 2.223413e-03 3 1  ON 35
ci_037                 3.425844e-03 3 1  ON 36
ci_038                 3.550473e-03 3 1  ON 37
ci_039                 4.414637e-03 3 1  ON 38
ci_040                 4.414031e-03 3 1  ON 39
ci_041                 2.817407e-03 3 1  ON 40
ci_042                 2.976422e-03 3 1  ON 41
ci_043                 3.539464e-03 3 1  ON 42
ci_044                 3.206015e-03 3 1  ON 43
ci_045                 2.432362e-03 3 1  ON 44
ci_046                 2.886851e-03 3 1  ON 45
ci_047                -1.116709e-03 3 1  ON 46
ci_048                -1.263769e-03 3 1  ON 47
ci_049                 1.031734e-03 3 1  ON 48
ci_050                 9.043518e-04 3 1  ON 49
ci_051                -1.671958e-03 3 1  ON 50
ci_052                -1.660142e-03 3 1  ON 51
ci_053                -2.543441e-03 3 1  ON 52
ci_054                -2.547426e-03 3 1  ON 53
ci_055                -1.655163e-03 3 1  ON 54
ci_056                -1.403301e-03 3 1  ON 55
ci_057                -1.211291e-03 3 1  ON 56
ci_058                -1.050467e-03 3 1  ON 57
ci_059                -4.222018e-04 3 1  ON 58
ci_060                -2.429194e-04 3 1  ON 59
ci_061                -5.441132e-04 3 1  ON 60
ci_062                -5.344085e-04 3 1  ON 61
ci_063                -6.710432e-04 3 1  ON 62
ci_064                -7.309941e-04 3 1  ON 63
ci_065                -1.802012e-03 3 1  ON 64
ci_066                -1.718166e-03 3 1  ON 65
ci_067                -1.575205e-03 3 1  ON 66
ci_068                -1.525559e-03 3 1  ON 67
ci_069                 1.918187e-04 3 1  ON 68
ci_070                 2.970304e-04 3 1  ON 69
ci_071                -1.457673e-03 3 1  ON 70
ci_072                -1.973612e-03 3 1  ON 71
ci_073                 1.600893e-04 3 1  ON 72
ci_074                 2.359642e-04 3 1  ON 73
ci_075                 1.123211e-04 3 1  ON 74
ci_076                 2.037526e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6267
    reference variance = 0.509853
====================================================
  Execution time = 2.7314e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4416e-01
  Total weights = 1.9546e+06
  Execution time = 3.6077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435465108968
                                         uncertainty =       0.002102357026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435465108968
                                         uncertainty =       0.002102357026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466599376
  error estimate for blocks of size 2^( 2) =       0.000490979601
  error estimate for blocks of size 2^( 3) =       0.000512461091
  error estimate for blocks of size 2^( 4) =       0.000528558618
  error estimate for blocks of size 2^( 5) =       0.000537280418
  error estimate for blocks of size 2^( 6) =       0.000542494796
  error estimate for blocks of size 2^( 7) =       0.000544592189

      target function =      -0.750111460201
              le_mean =     -22.661755740745
             les_mean =     513.999359676813
             stat err =       0.000538231505
             autocorr =       1.330607364742
   target nu stat err =       0.000538231505
   target dn stat err =       0.002697949274
      target stat err =       0.002318728286
              std dev =       0.659871166187
             le_variance =       0.435429955964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435463463994
                                         uncertainty =       0.002103986449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435463463994
                                         uncertainty =       0.002103986449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466598499
  error estimate for blocks of size 2^( 2) =       0.000490979249
  error estimate for blocks of size 2^( 3) =       0.000512461379
  error estimate for blocks of size 2^( 4) =       0.000528559018
  error estimate for blocks of size 2^( 5) =       0.000537280537
  error estimate for blocks of size 2^( 6) =       0.000542495420
  error estimate for blocks of size 2^( 7) =       0.000544592995

      target function =      -0.750184759710
              le_mean =     -22.661755707970
             les_mean =     513.999270111553
             stat err =       0.000538231993
             autocorr =       1.330614778582
   target nu stat err =       0.000538231993
   target dn stat err =       0.002670106930
      target stat err =       0.002296821183
              std dev =       0.659869925626
             le_variance =       0.435428318745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435464273915
                                         uncertainty =       0.002103172775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435464273915
                                         uncertainty =       0.002103172775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466598931
  error estimate for blocks of size 2^( 2) =       0.000490979419
  error estimate for blocks of size 2^( 3) =       0.000512461231
  error estimate for blocks of size 2^( 4) =       0.000528558814
  error estimate for blocks of size 2^( 5) =       0.000537280472
  error estimate for blocks of size 2^( 6) =       0.000542495105
  error estimate for blocks of size 2^( 7) =       0.000544592588

      target function =      -0.750149739748
              le_mean =     -22.661755723123
             les_mean =     513.999312878473
             stat err =       0.000538231745
             autocorr =       1.330611088899
   target nu stat err =       0.000538231745
   target dn stat err =       0.002683306266
      target stat err =       0.002307204349
              std dev =       0.659870536394
             le_variance =       0.435429124801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435465003546
                                         uncertainty =       0.002102458960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435465003546
                                         uncertainty =       0.002102458960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466599320
  error estimate for blocks of size 2^( 2) =       0.000490979577
  error estimate for blocks of size 2^( 3) =       0.000512461108
  error estimate for blocks of size 2^( 4) =       0.000528558642
  error estimate for blocks of size 2^( 5) =       0.000537280424
  error estimate for blocks of size 2^( 6) =       0.000542494834
  error estimate for blocks of size 2^( 7) =       0.000544592238

      target function =      -0.750116427333
              le_mean =     -22.661755738408
             les_mean =     513.999353601828
             stat err =       0.000538231535
             autocorr =       1.330607830904
   target nu stat err =       0.000538231535
   target dn stat err =       0.002696038503
      target stat err =       0.002317224255
              std dev =       0.659871086675
             le_variance =       0.435429851029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750111460201        initial
     9.5367e+00     9.5367e+01             1.7580e-05        -0.750184759710  <--
     3.8147e+01     3.8147e+02             4.4084e-06        -0.750149739748
     1.5259e+02     1.5259e+03             1.1029e-06        -0.750116427333

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 4.5393e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -7.018604e-01 3 1  ON 0
ci_002                -7.059951e-01 3 1  ON 1
ci_003                -5.358613e-02 3 1  ON 2
ci_004                -5.488875e-02 3 1  ON 3
ci_005                 2.003143e-02 3 1  ON 4
ci_006                 2.011564e-02 3 1  ON 5
ci_007                 1.629638e-02 3 1  ON 6
ci_008                 1.625144e-02 3 1  ON 7
ci_009                -1.263592e-02 3 1  ON 8
ci_010                -1.287391e-02 3 1  ON 9
ci_011                -1.009637e-02 3 1  ON 10
ci_012                -1.019038e-02 3 1  ON 11
ci_013                 9.101402e-03 3 1  ON 12
ci_014                 9.176144e-03 3 1  ON 13
ci_015                 9.637393e-03 3 1  ON 14
ci_016                 9.857737e-03 3 1  ON 15
ci_017                 8.626155e-03 3 1  ON 16
ci_018                 8.587410e-03 3 1  ON 17
ci_019                -7.957043e-04 3 1  ON 18
ci_020                -5.918690e-04 3 1  ON 19
ci_021                -9.971513e-03 3 1  ON 20
ci_022                -1.071886e-02 3 1  ON 21
ci_023                 5.569499e-03 3 1  ON 22
ci_024                 5.137773e-03 3 1  ON 23
ci_025                 1.282974e-02 3 1  ON 24
ci_026                 1.219242e-02 3 1  ON 25
ci_027                 6.244541e-03 3 1  ON 26
ci_028                 6.360089e-03 3 1  ON 27
ci_029                -3.836927e-03 3 1  ON 28
ci_030                -4.488800e-03 3 1  ON 29
ci_031                 3.594250e-03 3 1  ON 30
ci_032                 3.184135e-03 3 1  ON 31
ci_033                 3.578274e-03 3 1  ON 32
ci_034                 3.452077e-03 3 1  ON 33
ci_035                 2.363766e-03 3 1  ON 34
ci_036                 2.221422e-03 3 1  ON 35
ci_037                 3.423085e-03 3 1  ON 36
ci_038                 3.547783e-03 3 1  ON 37
ci_039                 4.411650e-03 3 1  ON 38
ci_040                 4.413371e-03 3 1  ON 39
ci_041                 2.819212e-03 3 1  ON 40
ci_042                 2.977652e-03 3 1  ON 41
ci_043                 3.535970e-03 3 1  ON 42
ci_044                 3.204946e-03 3 1  ON 43
ci_045                 2.429791e-03 3 1  ON 44
ci_046                 2.887383e-03 3 1  ON 45
ci_047                -1.118705e-03 3 1  ON 46
ci_048                -1.259937e-03 3 1  ON 47
ci_049                 1.024803e-03 3 1  ON 48
ci_050                 9.050741e-04 3 1  ON 49
ci_051                -1.673006e-03 3 1  ON 50
ci_052                -1.658557e-03 3 1  ON 51
ci_053                -2.541475e-03 3 1  ON 52
ci_054                -2.545601e-03 3 1  ON 53
ci_055                -1.660870e-03 3 1  ON 54
ci_056                -1.401997e-03 3 1  ON 55
ci_057                -1.211287e-03 3 1  ON 56
ci_058                -1.050368e-03 3 1  ON 57
ci_059                -4.213741e-04 3 1  ON 58
ci_060                -2.411110e-04 3 1  ON 59
ci_061                -5.384003e-04 3 1  ON 60
ci_062                -5.332104e-04 3 1  ON 61
ci_063                -6.758464e-04 3 1  ON 62
ci_064                -7.260632e-04 3 1  ON 63
ci_065                -1.803209e-03 3 1  ON 64
ci_066                -1.719920e-03 3 1  ON 65
ci_067                -1.573917e-03 3 1  ON 66
ci_068                -1.526736e-03 3 1  ON 67
ci_069                 1.913430e-04 3 1  ON 68
ci_070                 2.971716e-04 3 1  ON 69
ci_071                -1.460023e-03 3 1  ON 70
ci_072                -1.967462e-03 3 1  ON 71
ci_073                 1.590120e-04 3 1  ON 72
ci_074                 2.358161e-04 3 1  ON 73
ci_075                 1.150819e-04 3 1  ON 74
ci_076                 2.060728e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6176e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.6398
    reference variance = 0.309696
====================================================
  Execution time = 2.5967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5210e-01
  Total weights = 1.955305994e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443195025258
                                         uncertainty =       0.002614255675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443195025258
                                         uncertainty =       0.002614255675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470797301
  error estimate for blocks of size 2^( 2) =       0.000494884905
  error estimate for blocks of size 2^( 3) =       0.000517440852
  error estimate for blocks of size 2^( 4) =       0.000533436205
  error estimate for blocks of size 2^( 5) =       0.000542878721
  error estimate for blocks of size 2^( 6) =       0.000549663100
  error estimate for blocks of size 2^( 7) =       0.000549403805

      target function =      -0.743590897759
              le_mean =     -22.661508185401
             les_mean =     513.996053051338
             stat err =       0.000543845458
             autocorr =       1.334390933802
   target nu stat err =       0.000543845458
   target dn stat err =       0.003271651997
      target stat err =       0.002735216009
              std dev =       0.665807927980
             le_variance =       0.443300196961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266150818540e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743599969855       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743606104725       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743607373104       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743607523294       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743607572338       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743607580412       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743607597773       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743607596032       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743607600420       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743607602301       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743607603502       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 7.948972e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743599969855       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743601526210       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743601845621       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743601883205       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743601895418       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743601897340       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743601901602       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743601901151       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743601902240       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743601902693       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743601902981       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 2.011049e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743599969855       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743600360385       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743600440383       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743600449781       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743600452830       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743600453305       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743600454366       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743600454252       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743600454524       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743600454636       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743600454707       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 5.042724e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0717e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -7.018509e-01 3 1  ON 0
ci_002                -7.060076e-01 3 1  ON 1
ci_003                -5.357153e-02 3 1  ON 2
ci_004                -5.487347e-02 3 1  ON 3
ci_005                 2.002092e-02 3 1  ON 4
ci_006                 2.010828e-02 3 1  ON 5
ci_007                 1.629768e-02 3 1  ON 6
ci_008                 1.624288e-02 3 1  ON 7
ci_009                -1.262807e-02 3 1  ON 8
ci_010                -1.287058e-02 3 1  ON 9
ci_011                -1.008777e-02 3 1  ON 10
ci_012                -1.018007e-02 3 1  ON 11
ci_013                 9.092849e-03 3 1  ON 12
ci_014                 9.170989e-03 3 1  ON 13
ci_015                 9.631493e-03 3 1  ON 14
ci_016                 9.841887e-03 3 1  ON 15
ci_017                 8.628942e-03 3 1  ON 16
ci_018                 8.576604e-03 3 1  ON 17
ci_019                -8.021705e-04 3 1  ON 18
ci_020                -6.119795e-04 3 1  ON 19
ci_021                -9.983431e-03 3 1  ON 20
ci_022                -1.073373e-02 3 1  ON 21
ci_023                 5.578146e-03 3 1  ON 22
ci_024                 5.135764e-03 3 1  ON 23
ci_025                 1.284418e-02 3 1  ON 24
ci_026                 1.220912e-02 3 1  ON 25
ci_027                 6.246274e-03 3 1  ON 26
ci_028                 6.356456e-03 3 1  ON 27
ci_029                -3.839397e-03 3 1  ON 28
ci_030                -4.486258e-03 3 1  ON 29
ci_031                 3.603747e-03 3 1  ON 30
ci_032                 3.200811e-03 3 1  ON 31
ci_033                 3.573656e-03 3 1  ON 32
ci_034                 3.450757e-03 3 1  ON 33
ci_035                 2.362731e-03 3 1  ON 34
ci_036                 2.216875e-03 3 1  ON 35
ci_037                 3.421418e-03 3 1  ON 36
ci_038                 3.547829e-03 3 1  ON 37
ci_039                 4.410871e-03 3 1  ON 38
ci_040                 4.416438e-03 3 1  ON 39
ci_041                 2.815963e-03 3 1  ON 40
ci_042                 2.976099e-03 3 1  ON 41
ci_043                 3.533893e-03 3 1  ON 42
ci_044                 3.202738e-03 3 1  ON 43
ci_045                 2.427025e-03 3 1  ON 44
ci_046                 2.886373e-03 3 1  ON 45
ci_047                -1.115865e-03 3 1  ON 46
ci_048                -1.257151e-03 3 1  ON 47
ci_049                 1.015550e-03 3 1  ON 48
ci_050                 9.026025e-04 3 1  ON 49
ci_051                -1.670375e-03 3 1  ON 50
ci_052                -1.653015e-03 3 1  ON 51
ci_053                -2.546814e-03 3 1  ON 52
ci_054                -2.544000e-03 3 1  ON 53
ci_055                -1.652193e-03 3 1  ON 54
ci_056                -1.398972e-03 3 1  ON 55
ci_057                -1.211367e-03 3 1  ON 56
ci_058                -1.052779e-03 3 1  ON 57
ci_059                -4.255096e-04 3 1  ON 58
ci_060                -2.388881e-04 3 1  ON 59
ci_061                -5.385542e-04 3 1  ON 60
ci_062                -5.315209e-04 3 1  ON 61
ci_063                -6.747282e-04 3 1  ON 62
ci_064                -7.261124e-04 3 1  ON 63
ci_065                -1.800119e-03 3 1  ON 64
ci_066                -1.716781e-03 3 1  ON 65
ci_067                -1.578857e-03 3 1  ON 66
ci_068                -1.528119e-03 3 1  ON 67
ci_069                 1.909227e-04 3 1  ON 68
ci_070                 2.915663e-04 3 1  ON 69
ci_071                -1.468156e-03 3 1  ON 70
ci_072                -1.968721e-03 3 1  ON 71
ci_073                 1.634296e-04 3 1  ON 72
ci_074                 2.383182e-04 3 1  ON 73
ci_075                 1.153818e-04 3 1  ON 74
ci_076                 2.075568e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.6626
    reference variance = 0.273194
====================================================
  Execution time = 2.5309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5188e-01
  Total weights = 1.9555e+06
  Execution time = 3.6052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439943109542
                                         uncertainty =       0.002093798055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439943109542
                                         uncertainty =       0.002093798055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468972306
  error estimate for blocks of size 2^( 2) =       0.000492969723
  error estimate for blocks of size 2^( 3) =       0.000515334595
  error estimate for blocks of size 2^( 4) =       0.000530935882
  error estimate for blocks of size 2^( 5) =       0.000540904425
  error estimate for blocks of size 2^( 6) =       0.000547300070
  error estimate for blocks of size 2^( 7) =       0.000551384311

      target function =      -0.743719854248
              le_mean =     -22.662177331415
             les_mean =     514.026230479149
             stat err =       0.000542631172
             autocorr =       1.338798086550
   target nu stat err =       0.000542631172
   target dn stat err =       0.003194624753
      target stat err =       0.002677168065
              std dev =       0.663226994986
             le_variance =       0.439870046878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439922179965
                                         uncertainty =       0.002093921192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439922179965
                                         uncertainty =       0.002093921192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468961135
  error estimate for blocks of size 2^( 2) =       0.000492960774
  error estimate for blocks of size 2^( 3) =       0.000515327116
  error estimate for blocks of size 2^( 4) =       0.000530929197
  error estimate for blocks of size 2^( 5) =       0.000540898279
  error estimate for blocks of size 2^( 6) =       0.000547294072
  error estimate for blocks of size 2^( 7) =       0.000551376372

      target function =      -0.743895261576
              le_mean =     -22.662177441433
             les_mean =     514.026021586812
             stat err =       0.000542624480
             autocorr =       1.338828847555
   target nu stat err =       0.000542624480
   target dn stat err =       0.003082378040
      target stat err =       0.002589031673
              std dev =       0.663211196879
             le_variance =       0.439849091665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439932362928
                                         uncertainty =       0.002093851315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439932362928
                                         uncertainty =       0.002093851315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468966570
  error estimate for blocks of size 2^( 2) =       0.000492965118
  error estimate for blocks of size 2^( 3) =       0.000515330737
  error estimate for blocks of size 2^( 4) =       0.000530932432
  error estimate for blocks of size 2^( 5) =       0.000540901245
  error estimate for blocks of size 2^( 6) =       0.000547296965
  error estimate for blocks of size 2^( 7) =       0.000551380246

      target function =      -0.743822981943
              le_mean =     -22.662177369662
             les_mean =     514.026106415974
             stat err =       0.000542627722
             autocorr =       1.338813811676
   target nu stat err =       0.000542627722
   target dn stat err =       0.003134606112
      target stat err =       0.002630095868
              std dev =       0.663218883437
             le_variance =       0.439859287348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439941746047
                                         uncertainty =       0.002093803961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439941746047
                                         uncertainty =       0.002093803961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468971578
  error estimate for blocks of size 2^( 2) =       0.000492969138
  error estimate for blocks of size 2^( 3) =       0.000515334103
  error estimate for blocks of size 2^( 4) =       0.000530935441
  error estimate for blocks of size 2^( 5) =       0.000540904018
  error estimate for blocks of size 2^( 6) =       0.000547299672
  error estimate for blocks of size 2^( 7) =       0.000551383795

      target function =      -0.743733835831
              le_mean =     -22.662177334160
             les_mean =     514.026213545315
             stat err =       0.000542630732
             autocorr =       1.338800070569
   target nu stat err =       0.000542630732
   target dn stat err =       0.003186729702
      target stat err =       0.002670977887
              std dev =       0.663225965844
             le_variance =       0.439868681770


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743719854248        initial
     2.3842e+00     2.3842e+01             7.9490e-05        -0.743895261576  <--
     9.5367e+00     9.5367e+01             2.0110e-05        -0.743822981943
     3.8147e+01     3.8147e+02             5.0427e-06        -0.743733835831

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 4.3383e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -7.018225e-01 3 1  ON 0
ci_002                -7.060448e-01 3 1  ON 1
ci_003                -5.352797e-02 3 1  ON 2
ci_004                -5.482793e-02 3 1  ON 3
ci_005                 1.999002e-02 3 1  ON 4
ci_006                 2.008668e-02 3 1  ON 5
ci_007                 1.630154e-02 3 1  ON 6
ci_008                 1.621764e-02 3 1  ON 7
ci_009                -1.260494e-02 3 1  ON 8
ci_010                -1.286079e-02 3 1  ON 9
ci_011                -1.006243e-02 3 1  ON 10
ci_012                -1.014970e-02 3 1  ON 11
ci_013                 9.067661e-03 3 1  ON 12
ci_014                 9.155829e-03 3 1  ON 13
ci_015                 9.614096e-03 3 1  ON 14
ci_016                 9.795065e-03 3 1  ON 15
ci_017                 8.637196e-03 3 1  ON 16
ci_018                 8.544734e-03 3 1  ON 17
ci_019                -8.212620e-04 3 1  ON 18
ci_020                -6.713588e-04 3 1  ON 19
ci_021                -1.001860e-02 3 1  ON 20
ci_022                -1.077765e-02 3 1  ON 21
ci_023                 5.603570e-03 3 1  ON 22
ci_024                 5.129859e-03 3 1  ON 23
ci_025                 1.288680e-02 3 1  ON 24
ci_026                 1.225846e-02 3 1  ON 25
ci_027                 6.251360e-03 3 1  ON 26
ci_028                 6.345788e-03 3 1  ON 27
ci_029                -3.846677e-03 3 1  ON 28
ci_030                -4.478774e-03 3 1  ON 29
ci_031                 3.631802e-03 3 1  ON 30
ci_032                 3.250074e-03 3 1  ON 31
ci_033                 3.560037e-03 3 1  ON 32
ci_034                 3.446865e-03 3 1  ON 33
ci_035                 2.359667e-03 3 1  ON 34
ci_036                 2.203509e-03 3 1  ON 35
ci_037                 3.416501e-03 3 1  ON 36
ci_038                 3.547963e-03 3 1  ON 37
ci_039                 4.408578e-03 3 1  ON 38
ci_040                 4.425436e-03 3 1  ON 39
ci_041                 2.806411e-03 3 1  ON 40
ci_042                 2.971546e-03 3 1  ON 41
ci_043                 3.527784e-03 3 1  ON 42
ci_044                 3.196228e-03 3 1  ON 43
ci_045                 2.418886e-03 3 1  ON 44
ci_046                 2.883403e-03 3 1  ON 45
ci_047                -1.107524e-03 3 1  ON 46
ci_048                -1.248964e-03 3 1  ON 47
ci_049                 9.883143e-04 3 1  ON 48
ci_050                 8.953201e-04 3 1  ON 49
ci_051                -1.662604e-03 3 1  ON 50
ci_052                -1.636672e-03 3 1  ON 51
ci_053                -2.562577e-03 3 1  ON 52
ci_054                -2.539311e-03 3 1  ON 53
ci_055                -1.626562e-03 3 1  ON 54
ci_056                -1.390036e-03 3 1  ON 55
ci_057                -1.211600e-03 3 1  ON 56
ci_058                -1.059872e-03 3 1  ON 57
ci_059                -4.376541e-04 3 1  ON 58
ci_060                -2.323552e-04 3 1  ON 59
ci_061                -5.390215e-04 3 1  ON 60
ci_062                -5.265583e-04 3 1  ON 61
ci_063                -6.714546e-04 3 1  ON 62
ci_064                -7.262719e-04 3 1  ON 63
ci_065                -1.790986e-03 3 1  ON 64
ci_066                -1.707516e-03 3 1  ON 65
ci_067                -1.593448e-03 3 1  ON 66
ci_068                -1.532208e-03 3 1  ON 67
ci_069                 1.896826e-04 3 1  ON 68
ci_070                 2.750386e-04 3 1  ON 69
ci_071                -1.492134e-03 3 1  ON 70
ci_072                -1.972425e-03 3 1  ON 71
ci_073                 1.763834e-04 3 1  ON 72
ci_074                 2.456495e-04 3 1  ON 73
ci_075                 1.162721e-04 3 1  ON 74
ci_076                 2.119358e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6046
    reference variance = 0.354834
====================================================
  Execution time = 2.5932e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4950e-01
  Total weights = 1.955391359e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441059447076
                                         uncertainty =       0.004233267568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441059447076
                                         uncertainty =       0.004233267568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469552052
  error estimate for blocks of size 2^( 2) =       0.000493264884
  error estimate for blocks of size 2^( 3) =       0.000516038851
  error estimate for blocks of size 2^( 4) =       0.000532795734
  error estimate for blocks of size 2^( 5) =       0.000541855767
  error estimate for blocks of size 2^( 6) =       0.000546309476
  error estimate for blocks of size 2^( 7) =       0.000547241338

      target function =      -0.745717148399
              le_mean =     -22.662510037293
             les_mean =     514.038857409641
             stat err =       0.000542050579
             autocorr =       1.332637833897
   target nu stat err =       0.000542050579
   target dn stat err =       0.005191249674
      target stat err =       0.004307791526
              std dev =       0.664046880559
             le_variance =       0.440958259579


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266251003729e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745741407196       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745779189041       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745784164314       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745786133708       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745787562367       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745788365011       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745788623382       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745788658664       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745788667769       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745788655346       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745788673048       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745788665486       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 7.666349e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745741407196       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745751405531       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745752684565       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745753184332       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745753536157       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745753716161       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745753773819       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745753781153       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745753783255       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745753780150       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745753784155       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745753782552       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.919291e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745741407196       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745743943897       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745744265874       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745744391244       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745744478799       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745744522471       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745744536459       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745744538204       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745744538719       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745744537944       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745744538919       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 4.799012e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0623e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -7.020145e-01 3 1  ON 0
ci_002                -7.058599e-01 3 1  ON 1
ci_003                -5.355799e-02 3 1  ON 2
ci_004                -5.479864e-02 3 1  ON 3
ci_005                 1.998317e-02 3 1  ON 4
ci_006                 2.003207e-02 3 1  ON 5
ci_007                 1.625883e-02 3 1  ON 6
ci_008                 1.617807e-02 3 1  ON 7
ci_009                -1.258462e-02 3 1  ON 8
ci_010                -1.284179e-02 3 1  ON 9
ci_011                -1.002104e-02 3 1  ON 10
ci_012                -1.011447e-02 3 1  ON 11
ci_013                 9.021748e-03 3 1  ON 12
ci_014                 9.136875e-03 3 1  ON 13
ci_015                 9.553237e-03 3 1  ON 14
ci_016                 9.802819e-03 3 1  ON 15
ci_017                 8.613529e-03 3 1  ON 16
ci_018                 8.511843e-03 3 1  ON 17
ci_019                -8.560140e-04 3 1  ON 18
ci_020                -7.086354e-04 3 1  ON 19
ci_021                -1.009720e-02 3 1  ON 20
ci_022                -1.081557e-02 3 1  ON 21
ci_023                 5.604866e-03 3 1  ON 22
ci_024                 5.113274e-03 3 1  ON 23
ci_025                 1.290018e-02 3 1  ON 24
ci_026                 1.225985e-02 3 1  ON 25
ci_027                 6.269065e-03 3 1  ON 26
ci_028                 6.311005e-03 3 1  ON 27
ci_029                -3.852069e-03 3 1  ON 28
ci_030                -4.536156e-03 3 1  ON 29
ci_031                 3.701818e-03 3 1  ON 30
ci_032                 3.272854e-03 3 1  ON 31
ci_033                 3.519564e-03 3 1  ON 32
ci_034                 3.445998e-03 3 1  ON 33
ci_035                 2.351974e-03 3 1  ON 34
ci_036                 2.188752e-03 3 1  ON 35
ci_037                 3.418384e-03 3 1  ON 36
ci_038                 3.521985e-03 3 1  ON 37
ci_039                 4.408822e-03 3 1  ON 38
ci_040                 4.428779e-03 3 1  ON 39
ci_041                 2.825118e-03 3 1  ON 40
ci_042                 2.981407e-03 3 1  ON 41
ci_043                 3.540975e-03 3 1  ON 42
ci_044                 3.195884e-03 3 1  ON 43
ci_045                 2.402698e-03 3 1  ON 44
ci_046                 2.902335e-03 3 1  ON 45
ci_047                -1.087766e-03 3 1  ON 46
ci_048                -1.242291e-03 3 1  ON 47
ci_049                 9.632216e-04 3 1  ON 48
ci_050                 8.685023e-04 3 1  ON 49
ci_051                -1.655058e-03 3 1  ON 50
ci_052                -1.615966e-03 3 1  ON 51
ci_053                -2.528532e-03 3 1  ON 52
ci_054                -2.531413e-03 3 1  ON 53
ci_055                -1.646985e-03 3 1  ON 54
ci_056                -1.344474e-03 3 1  ON 55
ci_057                -1.174829e-03 3 1  ON 56
ci_058                -1.047969e-03 3 1  ON 57
ci_059                -4.385251e-04 3 1  ON 58
ci_060                -2.290743e-04 3 1  ON 59
ci_061                -5.476003e-04 3 1  ON 60
ci_062                -4.789284e-04 3 1  ON 61
ci_063                -6.593802e-04 3 1  ON 62
ci_064                -7.279767e-04 3 1  ON 63
ci_065                -1.791464e-03 3 1  ON 64
ci_066                -1.686113e-03 3 1  ON 65
ci_067                -1.607561e-03 3 1  ON 66
ci_068                -1.505483e-03 3 1  ON 67
ci_069                 1.876758e-04 3 1  ON 68
ci_070                 2.734946e-04 3 1  ON 69
ci_071                -1.493268e-03 3 1  ON 70
ci_072                -1.951830e-03 3 1  ON 71
ci_073                 1.856151e-04 3 1  ON 72
ci_074                 2.381061e-04 3 1  ON 73
ci_075                 9.379488e-05 3 1  ON 74
ci_076                 2.062517e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6716
    reference variance = 0.621159
====================================================
  Execution time = 2.5405e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5029e-01
  Total weights = 1.9552e+06
  Execution time = 3.6351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440985091924
                                         uncertainty =       0.002761664651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440985091924
                                         uncertainty =       0.002761664651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469604724
  error estimate for blocks of size 2^( 2) =       0.000493634841
  error estimate for blocks of size 2^( 3) =       0.000515972846
  error estimate for blocks of size 2^( 4) =       0.000532181828
  error estimate for blocks of size 2^( 5) =       0.000542076834
  error estimate for blocks of size 2^( 6) =       0.000545816206
  error estimate for blocks of size 2^( 7) =       0.000545597616

      target function =      -0.744922632716
              le_mean =     -22.661212889855
             les_mean =     513.981034719371
             stat err =       0.000541418121
             autocorr =       1.329231611666
   target nu stat err =       0.000541418121
   target dn stat err =       0.003471419826
      target stat err =       0.002902846739
              std dev =       0.664121369063
             le_variance =       0.441057192846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440871065907
                                         uncertainty =       0.002762008673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440871065907
                                         uncertainty =       0.002762008673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469544272
  error estimate for blocks of size 2^( 2) =       0.000493584160
  error estimate for blocks of size 2^( 3) =       0.000515930427
  error estimate for blocks of size 2^( 4) =       0.000532139677
  error estimate for blocks of size 2^( 5) =       0.000542034345
  error estimate for blocks of size 2^( 6) =       0.000545772140
  error estimate for blocks of size 2^( 7) =       0.000545547912

      target function =      -0.744935338531
              le_mean =     -22.661212130622
             les_mean =     513.980983532236
             stat err =       0.000541373518
             autocorr =       1.329354841644
   target nu stat err =       0.000541373518
   target dn stat err =       0.003631269532
      target stat err =       0.003031112865
              std dev =       0.664035878257
             le_variance =       0.440943647612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440922328535
                                         uncertainty =       0.002761773770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440922328535
                                         uncertainty =       0.002761773770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469571440
  error estimate for blocks of size 2^( 2) =       0.000493606818
  error estimate for blocks of size 2^( 3) =       0.000515949250
  error estimate for blocks of size 2^( 4) =       0.000532158403
  error estimate for blocks of size 2^( 5) =       0.000542053408
  error estimate for blocks of size 2^( 6) =       0.000545791821
  error estimate for blocks of size 2^( 7) =       0.000545570283

      target function =      -0.745133554886
              le_mean =     -22.661212194565
             les_mean =     513.980745083457
             stat err =       0.000541393479
             autocorr =       1.329299040892
   target nu stat err =       0.000541393479
   target dn stat err =       0.003533536707
      target stat err =       0.002954258157
              std dev =       0.664074298877
             le_variance =       0.440994674429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440976768543
                                         uncertainty =       0.002761671469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440976768543
                                         uncertainty =       0.002761671469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469600309
  error estimate for blocks of size 2^( 2) =       0.000493631094
  error estimate for blocks of size 2^( 3) =       0.000515969682
  error estimate for blocks of size 2^( 4) =       0.000532178702
  error estimate for blocks of size 2^( 5) =       0.000542073819
  error estimate for blocks of size 2^( 6) =       0.000545813075
  error estimate for blocks of size 2^( 7) =       0.000545594064

      target function =      -0.745123549995
              le_mean =     -22.661212721792
             les_mean =     513.980781674418
             stat err =       0.000541414915
             autocorr =       1.329240860947
   target nu stat err =       0.000541414915
   target dn stat err =       0.003472065977
      target stat err =       0.002904896465
              std dev =       0.664115125867
             le_variance =       0.441048900406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744922632716        initial
     5.9605e-01     5.9605e+00             7.6663e-04        -0.744935338531
     2.3842e+00     2.3842e+01             1.9193e-04        -0.745133554886  <--
     9.5367e+00     9.5367e+01             4.7990e-05        -0.745123549995

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 4.3574e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -7.020145e-01 3 1  ON 0
ci_002                -7.058599e-01 3 1  ON 1
ci_003                -5.355799e-02 3 1  ON 2
ci_004                -5.479864e-02 3 1  ON 3
ci_005                 1.998317e-02 3 1  ON 4
ci_006                 2.003207e-02 3 1  ON 5
ci_007                 1.625883e-02 3 1  ON 6
ci_008                 1.617807e-02 3 1  ON 7
ci_009                -1.258462e-02 3 1  ON 8
ci_010                -1.284179e-02 3 1  ON 9
ci_011                -1.002104e-02 3 1  ON 10
ci_012                -1.011447e-02 3 1  ON 11
ci_013                 9.021748e-03 3 1  ON 12
ci_014                 9.136875e-03 3 1  ON 13
ci_015                 9.553237e-03 3 1  ON 14
ci_016                 9.802819e-03 3 1  ON 15
ci_017                 8.613529e-03 3 1  ON 16
ci_018                 8.511843e-03 3 1  ON 17
ci_019                -8.560140e-04 3 1  ON 18
ci_020                -7.086354e-04 3 1  ON 19
ci_021                -1.009720e-02 3 1  ON 20
ci_022                -1.081557e-02 3 1  ON 21
ci_023                 5.604866e-03 3 1  ON 22
ci_024                 5.113274e-03 3 1  ON 23
ci_025                 1.290018e-02 3 1  ON 24
ci_026                 1.225985e-02 3 1  ON 25
ci_027                 6.269065e-03 3 1  ON 26
ci_028                 6.311005e-03 3 1  ON 27
ci_029                -3.852069e-03 3 1  ON 28
ci_030                -4.536156e-03 3 1  ON 29
ci_031                 3.701818e-03 3 1  ON 30
ci_032                 3.272854e-03 3 1  ON 31
ci_033                 3.519564e-03 3 1  ON 32
ci_034                 3.445998e-03 3 1  ON 33
ci_035                 2.351974e-03 3 1  ON 34
ci_036                 2.188752e-03 3 1  ON 35
ci_037                 3.418384e-03 3 1  ON 36
ci_038                 3.521985e-03 3 1  ON 37
ci_039                 4.408822e-03 3 1  ON 38
ci_040                 4.428779e-03 3 1  ON 39
ci_041                 2.825118e-03 3 1  ON 40
ci_042                 2.981407e-03 3 1  ON 41
ci_043                 3.540975e-03 3 1  ON 42
ci_044                 3.195884e-03 3 1  ON 43
ci_045                 2.402698e-03 3 1  ON 44
ci_046                 2.902335e-03 3 1  ON 45
ci_047                -1.087766e-03 3 1  ON 46
ci_048                -1.242291e-03 3 1  ON 47
ci_049                 9.632216e-04 3 1  ON 48
ci_050                 8.685023e-04 3 1  ON 49
ci_051                -1.655058e-03 3 1  ON 50
ci_052                -1.615966e-03 3 1  ON 51
ci_053                -2.528532e-03 3 1  ON 52
ci_054                -2.531413e-03 3 1  ON 53
ci_055                -1.646985e-03 3 1  ON 54
ci_056                -1.344474e-03 3 1  ON 55
ci_057                -1.174829e-03 3 1  ON 56
ci_058                -1.047969e-03 3 1  ON 57
ci_059                -4.385251e-04 3 1  ON 58
ci_060                -2.290743e-04 3 1  ON 59
ci_061                -5.476003e-04 3 1  ON 60
ci_062                -4.789284e-04 3 1  ON 61
ci_063                -6.593802e-04 3 1  ON 62
ci_064                -7.279767e-04 3 1  ON 63
ci_065                -1.791464e-03 3 1  ON 64
ci_066                -1.686113e-03 3 1  ON 65
ci_067                -1.607561e-03 3 1  ON 66
ci_068                -1.505483e-03 3 1  ON 67
ci_069                 1.876758e-04 3 1  ON 68
ci_070                 2.734946e-04 3 1  ON 69
ci_071                -1.493268e-03 3 1  ON 70
ci_072                -1.951830e-03 3 1  ON 71
ci_073                 1.856151e-04 3 1  ON 72
ci_074                 2.381061e-04 3 1  ON 73
ci_075                 9.379488e-05 3 1  ON 74
ci_076                 2.062517e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.5739
    reference variance = 0.33054
====================================================
  Execution time = 2.6004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4859e-01
  Total weights = 1.954980977e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438855515132
                                         uncertainty =       0.002221119092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438855515132
                                         uncertainty =       0.002221119092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468403285
  error estimate for blocks of size 2^( 2) =       0.000492412736
  error estimate for blocks of size 2^( 3) =       0.000514624461
  error estimate for blocks of size 2^( 4) =       0.000529931721
  error estimate for blocks of size 2^( 5) =       0.000538784741
  error estimate for blocks of size 2^( 6) =       0.000542756032
  error estimate for blocks of size 2^( 7) =       0.000545009641

      target function =      -0.746474662642
              le_mean =     -22.661867240576
             les_mean =     514.008814440313
             stat err =       0.000539120534
             autocorr =       1.324743761685
   target nu stat err =       0.000539120534
   target dn stat err =       0.002786159026
      target stat err =       0.002367845829
              std dev =       0.662422278015
             le_variance =       0.438803274411


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266186724058e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746481240899       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746511919343       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746516912368       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746518322642       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746518646545       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746518642836       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746518631093       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746518732234       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746518707935       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746518685318       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746518687154       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746518685684       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 2.450213e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746481240899       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746489369761       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746490656568       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746491018277       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746491098660       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746491096404       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746491092561       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746491116736       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746491110704       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746491105224       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746491105731       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746491105466       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 6.435495e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746481240899       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746483303997       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746483628149       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746483719152       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746483739197       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746483738547       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746483737530       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746483743500       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746483741996       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746483740639       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746483740768       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746483740708       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 1.629489e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282978 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0770e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -7.019871e-01 3 1  ON 0
ci_002                -7.059016e-01 3 1  ON 1
ci_003                -5.351316e-02 3 1  ON 2
ci_004                -5.473826e-02 3 1  ON 3
ci_005                 1.994787e-02 3 1  ON 4
ci_006                 1.999975e-02 3 1  ON 5
ci_007                 1.624608e-02 3 1  ON 6
ci_008                 1.615535e-02 3 1  ON 7
ci_009                -1.253925e-02 3 1  ON 8
ci_010                -1.281246e-02 3 1  ON 9
ci_011                -9.965128e-03 3 1  ON 10
ci_012                -1.007913e-02 3 1  ON 11
ci_013                 9.004456e-03 3 1  ON 12
ci_014                 9.097153e-03 3 1  ON 13
ci_015                 9.507146e-03 3 1  ON 14
ci_016                 9.790669e-03 3 1  ON 15
ci_017                 8.603410e-03 3 1  ON 16
ci_018                 8.476788e-03 3 1  ON 17
ci_019                -8.919474e-04 3 1  ON 18
ci_020                -7.641530e-04 3 1  ON 19
ci_021                -1.015702e-02 3 1  ON 20
ci_022                -1.084839e-02 3 1  ON 21
ci_023                 5.602421e-03 3 1  ON 22
ci_024                 5.133806e-03 3 1  ON 23
ci_025                 1.288318e-02 3 1  ON 24
ci_026                 1.227287e-02 3 1  ON 25
ci_027                 6.265041e-03 3 1  ON 26
ci_028                 6.288757e-03 3 1  ON 27
ci_029                -3.818886e-03 3 1  ON 28
ci_030                -4.529052e-03 3 1  ON 29
ci_031                 3.766173e-03 3 1  ON 30
ci_032                 3.335419e-03 3 1  ON 31
ci_033                 3.514663e-03 3 1  ON 32
ci_034                 3.426830e-03 3 1  ON 33
ci_035                 2.343929e-03 3 1  ON 34
ci_036                 2.182031e-03 3 1  ON 35
ci_037                 3.411544e-03 3 1  ON 36
ci_038                 3.486694e-03 3 1  ON 37
ci_039                 4.380476e-03 3 1  ON 38
ci_040                 4.429217e-03 3 1  ON 39
ci_041                 2.824259e-03 3 1  ON 40
ci_042                 2.972672e-03 3 1  ON 41
ci_043                 3.539143e-03 3 1  ON 42
ci_044                 3.210984e-03 3 1  ON 43
ci_045                 2.411856e-03 3 1  ON 44
ci_046                 2.921164e-03 3 1  ON 45
ci_047                -1.060618e-03 3 1  ON 46
ci_048                -1.222274e-03 3 1  ON 47
ci_049                 9.099491e-04 3 1  ON 48
ci_050                 8.594529e-04 3 1  ON 49
ci_051                -1.618475e-03 3 1  ON 50
ci_052                -1.585942e-03 3 1  ON 51
ci_053                -2.531822e-03 3 1  ON 52
ci_054                -2.547205e-03 3 1  ON 53
ci_055                -1.640516e-03 3 1  ON 54
ci_056                -1.359704e-03 3 1  ON 55
ci_057                -1.155618e-03 3 1  ON 56
ci_058                -1.052145e-03 3 1  ON 57
ci_059                -4.236579e-04 3 1  ON 58
ci_060                -2.204738e-04 3 1  ON 59
ci_061                -5.636230e-04 3 1  ON 60
ci_062                -4.872719e-04 3 1  ON 61
ci_063                -6.466771e-04 3 1  ON 62
ci_064                -7.250456e-04 3 1  ON 63
ci_065                -1.785169e-03 3 1  ON 64
ci_066                -1.686738e-03 3 1  ON 65
ci_067                -1.597018e-03 3 1  ON 66
ci_068                -1.504831e-03 3 1  ON 67
ci_069                 1.553208e-04 3 1  ON 68
ci_070                 2.607227e-04 3 1  ON 69
ci_071                -1.508587e-03 3 1  ON 70
ci_072                -1.971244e-03 3 1  ON 71
ci_073                 1.766440e-04 3 1  ON 72
ci_074                 2.234926e-04 3 1  ON 73
ci_075                 8.493878e-05 3 1  ON 74
ci_076                 2.201716e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.5873
    reference variance = 0.536052
====================================================
  Execution time = 2.5139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4540e-01
  Total weights = 1.9548e+06
  Execution time = 3.6106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436266176015
                                         uncertainty =       0.001674877768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436266176015
                                         uncertainty =       0.001674877768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467035986
  error estimate for blocks of size 2^( 2) =       0.000491365189
  error estimate for blocks of size 2^( 3) =       0.000514030860
  error estimate for blocks of size 2^( 4) =       0.000530846410
  error estimate for blocks of size 2^( 5) =       0.000540241992
  error estimate for blocks of size 2^( 6) =       0.000545149936
  error estimate for blocks of size 2^( 7) =       0.000549716421

      target function =      -0.747429048162
              le_mean =     -22.661563640603
             les_mean =     513.993887677294
             stat err =       0.000541488690
             autocorr =       1.344243948381
   target nu stat err =       0.000541488690
   target dn stat err =       0.003213743711
      target stat err =       0.002715922149
              std dev =       0.660488625191
             le_variance =       0.436245224007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436191959274
                                         uncertainty =       0.001674001725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436191959274
                                         uncertainty =       0.001674001725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466996142
  error estimate for blocks of size 2^( 2) =       0.000491333903
  error estimate for blocks of size 2^( 3) =       0.000514004056
  error estimate for blocks of size 2^( 4) =       0.000530823173
  error estimate for blocks of size 2^( 5) =       0.000540220103
  error estimate for blocks of size 2^( 6) =       0.000545127901
  error estimate for blocks of size 2^( 7) =       0.000549696787

      target function =      -0.748731389045
              le_mean =     -22.661558763922
             les_mean =     513.992094323505
             stat err =       0.000541466991
             autocorr =       1.344365586853
   target nu stat err =       0.000541466991
   target dn stat err =       0.002450038972
      target stat err =       0.002113303951
              std dev =       0.660432277716
             le_variance =       0.436170793450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436225683469
                                         uncertainty =       0.001674358430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436225683469
                                         uncertainty =       0.001674358430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467014249
  error estimate for blocks of size 2^( 2) =       0.000491348017
  error estimate for blocks of size 2^( 3) =       0.000514016028
  error estimate for blocks of size 2^( 4) =       0.000530832476
  error estimate for blocks of size 2^( 5) =       0.000540229364
  error estimate for blocks of size 2^( 6) =       0.000545135448
  error estimate for blocks of size 2^( 7) =       0.000549705176

      target function =      -0.660437136272
              le_mean =     -22.661560248082
             les_mean =     514.101289493321
             stat err =       0.000541475616
             autocorr =       1.344304165737
   target nu stat err =       0.000541475616
   target dn stat err =       0.109800923135
      target stat err =       0.071504329026
              std dev =       0.660457885283
             le_variance =       0.436204618233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436260732983
                                         uncertainty =       0.001674804870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436260732983
                                         uncertainty =       0.001674804870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467033065
  error estimate for blocks of size 2^( 2) =       0.000491362882
  error estimate for blocks of size 2^( 3) =       0.000514028857
  error estimate for blocks of size 2^( 4) =       0.000530844681
  error estimate for blocks of size 2^( 5) =       0.000540240486
  error estimate for blocks of size 2^( 6) =       0.000545148648
  error estimate for blocks of size 2^( 7) =       0.000549715050

      target function =      -0.748034677580
              le_mean =     -22.661563308917
             les_mean =     513.993141427838
             stat err =       0.000541487216
             autocorr =       1.344253447406
   target nu stat err =       0.000541487216
   target dn stat err =       0.002785389341
      target stat err =       0.002376415128
              std dev =       0.660484494169
             le_variance =       0.436239767037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747429048162        initial
     5.9605e-01     5.9605e+00             2.4502e-04        -0.748731389045  <--
     2.3842e+00     2.3842e+01             6.4355e-05        -0.660437136272
     9.5367e+00     9.5367e+01             1.6295e-05        -0.748034677580

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 4.3237e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -7.019037e-01 3 1  ON 0
ci_002                -7.060261e-01 3 1  ON 1
ci_003                -5.338224e-02 3 1  ON 2
ci_004                -5.456182e-02 3 1  ON 3
ci_005                 1.984999e-02 3 1  ON 4
ci_006                 1.991071e-02 3 1  ON 5
ci_007                 1.621062e-02 3 1  ON 6
ci_008                 1.609234e-02 3 1  ON 7
ci_009                -1.241244e-02 3 1  ON 8
ci_010                -1.273006e-02 3 1  ON 9
ci_011                -9.808054e-03 3 1  ON 10
ci_012                -9.980473e-03 3 1  ON 11
ci_013                 8.956399e-03 3 1  ON 12
ci_014                 8.985931e-03 3 1  ON 13
ci_015                 9.376697e-03 3 1  ON 14
ci_016                 9.756543e-03 3 1  ON 15
ci_017                 8.575238e-03 3 1  ON 16
ci_018                 8.378598e-03 3 1  ON 17
ci_019                -9.928162e-04 3 1  ON 18
ci_020                -9.205110e-04 3 1  ON 19
ci_021                -1.032497e-02 3 1  ON 20
ci_022                -1.094089e-02 3 1  ON 21
ci_023                 5.595826e-03 3 1  ON 22
ci_024                 5.190304e-03 3 1  ON 23
ci_025                 1.283592e-02 3 1  ON 24
ci_026                 1.230998e-02 3 1  ON 25
ci_027                 6.253923e-03 3 1  ON 26
ci_028                 6.227456e-03 3 1  ON 27
ci_029                -3.726039e-03 3 1  ON 28
ci_030                -4.508887e-03 3 1  ON 29
ci_031                 3.946839e-03 3 1  ON 30
ci_032                 3.511827e-03 3 1  ON 31
ci_033                 3.500835e-03 3 1  ON 32
ci_034                 3.372758e-03 3 1  ON 33
ci_035                 2.321412e-03 3 1  ON 34
ci_036                 2.163146e-03 3 1  ON 35
ci_037                 3.392242e-03 3 1  ON 36
ci_038                 3.387595e-03 3 1  ON 37
ci_039                 4.302366e-03 3 1  ON 38
ci_040                 4.430575e-03 3 1  ON 39
ci_041                 2.821887e-03 3 1  ON 40
ci_042                 2.948618e-03 3 1  ON 41
ci_043                 3.533591e-03 3 1  ON 42
ci_044                 3.253150e-03 3 1  ON 43
ci_045                 2.437476e-03 3 1  ON 44
ci_046                 2.974243e-03 3 1  ON 45
ci_047                -9.859306e-04 3 1  ON 46
ci_048                -1.167049e-03 3 1  ON 47
ci_049                 7.624408e-04 3 1  ON 48
ci_050                 8.346767e-04 3 1  ON 49
ci_051                -1.516406e-03 3 1  ON 50
ci_052                -1.501387e-03 3 1  ON 51
ci_053                -2.541542e-03 3 1  ON 52
ci_054                -2.591815e-03 3 1  ON 53
ci_055                -1.622016e-03 3 1  ON 54
ci_056                -1.402569e-03 3 1  ON 55
ci_057                -1.102347e-03 3 1  ON 56
ci_058                -1.063566e-03 3 1  ON 57
ci_059                -3.824984e-04 3 1  ON 58
ci_060                -1.965084e-04 3 1  ON 59
ci_061                -6.083604e-04 3 1  ON 60
ci_062                -5.107135e-04 3 1  ON 61
ci_063                -6.112546e-04 3 1  ON 62
ci_064                -7.171278e-04 3 1  ON 63
ci_065                -1.767058e-03 3 1  ON 64
ci_066                -1.688197e-03 3 1  ON 65
ci_067                -1.567595e-03 3 1  ON 66
ci_068                -1.503104e-03 3 1  ON 67
ci_069                 6.499465e-05 3 1  ON 68
ci_070                 2.249805e-04 3 1  ON 69
ci_071                -1.551308e-03 3 1  ON 70
ci_072                -2.025809e-03 3 1  ON 71
ci_073                 1.518771e-04 3 1  ON 72
ci_074                 1.832085e-04 3 1  ON 73
ci_075                 6.025274e-05 3 1  ON 74
ci_076                 2.590508e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4014e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6241
    reference variance = 0.393369
====================================================
  Execution time = 2.6050e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4676e-01
  Total weights = 1.955269154e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438197269286
                                         uncertainty =       0.001971174511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438197269286
                                         uncertainty =       0.001971174511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468099332
  error estimate for blocks of size 2^( 2) =       0.000492212846
  error estimate for blocks of size 2^( 3) =       0.000514268037
  error estimate for blocks of size 2^( 4) =       0.000529481031
  error estimate for blocks of size 2^( 5) =       0.000540170205
  error estimate for blocks of size 2^( 6) =       0.000544210910
  error estimate for blocks of size 2^( 7) =       0.000546602932

      target function =      -0.747976132505
              le_mean =     -22.661649531117
             les_mean =     513.997124173393
             stat err =       0.000540116270
             autocorr =       1.331369111950
   target nu stat err =       0.000540116270
   target dn stat err =       0.002350075534
      target stat err =       0.002030032814
              std dev =       0.661992423291
             le_variance =       0.438233968495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266164953112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747980696068       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748080501016       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748096104222       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748097811422       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748098708934       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748098791057       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748098377382       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748098219046       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748098121489       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748098119932       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748098103138       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e-01 is 1.039589e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747980696068       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748011464434       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748015803118       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748016249812       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748016492711       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748016498985       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748016391793       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748016355723       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748016335188       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748016335765       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 3.072346e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747980696068       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747988864157       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747989976951       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747990089497       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747990151249       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747990151523       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747990124749       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747990116051       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747990111219       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747990111436       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 8.047205e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0853e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -7.019025e-01 3 1  ON 0
ci_002                -7.060780e-01 3 1  ON 1
ci_003                -5.329691e-02 3 1  ON 2
ci_004                -5.434451e-02 3 1  ON 3
ci_005                 1.960320e-02 3 1  ON 4
ci_006                 1.984575e-02 3 1  ON 5
ci_007                 1.611635e-02 3 1  ON 6
ci_008                 1.586517e-02 3 1  ON 7
ci_009                -1.225605e-02 3 1  ON 8
ci_010                -1.261492e-02 3 1  ON 9
ci_011                -9.587906e-03 3 1  ON 10
ci_012                -9.943071e-03 3 1  ON 11
ci_013                 8.934011e-03 3 1  ON 12
ci_014                 8.810300e-03 3 1  ON 13
ci_015                 9.355099e-03 3 1  ON 14
ci_016                 9.645573e-03 3 1  ON 15
ci_017                 8.482816e-03 3 1  ON 16
ci_018                 8.236716e-03 3 1  ON 17
ci_019                -1.300051e-03 3 1  ON 18
ci_020                -1.154351e-03 3 1  ON 19
ci_021                -1.021946e-02 3 1  ON 20
ci_022                -1.107254e-02 3 1  ON 21
ci_023                 5.505760e-03 3 1  ON 22
ci_024                 5.257384e-03 3 1  ON 23
ci_025                 1.286111e-02 3 1  ON 24
ci_026                 1.254336e-02 3 1  ON 25
ci_027                 6.240829e-03 3 1  ON 26
ci_028                 6.217147e-03 3 1  ON 27
ci_029                -3.714358e-03 3 1  ON 28
ci_030                -4.445426e-03 3 1  ON 29
ci_031                 4.157707e-03 3 1  ON 30
ci_032                 3.478389e-03 3 1  ON 31
ci_033                 3.459413e-03 3 1  ON 32
ci_034                 3.406013e-03 3 1  ON 33
ci_035                 2.315219e-03 3 1  ON 34
ci_036                 2.214594e-03 3 1  ON 35
ci_037                 3.441191e-03 3 1  ON 36
ci_038                 3.249955e-03 3 1  ON 37
ci_039                 4.303722e-03 3 1  ON 38
ci_040                 4.394541e-03 3 1  ON 39
ci_041                 2.742989e-03 3 1  ON 40
ci_042                 2.931538e-03 3 1  ON 41
ci_043                 3.359310e-03 3 1  ON 42
ci_044                 3.202142e-03 3 1  ON 43
ci_045                 2.558848e-03 3 1  ON 44
ci_046                 2.903404e-03 3 1  ON 45
ci_047                -1.035979e-03 3 1  ON 46
ci_048                -1.221269e-03 3 1  ON 47
ci_049                 8.201080e-04 3 1  ON 48
ci_050                 8.479612e-04 3 1  ON 49
ci_051                -1.475559e-03 3 1  ON 50
ci_052                -1.414710e-03 3 1  ON 51
ci_053                -2.506596e-03 3 1  ON 52
ci_054                -2.708429e-03 3 1  ON 53
ci_055                -1.619980e-03 3 1  ON 54
ci_056                -1.370606e-03 3 1  ON 55
ci_057                -1.048285e-03 3 1  ON 56
ci_058                -1.036265e-03 3 1  ON 57
ci_059                -4.382671e-04 3 1  ON 58
ci_060                -1.875816e-04 3 1  ON 59
ci_061                -6.736193e-04 3 1  ON 60
ci_062                -5.580164e-04 3 1  ON 61
ci_063                -6.026688e-04 3 1  ON 62
ci_064                -6.259337e-04 3 1  ON 63
ci_065                -1.839195e-03 3 1  ON 64
ci_066                -1.676440e-03 3 1  ON 65
ci_067                -1.627118e-03 3 1  ON 66
ci_068                -1.559191e-03 3 1  ON 67
ci_069                -4.619085e-06 3 1  ON 68
ci_070                 1.976591e-04 3 1  ON 69
ci_071                -1.558864e-03 3 1  ON 70
ci_072                -1.940703e-03 3 1  ON 71
ci_073                 2.022856e-04 3 1  ON 72
ci_074                 1.110292e-04 3 1  ON 73
ci_075                 6.140393e-05 3 1  ON 74
ci_076                 2.585313e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6701
    reference variance = 0.407382
====================================================
  Execution time = 2.6979e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5018e-01
  Total weights = 1.9552e+06
  Execution time = 3.6295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439824779704
                                         uncertainty =       0.002243881112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439824779704
                                         uncertainty =       0.002243881112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469013557
  error estimate for blocks of size 2^( 2) =       0.000492942306
  error estimate for blocks of size 2^( 3) =       0.000515798570
  error estimate for blocks of size 2^( 4) =       0.000531947523
  error estimate for blocks of size 2^( 5) =       0.000541112287
  error estimate for blocks of size 2^( 6) =       0.000544258206
  error estimate for blocks of size 2^( 7) =       0.000549534366

      target function =      -0.744787593122
              le_mean =     -22.662033959980
             les_mean =     514.018427408982
             stat err =       0.000541713096
             autocorr =       1.334037001416
   target nu stat err =       0.000541713096
   target dn stat err =       0.002920322672
      target stat err =       0.002465286394
              std dev =       0.663285333912
             le_variance =       0.439947434183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439784021305
                                         uncertainty =       0.002245055430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439784021305
                                         uncertainty =       0.002245055430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468989668
  error estimate for blocks of size 2^( 2) =       0.000492944942
  error estimate for blocks of size 2^( 3) =       0.000515822547
  error estimate for blocks of size 2^( 4) =       0.000531980964
  error estimate for blocks of size 2^( 5) =       0.000541163202
  error estimate for blocks of size 2^( 6) =       0.000544311809
  error estimate for blocks of size 2^( 7) =       0.000549587723

      target function =      -0.742944240672
              le_mean =     -22.662027714464
             les_mean =     514.020394779370
             stat err =       0.000541760924
             autocorr =       1.334408512738
   target nu stat err =       0.000541760924
   target dn stat err =       0.003671722795
      target stat err =       0.003051294066
              std dev =       0.663251549740
             le_variance =       0.439902618232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439776827524
                                         uncertainty =       0.002243299008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439776827524
                                         uncertainty =       0.002243299008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468986719
  error estimate for blocks of size 2^( 2) =       0.000492932187
  error estimate for blocks of size 2^( 3) =       0.000515800981
  error estimate for blocks of size 2^( 4) =       0.000531955535
  error estimate for blocks of size 2^( 5) =       0.000541130691
  error estimate for blocks of size 2^( 6) =       0.000544279049
  error estimate for blocks of size 2^( 7) =       0.000549554872

      target function =      -0.733292033970
              le_mean =     -22.662027109736
             les_mean =     514.032146296613
             stat err =       0.000541730037
             autocorr =       1.334273142432
   target nu stat err =       0.000541730037
   target dn stat err =       0.014693188502
      target stat err =       0.011684824180
              std dev =       0.663247378390
             le_variance =       0.439897084942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439814409557
                                         uncertainty =       0.002243657025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439814409557
                                         uncertainty =       0.002243657025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469007865
  error estimate for blocks of size 2^( 2) =       0.000492938873
  error estimate for blocks of size 2^( 3) =       0.000515796771
  error estimate for blocks of size 2^( 4) =       0.000531946637
  error estimate for blocks of size 2^( 5) =       0.000541112769
  error estimate for blocks of size 2^( 6) =       0.000544259225
  error estimate for blocks of size 2^( 7) =       0.000549535149

      target function =      -0.745045706327
              le_mean =     -22.662032561941
             les_mean =     514.018049157894
             stat err =       0.000541713445
             autocorr =       1.334071107314
   target nu stat err =       0.000541713445
   target dn stat err =       0.002901148963
      target stat err =       0.002451691588
              std dev =       0.663277283180
             le_variance =       0.439936754382


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744787593122        initial
     1.4901e-01     1.4901e+00             1.0396e-03        -0.742944240672
     5.9605e-01     5.9605e+00             3.0723e-04        -0.733292033970
     2.3842e+00     2.3842e+01             8.0472e-05        -0.745045706327  <--

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 4.5111e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -7.019035e-01 3 1  ON 0
ci_002                -7.060395e-01 3 1  ON 1
ci_003                -5.336031e-02 3 1  ON 2
ci_004                -5.450601e-02 3 1  ON 3
ci_005                 1.978435e-02 3 1  ON 4
ci_006                 1.989344e-02 3 1  ON 5
ci_007                 1.618566e-02 3 1  ON 6
ci_008                 1.603245e-02 3 1  ON 7
ci_009                -1.237103e-02 3 1  ON 8
ci_010                -1.269948e-02 3 1  ON 9
ci_011                -9.750081e-03 3 1  ON 10
ci_012                -9.970577e-03 3 1  ON 11
ci_013                 8.950376e-03 3 1  ON 12
ci_014                 8.939688e-03 3 1  ON 13
ci_015                 9.370980e-03 3 1  ON 14
ci_016                 9.727566e-03 3 1  ON 15
ci_017                 8.550868e-03 3 1  ON 16
ci_018                 8.341142e-03 3 1  ON 17
ci_019                -1.073288e-03 3 1  ON 18
ci_020                -9.817014e-04 3 1  ON 19
ci_021                -1.029734e-02 3 1  ON 20
ci_022                -1.097552e-02 3 1  ON 21
ci_023                 5.571963e-03 3 1  ON 22
ci_024                 5.208050e-03 3 1  ON 23
ci_025                 1.284230e-02 3 1  ON 24
ci_026                 1.237102e-02 3 1  ON 25
ci_027                 6.250396e-03 3 1  ON 26
ci_028                 6.224726e-03 3 1  ON 27
ci_029                -3.722997e-03 3 1  ON 28
ci_030                -4.492267e-03 3 1  ON 29
ci_031                 4.002462e-03 3 1  ON 30
ci_032                 3.503039e-03 3 1  ON 31
ci_033                 3.489927e-03 3 1  ON 32
ci_034                 3.381514e-03 3 1  ON 33
ci_035                 2.319813e-03 3 1  ON 34
ci_036                 2.176966e-03 3 1  ON 35
ci_037                 3.405117e-03 3 1  ON 36
ci_038                 3.351555e-03 3 1  ON 37
ci_039                 4.302733e-03 3 1  ON 38
ci_040                 4.420965e-03 3 1  ON 39
ci_041                 2.800875e-03 3 1  ON 40
ci_042                 2.944071e-03 3 1  ON 41
ci_043                 3.487475e-03 3 1  ON 42
ci_044                 3.239782e-03 3 1  ON 43
ci_045                 2.469380e-03 3 1  ON 44
ci_046                 2.955552e-03 3 1  ON 45
ci_047                -9.994191e-04 3 1  ON 46
ci_048                -1.181597e-03 3 1  ON 47
ci_049                 7.776938e-04 3 1  ON 48
ci_050                 8.382070e-04 3 1  ON 49
ci_051                -1.505708e-03 3 1  ON 50
ci_052                -1.478677e-03 3 1  ON 51
ci_053                -2.532145e-03 3 1  ON 52
ci_054                -2.622491e-03 3 1  ON 53
ci_055                -1.621538e-03 3 1  ON 54
ci_056                -1.394251e-03 3 1  ON 55
ci_057                -1.088065e-03 3 1  ON 56
ci_058                -1.056358e-03 3 1  ON 57
ci_059                -3.974193e-04 3 1  ON 58
ci_060                -1.942050e-04 3 1  ON 59
ci_061                -6.255678e-04 3 1  ON 60
ci_062                -5.237099e-04 3 1  ON 61
ci_063                -6.089939e-04 3 1  ON 62
ci_064                -6.931058e-04 3 1  ON 63
ci_065                -1.786185e-03 3 1  ON 64
ci_066                -1.685189e-03 3 1  ON 65
ci_067                -1.583002e-03 3 1  ON 66
ci_068                -1.517834e-03 3 1  ON 67
ci_069                 4.674152e-05 3 1  ON 68
ci_070                 2.177209e-04 3 1  ON 69
ci_071                -1.553305e-03 3 1  ON 70
ci_072                -2.003425e-03 3 1  ON 71
ci_073                 1.654750e-04 3 1  ON 72
ci_074                 1.640262e-04 3 1  ON 73
ci_075                 6.032778e-05 3 1  ON 74
ci_076                 2.588934e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5970e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7332
    reference variance = 0.302652
====================================================
  Execution time = 2.6298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4753e-01
  Total weights = 1.955459877e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437124767940
                                         uncertainty =       0.001937628099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437124767940
                                         uncertainty =       0.001937628099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467497850
  error estimate for blocks of size 2^( 2) =       0.000491541091
  error estimate for blocks of size 2^( 3) =       0.000513728162
  error estimate for blocks of size 2^( 4) =       0.000530099497
  error estimate for blocks of size 2^( 5) =       0.000539598557
  error estimate for blocks of size 2^( 6) =       0.000542944280
  error estimate for blocks of size 2^( 7) =       0.000544797157

      target function =      -0.747339360860
              le_mean =     -22.661356030547
             les_mean =     513.984585075634
             stat err =       0.000539359873
             autocorr =       1.331061216797
   target nu stat err =       0.000539359873
   target dn stat err =       0.002951249155
      target stat err =       0.002503354481
              std dev =       0.661141799944
             le_variance =       0.437108479633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266135603055e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747346814024       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747367584691       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747370881505       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747371317399       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747371594514       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747371648834       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747371805180       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747371760592       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747371768867       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747371773540       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747371784380       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 2.539943e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747346814024       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747352311525       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747353158271       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747353269468       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747353338609       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747353351165       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747353387683       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747353376525       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747353378577       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747353379620       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747353382072       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 6.665851e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747346814024       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747348208869       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747348421970       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747348449906       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747348467172       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747348470244       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747348479204       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747348476418       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747348476930       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747348477184       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747348477780       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 1.687451e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0992e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -7.019638e-01 3 1  ON 0
ci_002                -7.059894e-01 3 1  ON 1
ci_003                -5.332256e-02 3 1  ON 2
ci_004                -5.448920e-02 3 1  ON 3
ci_005                 1.975178e-02 3 1  ON 4
ci_006                 1.985411e-02 3 1  ON 5
ci_007                 1.614073e-02 3 1  ON 6
ci_008                 1.599333e-02 3 1  ON 7
ci_009                -1.236222e-02 3 1  ON 8
ci_010                -1.269648e-02 3 1  ON 9
ci_011                -9.717822e-03 3 1  ON 10
ci_012                -9.953051e-03 3 1  ON 11
ci_013                 8.915020e-03 3 1  ON 12
ci_014                 8.913642e-03 3 1  ON 13
ci_015                 9.312914e-03 3 1  ON 14
ci_016                 9.710193e-03 3 1  ON 15
ci_017                 8.531102e-03 3 1  ON 16
ci_018                 8.337538e-03 3 1  ON 17
ci_019                -1.109404e-03 3 1  ON 18
ci_020                -1.048360e-03 3 1  ON 19
ci_021                -1.033229e-02 3 1  ON 20
ci_022                -1.100678e-02 3 1  ON 21
ci_023                 5.564722e-03 3 1  ON 22
ci_024                 5.207759e-03 3 1  ON 23
ci_025                 1.284384e-02 3 1  ON 24
ci_026                 1.235699e-02 3 1  ON 25
ci_027                 6.263050e-03 3 1  ON 26
ci_028                 6.243577e-03 3 1  ON 27
ci_029                -3.731524e-03 3 1  ON 28
ci_030                -4.474160e-03 3 1  ON 29
ci_031                 4.055171e-03 3 1  ON 30
ci_032                 3.530062e-03 3 1  ON 31
ci_033                 3.488167e-03 3 1  ON 32
ci_034                 3.375007e-03 3 1  ON 33
ci_035                 2.318553e-03 3 1  ON 34
ci_036                 2.181078e-03 3 1  ON 35
ci_037                 3.407703e-03 3 1  ON 36
ci_038                 3.349636e-03 3 1  ON 37
ci_039                 4.312835e-03 3 1  ON 38
ci_040                 4.421698e-03 3 1  ON 39
ci_041                 2.799557e-03 3 1  ON 40
ci_042                 2.945541e-03 3 1  ON 41
ci_043                 3.480486e-03 3 1  ON 42
ci_044                 3.225940e-03 3 1  ON 43
ci_045                 2.470927e-03 3 1  ON 44
ci_046                 2.938634e-03 3 1  ON 45
ci_047                -9.869902e-04 3 1  ON 46
ci_048                -1.168910e-03 3 1  ON 47
ci_049                 7.820022e-04 3 1  ON 48
ci_050                 8.132907e-04 3 1  ON 49
ci_051                -1.506185e-03 3 1  ON 50
ci_052                -1.486219e-03 3 1  ON 51
ci_053                -2.544397e-03 3 1  ON 52
ci_054                -2.613587e-03 3 1  ON 53
ci_055                -1.596565e-03 3 1  ON 54
ci_056                -1.413634e-03 3 1  ON 55
ci_057                -1.091333e-03 3 1  ON 56
ci_058                -1.040093e-03 3 1  ON 57
ci_059                -3.979820e-04 3 1  ON 58
ci_060                -2.000608e-04 3 1  ON 59
ci_061                -6.180594e-04 3 1  ON 60
ci_062                -5.217994e-04 3 1  ON 61
ci_063                -6.274815e-04 3 1  ON 62
ci_064                -7.023344e-04 3 1  ON 63
ci_065                -1.762431e-03 3 1  ON 64
ci_066                -1.687034e-03 3 1  ON 65
ci_067                -1.577964e-03 3 1  ON 66
ci_068                -1.533858e-03 3 1  ON 67
ci_069                 9.914114e-06 3 1  ON 68
ci_070                 1.888339e-04 3 1  ON 69
ci_071                -1.537321e-03 3 1  ON 70
ci_072                -2.004039e-03 3 1  ON 71
ci_073                 1.445855e-04 3 1  ON 72
ci_074                 1.599572e-04 3 1  ON 73
ci_075                 8.054249e-05 3 1  ON 74
ci_076                 2.724510e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8225
    reference variance = 0.379502
====================================================
  Execution time = 2.5742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5121e-01
  Total weights = 1.9551e+06
  Execution time = 3.6213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440738169559
                                         uncertainty =       0.002243626304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440738169559
                                         uncertainty =       0.002243626304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469399556
  error estimate for blocks of size 2^( 2) =       0.000493489014
  error estimate for blocks of size 2^( 3) =       0.000515408865
  error estimate for blocks of size 2^( 4) =       0.000532330502
  error estimate for blocks of size 2^( 5) =       0.000541677711
  error estimate for blocks of size 2^( 6) =       0.000545986544
  error estimate for blocks of size 2^( 7) =       0.000550043877

      target function =      -0.744315990586
              le_mean =     -22.660973542016
             les_mean =     513.970930367021
             stat err =       0.000542509658
             autocorr =       1.335763586658
   target nu stat err =       0.000542509658
   target dn stat err =       0.002783410979
      target stat err =       0.002350265477
              std dev =       0.663831218073
             le_variance =       0.440671886089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440686788866
                                         uncertainty =       0.002241905592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440686788866
                                         uncertainty =       0.002241905592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469372293
  error estimate for blocks of size 2^( 2) =       0.000493470291
  error estimate for blocks of size 2^( 3) =       0.000515396175
  error estimate for blocks of size 2^( 4) =       0.000532318271
  error estimate for blocks of size 2^( 5) =       0.000541662655
  error estimate for blocks of size 2^( 6) =       0.000545969430
  error estimate for blocks of size 2^( 7) =       0.000550037526

      target function =      -0.744141683907
              le_mean =     -22.660974087865
             les_mean =     513.971168479507
             stat err =       0.000542496971
             autocorr =       1.335856279597
   target nu stat err =       0.000542496971
   target dn stat err =       0.002796100125
      target stat err =       0.002359222261
              std dev =       0.663792661910
             le_variance =       0.440620698005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440709426827
                                         uncertainty =       0.002242625367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440709426827
                                         uncertainty =       0.002242625367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469384302
  error estimate for blocks of size 2^( 2) =       0.000493478301
  error estimate for blocks of size 2^( 3) =       0.000515401343
  error estimate for blocks of size 2^( 4) =       0.000532323222
  error estimate for blocks of size 2^( 5) =       0.000541668934
  error estimate for blocks of size 2^( 6) =       0.000545976733
  error estimate for blocks of size 2^( 7) =       0.000550039669

      target function =      -0.744295967121
              le_mean =     -22.660973659799
             les_mean =     513.970960192027
             stat err =       0.000542502140
             autocorr =       1.335813380805
   target nu stat err =       0.000542502140
   target dn stat err =       0.002788176330
      target stat err =       0.002353907046
              std dev =       0.663809645180
             le_variance =       0.440643245034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440734346146
                                         uncertainty =       0.002243493235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440734346146
                                         uncertainty =       0.002243493235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469397526
  error estimate for blocks of size 2^( 2) =       0.000493487561
  error estimate for blocks of size 2^( 3) =       0.000515407819
  error estimate for blocks of size 2^( 4) =       0.000532329485
  error estimate for blocks of size 2^( 5) =       0.000541676510
  error estimate for blocks of size 2^( 6) =       0.000545985212
  error estimate for blocks of size 2^( 7) =       0.000550043252

      target function =      -0.744320138218
              le_mean =     -22.660973533020
             les_mean =     513.970924878745
             stat err =       0.000542508615
             autocorr =       1.335769997398
   target nu stat err =       0.000542508615
   target dn stat err =       0.002783858221
      target stat err =       0.002350643932
              std dev =       0.663828348067
             le_variance =       0.440668075697


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744315990586        initial
     5.9605e-01     5.9605e+00             2.5399e-04        -0.744141683907
     2.3842e+00     2.3842e+01             6.6659e-05        -0.744295967121
     9.5367e+00     9.5367e+01             1.6875e-05        -0.744320138218  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 4.3841e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -7.019186e-01 3 1  ON 0
ci_002                -7.060270e-01 3 1  ON 1
ci_003                -5.335082e-02 3 1  ON 2
ci_004                -5.450179e-02 3 1  ON 3
ci_005                 1.977607e-02 3 1  ON 4
ci_006                 1.988346e-02 3 1  ON 5
ci_007                 1.617427e-02 3 1  ON 6
ci_008                 1.602254e-02 3 1  ON 7
ci_009                -1.236878e-02 3 1  ON 8
ci_010                -1.269872e-02 3 1  ON 9
ci_011                -9.741906e-03 3 1  ON 10
ci_012                -9.966138e-03 3 1  ON 11
ci_013                 8.941414e-03 3 1  ON 12
ci_014                 8.933089e-03 3 1  ON 13
ci_015                 9.356290e-03 3 1  ON 14
ci_016                 9.723168e-03 3 1  ON 15
ci_017                 8.545864e-03 3 1  ON 16
ci_018                 8.340218e-03 3 1  ON 17
ci_019                -1.082430e-03 3 1  ON 18
ci_020                -9.985759e-04 3 1  ON 19
ci_021                -1.030618e-02 3 1  ON 20
ci_022                -1.098344e-02 3 1  ON 21
ci_023                 5.570125e-03 3 1  ON 22
ci_024                 5.207980e-03 3 1  ON 23
ci_025                 1.284267e-02 3 1  ON 24
ci_026                 1.236746e-02 3 1  ON 25
ci_027                 6.253610e-03 3 1  ON 26
ci_028                 6.229518e-03 3 1  ON 27
ci_029                -3.725152e-03 3 1  ON 28
ci_030                -4.487684e-03 3 1  ON 29
ci_031                 4.015797e-03 3 1  ON 30
ci_032                 3.509875e-03 3 1  ON 31
ci_033                 3.489479e-03 3 1  ON 32
ci_034                 3.379865e-03 3 1  ON 33
ci_035                 2.319499e-03 3 1  ON 34
ci_036                 2.178015e-03 3 1  ON 35
ci_037                 3.405774e-03 3 1  ON 36
ci_038                 3.351070e-03 3 1  ON 37
ci_039                 4.305299e-03 3 1  ON 38
ci_040                 4.421153e-03 3 1  ON 39
ci_041                 2.800539e-03 3 1  ON 40
ci_042                 2.944444e-03 3 1  ON 41
ci_043                 3.485713e-03 3 1  ON 42
ci_044                 3.236279e-03 3 1  ON 43
ci_045                 2.469770e-03 3 1  ON 44
ci_046                 2.951266e-03 3 1  ON 45
ci_047                -9.962610e-04 3 1  ON 46
ci_048                -1.178373e-03 3 1  ON 47
ci_049                 7.787860e-04 3 1  ON 48
ci_050                 8.318854e-04 3 1  ON 49
ci_051                -1.505835e-03 3 1  ON 50
ci_052                -1.480595e-03 3 1  ON 51
ci_053                -2.535246e-03 3 1  ON 52
ci_054                -2.620235e-03 3 1  ON 53
ci_055                -1.615219e-03 3 1  ON 54
ci_056                -1.399156e-03 3 1  ON 55
ci_057                -1.088895e-03 3 1  ON 56
ci_058                -1.052232e-03 3 1  ON 57
ci_059                -3.975673e-04 3 1  ON 58
ci_060                -1.956976e-04 3 1  ON 59
ci_061                -6.236717e-04 3 1  ON 60
ci_062                -5.232228e-04 3 1  ON 61
ci_063                -6.136726e-04 3 1  ON 62
ci_064                -6.954407e-04 3 1  ON 63
ci_065                -1.780171e-03 3 1  ON 64
ci_066                -1.685659e-03 3 1  ON 65
ci_067                -1.581720e-03 3 1  ON 66
ci_068                -1.521891e-03 3 1  ON 67
ci_069                 3.740913e-05 3 1  ON 68
ci_070                 2.104033e-04 3 1  ON 69
ci_071                -1.549256e-03 3 1  ON 70
ci_072                -2.003584e-03 3 1  ON 71
ci_073                 1.601668e-04 3 1  ON 72
ci_074                 1.629933e-04 3 1  ON 73
ci_075                 6.545185e-05 3 1  ON 74
ci_076                 2.623260e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4839e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.685
    reference variance = 0.273894
====================================================
  Execution time = 2.6196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5738e-01
  Total weights = 1.955433649e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442612744923
                                         uncertainty =       0.003418285290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442612744923
                                         uncertainty =       0.003418285290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470437889
  error estimate for blocks of size 2^( 2) =       0.000494457660
  error estimate for blocks of size 2^( 3) =       0.000516547410
  error estimate for blocks of size 2^( 4) =       0.000533160556
  error estimate for blocks of size 2^( 5) =       0.000541977727
  error estimate for blocks of size 2^( 6) =       0.000546650053
  error estimate for blocks of size 2^( 7) =       0.000547990127

      target function =      -0.739273329963
              le_mean =     -22.661293684785
             les_mean =     513.991611594245
             stat err =       0.000542444616
             autocorr =       1.329554736858
   target nu stat err =       0.000542444616
   target dn stat err =       0.007007114165
      target stat err =       0.005680240779
              std dev =       0.665299642280
             le_variance =       0.442623614017


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266129368478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739316019341       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739334211409       residual = 6.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739337061408       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739337671991       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739337845183       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739338071752       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739338116274       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739338115521       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739338109809       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739338109847       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739338122949       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739338120939       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.163099e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739316019341       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739320634989       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739321352718       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739321505643       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739321548883       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739321604987       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739321615555       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739321615276       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739321613861       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739321613897       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739321617059       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739321616566       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 2.942848e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739316019341       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739317177559       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739317357319       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739317395566       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739317406372       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739317420364       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739317422971       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739317422895       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739317422542       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739317422553       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739317423336       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739317423214       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 7.379384e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0919e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -7.019476e-01 3 1  ON 0
ci_002                -7.059981e-01 3 1  ON 1
ci_003                -5.337010e-02 3 1  ON 2
ci_004                -5.449292e-02 3 1  ON 3
ci_005                 1.976967e-02 3 1  ON 4
ci_006                 1.986820e-02 3 1  ON 5
ci_007                 1.617107e-02 3 1  ON 6
ci_008                 1.600976e-02 3 1  ON 7
ci_009                -1.236543e-02 3 1  ON 8
ci_010                -1.270023e-02 3 1  ON 9
ci_011                -9.744319e-03 3 1  ON 10
ci_012                -9.948031e-03 3 1  ON 11
ci_013                 8.929958e-03 3 1  ON 12
ci_014                 8.927409e-03 3 1  ON 13
ci_015                 9.349543e-03 3 1  ON 14
ci_016                 9.704190e-03 3 1  ON 15
ci_017                 8.570227e-03 3 1  ON 16
ci_018                 8.331313e-03 3 1  ON 17
ci_019                -1.101052e-03 3 1  ON 18
ci_020                -1.028004e-03 3 1  ON 19
ci_021                -1.032339e-02 3 1  ON 20
ci_022                -1.099331e-02 3 1  ON 21
ci_023                 5.555842e-03 3 1  ON 22
ci_024                 5.232172e-03 3 1  ON 23
ci_025                 1.285730e-02 3 1  ON 24
ci_026                 1.238284e-02 3 1  ON 25
ci_027                 6.255141e-03 3 1  ON 26
ci_028                 6.232016e-03 3 1  ON 27
ci_029                -3.719978e-03 3 1  ON 28
ci_030                -4.481083e-03 3 1  ON 29
ci_031                 4.018721e-03 3 1  ON 30
ci_032                 3.533177e-03 3 1  ON 31
ci_033                 3.478218e-03 3 1  ON 32
ci_034                 3.375830e-03 3 1  ON 33
ci_035                 2.311817e-03 3 1  ON 34
ci_036                 2.173969e-03 3 1  ON 35
ci_037                 3.404508e-03 3 1  ON 36
ci_038                 3.347678e-03 3 1  ON 37
ci_039                 4.297537e-03 3 1  ON 38
ci_040                 4.418959e-03 3 1  ON 39
ci_041                 2.800314e-03 3 1  ON 40
ci_042                 2.944178e-03 3 1  ON 41
ci_043                 3.488644e-03 3 1  ON 42
ci_044                 3.233747e-03 3 1  ON 43
ci_045                 2.479436e-03 3 1  ON 44
ci_046                 2.944781e-03 3 1  ON 45
ci_047                -9.953676e-04 3 1  ON 46
ci_048                -1.174624e-03 3 1  ON 47
ci_049                 7.697627e-04 3 1  ON 48
ci_050                 8.230309e-04 3 1  ON 49
ci_051                -1.510941e-03 3 1  ON 50
ci_052                -1.476331e-03 3 1  ON 51
ci_053                -2.539055e-03 3 1  ON 52
ci_054                -2.622573e-03 3 1  ON 53
ci_055                -1.608376e-03 3 1  ON 54
ci_056                -1.382015e-03 3 1  ON 55
ci_057                -1.076670e-03 3 1  ON 56
ci_058                -1.044038e-03 3 1  ON 57
ci_059                -3.971151e-04 3 1  ON 58
ci_060                -1.931206e-04 3 1  ON 59
ci_061                -6.330503e-04 3 1  ON 60
ci_062                -5.259090e-04 3 1  ON 61
ci_063                -6.184988e-04 3 1  ON 62
ci_064                -7.009635e-04 3 1  ON 63
ci_065                -1.772988e-03 3 1  ON 64
ci_066                -1.685910e-03 3 1  ON 65
ci_067                -1.585828e-03 3 1  ON 66
ci_068                -1.546318e-03 3 1  ON 67
ci_069                 3.096511e-05 3 1  ON 68
ci_070                 2.065282e-04 3 1  ON 69
ci_071                -1.545184e-03 3 1  ON 70
ci_072                -1.990619e-03 3 1  ON 71
ci_073                 1.581470e-04 3 1  ON 72
ci_074                 1.601460e-04 3 1  ON 73
ci_075                 6.241930e-05 3 1  ON 74
ci_076                 2.571167e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7144
    reference variance = 0.347653
====================================================
  Execution time = 2.5553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4891e-01
  Total weights = 1.9550e+06
  Execution time = 3.6286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438344605452
                                         uncertainty =       0.002137789813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438344605452
                                         uncertainty =       0.002137789813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468127282
  error estimate for blocks of size 2^( 2) =       0.000492499626
  error estimate for blocks of size 2^( 3) =       0.000514421205
  error estimate for blocks of size 2^( 4) =       0.000529974947
  error estimate for blocks of size 2^( 5) =       0.000539729243
  error estimate for blocks of size 2^( 6) =       0.000543841858
  error estimate for blocks of size 2^( 7) =       0.000545821036

      target function =      -0.746153718498
              le_mean =     -22.661694915183
             les_mean =     514.001392644102
             stat err =       0.000539841771
             autocorr =       1.329857380971
   target nu stat err =       0.000539841771
   target dn stat err =       0.002642779719
      target stat err =       0.002251624418
              std dev =       0.662031950468
             le_variance =       0.438286303441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438334222619
                                         uncertainty =       0.002140838222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438334222619
                                         uncertainty =       0.002140838222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468121741
  error estimate for blocks of size 2^( 2) =       0.000492496056
  error estimate for blocks of size 2^( 3) =       0.000514418331
  error estimate for blocks of size 2^( 4) =       0.000529972806
  error estimate for blocks of size 2^( 5) =       0.000539724903
  error estimate for blocks of size 2^( 6) =       0.000543841594
  error estimate for blocks of size 2^( 7) =       0.000545820899

      target function =      -0.746244034951
              le_mean =     -22.661695342644
             les_mean =     514.001302276441
             stat err =       0.000539840051
             autocorr =       1.329880385033
   target nu stat err =       0.000539840051
   target dn stat err =       0.002617390492
      target stat err =       0.002232029624
              std dev =       0.662024114776
             le_variance =       0.438275928545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438338810081
                                         uncertainty =       0.002139314180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438338810081
                                         uncertainty =       0.002139314180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468124189
  error estimate for blocks of size 2^( 2) =       0.000492497538
  error estimate for blocks of size 2^( 3) =       0.000514419486
  error estimate for blocks of size 2^( 4) =       0.000529973639
  error estimate for blocks of size 2^( 5) =       0.000539726815
  error estimate for blocks of size 2^( 6) =       0.000543841480
  error estimate for blocks of size 2^( 7) =       0.000545820794

      target function =      -0.746239390670
              le_mean =     -22.661695072110
             les_mean =     514.001295614294
             stat err =       0.000539840682
             autocorr =       1.329869585975
   target nu stat err =       0.000539840682
   target dn stat err =       0.002625500006
      target stat err =       0.002238427616
              std dev =       0.662027577146
             le_variance =       0.438280512902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438343817933
                                         uncertainty =       0.002137978842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438343817933
                                         uncertainty =       0.002137978842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468126861
  error estimate for blocks of size 2^( 2) =       0.000492499334
  error estimate for blocks of size 2^( 3) =       0.000514420960
  error estimate for blocks of size 2^( 4) =       0.000529974760
  error estimate for blocks of size 2^( 5) =       0.000539728910
  error estimate for blocks of size 2^( 6) =       0.000543841792
  error estimate for blocks of size 2^( 7) =       0.000545820985

      target function =      -0.746167699769
              le_mean =     -22.661694930603
             les_mean =     514.001376346017
             stat err =       0.000539841612
             autocorr =       1.329858984638
   target nu stat err =       0.000539841612
   target dn stat err =       0.002639913868
      target stat err =       0.002249434379
              std dev =       0.662031356216
             le_variance =       0.438285516613


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746153718498        initial
     2.3842e+00     2.3842e+01             1.1631e-04        -0.746244034951  <--
     9.5367e+00     9.5367e+01             2.9428e-05        -0.746239390670
     3.8147e+01     3.8147e+02             7.3794e-06        -0.746167699769

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 4.3638e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -7.020347e-01 3 1  ON 0
ci_002                -7.059113e-01 3 1  ON 1
ci_003                -5.342766e-02 3 1  ON 2
ci_004                -5.446642e-02 3 1  ON 3
ci_005                 1.975092e-02 3 1  ON 4
ci_006                 1.982332e-02 3 1  ON 5
ci_007                 1.616164e-02 3 1  ON 6
ci_008                 1.597205e-02 3 1  ON 7
ci_009                -1.235548e-02 3 1  ON 8
ci_010                -1.270464e-02 3 1  ON 9
ci_011                -9.751457e-03 3 1  ON 10
ci_012                -9.894600e-03 3 1  ON 11
ci_013                 8.896145e-03 3 1  ON 12
ci_014                 8.910669e-03 3 1  ON 13
ci_015                 9.329628e-03 3 1  ON 14
ci_016                 9.648075e-03 3 1  ON 15
ci_017                 8.642127e-03 3 1  ON 16
ci_018                 8.305033e-03 3 1  ON 17
ci_019                -1.156035e-03 3 1  ON 18
ci_020                -1.114886e-03 3 1  ON 19
ci_021                -1.037417e-02 3 1  ON 20
ci_022                -1.102242e-02 3 1  ON 21
ci_023                 5.513846e-03 3 1  ON 22
ci_024                 5.303228e-03 3 1  ON 23
ci_025                 1.290054e-02 3 1  ON 24
ci_026                 1.242828e-02 3 1  ON 25
ci_027                 6.259656e-03 3 1  ON 26
ci_028                 6.239303e-03 3 1  ON 27
ci_029                -3.704746e-03 3 1  ON 28
ci_030                -4.461602e-03 3 1  ON 29
ci_031                 4.027403e-03 3 1  ON 30
ci_032                 3.601963e-03 3 1  ON 31
ci_033                 3.444964e-03 3 1  ON 32
ci_034                 3.363937e-03 3 1  ON 33
ci_035                 2.289301e-03 3 1  ON 34
ci_036                 2.162066e-03 3 1  ON 35
ci_037                 3.400751e-03 3 1  ON 36
ci_038                 3.337688e-03 3 1  ON 37
ci_039                 4.274769e-03 3 1  ON 38
ci_040                 4.412515e-03 3 1  ON 39
ci_041                 2.799687e-03 3 1  ON 40
ci_042                 2.943374e-03 3 1  ON 41
ci_043                 3.497297e-03 3 1  ON 42
ci_044                 3.226252e-03 3 1  ON 43
ci_045                 2.507970e-03 3 1  ON 44
ci_046                 2.925694e-03 3 1  ON 45
ci_047                -9.927723e-04 3 1  ON 46
ci_048                -1.163617e-03 3 1  ON 47
ci_049                 7.432068e-04 3 1  ON 48
ci_050                 7.970231e-04 3 1  ON 49
ci_051                -1.525973e-03 3 1  ON 50
ci_052                -1.463774e-03 3 1  ON 51
ci_053                -2.550289e-03 3 1  ON 52
ci_054                -2.629493e-03 3 1  ON 53
ci_055                -1.588151e-03 3 1  ON 54
ci_056                -1.331388e-03 3 1  ON 55
ci_057                -1.040750e-03 3 1  ON 56
ci_058                -1.019920e-03 3 1  ON 57
ci_059                -3.957763e-04 3 1  ON 58
ci_060                -1.855345e-04 3 1  ON 59
ci_061                -6.607168e-04 3 1  ON 60
ci_062                -5.338279e-04 3 1  ON 61
ci_063                -6.327266e-04 3 1  ON 62
ci_064                -7.172344e-04 3 1  ON 63
ci_065                -1.751823e-03 3 1  ON 64
ci_066                -1.686655e-03 3 1  ON 65
ci_067                -1.597981e-03 3 1  ON 66
ci_068                -1.618317e-03 3 1  ON 67
ci_069                 1.195579e-05 3 1  ON 68
ci_070                 1.951173e-04 3 1  ON 69
ci_071                -1.533153e-03 3 1  ON 70
ci_072                -1.952439e-03 3 1  ON 71
ci_073                 1.522133e-04 3 1  ON 72
ci_074                 1.517759e-04 3 1  ON 73
ci_075                 5.349096e-05 3 1  ON 74
ci_076                 2.417688e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9965e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.6198
    reference variance = 0.293689
====================================================
  Execution time = 2.6128e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5427e-01
  Total weights = 1.955369089e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444042801838
                                         uncertainty =       0.002916570477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444042801838
                                         uncertainty =       0.002916570477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471161918
  error estimate for blocks of size 2^( 2) =       0.000494977896
  error estimate for blocks of size 2^( 3) =       0.000516878433
  error estimate for blocks of size 2^( 4) =       0.000532998108
  error estimate for blocks of size 2^( 5) =       0.000543393377
  error estimate for blocks of size 2^( 6) =       0.000548776508
  error estimate for blocks of size 2^( 7) =       0.000551141328

      target function =      -0.741826174529
              le_mean =     -22.662377394248
             les_mean =     514.037621430057
             stat err =       0.000544077330
             autocorr =       1.333462783392
   target nu stat err =       0.000544077330
   target dn stat err =       0.003429524202
      target stat err =       0.002851504161
              std dev =       0.666323574733
             le_variance =       0.443987106244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266237739425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741836268202       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741878246694       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741887200500       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741888153810       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741888199152       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741888288584       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741888266528       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741888280894       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741888280111       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741888262140       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741888259955       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741888256228       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 4.075870e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741836268202       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741847372133       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741849685438       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741849922922       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741849932154       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741849953650       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741849947300       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741849950676       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741849950201       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741849945973       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741849945518       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741849944844       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.069327e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741836268202       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741839085067       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741839668196       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741839727469       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741839729635       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741839734953       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741839733314       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741839734145       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741839734008       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741839732970       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741839732862       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741839732708       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 2.706784e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0841e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -7.020673e-01 3 1  ON 0
ci_002                -7.058924e-01 3 1  ON 1
ci_003                -5.338933e-02 3 1  ON 2
ci_004                -5.439368e-02 3 1  ON 3
ci_005                 1.970439e-02 3 1  ON 4
ci_006                 1.978143e-02 3 1  ON 5
ci_007                 1.613237e-02 3 1  ON 6
ci_008                 1.593310e-02 3 1  ON 7
ci_009                -1.232533e-02 3 1  ON 8
ci_010                -1.267164e-02 3 1  ON 9
ci_011                -9.710957e-03 3 1  ON 10
ci_012                -9.853750e-03 3 1  ON 11
ci_013                 8.870913e-03 3 1  ON 12
ci_014                 8.885851e-03 3 1  ON 13
ci_015                 9.301247e-03 3 1  ON 14
ci_016                 9.572048e-03 3 1  ON 15
ci_017                 8.653734e-03 3 1  ON 16
ci_018                 8.296673e-03 3 1  ON 17
ci_019                -1.205268e-03 3 1  ON 18
ci_020                -1.199774e-03 3 1  ON 19
ci_021                -1.048111e-02 3 1  ON 20
ci_022                -1.106688e-02 3 1  ON 21
ci_023                 5.474969e-03 3 1  ON 22
ci_024                 5.302867e-03 3 1  ON 23
ci_025                 1.289161e-02 3 1  ON 24
ci_026                 1.251138e-02 3 1  ON 25
ci_027                 6.253700e-03 3 1  ON 26
ci_028                 6.255303e-03 3 1  ON 27
ci_029                -3.705408e-03 3 1  ON 28
ci_030                -4.469252e-03 3 1  ON 29
ci_031                 4.088772e-03 3 1  ON 30
ci_032                 3.614297e-03 3 1  ON 31
ci_033                 3.462699e-03 3 1  ON 32
ci_034                 3.340931e-03 3 1  ON 33
ci_035                 2.281213e-03 3 1  ON 34
ci_036                 2.140169e-03 3 1  ON 35
ci_037                 3.383502e-03 3 1  ON 36
ci_038                 3.342307e-03 3 1  ON 37
ci_039                 4.270251e-03 3 1  ON 38
ci_040                 4.417764e-03 3 1  ON 39
ci_041                 2.785169e-03 3 1  ON 40
ci_042                 2.955436e-03 3 1  ON 41
ci_043                 3.467930e-03 3 1  ON 42
ci_044                 3.194393e-03 3 1  ON 43
ci_045                 2.497826e-03 3 1  ON 44
ci_046                 2.902555e-03 3 1  ON 45
ci_047                -9.801351e-04 3 1  ON 46
ci_048                -1.160160e-03 3 1  ON 47
ci_049                 7.060967e-04 3 1  ON 48
ci_050                 8.041607e-04 3 1  ON 49
ci_051                -1.529354e-03 3 1  ON 50
ci_052                -1.442595e-03 3 1  ON 51
ci_053                -2.538455e-03 3 1  ON 52
ci_054                -2.609024e-03 3 1  ON 53
ci_055                -1.570545e-03 3 1  ON 54
ci_056                -1.328709e-03 3 1  ON 55
ci_057                -1.036913e-03 3 1  ON 56
ci_058                -1.037911e-03 3 1  ON 57
ci_059                -4.148241e-04 3 1  ON 58
ci_060                -1.847415e-04 3 1  ON 59
ci_061                -6.648190e-04 3 1  ON 60
ci_062                -5.463435e-04 3 1  ON 61
ci_063                -6.166272e-04 3 1  ON 62
ci_064                -7.296244e-04 3 1  ON 63
ci_065                -1.721450e-03 3 1  ON 64
ci_066                -1.756176e-03 3 1  ON 65
ci_067                -1.590868e-03 3 1  ON 66
ci_068                -1.597035e-03 3 1  ON 67
ci_069                -6.815817e-06 3 1  ON 68
ci_070                 1.953061e-04 3 1  ON 69
ci_071                -1.539849e-03 3 1  ON 70
ci_072                -1.930143e-03 3 1  ON 71
ci_073                 1.509705e-04 3 1  ON 72
ci_074                 1.510518e-04 3 1  ON 73
ci_075                 8.866069e-05 3 1  ON 74
ci_076                 2.291375e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.6652
    reference variance = 0.435604
====================================================
  Execution time = 2.6721e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4799e-01
  Total weights = 1.9552e+06
  Execution time = 3.6212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440590904701
                                         uncertainty =       0.002960497513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440590904701
                                         uncertainty =       0.002960497513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469340532
  error estimate for blocks of size 2^( 2) =       0.000493401021
  error estimate for blocks of size 2^( 3) =       0.000515611312
  error estimate for blocks of size 2^( 4) =       0.000531970138
  error estimate for blocks of size 2^( 5) =       0.000541111082
  error estimate for blocks of size 2^( 6) =       0.000545279088
  error estimate for blocks of size 2^( 7) =       0.000550867278

      target function =      -0.746947979629
              le_mean =     -22.661918378081
             les_mean =     514.010553681554
             stat err =       0.000542306897
             autocorr =       1.335101032203
   target nu stat err =       0.000542306897
   target dn stat err =       0.003429356499
      target stat err =       0.002887652447
              std dev =       0.663747746318
             le_variance =       0.440561070742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440478294642
                                         uncertainty =       0.002942918462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440478294642
                                         uncertainty =       0.002942918462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469280771
  error estimate for blocks of size 2^( 2) =       0.000493349892
  error estimate for blocks of size 2^( 3) =       0.000515570905
  error estimate for blocks of size 2^( 4) =       0.000531935125
  error estimate for blocks of size 2^( 5) =       0.000541078110
  error estimate for blocks of size 2^( 6) =       0.000545250978
  error estimate for blocks of size 2^( 7) =       0.000550839440

      target function =      -0.746463486650
              le_mean =     -22.661922340587
             les_mean =     514.011321826794
             stat err =       0.000542275913
             autocorr =       1.335288506190
   target nu stat err =       0.000542275913
   target dn stat err =       0.003434845705
      target stat err =       0.002888415995
              std dev =       0.663663230732
             le_variance =       0.440448883826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440529260431
                                         uncertainty =       0.002951280375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440529260431
                                         uncertainty =       0.002951280375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469307814
  error estimate for blocks of size 2^( 2) =       0.000493373093
  error estimate for blocks of size 2^( 3) =       0.000515589092
  error estimate for blocks of size 2^( 4) =       0.000531950940
  error estimate for blocks of size 2^( 5) =       0.000541092790
  error estimate for blocks of size 2^( 6) =       0.000545263643
  error estimate for blocks of size 2^( 7) =       0.000550851708

      target function =      -0.746811087100
              le_mean =     -22.661919891688
             les_mean =     514.010788550672
             stat err =       0.000542289770
             autocorr =       1.335202859018
   target nu stat err =       0.000542289770
   target dn stat err =       0.003425254301
      target stat err =       0.002883314512
              std dev =       0.663701475304
             le_variance =       0.440499648321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440582803386
                                         uncertainty =       0.002959326825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440582803386
                                         uncertainty =       0.002959326825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469336232
  error estimate for blocks of size 2^( 2) =       0.000493397313
  error estimate for blocks of size 2^( 3) =       0.000515608332
  error estimate for blocks of size 2^( 4) =       0.000531967532
  error estimate for blocks of size 2^( 5) =       0.000541108615
  error estimate for blocks of size 2^( 6) =       0.000545276947
  error estimate for blocks of size 2^( 7) =       0.000550865124

      target function =      -0.746957177302
              le_mean =     -22.661918523750
             les_mean =     514.010549129838
             stat err =       0.000542304554
             autocorr =       1.335113964492
   target nu stat err =       0.000542304554
   target dn stat err =       0.003428157318
      target stat err =       0.002886755638
              std dev =       0.663741664794
             le_variance =       0.440552997584


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746947979629        initial
     5.9605e-01     5.9605e+00             4.0759e-04        -0.746463486650
     2.3842e+00     2.3842e+01             1.0693e-04        -0.746811087100
     9.5367e+00     9.5367e+01             2.7068e-05        -0.746957177302  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 4.4860e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -7.020428e-01 3 1  ON 0
ci_002                -7.059066e-01 3 1  ON 1
ci_003                -5.341803e-02 3 1  ON 2
ci_004                -5.444815e-02 3 1  ON 3
ci_005                 1.973910e-02 3 1  ON 4
ci_006                 1.981269e-02 3 1  ON 5
ci_007                 1.615422e-02 3 1  ON 6
ci_008                 1.596218e-02 3 1  ON 7
ci_009                -1.234784e-02 3 1  ON 8
ci_010                -1.269627e-02 3 1  ON 9
ci_011                -9.741181e-03 3 1  ON 10
ci_012                -9.884253e-03 3 1  ON 11
ci_013                 8.889746e-03 3 1  ON 12
ci_014                 8.904372e-03 3 1  ON 13
ci_015                 9.322453e-03 3 1  ON 14
ci_016                 9.628847e-03 3 1  ON 15
ci_017                 8.645049e-03 3 1  ON 16
ci_018                 8.302909e-03 3 1  ON 17
ci_019                -1.168505e-03 3 1  ON 18
ci_020                -1.136362e-03 3 1  ON 19
ci_021                -1.040124e-02 3 1  ON 20
ci_022                -1.103368e-02 3 1  ON 21
ci_023                 5.503976e-03 3 1  ON 22
ci_024                 5.303140e-03 3 1  ON 23
ci_025                 1.289828e-02 3 1  ON 24
ci_026                 1.244930e-02 3 1  ON 25
ci_027                 6.258142e-03 3 1  ON 26
ci_028                 6.243371e-03 3 1  ON 27
ci_029                -3.704907e-03 3 1  ON 28
ci_030                -4.463550e-03 3 1  ON 29
ci_031                 4.042918e-03 3 1  ON 30
ci_032                 3.605087e-03 3 1  ON 31
ci_033                 3.449457e-03 3 1  ON 32
ci_034                 3.358112e-03 3 1  ON 33
ci_035                 2.287251e-03 3 1  ON 34
ci_036                 2.156507e-03 3 1  ON 35
ci_037                 3.396386e-03 3 1  ON 36
ci_038                 3.338857e-03 3 1  ON 37
ci_039                 4.273619e-03 3 1  ON 38
ci_040                 4.413847e-03 3 1  ON 39
ci_041                 2.796001e-03 3 1  ON 40
ci_042                 2.946437e-03 3 1  ON 41
ci_043                 3.489859e-03 3 1  ON 42
ci_044                 3.218181e-03 3 1  ON 43
ci_045                 2.505403e-03 3 1  ON 44
ci_046                 2.919827e-03 3 1  ON 45
ci_047                -9.895623e-04 3 1  ON 46
ci_048                -1.162741e-03 3 1  ON 47
ci_049                 7.337833e-04 3 1  ON 48
ci_050                 7.988295e-04 3 1  ON 49
ci_051                -1.526834e-03 3 1  ON 50
ci_052                -1.458412e-03 3 1  ON 51
ci_053                -2.547288e-03 3 1  ON 52
ci_054                -2.624302e-03 3 1  ON 53
ci_055                -1.583693e-03 3 1  ON 54
ci_056                -1.330710e-03 3 1  ON 55
ci_057                -1.039777e-03 3 1  ON 56
ci_058                -1.024487e-03 3 1  ON 57
ci_059                -4.006190e-04 3 1  ON 58
ci_060                -1.853355e-04 3 1  ON 59
ci_061                -6.617604e-04 3 1  ON 60
ci_062                -5.370020e-04 3 1  ON 61
ci_063                -6.286460e-04 3 1  ON 62
ci_064                -7.203730e-04 3 1  ON 63
ci_065                -1.744135e-03 3 1  ON 64
ci_066                -1.704276e-03 3 1  ON 65
ci_067                -1.596175e-03 3 1  ON 66
ci_068                -1.612926e-03 3 1  ON 67
ci_069                 7.206925e-06 3 1  ON 68
ci_070                 1.951615e-04 3 1  ON 69
ci_071                -1.534850e-03 3 1  ON 70
ci_072                -1.946796e-03 3 1  ON 71
ci_073                 1.518983e-04 3 1  ON 72
ci_074                 1.515965e-04 3 1  ON 73
ci_075                 6.239993e-05 3 1  ON 74
ci_076                 2.385692e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7395
    reference variance = 0.315102
====================================================
  Execution time = 2.6055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4765e-01
  Total weights = 1.955239957e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440262823127
                                         uncertainty =       0.001899566690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440262823127
                                         uncertainty =       0.001899566690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469170488
  error estimate for blocks of size 2^( 2) =       0.000492524568
  error estimate for blocks of size 2^( 3) =       0.000514239798
  error estimate for blocks of size 2^( 4) =       0.000531231854
  error estimate for blocks of size 2^( 5) =       0.000541016073
  error estimate for blocks of size 2^( 6) =       0.000545594171
  error estimate for blocks of size 2^( 7) =       0.000545349619

      target function =      -0.747265713079
              le_mean =     -22.662925433336
             les_mean =     514.055835075916
             stat err =       0.000540797929
             autocorr =       1.328644111740
   target nu stat err =       0.000540797929
   target dn stat err =       0.002341156083
      target stat err =       0.002023351663
              std dev =       0.663507267727
             le_variance =       0.440241894326


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266292543334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747270242285       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747277142543       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747278922967       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747279083556       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747279106668       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747279121963       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747279164420       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747279179937       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747279177403       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747279172239       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747279171300       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747279172628       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 8.130665e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747270242285       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747271994463       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747272442996       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747272483180       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747272488881       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747272492685       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747272503209       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747272506952       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747272506302       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747272505034       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747272504813       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747272505137       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 2.059165e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747270242285       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747270682057       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747270794405       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747270804453       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747270805874       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747270806823       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747270809448       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747270810376       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747270810212       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747270809897       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747270809842       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747270809923       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 5.164746e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305538 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0751e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -7.020585e-01 3 1  ON 0
ci_002                -7.058925e-01 3 1  ON 1
ci_003                -5.341446e-02 3 1  ON 2
ci_004                -5.445413e-02 3 1  ON 3
ci_005                 1.973559e-02 3 1  ON 4
ci_006                 1.981088e-02 3 1  ON 5
ci_007                 1.615107e-02 3 1  ON 6
ci_008                 1.594553e-02 3 1  ON 7
ci_009                -1.233794e-02 3 1  ON 8
ci_010                -1.268952e-02 3 1  ON 9
ci_011                -9.740498e-03 3 1  ON 10
ci_012                -9.875198e-03 3 1  ON 11
ci_013                 8.888143e-03 3 1  ON 12
ci_014                 8.896070e-03 3 1  ON 13
ci_015                 9.301862e-03 3 1  ON 14
ci_016                 9.614541e-03 3 1  ON 15
ci_017                 8.641473e-03 3 1  ON 16
ci_018                 8.301954e-03 3 1  ON 17
ci_019                -1.184714e-03 3 1  ON 18
ci_020                -1.155152e-03 3 1  ON 19
ci_021                -1.039327e-02 3 1  ON 20
ci_022                -1.103850e-02 3 1  ON 21
ci_023                 5.502928e-03 3 1  ON 22
ci_024                 5.302284e-03 3 1  ON 23
ci_025                 1.290087e-02 3 1  ON 24
ci_026                 1.246138e-02 3 1  ON 25
ci_027                 6.256912e-03 3 1  ON 26
ci_028                 6.244918e-03 3 1  ON 27
ci_029                -3.700308e-03 3 1  ON 28
ci_030                -4.459078e-03 3 1  ON 29
ci_031                 4.041516e-03 3 1  ON 30
ci_032                 3.618096e-03 3 1  ON 31
ci_033                 3.442869e-03 3 1  ON 32
ci_034                 3.359439e-03 3 1  ON 33
ci_035                 2.284416e-03 3 1  ON 34
ci_036                 2.144143e-03 3 1  ON 35
ci_037                 3.396414e-03 3 1  ON 36
ci_038                 3.335358e-03 3 1  ON 37
ci_039                 4.272603e-03 3 1  ON 38
ci_040                 4.407366e-03 3 1  ON 39
ci_041                 2.792785e-03 3 1  ON 40
ci_042                 2.944349e-03 3 1  ON 41
ci_043                 3.487619e-03 3 1  ON 42
ci_044                 3.218311e-03 3 1  ON 43
ci_045                 2.503070e-03 3 1  ON 44
ci_046                 2.910495e-03 3 1  ON 45
ci_047                -9.891567e-04 3 1  ON 46
ci_048                -1.167299e-03 3 1  ON 47
ci_049                 7.383130e-04 3 1  ON 48
ci_050                 7.943650e-04 3 1  ON 49
ci_051                -1.516284e-03 3 1  ON 50
ci_052                -1.459322e-03 3 1  ON 51
ci_053                -2.548151e-03 3 1  ON 52
ci_054                -2.627795e-03 3 1  ON 53
ci_055                -1.582989e-03 3 1  ON 54
ci_056                -1.330227e-03 3 1  ON 55
ci_057                -1.037467e-03 3 1  ON 56
ci_058                -1.028909e-03 3 1  ON 57
ci_059                -3.977838e-04 3 1  ON 58
ci_060                -1.860101e-04 3 1  ON 59
ci_061                -6.604672e-04 3 1  ON 60
ci_062                -5.347970e-04 3 1  ON 61
ci_063                -6.299883e-04 3 1  ON 62
ci_064                -7.216183e-04 3 1  ON 63
ci_065                -1.740946e-03 3 1  ON 64
ci_066                -1.704352e-03 3 1  ON 65
ci_067                -1.603432e-03 3 1  ON 66
ci_068                -1.615658e-03 3 1  ON 67
ci_069                 1.305106e-06 3 1  ON 68
ci_070                 1.955757e-04 3 1  ON 69
ci_071                -1.534921e-03 3 1  ON 70
ci_072                -1.940333e-03 3 1  ON 71
ci_073                 1.519888e-04 3 1  ON 72
ci_074                 1.475817e-04 3 1  ON 73
ci_075                 6.460064e-05 3 1  ON 74
ci_076                 2.373482e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6181
    reference variance = 0.345739
====================================================
  Execution time = 2.7286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4817e-01
  Total weights = 1.9548e+06
  Execution time = 3.6272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439557397241
                                         uncertainty =       0.002709719883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439557397241
                                         uncertainty =       0.002709719883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468805045
  error estimate for blocks of size 2^( 2) =       0.000492622521
  error estimate for blocks of size 2^( 3) =       0.000515573997
  error estimate for blocks of size 2^( 4) =       0.000531506263
  error estimate for blocks of size 2^( 5) =       0.000540454042
  error estimate for blocks of size 2^( 6) =       0.000545542850
  error estimate for blocks of size 2^( 7) =       0.000546395491

      target function =      -0.746795937797
              le_mean =     -22.660889524367
             les_mean =     513.964089170559
             stat err =       0.000540974662
             autocorr =       1.331586227559
   target nu stat err =       0.000540974662
   target dn stat err =       0.003628882597
      target stat err =       0.003042522276
              std dev =       0.662990452587
             le_variance =       0.439556340222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439535851622
                                         uncertainty =       0.002699951535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439535851622
                                         uncertainty =       0.002699951535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468793585
  error estimate for blocks of size 2^( 2) =       0.000492612774
  error estimate for blocks of size 2^( 3) =       0.000515564742
  error estimate for blocks of size 2^( 4) =       0.000531498643
  error estimate for blocks of size 2^( 5) =       0.000540446485
  error estimate for blocks of size 2^( 6) =       0.000545536283
  error estimate for blocks of size 2^( 7) =       0.000546388367

      target function =      -0.746777371166
              le_mean =     -22.660889999489
             les_mean =     513.964133442611
             stat err =       0.000540967445
             autocorr =       1.331615801389
   target nu stat err =       0.000540967445
   target dn stat err =       0.003610272643
      target stat err =       0.003027371186
              std dev =       0.662974245849
             le_variance =       0.439534850659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439546362795
                                         uncertainty =       0.002704776463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439546362795
                                         uncertainty =       0.002704776463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468799176
  error estimate for blocks of size 2^( 2) =       0.000492617522
  error estimate for blocks of size 2^( 3) =       0.000515569249
  error estimate for blocks of size 2^( 4) =       0.000531502344
  error estimate for blocks of size 2^( 5) =       0.000540450154
  error estimate for blocks of size 2^( 6) =       0.000545539477
  error estimate for blocks of size 2^( 7) =       0.000546391796

      target function =      -0.746767217061
              le_mean =     -22.660889746307
             les_mean =     513.964134244359
             stat err =       0.000540970943
             autocorr =       1.331601263710
   target nu stat err =       0.000540970943
   target dn stat err =       0.003619124224
      target stat err =       0.003034425618
              std dev =       0.662982152159
             le_variance =       0.439545334082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439555998635
                                         uncertainty =       0.002709098780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439555998635
                                         uncertainty =       0.002709098780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468804301
  error estimate for blocks of size 2^( 2) =       0.000492621886
  error estimate for blocks of size 2^( 3) =       0.000515573394
  error estimate for blocks of size 2^( 4) =       0.000531505765
  error estimate for blocks of size 2^( 5) =       0.000540453545
  error estimate for blocks of size 2^( 6) =       0.000545542417
  error estimate for blocks of size 2^( 7) =       0.000546395017

      target function =      -0.746797825169
              le_mean =     -22.660889549157
             les_mean =     513.964088009174
             stat err =       0.000540974186
             autocorr =       1.331588111654
   target nu stat err =       0.000540974186
   target dn stat err =       0.003627593401
      target stat err =       0.003041497871
              std dev =       0.662989400498
             le_variance =       0.439554945173


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746795937797        initial
     2.3842e+00     2.3842e+01             8.1307e-05        -0.746777371166
     9.5367e+00     9.5367e+01             2.0592e-05        -0.746767217061
     3.8147e+01     3.8147e+02             5.1647e-06        -0.746797825169  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 4.5357e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -7.020467e-01 3 1  ON 0
ci_002                -7.059030e-01 3 1  ON 1
ci_003                -5.341714e-02 3 1  ON 2
ci_004                -5.444965e-02 3 1  ON 3
ci_005                 1.973822e-02 3 1  ON 4
ci_006                 1.981224e-02 3 1  ON 5
ci_007                 1.615343e-02 3 1  ON 6
ci_008                 1.595800e-02 3 1  ON 7
ci_009                -1.234535e-02 3 1  ON 8
ci_010                -1.269458e-02 3 1  ON 9
ci_011                -9.741009e-03 3 1  ON 10
ci_012                -9.881982e-03 3 1  ON 11
ci_013                 8.889344e-03 3 1  ON 12
ci_014                 8.902290e-03 3 1  ON 13
ci_015                 9.317288e-03 3 1  ON 14
ci_016                 9.625260e-03 3 1  ON 15
ci_017                 8.644152e-03 3 1  ON 16
ci_018                 8.302669e-03 3 1  ON 17
ci_019                -1.172569e-03 3 1  ON 18
ci_020                -1.141074e-03 3 1  ON 19
ci_021                -1.039924e-02 3 1  ON 20
ci_022                -1.103489e-02 3 1  ON 21
ci_023                 5.503713e-03 3 1  ON 22
ci_024                 5.302926e-03 3 1  ON 23
ci_025                 1.289893e-02 3 1  ON 24
ci_026                 1.245233e-02 3 1  ON 25
ci_027                 6.257833e-03 3 1  ON 26
ci_028                 6.243759e-03 3 1  ON 27
ci_029                -3.703754e-03 3 1  ON 28
ci_030                -4.462428e-03 3 1  ON 29
ci_031                 4.042567e-03 3 1  ON 30
ci_032                 3.608349e-03 3 1  ON 31
ci_033                 3.447804e-03 3 1  ON 32
ci_034                 3.358445e-03 3 1  ON 33
ci_035                 2.286539e-03 3 1  ON 34
ci_036                 2.153403e-03 3 1  ON 35
ci_037                 3.396393e-03 3 1  ON 36
ci_038                 3.337979e-03 3 1  ON 37
ci_039                 4.273364e-03 3 1  ON 38
ci_040                 4.412220e-03 3 1  ON 39
ci_041                 2.795193e-03 3 1  ON 40
ci_042                 2.945913e-03 3 1  ON 41
ci_043                 3.489297e-03 3 1  ON 42
ci_044                 3.218214e-03 3 1  ON 43
ci_045                 2.504818e-03 3 1  ON 44
ci_046                 2.917486e-03 3 1  ON 45
ci_047                -9.894606e-04 3 1  ON 46
ci_048                -1.163886e-03 3 1  ON 47
ci_049                 7.349197e-04 3 1  ON 48
ci_050                 7.977094e-04 3 1  ON 49
ci_051                -1.524188e-03 3 1  ON 50
ci_052                -1.458641e-03 3 1  ON 51
ci_053                -2.547505e-03 3 1  ON 52
ci_054                -2.625177e-03 3 1  ON 53
ci_055                -1.583517e-03 3 1  ON 54
ci_056                -1.330589e-03 3 1  ON 55
ci_057                -1.039198e-03 3 1  ON 56
ci_058                -1.025597e-03 3 1  ON 57
ci_059                -3.999070e-04 3 1  ON 58
ci_060                -1.855050e-04 3 1  ON 59
ci_061                -6.614359e-04 3 1  ON 60
ci_062                -5.364489e-04 3 1  ON 61
ci_063                -6.289827e-04 3 1  ON 62
ci_064                -7.206852e-04 3 1  ON 63
ci_065                -1.743335e-03 3 1  ON 64
ci_066                -1.704295e-03 3 1  ON 65
ci_067                -1.597995e-03 3 1  ON 66
ci_068                -1.613611e-03 3 1  ON 67
ci_069                 5.726426e-06 3 1  ON 68
ci_070                 1.952654e-04 3 1  ON 69
ci_071                -1.534868e-03 3 1  ON 70
ci_072                -1.945174e-03 3 1  ON 71
ci_073                 1.519210e-04 3 1  ON 72
ci_074                 1.505884e-04 3 1  ON 73
ci_075                 6.295176e-05 3 1  ON 74
ci_076                 2.382628e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6114e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7222
    reference variance = 0.651776
====================================================
  Execution time = 2.5985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5042e-01
  Total weights = 1.955454231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441580178587
                                         uncertainty =       0.002288639911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441580178587
                                         uncertainty =       0.002288639911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469873771
  error estimate for blocks of size 2^( 2) =       0.000493920217
  error estimate for blocks of size 2^( 3) =       0.000515954357
  error estimate for blocks of size 2^( 4) =       0.000531947557
  error estimate for blocks of size 2^( 5) =       0.000541542684
  error estimate for blocks of size 2^( 6) =       0.000545615372
  error estimate for blocks of size 2^( 7) =       0.000549359562

      target function =      -0.744959268677
              le_mean =     -22.661267801215
             les_mean =     513.983482142014
             stat err =       0.000542116294
             autocorr =       1.331136266538
   target nu stat err =       0.000542116294
   target dn stat err =       0.003061655378
      target stat err =       0.002576127915
              std dev =       0.664501859514
             le_variance =       0.441562721297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266126780122e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744967356208       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744969505807       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744970001103       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744970033405       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744970047905       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744970072080       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744970080469       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744970084943       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744970083125       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744970084452       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744970083257       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744970082404       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 2.344706e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744967356208       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744967895594       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744968019650       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744968027715       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744968031336       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744968037372       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744968039456       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744968040567       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744968040112       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744968040441       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744968040143       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744968039931       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 5.879732e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744967356208       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744967491179       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744967522208       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744967524223       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744967525128       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744967526637       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744967527157       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744967527434       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744967527321       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744967527402       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744967527328       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744967527276       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+02 is 1.471060e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0699e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -7.020492e-01 3 1  ON 0
ci_002                -7.059010e-01 3 1  ON 1
ci_003                -5.341375e-02 3 1  ON 2
ci_004                -5.445098e-02 3 1  ON 3
ci_005                 1.973463e-02 3 1  ON 4
ci_006                 1.981060e-02 3 1  ON 5
ci_007                 1.615074e-02 3 1  ON 6
ci_008                 1.595781e-02 3 1  ON 7
ci_009                -1.234293e-02 3 1  ON 8
ci_010                -1.269292e-02 3 1  ON 9
ci_011                -9.743228e-03 3 1  ON 10
ci_012                -9.881636e-03 3 1  ON 11
ci_013                 8.889574e-03 3 1  ON 12
ci_014                 8.897490e-03 3 1  ON 13
ci_015                 9.315405e-03 3 1  ON 14
ci_016                 9.621454e-03 3 1  ON 15
ci_017                 8.643645e-03 3 1  ON 16
ci_018                 8.301664e-03 3 1  ON 17
ci_019                -1.178449e-03 3 1  ON 18
ci_020                -1.146501e-03 3 1  ON 19
ci_021                -1.040437e-02 3 1  ON 20
ci_022                -1.103476e-02 3 1  ON 21
ci_023                 5.502575e-03 3 1  ON 22
ci_024                 5.301257e-03 3 1  ON 23
ci_025                 1.290223e-02 3 1  ON 24
ci_026                 1.245582e-02 3 1  ON 25
ci_027                 6.258075e-03 3 1  ON 26
ci_028                 6.243821e-03 3 1  ON 27
ci_029                -3.703674e-03 3 1  ON 28
ci_030                -4.461709e-03 3 1  ON 29
ci_031                 4.044302e-03 3 1  ON 30
ci_032                 3.609741e-03 3 1  ON 31
ci_033                 3.446921e-03 3 1  ON 32
ci_034                 3.356734e-03 3 1  ON 33
ci_035                 2.286318e-03 3 1  ON 34
ci_036                 2.152486e-03 3 1  ON 35
ci_037                 3.395825e-03 3 1  ON 36
ci_038                 3.337841e-03 3 1  ON 37
ci_039                 4.273085e-03 3 1  ON 38
ci_040                 4.414038e-03 3 1  ON 39
ci_041                 2.795402e-03 3 1  ON 40
ci_042                 2.946319e-03 3 1  ON 41
ci_043                 3.490713e-03 3 1  ON 42
ci_044                 3.218673e-03 3 1  ON 43
ci_045                 2.506374e-03 3 1  ON 44
ci_046                 2.917659e-03 3 1  ON 45
ci_047                -9.876680e-04 3 1  ON 46
ci_048                -1.163498e-03 3 1  ON 47
ci_049                 7.347005e-04 3 1  ON 48
ci_050                 7.971180e-04 3 1  ON 49
ci_051                -1.523364e-03 3 1  ON 50
ci_052                -1.458508e-03 3 1  ON 51
ci_053                -2.546578e-03 3 1  ON 52
ci_054                -2.626675e-03 3 1  ON 53
ci_055                -1.581959e-03 3 1  ON 54
ci_056                -1.328406e-03 3 1  ON 55
ci_057                -1.038813e-03 3 1  ON 56
ci_058                -1.024418e-03 3 1  ON 57
ci_059                -4.007810e-04 3 1  ON 58
ci_060                -1.860681e-04 3 1  ON 59
ci_061                -6.622652e-04 3 1  ON 60
ci_062                -5.369285e-04 3 1  ON 61
ci_063                -6.279923e-04 3 1  ON 62
ci_064                -7.228452e-04 3 1  ON 63
ci_065                -1.743154e-03 3 1  ON 64
ci_066                -1.704467e-03 3 1  ON 65
ci_067                -1.598726e-03 3 1  ON 66
ci_068                -1.614185e-03 3 1  ON 67
ci_069                 5.071524e-06 3 1  ON 68
ci_070                 1.947480e-04 3 1  ON 69
ci_071                -1.535391e-03 3 1  ON 70
ci_072                -1.943793e-03 3 1  ON 71
ci_073                 1.521642e-04 3 1  ON 72
ci_074                 1.507343e-04 3 1  ON 73
ci_075                 6.162015e-05 3 1  ON 74
ci_076                 2.381770e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.687
    reference variance = 0.340158
====================================================
  Execution time = 2.5258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5264e-01
  Total weights = 1.9551e+06
  Execution time = 3.6316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442961243980
                                         uncertainty =       0.003012842159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442961243980
                                         uncertainty =       0.003012842159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470610047
  error estimate for blocks of size 2^( 2) =       0.000494709861
  error estimate for blocks of size 2^( 3) =       0.000516829233
  error estimate for blocks of size 2^( 4) =       0.000532605393
  error estimate for blocks of size 2^( 5) =       0.000543267133
  error estimate for blocks of size 2^( 6) =       0.000548079180
  error estimate for blocks of size 2^( 7) =       0.000553527769

      target function =      -0.743144288231
              le_mean =     -22.661717360510
             les_mean =     514.006078419375
             stat err =       0.000544369869
             autocorr =       1.338029747499
   target nu stat err =       0.000544369869
   target dn stat err =       0.003876915084
      target stat err =       0.003216273432
              std dev =       0.665543110574
             le_variance =       0.442947632033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442958883999
                                         uncertainty =       0.003013571333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442958883999
                                         uncertainty =       0.003013571333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470608790
  error estimate for blocks of size 2^( 2) =       0.000494709138
  error estimate for blocks of size 2^( 3) =       0.000516828846
  error estimate for blocks of size 2^( 4) =       0.000532604931
  error estimate for blocks of size 2^( 5) =       0.000543266342
  error estimate for blocks of size 2^( 6) =       0.000548079228
  error estimate for blocks of size 2^( 7) =       0.000553527916

      target function =      -0.743155103523
              le_mean =     -22.661717463215
             les_mean =     514.006069805406
             stat err =       0.000544369604
             autocorr =       1.338035590434
   target nu stat err =       0.000544369604
   target dn stat err =       0.003877137856
      target stat err =       0.003216544324
              std dev =       0.665541333993
             le_variance =       0.442945267253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442960047661
                                         uncertainty =       0.003013206887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442960047661
                                         uncertainty =       0.003013206887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470609410
  error estimate for blocks of size 2^( 2) =       0.000494709492
  error estimate for blocks of size 2^( 3) =       0.000516829032
  error estimate for blocks of size 2^( 4) =       0.000532605155
  error estimate for blocks of size 2^( 5) =       0.000543266731
  error estimate for blocks of size 2^( 6) =       0.000548079198
  error estimate for blocks of size 2^( 7) =       0.000553527837

      target function =      -0.743149914597
              le_mean =     -22.661717410743
             les_mean =     514.006073793349
             stat err =       0.000544369730
             autocorr =       1.338032687096
   target nu stat err =       0.000544369730
   target dn stat err =       0.003877016485
      target stat err =       0.003216402733
              std dev =       0.665542210025
             le_variance =       0.442946433325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442961092945
                                         uncertainty =       0.003012887680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442961092945
                                         uncertainty =       0.003012887680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470609966
  error estimate for blocks of size 2^( 2) =       0.000494709814
  error estimate for blocks of size 2^( 3) =       0.000516829207
  error estimate for blocks of size 2^( 4) =       0.000532605362
  error estimate for blocks of size 2^( 5) =       0.000543267082
  error estimate for blocks of size 2^( 6) =       0.000548079182
  error estimate for blocks of size 2^( 7) =       0.000553527777

      target function =      -0.743145013074
              le_mean =     -22.661717366650
             les_mean =     514.006077808367
             stat err =       0.000544369851
             autocorr =       1.338030116010
   target nu stat err =       0.000544369851
   target dn stat err =       0.003876926668
      target stat err =       0.003216288903
              std dev =       0.665542996882
             le_variance =       0.442947480699


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743144288231        initial
     9.5367e+00     9.5367e+01             2.3447e-05        -0.743155103523  <--
     3.8147e+01     3.8147e+02             5.8797e-06        -0.743149914597
     1.5259e+02     1.5259e+03             1.4711e-06        -0.743145013074

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 4.3349e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115863e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764559e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7423
    reference variance = 0.348299
====================================================
  Execution time = 2.6186e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5123e-01
  Total weights = 1.955369443e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441327757827
                                         uncertainty =       0.002849831165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441327757827
                                         uncertainty =       0.002849831165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469699315
  error estimate for blocks of size 2^( 2) =       0.000494107291
  error estimate for blocks of size 2^( 3) =       0.000516170751
  error estimate for blocks of size 2^( 4) =       0.000532983927
  error estimate for blocks of size 2^( 5) =       0.000542022856
  error estimate for blocks of size 2^( 6) =       0.000547224277
  error estimate for blocks of size 2^( 7) =       0.000548304240

      target function =      -0.744295511360
              le_mean =     -22.661160156118
             les_mean =     513.979410489243
             stat err =       0.000542633825
             autocorr =       1.334669909619
   target nu stat err =       0.000542633825
   target dn stat err =       0.003526975704
      target stat err =       0.002942549981
              std dev =       0.664255142010
             le_variance =       0.441234893686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266116015612e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744306149819       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744323845862       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744326041090       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744326287017       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744326367533       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744326737370       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744326771292       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744326725957       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744326758435       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744326770841       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744326774588       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744326776419       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.525239e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744306149819       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744310641108       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744311192278       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744311254014       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744311274426       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744311366188       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744311373843       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744311362664       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744311370761       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744311373792       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744311374650       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744311375093       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 3.814090e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744306149819       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744307276926       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744307414864       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744307430314       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744307435435       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744307458330       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744307460192       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744307457408       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744307459431       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744307460183       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744307460393       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744307460503       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 9.535852e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315220 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0886e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -7.020201e-01 3 1  ON 0
ci_002                -7.059330e-01 3 1  ON 1
ci_003                -5.339096e-02 3 1  ON 2
ci_004                -5.445903e-02 3 1  ON 3
ci_005                 1.971243e-02 3 1  ON 4
ci_006                 1.979639e-02 3 1  ON 5
ci_007                 1.611697e-02 3 1  ON 6
ci_008                 1.595975e-02 3 1  ON 7
ci_009                -1.233026e-02 3 1  ON 8
ci_010                -1.268316e-02 3 1  ON 9
ci_011                -9.745935e-03 3 1  ON 10
ci_012                -9.875979e-03 3 1  ON 11
ci_013                 8.881088e-03 3 1  ON 12
ci_014                 8.878865e-03 3 1  ON 13
ci_015                 9.296580e-03 3 1  ON 14
ci_016                 9.607271e-03 3 1  ON 15
ci_017                 8.636365e-03 3 1  ON 16
ci_018                 8.287044e-03 3 1  ON 17
ci_019                -1.224548e-03 3 1  ON 18
ci_020                -1.165081e-03 3 1  ON 19
ci_021                -1.043448e-02 3 1  ON 20
ci_022                -1.104220e-02 3 1  ON 21
ci_023                 5.493233e-03 3 1  ON 22
ci_024                 5.296787e-03 3 1  ON 23
ci_025                 1.292071e-02 3 1  ON 24
ci_026                 1.247164e-02 3 1  ON 25
ci_027                 6.277319e-03 3 1  ON 26
ci_028                 6.241716e-03 3 1  ON 27
ci_029                -3.705258e-03 3 1  ON 28
ci_030                -4.448830e-03 3 1  ON 29
ci_031                 4.080284e-03 3 1  ON 30
ci_032                 3.624407e-03 3 1  ON 31
ci_033                 3.440665e-03 3 1  ON 32
ci_034                 3.335625e-03 3 1  ON 33
ci_035                 2.282752e-03 3 1  ON 34
ci_036                 2.149636e-03 3 1  ON 35
ci_037                 3.395876e-03 3 1  ON 36
ci_038                 3.337768e-03 3 1  ON 37
ci_039                 4.277879e-03 3 1  ON 38
ci_040                 4.413080e-03 3 1  ON 39
ci_041                 2.796794e-03 3 1  ON 40
ci_042                 2.952139e-03 3 1  ON 41
ci_043                 3.489681e-03 3 1  ON 42
ci_044                 3.219983e-03 3 1  ON 43
ci_045                 2.517285e-03 3 1  ON 44
ci_046                 2.909844e-03 3 1  ON 45
ci_047                -9.812320e-04 3 1  ON 46
ci_048                -1.158121e-03 3 1  ON 47
ci_049                 7.347521e-04 3 1  ON 48
ci_050                 8.011080e-04 3 1  ON 49
ci_051                -1.517741e-03 3 1  ON 50
ci_052                -1.456550e-03 3 1  ON 51
ci_053                -2.542354e-03 3 1  ON 52
ci_054                -2.629260e-03 3 1  ON 53
ci_055                -1.560864e-03 3 1  ON 54
ci_056                -1.321195e-03 3 1  ON 55
ci_057                -1.038576e-03 3 1  ON 56
ci_058                -1.020527e-03 3 1  ON 57
ci_059                -4.027119e-04 3 1  ON 58
ci_060                -1.855719e-04 3 1  ON 59
ci_061                -6.664693e-04 3 1  ON 60
ci_062                -5.450802e-04 3 1  ON 61
ci_063                -6.201135e-04 3 1  ON 62
ci_064                -7.187498e-04 3 1  ON 63
ci_065                -1.726729e-03 3 1  ON 64
ci_066                -1.698872e-03 3 1  ON 65
ci_067                -1.600872e-03 3 1  ON 66
ci_068                -1.617150e-03 3 1  ON 67
ci_069                 2.108429e-06 3 1  ON 68
ci_070                 1.778994e-04 3 1  ON 69
ci_071                -1.525554e-03 3 1  ON 70
ci_072                -1.938828e-03 3 1  ON 71
ci_073                 1.527866e-04 3 1  ON 72
ci_074                 1.482517e-04 3 1  ON 73
ci_075                 6.274847e-05 3 1  ON 74
ci_076                 2.407531e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.6136
    reference variance = 0.550086
====================================================
  Execution time = 2.5379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4892e-01
  Total weights = 1.9551e+06
  Execution time = 3.6242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438935791947
                                         uncertainty =       0.002031120029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438935791947
                                         uncertainty =       0.002031120029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468479004
  error estimate for blocks of size 2^( 2) =       0.000492582083
  error estimate for blocks of size 2^( 3) =       0.000514880584
  error estimate for blocks of size 2^( 4) =       0.000530370735
  error estimate for blocks of size 2^( 5) =       0.000539682322
  error estimate for blocks of size 2^( 6) =       0.000545022096
  error estimate for blocks of size 2^( 7) =       0.000549769060

      target function =      -0.746213698574
              le_mean =     -22.662384129746
             les_mean =     514.032568048906
             stat err =       0.000541211053
             autocorr =       1.334605934782
   target nu stat err =       0.000541211053
   target dn stat err =       0.002548256025
      target stat err =       0.002179768011
              std dev =       0.662529361275
             le_variance =       0.438945154551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438922959420
                                         uncertainty =       0.002029586500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438922959420
                                         uncertainty =       0.002029586500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468472223
  error estimate for blocks of size 2^( 2) =       0.000492577585
  error estimate for blocks of size 2^( 3) =       0.000514877644
  error estimate for blocks of size 2^( 4) =       0.000530367821
  error estimate for blocks of size 2^( 5) =       0.000539677898
  error estimate for blocks of size 2^( 6) =       0.000545017527
  error estimate for blocks of size 2^( 7) =       0.000549766380

      target function =      -0.746190455256
              le_mean =     -22.662383208737
             les_mean =     514.032554474458
             stat err =       0.000541207407
             autocorr =       1.334626588417
   target nu stat err =       0.000541207407
   target dn stat err =       0.002560611171
      target stat err =       0.002189411112
              std dev =       0.662519770759
             le_variance =       0.438932446647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438928956149
                                         uncertainty =       0.002030324058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438928956149
                                         uncertainty =       0.002030324058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468475390
  error estimate for blocks of size 2^( 2) =       0.000492579626
  error estimate for blocks of size 2^( 3) =       0.000514878922
  error estimate for blocks of size 2^( 4) =       0.000530369086
  error estimate for blocks of size 2^( 5) =       0.000539679902
  error estimate for blocks of size 2^( 6) =       0.000545019615
  error estimate for blocks of size 2^( 7) =       0.000549767560

      target function =      -0.746207782542
              le_mean =     -22.662383633205
             les_mean =     514.032552694609
             stat err =       0.000541209041
             autocorr =       1.334616602464
   target nu stat err =       0.000541209041
   target dn stat err =       0.002554021259
      target stat err =       0.002184294929
              std dev =       0.662524250138
             le_variance =       0.438938382020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438934898418
                                         uncertainty =       0.002031018182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438934898418
                                         uncertainty =       0.002031018182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468478532
  error estimate for blocks of size 2^( 2) =       0.000492581755
  error estimate for blocks of size 2^( 3) =       0.000514880357
  error estimate for blocks of size 2^( 4) =       0.000530370510
  error estimate for blocks of size 2^( 5) =       0.000539681999
  error estimate for blocks of size 2^( 6) =       0.000545021767
  error estimate for blocks of size 2^( 7) =       0.000549768856

      target function =      -0.746209983610
              le_mean =     -22.662384064166
             les_mean =     514.032569587289
             stat err =       0.000541210783
             autocorr =       1.334607293183
   target nu stat err =       0.000541210783
   target dn stat err =       0.002548923421
      target stat err =       0.002180274943
              std dev =       0.662528692949
             le_variance =       0.438944268981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746213698574        initial  <--
     2.3842e+00     2.3842e+01             1.5252e-04        -0.746190455256
     9.5367e+00     9.5367e+01             3.8141e-05        -0.746207782542
     3.8147e+01     3.8147e+02             9.5359e-06        -0.746209983610

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4539
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115863e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764559e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4346e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6759
    reference variance = 0.464447
====================================================
  Execution time = 2.6127e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5252e-01
  Total weights = 1.955179746e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441782133732
                                         uncertainty =       0.002332853752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441782133732
                                         uncertainty =       0.002332853752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470010672
  error estimate for blocks of size 2^( 2) =       0.000494527742
  error estimate for blocks of size 2^( 3) =       0.000516485051
  error estimate for blocks of size 2^( 4) =       0.000531409393
  error estimate for blocks of size 2^( 5) =       0.000541403740
  error estimate for blocks of size 2^( 6) =       0.000545458992
  error estimate for blocks of size 2^( 7) =       0.000550725589

      target function =      -0.743255942184
              le_mean =     -22.662091911677
             les_mean =     514.022926623082
             stat err =       0.000542249428
             autocorr =       1.331014442887
   target nu stat err =       0.000542249428
   target dn stat err =       0.003133222675
      target stat err =       0.002624665793
              std dev =       0.664695466331
             le_variance =       0.441820062961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266209191168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743264368781       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743265460439       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743265603321       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743265621246       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743265618596       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743265619365       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743265618866       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743265618378       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743265618686       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743265618082       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743265617804       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743265617752       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+01 is 9.261391e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743264368781       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743264642077       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743264677819       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743264682298       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743264681634       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743264681825       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743264681701       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743264681579       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743264681655       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743264681505       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743264681435       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743264681422       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+01 is 2.316253e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743264368781       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743264437129       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743264446066       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743264447186       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743264447020       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743264447067       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743264447036       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743264447006       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743264447025       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743264446987       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743264446970       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743264446966       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+02 is 5.791197e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320023 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0842e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -7.020559e-01 3 1  ON 0
ci_002                -7.058957e-01 3 1  ON 1
ci_003                -5.340126e-02 3 1  ON 2
ci_004                -5.445322e-02 3 1  ON 3
ci_005                 1.972343e-02 3 1  ON 4
ci_006                 1.980505e-02 3 1  ON 5
ci_007                 1.614166e-02 3 1  ON 6
ci_008                 1.595653e-02 3 1  ON 7
ci_009                -1.233533e-02 3 1  ON 8
ci_010                -1.268724e-02 3 1  ON 9
ci_011                -9.749410e-03 3 1  ON 10
ci_012                -9.880682e-03 3 1  ON 11
ci_013                 8.890225e-03 3 1  ON 12
ci_014                 8.882369e-03 3 1  ON 13
ci_015                 9.308269e-03 3 1  ON 14
ci_016                 9.608094e-03 3 1  ON 15
ci_017                 8.641284e-03 3 1  ON 16
ci_018                 8.298565e-03 3 1  ON 17
ci_019                -1.197614e-03 3 1  ON 18
ci_020                -1.164380e-03 3 1  ON 19
ci_021                -1.042147e-02 3 1  ON 20
ci_022                -1.103491e-02 3 1  ON 21
ci_023                 5.498189e-03 3 1  ON 22
ci_024                 5.295960e-03 3 1  ON 23
ci_025                 1.291395e-02 3 1  ON 24
ci_026                 1.246667e-02 3 1  ON 25
ci_027                 6.259442e-03 3 1  ON 26
ci_028                 6.244039e-03 3 1  ON 27
ci_029                -3.703266e-03 3 1  ON 28
ci_030                -4.458116e-03 3 1  ON 29
ci_031                 4.051798e-03 3 1  ON 30
ci_032                 3.616142e-03 3 1  ON 31
ci_033                 3.444077e-03 3 1  ON 32
ci_034                 3.351043e-03 3 1  ON 33
ci_035                 2.285348e-03 3 1  ON 34
ci_036                 2.149778e-03 3 1  ON 35
ci_037                 3.394337e-03 3 1  ON 36
ci_038                 3.337506e-03 3 1  ON 37
ci_039                 4.272067e-03 3 1  ON 38
ci_040                 4.419284e-03 3 1  ON 39
ci_041                 2.796384e-03 3 1  ON 40
ci_042                 2.947699e-03 3 1  ON 41
ci_043                 3.495591e-03 3 1  ON 42
ci_044                 3.220090e-03 3 1  ON 43
ci_045                 2.511210e-03 3 1  ON 44
ci_046                 2.917993e-03 3 1  ON 45
ci_047                -9.824115e-04 3 1  ON 46
ci_048                -1.162252e-03 3 1  ON 47
ci_049                 7.340891e-04 3 1  ON 48
ci_050                 7.947544e-04 3 1  ON 49
ci_051                -1.519794e-03 3 1  ON 50
ci_052                -1.457874e-03 3 1  ON 51
ci_053                -2.544548e-03 3 1  ON 52
ci_054                -2.630546e-03 3 1  ON 53
ci_055                -1.578178e-03 3 1  ON 54
ci_056                -1.320980e-03 3 1  ON 55
ci_057                -1.037621e-03 3 1  ON 56
ci_058                -1.021273e-03 3 1  ON 57
ci_059                -4.031816e-04 3 1  ON 58
ci_060                -1.875360e-04 3 1  ON 59
ci_061                -6.648834e-04 3 1  ON 60
ci_062                -5.376466e-04 3 1  ON 61
ci_063                -6.236555e-04 3 1  ON 62
ci_064                -7.296495e-04 3 1  ON 63
ci_065                -1.742623e-03 3 1  ON 64
ci_066                -1.705452e-03 3 1  ON 65
ci_067                -1.599680e-03 3 1  ON 66
ci_068                -1.616663e-03 3 1  ON 67
ci_069                 2.383624e-06 3 1  ON 68
ci_070                 1.931989e-04 3 1  ON 69
ci_071                -1.537499e-03 3 1  ON 70
ci_072                -1.940298e-03 3 1  ON 71
ci_073                 1.528360e-04 3 1  ON 72
ci_074                 1.517096e-04 3 1  ON 73
ci_075                 5.808185e-05 3 1  ON 74
ci_076                 2.386433e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6268
    reference variance = 0.325299
====================================================
  Execution time = 2.5380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5698e-01
  Total weights = 1.9548e+06
  Execution time = 3.6387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446818166220
                                         uncertainty =       0.004095082076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446818166220
                                         uncertainty =       0.004095082076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472669255
  error estimate for blocks of size 2^( 2) =       0.000496063986
  error estimate for blocks of size 2^( 3) =       0.000517915732
  error estimate for blocks of size 2^( 4) =       0.000533869640
  error estimate for blocks of size 2^( 5) =       0.000542870672
  error estimate for blocks of size 2^( 6) =       0.000547506753
  error estimate for blocks of size 2^( 7) =       0.000550122880

      target function =      -0.739618041146
              le_mean =     -22.661188607490
             les_mean =     513.986447219844
             stat err =       0.000543592486
             autocorr =       1.322611153239
   target nu stat err =       0.000543592486
   target dn stat err =       0.005066210647
      target stat err =       0.004130386340
              std dev =       0.668455271361
             le_variance =       0.446832449810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446821057085
                                         uncertainty =       0.004095255316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446821057085
                                         uncertainty =       0.004095255316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472670779
  error estimate for blocks of size 2^( 2) =       0.000496065646
  error estimate for blocks of size 2^( 3) =       0.000517917361
  error estimate for blocks of size 2^( 4) =       0.000533871437
  error estimate for blocks of size 2^( 5) =       0.000542872492
  error estimate for blocks of size 2^( 6) =       0.000547508515
  error estimate for blocks of size 2^( 7) =       0.000550124382

      target function =      -0.739607895401
              le_mean =     -22.661188607616
             les_mean =     513.986459764361
             stat err =       0.000543594207
             autocorr =       1.322610995936
   target nu stat err =       0.000543594207
   target dn stat err =       0.005069591125
      target stat err =       0.004132973800
              std dev =       0.668457426826
             le_variance =       0.446835331479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446819602403
                                         uncertainty =       0.004095166725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446819602403
                                         uncertainty =       0.004095166725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472670012
  error estimate for blocks of size 2^( 2) =       0.000496064811
  error estimate for blocks of size 2^( 3) =       0.000517916542
  error estimate for blocks of size 2^( 4) =       0.000533870534
  error estimate for blocks of size 2^( 5) =       0.000542871577
  error estimate for blocks of size 2^( 6) =       0.000547507630
  error estimate for blocks of size 2^( 7) =       0.000550123626

      target function =      -0.739613078866
              le_mean =     -22.661188607403
             les_mean =     513.986453348259
             stat err =       0.000543593342
             autocorr =       1.322611080562
   target nu stat err =       0.000543593342
   target dn stat err =       0.005067893399
      target stat err =       0.004131675327
              std dev =       0.668456342177
             le_variance =       0.446833881397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446818344657
                                         uncertainty =       0.004095092444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446818344657
                                         uncertainty =       0.004095092444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472669349
  error estimate for blocks of size 2^( 2) =       0.000496064088
  error estimate for blocks of size 2^( 3) =       0.000517915832
  error estimate for blocks of size 2^( 4) =       0.000533869751
  error estimate for blocks of size 2^( 5) =       0.000542870784
  error estimate for blocks of size 2^( 6) =       0.000547506862
  error estimate for blocks of size 2^( 7) =       0.000550122972

      target function =      -0.739617432293
              le_mean =     -22.661188607461
             les_mean =     513.986447970929
             stat err =       0.000543592592
             autocorr =       1.322611144721
   target nu stat err =       0.000543592592
   target dn stat err =       0.005066420062
      target stat err =       0.004130546849
              std dev =       0.668455404401
             le_variance =       0.446832627673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739618041146        initial  <--
     2.3842e+01     2.3842e+02             9.2614e-06        -0.739607895401
     9.5367e+01     9.5367e+02             2.3163e-06        -0.739613078866
     3.8147e+02     3.8147e+03             5.7912e-07        -0.739617432293

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5275
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115863e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764559e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4375e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.6456
    reference variance = 0.284589
====================================================
  Execution time = 2.6126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5296e-01
  Total weights = 1.955512275e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443518945551
                                         uncertainty =       0.002184628216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443518945551
                                         uncertainty =       0.002184628216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471046146
  error estimate for blocks of size 2^( 2) =       0.000495486466
  error estimate for blocks of size 2^( 3) =       0.000517850872
  error estimate for blocks of size 2^( 4) =       0.000533802988
  error estimate for blocks of size 2^( 5) =       0.000542632965
  error estimate for blocks of size 2^( 6) =       0.000548127135
  error estimate for blocks of size 2^( 7) =       0.000549874673

      target function =      -0.742898631371
              le_mean =     -22.662084873037
             les_mean =     514.023047666819
             stat err =       0.000543609440
             autocorr =       1.331824714079
   target nu stat err =       0.000543609440
   target dn stat err =       0.002843333012
      target stat err =       0.002393028496
              std dev =       0.666159848542
             le_variance =       0.443768943810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266208487304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742905459075       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742905579072       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742905599771       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742905603246       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742905604310       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742905603732       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742905603947       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742905604088       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742905604301       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742905604362       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742905604365       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742905604366       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+02 is 1.045282e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742905459075       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742905489079       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742905494254       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742905495123       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742905495388       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742905495242       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742905495298       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742905495334       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742905495387       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742905495402       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742905495403       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742905495403       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+02 is 2.613524e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742905459075       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742905466576       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742905467870       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742905468087       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742905468149       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742905468121       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742905468131       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742905468145       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742905468146       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742905468170       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742905468169       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742905468163       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+03 is 6.534009e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0863e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -7.020567e-01 3 1  ON 0
ci_002                -7.058946e-01 3 1  ON 1
ci_003                -5.340342e-02 3 1  ON 2
ci_004                -5.445483e-02 3 1  ON 3
ci_005                 1.972380e-02 3 1  ON 4
ci_006                 1.980567e-02 3 1  ON 5
ci_007                 1.614250e-02 3 1  ON 6
ci_008                 1.595719e-02 3 1  ON 7
ci_009                -1.233560e-02 3 1  ON 8
ci_010                -1.268791e-02 3 1  ON 9
ci_011                -9.749845e-03 3 1  ON 10
ci_012                -9.880474e-03 3 1  ON 11
ci_013                 8.890132e-03 3 1  ON 12
ci_014                 8.882948e-03 3 1  ON 13
ci_015                 9.309630e-03 3 1  ON 14
ci_016                 9.609964e-03 3 1  ON 15
ci_017                 8.642226e-03 3 1  ON 16
ci_018                 8.298655e-03 3 1  ON 17
ci_019                -1.196103e-03 3 1  ON 18
ci_020                -1.162978e-03 3 1  ON 19
ci_021                -1.041981e-02 3 1  ON 20
ci_022                -1.103436e-02 3 1  ON 21
ci_023                 5.499211e-03 3 1  ON 22
ci_024                 5.296222e-03 3 1  ON 23
ci_025                 1.291214e-02 3 1  ON 24
ci_026                 1.246634e-02 3 1  ON 25
ci_027                 6.258767e-03 3 1  ON 26
ci_028                 6.243973e-03 3 1  ON 27
ci_029                -3.703415e-03 3 1  ON 28
ci_030                -4.459510e-03 3 1  ON 29
ci_031                 4.049570e-03 3 1  ON 30
ci_032                 3.614074e-03 3 1  ON 31
ci_033                 3.444121e-03 3 1  ON 32
ci_034                 3.351631e-03 3 1  ON 33
ci_035                 2.285642e-03 3 1  ON 34
ci_036                 2.149773e-03 3 1  ON 35
ci_037                 3.394055e-03 3 1  ON 36
ci_038                 3.337292e-03 3 1  ON 37
ci_039                 4.272274e-03 3 1  ON 38
ci_040                 4.419486e-03 3 1  ON 39
ci_041                 2.796034e-03 3 1  ON 40
ci_042                 2.947464e-03 3 1  ON 41
ci_043                 3.494888e-03 3 1  ON 42
ci_044                 3.220098e-03 3 1  ON 43
ci_045                 2.510953e-03 3 1  ON 44
ci_046                 2.918164e-03 3 1  ON 45
ci_047                -9.823619e-04 3 1  ON 46
ci_048                -1.162335e-03 3 1  ON 47
ci_049                 7.340814e-04 3 1  ON 48
ci_050                 7.954134e-04 3 1  ON 49
ci_051                -1.520739e-03 3 1  ON 50
ci_052                -1.458125e-03 3 1  ON 51
ci_053                -2.543814e-03 3 1  ON 52
ci_054                -2.631165e-03 3 1  ON 53
ci_055                -1.577292e-03 3 1  ON 54
ci_056                -1.321944e-03 3 1  ON 55
ci_057                -1.037606e-03 3 1  ON 56
ci_058                -1.020916e-03 3 1  ON 57
ci_059                -4.033989e-04 3 1  ON 58
ci_060                -1.877861e-04 3 1  ON 59
ci_061                -6.648083e-04 3 1  ON 60
ci_062                -5.384225e-04 3 1  ON 61
ci_063                -6.250114e-04 3 1  ON 62
ci_064                -7.293135e-04 3 1  ON 63
ci_065                -1.742616e-03 3 1  ON 64
ci_066                -1.705067e-03 3 1  ON 65
ci_067                -1.600948e-03 3 1  ON 66
ci_068                -1.615881e-03 3 1  ON 67
ci_069                 3.091752e-06 3 1  ON 68
ci_070                 1.931261e-04 3 1  ON 69
ci_071                -1.536889e-03 3 1  ON 70
ci_072                -1.939618e-03 3 1  ON 71
ci_073                 1.528801e-04 3 1  ON 72
ci_074                 1.510786e-04 3 1  ON 73
ci_075                 5.758102e-05 3 1  ON 74
ci_076                 2.379589e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.6381
    reference variance = 0.475396
====================================================
  Execution time = 2.7331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5173e-01
  Total weights = 1.9550e+06
  Execution time = 3.6465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438905653083
                                         uncertainty =       0.002004399088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438905653083
                                         uncertainty =       0.002004399088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468463096
  error estimate for blocks of size 2^( 2) =       0.000492456638
  error estimate for blocks of size 2^( 3) =       0.000514779458
  error estimate for blocks of size 2^( 4) =       0.000530685575
  error estimate for blocks of size 2^( 5) =       0.000539308420
  error estimate for blocks of size 2^( 6) =       0.000544612477
  error estimate for blocks of size 2^( 7) =       0.000547644688

      target function =      -0.743899796209
              le_mean =     -22.661587458660
             les_mean =     513.999264816747
             stat err =       0.000540562790
             autocorr =       1.331501091743
   target nu stat err =       0.000540562790
   target dn stat err =       0.003717588220
      target stat err =       0.003093510699
              std dev =       0.662506863431
             le_variance =       0.438915344093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438905447089
                                         uncertainty =       0.002004385685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438905447089
                                         uncertainty =       0.002004385685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468462985
  error estimate for blocks of size 2^( 2) =       0.000492456550
  error estimate for blocks of size 2^( 3) =       0.000514779399
  error estimate for blocks of size 2^( 4) =       0.000530685530
  error estimate for blocks of size 2^( 5) =       0.000539308393
  error estimate for blocks of size 2^( 6) =       0.000544612455
  error estimate for blocks of size 2^( 7) =       0.000547644635

      target function =      -0.743831296509
              le_mean =     -22.661587461658
             les_mean =     513.999348712290
             stat err =       0.000540562753
             autocorr =       1.331501539151
   target nu stat err =       0.000540562753
   target dn stat err =       0.003733187545
      target stat err =       0.003105453484
              std dev =       0.662506707258
             le_variance =       0.438915137162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438905550052
                                         uncertainty =       0.002004392385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438905550052
                                         uncertainty =       0.002004392385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468463040
  error estimate for blocks of size 2^( 2) =       0.000492456594
  error estimate for blocks of size 2^( 3) =       0.000514779428
  error estimate for blocks of size 2^( 4) =       0.000530685553
  error estimate for blocks of size 2^( 5) =       0.000539308406
  error estimate for blocks of size 2^( 6) =       0.000544612466
  error estimate for blocks of size 2^( 7) =       0.000547644661

      target function =      -0.743887474172
              le_mean =     -22.661587460250
             les_mean =     513.999279916392
             stat err =       0.000540562771
             autocorr =       1.331501313980
   target nu stat err =       0.000540562771
   target dn stat err =       0.003725080844
      target stat err =       0.003099415711
              std dev =       0.662506785319
             le_variance =       0.438915240594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438905640202
                                         uncertainty =       0.002004398250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438905640202
                                         uncertainty =       0.002004398250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468463089
  error estimate for blocks of size 2^( 2) =       0.000492456633
  error estimate for blocks of size 2^( 3) =       0.000514779454
  error estimate for blocks of size 2^( 4) =       0.000530685572
  error estimate for blocks of size 2^( 5) =       0.000539308418
  error estimate for blocks of size 2^( 6) =       0.000544612475
  error estimate for blocks of size 2^( 7) =       0.000547644684

      target function =      -0.743898423350
              le_mean =     -22.661587458860
             les_mean =     513.999266499305
             stat err =       0.000540562788
             autocorr =       1.331501119502
   target nu stat err =       0.000540562788
   target dn stat err =       0.003718520106
      target stat err =       0.003094246430
              std dev =       0.662506853665
             le_variance =       0.438915331153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743899796209        initial  <--
     2.3842e+02     2.3842e+03             1.0453e-06        -0.743831296509
     9.5367e+02     9.5367e+03             2.6135e-07        -0.743887474172
     3.8147e+03     3.8147e+04             6.5340e-08        -0.743898423350

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5159
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115863e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764559e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6386e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.6951
    reference variance = 0.453493
====================================================
  Execution time = 2.5928e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5907e-01
  Total weights = 1.954889827e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447262424736
                                         uncertainty =       0.007023665911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447262424736
                                         uncertainty =       0.007023665911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472919840
  error estimate for blocks of size 2^( 2) =       0.000496860797
  error estimate for blocks of size 2^( 3) =       0.000518555326
  error estimate for blocks of size 2^( 4) =       0.000534255451
  error estimate for blocks of size 2^( 5) =       0.000542793593
  error estimate for blocks of size 2^( 6) =       0.000546405566
  error estimate for blocks of size 2^( 7) =       0.000549415584

      target function =      -0.737886338290
              le_mean =     -22.662557051331
             les_mean =     514.050560423322
             stat err =       0.000543217549
             autocorr =       1.319387952783
   target nu stat err =       0.000543217549
   target dn stat err =       0.009021141844
      target stat err =       0.007283793427
              std dev =       0.668809651954
             le_variance =       0.447306350547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266255705133e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737956836427       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737956853023       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737956855442       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737956856822       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737956857468       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737956857784       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737956857816       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737956857836       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737956857845       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737956857829       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737956857837       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737956857830       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+03 is 2.741675e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737956836427       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737956840576       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737956841181       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737956841526       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737956841701       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737956841775       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737956841777       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737956841754       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737956841759       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737956841813       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737956841784       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737956841788       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+03 is 6.854192e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737956836427       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737956837464       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737956837615       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737956837692       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737956837719       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737956837805       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737956837696       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737956837701       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737956837663       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737956837690       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737956837691       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737956837741       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 1.713548e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0618e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058949e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445500e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980573e-02 3 1  ON 5
ci_007                 1.614270e-02 3 1  ON 6
ci_008                 1.595725e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749850e-03 3 1  ON 10
ci_012                -9.880596e-03 3 1  ON 11
ci_013                 8.890246e-03 3 1  ON 12
ci_014                 8.883131e-03 3 1  ON 13
ci_015                 9.309775e-03 3 1  ON 14
ci_016                 9.610070e-03 3 1  ON 15
ci_017                 8.642126e-03 3 1  ON 16
ci_018                 8.298635e-03 3 1  ON 17
ci_019                -1.196027e-03 3 1  ON 18
ci_020                -1.162713e-03 3 1  ON 19
ci_021                -1.041969e-02 3 1  ON 20
ci_022                -1.103436e-02 3 1  ON 21
ci_023                 5.499178e-03 3 1  ON 22
ci_024                 5.296265e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246626e-02 3 1  ON 25
ci_027                 6.258796e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703443e-03 3 1  ON 28
ci_030                -4.459563e-03 3 1  ON 29
ci_031                 4.049517e-03 3 1  ON 30
ci_032                 3.613897e-03 3 1  ON 31
ci_033                 3.444275e-03 3 1  ON 32
ci_034                 3.351615e-03 3 1  ON 33
ci_035                 2.285657e-03 3 1  ON 34
ci_036                 2.149750e-03 3 1  ON 35
ci_037                 3.394122e-03 3 1  ON 36
ci_038                 3.337429e-03 3 1  ON 37
ci_039                 4.272260e-03 3 1  ON 38
ci_040                 4.419457e-03 3 1  ON 39
ci_041                 2.796026e-03 3 1  ON 40
ci_042                 2.947505e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220044e-03 3 1  ON 43
ci_045                 2.511022e-03 3 1  ON 44
ci_046                 2.918176e-03 3 1  ON 45
ci_047                -9.823140e-04 3 1  ON 46
ci_048                -1.162345e-03 3 1  ON 47
ci_049                 7.340445e-04 3 1  ON 48
ci_050                 7.953583e-04 3 1  ON 49
ci_051                -1.520899e-03 3 1  ON 50
ci_052                -1.458109e-03 3 1  ON 51
ci_053                -2.543814e-03 3 1  ON 52
ci_054                -2.631137e-03 3 1  ON 53
ci_055                -1.577295e-03 3 1  ON 54
ci_056                -1.321882e-03 3 1  ON 55
ci_057                -1.037661e-03 3 1  ON 56
ci_058                -1.020912e-03 3 1  ON 57
ci_059                -4.033908e-04 3 1  ON 58
ci_060                -1.877500e-04 3 1  ON 59
ci_061                -6.647510e-04 3 1  ON 60
ci_062                -5.383522e-04 3 1  ON 61
ci_063                -6.250388e-04 3 1  ON 62
ci_064                -7.292822e-04 3 1  ON 63
ci_065                -1.742609e-03 3 1  ON 64
ci_066                -1.704975e-03 3 1  ON 65
ci_067                -1.600924e-03 3 1  ON 66
ci_068                -1.615897e-03 3 1  ON 67
ci_069                 3.118396e-06 3 1  ON 68
ci_070                 1.932022e-04 3 1  ON 69
ci_071                -1.536949e-03 3 1  ON 70
ci_072                -1.939658e-03 3 1  ON 71
ci_073                 1.528871e-04 3 1  ON 72
ci_074                 1.511667e-04 3 1  ON 73
ci_075                 5.765277e-05 3 1  ON 74
ci_076                 2.379218e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.6599
    reference variance = 0.444628
====================================================
  Execution time = 2.5489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5134e-01
  Total weights = 1.9553e+06
  Execution time = 3.6285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442308399317
                                         uncertainty =       0.002111193119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442308399317
                                         uncertainty =       0.002111193119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470236780
  error estimate for blocks of size 2^( 2) =       0.000494175904
  error estimate for blocks of size 2^( 3) =       0.000516189474
  error estimate for blocks of size 2^( 4) =       0.000532489795
  error estimate for blocks of size 2^( 5) =       0.000541766441
  error estimate for blocks of size 2^( 6) =       0.000547752951
  error estimate for blocks of size 2^( 7) =       0.000548370234

      target function =      -0.744221206197
              le_mean =     -22.661875511564
             les_mean =     514.011937987689
             stat err =       0.000542594855
             autocorr =       1.331429430770
   target nu stat err =       0.000542594855
   target dn stat err =       0.002608203589
      target stat err =       0.002214538904
              std dev =       0.665015232449
             le_variance =       0.442245259389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442308393598
                                         uncertainty =       0.002111191875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442308393598
                                         uncertainty =       0.002111191875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470236777
  error estimate for blocks of size 2^( 2) =       0.000494175902
  error estimate for blocks of size 2^( 3) =       0.000516189474
  error estimate for blocks of size 2^( 4) =       0.000532489797
  error estimate for blocks of size 2^( 5) =       0.000541766444
  error estimate for blocks of size 2^( 6) =       0.000547752953
  error estimate for blocks of size 2^( 7) =       0.000548370238

      target function =      -0.744221108161
              le_mean =     -22.661875510719
             les_mean =     514.011938069267
             stat err =       0.000542594858
             autocorr =       1.331429461346
   target nu stat err =       0.000542594858
   target dn stat err =       0.002608204131
      target stat err =       0.002214538766
              std dev =       0.665015228154
             le_variance =       0.442245253676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442308396457
                                         uncertainty =       0.002111192497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442308396457
                                         uncertainty =       0.002111192497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470236779
  error estimate for blocks of size 2^( 2) =       0.000494175903
  error estimate for blocks of size 2^( 3) =       0.000516189474
  error estimate for blocks of size 2^( 4) =       0.000532489796
  error estimate for blocks of size 2^( 5) =       0.000541766443
  error estimate for blocks of size 2^( 6) =       0.000547752952
  error estimate for blocks of size 2^( 7) =       0.000548370236

      target function =      -0.744221157268
              le_mean =     -22.661875511141
             les_mean =     514.011938028366
             stat err =       0.000542594857
             autocorr =       1.331429446065
   target nu stat err =       0.000542594857
   target dn stat err =       0.002608203859
      target stat err =       0.002214538835
              std dev =       0.665015230301
             le_variance =       0.442245256532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442308398959
                                         uncertainty =       0.002111193041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442308398959
                                         uncertainty =       0.002111193041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470236780
  error estimate for blocks of size 2^( 2) =       0.000494175904
  error estimate for blocks of size 2^( 3) =       0.000516189474
  error estimate for blocks of size 2^( 4) =       0.000532489795
  error estimate for blocks of size 2^( 5) =       0.000541766442
  error estimate for blocks of size 2^( 6) =       0.000547752951
  error estimate for blocks of size 2^( 7) =       0.000548370234

      target function =      -0.744221200090
              le_mean =     -22.661875511511
             les_mean =     514.011937992761
             stat err =       0.000542594855
             autocorr =       1.331429432681
   target nu stat err =       0.000542594855
   target dn stat err =       0.002608203623
      target stat err =       0.002214538895
              std dev =       0.665015232180
             le_variance =       0.442245259032


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744221206197        initial  <--
     2.3842e+03     2.3842e+04             2.7417e-07        -0.744221108161
     9.5367e+03     9.5367e+04             6.8542e-08        -0.744221157268
     3.8147e+04     3.8147e+05             1.7135e-08        -0.744221200090

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5727
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115863e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764559e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.698
    reference variance = 0.495482
====================================================
  Execution time = 2.6063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4825e-01
  Total weights = 1.955173711e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437875291364
                                         uncertainty =       0.002203007579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437875291364
                                         uncertainty =       0.002203007579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467916631
  error estimate for blocks of size 2^( 2) =       0.000492255546
  error estimate for blocks of size 2^( 3) =       0.000514157232
  error estimate for blocks of size 2^( 4) =       0.000529777766
  error estimate for blocks of size 2^( 5) =       0.000539477475
  error estimate for blocks of size 2^( 6) =       0.000543954513
  error estimate for blocks of size 2^( 7) =       0.000545340435

      target function =      -0.746749627908
              le_mean =     -22.661344250047
             les_mean =     513.984768430788
             stat err =       0.000539637547
             autocorr =       1.330048127329
   target nu stat err =       0.000539637547
   target dn stat err =       0.002779107945
      target stat err =       0.002362235812
              std dev =       0.661734045994
             le_variance =       0.437891947628


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266134425005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746756107110       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746756107629       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746756107727       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746756107743       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746756107732       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746756107745       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746756107747       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746756107745       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746756107713       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+04 is 6.639959e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746756107110       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746756107240       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746756107264       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746756107267       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746756107297       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746756107235       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746756107116       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746756107334       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746756107356       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+04 is 1.659992e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746756107110       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746756107143       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746756107149       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746756107150       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746756106977       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746756106939       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746756106378       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746756107150       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746756107046       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+05 is 4.149980e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332779 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0822e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890262e-03 3 1  ON 12
ci_014                 8.883150e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196018e-03 3 1  ON 18
ci_020                -1.162718e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499180e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703437e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049490e-03 3 1  ON 30
ci_032                 3.613900e-03 3 1  ON 31
ci_033                 3.444278e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149754e-03 3 1  ON 35
ci_037                 3.394128e-03 3 1  ON 36
ci_038                 3.337423e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419461e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823194e-04 3 1  ON 46
ci_048                -1.162342e-03 3 1  ON 47
ci_049                 7.340447e-04 3 1  ON 48
ci_050                 7.953525e-04 3 1  ON 49
ci_051                -1.520900e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577304e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020900e-03 3 1  ON 57
ci_059                -4.033880e-04 3 1  ON 58
ci_060                -1.877468e-04 3 1  ON 59
ci_061                -6.647435e-04 3 1  ON 60
ci_062                -5.383617e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292980e-04 3 1  ON 63
ci_065                -1.742610e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600911e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115513e-06 3 1  ON 68
ci_070                 1.932029e-04 3 1  ON 69
ci_071                -1.536954e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528895e-04 3 1  ON 72
ci_074                 1.511690e-04 3 1  ON 73
ci_075                 5.764559e-05 3 1  ON 74
ci_076                 2.379207e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.737
    reference variance = 0.25235
====================================================
  Execution time = 2.5612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4834e-01
  Total weights = 1.9554e+06
  Execution time = 3.6369e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437990656678
                                         uncertainty =       0.002151975682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437990656678
                                         uncertainty =       0.002151975682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467995033
  error estimate for blocks of size 2^( 2) =       0.000491873890
  error estimate for blocks of size 2^( 3) =       0.000514455940
  error estimate for blocks of size 2^( 4) =       0.000531081858
  error estimate for blocks of size 2^( 5) =       0.000540993768
  error estimate for blocks of size 2^( 6) =       0.000546372069
  error estimate for blocks of size 2^( 7) =       0.000547940353

      target function =      -0.746658327927
              le_mean =     -22.660839716314
             les_mean =     513.962001091364
             stat err =       0.000541597012
             autocorr =       1.339275829044
   target nu stat err =       0.000541597012
   target dn stat err =       0.003253367250
      target stat err =       0.002739368219
              std dev =       0.661844923256
             le_variance =       0.438038702440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437990656012
                                         uncertainty =       0.002151975911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437990656012
                                         uncertainty =       0.002151975911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467995033
  error estimate for blocks of size 2^( 2) =       0.000491873890
  error estimate for blocks of size 2^( 3) =       0.000514455940
  error estimate for blocks of size 2^( 4) =       0.000531081858
  error estimate for blocks of size 2^( 5) =       0.000540993768
  error estimate for blocks of size 2^( 6) =       0.000546372069
  error estimate for blocks of size 2^( 7) =       0.000547940352

      target function =      -0.746658320014
              le_mean =     -22.660839716286
             les_mean =     513.962001099716
             stat err =       0.000541597012
             autocorr =       1.339275831286
   target nu stat err =       0.000541597012
   target dn stat err =       0.003253367890
      target stat err =       0.002739368675
              std dev =       0.661844922747
             le_variance =       0.438038701766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437990656345
                                         uncertainty =       0.002151975796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437990656345
                                         uncertainty =       0.002151975796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467995033
  error estimate for blocks of size 2^( 2) =       0.000491873890
  error estimate for blocks of size 2^( 3) =       0.000514455940
  error estimate for blocks of size 2^( 4) =       0.000531081858
  error estimate for blocks of size 2^( 5) =       0.000540993768
  error estimate for blocks of size 2^( 6) =       0.000546372069
  error estimate for blocks of size 2^( 7) =       0.000547940352

      target function =      -0.746658323972
              le_mean =     -22.660839716300
             les_mean =     513.962001095539
             stat err =       0.000541597012
             autocorr =       1.339275830161
   target nu stat err =       0.000541597012
   target dn stat err =       0.003253367570
      target stat err =       0.002739368447
              std dev =       0.661844923002
             le_variance =       0.438038702103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437990656636
                                         uncertainty =       0.002151975696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437990656636
                                         uncertainty =       0.002151975696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467995033
  error estimate for blocks of size 2^( 2) =       0.000491873890
  error estimate for blocks of size 2^( 3) =       0.000514455940
  error estimate for blocks of size 2^( 4) =       0.000531081858
  error estimate for blocks of size 2^( 5) =       0.000540993768
  error estimate for blocks of size 2^( 6) =       0.000546372069
  error estimate for blocks of size 2^( 7) =       0.000547940353

      target function =      -0.746658327433
              le_mean =     -22.660839716312
             les_mean =     513.962001091886
             stat err =       0.000541597012
             autocorr =       1.339275829182
   target nu stat err =       0.000541597012
   target dn stat err =       0.003253367290
      target stat err =       0.002739368248
              std dev =       0.661844923224
             le_variance =       0.438038702397


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746658327927        initial  <--
     2.3842e+04     2.3842e+05             6.6400e-09        -0.746658320014
     9.5367e+04     9.5367e+05             1.6600e-09        -0.746658323972
     3.8147e+05     3.8147e+06             4.1500e-10        -0.746658327433

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7544
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115863e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764559e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4583e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.5724
    reference variance = 0.260423
====================================================
  Execution time = 2.6042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5744e-01
  Total weights = 1.955096221e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444579738718
                                         uncertainty =       0.003731555048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444579738718
                                         uncertainty =       0.003731555048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471470294
  error estimate for blocks of size 2^( 2) =       0.000495304958
  error estimate for blocks of size 2^( 3) =       0.000517183556
  error estimate for blocks of size 2^( 4) =       0.000531770022
  error estimate for blocks of size 2^( 5) =       0.000541668659
  error estimate for blocks of size 2^( 6) =       0.000546082379
  error estimate for blocks of size 2^( 7) =       0.000545458623

      target function =      -0.739242697148
              le_mean =     -22.662205852555
             les_mean =     514.033016338454
             stat err =       0.000541244921
             autocorr =       1.317889502876
   target nu stat err =       0.000541244921
   target dn stat err =       0.005384744451
      target stat err =       0.004386728226
              std dev =       0.666759684243
             le_variance =       0.444568476532


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266220585256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739267585267       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739267585335       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739267585345       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739267585347       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739267585263       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739267585770       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739267585652       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739267585164       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739267585779       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739267584918       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739267585689       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+05 is 1.203272e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739267585267       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739267585284       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739267585287       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739267585287       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739267585287       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739267585287       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739267585287       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739267585287       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739267587005       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739267586523       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739267585287       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+05 is 3.008182e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739267585267       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739267585272       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739267585272       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739267585272       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739267585272       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739267583878       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739267579781       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739267579252       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739267585741       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739267591859       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739267583462       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+06 is 7.520464e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.336917 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0769e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340452e-04 3 1  ON 48
ci_050                 7.953531e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577304e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115898e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528895e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764569e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.6172
    reference variance = 0.45682
====================================================
  Execution time = 2.5414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5243e-01
  Total weights = 1.9548e+06
  Execution time = 3.6335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441005178806
                                         uncertainty =       0.002119289135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441005178806
                                         uncertainty =       0.002119289135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469614551
  error estimate for blocks of size 2^( 2) =       0.000493692610
  error estimate for blocks of size 2^( 3) =       0.000516728031
  error estimate for blocks of size 2^( 4) =       0.000532752444
  error estimate for blocks of size 2^( 5) =       0.000542615011
  error estimate for blocks of size 2^( 6) =       0.000546731273
  error estimate for blocks of size 2^( 7) =       0.000549349241

      target function =      -0.743327555698
              le_mean =     -22.662141490427
             les_mean =     514.025087146504
             stat err =       0.000542861992
             autocorr =       1.336274810706
   target nu stat err =       0.000542861992
   target dn stat err =       0.003044287616
      target stat err =       0.002554871011
              std dev =       0.664135267463
             le_variance =       0.441075653488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441005178639
                                         uncertainty =       0.002119289123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441005178639
                                         uncertainty =       0.002119289123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469614551
  error estimate for blocks of size 2^( 2) =       0.000493692610
  error estimate for blocks of size 2^( 3) =       0.000516728031
  error estimate for blocks of size 2^( 4) =       0.000532752444
  error estimate for blocks of size 2^( 5) =       0.000542615011
  error estimate for blocks of size 2^( 6) =       0.000546731273
  error estimate for blocks of size 2^( 7) =       0.000549349241

      target function =      -0.743327555387
              le_mean =     -22.662141490427
             les_mean =     514.025087146908
             stat err =       0.000542861992
             autocorr =       1.336274810838
   target nu stat err =       0.000542861992
   target dn stat err =       0.003044287602
      target stat err =       0.002554870998
              std dev =       0.664135267339
             le_variance =       0.441075653323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441005178723
                                         uncertainty =       0.002119289129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441005178723
                                         uncertainty =       0.002119289129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469614551
  error estimate for blocks of size 2^( 2) =       0.000493692610
  error estimate for blocks of size 2^( 3) =       0.000516728031
  error estimate for blocks of size 2^( 4) =       0.000532752444
  error estimate for blocks of size 2^( 5) =       0.000542615011
  error estimate for blocks of size 2^( 6) =       0.000546731273
  error estimate for blocks of size 2^( 7) =       0.000549349241

      target function =      -0.743327555543
              le_mean =     -22.662141490427
             les_mean =     514.025087146706
             stat err =       0.000542861992
             autocorr =       1.336274810767
   target nu stat err =       0.000542861992
   target dn stat err =       0.003044287609
      target stat err =       0.002554871004
              std dev =       0.664135267401
             le_variance =       0.441075653406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441005178796
                                         uncertainty =       0.002119289134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441005178796
                                         uncertainty =       0.002119289134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469614551
  error estimate for blocks of size 2^( 2) =       0.000493692610
  error estimate for blocks of size 2^( 3) =       0.000516728031
  error estimate for blocks of size 2^( 4) =       0.000532752444
  error estimate for blocks of size 2^( 5) =       0.000542615011
  error estimate for blocks of size 2^( 6) =       0.000546731273
  error estimate for blocks of size 2^( 7) =       0.000549349241

      target function =      -0.743327555679
              le_mean =     -22.662141490427
             les_mean =     514.025087146529
             stat err =       0.000542861992
             autocorr =       1.336274810715
   target nu stat err =       0.000542861992
   target dn stat err =       0.003044287615
      target stat err =       0.002554871010
              std dev =       0.664135267455
             le_variance =       0.441075653478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743327555698        initial  <--
     2.3842e+05     2.3842e+06             1.2033e-09        -0.743327555387
     9.5367e+05     9.5367e+06             3.0082e-10        -0.743327555543
     3.8147e+06     3.8147e+07             7.5205e-11        -0.743327555679

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5308
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115863e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764559e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.6904
    reference variance = 0.357063
====================================================
  Execution time = 2.6141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4602e-01
  Total weights = 1.955199978e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437690176074
                                         uncertainty =       0.001927914905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437690176074
                                         uncertainty =       0.001927914905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467828409
  error estimate for blocks of size 2^( 2) =       0.000491934688
  error estimate for blocks of size 2^( 3) =       0.000514159399
  error estimate for blocks of size 2^( 4) =       0.000529728656
  error estimate for blocks of size 2^( 5) =       0.000539432643
  error estimate for blocks of size 2^( 6) =       0.000543932460
  error estimate for blocks of size 2^( 7) =       0.000547307783

      target function =      -0.748595173293
              le_mean =     -22.661644182115
             les_mean =     513.996132313305
             stat err =       0.000540100386
             autocorr =       1.332833172577
   target nu stat err =       0.000540100386
   target dn stat err =       0.002391477523
      target stat err =       0.002065987855
              std dev =       0.661609280665
             le_variance =       0.437726840261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266164418211e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748599939713       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748599939721       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748599939722       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748599939722       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748599938996       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748599933517       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748599942517       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748599939722       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748599935150       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748599942502       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+06 is 7.756716e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748599939713       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748599939715       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748599939715       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748599939657       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748599937340       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748599929930       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748599936001       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748599950804       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748599925891       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748599932395       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+06 is 1.939185e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748599939713       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748599939713       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748599939713       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748599939620       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748599939713       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748599939713       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748599881778       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748599903485       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748599939713       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748599991833       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+07 is 4.847967e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.340476 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0871e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115858e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764560e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.7457
    reference variance = 0.340627
====================================================
  Execution time = 2.7253e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4959e-01
  Total weights = 1.9554e+06
  Execution time = 3.6331e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438529103589
                                         uncertainty =       0.002416514792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438529103589
                                         uncertainty =       0.002416514792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468814452
  error estimate for blocks of size 2^( 2) =       0.000492589859
  error estimate for blocks of size 2^( 3) =       0.000514130931
  error estimate for blocks of size 2^( 4) =       0.000531318477
  error estimate for blocks of size 2^( 5) =       0.000540079810
  error estimate for blocks of size 2^( 6) =       0.000544333943
  error estimate for blocks of size 2^( 7) =       0.000548513158

      target function =      -0.745643954702
              le_mean =     -22.661526798053
             les_mean =     513.994386340901
             stat err =       0.000541061347
             autocorr =       1.331959551132
   target nu stat err =       0.000541061347
   target dn stat err =       0.003259751862
      target stat err =       0.002739863943
              std dev =       0.663003756543
             le_variance =       0.439573981191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438529103569
                                         uncertainty =       0.002416514792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438529103569
                                         uncertainty =       0.002416514792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468814452
  error estimate for blocks of size 2^( 2) =       0.000492589859
  error estimate for blocks of size 2^( 3) =       0.000514130931
  error estimate for blocks of size 2^( 4) =       0.000531318477
  error estimate for blocks of size 2^( 5) =       0.000540079810
  error estimate for blocks of size 2^( 6) =       0.000544333943
  error estimate for blocks of size 2^( 7) =       0.000548513158

      target function =      -0.745643954783
              le_mean =     -22.661526798054
             les_mean =     513.994386340825
             stat err =       0.000541061347
             autocorr =       1.331959551171
   target nu stat err =       0.000541061347
   target dn stat err =       0.003259751847
      target stat err =       0.002739863931
              std dev =       0.663003756528
             le_variance =       0.439573981170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438529103579
                                         uncertainty =       0.002416514792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438529103579
                                         uncertainty =       0.002416514792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468814452
  error estimate for blocks of size 2^( 2) =       0.000492589859
  error estimate for blocks of size 2^( 3) =       0.000514130931
  error estimate for blocks of size 2^( 4) =       0.000531318477
  error estimate for blocks of size 2^( 5) =       0.000540079810
  error estimate for blocks of size 2^( 6) =       0.000544333943
  error estimate for blocks of size 2^( 7) =       0.000548513158

      target function =      -0.745643954742
              le_mean =     -22.661526798053
             les_mean =     513.994386340863
             stat err =       0.000541061347
             autocorr =       1.331959551153
   target nu stat err =       0.000541061347
   target dn stat err =       0.003259751854
      target stat err =       0.002739863937
              std dev =       0.663003756535
             le_variance =       0.439573981180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438529103588
                                         uncertainty =       0.002416514792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438529103588
                                         uncertainty =       0.002416514792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468814452
  error estimate for blocks of size 2^( 2) =       0.000492589859
  error estimate for blocks of size 2^( 3) =       0.000514130931
  error estimate for blocks of size 2^( 4) =       0.000531318477
  error estimate for blocks of size 2^( 5) =       0.000540079810
  error estimate for blocks of size 2^( 6) =       0.000544333943
  error estimate for blocks of size 2^( 7) =       0.000548513158

      target function =      -0.745643954707
              le_mean =     -22.661526798053
             les_mean =     513.994386340897
             stat err =       0.000541061347
             autocorr =       1.331959551131
   target nu stat err =       0.000541061347
   target dn stat err =       0.003259751861
      target stat err =       0.002739863942
              std dev =       0.663003756542
             le_variance =       0.439573981189


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745643954702        initial
     2.3842e+06     2.3842e+07             7.7567e-11        -0.745643954783  <--
     9.5367e+06     9.5367e+07             1.9392e-11        -0.745643954742
     3.8147e+07     3.8147e+08             4.8480e-12        -0.745643954707

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 4.5366e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292978e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115843e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764562e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6264e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.5964
    reference variance = 0.384842
====================================================
  Execution time = 2.6155e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4944e-01
  Total weights = 1.954792289e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439731840664
                                         uncertainty =       0.002297621538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439731840664
                                         uncertainty =       0.002297621538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468856710
  error estimate for blocks of size 2^( 2) =       0.000492949294
  error estimate for blocks of size 2^( 3) =       0.000515833468
  error estimate for blocks of size 2^( 4) =       0.000532218615
  error estimate for blocks of size 2^( 5) =       0.000540808984
  error estimate for blocks of size 2^( 6) =       0.000546219574
  error estimate for blocks of size 2^( 7) =       0.000549050273

      target function =      -0.745762458992
              le_mean =     -22.661258170950
             les_mean =     513.982065416397
             stat err =       0.000542074361
             autocorr =       1.336710819080
   target nu stat err =       0.000542074361
   target dn stat err =       0.003074881544
      target stat err =       0.002592048066
              std dev =       0.663063517441
             le_variance =       0.439653228161


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266125817095e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745770561266       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745770561296       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745770561299       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745770561202       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745770561260       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745770561297       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745770560955       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745770560181       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745770560268       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745770561571       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745770560755       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+05 is 3.000955e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745770561266       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745770561273       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745770561274       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745770562849       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745770561850       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745770558126       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745770565550       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745770559427       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745770561274       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745770554112       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745770562853       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+06 is 7.502391e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745770561266       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745770561268       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745770561268       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745770561395       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745770560856       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745770561506       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745770561462       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745770561268       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745770543022       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745770569230       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745770583220       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+06 is 1.875601e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0888e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292978e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115847e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764562e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.5638
    reference variance = 0.332124
====================================================
  Execution time = 2.5660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4825e-01
  Total weights = 1.9553e+06
  Execution time = 3.6089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439051741595
                                         uncertainty =       0.002311306807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439051741595
                                         uncertainty =       0.002311306807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468568917
  error estimate for blocks of size 2^( 2) =       0.000492307951
  error estimate for blocks of size 2^( 3) =       0.000514168940
  error estimate for blocks of size 2^( 4) =       0.000529894416
  error estimate for blocks of size 2^( 5) =       0.000540878010
  error estimate for blocks of size 2^( 6) =       0.000545214057
  error estimate for blocks of size 2^( 7) =       0.000547040179

      target function =      -0.746753267671
              le_mean =     -22.661827845093
             les_mean =     514.006688808382
             stat err =       0.000540756666
             autocorr =       1.331854588652
   target nu stat err =       0.000540756666
   target dn stat err =       0.002940972861
      target stat err =       0.002493432167
              std dev =       0.662656517213
             le_variance =       0.439113659805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439051741548
                                         uncertainty =       0.002311306811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439051741548
                                         uncertainty =       0.002311306811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468568917
  error estimate for blocks of size 2^( 2) =       0.000492307951
  error estimate for blocks of size 2^( 3) =       0.000514168940
  error estimate for blocks of size 2^( 4) =       0.000529894416
  error estimate for blocks of size 2^( 5) =       0.000540878010
  error estimate for blocks of size 2^( 6) =       0.000545214057
  error estimate for blocks of size 2^( 7) =       0.000547040179

      target function =      -0.746753267352
              le_mean =     -22.661827845090
             les_mean =     514.006688808650
             stat err =       0.000540756666
             autocorr =       1.331854588788
   target nu stat err =       0.000540756666
   target dn stat err =       0.002940972908
      target stat err =       0.002493432203
              std dev =       0.662656517178
             le_variance =       0.439113659758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439051741571
                                         uncertainty =       0.002311306809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439051741571
                                         uncertainty =       0.002311306809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468568917
  error estimate for blocks of size 2^( 2) =       0.000492307951
  error estimate for blocks of size 2^( 3) =       0.000514168940
  error estimate for blocks of size 2^( 4) =       0.000529894416
  error estimate for blocks of size 2^( 5) =       0.000540878010
  error estimate for blocks of size 2^( 6) =       0.000545214057
  error estimate for blocks of size 2^( 7) =       0.000547040179

      target function =      -0.746753267512
              le_mean =     -22.661827845091
             les_mean =     514.006688808516
             stat err =       0.000540756666
             autocorr =       1.331854588718
   target nu stat err =       0.000540756666
   target dn stat err =       0.002940972885
      target stat err =       0.002493432185
              std dev =       0.662656517195
             le_variance =       0.439113659781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439051741592
                                         uncertainty =       0.002311306807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439051741592
                                         uncertainty =       0.002311306807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468568917
  error estimate for blocks of size 2^( 2) =       0.000492307951
  error estimate for blocks of size 2^( 3) =       0.000514168940
  error estimate for blocks of size 2^( 4) =       0.000529894416
  error estimate for blocks of size 2^( 5) =       0.000540878010
  error estimate for blocks of size 2^( 6) =       0.000545214057
  error estimate for blocks of size 2^( 7) =       0.000547040179

      target function =      -0.746753267651
              le_mean =     -22.661827845092
             les_mean =     514.006688808399
             stat err =       0.000540756666
             autocorr =       1.331854588665
   target nu stat err =       0.000540756666
   target dn stat err =       0.002940972864
      target stat err =       0.002493432170
              std dev =       0.662656517211
             le_variance =       0.439113659802


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746753267671        initial  <--
     5.9605e+05     5.9605e+06             3.0010e-10        -0.746753267352
     2.3842e+06     2.3842e+07             7.5024e-11        -0.746753267512
     9.5367e+06     9.5367e+07             1.8756e-11        -0.746753267651

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7221
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292978e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115843e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764562e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4617e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.6823
    reference variance = 0.642876
====================================================
  Execution time = 2.6148e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4979e-01
  Total weights = 1.955087121e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439330632992
                                         uncertainty =       0.002174050217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439330632992
                                         uncertainty =       0.002174050217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468651887
  error estimate for blocks of size 2^( 2) =       0.000492632659
  error estimate for blocks of size 2^( 3) =       0.000514999124
  error estimate for blocks of size 2^( 4) =       0.000531223559
  error estimate for blocks of size 2^( 5) =       0.000539364401
  error estimate for blocks of size 2^( 6) =       0.000542427831
  error estimate for blocks of size 2^( 7) =       0.000544984153

      target function =      -0.745473503251
              le_mean =     -22.661066539366
             les_mean =     513.973730277685
             stat err =       0.000539499986
             autocorr =       1.325202159391
   target nu stat err =       0.000539499986
   target dn stat err =       0.003015176500
      target stat err =       0.002541107749
              std dev =       0.662773854918
             le_variance =       0.439269182763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266106653937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745481193537       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745481193542       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745481193543       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745481193544       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745481193897       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745481191556       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745481189318       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745481194355       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745481191999       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+06 is 4.357628e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745481193537       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745481193539       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745481193539       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745481193539       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745481193538       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745481227601       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745481227771       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745481194437       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745481198179       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+07 is 1.089408e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745481193537       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745481193538       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745481193538       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745481185963       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745481176081       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745481241005       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745481425747       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745481440473       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745481330154       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+07 is 2.723524e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0847e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292978e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115843e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764562e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.6032
    reference variance = 0.366172
====================================================
  Execution time = 2.5716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5416e-01
  Total weights = 1.9554e+06
  Execution time = 3.6341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443025313822
                                         uncertainty =       0.002628878915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443025313822
                                         uncertainty =       0.002628878915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470676103
  error estimate for blocks of size 2^( 2) =       0.000494798587
  error estimate for blocks of size 2^( 3) =       0.000517010218
  error estimate for blocks of size 2^( 4) =       0.000533278020
  error estimate for blocks of size 2^( 5) =       0.000543553070
  error estimate for blocks of size 2^( 6) =       0.000548538036
  error estimate for blocks of size 2^( 7) =       0.000551034915

      target function =      -0.741909234080
              le_mean =     -22.661752069783
             les_mean =     514.009171844217
             stat err =       0.000544101010
             autocorr =       1.336333226058
   target nu stat err =       0.000544101010
   target dn stat err =       0.003582225062
      target stat err =       0.002970945514
              std dev =       0.665636528169
             le_variance =       0.443071987632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443025313813
                                         uncertainty =       0.002628878914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443025313813
                                         uncertainty =       0.002628878914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470676103
  error estimate for blocks of size 2^( 2) =       0.000494798587
  error estimate for blocks of size 2^( 3) =       0.000517010218
  error estimate for blocks of size 2^( 4) =       0.000533278020
  error estimate for blocks of size 2^( 5) =       0.000543553070
  error estimate for blocks of size 2^( 6) =       0.000548538036
  error estimate for blocks of size 2^( 7) =       0.000551034915

      target function =      -0.741909234369
              le_mean =     -22.661752069783
             les_mean =     514.009171843864
             stat err =       0.000544101010
             autocorr =       1.336333226072
   target nu stat err =       0.000544101010
   target dn stat err =       0.003582225004
      target stat err =       0.002970945471
              std dev =       0.665636528162
             le_variance =       0.443071987623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443025313818
                                         uncertainty =       0.002628878914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443025313818
                                         uncertainty =       0.002628878914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470676103
  error estimate for blocks of size 2^( 2) =       0.000494798587
  error estimate for blocks of size 2^( 3) =       0.000517010218
  error estimate for blocks of size 2^( 4) =       0.000533278020
  error estimate for blocks of size 2^( 5) =       0.000543553070
  error estimate for blocks of size 2^( 6) =       0.000548538036
  error estimate for blocks of size 2^( 7) =       0.000551034915

      target function =      -0.741909234224
              le_mean =     -22.661752069783
             les_mean =     514.009171844040
             stat err =       0.000544101010
             autocorr =       1.336333226060
   target nu stat err =       0.000544101010
   target dn stat err =       0.003582225033
      target stat err =       0.002970945493
              std dev =       0.665636528165
             le_variance =       0.443071987628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443025313822
                                         uncertainty =       0.002628878915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443025313822
                                         uncertainty =       0.002628878915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470676103
  error estimate for blocks of size 2^( 2) =       0.000494798587
  error estimate for blocks of size 2^( 3) =       0.000517010218
  error estimate for blocks of size 2^( 4) =       0.000533278020
  error estimate for blocks of size 2^( 5) =       0.000543553070
  error estimate for blocks of size 2^( 6) =       0.000548538036
  error estimate for blocks of size 2^( 7) =       0.000551034915

      target function =      -0.741909234098
              le_mean =     -22.661752069783
             les_mean =     514.009171844195
             stat err =       0.000544101010
             autocorr =       1.336333226056
   target nu stat err =       0.000544101010
   target dn stat err =       0.003582225058
      target stat err =       0.002970945512
              std dev =       0.665636528168
             le_variance =       0.443071987632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741909234080        initial
     5.9605e+06     5.9605e+07             4.3576e-11        -0.741909234369  <--
     2.3842e+07     2.3842e+08             1.0894e-11        -0.741909234224
     9.5367e+07     9.5367e+08             2.7235e-12        -0.741909234098

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 4.3819e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196016e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292978e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115842e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764562e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4672e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.5759
    reference variance = 0.458159
====================================================
  Execution time = 2.6064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5454e-01
  Total weights = 1.955107081e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440130383276
                                         uncertainty =       0.003013924113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440130383276
                                         uncertainty =       0.003013924113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469131594
  error estimate for blocks of size 2^( 2) =       0.000493464280
  error estimate for blocks of size 2^( 3) =       0.000515987312
  error estimate for blocks of size 2^( 4) =       0.000531033150
  error estimate for blocks of size 2^( 5) =       0.000539785414
  error estimate for blocks of size 2^( 6) =       0.000545288504
  error estimate for blocks of size 2^( 7) =       0.000549649029

      target function =      -0.741568449558
              le_mean =     -22.661700195958
             les_mean =     514.007191495421
             stat err =       0.000541439024
             autocorr =       1.332016931481
   target nu stat err =       0.000541439024
   target dn stat err =       0.007546307954
      target stat err =       0.006154242090
              std dev =       0.663452262886
             le_variance =       0.440168905128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266170019596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741618850558       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741618850574       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741618850577       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741618850577       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741618850559       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741618850582       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741618852274       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741618851330       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741618850120       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741618844395       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741618849108       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+06 is 2.372865e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741618850558       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741618850562       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741618850563       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741618850563       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741618850563       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741618850610       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741618848762       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741618862918       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741618849684       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741618828653       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741618847941       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+06 is 5.932173e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741618850558       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741618850559       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741618850559       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741618850559       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741618850559       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741618850559       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741618847373       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741618850870       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741618837815       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741618879240       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741618906439       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+07 is 1.483039e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0778e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041970e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115829e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764564e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.7
    reference variance = 0.441482
====================================================
  Execution time = 2.5579e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5573e-01
  Total weights = 1.9552e+06
  Execution time = 3.6344e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444627303961
                                         uncertainty =       0.003402031951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444627303961
                                         uncertainty =       0.003402031951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471501768
  error estimate for blocks of size 2^( 2) =       0.000495355207
  error estimate for blocks of size 2^( 3) =       0.000517986116
  error estimate for blocks of size 2^( 4) =       0.000533698736
  error estimate for blocks of size 2^( 5) =       0.000542042438
  error estimate for blocks of size 2^( 6) =       0.000545881143
  error estimate for blocks of size 2^( 7) =       0.000547312328

      target function =      -0.740644320999
              le_mean =     -22.662174496508
             les_mean =     514.029877988719
             stat err =       0.000542233661
             autocorr =       1.322532334457
   target nu stat err =       0.000542233661
   target dn stat err =       0.003724954623
      target stat err =       0.003075859519
              std dev =       0.666804194567
             le_variance =       0.444627833892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444627303847
                                         uncertainty =       0.003402031898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444627303847
                                         uncertainty =       0.003402031898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471501768
  error estimate for blocks of size 2^( 2) =       0.000495355207
  error estimate for blocks of size 2^( 3) =       0.000517986116
  error estimate for blocks of size 2^( 4) =       0.000533698736
  error estimate for blocks of size 2^( 5) =       0.000542042438
  error estimate for blocks of size 2^( 6) =       0.000545881143
  error estimate for blocks of size 2^( 7) =       0.000547312327

      target function =      -0.740644321080
              le_mean =     -22.662174496509
             les_mean =     514.029877988662
             stat err =       0.000542233661
             autocorr =       1.322532334526
   target nu stat err =       0.000542233661
   target dn stat err =       0.003724954507
      target stat err =       0.003075859428
              std dev =       0.666804194481
             le_variance =       0.444627833778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444627303904
                                         uncertainty =       0.003402031924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444627303904
                                         uncertainty =       0.003402031924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471501768
  error estimate for blocks of size 2^( 2) =       0.000495355207
  error estimate for blocks of size 2^( 3) =       0.000517986116
  error estimate for blocks of size 2^( 4) =       0.000533698736
  error estimate for blocks of size 2^( 5) =       0.000542042438
  error estimate for blocks of size 2^( 6) =       0.000545881143
  error estimate for blocks of size 2^( 7) =       0.000547312328

      target function =      -0.740644321040
              le_mean =     -22.662174496509
             les_mean =     514.029877988691
             stat err =       0.000542233661
             autocorr =       1.322532334492
   target nu stat err =       0.000542233661
   target dn stat err =       0.003724954565
      target stat err =       0.003075859473
              std dev =       0.666804194524
             le_variance =       0.444627833835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444627303954
                                         uncertainty =       0.003402031948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444627303954
                                         uncertainty =       0.003402031948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471501768
  error estimate for blocks of size 2^( 2) =       0.000495355207
  error estimate for blocks of size 2^( 3) =       0.000517986116
  error estimate for blocks of size 2^( 4) =       0.000533698736
  error estimate for blocks of size 2^( 5) =       0.000542042438
  error estimate for blocks of size 2^( 6) =       0.000545881143
  error estimate for blocks of size 2^( 7) =       0.000547312328

      target function =      -0.740644321004
              le_mean =     -22.662174496508
             les_mean =     514.029877988716
             stat err =       0.000542233661
             autocorr =       1.322532334470
   target nu stat err =       0.000542233661
   target dn stat err =       0.003724954615
      target stat err =       0.003075859513
              std dev =       0.666804194562
             le_variance =       0.444627833885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740644320999        initial
     1.4901e+06     1.4901e+07             2.3729e-10        -0.740644321080  <--
     5.9605e+06     5.9605e+07             5.9322e-11        -0.740644321040
     2.3842e+07     2.3842e+08             1.4830e-11        -0.740644321004

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 4.3699e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419461e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115791e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764567e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4483e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7453
    reference variance = 0.284545
====================================================
  Execution time = 2.6120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4673e-01
  Total weights = 1.955180856e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438245284776
                                         uncertainty =       0.002373857505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438245284776
                                         uncertainty =       0.002373857505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468098656
  error estimate for blocks of size 2^( 2) =       0.000492714453
  error estimate for blocks of size 2^( 3) =       0.000515142789
  error estimate for blocks of size 2^( 4) =       0.000531534090
  error estimate for blocks of size 2^( 5) =       0.000540368938
  error estimate for blocks of size 2^( 6) =       0.000544972154
  error estimate for blocks of size 2^( 7) =       0.000548436072

      target function =      -0.748006723545
              le_mean =     -22.662155682460
             les_mean =     514.020031706796
             stat err =       0.000541327814
             autocorr =       1.337352503300
   target nu stat err =       0.000541327814
   target dn stat err =       0.003180676021
      target stat err =       0.002695706467
              std dev =       0.661991468113
             le_variance =       0.438232703854


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266215568246e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748015503232       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748015503271       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748015503277       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748015503277       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748015503277       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748015503277       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748015503278       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748015503278       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748015503278       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748015502663       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748015503277       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+05 is 5.754299e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748015503232       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748015503242       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748015503243       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748015503243       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748015503243       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748015503047       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748015503243       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748015502673       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748015501825       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748015503243       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748015503243       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+06 is 1.438575e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748015503232       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748015503234       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748015503235       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748015503235       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748015503235       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748015503235       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748015503235       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748015503235       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748015503235       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748015503235       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748015503235       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+06 is 3.596436e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.355964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0859e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321886e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647437e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115743e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764569e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.6268
    reference variance = 0.283233
====================================================
  Execution time = 2.7248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4774e-01
  Total weights = 1.9550e+06
  Execution time = 3.6420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438627917624
                                         uncertainty =       0.002046220074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438627917624
                                         uncertainty =       0.002046220074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468285161
  error estimate for blocks of size 2^( 2) =       0.000491856010
  error estimate for blocks of size 2^( 3) =       0.000513840740
  error estimate for blocks of size 2^( 4) =       0.000529682172
  error estimate for blocks of size 2^( 5) =       0.000539890276
  error estimate for blocks of size 2^( 6) =       0.000543282887
  error estimate for blocks of size 2^( 7) =       0.000545056611

      target function =      -0.747174749292
              le_mean =     -22.661978730648
             les_mean =     514.013020674194
             stat err =       0.000539477987
             autocorr =       1.327170330251
   target nu stat err =       0.000539477987
   target dn stat err =       0.002544154631
      target stat err =       0.002180092782
              std dev =       0.662255225383
             le_variance =       0.438581983547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438627917440
                                         uncertainty =       0.002046220062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438627917440
                                         uncertainty =       0.002046220062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468285161
  error estimate for blocks of size 2^( 2) =       0.000491856010
  error estimate for blocks of size 2^( 3) =       0.000513840739
  error estimate for blocks of size 2^( 4) =       0.000529682172
  error estimate for blocks of size 2^( 5) =       0.000539890276
  error estimate for blocks of size 2^( 6) =       0.000543282887
  error estimate for blocks of size 2^( 7) =       0.000545056611

      target function =      -0.747174749120
              le_mean =     -22.661978730644
             les_mean =     514.013020674215
             stat err =       0.000539477986
             autocorr =       1.327170330400
   target nu stat err =       0.000539477986
   target dn stat err =       0.002544154605
      target stat err =       0.002180092761
              std dev =       0.662255225245
             le_variance =       0.438581983364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438627917532
                                         uncertainty =       0.002046220068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438627917532
                                         uncertainty =       0.002046220068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468285161
  error estimate for blocks of size 2^( 2) =       0.000491856010
  error estimate for blocks of size 2^( 3) =       0.000513840739
  error estimate for blocks of size 2^( 4) =       0.000529682172
  error estimate for blocks of size 2^( 5) =       0.000539890276
  error estimate for blocks of size 2^( 6) =       0.000543282887
  error estimate for blocks of size 2^( 7) =       0.000545056611

      target function =      -0.747174749206
              le_mean =     -22.661978730646
             les_mean =     514.013020674204
             stat err =       0.000539477987
             autocorr =       1.327170330319
   target nu stat err =       0.000539477987
   target dn stat err =       0.002544154618
      target stat err =       0.002180092772
              std dev =       0.662255225314
             le_variance =       0.438581983455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438627917612
                                         uncertainty =       0.002046220073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438627917612
                                         uncertainty =       0.002046220073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468285161
  error estimate for blocks of size 2^( 2) =       0.000491856010
  error estimate for blocks of size 2^( 3) =       0.000513840740
  error estimate for blocks of size 2^( 4) =       0.000529682172
  error estimate for blocks of size 2^( 5) =       0.000539890276
  error estimate for blocks of size 2^( 6) =       0.000543282887
  error estimate for blocks of size 2^( 7) =       0.000545056611

      target function =      -0.747174749281
              le_mean =     -22.661978730648
             les_mean =     514.013020674195
             stat err =       0.000539477987
             autocorr =       1.327170330262
   target nu stat err =       0.000539477987
   target dn stat err =       0.002544154629
      target stat err =       0.002180092781
              std dev =       0.662255225374
             le_variance =       0.438581983535


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747174749292        initial  <--
     3.7253e+05     3.7253e+06             5.7543e-10        -0.747174749120
     1.4901e+06     1.4901e+07             1.4386e-10        -0.747174749206
     5.9605e+06     5.9605e+07             3.5964e-11        -0.747174749281

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4610
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419461e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115791e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764567e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6357e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.6748
    reference variance = 0.316809
====================================================
  Execution time = 2.6982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5980e-01
  Total weights = 1.955113665e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7153e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446392095662
                                         uncertainty =       0.004904272577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446392095662
                                         uncertainty =       0.004904272577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472662230
  error estimate for blocks of size 2^( 2) =       0.000496440067
  error estimate for blocks of size 2^( 3) =       0.000518702659
  error estimate for blocks of size 2^( 4) =       0.000534331501
  error estimate for blocks of size 2^( 5) =       0.000542105118
  error estimate for blocks of size 2^( 6) =       0.000547529661
  error estimate for blocks of size 2^( 7) =       0.000549503620

      target function =      -0.737338271268
              le_mean =     -22.661940463579
             les_mean =     514.023345767749
             stat err =       0.000543367475
             autocorr =       1.321555719242
   target nu stat err =       0.000543367475
   target dn stat err =       0.005985277228
      target stat err =       0.004841078284
              std dev =       0.668445335851
             le_variance =       0.446819167020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266194046358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737369397163       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737369397175       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737369397184       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737369397209       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737369399319       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737369400971       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737369397186       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737369397186       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737369394732       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737369401102       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737369390210       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737369404101       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.737369396387       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+06 is 1.005046e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737369397163       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737369397166       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737369397169       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737369399808       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737369386530       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737369397169       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737369410400       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737369430455       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737369415999       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737369389148       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737369417854       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737369384048       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.737369388365       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+07 is 2.512617e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737369397163       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737369397164       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737369397165       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737369397165       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737369374716       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737369402074       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737369533542       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737369344256       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737369324871       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737369530434       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737369368911       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737369432601       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.737369402613       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+07 is 6.281512e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361521 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1709e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309777e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115798e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764565e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.6247
    reference variance = 0.310734
====================================================
  Execution time = 2.5473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5017e-01
  Total weights = 1.9555e+06
  Execution time = 3.6362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441022477626
                                         uncertainty =       0.002310452252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441022477626
                                         uncertainty =       0.002310452252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469539737
  error estimate for blocks of size 2^( 2) =       0.000493692142
  error estimate for blocks of size 2^( 3) =       0.000516190898
  error estimate for blocks of size 2^( 4) =       0.000533019584
  error estimate for blocks of size 2^( 5) =       0.000542254783
  error estimate for blocks of size 2^( 6) =       0.000546661976
  error estimate for blocks of size 2^( 7) =       0.000550913093

      target function =      -0.745175628430
              le_mean =     -22.662308854488
             les_mean =     514.030415773757
             stat err =       0.000543212359
             autocorr =       1.338426659830
   target nu stat err =       0.000543212359
   target dn stat err =       0.003050333112
      target stat err =       0.002572792777
              std dev =       0.664029464830
             le_variance =       0.440935130162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441022477630
                                         uncertainty =       0.002310452255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441022477630
                                         uncertainty =       0.002310452255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469539737
  error estimate for blocks of size 2^( 2) =       0.000493692142
  error estimate for blocks of size 2^( 3) =       0.000516190898
  error estimate for blocks of size 2^( 4) =       0.000533019584
  error estimate for blocks of size 2^( 5) =       0.000542254783
  error estimate for blocks of size 2^( 6) =       0.000546661976
  error estimate for blocks of size 2^( 7) =       0.000550913093

      target function =      -0.745175628464
              le_mean =     -22.662308854487
             les_mean =     514.030415773688
             stat err =       0.000543212359
             autocorr =       1.338426659857
   target nu stat err =       0.000543212359
   target dn stat err =       0.003050333115
      target stat err =       0.002572792780
              std dev =       0.664029464833
             le_variance =       0.440935130166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441022477628
                                         uncertainty =       0.002310452253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441022477628
                                         uncertainty =       0.002310452253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469539737
  error estimate for blocks of size 2^( 2) =       0.000493692142
  error estimate for blocks of size 2^( 3) =       0.000516190898
  error estimate for blocks of size 2^( 4) =       0.000533019584
  error estimate for blocks of size 2^( 5) =       0.000542254783
  error estimate for blocks of size 2^( 6) =       0.000546661976
  error estimate for blocks of size 2^( 7) =       0.000550913093

      target function =      -0.745175628447
              le_mean =     -22.662308854488
             les_mean =     514.030415773723
             stat err =       0.000543212359
             autocorr =       1.338426659838
   target nu stat err =       0.000543212359
   target dn stat err =       0.003050333114
      target stat err =       0.002572792779
              std dev =       0.664029464831
             le_variance =       0.440935130164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441022477626
                                         uncertainty =       0.002310452252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441022477626
                                         uncertainty =       0.002310452252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469539737
  error estimate for blocks of size 2^( 2) =       0.000493692142
  error estimate for blocks of size 2^( 3) =       0.000516190898
  error estimate for blocks of size 2^( 4) =       0.000533019584
  error estimate for blocks of size 2^( 5) =       0.000542254783
  error estimate for blocks of size 2^( 6) =       0.000546661976
  error estimate for blocks of size 2^( 7) =       0.000550913093

      target function =      -0.745175628432
              le_mean =     -22.662308854488
             les_mean =     514.030415773753
             stat err =       0.000543212359
             autocorr =       1.338426659837
   target nu stat err =       0.000543212359
   target dn stat err =       0.003050333112
      target stat err =       0.002572792778
              std dev =       0.664029464830
             le_variance =       0.440935130162


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745175628430        initial
     3.7253e+06     3.7253e+07             1.0050e-10        -0.745175628464  <--
     1.4901e+07     1.4901e+08             2.5126e-11        -0.745175628447
     5.9605e+07     5.9605e+08             6.2815e-12        -0.745175628432

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 4.3594e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749861e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115819e-06 3 1  ON 68
ci_070                 1.932031e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764560e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.613
    reference variance = 0.352277
====================================================
  Execution time = 2.6064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4663e-01
  Total weights = 1.955032959e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437430759138
                                         uncertainty =       0.001726004420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437430759138
                                         uncertainty =       0.001726004420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467677939
  error estimate for blocks of size 2^( 2) =       0.000491886113
  error estimate for blocks of size 2^( 3) =       0.000513854348
  error estimate for blocks of size 2^( 4) =       0.000529949869
  error estimate for blocks of size 2^( 5) =       0.000540359663
  error estimate for blocks of size 2^( 6) =       0.000544713339
  error estimate for blocks of size 2^( 7) =       0.000547715464

      target function =      -0.748095398948
              le_mean =     -22.662002637033
             les_mean =     514.012988739977
             stat err =       0.000540684584
             autocorr =       1.336577682096
   target nu stat err =       0.000540684584
   target dn stat err =       0.002621208912
      target stat err =       0.002247032433
              std dev =       0.661396484523
             le_variance =       0.437445309739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266200263703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748101151587       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748101151611       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748101151615       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748101151614       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748101151182       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748101151158       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748101152575       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748101151301       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748101150141       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+05 is 1.873275e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748101151587       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748101151593       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748101151594       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748101151091       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748101150385       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748101152630       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748101149847       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748101154793       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748101148321       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+06 is 4.683189e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748101151587       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748101151588       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748101151588       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748101151588       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748101154984       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748101157884       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748101148139       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748101131769       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748101149292       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+07 is 1.170800e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0808e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220046e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250348e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115812e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764562e-05 3 1  ON 74
ci_076                 2.379209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.6021
    reference variance = 0.43943
====================================================
  Execution time = 2.5703e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4758e-01
  Total weights = 1.9552e+06
  Execution time = 3.6131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437853670604
                                         uncertainty =       0.002178930720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437853670604
                                         uncertainty =       0.002178930720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467892195
  error estimate for blocks of size 2^( 2) =       0.000492385292
  error estimate for blocks of size 2^( 3) =       0.000514823908
  error estimate for blocks of size 2^( 4) =       0.000530507536
  error estimate for blocks of size 2^( 5) =       0.000540146803
  error estimate for blocks of size 2^( 6) =       0.000544434585
  error estimate for blocks of size 2^( 7) =       0.000547246785

      target function =      -0.747288296707
              le_mean =     -22.661047419048
             les_mean =     513.970654581098
             stat err =       0.000540583927
             autocorr =       1.334856730034
   target nu stat err =       0.000540583927
   target dn stat err =       0.002941212067
      target stat err =       0.002494176796
              std dev =       0.661699488517
             le_variance =       0.437846213104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437853670572
                                         uncertainty =       0.002178930716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437853670572
                                         uncertainty =       0.002178930716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467892195
  error estimate for blocks of size 2^( 2) =       0.000492385292
  error estimate for blocks of size 2^( 3) =       0.000514823908
  error estimate for blocks of size 2^( 4) =       0.000530507536
  error estimate for blocks of size 2^( 5) =       0.000540146803
  error estimate for blocks of size 2^( 6) =       0.000544434585
  error estimate for blocks of size 2^( 7) =       0.000547246785

      target function =      -0.747288296987
              le_mean =     -22.661047419048
             les_mean =     513.970654580727
             stat err =       0.000540583927
             autocorr =       1.334856730150
   target nu stat err =       0.000540583927
   target dn stat err =       0.002941212038
      target stat err =       0.002494176775
              std dev =       0.661699488493
             le_variance =       0.437846213072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437853670588
                                         uncertainty =       0.002178930718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437853670588
                                         uncertainty =       0.002178930718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467892195
  error estimate for blocks of size 2^( 2) =       0.000492385292
  error estimate for blocks of size 2^( 3) =       0.000514823908
  error estimate for blocks of size 2^( 4) =       0.000530507536
  error estimate for blocks of size 2^( 5) =       0.000540146803
  error estimate for blocks of size 2^( 6) =       0.000544434585
  error estimate for blocks of size 2^( 7) =       0.000547246785

      target function =      -0.747288296847
              le_mean =     -22.661047419048
             les_mean =     513.970654580913
             stat err =       0.000540583927
             autocorr =       1.334856730087
   target nu stat err =       0.000540583927
   target dn stat err =       0.002941212053
      target stat err =       0.002494176786
              std dev =       0.661699488505
             le_variance =       0.437846213088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437853670602
                                         uncertainty =       0.002178930720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437853670602
                                         uncertainty =       0.002178930720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467892195
  error estimate for blocks of size 2^( 2) =       0.000492385292
  error estimate for blocks of size 2^( 3) =       0.000514823908
  error estimate for blocks of size 2^( 4) =       0.000530507536
  error estimate for blocks of size 2^( 5) =       0.000540146803
  error estimate for blocks of size 2^( 6) =       0.000544434585
  error estimate for blocks of size 2^( 7) =       0.000547246785

      target function =      -0.747288296725
              le_mean =     -22.661047419048
             les_mean =     513.970654581075
             stat err =       0.000540583927
             autocorr =       1.334856730050
   target nu stat err =       0.000540583927
   target dn stat err =       0.002941212065
      target stat err =       0.002494176795
              std dev =       0.661699488516
             le_variance =       0.437846213102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747288296707        initial
     9.3132e+05     9.3132e+06             1.8733e-10        -0.747288296987  <--
     3.7253e+06     3.7253e+07             4.6832e-11        -0.747288296847
     1.4901e+07     1.4901e+08             1.1708e-11        -0.747288296725

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 4.3779e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115790e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536954e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764570e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4593e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.7094
    reference variance = 0.454927
====================================================
  Execution time = 2.6104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5112e-01
  Total weights = 1.955122514e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437199839145
                                         uncertainty =       0.001708062357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437199839145
                                         uncertainty =       0.001708062357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467576840
  error estimate for blocks of size 2^( 2) =       0.000491868017
  error estimate for blocks of size 2^( 3) =       0.000514104394
  error estimate for blocks of size 2^( 4) =       0.000529833003
  error estimate for blocks of size 2^( 5) =       0.000539258852
  error estimate for blocks of size 2^( 6) =       0.000544180256
  error estimate for blocks of size 2^( 7) =       0.000544579247

      target function =      -0.744377094621
              le_mean =     -22.661478389673
             les_mean =     513.993727232840
             stat err =       0.000539462840
             autocorr =       1.331119620326
   target nu stat err =       0.000539462840
   target dn stat err =       0.004689075194
      target stat err =       0.003879297413
              std dev =       0.661253508680
             le_variance =       0.437256202742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266147838967e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744396351839       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744396352009       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744396352033       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744396352036       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744396351999       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744396351763       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744396352051       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744396351693       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744396352139       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744396351249       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744396351649       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744396351748       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+05 is 1.730943e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744396351839       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744396351882       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744396351888       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744396351781       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744396351758       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744396352336       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744396351889       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744396351889       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744396351889       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744396351075       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744396355001       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744396353721       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+05 is 4.327355e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744396351839       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744396351850       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744396351851       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744396350530       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744396351841       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744396352486       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744396347866       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744396349107       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744396347898       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744396357060       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744396352523       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744396338182       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+06 is 1.081840e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.369440 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0823e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642133e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499180e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823199e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953531e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321886e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877474e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115851e-06 3 1  ON 68
ci_070                 1.932029e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764573e-05 3 1  ON 74
ci_076                 2.379211e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.6173
    reference variance = 0.615595
====================================================
  Execution time = 2.5433e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4790e-01
  Total weights = 1.9553e+06
  Execution time = 3.6344e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437053326738
                                         uncertainty =       0.001970649087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437053326738
                                         uncertainty =       0.001970649087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467506699
  error estimate for blocks of size 2^( 2) =       0.000491448560
  error estimate for blocks of size 2^( 3) =       0.000513959601
  error estimate for blocks of size 2^( 4) =       0.000530263603
  error estimate for blocks of size 2^( 5) =       0.000538147401
  error estimate for blocks of size 2^( 6) =       0.000544099400
  error estimate for blocks of size 2^( 7) =       0.000544685416

      target function =      -0.747029509243
              le_mean =     -22.661131370569
             les_mean =     513.974775028949
             stat err =       0.000539298955
             autocorr =       1.330710183060
   target nu stat err =       0.000539298955
   target dn stat err =       0.002979405750
      target stat err =       0.002523008802
              std dev =       0.661154314765
             le_variance =       0.437125027932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437053326593
                                         uncertainty =       0.001970649083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437053326593
                                         uncertainty =       0.001970649083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467506699
  error estimate for blocks of size 2^( 2) =       0.000491448560
  error estimate for blocks of size 2^( 3) =       0.000513959601
  error estimate for blocks of size 2^( 4) =       0.000530263603
  error estimate for blocks of size 2^( 5) =       0.000538147401
  error estimate for blocks of size 2^( 6) =       0.000544099400
  error estimate for blocks of size 2^( 7) =       0.000544685416

      target function =      -0.747029504027
              le_mean =     -22.661131370574
             les_mean =     513.974775035505
             stat err =       0.000539298955
             autocorr =       1.330710183423
   target nu stat err =       0.000539298955
   target dn stat err =       0.002979406680
      target stat err =       0.002523009512
              std dev =       0.661154314656
             le_variance =       0.437125027788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437053326666
                                         uncertainty =       0.001970649085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437053326666
                                         uncertainty =       0.001970649085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467506699
  error estimate for blocks of size 2^( 2) =       0.000491448560
  error estimate for blocks of size 2^( 3) =       0.000513959601
  error estimate for blocks of size 2^( 4) =       0.000530263603
  error estimate for blocks of size 2^( 5) =       0.000538147401
  error estimate for blocks of size 2^( 6) =       0.000544099400
  error estimate for blocks of size 2^( 7) =       0.000544685416

      target function =      -0.747029506635
              le_mean =     -22.661131370571
             les_mean =     513.974775032226
             stat err =       0.000539298955
             autocorr =       1.330710183246
   target nu stat err =       0.000539298955
   target dn stat err =       0.002979406215
      target stat err =       0.002523009157
              std dev =       0.661154314711
             le_variance =       0.437125027860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437053326729
                                         uncertainty =       0.001970649086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437053326729
                                         uncertainty =       0.001970649086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467506699
  error estimate for blocks of size 2^( 2) =       0.000491448560
  error estimate for blocks of size 2^( 3) =       0.000513959601
  error estimate for blocks of size 2^( 4) =       0.000530263603
  error estimate for blocks of size 2^( 5) =       0.000538147401
  error estimate for blocks of size 2^( 6) =       0.000544099400
  error estimate for blocks of size 2^( 7) =       0.000544685416

      target function =      -0.747029508917
              le_mean =     -22.661131370569
             les_mean =     513.974775029358
             stat err =       0.000539298955
             autocorr =       1.330710183081
   target nu stat err =       0.000539298955
   target dn stat err =       0.002979405808
      target stat err =       0.002523008847
              std dev =       0.661154314758
             le_variance =       0.437125027923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747029509243        initial  <--
     2.3283e+05     2.3283e+06             1.7309e-09        -0.747029504027
     9.3132e+05     9.3132e+06             4.3274e-10        -0.747029506635
     3.7253e+06     3.7253e+07             1.0818e-10        -0.747029508917

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5500
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298665e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115790e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536954e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764570e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4379e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.6152
    reference variance = 0.369566
====================================================
  Execution time = 2.6086e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5759e-01
  Total weights = 1.955523461e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447671793659
                                         uncertainty =       0.004027443051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447671793659
                                         uncertainty =       0.004027443051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473135521
  error estimate for blocks of size 2^( 2) =       0.000496746260
  error estimate for blocks of size 2^( 3) =       0.000518468883
  error estimate for blocks of size 2^( 4) =       0.000534575411
  error estimate for blocks of size 2^( 5) =       0.000544115210
  error estimate for blocks of size 2^( 6) =       0.000550276129
  error estimate for blocks of size 2^( 7) =       0.000551489548

      target function =      -0.739126571897
              le_mean =     -22.661291961301
             les_mean =     513.991745068564
             stat err =       0.000545114074
             autocorr =       1.327405711561
   target nu stat err =       0.000545114074
   target dn stat err =       0.004677009932
      target stat err =       0.003815695045
              std dev =       0.669114670838
             le_variance =       0.447714442730


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266129196130e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739145458639       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739145458659       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739145458661       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739145459022       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739145459398       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739145458246       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739145460392       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739145459438       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739145453242       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+06 is 1.206407e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739145458639       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739145458644       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739145458645       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739145458645       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739145458645       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739145443210       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739145466822       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739145475230       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739145451159       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+06 is 3.016017e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739145458639       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739145458640       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739145458640       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739145458640       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739145458640       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739145459677       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739145458640       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739145441672       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739145458640       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+07 is 7.540055e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.372578 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0871e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115782e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536954e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764572e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.6601
    reference variance = 0.317714
====================================================
  Execution time = 2.7418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4864e-01
  Total weights = 1.9553e+06
  Execution time = 3.6245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438364581805
                                         uncertainty =       0.002008151070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438364581805
                                         uncertainty =       0.002008151070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468145137
  error estimate for blocks of size 2^( 2) =       0.000492471016
  error estimate for blocks of size 2^( 3) =       0.000514688165
  error estimate for blocks of size 2^( 4) =       0.000530807185
  error estimate for blocks of size 2^( 5) =       0.000540253241
  error estimate for blocks of size 2^( 6) =       0.000546613113
  error estimate for blocks of size 2^( 7) =       0.000547492646

      target function =      -0.746420187511
              le_mean =     -22.660767124114
             les_mean =     513.959002075213
             stat err =       0.000541291546
             autocorr =       1.336907796232
   target nu stat err =       0.000541291546
   target dn stat err =       0.002921865420
      target stat err =       0.002472284968
              std dev =       0.662057202305
             le_variance =       0.438319739123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438364581792
                                         uncertainty =       0.002008151071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438364581792
                                         uncertainty =       0.002008151071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468145137
  error estimate for blocks of size 2^( 2) =       0.000492471016
  error estimate for blocks of size 2^( 3) =       0.000514688165
  error estimate for blocks of size 2^( 4) =       0.000530807185
  error estimate for blocks of size 2^( 5) =       0.000540253241
  error estimate for blocks of size 2^( 6) =       0.000546613113
  error estimate for blocks of size 2^( 7) =       0.000547492646

      target function =      -0.746420187718
              le_mean =     -22.660767124114
             les_mean =     513.959002074960
             stat err =       0.000541291546
             autocorr =       1.336907796278
   target nu stat err =       0.000541291546
   target dn stat err =       0.002921865412
      target stat err =       0.002472284964
              std dev =       0.662057202295
             le_variance =       0.438319739111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438364581799
                                         uncertainty =       0.002008151070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438364581799
                                         uncertainty =       0.002008151070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468145137
  error estimate for blocks of size 2^( 2) =       0.000492471016
  error estimate for blocks of size 2^( 3) =       0.000514688165
  error estimate for blocks of size 2^( 4) =       0.000530807185
  error estimate for blocks of size 2^( 5) =       0.000540253241
  error estimate for blocks of size 2^( 6) =       0.000546613113
  error estimate for blocks of size 2^( 7) =       0.000547492646

      target function =      -0.746420187614
              le_mean =     -22.660767124114
             les_mean =     513.959002075087
             stat err =       0.000541291546
             autocorr =       1.336907796246
   target nu stat err =       0.000541291546
   target dn stat err =       0.002921865416
      target stat err =       0.002472284966
              std dev =       0.662057202300
             le_variance =       0.438319739117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438364581805
                                         uncertainty =       0.002008151070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438364581805
                                         uncertainty =       0.002008151070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468145137
  error estimate for blocks of size 2^( 2) =       0.000492471016
  error estimate for blocks of size 2^( 3) =       0.000514688165
  error estimate for blocks of size 2^( 4) =       0.000530807185
  error estimate for blocks of size 2^( 5) =       0.000540253241
  error estimate for blocks of size 2^( 6) =       0.000546613113
  error estimate for blocks of size 2^( 7) =       0.000547492646

      target function =      -0.746420187524
              le_mean =     -22.660767124114
             les_mean =     513.959002075197
             stat err =       0.000541291546
             autocorr =       1.336907796232
   target nu stat err =       0.000541291546
   target dn stat err =       0.002921865419
      target stat err =       0.002472284968
              std dev =       0.662057202304
             le_variance =       0.438319739123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746420187511        initial
     2.3283e+06     2.3283e+07             1.2064e-10        -0.746420187718  <--
     9.3132e+06     9.3132e+07             3.0160e-11        -0.746420187614
     3.7253e+07     3.7253e+08             7.5401e-12        -0.746420187524

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 4.5520e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6400e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7646
    reference variance = 0.505469
====================================================
  Execution time = 2.6000e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4579e-01
  Total weights = 1.954998633e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436376916284
                                         uncertainty =       0.001835349061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436376916284
                                         uncertainty =       0.001835349061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467071749
  error estimate for blocks of size 2^( 2) =       0.000491274636
  error estimate for blocks of size 2^( 3) =       0.000513478321
  error estimate for blocks of size 2^( 4) =       0.000529497329
  error estimate for blocks of size 2^( 5) =       0.000537811041
  error estimate for blocks of size 2^( 6) =       0.000541823913
  error estimate for blocks of size 2^( 7) =       0.000545678091

      target function =      -0.748777304642
              le_mean =     -22.661364783473
             les_mean =     513.983241964421
             stat err =       0.000538702593
             autocorr =       1.330242847287
   target nu stat err =       0.000538702593
   target dn stat err =       0.002658922204
      target stat err =       0.002278384485
              std dev =       0.660539202658
             le_variance =       0.436312038248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266136478347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748783264818       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748783264842       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748783264847       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748783264847       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748783265130       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748783264736       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748783264418       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748783265343       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748783264534       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748783267552       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748783266525       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+05 is 3.829433e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748783264818       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748783264824       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748783264825       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748783264825       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748783265390       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748783276829       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748783271663       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748783260387       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748783267702       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748783269337       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748783265459       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+06 is 9.573581e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748783264818       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748783264819       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748783264819       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748783269359       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748783263106       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748783273764       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748783267205       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748783264659       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748783257543       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748783265574       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748783260377       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+06 is 2.393390e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0770e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499180e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115751e-06 3 1  ON 68
ci_070                 1.932029e-04 3 1  ON 69
ci_071                -1.536954e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764576e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.6802
    reference variance = 0.497116
====================================================
  Execution time = 2.5524e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6025e-01
  Total weights = 1.9549e+06
  Execution time = 3.6336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447396457509
                                         uncertainty =       0.004706340224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447396457509
                                         uncertainty =       0.004706340224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473013483
  error estimate for blocks of size 2^( 2) =       0.000496952665
  error estimate for blocks of size 2^( 3) =       0.000519340273
  error estimate for blocks of size 2^( 4) =       0.000535154915
  error estimate for blocks of size 2^( 5) =       0.000545736780
  error estimate for blocks of size 2^( 6) =       0.000550008536
  error estimate for blocks of size 2^( 7) =       0.000553473807

      target function =      -0.736984218145
              le_mean =     -22.662101161520
             les_mean =     514.031078132400
             stat err =       0.000546093509
             autocorr =       1.332867530742
   target nu stat err =       0.000546093509
   target dn stat err =       0.005340344573
      target stat err =       0.004324967757
              std dev =       0.668942083187
             le_variance =       0.447483510658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447396457377
                                         uncertainty =       0.004706340206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447396457377
                                         uncertainty =       0.004706340206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473013483
  error estimate for blocks of size 2^( 2) =       0.000496952665
  error estimate for blocks of size 2^( 3) =       0.000519340273
  error estimate for blocks of size 2^( 4) =       0.000535154915
  error estimate for blocks of size 2^( 5) =       0.000545736780
  error estimate for blocks of size 2^( 6) =       0.000550008536
  error estimate for blocks of size 2^( 7) =       0.000553473807

      target function =      -0.736984181359
              le_mean =     -22.662101161523
             les_mean =     514.031078178428
             stat err =       0.000546093509
             autocorr =       1.332867530911
   target nu stat err =       0.000546093509
   target dn stat err =       0.005340345283
      target stat err =       0.004324967893
              std dev =       0.668942083089
             le_variance =       0.447483510528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447396457443
                                         uncertainty =       0.004706340215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447396457443
                                         uncertainty =       0.004706340215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473013483
  error estimate for blocks of size 2^( 2) =       0.000496952665
  error estimate for blocks of size 2^( 3) =       0.000519340273
  error estimate for blocks of size 2^( 4) =       0.000535154915
  error estimate for blocks of size 2^( 5) =       0.000545736780
  error estimate for blocks of size 2^( 6) =       0.000550008536
  error estimate for blocks of size 2^( 7) =       0.000553473807

      target function =      -0.736984199757
              le_mean =     -22.662101161521
             les_mean =     514.031078155408
             stat err =       0.000546093509
             autocorr =       1.332867530821
   target nu stat err =       0.000546093509
   target dn stat err =       0.005340344928
      target stat err =       0.004324967825
              std dev =       0.668942083138
             le_variance =       0.447483510593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447396457500
                                         uncertainty =       0.004706340223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447396457500
                                         uncertainty =       0.004706340223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473013483
  error estimate for blocks of size 2^( 2) =       0.000496952665
  error estimate for blocks of size 2^( 3) =       0.000519340273
  error estimate for blocks of size 2^( 4) =       0.000535154915
  error estimate for blocks of size 2^( 5) =       0.000545736780
  error estimate for blocks of size 2^( 6) =       0.000550008536
  error estimate for blocks of size 2^( 7) =       0.000553473807

      target function =      -0.736984215847
              le_mean =     -22.662101161520
             les_mean =     514.031078135276
             stat err =       0.000546093509
             autocorr =       1.332867530764
   target nu stat err =       0.000546093509
   target dn stat err =       0.005340344618
      target stat err =       0.004324967765
              std dev =       0.668942083181
             le_variance =       0.447483510650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736984218145        initial  <--
     5.8208e+05     5.8208e+06             3.8294e-10        -0.736984181359
     2.3283e+06     2.3283e+07             9.5736e-11        -0.736984199757
     9.3132e+06     9.3132e+07             2.3934e-11        -0.736984215847

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6323
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.6854
    reference variance = 0.263939
====================================================
  Execution time = 2.6022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4885e-01
  Total weights = 1.955351704e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438802279360
                                         uncertainty =       0.002043035960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438802279360
                                         uncertainty =       0.002043035960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468420651
  error estimate for blocks of size 2^( 2) =       0.000492130086
  error estimate for blocks of size 2^( 3) =       0.000514297903
  error estimate for blocks of size 2^( 4) =       0.000529900862
  error estimate for blocks of size 2^( 5) =       0.000539118719
  error estimate for blocks of size 2^( 6) =       0.000545037404
  error estimate for blocks of size 2^( 7) =       0.000549914721

      target function =      -0.746259475165
              le_mean =     -22.661561736529
             les_mean =     513.995226580455
             stat err =       0.000540992927
             autocorr =       1.333862636041
   target nu stat err =       0.000540992927
   target dn stat err =       0.002525944072
      target stat err =       0.002159682744
              std dev =       0.662446837283
             le_variance =       0.438835812227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266156173653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746264768010       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746264768013       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746264768013       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746264768092       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746264768013       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746264769455       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746264761504       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746264767644       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746264761404       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746264757021       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746264768014       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+06 is 3.732851e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746264768010       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746264768011       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746264768011       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746264768011       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746264760355       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746264766717       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746264773794       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746264755623       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746264793741       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746264686372       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746264752559       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+07 is 9.332060e-12

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746264768010       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746264768010       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746264768010       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746264768010       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746264768011       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746264814969       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746264685471       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746264826819       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746264802615       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746264731355       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746264889817       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+07 is 2.332878e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0767e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115757e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.7244
    reference variance = 0.460272
====================================================
  Execution time = 2.5513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5306e-01
  Total weights = 1.9551e+06
  Execution time = 3.6454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443873336652
                                         uncertainty =       0.003986455141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443873336652
                                         uncertainty =       0.003986455141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471158588
  error estimate for blocks of size 2^( 2) =       0.000495039518
  error estimate for blocks of size 2^( 3) =       0.000516602392
  error estimate for blocks of size 2^( 4) =       0.000531694067
  error estimate for blocks of size 2^( 5) =       0.000540665923
  error estimate for blocks of size 2^( 6) =       0.000545476949
  error estimate for blocks of size 2^( 7) =       0.000548451164

      target function =      -0.742798859592
              le_mean =     -22.660856167039
             les_mean =     513.967457440982
             stat err =       0.000541572026
             autocorr =       1.321229386131
   target nu stat err =       0.000541572026
   target dn stat err =       0.004432465922
      target stat err =       0.003653753548
              std dev =       0.666318864535
             le_variance =       0.443980829235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443873336696
                                         uncertainty =       0.003986455180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443873336696
                                         uncertainty =       0.003986455180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471158588
  error estimate for blocks of size 2^( 2) =       0.000495039518
  error estimate for blocks of size 2^( 3) =       0.000516602392
  error estimate for blocks of size 2^( 4) =       0.000531694067
  error estimate for blocks of size 2^( 5) =       0.000540665923
  error estimate for blocks of size 2^( 6) =       0.000545476949
  error estimate for blocks of size 2^( 7) =       0.000548451164

      target function =      -0.742798859508
              le_mean =     -22.660856167040
             les_mean =     513.967457441103
             stat err =       0.000541572026
             autocorr =       1.321229386098
   target nu stat err =       0.000541572026
   target dn stat err =       0.004432465966
      target stat err =       0.003653753583
              std dev =       0.666318864568
             le_variance =       0.443980829280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443873336674
                                         uncertainty =       0.003986455160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443873336674
                                         uncertainty =       0.003986455160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471158588
  error estimate for blocks of size 2^( 2) =       0.000495039518
  error estimate for blocks of size 2^( 3) =       0.000516602392
  error estimate for blocks of size 2^( 4) =       0.000531694067
  error estimate for blocks of size 2^( 5) =       0.000540665923
  error estimate for blocks of size 2^( 6) =       0.000545476949
  error estimate for blocks of size 2^( 7) =       0.000548451164

      target function =      -0.742798859550
              le_mean =     -22.660856167040
             les_mean =     513.967457441043
             stat err =       0.000541572026
             autocorr =       1.321229386111
   target nu stat err =       0.000541572026
   target dn stat err =       0.004432465944
      target stat err =       0.003653753565
              std dev =       0.666318864552
             le_variance =       0.443980829258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443873336655
                                         uncertainty =       0.003986455143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443873336655
                                         uncertainty =       0.003986455143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471158588
  error estimate for blocks of size 2^( 2) =       0.000495039518
  error estimate for blocks of size 2^( 3) =       0.000516602392
  error estimate for blocks of size 2^( 4) =       0.000531694067
  error estimate for blocks of size 2^( 5) =       0.000540665923
  error estimate for blocks of size 2^( 6) =       0.000545476949
  error estimate for blocks of size 2^( 7) =       0.000548451164

      target function =      -0.742798859587
              le_mean =     -22.660856167039
             les_mean =     513.967457440990
             stat err =       0.000541572026
             autocorr =       1.321229386128
   target nu stat err =       0.000541572026
   target dn stat err =       0.004432465925
      target stat err =       0.003653753550
              std dev =       0.666318864537
             le_variance =       0.443980829238


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742798859592        initial  <--
     5.8208e+06     5.8208e+07             3.7329e-11        -0.742798859508
     2.3283e+07     2.3283e+08             9.3321e-12        -0.742798859550
     9.3132e+07     9.3132e+08             2.3329e-12        -0.742798859587

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6760
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.6681
    reference variance = 0.463489
====================================================
  Execution time = 2.6211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5459e-01
  Total weights = 1.955354719e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440791520849
                                         uncertainty =       0.002113132344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440791520849
                                         uncertainty =       0.002113132344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469462193
  error estimate for blocks of size 2^( 2) =       0.000493196148
  error estimate for blocks of size 2^( 3) =       0.000514614508
  error estimate for blocks of size 2^( 4) =       0.000530826082
  error estimate for blocks of size 2^( 5) =       0.000541689171
  error estimate for blocks of size 2^( 6) =       0.000544691788
  error estimate for blocks of size 2^( 7) =       0.000548960485

      target function =      -0.741562051077
              le_mean =     -22.661914836187
             les_mean =     514.016972051492
             stat err =       0.000541541881
             autocorr =       1.330646977495
   target nu stat err =       0.000541541881
   target dn stat err =       0.004222037679
      target stat err =       0.003478962507
              std dev =       0.663919801042
             le_variance =       0.440789502215


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266191483619e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741577510742       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741577510743       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741577510743       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741577510743       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741577510736       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741577454666       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741577520858       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741577556341       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741577540954       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741577503854       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741577411503       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741577494715       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+07 is 6.490404e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741577510742       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741577510742       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741577510742       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741577510742       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741577510742       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741577510209       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741577510102       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741577136372       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741577496404       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741578010154       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741577597954       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741577469763       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+08 is 1.622642e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741577510742       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741577510742       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741577510742       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741577497708       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741577352272       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741578485374       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741577509472       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741576466218       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741574847804       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741576370607       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741578435891       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741579062695       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+08 is 4.056317e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0944e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.6841
    reference variance = 0.322604
====================================================
  Execution time = 2.5539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4924e-01
  Total weights = 1.9551e+06
  Execution time = 3.6217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670301951
                                         uncertainty =       0.001908230595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670301951
                                         uncertainty =       0.001908230595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468943065
  error estimate for blocks of size 2^( 2) =       0.000492806432
  error estimate for blocks of size 2^( 3) =       0.000514723912
  error estimate for blocks of size 2^( 4) =       0.000530616735
  error estimate for blocks of size 2^( 5) =       0.000539757627
  error estimate for blocks of size 2^( 6) =       0.000544779572
  error estimate for blocks of size 2^( 7) =       0.000546236201

      target function =      -0.745930803208
              le_mean =     -22.661253989614
             les_mean =     513.981674141494
             stat err =       0.000540347534
             autocorr =       1.327718821867
   target nu stat err =       0.000540347534
   target dn stat err =       0.002530963164
      target stat err =       0.002160637717
              std dev =       0.663185642573
             le_variance =       0.439815196515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670301950
                                         uncertainty =       0.001908230595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670301950
                                         uncertainty =       0.001908230595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468943065
  error estimate for blocks of size 2^( 2) =       0.000492806432
  error estimate for blocks of size 2^( 3) =       0.000514723912
  error estimate for blocks of size 2^( 4) =       0.000530616735
  error estimate for blocks of size 2^( 5) =       0.000539757627
  error estimate for blocks of size 2^( 6) =       0.000544779572
  error estimate for blocks of size 2^( 7) =       0.000546236201

      target function =      -0.745930803210
              le_mean =     -22.661253989614
             les_mean =     513.981674141490
             stat err =       0.000540347534
             autocorr =       1.327718821867
   target nu stat err =       0.000540347534
   target dn stat err =       0.002530963164
      target stat err =       0.002160637717
              std dev =       0.663185642573
             le_variance =       0.439815196515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670301951
                                         uncertainty =       0.001908230595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670301951
                                         uncertainty =       0.001908230595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468943065
  error estimate for blocks of size 2^( 2) =       0.000492806432
  error estimate for blocks of size 2^( 3) =       0.000514723912
  error estimate for blocks of size 2^( 4) =       0.000530616735
  error estimate for blocks of size 2^( 5) =       0.000539757627
  error estimate for blocks of size 2^( 6) =       0.000544779572
  error estimate for blocks of size 2^( 7) =       0.000546236201

      target function =      -0.745930803209
              le_mean =     -22.661253989614
             les_mean =     513.981674141492
             stat err =       0.000540347534
             autocorr =       1.327718821854
   target nu stat err =       0.000540347534
   target dn stat err =       0.002530963164
      target stat err =       0.002160637717
              std dev =       0.663185642573
             le_variance =       0.439815196515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670301951
                                         uncertainty =       0.001908230595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670301951
                                         uncertainty =       0.001908230595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468943065
  error estimate for blocks of size 2^( 2) =       0.000492806432
  error estimate for blocks of size 2^( 3) =       0.000514723912
  error estimate for blocks of size 2^( 4) =       0.000530616735
  error estimate for blocks of size 2^( 5) =       0.000539757627
  error estimate for blocks of size 2^( 6) =       0.000544779572
  error estimate for blocks of size 2^( 7) =       0.000546236201

      target function =      -0.745930803208
              le_mean =     -22.661253989614
             les_mean =     513.981674141494
             stat err =       0.000540347534
             autocorr =       1.327718821862
   target nu stat err =       0.000540347534
   target dn stat err =       0.002530963164
      target stat err =       0.002160637717
              std dev =       0.663185642573
             le_variance =       0.439815196515


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745930803208        initial
     5.8208e+07     5.8208e+08             6.4904e-12        -0.745930803210  <--
     2.3283e+08     2.3283e+09             1.6226e-12        -0.745930803209
     9.3132e+08     9.3132e+09             4.0563e-13        -0.745930803208

*****************************************************************************
Applying the update for shift_i =   5.8208e+07     and shift_s =   5.8208e+08
*****************************************************************************

  Execution time = 4.3590e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4541e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.6434
    reference variance = 0.388721
====================================================
  Execution time = 2.6392e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5284e-01
  Total weights = 1.954961595e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442734474758
                                         uncertainty =       0.003056094746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442734474758
                                         uncertainty =       0.003056094746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470421973
  error estimate for blocks of size 2^( 2) =       0.000494352298
  error estimate for blocks of size 2^( 3) =       0.000516673505
  error estimate for blocks of size 2^( 4) =       0.000533068962
  error estimate for blocks of size 2^( 5) =       0.000542817687
  error estimate for blocks of size 2^( 6) =       0.000550134476
  error estimate for blocks of size 2^( 7) =       0.000553776785

      target function =      -0.742982573346
              le_mean =     -22.661570326311
             les_mean =     513.999609809900
             stat err =       0.000544949478
             autocorr =       1.341952930984
   target nu stat err =       0.000544949478
   target dn stat err =       0.004036975306
      target stat err =       0.003342531166
              std dev =       0.665277134073
             le_variance =       0.442593665121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266157032631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742996887695       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742996887696       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742996887697       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742996887697       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742996887710       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742996893196       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742996917456       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742996908329       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742996887262       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742996880987       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742996903202       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+07 is 1.976173e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742996887695       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742996887695       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742996887695       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742996887695       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742996887679       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742996901112       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742996998780       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742996810367       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742996796227       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742996833298       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742996806905       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+07 is 4.940398e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742996887695       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742996887695       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742996887695       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742997060404       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742996887069       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742996868172       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742996391306       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742996905001       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742996882488       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742996779357       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742997681061       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+08 is 1.235085e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1115e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.5831
    reference variance = 0.327644
====================================================
  Execution time = 2.7307e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5293e-01
  Total weights = 1.9553e+06
  Execution time = 3.6458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443036283021
                                         uncertainty =       0.003813610640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443036283021
                                         uncertainty =       0.003813610640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470622096
  error estimate for blocks of size 2^( 2) =       0.000494617617
  error estimate for blocks of size 2^( 3) =       0.000517132834
  error estimate for blocks of size 2^( 4) =       0.000533828176
  error estimate for blocks of size 2^( 5) =       0.000543892490
  error estimate for blocks of size 2^( 6) =       0.000549763667
  error estimate for blocks of size 2^( 7) =       0.000547983430

      target function =      -0.742908613550
              le_mean =     -22.662070378353
             les_mean =     514.022366115595
             stat err =       0.000543866941
             autocorr =       1.335490166563
   target nu stat err =       0.000543866941
   target dn stat err =       0.004408233638
      target stat err =       0.003642294346
              std dev =       0.665560150803
             le_variance =       0.442970314336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443036283016
                                         uncertainty =       0.003813610640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443036283016
                                         uncertainty =       0.003813610640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470622096
  error estimate for blocks of size 2^( 2) =       0.000494617617
  error estimate for blocks of size 2^( 3) =       0.000517132834
  error estimate for blocks of size 2^( 4) =       0.000533828176
  error estimate for blocks of size 2^( 5) =       0.000543892490
  error estimate for blocks of size 2^( 6) =       0.000549763667
  error estimate for blocks of size 2^( 7) =       0.000547983430

      target function =      -0.742908613549
              le_mean =     -22.662070378354
             les_mean =     514.022366115600
             stat err =       0.000543866941
             autocorr =       1.335490166557
   target nu stat err =       0.000543866941
   target dn stat err =       0.004408233635
      target stat err =       0.003642294344
              std dev =       0.665560150799
             le_variance =       0.442970314331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443036283019
                                         uncertainty =       0.003813610640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443036283019
                                         uncertainty =       0.003813610640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470622096
  error estimate for blocks of size 2^( 2) =       0.000494617617
  error estimate for blocks of size 2^( 3) =       0.000517132834
  error estimate for blocks of size 2^( 4) =       0.000533828176
  error estimate for blocks of size 2^( 5) =       0.000543892490
  error estimate for blocks of size 2^( 6) =       0.000549763667
  error estimate for blocks of size 2^( 7) =       0.000547983430

      target function =      -0.742908613550
              le_mean =     -22.662070378353
             les_mean =     514.022366115598
             stat err =       0.000543866941
             autocorr =       1.335490166553
   target nu stat err =       0.000543866941
   target dn stat err =       0.004408233636
      target stat err =       0.003642294345
              std dev =       0.665560150801
             le_variance =       0.442970314334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443036283021
                                         uncertainty =       0.003813610640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443036283021
                                         uncertainty =       0.003813610640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470622096
  error estimate for blocks of size 2^( 2) =       0.000494617617
  error estimate for blocks of size 2^( 3) =       0.000517132834
  error estimate for blocks of size 2^( 4) =       0.000533828176
  error estimate for blocks of size 2^( 5) =       0.000543892490
  error estimate for blocks of size 2^( 6) =       0.000549763667
  error estimate for blocks of size 2^( 7) =       0.000547983430

      target function =      -0.742908613550
              le_mean =     -22.662070378353
             les_mean =     514.022366115596
             stat err =       0.000543866941
             autocorr =       1.335490166560
   target nu stat err =       0.000543866941
   target dn stat err =       0.004408233637
      target stat err =       0.003642294346
              std dev =       0.665560150803
             le_variance =       0.442970314336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742908613550        initial  <--
     1.4552e+07     1.4552e+08             1.9762e-11        -0.742908613549
     5.8208e+07     5.8208e+08             4.9404e-12        -0.742908613550
     2.3283e+08     2.3283e+09             1.2351e-12        -0.742908613550

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4743
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6595e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.5689
    reference variance = 0.338294
====================================================
  Execution time = 2.6232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4548e-01
  Total weights = 1.955393404e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438003487711
                                         uncertainty =       0.001967636623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438003487711
                                         uncertainty =       0.001967636623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467951410
  error estimate for blocks of size 2^( 2) =       0.000492085454
  error estimate for blocks of size 2^( 3) =       0.000514509918
  error estimate for blocks of size 2^( 4) =       0.000530731847
  error estimate for blocks of size 2^( 5) =       0.000539475185
  error estimate for blocks of size 2^( 6) =       0.000546606762
  error estimate for blocks of size 2^( 7) =       0.000547123434

      target function =      -0.749033043306
              le_mean =     -22.661165500219
             les_mean =     513.973897703126
             stat err =       0.000540984307
             autocorr =       1.336496464069
   target nu stat err =       0.000540984307
   target dn stat err =       0.002466644493
      target stat err =       0.002126745127
              std dev =       0.661783230341
             le_variance =       0.437957043960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266116550022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749038184989       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749038184990       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749038184990       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749038184990       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749038184992       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749038184927       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749037963639       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749038102650       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749038126267       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749038232274       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+08 is 1.398088e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749038184989       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749038184989       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749038184989       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749038184989       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749038580571       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749038185352       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749037827911       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749037011561       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749037938762       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749038335005       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+08 is 3.495041e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749038184989       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749038184989       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749038184989       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749038184989       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749038184990       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749038184991       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749039158607       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749036374440       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749027864509       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749039778528       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+09 is 8.737940e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0965e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.7062
    reference variance = 0.450977
====================================================
  Execution time = 2.5448e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4844e-01
  Total weights = 1.9551e+06
  Execution time = 3.6451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439889115060
                                         uncertainty =       0.002439227307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439889115060
                                         uncertainty =       0.002439227307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468996480
  error estimate for blocks of size 2^( 2) =       0.000493208722
  error estimate for blocks of size 2^( 3) =       0.000515554438
  error estimate for blocks of size 2^( 4) =       0.000531155002
  error estimate for blocks of size 2^( 5) =       0.000541093198
  error estimate for blocks of size 2^( 6) =       0.000546976356
  error estimate for blocks of size 2^( 7) =       0.000547025987

      target function =      -0.746577354776
              le_mean =     -22.660632597390
             les_mean =     513.952709517010
             stat err =       0.000541562636
             autocorr =       1.333393152887
   target nu stat err =       0.000541562636
   target dn stat err =       0.003205374819
      target stat err =       0.002699480019
              std dev =       0.663261182195
             le_variance =       0.439915395806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439889115060
                                         uncertainty =       0.002439227307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439889115060
                                         uncertainty =       0.002439227307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468996480
  error estimate for blocks of size 2^( 2) =       0.000493208722
  error estimate for blocks of size 2^( 3) =       0.000515554438
  error estimate for blocks of size 2^( 4) =       0.000531155002
  error estimate for blocks of size 2^( 5) =       0.000541093198
  error estimate for blocks of size 2^( 6) =       0.000546976356
  error estimate for blocks of size 2^( 7) =       0.000547025987

      target function =      -0.746577354777
              le_mean =     -22.660632597390
             les_mean =     513.952709517010
             stat err =       0.000541562636
             autocorr =       1.333393152893
   target nu stat err =       0.000541562636
   target dn stat err =       0.003205374819
      target stat err =       0.002699480019
              std dev =       0.663261182195
             le_variance =       0.439915395806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439889115060
                                         uncertainty =       0.002439227307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439889115060
                                         uncertainty =       0.002439227307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468996480
  error estimate for blocks of size 2^( 2) =       0.000493208722
  error estimate for blocks of size 2^( 3) =       0.000515554438
  error estimate for blocks of size 2^( 4) =       0.000531155002
  error estimate for blocks of size 2^( 5) =       0.000541093198
  error estimate for blocks of size 2^( 6) =       0.000546976356
  error estimate for blocks of size 2^( 7) =       0.000547025987

      target function =      -0.746577354777
              le_mean =     -22.660632597390
             les_mean =     513.952709517010
             stat err =       0.000541562636
             autocorr =       1.333393152888
   target nu stat err =       0.000541562636
   target dn stat err =       0.003205374819
      target stat err =       0.002699480019
              std dev =       0.663261182195
             le_variance =       0.439915395806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439889115060
                                         uncertainty =       0.002439227307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439889115060
                                         uncertainty =       0.002439227307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468996480
  error estimate for blocks of size 2^( 2) =       0.000493208722
  error estimate for blocks of size 2^( 3) =       0.000515554438
  error estimate for blocks of size 2^( 4) =       0.000531155002
  error estimate for blocks of size 2^( 5) =       0.000541093198
  error estimate for blocks of size 2^( 6) =       0.000546976356
  error estimate for blocks of size 2^( 7) =       0.000547025987

      target function =      -0.746577354776
              le_mean =     -22.660632597390
             les_mean =     513.952709517010
             stat err =       0.000541562636
             autocorr =       1.333393152892
   target nu stat err =       0.000541562636
   target dn stat err =       0.003205374819
      target stat err =       0.002699480019
              std dev =       0.663261182194
             le_variance =       0.439915395806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746577354776        initial
     1.4552e+08     1.4552e+09             1.3981e-12        -0.746577354777  <--
     5.8208e+08     5.8208e+09             3.4950e-13        -0.746577354777
     2.3283e+09     2.3283e+10             8.7379e-14        -0.746577354776

*****************************************************************************
Applying the update for shift_i =   1.4552e+08     and shift_s =   1.4552e+09
*****************************************************************************

  Execution time = 4.3613e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.6682
    reference variance = 0.377309
====================================================
  Execution time = 2.6087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4764e-01
  Total weights = 1.955185641e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438306078317
                                         uncertainty =       0.001624275856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438306078317
                                         uncertainty =       0.001624275856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468148791
  error estimate for blocks of size 2^( 2) =       0.000492583883
  error estimate for blocks of size 2^( 3) =       0.000515401912
  error estimate for blocks of size 2^( 4) =       0.000531776564
  error estimate for blocks of size 2^( 5) =       0.000541029262
  error estimate for blocks of size 2^( 6) =       0.000545802511
  error estimate for blocks of size 2^( 7) =       0.000548757650

      target function =      -0.747250845858
              le_mean =     -22.661440708343
             les_mean =     513.988535202375
             stat err =       0.000541841497
             autocorr =       1.339604855209
   target nu stat err =       0.000541841497
   target dn stat err =       0.002398609068
      target stat err =       0.002064444708
              std dev =       0.662062369128
             le_variance =       0.438326580616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266144070834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747255514112       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747255514113       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747255514113       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747255514113       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747255516199       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747255519745       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747255521249       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747255565257       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747255475619       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747255574863       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747255544240       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+07 is 5.314094e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747255514112       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747255514113       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747255514113       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747255514113       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747255591224       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747255514085       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747255224148       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747255504601       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747255059284       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747255575621       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747255398165       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+08 is 1.328551e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747255514112       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747255514112       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747255514112       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747255210122       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747255514115       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747255512227       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747255501569       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747255654654       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747255422672       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747253682869       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747255779381       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+08 is 3.321245e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0807e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7624
    reference variance = 0.328251
====================================================
  Execution time = 2.5632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4362e-01
  Total weights = 1.9550e+06
  Execution time = 3.6320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434850971266
                                         uncertainty =       0.001832798061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434850971266
                                         uncertainty =       0.001832798061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466324260
  error estimate for blocks of size 2^( 2) =       0.000491004308
  error estimate for blocks of size 2^( 3) =       0.000513480774
  error estimate for blocks of size 2^( 4) =       0.000528851612
  error estimate for blocks of size 2^( 5) =       0.000538903840
  error estimate for blocks of size 2^( 6) =       0.000543551053
  error estimate for blocks of size 2^( 7) =       0.000544953678

      target function =      -0.750566602693
              le_mean =     -22.660903712988
             les_mean =     513.960177783573
             stat err =       0.000539065046
             autocorr =       1.336307247813
   target nu stat err =       0.000539065046
   target dn stat err =       0.002361560197
      target stat err =       0.002050047441
              std dev =       0.659482093371
             le_variance =       0.434916631478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434850971266
                                         uncertainty =       0.001832798061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434850971266
                                         uncertainty =       0.001832798061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466324260
  error estimate for blocks of size 2^( 2) =       0.000491004308
  error estimate for blocks of size 2^( 3) =       0.000513480774
  error estimate for blocks of size 2^( 4) =       0.000528851612
  error estimate for blocks of size 2^( 5) =       0.000538903840
  error estimate for blocks of size 2^( 6) =       0.000543551053
  error estimate for blocks of size 2^( 7) =       0.000544953678

      target function =      -0.750566602695
              le_mean =     -22.660903712988
             les_mean =     513.960177783572
             stat err =       0.000539065046
             autocorr =       1.336307247809
   target nu stat err =       0.000539065046
   target dn stat err =       0.002361560197
      target stat err =       0.002050047441
              std dev =       0.659482093371
             le_variance =       0.434916631477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434850971266
                                         uncertainty =       0.001832798061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434850971266
                                         uncertainty =       0.001832798061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466324260
  error estimate for blocks of size 2^( 2) =       0.000491004308
  error estimate for blocks of size 2^( 3) =       0.000513480774
  error estimate for blocks of size 2^( 4) =       0.000528851612
  error estimate for blocks of size 2^( 5) =       0.000538903840
  error estimate for blocks of size 2^( 6) =       0.000543551053
  error estimate for blocks of size 2^( 7) =       0.000544953678

      target function =      -0.750566602694
              le_mean =     -22.660903712988
             les_mean =     513.960177783572
             stat err =       0.000539065046
             autocorr =       1.336307247802
   target nu stat err =       0.000539065046
   target dn stat err =       0.002361560197
      target stat err =       0.002050047441
              std dev =       0.659482093371
             le_variance =       0.434916631477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434850971266
                                         uncertainty =       0.001832798061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434850971266
                                         uncertainty =       0.001832798061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466324260
  error estimate for blocks of size 2^( 2) =       0.000491004308
  error estimate for blocks of size 2^( 3) =       0.000513480774
  error estimate for blocks of size 2^( 4) =       0.000528851612
  error estimate for blocks of size 2^( 5) =       0.000538903840
  error estimate for blocks of size 2^( 6) =       0.000543551053
  error estimate for blocks of size 2^( 7) =       0.000544953678

      target function =      -0.750566602693
              le_mean =     -22.660903712988
             les_mean =     513.960177783572
             stat err =       0.000539065046
             autocorr =       1.336307247810
   target nu stat err =       0.000539065046
   target dn stat err =       0.002361560197
      target stat err =       0.002050047441
              std dev =       0.659482093371
             le_variance =       0.434916631477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750566602693        initial
     3.6380e+07     3.6380e+08             5.3141e-12        -0.750566602695  <--
     1.4552e+08     1.4552e+09             1.3286e-12        -0.750566602694
     5.8208e+08     5.8208e+09             3.3212e-13        -0.750566602693

*****************************************************************************
Applying the update for shift_i =   3.6380e+07     and shift_s =   3.6380e+08
*****************************************************************************

  Execution time = 4.3752e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764576e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4565e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.6943
    reference variance = 0.300762
====================================================
  Execution time = 2.6347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5573e-01
  Total weights = 1.955230507e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446569135694
                                         uncertainty =       0.003448238805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446569135694
                                         uncertainty =       0.003448238805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472454421
  error estimate for blocks of size 2^( 2) =       0.000495772951
  error estimate for blocks of size 2^( 3) =       0.000517638830
  error estimate for blocks of size 2^( 4) =       0.000533845351
  error estimate for blocks of size 2^( 5) =       0.000542813675
  error estimate for blocks of size 2^( 6) =       0.000547918976
  error estimate for blocks of size 2^( 7) =       0.000549809338

      target function =      -0.740637380835
              le_mean =     -22.661996830756
             les_mean =     514.021828282826
             stat err =       0.000543596835
             autocorr =       1.323835446285
   target nu stat err =       0.000543596835
   target dn stat err =       0.004307859971
      target stat err =       0.003539735461
              std dev =       0.668151449124
             le_variance =       0.446426358967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266199683076e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740653385878       residual = 3.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740653385883       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740653385884       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740653384790       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740653387794       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740653384851       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740653368237       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740653391489       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740653377574       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+06 is 3.351264e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740653385878       residual = 3.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740653385879       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740653385879       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740653385879       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740653385879       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740653385879       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740653369847       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740653385879       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740653270524       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+07 is 8.378248e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740653385878       residual = 3.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740653385878       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740653385878       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740653385878       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740653385864       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740653354557       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740653411123       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740653527751       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740653234268       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+08 is 2.094493e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.400635 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1036e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764575e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.6619
    reference variance = 0.60595
====================================================
  Execution time = 2.5397e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5271e-01
  Total weights = 1.9554e+06
  Execution time = 3.6312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440091796606
                                         uncertainty =       0.001837225317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440091796606
                                         uncertainty =       0.001837225317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469125120
  error estimate for blocks of size 2^( 2) =       0.000492614586
  error estimate for blocks of size 2^( 3) =       0.000514495998
  error estimate for blocks of size 2^( 4) =       0.000529893923
  error estimate for blocks of size 2^( 5) =       0.000539316112
  error estimate for blocks of size 2^( 6) =       0.000542907001
  error estimate for blocks of size 2^( 7) =       0.000545458811

      target function =      -0.743097002093
              le_mean =     -22.661927579602
             les_mean =     514.015673330620
             stat err =       0.000539393962
             autocorr =       1.322010130184
   target nu stat err =       0.000539393962
   target dn stat err =       0.002924325472
      target stat err =       0.002456600617
              std dev =       0.663443107611
             le_variance =       0.440156757037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440091796608
                                         uncertainty =       0.001837225317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440091796608
                                         uncertainty =       0.001837225317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469125120
  error estimate for blocks of size 2^( 2) =       0.000492614586
  error estimate for blocks of size 2^( 3) =       0.000514495998
  error estimate for blocks of size 2^( 4) =       0.000529893923
  error estimate for blocks of size 2^( 5) =       0.000539316112
  error estimate for blocks of size 2^( 6) =       0.000542907001
  error estimate for blocks of size 2^( 7) =       0.000545458811

      target function =      -0.743097002030
              le_mean =     -22.661927579602
             les_mean =     514.015673330705
             stat err =       0.000539393962
             autocorr =       1.322010130179
   target nu stat err =       0.000539393962
   target dn stat err =       0.002924325473
      target stat err =       0.002456600618
              std dev =       0.663443107613
             le_variance =       0.440156757039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440091796607
                                         uncertainty =       0.001837225317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440091796607
                                         uncertainty =       0.001837225317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469125120
  error estimate for blocks of size 2^( 2) =       0.000492614586
  error estimate for blocks of size 2^( 3) =       0.000514495998
  error estimate for blocks of size 2^( 4) =       0.000529893923
  error estimate for blocks of size 2^( 5) =       0.000539316112
  error estimate for blocks of size 2^( 6) =       0.000542907001
  error estimate for blocks of size 2^( 7) =       0.000545458811

      target function =      -0.743097002062
              le_mean =     -22.661927579602
             les_mean =     514.015673330662
             stat err =       0.000539393962
             autocorr =       1.322010130185
   target nu stat err =       0.000539393962
   target dn stat err =       0.002924325473
      target stat err =       0.002456600618
              std dev =       0.663443107612
             le_variance =       0.440156757038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440091796606
                                         uncertainty =       0.001837225317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440091796606
                                         uncertainty =       0.001837225317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469125120
  error estimate for blocks of size 2^( 2) =       0.000492614586
  error estimate for blocks of size 2^( 3) =       0.000514495998
  error estimate for blocks of size 2^( 4) =       0.000529893923
  error estimate for blocks of size 2^( 5) =       0.000539316112
  error estimate for blocks of size 2^( 6) =       0.000542907001
  error estimate for blocks of size 2^( 7) =       0.000545458811

      target function =      -0.743097002089
              le_mean =     -22.661927579602
             les_mean =     514.015673330625
             stat err =       0.000539393962
             autocorr =       1.322010130181
   target nu stat err =       0.000539393962
   target dn stat err =       0.002924325472
      target stat err =       0.002456600617
              std dev =       0.663443107611
             le_variance =       0.440156757037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743097002093        initial  <--
     9.0949e+06     9.0949e+07             3.3513e-11        -0.743097002030
     3.6380e+07     3.6380e+08             8.3782e-12        -0.743097002062
     1.4552e+08     1.4552e+09             2.0945e-12        -0.743097002089

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5532
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764576e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4595e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.607
    reference variance = 0.4019
====================================================
  Execution time = 2.6074e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5109e-01
  Total weights = 1.955073834e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440463189651
                                         uncertainty =       0.002324009416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440463189651
                                         uncertainty =       0.002324009416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469312904
  error estimate for blocks of size 2^( 2) =       0.000493392213
  error estimate for blocks of size 2^( 3) =       0.000515718599
  error estimate for blocks of size 2^( 4) =       0.000532168355
  error estimate for blocks of size 2^( 5) =       0.000540789206
  error estimate for blocks of size 2^( 6) =       0.000547089654
  error estimate for blocks of size 2^( 7) =       0.000552740947

      target function =      -0.744416845875
              le_mean =     -22.661656201710
             les_mean =     514.001752327382
             stat err =       0.000543197041
             autocorr =       1.339645219938
   target nu stat err =       0.000543197041
   target dn stat err =       0.003219387454
      target stat err =       0.002699888805
              std dev =       0.663708674255
             le_variance =       0.440509204282


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266165620171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744425814866       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744425814867       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744425814867       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744425814867       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744425799564       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744425840187       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744426061453       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744425777987       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744425764603       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744425950246       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744425627205       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+07 is 1.764401e-12

solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744425814866       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744425814866       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744425814866       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744425789382       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744426060055       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744425754402       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744425675356       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744425606075       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744425617803       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744425662468       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744426868516       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+08 is 4.410906e-13

solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744425814866       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744425814866       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744425814866       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744425814866       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744425750048       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744425855467       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744425587424       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744425673511       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744425965134       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744424445153       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744429200681       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+09 is 1.102721e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.404786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0822e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764576e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.7002
    reference variance = 0.537492
====================================================
  Execution time = 2.7494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5385e-01
  Total weights = 1.9553e+06
  Execution time = 3.6317e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442550632443
                                         uncertainty =       0.002496241756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442550632443
                                         uncertainty =       0.002496241756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470573032
  error estimate for blocks of size 2^( 2) =       0.000494911520
  error estimate for blocks of size 2^( 3) =       0.000517720301
  error estimate for blocks of size 2^( 4) =       0.000533902362
  error estimate for blocks of size 2^( 5) =       0.000544055619
  error estimate for blocks of size 2^( 6) =       0.000547171339
  error estimate for blocks of size 2^( 7) =       0.000549200222

      target function =      -0.742165723777
              le_mean =     -22.661413032614
             les_mean =     513.993486690654
             stat err =       0.000543582386
             autocorr =       1.334371265940
   target nu stat err =       0.000543582386
   target dn stat err =       0.003681884567
      target stat err =       0.003050751018
              std dev =       0.665490763969
             le_variance =       0.442877956928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442550632443
                                         uncertainty =       0.002496241756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442550632443
                                         uncertainty =       0.002496241756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470573032
  error estimate for blocks of size 2^( 2) =       0.000494911520
  error estimate for blocks of size 2^( 3) =       0.000517720301
  error estimate for blocks of size 2^( 4) =       0.000533902362
  error estimate for blocks of size 2^( 5) =       0.000544055619
  error estimate for blocks of size 2^( 6) =       0.000547171339
  error estimate for blocks of size 2^( 7) =       0.000549200222

      target function =      -0.742165723778
              le_mean =     -22.661413032614
             les_mean =     513.993486690653
             stat err =       0.000543582386
             autocorr =       1.334371265923
   target nu stat err =       0.000543582386
   target dn stat err =       0.003681884567
      target stat err =       0.003050751018
              std dev =       0.665490763969
             le_variance =       0.442877956928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442550632443
                                         uncertainty =       0.002496241756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442550632443
                                         uncertainty =       0.002496241756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470573032
  error estimate for blocks of size 2^( 2) =       0.000494911520
  error estimate for blocks of size 2^( 3) =       0.000517720301
  error estimate for blocks of size 2^( 4) =       0.000533902362
  error estimate for blocks of size 2^( 5) =       0.000544055619
  error estimate for blocks of size 2^( 6) =       0.000547171339
  error estimate for blocks of size 2^( 7) =       0.000549200222

      target function =      -0.742165723778
              le_mean =     -22.661413032614
             les_mean =     513.993486690654
             stat err =       0.000543582386
             autocorr =       1.334371265930
   target nu stat err =       0.000543582386
   target dn stat err =       0.003681884567
      target stat err =       0.003050751018
              std dev =       0.665490763969
             le_variance =       0.442877956928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442550632443
                                         uncertainty =       0.002496241756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442550632443
                                         uncertainty =       0.002496241756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470573032
  error estimate for blocks of size 2^( 2) =       0.000494911520
  error estimate for blocks of size 2^( 3) =       0.000517720301
  error estimate for blocks of size 2^( 4) =       0.000533902362
  error estimate for blocks of size 2^( 5) =       0.000544055619
  error estimate for blocks of size 2^( 6) =       0.000547171339
  error estimate for blocks of size 2^( 7) =       0.000549200222

      target function =      -0.742165723777
              le_mean =     -22.661413032614
             les_mean =     513.993486690654
             stat err =       0.000543582386
             autocorr =       1.334371265935
   target nu stat err =       0.000543582386
   target dn stat err =       0.003681884567
      target stat err =       0.003050751018
              std dev =       0.665490763969
             le_variance =       0.442877956928


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742165723777        initial
     9.0949e+07     9.0949e+08             1.7644e-12        -0.742165723778  <--
     3.6380e+08     3.6380e+09             4.4109e-13        -0.742165723778
     1.4552e+09     1.4552e+10             1.1027e-13        -0.742165723777

*****************************************************************************
Applying the update for shift_i =   9.0949e+07     and shift_s =   9.0949e+08
*****************************************************************************

  Execution time = 4.5597e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764576e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6426e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6704
    reference variance = 0.409807
====================================================
  Execution time = 2.6061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4865e-01
  Total weights = 1.955076054e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440988620395
                                         uncertainty =       0.002033985278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440988620395
                                         uncertainty =       0.002033985278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469560767
  error estimate for blocks of size 2^( 2) =       0.000493733585
  error estimate for blocks of size 2^( 3) =       0.000515818975
  error estimate for blocks of size 2^( 4) =       0.000531929156
  error estimate for blocks of size 2^( 5) =       0.000542202688
  error estimate for blocks of size 2^( 6) =       0.000548201386
  error estimate for blocks of size 2^( 7) =       0.000551730055

      target function =      -0.746424398577
              le_mean =     -22.661740438644
             les_mean =     514.003127990261
             stat err =       0.000543515821
             autocorr =       1.339802467740
   target nu stat err =       0.000543515821
   target dn stat err =       0.002535487035
      target stat err =       0.002169481682
              std dev =       0.664059205647
             le_variance =       0.440974628605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266174043864e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746429757488       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746429757489       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746429757489       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746429757489       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746429759626       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746429762346       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746429770660       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746429760583       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746429695331       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746429785819       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746429815096       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+07 is 7.976256e-12

solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746429757488       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746429757488       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746429757488       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746429684685       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746429746807       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746429829049       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746429515167       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746429691771       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746429725559       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746429948315       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746429751301       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+07 is 1.994096e-12

solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746429757488       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746429757488       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746429757488       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746429757488       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746429757488       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746429782622       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746429757488       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746429609789       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746430355067       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746428306731       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746429287464       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+08 is 4.984714e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.408921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0790e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340451e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115755e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764576e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6648
    reference variance = 0.25703
====================================================
  Execution time = 2.5413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4587e-01
  Total weights = 1.9553e+06
  Execution time = 3.6455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436244025211
                                         uncertainty =       0.001947945318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436244025211
                                         uncertainty =       0.001947945318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466990891
  error estimate for blocks of size 2^( 2) =       0.000491273559
  error estimate for blocks of size 2^( 3) =       0.000513544532
  error estimate for blocks of size 2^( 4) =       0.000529296912
  error estimate for blocks of size 2^( 5) =       0.000539749504
  error estimate for blocks of size 2^( 6) =       0.000546114619
  error estimate for blocks of size 2^( 7) =       0.000551631055

      target function =      -0.748736090356
              le_mean =     -22.663018650410
             les_mean =     514.058281750687
             stat err =       0.000541698023
             autocorr =       1.345543313122
   target nu stat err =       0.000541698023
   target dn stat err =       0.002841240362
      target stat err =       0.002430761616
              std dev =       0.660424851135
             le_variance =       0.436160983997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436244025209
                                         uncertainty =       0.001947945318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436244025209
                                         uncertainty =       0.001947945318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466990891
  error estimate for blocks of size 2^( 2) =       0.000491273559
  error estimate for blocks of size 2^( 3) =       0.000513544532
  error estimate for blocks of size 2^( 4) =       0.000529296912
  error estimate for blocks of size 2^( 5) =       0.000539749504
  error estimate for blocks of size 2^( 6) =       0.000546114619
  error estimate for blocks of size 2^( 7) =       0.000551631055

      target function =      -0.748736090363
              le_mean =     -22.663018650410
             les_mean =     514.058281750676
             stat err =       0.000541698023
             autocorr =       1.345543313119
   target nu stat err =       0.000541698023
   target dn stat err =       0.002841240360
      target stat err =       0.002430761615
              std dev =       0.660424851134
             le_variance =       0.436160983995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436244025210
                                         uncertainty =       0.001947945318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436244025210
                                         uncertainty =       0.001947945318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466990891
  error estimate for blocks of size 2^( 2) =       0.000491273559
  error estimate for blocks of size 2^( 3) =       0.000513544532
  error estimate for blocks of size 2^( 4) =       0.000529296912
  error estimate for blocks of size 2^( 5) =       0.000539749504
  error estimate for blocks of size 2^( 6) =       0.000546114619
  error estimate for blocks of size 2^( 7) =       0.000551631055

      target function =      -0.748736090359
              le_mean =     -22.663018650410
             les_mean =     514.058281750682
             stat err =       0.000541698023
             autocorr =       1.345543313118
   target nu stat err =       0.000541698023
   target dn stat err =       0.002841240361
      target stat err =       0.002430761615
              std dev =       0.660424851134
             le_variance =       0.436160983996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436244025210
                                         uncertainty =       0.001947945318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436244025210
                                         uncertainty =       0.001947945318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466990891
  error estimate for blocks of size 2^( 2) =       0.000491273559
  error estimate for blocks of size 2^( 3) =       0.000513544532
  error estimate for blocks of size 2^( 4) =       0.000529296912
  error estimate for blocks of size 2^( 5) =       0.000539749504
  error estimate for blocks of size 2^( 6) =       0.000546114619
  error estimate for blocks of size 2^( 7) =       0.000551631055

      target function =      -0.748736090356
              le_mean =     -22.663018650410
             les_mean =     514.058281750686
             stat err =       0.000541698023
             autocorr =       1.345543313122
   target nu stat err =       0.000541698023
   target dn stat err =       0.002841240362
      target stat err =       0.002430761616
              std dev =       0.660424851135
             le_variance =       0.436160983997


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748736090356        initial
     2.2737e+07     2.2737e+08             7.9763e-12        -0.748736090363  <--
     9.0949e+07     9.0949e+08             1.9941e-12        -0.748736090359
     3.6380e+08     3.6380e+09             4.9847e-13        -0.748736090356

*****************************************************************************
Applying the update for shift_i =   2.2737e+07     and shift_s =   2.2737e+08
*****************************************************************************

  Execution time = 4.3563e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115754e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764576e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.6512
    reference variance = 0.356589
====================================================
  Execution time = 2.6037e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5542e-01
  Total weights = 1.955540401e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442741495321
                                         uncertainty =       0.002371675587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442741495321
                                         uncertainty =       0.002371675587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470449191
  error estimate for blocks of size 2^( 2) =       0.000494258865
  error estimate for blocks of size 2^( 3) =       0.000515803701
  error estimate for blocks of size 2^( 4) =       0.000532148039
  error estimate for blocks of size 2^( 5) =       0.000542761702
  error estimate for blocks of size 2^( 6) =       0.000547280370
  error estimate for blocks of size 2^( 7) =       0.000549616894

      target function =      -0.740895578834
              le_mean =     -22.662707936910
             les_mean =     514.053751126894
             stat err =       0.000542951751
             autocorr =       1.331977917379
   target nu stat err =       0.000542951751
   target dn stat err =       0.003356605944
      target stat err =       0.002787806411
              std dev =       0.665315625936
             le_variance =       0.442644882114


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266270793691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740905137419       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740905137423       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740905137424       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740905137424       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740905140919       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740905137424       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740905126485       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740905123174       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740905144256       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740905126191       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740905130400       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740905137424       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+06 is 4.160849e-11

solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740905137419       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740905137420       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740905137420       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740905128726       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740905137420       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740905137420       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740905109359       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740905137420       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740905092376       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740905122792       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740905137420       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740905209795       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+07 is 1.040211e-11

solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740905137419       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740905137419       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740905137419       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740905137419       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740905176428       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740905137419       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740905131931       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740904915049       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740905222651       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740904885653       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740905094247       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740904983197       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+07 is 2.600529e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.413758 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0776e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115755e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764576e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.5636
    reference variance = 0.375041
====================================================
  Execution time = 2.5492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5065e-01
  Total weights = 1.9552e+06
  Execution time = 3.6251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441256448475
                                         uncertainty =       0.001753478306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441256448475
                                         uncertainty =       0.001753478306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469687129
  error estimate for blocks of size 2^( 2) =       0.000494249706
  error estimate for blocks of size 2^( 3) =       0.000516906673
  error estimate for blocks of size 2^( 4) =       0.000531768516
  error estimate for blocks of size 2^( 5) =       0.000540331817
  error estimate for blocks of size 2^( 6) =       0.000546297964
  error estimate for blocks of size 2^( 7) =       0.000548110515

      target function =      -0.744785271780
              le_mean =     -22.662361592868
             les_mean =     514.033286450147
             stat err =       0.000541627203
             autocorr =       1.329791700125
   target nu stat err =       0.000541627203
   target dn stat err =       0.002447346479
      target stat err =       0.002092393063
              std dev =       0.664237908454
             le_variance =       0.441211999028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441256448464
                                         uncertainty =       0.001753478305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441256448464
                                         uncertainty =       0.001753478305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469687129
  error estimate for blocks of size 2^( 2) =       0.000494249706
  error estimate for blocks of size 2^( 3) =       0.000516906673
  error estimate for blocks of size 2^( 4) =       0.000531768516
  error estimate for blocks of size 2^( 5) =       0.000540331817
  error estimate for blocks of size 2^( 6) =       0.000546297964
  error estimate for blocks of size 2^( 7) =       0.000548110515

      target function =      -0.744785271810
              le_mean =     -22.662361592868
             les_mean =     514.033286450108
             stat err =       0.000541627203
             autocorr =       1.329791700143
   target nu stat err =       0.000541627203
   target dn stat err =       0.002447346478
      target stat err =       0.002092393062
              std dev =       0.664237908446
             le_variance =       0.441211999017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441256448469
                                         uncertainty =       0.001753478305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441256448469
                                         uncertainty =       0.001753478305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469687129
  error estimate for blocks of size 2^( 2) =       0.000494249706
  error estimate for blocks of size 2^( 3) =       0.000516906673
  error estimate for blocks of size 2^( 4) =       0.000531768516
  error estimate for blocks of size 2^( 5) =       0.000540331817
  error estimate for blocks of size 2^( 6) =       0.000546297964
  error estimate for blocks of size 2^( 7) =       0.000548110515

      target function =      -0.744785271795
              le_mean =     -22.662361592868
             les_mean =     514.033286450128
             stat err =       0.000541627203
             autocorr =       1.329791700145
   target nu stat err =       0.000541627203
   target dn stat err =       0.002447346479
      target stat err =       0.002092393063
              std dev =       0.664237908450
             le_variance =       0.441211999023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441256448474
                                         uncertainty =       0.001753478306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441256448474
                                         uncertainty =       0.001753478306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469687129
  error estimate for blocks of size 2^( 2) =       0.000494249706
  error estimate for blocks of size 2^( 3) =       0.000516906673
  error estimate for blocks of size 2^( 4) =       0.000531768516
  error estimate for blocks of size 2^( 5) =       0.000540331817
  error estimate for blocks of size 2^( 6) =       0.000546297964
  error estimate for blocks of size 2^( 7) =       0.000548110515

      target function =      -0.744785271782
              le_mean =     -22.662361592868
             les_mean =     514.033286450145
             stat err =       0.000541627203
             autocorr =       1.329791700133
   target nu stat err =       0.000541627203
   target dn stat err =       0.002447346479
      target stat err =       0.002092393063
              std dev =       0.664237908454
             le_variance =       0.441211999027


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744785271780        initial
     5.6843e+06     5.6843e+07             4.1608e-11        -0.744785271810  <--
     2.2737e+07     2.2737e+08             1.0402e-11        -0.744785271795
     9.0949e+07     9.0949e+08             2.6005e-12        -0.744785271782

*****************************************************************************
Applying the update for shift_i =   5.6843e+06     and shift_s =   5.6843e+07
*****************************************************************************

  Execution time = 4.3593e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250347e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115757e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764576e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4375e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.6212
    reference variance = 0.401157
====================================================
  Execution time = 2.6037e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5075e-01
  Total weights = 1.955532658e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440623518431
                                         uncertainty =       0.002005928812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440623518431
                                         uncertainty =       0.002005928812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469362697
  error estimate for blocks of size 2^( 2) =       0.000492820311
  error estimate for blocks of size 2^( 3) =       0.000514676485
  error estimate for blocks of size 2^( 4) =       0.000530377510
  error estimate for blocks of size 2^( 5) =       0.000540011675
  error estimate for blocks of size 2^( 6) =       0.000545231806
  error estimate for blocks of size 2^( 7) =       0.000548949441

      target function =      -0.744701449951
              le_mean =     -22.662069025391
             les_mean =     514.020124033183
             stat err =       0.000541142608
             autocorr =       1.329248930497
   target nu stat err =       0.000541142608
   target dn stat err =       0.002621942743
      target stat err =       0.002228340742
              std dev =       0.663779091572
             le_variance =       0.440602682408


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266206902539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744707202578       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744707202589       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744707202591       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744707202465       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744707202653       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744707201987       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744707203965       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744707202549       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744707203658       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744707202140       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744707203456       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+06 is 1.233979e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744707202578       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744707202581       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744707202581       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744707202582       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744707205588       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744707205782       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744707204316       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744707194524       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744707181884       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744707202582       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744707202582       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+06 is 3.084949e-11

solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744707202578       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744707202579       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744707202579       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744707202579       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744707202573       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744707214938       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744707210504       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744707213868       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744707188726       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744707255258       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744707182552       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+07 is 7.712362e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.417939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0758e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115749e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764576e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.733
    reference variance = 0.415246
====================================================
  Execution time = 2.5363e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4618e-01
  Total weights = 1.9548e+06
  Execution time = 3.6287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708968208
                                         uncertainty =       0.002135465547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708968208
                                         uncertainty =       0.002135465547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467808393
  error estimate for blocks of size 2^( 2) =       0.000491735117
  error estimate for blocks of size 2^( 3) =       0.000514552344
  error estimate for blocks of size 2^( 4) =       0.000530350527
  error estimate for blocks of size 2^( 5) =       0.000540486135
  error estimate for blocks of size 2^( 6) =       0.000544117148
  error estimate for blocks of size 2^( 7) =       0.000545754760

      target function =      -0.748456749242
              le_mean =     -22.661814907850
             les_mean =     514.004039347955
             stat err =       0.000540177143
             autocorr =       1.333326122347
   target nu stat err =       0.000540177143
   target dn stat err =       0.002643611404
      target stat err =       0.002266222499
              std dev =       0.661580974011
             le_variance =       0.437689385174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708968192
                                         uncertainty =       0.002135465548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708968192
                                         uncertainty =       0.002135465548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467808393
  error estimate for blocks of size 2^( 2) =       0.000491735117
  error estimate for blocks of size 2^( 3) =       0.000514552344
  error estimate for blocks of size 2^( 4) =       0.000530350527
  error estimate for blocks of size 2^( 5) =       0.000540486135
  error estimate for blocks of size 2^( 6) =       0.000544117148
  error estimate for blocks of size 2^( 7) =       0.000545754760

      target function =      -0.748456749283
              le_mean =     -22.661814907851
             les_mean =     514.004039347929
             stat err =       0.000540177143
             autocorr =       1.333326122402
   target nu stat err =       0.000540177143
   target dn stat err =       0.002643611403
      target stat err =       0.002266222499
              std dev =       0.661580974000
             le_variance =       0.437689385158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708968200
                                         uncertainty =       0.002135465547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708968200
                                         uncertainty =       0.002135465547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467808393
  error estimate for blocks of size 2^( 2) =       0.000491735117
  error estimate for blocks of size 2^( 3) =       0.000514552344
  error estimate for blocks of size 2^( 4) =       0.000530350527
  error estimate for blocks of size 2^( 5) =       0.000540486135
  error estimate for blocks of size 2^( 6) =       0.000544117148
  error estimate for blocks of size 2^( 7) =       0.000545754760

      target function =      -0.748456749263
              le_mean =     -22.661814907851
             les_mean =     514.004039347942
             stat err =       0.000540177143
             autocorr =       1.333326122374
   target nu stat err =       0.000540177143
   target dn stat err =       0.002643611404
      target stat err =       0.002266222499
              std dev =       0.661580974006
             le_variance =       0.437689385166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708968207
                                         uncertainty =       0.002135465547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708968207
                                         uncertainty =       0.002135465547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467808393
  error estimate for blocks of size 2^( 2) =       0.000491735117
  error estimate for blocks of size 2^( 3) =       0.000514552344
  error estimate for blocks of size 2^( 4) =       0.000530350527
  error estimate for blocks of size 2^( 5) =       0.000540486135
  error estimate for blocks of size 2^( 6) =       0.000544117148
  error estimate for blocks of size 2^( 7) =       0.000545754760

      target function =      -0.748456749245
              le_mean =     -22.661814907850
             les_mean =     514.004039347953
             stat err =       0.000540177143
             autocorr =       1.333326122359
   target nu stat err =       0.000540177143
   target dn stat err =       0.002643611404
      target stat err =       0.002266222499
              std dev =       0.661580974011
             le_variance =       0.437689385173


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748456749242        initial
     1.4211e+06     1.4211e+07             1.2340e-10        -0.748456749283  <--
     5.6843e+06     5.6843e+07             3.0849e-11        -0.748456749263
     2.2737e+07     2.2737e+08             7.7124e-12        -0.748456749245

*****************************************************************************
Applying the update for shift_i =   1.4211e+06     and shift_s =   1.4211e+07
*****************************************************************************

  Execution time = 4.3665e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115725e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764578e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.6658
    reference variance = 0.476739
====================================================
  Execution time = 2.6305e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5128e-01
  Total weights = 1.955209394e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439030153127
                                         uncertainty =       0.002562868972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439030153127
                                         uncertainty =       0.002562868972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468528803
  error estimate for blocks of size 2^( 2) =       0.000492883987
  error estimate for blocks of size 2^( 3) =       0.000515273149
  error estimate for blocks of size 2^( 4) =       0.000531422450
  error estimate for blocks of size 2^( 5) =       0.000541331153
  error estimate for blocks of size 2^( 6) =       0.000544927933
  error estimate for blocks of size 2^( 7) =       0.000548648922

      target function =      -0.744260341419
              le_mean =     -22.661902358921
             les_mean =     514.013102844552
             stat err =       0.000541582614
             autocorr =       1.336154994298
   target nu stat err =       0.000541582614
   target dn stat err =       0.003258935468
      target stat err =       0.002730929154
              std dev =       0.662599788093
             le_variance =       0.439038479182


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266190235892e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744269608188       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744269608319       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744269608330       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744269608332       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744269608333       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744269608333       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744269608286       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744269609013       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744269609359       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744269607887       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744269608333       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744269608385       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+05 is 6.002700e-10

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744269608188       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744269608221       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744269608223       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744269608224       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744269608224       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744269608224       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744269608224       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744269608224       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744269608224       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744269608224       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744269608224       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744269608224       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+06 is 1.500675e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744269608188       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744269608196       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744269608197       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744269608197       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744269608197       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744269613896       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744269601563       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744269608197       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744269611745       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744269608197       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744269602355       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744269605839       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+06 is 3.751690e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.422767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1016e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647435e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704983e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115708e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764581e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7565
    reference variance = 0.312355
====================================================
  Execution time = 2.7246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5078e-01
  Total weights = 1.9551e+06
  Execution time = 3.6316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440038639359
                                         uncertainty =       0.002522717991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440038639359
                                         uncertainty =       0.002522717991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469054495
  error estimate for blocks of size 2^( 2) =       0.000492750608
  error estimate for blocks of size 2^( 3) =       0.000514537736
  error estimate for blocks of size 2^( 4) =       0.000531348534
  error estimate for blocks of size 2^( 5) =       0.000541015763
  error estimate for blocks of size 2^( 6) =       0.000546645922
  error estimate for blocks of size 2^( 7) =       0.000548167387

      target function =      -0.744670965912
              le_mean =     -22.661574683889
             les_mean =     513.997746326775
             stat err =       0.000541794402
             autocorr =       1.334204564218
   target nu stat err =       0.000541794402
   target dn stat err =       0.003144338366
      target stat err =       0.002641150536
              std dev =       0.663343228222
             le_variance =       0.440024238428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440038639340
                                         uncertainty =       0.002522717995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440038639340
                                         uncertainty =       0.002522717995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469054495
  error estimate for blocks of size 2^( 2) =       0.000492750608
  error estimate for blocks of size 2^( 3) =       0.000514537736
  error estimate for blocks of size 2^( 4) =       0.000531348534
  error estimate for blocks of size 2^( 5) =       0.000541015763
  error estimate for blocks of size 2^( 6) =       0.000546645922
  error estimate for blocks of size 2^( 7) =       0.000548167387

      target function =      -0.744670965380
              le_mean =     -22.661574683897
             les_mean =     513.997746327786
             stat err =       0.000541794402
             autocorr =       1.334204564317
   target nu stat err =       0.000541794402
   target dn stat err =       0.003144338525
      target stat err =       0.002641150660
              std dev =       0.663343228207
             le_variance =       0.440024238408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440038639350
                                         uncertainty =       0.002522717993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440038639350
                                         uncertainty =       0.002522717993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469054495
  error estimate for blocks of size 2^( 2) =       0.000492750608
  error estimate for blocks of size 2^( 3) =       0.000514537736
  error estimate for blocks of size 2^( 4) =       0.000531348534
  error estimate for blocks of size 2^( 5) =       0.000541015763
  error estimate for blocks of size 2^( 6) =       0.000546645922
  error estimate for blocks of size 2^( 7) =       0.000548167387

      target function =      -0.744670965646
              le_mean =     -22.661574683893
             les_mean =     513.997746327280
             stat err =       0.000541794402
             autocorr =       1.334204564268
   target nu stat err =       0.000541794402
   target dn stat err =       0.003144338445
      target stat err =       0.002641150598
              std dev =       0.663343228215
             le_variance =       0.440024238418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440038639358
                                         uncertainty =       0.002522717991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440038639358
                                         uncertainty =       0.002522717991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469054495
  error estimate for blocks of size 2^( 2) =       0.000492750608
  error estimate for blocks of size 2^( 3) =       0.000514537736
  error estimate for blocks of size 2^( 4) =       0.000531348534
  error estimate for blocks of size 2^( 5) =       0.000541015763
  error estimate for blocks of size 2^( 6) =       0.000546645922
  error estimate for blocks of size 2^( 7) =       0.000548167387

      target function =      -0.744670965879
              le_mean =     -22.661574683890
             les_mean =     513.997746326838
             stat err =       0.000541794402
             autocorr =       1.334204564226
   target nu stat err =       0.000541794402
   target dn stat err =       0.003144338376
      target stat err =       0.002641150544
              std dev =       0.663343228221
             le_variance =       0.440024238427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744670965912        initial  <--
     3.5527e+05     3.5527e+06             6.0027e-10        -0.744670965380
     1.4211e+06     1.4211e+07             1.5007e-10        -0.744670965646
     5.6843e+06     5.6843e+07             3.7517e-11        -0.744670965879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3382
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115725e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764578e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6361e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6014
    reference variance = 0.507029
====================================================
  Execution time = 2.5986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4904e-01
  Total weights = 1.954986144e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437707167855
                                         uncertainty =       0.002396336495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437707167855
                                         uncertainty =       0.002396336495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467814904
  error estimate for blocks of size 2^( 2) =       0.000491741982
  error estimate for blocks of size 2^( 3) =       0.000514143463
  error estimate for blocks of size 2^( 4) =       0.000529671803
  error estimate for blocks of size 2^( 5) =       0.000539086557
  error estimate for blocks of size 2^( 6) =       0.000544514049
  error estimate for blocks of size 2^( 7) =       0.000546927765

      target function =      -0.746105752135
              le_mean =     -22.662345401916
             les_mean =     514.030935167449
             stat err =       0.000540050043
             autocorr =       1.332661659314
   target nu stat err =       0.000540050043
   target dn stat err =       0.003747883178
      target stat err =       0.003139384029
              std dev =       0.661590181872
             le_variance =       0.437701568749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266234540192e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746117976232       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746117976239       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746117976240       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746117978262       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746117978285       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746117974718       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746117967762       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746117979762       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746117975804       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746117980041       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746117979424       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746117971671       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+06 is 7.819696e-11

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746117976232       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746117976233       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746117976234       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746117974942       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746117981276       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746117976234       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746117953550       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746117946678       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746117976234       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746117951481       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746117975928       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746117998583       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+07 is 1.954924e-11

solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746117976232       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746117976232       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746117976232       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746117976239       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746117976667       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746117947337       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746117865647       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746117896953       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746117822291       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746118026135       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746117977244       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746117872623       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+07 is 4.887276e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.427540 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0675e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115734e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764578e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6954
    reference variance = 0.348211
====================================================
  Execution time = 2.5437e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5509e-01
  Total weights = 1.9554e+06
  Execution time = 3.6305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442356561533
                                         uncertainty =       0.002254112804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442356561533
                                         uncertainty =       0.002254112804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470328848
  error estimate for blocks of size 2^( 2) =       0.000494185163
  error estimate for blocks of size 2^( 3) =       0.000516299908
  error estimate for blocks of size 2^( 4) =       0.000532778147
  error estimate for blocks of size 2^( 5) =       0.000542972840
  error estimate for blocks of size 2^( 6) =       0.000546646769
  error estimate for blocks of size 2^( 7) =       0.000548537233

      target function =      -0.741161350747
              le_mean =     -22.662422245965
             les_mean =     514.040474436934
             stat err =       0.000542733747
             autocorr =       1.331589672768
   target nu stat err =       0.000542733747
   target dn stat err =       0.003231918146
      target stat err =       0.002689737174
              std dev =       0.665145436293
             le_variance =       0.442418451421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442356561531
                                         uncertainty =       0.002254112805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442356561531
                                         uncertainty =       0.002254112805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470328848
  error estimate for blocks of size 2^( 2) =       0.000494185163
  error estimate for blocks of size 2^( 3) =       0.000516299908
  error estimate for blocks of size 2^( 4) =       0.000532778147
  error estimate for blocks of size 2^( 5) =       0.000542972840
  error estimate for blocks of size 2^( 6) =       0.000546646769
  error estimate for blocks of size 2^( 7) =       0.000548537233

      target function =      -0.741161350805
              le_mean =     -22.662422245965
             les_mean =     514.040474436845
             stat err =       0.000542733747
             autocorr =       1.331589672782
   target nu stat err =       0.000542733747
   target dn stat err =       0.003231918107
      target stat err =       0.002689737143
              std dev =       0.665145436292
             le_variance =       0.442418451420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442356561532
                                         uncertainty =       0.002254112804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442356561532
                                         uncertainty =       0.002254112804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470328848
  error estimate for blocks of size 2^( 2) =       0.000494185163
  error estimate for blocks of size 2^( 3) =       0.000516299908
  error estimate for blocks of size 2^( 4) =       0.000532778147
  error estimate for blocks of size 2^( 5) =       0.000542972840
  error estimate for blocks of size 2^( 6) =       0.000546646769
  error estimate for blocks of size 2^( 7) =       0.000548537233

      target function =      -0.741161350776
              le_mean =     -22.662422245965
             les_mean =     514.040474436890
             stat err =       0.000542733747
             autocorr =       1.331589672774
   target nu stat err =       0.000542733747
   target dn stat err =       0.003231918126
      target stat err =       0.002689737158
              std dev =       0.665145436292
             le_variance =       0.442418451420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442356561533
                                         uncertainty =       0.002254112804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442356561533
                                         uncertainty =       0.002254112804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470328848
  error estimate for blocks of size 2^( 2) =       0.000494185163
  error estimate for blocks of size 2^( 3) =       0.000516299908
  error estimate for blocks of size 2^( 4) =       0.000532778147
  error estimate for blocks of size 2^( 5) =       0.000542972840
  error estimate for blocks of size 2^( 6) =       0.000546646769
  error estimate for blocks of size 2^( 7) =       0.000548537233

      target function =      -0.741161350750
              le_mean =     -22.662422245965
             les_mean =     514.040474436929
             stat err =       0.000542733747
             autocorr =       1.331589672776
   target nu stat err =       0.000542733747
   target dn stat err =       0.003231918144
      target stat err =       0.002689737172
              std dev =       0.665145436293
             le_variance =       0.442418451421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741161350747        initial
     3.5527e+06     3.5527e+07             7.8197e-11        -0.741161350805  <--
     1.4211e+07     1.4211e+08             1.9549e-11        -0.741161350776
     5.6843e+07     5.6843e+08             4.8873e-12        -0.741161350750

*****************************************************************************
Applying the update for shift_i =   3.5527e+06     and shift_s =   3.5527e+07
*****************************************************************************

  Execution time = 4.3548e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115760e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536954e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4230e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.5511
    reference variance = 0.278538
====================================================
  Execution time = 2.6074e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4900e-01
  Total weights = 1.954776437e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437506545611
                                         uncertainty =       0.002049865733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437506545611
                                         uncertainty =       0.002049865733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467667507
  error estimate for blocks of size 2^( 2) =       0.000491063791
  error estimate for blocks of size 2^( 3) =       0.000512992781
  error estimate for blocks of size 2^( 4) =       0.000528093605
  error estimate for blocks of size 2^( 5) =       0.000538543609
  error estimate for blocks of size 2^( 6) =       0.000544080777
  error estimate for blocks of size 2^( 7) =       0.000544619545

      target function =      -0.746126438794
              le_mean =     -22.661048840767
             les_mean =     513.972131423080
             stat err =       0.000538834384
             autocorr =       1.327505134380
   target nu stat err =       0.000538834384
   target dn stat err =       0.003050608451
      target stat err =       0.002573499106
              std dev =       0.661381730812
             le_variance =       0.437425793852


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266104884077e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746134446549       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746134446582       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746134446587       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746134446587       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746134446861       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746134446172       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746134446328       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746134447050       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746134444139       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746134446342       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746134443347       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746134445343       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+05 is 3.538283e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746134446549       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746134446558       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746134446559       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746134446559       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746134444142       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746134445273       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746134450523       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746134438894       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746134443335       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746134445045       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746134451044       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746134445074       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+06 is 8.845709e-11

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746134446549       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746134446551       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746134446552       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746134447172       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746134446552       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746134468956       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746134443765       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746134412506       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746134422306       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746134441983       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746134448006       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746134479847       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+07 is 2.211425e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.432339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0767e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321886e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115755e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.6796
    reference variance = 0.395457
====================================================
  Execution time = 2.5723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4884e-01
  Total weights = 1.9551e+06
  Execution time = 3.6293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439193670197
                                         uncertainty =       0.002192810365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439193670197
                                         uncertainty =       0.002192810365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468587342
  error estimate for blocks of size 2^( 2) =       0.000492612938
  error estimate for blocks of size 2^( 3) =       0.000514917812
  error estimate for blocks of size 2^( 4) =       0.000530602753
  error estimate for blocks of size 2^( 5) =       0.000539850272
  error estimate for blocks of size 2^( 6) =       0.000545538524
  error estimate for blocks of size 2^( 7) =       0.000548352776

      target function =      -0.746260142270
              le_mean =     -22.661520328812
             les_mean =     513.993347062781
             stat err =       0.000541086081
             autocorr =       1.333372886431
   target nu stat err =       0.000541086081
   target dn stat err =       0.002746493259
      target stat err =       0.002334328845
              std dev =       0.662682573605
             le_variance =       0.439148193360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439193670204
                                         uncertainty =       0.002192810360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439193670204
                                         uncertainty =       0.002192810360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468587342
  error estimate for blocks of size 2^( 2) =       0.000492612938
  error estimate for blocks of size 2^( 3) =       0.000514917812
  error estimate for blocks of size 2^( 4) =       0.000530602753
  error estimate for blocks of size 2^( 5) =       0.000539850272
  error estimate for blocks of size 2^( 6) =       0.000545538524
  error estimate for blocks of size 2^( 7) =       0.000548352776

      target function =      -0.746260141952
              le_mean =     -22.661520328813
             les_mean =     513.993347063230
             stat err =       0.000541086081
             autocorr =       1.333372886432
   target nu stat err =       0.000541086081
   target dn stat err =       0.002746493300
      target stat err =       0.002334328876
              std dev =       0.662682573610
             le_variance =       0.439148193367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439193670200
                                         uncertainty =       0.002192810362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439193670200
                                         uncertainty =       0.002192810362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468587342
  error estimate for blocks of size 2^( 2) =       0.000492612938
  error estimate for blocks of size 2^( 3) =       0.000514917812
  error estimate for blocks of size 2^( 4) =       0.000530602753
  error estimate for blocks of size 2^( 5) =       0.000539850272
  error estimate for blocks of size 2^( 6) =       0.000545538524
  error estimate for blocks of size 2^( 7) =       0.000548352776

      target function =      -0.746260142111
              le_mean =     -22.661520328813
             les_mean =     513.993347063006
             stat err =       0.000541086081
             autocorr =       1.333372886422
   target nu stat err =       0.000541086081
   target dn stat err =       0.002746493280
      target stat err =       0.002334328861
              std dev =       0.662682573608
             le_variance =       0.439148193364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439193670197
                                         uncertainty =       0.002192810364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439193670197
                                         uncertainty =       0.002192810364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468587342
  error estimate for blocks of size 2^( 2) =       0.000492612938
  error estimate for blocks of size 2^( 3) =       0.000514917812
  error estimate for blocks of size 2^( 4) =       0.000530602753
  error estimate for blocks of size 2^( 5) =       0.000539850272
  error estimate for blocks of size 2^( 6) =       0.000545538524
  error estimate for blocks of size 2^( 7) =       0.000548352776

      target function =      -0.746260142250
              le_mean =     -22.661520328812
             les_mean =     513.993347062809
             stat err =       0.000541086081
             autocorr =       1.333372886421
   target nu stat err =       0.000541086081
   target dn stat err =       0.002746493262
      target stat err =       0.002334328847
              std dev =       0.662682573606
             le_variance =       0.439148193361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746260142270        initial  <--
     8.8818e+05     8.8818e+06             3.5383e-10        -0.746260141952
     3.5527e+06     3.5527e+07             8.8457e-11        -0.746260142111
     1.4211e+07     1.4211e+08             2.2114e-11        -0.746260142250

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9123
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115760e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536954e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.5966
    reference variance = 1.00147
====================================================
  Execution time = 2.6148e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5114e-01
  Total weights = 1.955162855e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441289590890
                                         uncertainty =       0.002324282832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441289590890
                                         uncertainty =       0.002324282832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469674907
  error estimate for blocks of size 2^( 2) =       0.000493657820
  error estimate for blocks of size 2^( 3) =       0.000515771829
  error estimate for blocks of size 2^( 4) =       0.000531265382
  error estimate for blocks of size 2^( 5) =       0.000539853879
  error estimate for blocks of size 2^( 6) =       0.000544994368
  error estimate for blocks of size 2^( 7) =       0.000546634379

      target function =      -0.744374008354
              le_mean =     -22.661383264920
             les_mean =     513.989433725781
             stat err =       0.000540687002
             autocorr =       1.325247957223
   target nu stat err =       0.000540687002
   target dn stat err =       0.002839065835
      target stat err =       0.002395584902
              std dev =       0.664220622947
             le_variance =       0.441189035948


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266138326492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744380839026       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744380839028       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744380839028       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744380839028       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744380840155       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744380843809       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744380839028       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744380839028       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744380839028       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744380838508       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744380839028       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+06 is 2.052553e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744380839026       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744380839026       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744380839026       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744380839026       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744380798824       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744380869239       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744380927619       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744380839026       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744380897108       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744380872409       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744380839026       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+07 is 5.131406e-12

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744380839026       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744380839026       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744380839026       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744380803903       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744380790662       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744380898662       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744380846035       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744380824348       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744380839026       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744380871668       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744380846168       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+08 is 1.282869e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.436474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0832e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115762e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.6892
    reference variance = 0.40107
====================================================
  Execution time = 2.5690e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5344e-01
  Total weights = 1.9554e+06
  Execution time = 3.6306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442051645511
                                         uncertainty =       0.002562970206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442051645511
                                         uncertainty =       0.002562970206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470111294
  error estimate for blocks of size 2^( 2) =       0.000494049351
  error estimate for blocks of size 2^( 3) =       0.000515850392
  error estimate for blocks of size 2^( 4) =       0.000531600645
  error estimate for blocks of size 2^( 5) =       0.000540242273
  error estimate for blocks of size 2^( 6) =       0.000544562733
  error estimate for blocks of size 2^( 7) =       0.000545685998

      target function =      -0.742500783728
              le_mean =     -22.661629286165
             les_mean =     514.002879454521
             stat err =       0.000540522912
             autocorr =       1.321985970137
   target nu stat err =       0.000540522912
   target dn stat err =       0.003457037169
      target stat err =       0.002874516180
              std dev =       0.664837767854
             le_variance =       0.442009257565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442051645508
                                         uncertainty =       0.002562970205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442051645508
                                         uncertainty =       0.002562970205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470111294
  error estimate for blocks of size 2^( 2) =       0.000494049351
  error estimate for blocks of size 2^( 3) =       0.000515850392
  error estimate for blocks of size 2^( 4) =       0.000531600645
  error estimate for blocks of size 2^( 5) =       0.000540242273
  error estimate for blocks of size 2^( 6) =       0.000544562733
  error estimate for blocks of size 2^( 7) =       0.000545685998

      target function =      -0.742500783732
              le_mean =     -22.661629286165
             les_mean =     514.002879454522
             stat err =       0.000540522912
             autocorr =       1.321985970163
   target nu stat err =       0.000540522912
   target dn stat err =       0.003457037167
      target stat err =       0.002874516180
              std dev =       0.664837767851
             le_variance =       0.442009257562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442051645509
                                         uncertainty =       0.002562970205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442051645509
                                         uncertainty =       0.002562970205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470111294
  error estimate for blocks of size 2^( 2) =       0.000494049351
  error estimate for blocks of size 2^( 3) =       0.000515850392
  error estimate for blocks of size 2^( 4) =       0.000531600645
  error estimate for blocks of size 2^( 5) =       0.000540242273
  error estimate for blocks of size 2^( 6) =       0.000544562733
  error estimate for blocks of size 2^( 7) =       0.000545685998

      target function =      -0.742500783730
              le_mean =     -22.661629286165
             les_mean =     514.002879454521
             stat err =       0.000540522912
             autocorr =       1.321985970151
   target nu stat err =       0.000540522912
   target dn stat err =       0.003457037168
      target stat err =       0.002874516180
              std dev =       0.664837767853
             le_variance =       0.442009257564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442051645510
                                         uncertainty =       0.002562970206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442051645510
                                         uncertainty =       0.002562970206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470111294
  error estimate for blocks of size 2^( 2) =       0.000494049351
  error estimate for blocks of size 2^( 3) =       0.000515850392
  error estimate for blocks of size 2^( 4) =       0.000531600645
  error estimate for blocks of size 2^( 5) =       0.000540242273
  error estimate for blocks of size 2^( 6) =       0.000544562733
  error estimate for blocks of size 2^( 7) =       0.000545685998

      target function =      -0.742500783728
              le_mean =     -22.661629286165
             les_mean =     514.002879454521
             stat err =       0.000540522912
             autocorr =       1.321985970148
   target nu stat err =       0.000540522912
   target dn stat err =       0.003457037168
      target stat err =       0.002874516180
              std dev =       0.664837767854
             le_variance =       0.442009257564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742500783728        initial
     8.8818e+06     8.8818e+07             2.0526e-11        -0.742500783732  <--
     3.5527e+07     3.5527e+08             5.1314e-12        -0.742500783730
     1.4211e+08     1.4211e+09             1.2829e-12        -0.742500783728

*****************************************************************************
Applying the update for shift_i =   8.8818e+06     and shift_s =   8.8818e+07
*****************************************************************************

  Execution time = 4.3803e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.6033
    reference variance = 0.387411
====================================================
  Execution time = 2.6021e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4755e-01
  Total weights = 1.955036757e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436846249611
                                         uncertainty =       0.001648543530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436846249611
                                         uncertainty =       0.001648543530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467467328
  error estimate for blocks of size 2^( 2) =       0.000490754569
  error estimate for blocks of size 2^( 3) =       0.000512951627
  error estimate for blocks of size 2^( 4) =       0.000528284384
  error estimate for blocks of size 2^( 5) =       0.000537475742
  error estimate for blocks of size 2^( 6) =       0.000543276692
  error estimate for blocks of size 2^( 7) =       0.000548478662

      target function =      -0.747332181045
              le_mean =     -22.661733134785
             les_mean =     514.001693951285
             stat err =       0.000539378870
             autocorr =       1.331328816425
   target nu stat err =       0.000539378870
   target dn stat err =       0.002597218986
      target stat err =       0.002222275257
              std dev =       0.661098635879
             le_variance =       0.437051406360


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266173313478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+06, overlap shift 2.2204e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747337879715       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747337879722       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747337879724       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747337879609       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747337880077       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747337879523       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747337882121       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747337878450       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747337881889       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747337878205       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747337874388       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+06 is 1.343790e-10

solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747337879715       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747337879716       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747337879717       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747337879717       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747337884000       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747337879484       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747337893121       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747337892127       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747337875412       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747337865899       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747337899745       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+06 is 3.359473e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747337879715       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747337879715       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747337879715       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747337879715       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747337877659       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747337877156       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747337876197       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747337921076       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747337913731       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747337853951       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747337796748       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+07 is 8.398596e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.440645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0728e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115765e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.6589
    reference variance = 0.315606
====================================================
  Execution time = 2.7262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4648e-01
  Total weights = 1.9554e+06
  Execution time = 3.6306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437477388911
                                         uncertainty =       0.001676455609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437477388911
                                         uncertainty =       0.001676455609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467700915
  error estimate for blocks of size 2^( 2) =       0.000491788047
  error estimate for blocks of size 2^( 3) =       0.000514045997
  error estimate for blocks of size 2^( 4) =       0.000529804920
  error estimate for blocks of size 2^( 5) =       0.000538791419
  error estimate for blocks of size 2^( 6) =       0.000544319726
  error estimate for blocks of size 2^( 7) =       0.000547148405

      target function =      -0.748195828473
              le_mean =     -22.660869983784
             les_mean =     513.961511531734
             stat err =       0.000540016118
             autocorr =       1.333143824748
   target nu stat err =       0.000540016118
   target dn stat err =       0.002454313289
      target stat err =       0.002111191186
              std dev =       0.661428977087
             le_variance =       0.437488291730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437477388891
                                         uncertainty =       0.001676455609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437477388891
                                         uncertainty =       0.001676455609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467700915
  error estimate for blocks of size 2^( 2) =       0.000491788047
  error estimate for blocks of size 2^( 3) =       0.000514045997
  error estimate for blocks of size 2^( 4) =       0.000529804920
  error estimate for blocks of size 2^( 5) =       0.000538791419
  error estimate for blocks of size 2^( 6) =       0.000544319726
  error estimate for blocks of size 2^( 7) =       0.000547148405

      target function =      -0.748195828441
              le_mean =     -22.660869983783
             les_mean =     513.961511531764
             stat err =       0.000540016118
             autocorr =       1.333143824790
   target nu stat err =       0.000540016118
   target dn stat err =       0.002454313292
      target stat err =       0.002111191188
              std dev =       0.661428977072
             le_variance =       0.437488291710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437477388901
                                         uncertainty =       0.001676455609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437477388901
                                         uncertainty =       0.001676455609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467700915
  error estimate for blocks of size 2^( 2) =       0.000491788047
  error estimate for blocks of size 2^( 3) =       0.000514045997
  error estimate for blocks of size 2^( 4) =       0.000529804920
  error estimate for blocks of size 2^( 5) =       0.000538791419
  error estimate for blocks of size 2^( 6) =       0.000544319726
  error estimate for blocks of size 2^( 7) =       0.000547148405

      target function =      -0.748195828457
              le_mean =     -22.660869983784
             les_mean =     513.961511531749
             stat err =       0.000540016118
             autocorr =       1.333143824777
   target nu stat err =       0.000540016118
   target dn stat err =       0.002454313291
      target stat err =       0.002111191187
              std dev =       0.661428977079
             le_variance =       0.437488291720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437477388910
                                         uncertainty =       0.001676455609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437477388910
                                         uncertainty =       0.001676455609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467700915
  error estimate for blocks of size 2^( 2) =       0.000491788047
  error estimate for blocks of size 2^( 3) =       0.000514045997
  error estimate for blocks of size 2^( 4) =       0.000529804920
  error estimate for blocks of size 2^( 5) =       0.000538791419
  error estimate for blocks of size 2^( 6) =       0.000544319726
  error estimate for blocks of size 2^( 7) =       0.000547148405

      target function =      -0.748195828471
              le_mean =     -22.660869983784
             les_mean =     513.961511531736
             stat err =       0.000540016118
             autocorr =       1.333143824749
   target nu stat err =       0.000540016118
   target dn stat err =       0.002454313289
      target stat err =       0.002111191186
              std dev =       0.661428977086
             le_variance =       0.437488291729


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748195828473        initial  <--
     2.2204e+06     2.2204e+07             1.3438e-10        -0.748195828441
     8.8818e+06     8.8818e+07             3.3595e-11        -0.748195828457
     3.5527e+07     3.5527e+08             8.3986e-12        -0.748195828471

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3614
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.7129
    reference variance = 0.23531
====================================================
  Execution time = 2.5993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4984e-01
  Total weights = 1.954751513e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441009089088
                                         uncertainty =       0.002200434201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441009089088
                                         uncertainty =       0.002200434201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469550483
  error estimate for blocks of size 2^( 2) =       0.000493678431
  error estimate for blocks of size 2^( 3) =       0.000516583626
  error estimate for blocks of size 2^( 4) =       0.000532271568
  error estimate for blocks of size 2^( 5) =       0.000540937978
  error estimate for blocks of size 2^( 6) =       0.000545654984
  error estimate for blocks of size 2^( 7) =       0.000548745398

      target function =      -0.745445071516
              le_mean =     -22.661811435379
             les_mean =     514.007538914414
             stat err =       0.000541902482
             autocorr =       1.331918639458
   target nu stat err =       0.000541902482
   target dn stat err =       0.002585461598
      target stat err =       0.002203183719
              std dev =       0.664044661495
             le_variance =       0.440955312460


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266181143538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+07, overlap shift 2.2204e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745450607138       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745450607139       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745450607139       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745450607139       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745450607143       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745450607896       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745450634362       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745450639909       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745450636866       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+07 is 6.697357e-12

solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745450607138       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745450607138       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745450607138       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745450607138       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745450607138       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745450644958       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745450459197       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745450610617       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745450403731       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+07 is 1.674328e-12

solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745450607138       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745450607138       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745450607138       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745450607138       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745450607138       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745450607141       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745450557527       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745450769298       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745450607138       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+08 is 4.185133e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.448211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0695e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.6571
    reference variance = 0.313394
====================================================
  Execution time = 2.5578e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4994e-01
  Total weights = 1.9554e+06
  Execution time = 3.6267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440384547511
                                         uncertainty =       0.002082384206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440384547511
                                         uncertainty =       0.002082384206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469211567
  error estimate for blocks of size 2^( 2) =       0.000493507378
  error estimate for blocks of size 2^( 3) =       0.000515910732
  error estimate for blocks of size 2^( 4) =       0.000533107964
  error estimate for blocks of size 2^( 5) =       0.000542243834
  error estimate for blocks of size 2^( 6) =       0.000545083382
  error estimate for blocks of size 2^( 7) =       0.000546249452

      target function =      -0.745358933269
              le_mean =     -22.661110882734
             les_mean =     513.975882041624
             stat err =       0.000541671158
             autocorr =       1.332704928834
   target nu stat err =       0.000541671158
   target dn stat err =       0.002773683427
      target stat err =       0.002349178696
              std dev =       0.663565361568
             le_variance =       0.440318989073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440384547510
                                         uncertainty =       0.002082384206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440384547510
                                         uncertainty =       0.002082384206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469211567
  error estimate for blocks of size 2^( 2) =       0.000493507378
  error estimate for blocks of size 2^( 3) =       0.000515910732
  error estimate for blocks of size 2^( 4) =       0.000533107964
  error estimate for blocks of size 2^( 5) =       0.000542243834
  error estimate for blocks of size 2^( 6) =       0.000545083382
  error estimate for blocks of size 2^( 7) =       0.000546249452

      target function =      -0.745358933268
              le_mean =     -22.661110882734
             les_mean =     513.975882041624
             stat err =       0.000541671158
             autocorr =       1.332704928838
   target nu stat err =       0.000541671158
   target dn stat err =       0.002773683428
      target stat err =       0.002349178697
              std dev =       0.663565361567
             le_variance =       0.440318989071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440384547511
                                         uncertainty =       0.002082384206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440384547511
                                         uncertainty =       0.002082384206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469211567
  error estimate for blocks of size 2^( 2) =       0.000493507378
  error estimate for blocks of size 2^( 3) =       0.000515910732
  error estimate for blocks of size 2^( 4) =       0.000533107964
  error estimate for blocks of size 2^( 5) =       0.000542243834
  error estimate for blocks of size 2^( 6) =       0.000545083382
  error estimate for blocks of size 2^( 7) =       0.000546249452

      target function =      -0.745358933269
              le_mean =     -22.661110882734
             les_mean =     513.975882041624
             stat err =       0.000541671158
             autocorr =       1.332704928837
   target nu stat err =       0.000541671158
   target dn stat err =       0.002773683428
      target stat err =       0.002349178696
              std dev =       0.663565361567
             le_variance =       0.440318989072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440384547511
                                         uncertainty =       0.002082384206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440384547511
                                         uncertainty =       0.002082384206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469211567
  error estimate for blocks of size 2^( 2) =       0.000493507378
  error estimate for blocks of size 2^( 3) =       0.000515910732
  error estimate for blocks of size 2^( 4) =       0.000533107964
  error estimate for blocks of size 2^( 5) =       0.000542243834
  error estimate for blocks of size 2^( 6) =       0.000545083382
  error estimate for blocks of size 2^( 7) =       0.000546249452

      target function =      -0.745358933269
              le_mean =     -22.661110882734
             les_mean =     513.975882041624
             stat err =       0.000541671158
             autocorr =       1.332704928835
   target nu stat err =       0.000541671158
   target dn stat err =       0.002773683428
      target stat err =       0.002349178696
              std dev =       0.663565361568
             le_variance =       0.440318989072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745358933269        initial  <--
     2.2204e+07     2.2204e+08             6.6974e-12        -0.745358933268
     8.8818e+07     8.8818e+08             1.6743e-12        -0.745358933269
     3.5527e+08     3.5527e+09             4.1851e-13        -0.745358933269

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8204
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.6199
    reference variance = 0.361282
====================================================
  Execution time = 2.6239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5150e-01
  Total weights = 1.955041452e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442934117869
                                         uncertainty =       0.003898568428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442934117869
                                         uncertainty =       0.003898568428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470590744
  error estimate for blocks of size 2^( 2) =       0.000495038587
  error estimate for blocks of size 2^( 3) =       0.000517271148
  error estimate for blocks of size 2^( 4) =       0.000533157837
  error estimate for blocks of size 2^( 5) =       0.000542587381
  error estimate for blocks of size 2^( 6) =       0.000545690531
  error estimate for blocks of size 2^( 7) =       0.000550442402

      target function =      -0.744071670954
              le_mean =     -22.662153173939
             les_mean =     514.024690133168
             stat err =       0.000542969538
             autocorr =       1.331263939405
   target nu stat err =       0.000542969538
   target dn stat err =       0.004885714395
      target stat err =       0.004039576945
              std dev =       0.665515812688
             le_variance =       0.442911296938


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266215317394e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744092410502       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744092410502       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744092410502       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744092410502       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744092410444       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744092432535       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744092186784       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744092504632       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744092227812       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744092707789       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744092466228       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744092503309       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+08 is 1.048218e-12

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744092410502       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744092410502       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744092410502       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744092410502       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744092410487       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744092507221       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744093049171       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744092444755       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744092399347       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744095389729       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744095163094       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744091179973       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+08 is 2.620777e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744092410502       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744092410502       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744092410502       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744092410502       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744092410502       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744092410139       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744092539302       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744088170829       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744096931275       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744085132455       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744092249149       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744100641620       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+09 is 6.550651e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.458263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0956e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.6988
    reference variance = 0.551299
====================================================
  Execution time = 2.5685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5946e-01
  Total weights = 1.9553e+06
  Execution time = 3.6245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446616113652
                                         uncertainty =       0.003431046576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446616113652
                                         uncertainty =       0.003431046576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472566804
  error estimate for blocks of size 2^( 2) =       0.000496552054
  error estimate for blocks of size 2^( 3) =       0.000518203088
  error estimate for blocks of size 2^( 4) =       0.000534480681
  error estimate for blocks of size 2^( 5) =       0.000544418768
  error estimate for blocks of size 2^( 6) =       0.000547646235
  error estimate for blocks of size 2^( 7) =       0.000547897667

      target function =      -0.737627027380
              le_mean =     -22.662071884905
             les_mean =     514.028957708406
             stat err =       0.000543610838
             autocorr =       1.323274037855
   target nu stat err =       0.000543610838
   target dn stat err =       0.004711824004
      target stat err =       0.003832174620
              std dev =       0.668310383103
             le_variance =       0.446638768163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446616113652
                                         uncertainty =       0.003431046576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446616113652
                                         uncertainty =       0.003431046576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472566804
  error estimate for blocks of size 2^( 2) =       0.000496552054
  error estimate for blocks of size 2^( 3) =       0.000518203088
  error estimate for blocks of size 2^( 4) =       0.000534480681
  error estimate for blocks of size 2^( 5) =       0.000544418768
  error estimate for blocks of size 2^( 6) =       0.000547646235
  error estimate for blocks of size 2^( 7) =       0.000547897667

      target function =      -0.737627027379
              le_mean =     -22.662071884905
             les_mean =     514.028957708406
             stat err =       0.000543610838
             autocorr =       1.323274037860
   target nu stat err =       0.000543610838
   target dn stat err =       0.004711824004
      target stat err =       0.003832174621
              std dev =       0.668310383103
             le_variance =       0.446638768163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446616113652
                                         uncertainty =       0.003431046576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446616113652
                                         uncertainty =       0.003431046576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472566804
  error estimate for blocks of size 2^( 2) =       0.000496552054
  error estimate for blocks of size 2^( 3) =       0.000518203088
  error estimate for blocks of size 2^( 4) =       0.000534480681
  error estimate for blocks of size 2^( 5) =       0.000544418768
  error estimate for blocks of size 2^( 6) =       0.000547646235
  error estimate for blocks of size 2^( 7) =       0.000547897667

      target function =      -0.737627027380
              le_mean =     -22.662071884905
             les_mean =     514.028957708406
             stat err =       0.000543610838
             autocorr =       1.323274037861
   target nu stat err =       0.000543610838
   target dn stat err =       0.004711824004
      target stat err =       0.003832174621
              std dev =       0.668310383103
             le_variance =       0.446638768163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446616113652
                                         uncertainty =       0.003431046576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446616113652
                                         uncertainty =       0.003431046576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472566804
  error estimate for blocks of size 2^( 2) =       0.000496552054
  error estimate for blocks of size 2^( 3) =       0.000518203088
  error estimate for blocks of size 2^( 4) =       0.000534480681
  error estimate for blocks of size 2^( 5) =       0.000544418768
  error estimate for blocks of size 2^( 6) =       0.000547646235
  error estimate for blocks of size 2^( 7) =       0.000547897667

      target function =      -0.737627027380
              le_mean =     -22.662071884905
             les_mean =     514.028957708406
             stat err =       0.000543610838
             autocorr =       1.323274037856
   target nu stat err =       0.000543610838
   target dn stat err =       0.004711824004
      target stat err =       0.003832174621
              std dev =       0.668310383103
             le_variance =       0.446638768163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737627027380        initial  <--
     2.2204e+08     2.2204e+09             1.0482e-12        -0.737627027379
     8.8818e+08     8.8818e+09             2.6208e-13        -0.737627027380
     3.5527e+09     3.5527e+10             6.5507e-14        -0.737627027380

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7791
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6502
    reference variance = 0.6009
====================================================
  Execution time = 2.6142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4958e-01
  Total weights = 1.955159231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441228404280
                                         uncertainty =       0.002128404890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441228404280
                                         uncertainty =       0.002128404890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469684961
  error estimate for blocks of size 2^( 2) =       0.000494225399
  error estimate for blocks of size 2^( 3) =       0.000516582738
  error estimate for blocks of size 2^( 4) =       0.000532512575
  error estimate for blocks of size 2^( 5) =       0.000540999872
  error estimate for blocks of size 2^( 6) =       0.000545973991
  error estimate for blocks of size 2^( 7) =       0.000547459838

      target function =      -0.745652468480
              le_mean =     -22.661161280689
             les_mean =     513.977809189858
             stat err =       0.000541736569
             autocorr =       1.330341064284
   target nu stat err =       0.000541736569
   target dn stat err =       0.002715702350
      target stat err =       0.002305200319
              std dev =       0.664234841827
             le_variance =       0.441207925097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266116128069e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745658582484       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745658582484       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745658582484       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745658582484       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745658582484       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745658582484       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745658582484       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745658582484       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745658582484       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745658582484       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745658582484       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+09 is 8.344879e-14

solving harmonic davidson linear method for identity shift 8.8818e+09, overlap shift 8.8818e+10 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745658582484       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745658582484       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745658582484       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745658582484       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745658582484       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745658582484       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745658582484       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745658582484       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745658582484       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745662817455       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745658582484       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+09 is 2.085594e-14

solving harmonic davidson linear method for identity shift 3.5527e+10, overlap shift 3.5527e+11 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745658582484       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745658582484       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745658582484       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745658582484       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745658582484       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745658582484       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745658582484       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745658582484       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745658582484       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745658582484       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745700800961       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745574132606       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745674606946       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745647884910       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745815368346       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745666240970       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745589043498       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745422586631       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745562217605       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746032665079       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745767441984       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745808037191       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745604457859       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745676056388       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745998849005       residual = 3.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749025577454       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746077955024       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744735685480       residual = 7.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.698692574749       residual = 3.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.720830148414       residual = 1.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.794548381932       residual = 2.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.752940441526       residual = 6.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.858298805297       residual = 2.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.721459712912       residual = 4.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       3.426734106555       residual = 3.68e+05           smallest_sin_value = 1.00e+00
davidson iteration   35 stopping due to too large eigenvalue change
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+10 is 5.428966e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.481450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0877e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.5975
    reference variance = 0.512224
====================================================
  Execution time = 2.5885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5120e-01
  Total weights = 1.9549e+06
  Execution time = 3.6435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440131900694
                                         uncertainty =       0.002573875352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440131900694
                                         uncertainty =       0.002573875352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469091352
  error estimate for blocks of size 2^( 2) =       0.000492854787
  error estimate for blocks of size 2^( 3) =       0.000515515229
  error estimate for blocks of size 2^( 4) =       0.000530990069
  error estimate for blocks of size 2^( 5) =       0.000540639596
  error estimate for blocks of size 2^( 6) =       0.000546011947
  error estimate for blocks of size 2^( 7) =       0.000549254741

      target function =      -0.744323718747
              le_mean =     -22.661752077295
             les_mean =     514.006212112238
             stat err =       0.000541724088
             autocorr =       1.333648685293
   target nu stat err =       0.000541724088
   target dn stat err =       0.003308720007
      target stat err =       0.002770561119
              std dev =       0.663395352132
             le_variance =       0.440093393231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440131900694
                                         uncertainty =       0.002573875352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440131900694
                                         uncertainty =       0.002573875352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469091352
  error estimate for blocks of size 2^( 2) =       0.000492854787
  error estimate for blocks of size 2^( 3) =       0.000515515229
  error estimate for blocks of size 2^( 4) =       0.000530990069
  error estimate for blocks of size 2^( 5) =       0.000540639596
  error estimate for blocks of size 2^( 6) =       0.000546011947
  error estimate for blocks of size 2^( 7) =       0.000549254741

      target function =      -0.744323718747
              le_mean =     -22.661752077295
             les_mean =     514.006212112238
             stat err =       0.000541724088
             autocorr =       1.333648685294
   target nu stat err =       0.000541724088
   target dn stat err =       0.003308720007
      target stat err =       0.002770561119
              std dev =       0.663395352132
             le_variance =       0.440093393231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440131900694
                                         uncertainty =       0.002573875352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440131900694
                                         uncertainty =       0.002573875352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469091352
  error estimate for blocks of size 2^( 2) =       0.000492854787
  error estimate for blocks of size 2^( 3) =       0.000515515229
  error estimate for blocks of size 2^( 4) =       0.000530990069
  error estimate for blocks of size 2^( 5) =       0.000540639596
  error estimate for blocks of size 2^( 6) =       0.000546011947
  error estimate for blocks of size 2^( 7) =       0.000549254741

      target function =      -0.744323718747
              le_mean =     -22.661752077295
             les_mean =     514.006212112238
             stat err =       0.000541724088
             autocorr =       1.333648685297
   target nu stat err =       0.000541724088
   target dn stat err =       0.003308720007
      target stat err =       0.002770561119
              std dev =       0.663395352132
             le_variance =       0.440093393231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440131900694
                                         uncertainty =       0.002573875352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440131900694
                                         uncertainty =       0.002573875352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469091352
  error estimate for blocks of size 2^( 2) =       0.000492854787
  error estimate for blocks of size 2^( 3) =       0.000515515229
  error estimate for blocks of size 2^( 4) =       0.000530990069
  error estimate for blocks of size 2^( 5) =       0.000540639596
  error estimate for blocks of size 2^( 6) =       0.000546011947
  error estimate for blocks of size 2^( 7) =       0.000549254741

      target function =      -0.744323718747
              le_mean =     -22.661752077295
             les_mean =     514.006212112238
             stat err =       0.000541724088
             autocorr =       1.333648685301
   target nu stat err =       0.000541724088
   target dn stat err =       0.003308720007
      target stat err =       0.002770561119
              std dev =       0.663395352132
             le_variance =       0.440093393231


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744323718747        initial
     2.2204e+09     2.2204e+10             8.3449e-14        -0.744323718747  <--
     8.8818e+09     8.8818e+10             2.0856e-14        -0.744323718747
     3.5527e+10     3.5527e+11             5.4290e-15        -0.744323718747

*****************************************************************************
Applying the update for shift_i =   2.2204e+09     and shift_s =   2.2204e+10
*****************************************************************************

  Execution time = 4.4047e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4930e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.6124
    reference variance = 0.748487
====================================================
  Execution time = 2.6029e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5596e-01
  Total weights = 1.955241669e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442355928370
                                         uncertainty =       0.001877192080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442355928370
                                         uncertainty =       0.001877192080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470406960
  error estimate for blocks of size 2^( 2) =       0.000494181832
  error estimate for blocks of size 2^( 3) =       0.000516730393
  error estimate for blocks of size 2^( 4) =       0.000533239606
  error estimate for blocks of size 2^( 5) =       0.000542866581
  error estimate for blocks of size 2^( 6) =       0.000547161375
  error estimate for blocks of size 2^( 7) =       0.000550456209

      target function =      -0.740458730515
              le_mean =     -22.661985620327
             les_mean =     514.021548332496
             stat err =       0.000543430943
             autocorr =       1.334569663554
   target nu stat err =       0.000543430943
   target dn stat err =       0.003418791515
      target stat err =       0.002830942115
              std dev =       0.665255902888
             le_variance =       0.442565416327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266198562033e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740468583694       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740468583694       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740468583694       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740468583694       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740468589886       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740468583694       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740468583694       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740468583694       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740468583694       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740468769722       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740468029674       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740467588929       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+08 is 4.686353e-13

solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740468583694       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740468583694       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740468583694       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740468553224       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740469029054       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740468583694       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740468583694       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740474641330       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740468583694       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740468583694       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740475883372       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740474552027       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+09 is 1.171244e-13

solving harmonic davidson linear method for identity shift 8.8818e+09, overlap shift 8.8818e+10 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740468583694       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740468583694       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740468583694       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740468583694       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740468583694       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740468194761       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740467699560       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740468583694       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740451925826       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740451030997       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740468583694       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740448046954       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740431952245       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740489442863       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+09 is 2.929893e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.486840 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0756e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.7022
    reference variance = 0.399317
====================================================
  Execution time = 2.7218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5483e-01
  Total weights = 1.9551e+06
  Execution time = 3.6189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442461809054
                                         uncertainty =       0.002623117010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442461809054
                                         uncertainty =       0.002623117010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470396773
  error estimate for blocks of size 2^( 2) =       0.000494770772
  error estimate for blocks of size 2^( 3) =       0.000517289405
  error estimate for blocks of size 2^( 4) =       0.000533721231
  error estimate for blocks of size 2^( 5) =       0.000543294192
  error estimate for blocks of size 2^( 6) =       0.000547525034
  error estimate for blocks of size 2^( 7) =       0.000547799010

      target function =      -0.741365773560
              le_mean =     -22.661929951935
             les_mean =     514.017902648686
             stat err =       0.000543084867
             autocorr =       1.332928138463
   target nu stat err =       0.000543084867
   target dn stat err =       0.003837578458
      target stat err =       0.003170541473
              std dev =       0.665241495371
             le_variance =       0.442546247164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442461809054
                                         uncertainty =       0.002623117010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442461809054
                                         uncertainty =       0.002623117010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470396773
  error estimate for blocks of size 2^( 2) =       0.000494770772
  error estimate for blocks of size 2^( 3) =       0.000517289405
  error estimate for blocks of size 2^( 4) =       0.000533721231
  error estimate for blocks of size 2^( 5) =       0.000543294192
  error estimate for blocks of size 2^( 6) =       0.000547525034
  error estimate for blocks of size 2^( 7) =       0.000547799010

      target function =      -0.741365773560
              le_mean =     -22.661929951935
             les_mean =     514.017902648686
             stat err =       0.000543084867
             autocorr =       1.332928138461
   target nu stat err =       0.000543084867
   target dn stat err =       0.003837578458
      target stat err =       0.003170541473
              std dev =       0.665241495371
             le_variance =       0.442546247164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442461809054
                                         uncertainty =       0.002623117010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442461809054
                                         uncertainty =       0.002623117010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470396773
  error estimate for blocks of size 2^( 2) =       0.000494770772
  error estimate for blocks of size 2^( 3) =       0.000517289405
  error estimate for blocks of size 2^( 4) =       0.000533721231
  error estimate for blocks of size 2^( 5) =       0.000543294192
  error estimate for blocks of size 2^( 6) =       0.000547525034
  error estimate for blocks of size 2^( 7) =       0.000547799010

      target function =      -0.741365773560
              le_mean =     -22.661929951935
             les_mean =     514.017902648686
             stat err =       0.000543084867
             autocorr =       1.332928138463
   target nu stat err =       0.000543084867
   target dn stat err =       0.003837578458
      target stat err =       0.003170541473
              std dev =       0.665241495371
             le_variance =       0.442546247164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442461809054
                                         uncertainty =       0.002623117010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442461809054
                                         uncertainty =       0.002623117010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470396773
  error estimate for blocks of size 2^( 2) =       0.000494770772
  error estimate for blocks of size 2^( 3) =       0.000517289405
  error estimate for blocks of size 2^( 4) =       0.000533721231
  error estimate for blocks of size 2^( 5) =       0.000543294192
  error estimate for blocks of size 2^( 6) =       0.000547525034
  error estimate for blocks of size 2^( 7) =       0.000547799010

      target function =      -0.741365773560
              le_mean =     -22.661929951935
             les_mean =     514.017902648686
             stat err =       0.000543084867
             autocorr =       1.332928138462
   target nu stat err =       0.000543084867
   target dn stat err =       0.003837578458
      target stat err =       0.003170541473
              std dev =       0.665241495371
             le_variance =       0.442546247164


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741365773560        initial
     5.5511e+08     5.5511e+09             4.6864e-13        -0.741365773560  <--
     2.2204e+09     2.2204e+10             1.1712e-13        -0.741365773560
     8.8818e+09     8.8818e+10             2.9299e-14        -0.741365773560

*****************************************************************************
Applying the update for shift_i =   5.5511e+08     and shift_s =   5.5511e+09
*****************************************************************************

  Execution time = 4.5273e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.7095
    reference variance = 0.550696
====================================================
  Execution time = 2.5997e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5166e-01
  Total weights = 1.955016227e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442283412216
                                         uncertainty =       0.002489213795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442283412216
                                         uncertainty =       0.002489213795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470265753
  error estimate for blocks of size 2^( 2) =       0.000494571154
  error estimate for blocks of size 2^( 3) =       0.000517182135
  error estimate for blocks of size 2^( 4) =       0.000532685446
  error estimate for blocks of size 2^( 5) =       0.000541864382
  error estimate for blocks of size 2^( 6) =       0.000546838128
  error estimate for blocks of size 2^( 7) =       0.000549178311

      target function =      -0.743942731760
              le_mean =     -22.661027040429
             les_mean =     513.973810776040
             stat err =       0.000542641566
             autocorr =       1.331494602065
   target nu stat err =       0.000542641566
   target dn stat err =       0.003128377293
      target stat err =       0.002621510688
              std dev =       0.665056206030
             le_variance =       0.442299757179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266102704043e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743950919776       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743950919776       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743950919776       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743950919776       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743950956713       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743950945154       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743950921294       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743950734637       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743950901448       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743950603943       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743951006313       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+08 is 1.209105e-12

solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743950919776       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743950919776       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743950919776       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743950907984       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743951173671       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743950863614       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743950919776       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743950777187       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743950919776       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743950699275       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743951185461       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+08 is 3.021853e-13

solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743950919776       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743950919776       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743950919776       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743950926872       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743950836019       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743952307087       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743949030710       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743952525291       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743953756430       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743958005799       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743949954814       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+09 is 7.546386e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.491045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0754e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.6944
    reference variance = 0.362907
====================================================
  Execution time = 2.5327e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4967e-01
  Total weights = 1.9551e+06
  Execution time = 3.6458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438442133766
                                         uncertainty =       0.002225847038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438442133766
                                         uncertainty =       0.002225847038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468171765
  error estimate for blocks of size 2^( 2) =       0.000491644522
  error estimate for blocks of size 2^( 3) =       0.000513854237
  error estimate for blocks of size 2^( 4) =       0.000529719315
  error estimate for blocks of size 2^( 5) =       0.000538643449
  error estimate for blocks of size 2^( 6) =       0.000545130131
  error estimate for blocks of size 2^( 7) =       0.000547775176

      target function =      -0.745573136916
              le_mean =     -22.660770058747
             les_mean =     513.960166798750
             stat err =       0.000540317018
             autocorr =       1.331946729071
   target nu stat err =       0.000540317018
   target dn stat err =       0.003050334413
      target stat err =       0.002568886429
              std dev =       0.662094859887
             le_variance =       0.438369603489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438442133765
                                         uncertainty =       0.002225847038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438442133765
                                         uncertainty =       0.002225847038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468171765
  error estimate for blocks of size 2^( 2) =       0.000491644522
  error estimate for blocks of size 2^( 3) =       0.000513854237
  error estimate for blocks of size 2^( 4) =       0.000529719315
  error estimate for blocks of size 2^( 5) =       0.000538643449
  error estimate for blocks of size 2^( 6) =       0.000545130131
  error estimate for blocks of size 2^( 7) =       0.000547775176

      target function =      -0.745573136920
              le_mean =     -22.660770058747
             les_mean =     513.960166798746
             stat err =       0.000540317018
             autocorr =       1.331946729073
   target nu stat err =       0.000540317018
   target dn stat err =       0.003050334413
      target stat err =       0.002568886429
              std dev =       0.662094859887
             le_variance =       0.438369603489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438442133766
                                         uncertainty =       0.002225847038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438442133766
                                         uncertainty =       0.002225847038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468171765
  error estimate for blocks of size 2^( 2) =       0.000491644522
  error estimate for blocks of size 2^( 3) =       0.000513854237
  error estimate for blocks of size 2^( 4) =       0.000529719315
  error estimate for blocks of size 2^( 5) =       0.000538643449
  error estimate for blocks of size 2^( 6) =       0.000545130131
  error estimate for blocks of size 2^( 7) =       0.000547775176

      target function =      -0.745573136918
              le_mean =     -22.660770058747
             les_mean =     513.960166798748
             stat err =       0.000540317018
             autocorr =       1.331946729089
   target nu stat err =       0.000540317018
   target dn stat err =       0.003050334413
      target stat err =       0.002568886429
              std dev =       0.662094859887
             le_variance =       0.438369603489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438442133766
                                         uncertainty =       0.002225847038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438442133766
                                         uncertainty =       0.002225847038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468171765
  error estimate for blocks of size 2^( 2) =       0.000491644522
  error estimate for blocks of size 2^( 3) =       0.000513854237
  error estimate for blocks of size 2^( 4) =       0.000529719315
  error estimate for blocks of size 2^( 5) =       0.000538643449
  error estimate for blocks of size 2^( 6) =       0.000545130131
  error estimate for blocks of size 2^( 7) =       0.000547775176

      target function =      -0.745573136917
              le_mean =     -22.660770058747
             les_mean =     513.960166798750
             stat err =       0.000540317018
             autocorr =       1.331946729072
   target nu stat err =       0.000540317018
   target dn stat err =       0.003050334413
      target stat err =       0.002568886429
              std dev =       0.662094859887
             le_variance =       0.438369603489


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745573136916        initial
     1.3878e+08     1.3878e+09             1.2091e-12        -0.745573136920  <--
     5.5511e+08     5.5511e+09             3.0219e-13        -0.745573136918
     2.2204e+09     2.2204e+10             7.5464e-14        -0.745573136917

*****************************************************************************
Applying the update for shift_i =   1.3878e+08     and shift_s =   1.3878e+09
*****************************************************************************

  Execution time = 4.3506e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4267e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.7238
    reference variance = 1.00483
====================================================
  Execution time = 2.5986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2660e+01
  VMC Evar = 4.4629e-01
  Total weights = 1.955040065e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438533461771
                                         uncertainty =       0.001957603341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438533461771
                                         uncertainty =       0.001957603341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468335047
  error estimate for blocks of size 2^( 2) =       0.000492335468
  error estimate for blocks of size 2^( 3) =       0.000514914166
  error estimate for blocks of size 2^( 4) =       0.000530888161
  error estimate for blocks of size 2^( 5) =       0.000540764150
  error estimate for blocks of size 2^( 6) =       0.000547531232
  error estimate for blocks of size 2^( 7) =       0.000549967159

      target function =      -0.748346845576
              le_mean =     -22.660398390281
             les_mean =     513.939945256474
             stat err =       0.000542287675
             autocorr =       1.340744894896
   target nu stat err =       0.000542287675
   target dn stat err =       0.002499504150
      target stat err =       0.002147033593
              std dev =       0.662325774696
             le_variance =       0.438675431826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266039839028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748352044960       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748352044960       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748352044960       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748352044961       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748352044959       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748352066017       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748351964680       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748351954257       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748352115003       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748351993035       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748352008488       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+07 is 5.175505e-12

solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748352044960       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748352044960       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748352044960       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748352044960       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748351987145       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748352050284       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748352149497       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748351890898       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748352373205       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748352366851       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748352228870       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+08 is 1.294037e-12

solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748352044960       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748352044960       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748352044960       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748352044960       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748352085085       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748352081187       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748352073757       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748351637182       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748354212925       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748353962124       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748352690058       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+08 is 3.231767e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.495263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0710e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115769e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.5991
    reference variance = 0.315909
====================================================
  Execution time = 2.5386e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4984e-01
  Total weights = 1.9550e+06
  Execution time = 3.6426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440575409783
                                         uncertainty =       0.002252325803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440575409783
                                         uncertainty =       0.002252325803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469375403
  error estimate for blocks of size 2^( 2) =       0.000493732993
  error estimate for blocks of size 2^( 3) =       0.000515644048
  error estimate for blocks of size 2^( 4) =       0.000531639973
  error estimate for blocks of size 2^( 5) =       0.000540633324
  error estimate for blocks of size 2^( 6) =       0.000545771783
  error estimate for blocks of size 2^( 7) =       0.000547614930

      target function =      -0.745447931274
              le_mean =     -22.661679208771
             les_mean =     514.001539865542
             stat err =       0.000541415002
             autocorr =       1.330515437246
   target nu stat err =       0.000541415002
   target dn stat err =       0.002705132307
      target stat err =       0.002297274202
              std dev =       0.663797060244
             le_variance =       0.440626537189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440575409782
                                         uncertainty =       0.002252325803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440575409782
                                         uncertainty =       0.002252325803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469375403
  error estimate for blocks of size 2^( 2) =       0.000493732993
  error estimate for blocks of size 2^( 3) =       0.000515644048
  error estimate for blocks of size 2^( 4) =       0.000531639973
  error estimate for blocks of size 2^( 5) =       0.000540633324
  error estimate for blocks of size 2^( 6) =       0.000545771783
  error estimate for blocks of size 2^( 7) =       0.000547614930

      target function =      -0.745447931287
              le_mean =     -22.661679208771
             les_mean =     514.001539865528
             stat err =       0.000541415002
             autocorr =       1.330515437264
   target nu stat err =       0.000541415002
   target dn stat err =       0.002705132306
      target stat err =       0.002297274201
              std dev =       0.663797060243
             le_variance =       0.440626537188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440575409782
                                         uncertainty =       0.002252325803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440575409782
                                         uncertainty =       0.002252325803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469375403
  error estimate for blocks of size 2^( 2) =       0.000493732993
  error estimate for blocks of size 2^( 3) =       0.000515644048
  error estimate for blocks of size 2^( 4) =       0.000531639973
  error estimate for blocks of size 2^( 5) =       0.000540633324
  error estimate for blocks of size 2^( 6) =       0.000545771783
  error estimate for blocks of size 2^( 7) =       0.000547614930

      target function =      -0.745447931280
              le_mean =     -22.661679208771
             les_mean =     514.001539865535
             stat err =       0.000541415002
             autocorr =       1.330515437255
   target nu stat err =       0.000541415002
   target dn stat err =       0.002705132307
      target stat err =       0.002297274202
              std dev =       0.663797060244
             le_variance =       0.440626537188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440575409783
                                         uncertainty =       0.002252325803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440575409783
                                         uncertainty =       0.002252325803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469375403
  error estimate for blocks of size 2^( 2) =       0.000493732993
  error estimate for blocks of size 2^( 3) =       0.000515644048
  error estimate for blocks of size 2^( 4) =       0.000531639973
  error estimate for blocks of size 2^( 5) =       0.000540633324
  error estimate for blocks of size 2^( 6) =       0.000545771783
  error estimate for blocks of size 2^( 7) =       0.000547614930

      target function =      -0.745447931275
              le_mean =     -22.661679208771
             les_mean =     514.001539865541
             stat err =       0.000541415002
             autocorr =       1.330515437246
   target nu stat err =       0.000541415002
   target dn stat err =       0.002705132307
      target stat err =       0.002297274202
              std dev =       0.663797060244
             le_variance =       0.440626537189


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745447931274        initial
     3.4694e+07     3.4694e+08             5.1755e-12        -0.745447931287  <--
     1.3878e+08     1.3878e+09             1.2940e-12        -0.745447931280
     5.5511e+08     5.5511e+09             3.2318e-13        -0.745447931275

*****************************************************************************
Applying the update for shift_i =   3.4694e+07     and shift_s =   3.4694e+08
*****************************************************************************

  Execution time = 4.3537e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115770e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.7044
    reference variance = 0.433029
====================================================
  Execution time = 2.6325e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5066e-01
  Total weights = 1.955578668e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438532045998
                                         uncertainty =       0.002139322095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438532045998
                                         uncertainty =       0.002139322095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468267532
  error estimate for blocks of size 2^( 2) =       0.000492216160
  error estimate for blocks of size 2^( 3) =       0.000514066371
  error estimate for blocks of size 2^( 4) =       0.000530526780
  error estimate for blocks of size 2^( 5) =       0.000540475103
  error estimate for blocks of size 2^( 6) =       0.000547480553
  error estimate for blocks of size 2^( 7) =       0.000548481677

      target function =      -0.744766715839
              le_mean =     -22.661795473157
             les_mean =     514.007637176661
             stat err =       0.000541741028
             autocorr =       1.338429074366
   target nu stat err =       0.000541741028
   target dn stat err =       0.003444094418
      target stat err =       0.002882329649
              std dev =       0.662230294778
             le_variance =       0.438548963322


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266179547316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744776959989       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744776959992       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744776959992       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744776959992       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744776959992       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744776958499       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744776959993       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744776958391       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744776951380       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744776949258       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744776928073       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+06 is 6.486115e-11

solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744776959989       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744776959990       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744776959990       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744776959990       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744776959992       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744776959197       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744776965740       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744776980270       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744776881130       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744776913630       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744776983812       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+07 is 1.621520e-11

solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744776959989       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744776959990       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744776959990       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744776959990       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744776959989       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744777047627       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744776906131       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744776878206       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744776729471       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744776926906       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744777019720       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+08 is 4.053788e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.499496 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1054e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115768e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.756
    reference variance = 0.291634
====================================================
  Execution time = 2.5516e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4881e-01
  Total weights = 1.9548e+06
  Execution time = 3.6291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439199246318
                                         uncertainty =       0.002347019757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439199246318
                                         uncertainty =       0.002347019757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468563442
  error estimate for blocks of size 2^( 2) =       0.000492688478
  error estimate for blocks of size 2^( 3) =       0.000514703889
  error estimate for blocks of size 2^( 4) =       0.000530855246
  error estimate for blocks of size 2^( 5) =       0.000539941555
  error estimate for blocks of size 2^( 6) =       0.000545125508
  error estimate for blocks of size 2^( 7) =       0.000546404883

      target function =      -0.746283220226
              le_mean =     -22.660888107163
             les_mean =     513.964654979295
             stat err =       0.000540581798
             autocorr =       1.331024454342
   target nu stat err =       0.000540581798
   target dn stat err =       0.002761922575
      target stat err =       0.002344403052
              std dev =       0.662648774416
             le_variance =       0.439103398235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439199246315
                                         uncertainty =       0.002347019757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439199246315
                                         uncertainty =       0.002347019757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468563442
  error estimate for blocks of size 2^( 2) =       0.000492688478
  error estimate for blocks of size 2^( 3) =       0.000514703889
  error estimate for blocks of size 2^( 4) =       0.000530855246
  error estimate for blocks of size 2^( 5) =       0.000539941555
  error estimate for blocks of size 2^( 6) =       0.000545125508
  error estimate for blocks of size 2^( 7) =       0.000546404883

      target function =      -0.746283220249
              le_mean =     -22.660888107162
             les_mean =     513.964654979260
             stat err =       0.000540581798
             autocorr =       1.331024454359
   target nu stat err =       0.000540581798
   target dn stat err =       0.002761922566
      target stat err =       0.002344403045
              std dev =       0.662648774414
             le_variance =       0.439103398233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439199246316
                                         uncertainty =       0.002347019757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439199246316
                                         uncertainty =       0.002347019757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468563442
  error estimate for blocks of size 2^( 2) =       0.000492688478
  error estimate for blocks of size 2^( 3) =       0.000514703889
  error estimate for blocks of size 2^( 4) =       0.000530855246
  error estimate for blocks of size 2^( 5) =       0.000539941555
  error estimate for blocks of size 2^( 6) =       0.000545125508
  error estimate for blocks of size 2^( 7) =       0.000546404883

      target function =      -0.746283220238
              le_mean =     -22.660888107163
             les_mean =     513.964654979278
             stat err =       0.000540581798
             autocorr =       1.331024454358
   target nu stat err =       0.000540581798
   target dn stat err =       0.002761922570
      target stat err =       0.002344403048
              std dev =       0.662648774415
             le_variance =       0.439103398234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439199246317
                                         uncertainty =       0.002347019757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439199246317
                                         uncertainty =       0.002347019757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468563442
  error estimate for blocks of size 2^( 2) =       0.000492688478
  error estimate for blocks of size 2^( 3) =       0.000514703889
  error estimate for blocks of size 2^( 4) =       0.000530855246
  error estimate for blocks of size 2^( 5) =       0.000539941555
  error estimate for blocks of size 2^( 6) =       0.000545125508
  error estimate for blocks of size 2^( 7) =       0.000546404883

      target function =      -0.746283220227
              le_mean =     -22.660888107163
             les_mean =     513.964654979293
             stat err =       0.000540581798
             autocorr =       1.331024454344
   target nu stat err =       0.000540581798
   target dn stat err =       0.002761922575
      target stat err =       0.002344403052
              std dev =       0.662648774416
             le_variance =       0.439103398235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746283220226        initial
     8.6736e+06     8.6736e+07             6.4861e-11        -0.746283220249  <--
     3.4694e+07     3.4694e+08             1.6215e-11        -0.746283220238
     1.3878e+08     1.3878e+09             4.0538e-12        -0.746283220227

*****************************************************************************
Applying the update for shift_i =   8.6736e+06     and shift_s =   8.6736e+07
*****************************************************************************

  Execution time = 4.3628e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115763e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4689e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.6354
    reference variance = 0.316744
====================================================
  Execution time = 2.6313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5487e-01
  Total weights = 1.955154908e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439841110863
                                         uncertainty =       0.002206980986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439841110863
                                         uncertainty =       0.002206980986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468924033
  error estimate for blocks of size 2^( 2) =       0.000492748220
  error estimate for blocks of size 2^( 3) =       0.000515175668
  error estimate for blocks of size 2^( 4) =       0.000530764080
  error estimate for blocks of size 2^( 5) =       0.000540917257
  error estimate for blocks of size 2^( 6) =       0.000546792744
  error estimate for blocks of size 2^( 7) =       0.000550798901

      target function =      -0.741312736102
              le_mean =     -22.662232046352
             les_mean =     514.031629461959
             stat err =       0.000542318245
             autocorr =       1.337529742431
   target nu stat err =       0.000542318245
   target dn stat err =       0.006644277439
      target stat err =       0.005426450760
              std dev =       0.663158727490
             le_variance =       0.439779497846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266223204635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741351510434       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741351510445       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741351510446       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741351510446       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741351510451       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741351511298       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741351513603       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741351509718       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741351508524       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741351506156       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+06 is 1.052919e-10

solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741351510434       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741351510436       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741351510437       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741351510437       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741351506336       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741351527031       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741351507775       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741351508622       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741351506166       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741351514533       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+06 is 2.632292e-11

solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741351510434       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741351510434       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741351510434       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741351510435       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741351510526       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741351507292       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741351572583       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741351445575       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741351535185       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741351461348       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+07 is 6.580694e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.503146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1044e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337424e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953529e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292976e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115762e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.723
    reference variance = 0.562299
====================================================
  Execution time = 2.7354e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2660e+01
  VMC Evar = 4.4901e-01
  Total weights = 1.9549e+06
  Execution time = 3.6243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440720605032
                                         uncertainty =       0.002039913785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440720605032
                                         uncertainty =       0.002039913785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469459208
  error estimate for blocks of size 2^( 2) =       0.000493991689
  error estimate for blocks of size 2^( 3) =       0.000516058703
  error estimate for blocks of size 2^( 4) =       0.000532283113
  error estimate for blocks of size 2^( 5) =       0.000541840903
  error estimate for blocks of size 2^( 6) =       0.000546429581
  error estimate for blocks of size 2^( 7) =       0.000548142487

      target function =      -0.746110810971
              le_mean =     -22.660441426905
             les_mean =     513.944615196431
             stat err =       0.000542174021
             autocorr =       1.333772271420
   target nu stat err =       0.000542174021
   target dn stat err =       0.003143106484
      target stat err =       0.002645784461
              std dev =       0.663915579150
             le_variance =       0.440783896239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440720605023
                                         uncertainty =       0.002039913786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440720605023
                                         uncertainty =       0.002039913786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469459208
  error estimate for blocks of size 2^( 2) =       0.000493991689
  error estimate for blocks of size 2^( 3) =       0.000516058703
  error estimate for blocks of size 2^( 4) =       0.000532283113
  error estimate for blocks of size 2^( 5) =       0.000541840903
  error estimate for blocks of size 2^( 6) =       0.000546429581
  error estimate for blocks of size 2^( 7) =       0.000548142487

      target function =      -0.746110811049
              le_mean =     -22.660441426905
             les_mean =     513.944615196335
             stat err =       0.000542174021
             autocorr =       1.333772271470
   target nu stat err =       0.000542174021
   target dn stat err =       0.003143106479
      target stat err =       0.002645784458
              std dev =       0.663915579144
             le_variance =       0.440783896230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440720605028
                                         uncertainty =       0.002039913785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440720605028
                                         uncertainty =       0.002039913785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469459208
  error estimate for blocks of size 2^( 2) =       0.000493991689
  error estimate for blocks of size 2^( 3) =       0.000516058703
  error estimate for blocks of size 2^( 4) =       0.000532283113
  error estimate for blocks of size 2^( 5) =       0.000541840903
  error estimate for blocks of size 2^( 6) =       0.000546429581
  error estimate for blocks of size 2^( 7) =       0.000548142487

      target function =      -0.746110811010
              le_mean =     -22.660441426905
             les_mean =     513.944615196383
             stat err =       0.000542174021
             autocorr =       1.333772271444
   target nu stat err =       0.000542174021
   target dn stat err =       0.003143106481
      target stat err =       0.002645784459
              std dev =       0.663915579147
             le_variance =       0.440783896234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440720605032
                                         uncertainty =       0.002039913785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440720605032
                                         uncertainty =       0.002039913785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469459208
  error estimate for blocks of size 2^( 2) =       0.000493991689
  error estimate for blocks of size 2^( 3) =       0.000516058703
  error estimate for blocks of size 2^( 4) =       0.000532283113
  error estimate for blocks of size 2^( 5) =       0.000541840903
  error estimate for blocks of size 2^( 6) =       0.000546429581
  error estimate for blocks of size 2^( 7) =       0.000548142487

      target function =      -0.746110810976
              le_mean =     -22.660441426905
             les_mean =     513.944615196425
             stat err =       0.000542174021
             autocorr =       1.333772271412
   target nu stat err =       0.000542174021
   target dn stat err =       0.003143106483
      target stat err =       0.002645784461
              std dev =       0.663915579150
             le_variance =       0.440783896238


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746110810971        initial
     2.1684e+06     2.1684e+07             1.0529e-10        -0.746110811049  <--
     8.6736e+06     8.6736e+07             2.6323e-11        -0.746110811010
     3.4694e+07     3.4694e+08             6.5807e-12        -0.746110810976

*****************************************************************************
Applying the update for shift_i =   2.1684e+06     and shift_s =   2.1684e+07
*****************************************************************************

  Execution time = 4.5459e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337423e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647435e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764578e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6509e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.6832
    reference variance = 0.291812
====================================================
  Execution time = 2.6259e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5321e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4839e-01
  Total weights = 1.955702979e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438878641760
                                         uncertainty =       0.002557341419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438878641760
                                         uncertainty =       0.002557341419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468423954
  error estimate for blocks of size 2^( 2) =       0.000492547268
  error estimate for blocks of size 2^( 3) =       0.000514651185
  error estimate for blocks of size 2^( 4) =       0.000531229040
  error estimate for blocks of size 2^( 5) =       0.000539619411
  error estimate for blocks of size 2^( 6) =       0.000542781614
  error estimate for blocks of size 2^( 7) =       0.000546309048

      target function =      -0.746623280600
              le_mean =     -22.661091339120
             les_mean =     513.973452040334
             stat err =       0.000539984778
             autocorr =       1.328877179803
   target nu stat err =       0.000539984778
   target dn stat err =       0.003258045818
      target stat err =       0.002743502437
              std dev =       0.662451509033
             le_variance =       0.438842001820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266109133912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746632437786       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746632437811       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746632437816       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746632437817       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746632437817       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746632437818       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746632437767       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746632437877       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746632439818       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746632438005       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746632438581       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+05 is 4.459521e-10

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746632437786       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746632437792       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746632437793       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746632437794       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746632437051       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746632437794       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746632437276       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746632434964       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746632433909       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746632440633       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746632437749       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+06 is 1.114880e-10

solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746632437786       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746632437788       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746632437788       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746632436672       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746632437788       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746632434656       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746632437788       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746632466598       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746632442684       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746632458221       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746632435592       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+06 is 2.787225e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.507355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0968e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499180e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337423e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340449e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033883e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647436e-04 3 1  ON 60
ci_062                -5.383615e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115741e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764581e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.715
    reference variance = 0.39776
====================================================
  Execution time = 2.5508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5292e-01
  Total weights = 1.9550e+06
  Execution time = 3.6283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443559248618
                                         uncertainty =       0.002592182628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443559248618
                                         uncertainty =       0.002592182628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470869398
  error estimate for blocks of size 2^( 2) =       0.000495156362
  error estimate for blocks of size 2^( 3) =       0.000517270920
  error estimate for blocks of size 2^( 4) =       0.000533039451
  error estimate for blocks of size 2^( 5) =       0.000542801597
  error estimate for blocks of size 2^( 6) =       0.000547740363
  error estimate for blocks of size 2^( 7) =       0.000552279222

      target function =      -0.742926995433
              le_mean =     -22.661783425133
             les_mean =     514.009343907573
             stat err =       0.000543965158
             autocorr =       1.334569620206
   target nu stat err =       0.000543965158
   target dn stat err =       0.003375457587
      target stat err =       0.002814187605
              std dev =       0.665909888221
             le_variance =       0.443435979230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443559248646
                                         uncertainty =       0.002592182622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443559248646
                                         uncertainty =       0.002592182622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470869398
  error estimate for blocks of size 2^( 2) =       0.000495156362
  error estimate for blocks of size 2^( 3) =       0.000517270920
  error estimate for blocks of size 2^( 4) =       0.000533039451
  error estimate for blocks of size 2^( 5) =       0.000542801597
  error estimate for blocks of size 2^( 6) =       0.000547740363
  error estimate for blocks of size 2^( 7) =       0.000552279222

      target function =      -0.742926995347
              le_mean =     -22.661783425140
             les_mean =     514.009343907975
             stat err =       0.000543965158
             autocorr =       1.334569620351
   target nu stat err =       0.000543965158
   target dn stat err =       0.003375457594
      target stat err =       0.002814187611
              std dev =       0.665909888241
             le_variance =       0.443435979257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443559248632
                                         uncertainty =       0.002592182625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443559248632
                                         uncertainty =       0.002592182625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470869398
  error estimate for blocks of size 2^( 2) =       0.000495156362
  error estimate for blocks of size 2^( 3) =       0.000517270920
  error estimate for blocks of size 2^( 4) =       0.000533039451
  error estimate for blocks of size 2^( 5) =       0.000542801597
  error estimate for blocks of size 2^( 6) =       0.000547740363
  error estimate for blocks of size 2^( 7) =       0.000552279222

      target function =      -0.742926995390
              le_mean =     -22.661783425136
             les_mean =     514.009343907774
             stat err =       0.000543965158
             autocorr =       1.334569620282
   target nu stat err =       0.000543965158
   target dn stat err =       0.003375457591
      target stat err =       0.002814187608
              std dev =       0.665909888231
             le_variance =       0.443435979244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443559248620
                                         uncertainty =       0.002592182628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443559248620
                                         uncertainty =       0.002592182628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470869398
  error estimate for blocks of size 2^( 2) =       0.000495156362
  error estimate for blocks of size 2^( 3) =       0.000517270920
  error estimate for blocks of size 2^( 4) =       0.000533039451
  error estimate for blocks of size 2^( 5) =       0.000542801597
  error estimate for blocks of size 2^( 6) =       0.000547740363
  error estimate for blocks of size 2^( 7) =       0.000552279222

      target function =      -0.742926995428
              le_mean =     -22.661783425134
             les_mean =     514.009343907598
             stat err =       0.000543965158
             autocorr =       1.334569620222
   target nu stat err =       0.000543965158
   target dn stat err =       0.003375457587
      target stat err =       0.002814187606
              std dev =       0.665909888222
             le_variance =       0.443435979232


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742926995433        initial  <--
     5.4210e+05     5.4210e+06             4.4595e-10        -0.742926995347
     2.1684e+06     2.1684e+07             1.1149e-10        -0.742926995390
     8.6736e+06     8.6736e+07             2.7872e-11        -0.742926995428

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6182
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337423e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647435e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764578e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.5444
    reference variance = 0.310974
====================================================
  Execution time = 2.6081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5099e-01
  Total weights = 1.955436418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440528757989
                                         uncertainty =       0.002156599430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440528757989
                                         uncertainty =       0.002156599430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469303501
  error estimate for blocks of size 2^( 2) =       0.000493265689
  error estimate for blocks of size 2^( 3) =       0.000515737969
  error estimate for blocks of size 2^( 4) =       0.000531494415
  error estimate for blocks of size 2^( 5) =       0.000541373209
  error estimate for blocks of size 2^( 6) =       0.000546199911
  error estimate for blocks of size 2^( 7) =       0.000548310400

      target function =      -0.744501572100
              le_mean =     -22.661938707832
             les_mean =     514.014459498940
             stat err =       0.000541844484
             autocorr =       1.333035528979
   target nu stat err =       0.000541844484
   target dn stat err =       0.002838667312
      target stat err =       0.002398344221
              std dev =       0.663695375921
             le_variance =       0.440491552018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266193870783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+06, overlap shift 5.4210e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744507870537       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744507870540       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744507870540       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744507870540       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744507870787       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744507868603       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744507875395       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744507874952       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744507855427       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744507871485       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744507868902       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+06 is 4.366960e-11

solving harmonic davidson linear method for identity shift 2.1684e+07, overlap shift 2.1684e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744507870537       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744507870537       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744507870538       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744507870538       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744507870538       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744507867007       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744507843954       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744507804487       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744507846077       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744507846708       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744507883363       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+07 is 1.091740e-11

solving harmonic davidson linear method for identity shift 8.6736e+07, overlap shift 8.6736e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744507870537       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744507870537       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744507870537       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744507816653       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744507861434       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744507852601       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744507835885       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744507790419       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744507982428       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744508156158       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744507815808       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+07 is 2.729435e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.511579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0796e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337423e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647435e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115754e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764579e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.6528
    reference variance = 0.374484
====================================================
  Execution time = 2.5646e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5328e-01
  Total weights = 1.9549e+06
  Execution time = 3.7315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443248538196
                                         uncertainty =       0.002973935842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443248538196
                                         uncertainty =       0.002973935842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470765288
  error estimate for blocks of size 2^( 2) =       0.000494510404
  error estimate for blocks of size 2^( 3) =       0.000517455839
  error estimate for blocks of size 2^( 4) =       0.000533123090
  error estimate for blocks of size 2^( 5) =       0.000543540830
  error estimate for blocks of size 2^( 6) =       0.000547663900
  error estimate for blocks of size 2^( 7) =       0.000548926056

      target function =      -0.742625851895
              le_mean =     -22.661755349335
             les_mean =     514.008437894138
             stat err =       0.000543313469
             autocorr =       1.331962745361
   target nu stat err =       0.000543313469
   target dn stat err =       0.003763978514
      target stat err =       0.003121528321
              std dev =       0.665762655079
             le_variance =       0.443239912897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443248538171
                                         uncertainty =       0.002973935830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443248538171
                                         uncertainty =       0.002973935830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470765288
  error estimate for blocks of size 2^( 2) =       0.000494510404
  error estimate for blocks of size 2^( 3) =       0.000517455839
  error estimate for blocks of size 2^( 4) =       0.000533123090
  error estimate for blocks of size 2^( 5) =       0.000543540830
  error estimate for blocks of size 2^( 6) =       0.000547663900
  error estimate for blocks of size 2^( 7) =       0.000548926056

      target function =      -0.742625851745
              le_mean =     -22.661755349335
             les_mean =     514.008437894319
             stat err =       0.000543313469
             autocorr =       1.331962745396
   target nu stat err =       0.000543313469
   target dn stat err =       0.003763978504
      target stat err =       0.003121528312
              std dev =       0.665762655059
             le_variance =       0.443239912872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443248538183
                                         uncertainty =       0.002973935836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443248538183
                                         uncertainty =       0.002973935836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470765288
  error estimate for blocks of size 2^( 2) =       0.000494510404
  error estimate for blocks of size 2^( 3) =       0.000517455839
  error estimate for blocks of size 2^( 4) =       0.000533123090
  error estimate for blocks of size 2^( 5) =       0.000543540830
  error estimate for blocks of size 2^( 6) =       0.000547663900
  error estimate for blocks of size 2^( 7) =       0.000548926056

      target function =      -0.742625851820
              le_mean =     -22.661755349335
             les_mean =     514.008437894228
             stat err =       0.000543313469
             autocorr =       1.331962745369
   target nu stat err =       0.000543313469
   target dn stat err =       0.003763978509
      target stat err =       0.003121528317
              std dev =       0.665762655069
             le_variance =       0.443239912885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443248538195
                                         uncertainty =       0.002973935841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443248538195
                                         uncertainty =       0.002973935841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470765288
  error estimate for blocks of size 2^( 2) =       0.000494510404
  error estimate for blocks of size 2^( 3) =       0.000517455839
  error estimate for blocks of size 2^( 4) =       0.000533123090
  error estimate for blocks of size 2^( 5) =       0.000543540830
  error estimate for blocks of size 2^( 6) =       0.000547663900
  error estimate for blocks of size 2^( 7) =       0.000548926056

      target function =      -0.742625851886
              le_mean =     -22.661755349335
             les_mean =     514.008437894149
             stat err =       0.000543313469
             autocorr =       1.331962745367
   target nu stat err =       0.000543313469
   target dn stat err =       0.003763978513
      target stat err =       0.003121528321
              std dev =       0.665762655078
             le_variance =       0.443239912896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742625851895        initial  <--
     5.4210e+06     5.4210e+07             4.3670e-11        -0.742625851745
     2.1684e+07     2.1684e+08             1.0917e-11        -0.742625851820
     8.6736e+07     8.6736e+08             2.7294e-12        -0.742625851886

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8454
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337423e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647435e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764578e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4648e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.6636
    reference variance = 0.403916
====================================================
  Execution time = 2.6119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5249e-01
  Total weights = 1.955076263e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440020041559
                                         uncertainty =       0.003579644492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440020041559
                                         uncertainty =       0.003579644492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469080087
  error estimate for blocks of size 2^( 2) =       0.000493323464
  error estimate for blocks of size 2^( 3) =       0.000515379654
  error estimate for blocks of size 2^( 4) =       0.000531471139
  error estimate for blocks of size 2^( 5) =       0.000541163634
  error estimate for blocks of size 2^( 6) =       0.000546915346
  error estimate for blocks of size 2^( 7) =       0.000549334059

      target function =      -0.743268976246
              le_mean =     -22.661616330746
             les_mean =     514.001340526729
             stat err =       0.000542221044
             autocorr =       1.336160855169
   target nu stat err =       0.000542221044
   target dn stat err =       0.004454654193
      target stat err =       0.003680389810
              std dev =       0.663379420822
             le_variance =       0.440072255970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266161633075e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+07, overlap shift 5.4210e+08 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743286043636       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743286043637       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743286043637       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743286053798       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743286019769       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743286098849       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743285977559       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743286010723       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743286142602       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743286044607       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743285934490       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743286026338       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+07 is 4.421620e-12

solving harmonic davidson linear method for identity shift 2.1684e+08, overlap shift 2.1684e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743286043636       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743286043637       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743286043637       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743286043637       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743286043637       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743286043637       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743286082193       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743285947116       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743285537604       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743286414496       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743285926437       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743286119254       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+08 is 1.105151e-12

solving harmonic davidson linear method for identity shift 8.6736e+08, overlap shift 8.6736e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743286043636       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743286043636       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743286043637       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743286043637       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743286043637       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743286043637       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743286917453       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743285279494       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743286134402       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743285396702       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743285469746       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743283158433       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+08 is 2.762082e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.516474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0854e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337423e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647435e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764578e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.6358
    reference variance = 0.2905
====================================================
  Execution time = 2.5504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4318e-01
  Total weights = 1.9553e+06
  Execution time = 3.6443e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435364074578
                                         uncertainty =       0.002226990487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435364074578
                                         uncertainty =       0.002226990487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466559240
  error estimate for blocks of size 2^( 2) =       0.000490623186
  error estimate for blocks of size 2^( 3) =       0.000512929869
  error estimate for blocks of size 2^( 4) =       0.000529445424
  error estimate for blocks of size 2^( 5) =       0.000538019000
  error estimate for blocks of size 2^( 6) =       0.000543885145
  error estimate for blocks of size 2^( 7) =       0.000543953929

      target function =      -0.750946198410
              le_mean =     -22.661599879389
             les_mean =     513.991289899493
             stat err =       0.000538825874
             autocorr =       1.333777215262
   target nu stat err =       0.000538825874
   target dn stat err =       0.002342724457
      target stat err =       0.002039071383
              std dev =       0.659814405466
             le_variance =       0.435355049661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435364074578
                                         uncertainty =       0.002226990487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435364074578
                                         uncertainty =       0.002226990487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466559240
  error estimate for blocks of size 2^( 2) =       0.000490623186
  error estimate for blocks of size 2^( 3) =       0.000512929869
  error estimate for blocks of size 2^( 4) =       0.000529445424
  error estimate for blocks of size 2^( 5) =       0.000538019000
  error estimate for blocks of size 2^( 6) =       0.000543885145
  error estimate for blocks of size 2^( 7) =       0.000543953929

      target function =      -0.750946198410
              le_mean =     -22.661599879389
             les_mean =     513.991289899494
             stat err =       0.000538825874
             autocorr =       1.333777215260
   target nu stat err =       0.000538825874
   target dn stat err =       0.002342724457
      target stat err =       0.002039071383
              std dev =       0.659814405466
             le_variance =       0.435355049661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435364074578
                                         uncertainty =       0.002226990487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435364074578
                                         uncertainty =       0.002226990487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466559240
  error estimate for blocks of size 2^( 2) =       0.000490623186
  error estimate for blocks of size 2^( 3) =       0.000512929869
  error estimate for blocks of size 2^( 4) =       0.000529445424
  error estimate for blocks of size 2^( 5) =       0.000538019000
  error estimate for blocks of size 2^( 6) =       0.000543885145
  error estimate for blocks of size 2^( 7) =       0.000543953929

      target function =      -0.750946198410
              le_mean =     -22.661599879389
             les_mean =     513.991289899493
             stat err =       0.000538825874
             autocorr =       1.333777215274
   target nu stat err =       0.000538825874
   target dn stat err =       0.002342724457
      target stat err =       0.002039071383
              std dev =       0.659814405466
             le_variance =       0.435355049661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435364074578
                                         uncertainty =       0.002226990487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435364074578
                                         uncertainty =       0.002226990487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466559240
  error estimate for blocks of size 2^( 2) =       0.000490623186
  error estimate for blocks of size 2^( 3) =       0.000512929869
  error estimate for blocks of size 2^( 4) =       0.000529445424
  error estimate for blocks of size 2^( 5) =       0.000538019000
  error estimate for blocks of size 2^( 6) =       0.000543885145
  error estimate for blocks of size 2^( 7) =       0.000543953929

      target function =      -0.750946198410
              le_mean =     -22.661599879389
             les_mean =     513.991289899493
             stat err =       0.000538825874
             autocorr =       1.333777215270
   target nu stat err =       0.000538825874
   target dn stat err =       0.002342724457
      target stat err =       0.002039071383
              std dev =       0.659814405466
             le_variance =       0.435355049661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750946198410        initial  <--
     5.4210e+07     5.4210e+08             4.4216e-12        -0.750946198410
     2.1684e+08     2.1684e+09             1.1052e-12        -0.750946198410
     8.6736e+08     8.6736e+09             2.7621e-13        -0.750946198410

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2516
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337423e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647435e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764578e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.6959
    reference variance = 0.259836
====================================================
  Execution time = 2.7108e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5123e-01
  Total weights = 1.955581043e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441465285974
                                         uncertainty =       0.002239357257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441465285974
                                         uncertainty =       0.002239357257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469913426
  error estimate for blocks of size 2^( 2) =       0.000493759797
  error estimate for blocks of size 2^( 3) =       0.000516011984
  error estimate for blocks of size 2^( 4) =       0.000531006627
  error estimate for blocks of size 2^( 5) =       0.000539964906
  error estimate for blocks of size 2^( 6) =       0.000545845880
  error estimate for blocks of size 2^( 7) =       0.000549194360

      target function =      -0.744311426290
              le_mean =     -22.662605800274
             les_mean =     514.044933518208
             stat err =       0.000541502943
             autocorr =       1.327901725237
   target nu stat err =       0.000541502943
   target dn stat err =       0.002892464839
      target stat err =       0.002442124560
              std dev =       0.664557940645
             le_variance =       0.441637256475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266260580027e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+08, overlap shift 5.4210e+09 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744318499517       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744318499517       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744318499517       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744318499517       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744318499517       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744318499517       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744318324272       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744318499517       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744318499517       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744317567824       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744318523839       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+08 is 3.412598e-13

solving harmonic davidson linear method for identity shift 2.1684e+09, overlap shift 2.1684e+10 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744318499517       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744318499517       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744318499517       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744318499517       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744318499517       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744318499517       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744318499517       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744318499517       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744318499517       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744318499517       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744318499517       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+09 is 8.530624e-14

solving harmonic davidson linear method for identity shift 8.6736e+09, overlap shift 8.6736e+10 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744318499517       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744318499517       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744318499517       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744318499516       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744314952256       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744318470993       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744318311767       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744331617087       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744322141863       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744308477498       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744318499517       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+09 is 2.132649e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.520696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1850e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337423e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647435e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764578e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.6483
    reference variance = 0.311982
====================================================
  Execution time = 2.8113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5832e-01
  Total weights = 1.9550e+06
  Execution time = 3.6125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445751452861
                                         uncertainty =       0.002757065966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445751452861
                                         uncertainty =       0.002757065966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472073066
  error estimate for blocks of size 2^( 2) =       0.000496194730
  error estimate for blocks of size 2^( 3) =       0.000518638648
  error estimate for blocks of size 2^( 4) =       0.000535415725
  error estimate for blocks of size 2^( 5) =       0.000545475380
  error estimate for blocks of size 2^( 6) =       0.000551181323
  error estimate for blocks of size 2^( 7) =       0.000553517587

      target function =      -0.738548477307
              le_mean =     -22.661859114813
             les_mean =     514.018173756413
             stat err =       0.000546397504
             autocorr =       1.339673504741
   target nu stat err =       0.000546397504
   target dn stat err =       0.004195024417
      target stat err =       0.003430352881
              std dev =       0.667612131954
             le_variance =       0.445705958732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445751452861
                                         uncertainty =       0.002757065966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445751452861
                                         uncertainty =       0.002757065966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472073066
  error estimate for blocks of size 2^( 2) =       0.000496194730
  error estimate for blocks of size 2^( 3) =       0.000518638648
  error estimate for blocks of size 2^( 4) =       0.000535415725
  error estimate for blocks of size 2^( 5) =       0.000545475380
  error estimate for blocks of size 2^( 6) =       0.000551181323
  error estimate for blocks of size 2^( 7) =       0.000553517587

      target function =      -0.738548477307
              le_mean =     -22.661859114813
             les_mean =     514.018173756413
             stat err =       0.000546397504
             autocorr =       1.339673504745
   target nu stat err =       0.000546397504
   target dn stat err =       0.004195024417
      target stat err =       0.003430352881
              std dev =       0.667612131954
             le_variance =       0.445705958732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445751452861
                                         uncertainty =       0.002757065966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445751452861
                                         uncertainty =       0.002757065966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472073066
  error estimate for blocks of size 2^( 2) =       0.000496194730
  error estimate for blocks of size 2^( 3) =       0.000518638648
  error estimate for blocks of size 2^( 4) =       0.000535415725
  error estimate for blocks of size 2^( 5) =       0.000545475380
  error estimate for blocks of size 2^( 6) =       0.000551181323
  error estimate for blocks of size 2^( 7) =       0.000553517587

      target function =      -0.738548477307
              le_mean =     -22.661859114813
             les_mean =     514.018173756413
             stat err =       0.000546397504
             autocorr =       1.339673504747
   target nu stat err =       0.000546397504
   target dn stat err =       0.004195024417
      target stat err =       0.003430352881
              std dev =       0.667612131954
             le_variance =       0.445705958732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445751452861
                                         uncertainty =       0.002757065966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445751452861
                                         uncertainty =       0.002757065966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472073066
  error estimate for blocks of size 2^( 2) =       0.000496194730
  error estimate for blocks of size 2^( 3) =       0.000518638648
  error estimate for blocks of size 2^( 4) =       0.000535415725
  error estimate for blocks of size 2^( 5) =       0.000545475380
  error estimate for blocks of size 2^( 6) =       0.000551181323
  error estimate for blocks of size 2^( 7) =       0.000553517587

      target function =      -0.738548477307
              le_mean =     -22.661859114813
             les_mean =     514.018173756413
             stat err =       0.000546397504
             autocorr =       1.339673504742
   target nu stat err =       0.000546397504
   target dn stat err =       0.004195024417
      target stat err =       0.003430352881
              std dev =       0.667612131954
             le_variance =       0.445705958732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738548477307        initial
     5.4210e+08     5.4210e+09             3.4126e-13        -0.738548477307  <--
     2.1684e+09     2.1684e+10             8.5306e-14        -0.738548477307
     8.6736e+09     8.6736e+10             2.1326e-14        -0.738548477307

*****************************************************************************
Applying the update for shift_i =   5.4210e+08     and shift_s =   5.4210e+09
*****************************************************************************

  Execution time = 4.6199e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -7.020564e-01 3 1  ON 0
ci_002                -7.058948e-01 3 1  ON 1
ci_003                -5.340357e-02 3 1  ON 2
ci_004                -5.445497e-02 3 1  ON 3
ci_005                 1.972391e-02 3 1  ON 4
ci_006                 1.980572e-02 3 1  ON 5
ci_007                 1.614271e-02 3 1  ON 6
ci_008                 1.595724e-02 3 1  ON 7
ci_009                -1.233569e-02 3 1  ON 8
ci_010                -1.268797e-02 3 1  ON 9
ci_011                -9.749860e-03 3 1  ON 10
ci_012                -9.880603e-03 3 1  ON 11
ci_013                 8.890263e-03 3 1  ON 12
ci_014                 8.883151e-03 3 1  ON 13
ci_015                 9.309776e-03 3 1  ON 14
ci_016                 9.610087e-03 3 1  ON 15
ci_017                 8.642132e-03 3 1  ON 16
ci_018                 8.298664e-03 3 1  ON 17
ci_019                -1.196017e-03 3 1  ON 18
ci_020                -1.162717e-03 3 1  ON 19
ci_021                -1.041971e-02 3 1  ON 20
ci_022                -1.103437e-02 3 1  ON 21
ci_023                 5.499181e-03 3 1  ON 22
ci_024                 5.296274e-03 3 1  ON 23
ci_025                 1.291209e-02 3 1  ON 24
ci_026                 1.246625e-02 3 1  ON 25
ci_027                 6.258798e-03 3 1  ON 26
ci_028                 6.244006e-03 3 1  ON 27
ci_029                -3.703436e-03 3 1  ON 28
ci_030                -4.459558e-03 3 1  ON 29
ci_031                 4.049489e-03 3 1  ON 30
ci_032                 3.613899e-03 3 1  ON 31
ci_033                 3.444279e-03 3 1  ON 32
ci_034                 3.351622e-03 3 1  ON 33
ci_035                 2.285654e-03 3 1  ON 34
ci_036                 2.149753e-03 3 1  ON 35
ci_037                 3.394129e-03 3 1  ON 36
ci_038                 3.337423e-03 3 1  ON 37
ci_039                 4.272255e-03 3 1  ON 38
ci_040                 4.419460e-03 3 1  ON 39
ci_041                 2.796027e-03 3 1  ON 40
ci_042                 2.947527e-03 3 1  ON 41
ci_043                 3.494943e-03 3 1  ON 42
ci_044                 3.220045e-03 3 1  ON 43
ci_045                 2.511024e-03 3 1  ON 44
ci_046                 2.918178e-03 3 1  ON 45
ci_047                -9.823198e-04 3 1  ON 46
ci_048                -1.162341e-03 3 1  ON 47
ci_049                 7.340450e-04 3 1  ON 48
ci_050                 7.953530e-04 3 1  ON 49
ci_051                -1.520901e-03 3 1  ON 50
ci_052                -1.458112e-03 3 1  ON 51
ci_053                -2.543808e-03 3 1  ON 52
ci_054                -2.631146e-03 3 1  ON 53
ci_055                -1.577303e-03 3 1  ON 54
ci_056                -1.321887e-03 3 1  ON 55
ci_057                -1.037664e-03 3 1  ON 56
ci_058                -1.020901e-03 3 1  ON 57
ci_059                -4.033882e-04 3 1  ON 58
ci_060                -1.877473e-04 3 1  ON 59
ci_061                -6.647435e-04 3 1  ON 60
ci_062                -5.383616e-04 3 1  ON 61
ci_063                -6.250346e-04 3 1  ON 62
ci_064                -7.292977e-04 3 1  ON 63
ci_065                -1.742611e-03 3 1  ON 64
ci_066                -1.704982e-03 3 1  ON 65
ci_067                -1.600910e-03 3 1  ON 66
ci_068                -1.615901e-03 3 1  ON 67
ci_069                 3.115756e-06 3 1  ON 68
ci_070                 1.932030e-04 3 1  ON 69
ci_071                -1.536953e-03 3 1  ON 70
ci_072                -1.939668e-03 3 1  ON 71
ci_073                 1.528894e-04 3 1  ON 72
ci_074                 1.511692e-04 3 1  ON 73
ci_075                 5.764578e-05 3 1  ON 74
ci_076                 2.379210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8054e+01 secs
  Total Execution time = 7.5082e+03 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
