Rank =    0  Free Memory = 78788 MB
Rank =    1  Free Memory = 78788 MB
Rank =    2  Free Memory = 78788 MB
Rank =    3  Free Memory = 78787 MB
Rank =    4  Free Memory = 78786 MB
Rank =    5  Free Memory = 78786 MB
Rank =    6  Free Memory = 78786 MB
Rank =    7  Free Memory = 78786 MB
Rank =    8  Free Memory = 78786 MB
Rank =    9  Free Memory = 78786 MB
Rank =   10  Free Memory = 78786 MB
Rank =   11  Free Memory = 78786 MB
Rank =   12  Free Memory = 78786 MB
Rank =   13  Free Memory = 78786 MB
Rank =   14  Free Memory = 78785 MB
Rank =   15  Free Memory = 78772 MB
Rank =   16  Free Memory = 78772 MB
Rank =   17  Free Memory = 78772 MB
Rank =   18  Free Memory = 78772 MB
Rank =   19  Free Memory = 78772 MB
Rank =   20  Free Memory = 78772 MB
Rank =   21  Free Memory = 78772 MB
Rank =   22  Free Memory = 78772 MB
Rank =   23  Free Memory = 78772 MB
Rank =   24  Free Memory = 78772 MB
Rank =   25  Free Memory = 78771 MB
Rank =   26  Free Memory = 78771 MB
Rank =   27  Free Memory = 78771 MB
Rank =   28  Free Memory = 78771 MB
Rank =   29  Free Memory = 78771 MB
Rank =   30  Free Memory = 78771 MB
Rank =   31  Free Memory = 78771 MB
Rank =   32  Free Memory = 79640 MB
Rank =   33  Free Memory = 79639 MB
Rank =   34  Free Memory = 79639 MB
Rank =   35  Free Memory = 79639 MB
Rank =   36  Free Memory = 79639 MB
Rank =   37  Free Memory = 79639 MB
Rank =   38  Free Memory = 79639 MB
Rank =   39  Free Memory = 79639 MB
Rank =   40  Free Memory = 79638 MB
Rank =   41  Free Memory = 79638 MB
Rank =   42  Free Memory = 79638 MB
Rank =   43  Free Memory = 79638 MB
Rank =   44  Free Memory = 79638 MB
Rank =   45  Free Memory = 79638 MB
Rank =   46  Free Memory = 79638 MB
Rank =   47  Free Memory = 79638 MB
Rank =   48  Free Memory = 79638 MB
Rank =   49  Free Memory = 79637 MB
Rank =   50  Free Memory = 79637 MB
Rank =   51  Free Memory = 79637 MB
Rank =   52  Free Memory = 79637 MB
Rank =   53  Free Memory = 79637 MB
Rank =   54  Free Memory = 79637 MB
Rank =   55  Free Memory = 79637 MB
Rank =   56  Free Memory = 79637 MB
Rank =   57  Free Memory = 79637 MB
Rank =   58  Free Memory = 79637 MB
Rank =   59  Free Memory = 79637 MB
Rank =   60  Free Memory = 79637 MB
Rank =   61  Free Memory = 79637 MB
Rank =   62  Free Memory = 79637 MB
Rank =   63  Free Memory = 79637 MB
Rank =   64  Free Memory = 78807 MB
Rank =   65  Free Memory = 78807 MB
Rank =   66  Free Memory = 78806 MB
Rank =   67  Free Memory = 78806 MB
Rank =   68  Free Memory = 78806 MB
Rank =   69  Free Memory = 78806 MB
Rank =   70  Free Memory = 78806 MB
Rank =   71  Free Memory = 78806 MB
Rank =   72  Free Memory = 78806 MB
Rank =   73  Free Memory = 78806 MB
Rank =   74  Free Memory = 78806 MB
Rank =   75  Free Memory = 78806 MB
Rank =   76  Free Memory = 78806 MB
Rank =   77  Free Memory = 78806 MB
Rank =   78  Free Memory = 78806 MB
Rank =   79  Free Memory = 78806 MB
Rank =   80  Free Memory = 78806 MB
Rank =   81  Free Memory = 78806 MB
Rank =   82  Free Memory = 78806 MB
Rank =   83  Free Memory = 78806 MB
Rank =   84  Free Memory = 78806 MB
Rank =   85  Free Memory = 78806 MB
Rank =   86  Free Memory = 78806 MB
Rank =   87  Free Memory = 78806 MB
Rank =   88  Free Memory = 78806 MB
Rank =   89  Free Memory = 78806 MB
Rank =   90  Free Memory = 78806 MB
Rank =   91  Free Memory = 78806 MB
Rank =   92  Free Memory = 78806 MB
Rank =   93  Free Memory = 78806 MB
Rank =   94  Free Memory = 78806 MB
Rank =   95  Free Memory = 78806 MB
Rank =   96  Free Memory = 88615 MB
Rank =   97  Free Memory = 88615 MB
Rank =   98  Free Memory = 88615 MB
Rank =   99  Free Memory = 88615 MB
Rank =  100  Free Memory = 88615 MB
Rank =  101  Free Memory = 88615 MB
Rank =  102  Free Memory = 88615 MB
Rank =  103  Free Memory = 88615 MB
Rank =  104  Free Memory = 88615 MB
Rank =  105  Free Memory = 88615 MB
Rank =  106  Free Memory = 88614 MB
Rank =  107  Free Memory = 88614 MB
Rank =  108  Free Memory = 88614 MB
Rank =  109  Free Memory = 88614 MB
Rank =  110  Free Memory = 88614 MB
Rank =  111  Free Memory = 88614 MB
Rank =  112  Free Memory = 88614 MB
Rank =  113  Free Memory = 88614 MB
Rank =  114  Free Memory = 88614 MB
Rank =  115  Free Memory = 88614 MB
Rank =  116  Free Memory = 88614 MB
Rank =  117  Free Memory = 88614 MB
Rank =  118  Free Memory = 88614 MB
Rank =  119  Free Memory = 88614 MB
Rank =  120  Free Memory = 88614 MB
Rank =  121  Free Memory = 88614 MB
Rank =  122  Free Memory = 88614 MB
Rank =  123  Free Memory = 88614 MB
Rank =  124  Free Memory = 88614 MB
Rank =  125  Free Memory = 88614 MB
Rank =  126  Free Memory = 88614 MB
Rank =  127  Free Memory = 88614 MB
  Input file(s): opt_form_n2pistar_tett_run002a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_tett_run002a.xml

  Project = FORM2
  date    = 2023-02-22 11:48:08 PST
  host    = n0057.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 376

  Range of prime numbers to use as seeds over processors and threads = 2593-3617


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.949409e-01    1         1 OFF
     uu_1                 1.195613e-01    1         1 OFF
     uu_2                 6.101406e-03    1         1 OFF
     uu_3                -6.065052e-02    1         1 OFF
     uu_4                -1.006773e-01    1         1 OFF
     uu_5                -1.263386e-01    1         1 OFF
     uu_6                -1.424870e-01    1         1 OFF
     uu_7                -1.474970e-01    1         1 OFF
     uu_8                -1.439685e-01    1         1 OFF
     uu_9                -1.245737e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.892816e-01    1         1 OFF
     ud_1                 1.116049e-01    1         1 OFF
     ud_2                -2.827929e-02    1         1 OFF
     ud_3                -1.008992e-01    1         1 OFF
     ud_4                -1.393727e-01    1         1 OFF
     ud_5                -1.605036e-01    1         1 OFF
     ud_6                -1.695725e-01    1         1 OFF
     ud_7                -1.679012e-01    1         1 OFF
     ud_8                -1.529607e-01    1         1 OFF
     ud_9                -1.271010e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.549610e-01    1         1 OFF
     eC_1                -4.097799e-01    1         1 OFF
     eC_2                -1.687963e-01    1         1 OFF
     eC_3                -2.272894e-02    1         1 OFF
     eC_4                 4.861398e-02    1         1 OFF
     eC_5                 1.388351e-01    1         1 OFF
     eC_6                 2.384813e-01    1         1 OFF
     eC_7                 3.809007e-01    1         1 OFF
     eC_8                 2.683911e-01    1         1 OFF
     eC_9                 7.455279e-02    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.151913e+00    1         1 OFF
     eO_1                -7.856470e-01    1         1 OFF
     eO_2                -3.291222e-01    1         1 OFF
     eO_3                 1.643085e-03    1         1 OFF
     eO_4                 2.151175e-01    1         1 OFF
     eO_5                 3.696682e-01    1         1 OFF
     eO_6                 4.085243e-01    1         1 OFF
     eO_7                 4.138030e-01    1         1 OFF
     eO_8                 4.299012e-01    1         1 OFF
     eO_9                 3.006370e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.976343e-01    1         1 OFF
     eH1_1                -1.082406e-01    1         1 OFF
     eH1_2                -7.189495e-02    1         1 OFF
     eH1_3                -5.559476e-02    1         1 OFF
     eH1_4                 1.189862e-02    1         1 OFF
     eH1_5                 5.684541e-02    1         1 OFF
     eH1_6                 8.802783e-02    1         1 OFF
     eH1_7                 6.288523e-02    1         1 OFF
     eH1_8                -2.109080e-02    1         1 OFF
     eH1_9                 7.073231e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.948420e-01    1         1 OFF
     eH2_1                -1.038901e-01    1         1 OFF
     eH2_2                -6.810792e-02    1         1 OFF
     eH2_3                -5.190814e-02    1         1 OFF
     eH2_4                 1.566164e-02    1         1 OFF
     eH2_5                 6.037548e-02    1         1 OFF
     eH2_6                 9.231229e-02    1         1 OFF
     eH2_7                 6.881598e-02    1         1 OFF
     eH2_8                -1.143329e-02    1         1 OFF
     eH2_9                 7.068194e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.999735e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.6308e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM2.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6278
    reference variance = 0.518918
====================================================
  Execution time = 5.1388e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 5.2357e-01
  Total weights = 1.954396197e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508662376868
                                         uncertainty =       0.003050293877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508662376868
                                         uncertainty =       0.003050293877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504418777
  error estimate for blocks of size 2^( 2) =       0.000523506380
  error estimate for blocks of size 2^( 3) =       0.000540935109
  error estimate for blocks of size 2^( 4) =       0.000552329355
  error estimate for blocks of size 2^( 5) =       0.000559748535
  error estimate for blocks of size 2^( 6) =       0.000563946252
  error estimate for blocks of size 2^( 7) =       0.000566340965

      target function =      -0.601845876104
              le_mean =     -22.661033393257
             les_mean =     514.046001542406
             stat err =       0.000560591277
             autocorr =       1.235122923947
   target nu stat err =       0.000560591277
   target dn stat err =       0.003636961401
      target stat err =       0.001097605049
              std dev =       0.713355874886
             le_variance =       0.508876604235


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266103339326e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.601847558101       residual = 5.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603079432192       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603207484984       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603225808359       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603229554791       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603231088897       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603231134443       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603231109425       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603231201517       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603231154010       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.603231159459       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.603231175351       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 4.228849e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.601847558101       residual = 5.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.602189463093       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.602223475968       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.602228164462       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.602229097001       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.602229450110       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.602229447317       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.602229436722       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.602229458519       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.602229447199       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.602229448460       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.602229451616       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 1.178493e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.601847558101       residual = 5.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.601935448662       residual = 4.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.601944081411       residual = 7.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.601945258982       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.601945491350       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.601945577277       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.601945575688       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.601945572799       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.601945578164       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.601945575377       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.601945575685       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.601945576425       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 3.032965e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.362933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1218e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_001 -7.003395e-01                3 1 ON  0
ci_002 -7.001587e-01                3 1 ON  1
ci_003 -6.166440e-02                3 1 ON  2
ci_004 -6.167752e-02                3 1 ON  3
ci_005 4.429946e-02                 3 1 ON  4
ci_006 4.425521e-02                 3 1 ON  5
ci_007 3.126037e-02                 3 1 ON  6
ci_008 3.122392e-02                 3 1 ON  7
ci_009 -2.435314e-02                3 1 ON  8
ci_010 -2.439116e-02                3 1 ON  9
ci_011 -2.205942e-02                3 1 ON  10
ci_012 -2.207502e-02                3 1 ON  11
ci_013 1.982543e-02                 3 1 ON  12
ci_014 1.988208e-02                 3 1 ON  13
ci_015 1.951935e-02                 3 1 ON  14
ci_016 1.953873e-02                 3 1 ON  15
ci_017 1.538068e-02                 3 1 ON  16
ci_018 1.542002e-02                 3 1 ON  17
ci_019 9.726839e-03                 3 1 ON  18
ci_020 9.827609e-03                 3 1 ON  19
ci_021 -9.768499e-03                3 1 ON  20
ci_022 -9.822243e-03                3 1 ON  21
ci_023 8.540916e-03                 3 1 ON  22
ci_024 8.564862e-03                 3 1 ON  23
ci_025 7.969608e-03                 3 1 ON  24
ci_026 7.999508e-03                 3 1 ON  25
ci_027 7.829098e-03                 3 1 ON  26
ci_028 7.825272e-03                 3 1 ON  27
ci_029 -7.765714e-03                3 1 ON  28
ci_030 -7.776068e-03                3 1 ON  29
ci_031 -7.416202e-03                3 1 ON  30
ci_032 -7.437187e-03                3 1 ON  31
ci_033 6.807724e-03                 3 1 ON  32
ci_034 6.811085e-03                 3 1 ON  33
ci_035 6.399723e-03                 3 1 ON  34
ci_036 6.399773e-03                 3 1 ON  35
ci_037 6.531277e-03                 3 1 ON  36
ci_038 6.567540e-03                 3 1 ON  37
ci_039 5.522734e-03                 3 1 ON  38
ci_040 5.563811e-03                 3 1 ON  39
ci_041 4.988526e-03                 3 1 ON  40
ci_042 4.934256e-03                 3 1 ON  41
ci_043 4.986409e-03                 3 1 ON  42
ci_044 5.031952e-03                 3 1 ON  43
ci_045 4.882912e-03                 3 1 ON  44
ci_046 4.888552e-03                 3 1 ON  45
ci_047 -4.185389e-03                3 1 ON  46
ci_048 -4.121410e-03                3 1 ON  47
ci_049 3.226900e-03                 3 1 ON  48
ci_050 3.208088e-03                 3 1 ON  49
ci_051 -2.840057e-03                3 1 ON  50
ci_052 -2.806374e-03                3 1 ON  51
ci_053 -2.686982e-03                3 1 ON  52
ci_054 -2.794421e-03                3 1 ON  53
ci_055 -2.220129e-03                3 1 ON  54
ci_056 -2.148009e-03                3 1 ON  55
ci_057 -1.931704e-03                3 1 ON  56
ci_058 -1.956597e-03                3 1 ON  57
ci_059 -1.795229e-03                3 1 ON  58
ci_060 -1.766906e-03                3 1 ON  59
ci_061 -1.524503e-03                3 1 ON  60
ci_062 -1.524308e-03                3 1 ON  61
ci_063 -1.413961e-03                3 1 ON  62
ci_064 -1.425048e-03                3 1 ON  63
ci_065 -1.386842e-03                3 1 ON  64
ci_066 -1.378119e-03                3 1 ON  65
ci_067 -1.323999e-03                3 1 ON  66
ci_068 -1.334240e-03                3 1 ON  67
ci_069 1.183519e-03                 3 1 ON  68
ci_070 1.125920e-03                 3 1 ON  69
ci_071 -1.202685e-03                3 1 ON  70
ci_072 -1.227457e-03                3 1 ON  71
ci_073 1.016160e-03                 3 1 ON  72
ci_074 1.075315e-03                 3 1 ON  73
ci_075 -9.568151e-04                3 1 ON  74
ci_076 -1.026873e-03                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7039
    reference variance = 0.545341
====================================================
  Execution time = 5.0431e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.2478e-01
  Total weights = 1.9550e+06
  Execution time = 7.2366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507371743883
                                         uncertainty =       0.002599444254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507371743883
                                         uncertainty =       0.002599444254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503670935
  error estimate for blocks of size 2^( 2) =       0.000522623040
  error estimate for blocks of size 2^( 3) =       0.000540226310
  error estimate for blocks of size 2^( 4) =       0.000552033246
  error estimate for blocks of size 2^( 5) =       0.000559627847
  error estimate for blocks of size 2^( 6) =       0.000563272539
  error estimate for blocks of size 2^( 7) =       0.000567092587

      target function =      -0.569989329974
              le_mean =     -22.662947476072
             les_mean =     514.243884353677
             stat err =       0.000560506555
             autocorr =       1.238419013126
   target nu stat err =       0.000560506555
   target dn stat err =       0.107314443191
      target stat err =       0.028254403867
              std dev =       0.712298267923
             le_variance =       0.507368822487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500388349926
                                         uncertainty =       0.002623341140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500388349926
                                         uncertainty =       0.002623341140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500194809
  error estimate for blocks of size 2^( 2) =       0.000518916367
  error estimate for blocks of size 2^( 3) =       0.000536329850
  error estimate for blocks of size 2^( 4) =       0.000547975283
  error estimate for blocks of size 2^( 5) =       0.000555557437
  error estimate for blocks of size 2^( 6) =       0.000559192321
  error estimate for blocks of size 2^( 7) =       0.000562875014

      target function =      -0.599510590910
              le_mean =     -22.663041801507
             les_mean =     514.146630536842
             stat err =       0.000556400014
             autocorr =       1.237359516471
   target nu stat err =       0.000556400014
   target dn stat err =       0.009987901469
      target stat err =       0.002914672454
              std dev =       0.707382283355
             le_variance =       0.500389694805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502932861804
                                         uncertainty =       0.002592216303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502932861804
                                         uncertainty =       0.002592216303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501464318
  error estimate for blocks of size 2^( 2) =       0.000520289914
  error estimate for blocks of size 2^( 3) =       0.000537789926
  error estimate for blocks of size 2^( 4) =       0.000549516187
  error estimate for blocks of size 2^( 5) =       0.000557084789
  error estimate for blocks of size 2^( 6) =       0.000560716222
  error estimate for blocks of size 2^( 7) =       0.000564404685

      target function =      -0.601876779225
              le_mean =     -22.662963667792
             les_mean =     514.134933981410
             stat err =       0.000557930471
             autocorr =       1.237884396752
   target nu stat err =       0.000557930471
   target dn stat err =       0.007647105845
      target stat err =       0.002255813578
              std dev =       0.709177639638
             le_variance =       0.502932924562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506491301269
                                         uncertainty =       0.002593466554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506491301269
                                         uncertainty =       0.002593466554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503234301
  error estimate for blocks of size 2^( 2) =       0.000522171451
  error estimate for blocks of size 2^( 3) =       0.000539769560
  error estimate for blocks of size 2^( 4) =       0.000551566689
  error estimate for blocks of size 2^( 5) =       0.000559163088
  error estimate for blocks of size 2^( 6) =       0.000562817055
  error estimate for blocks of size 2^( 7) =       0.000566590641

      target function =      -0.599993173630
              le_mean =     -22.662951576981
             les_mean =     514.140820179292
             stat err =       0.000560034368
             autocorr =       1.238479687831
   target nu stat err =       0.000560034368
   target dn stat err =       0.008706910548
      target stat err =       0.002548348408
              std dev =       0.711680773583
             le_variance =       0.506489523488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.569989329974        initial
     2.5000e-01     2.5000e+00             4.2288e-03        -0.599510590910
     1.0000e+00     1.0000e+01             1.1785e-03        -0.601876779225  <--
     4.0000e+00     4.0000e+01             3.0330e-04        -0.599993173630

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 8.6702e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_001                -7.003395e-01 3 1  ON 0
ci_002                -7.001587e-01 3 1  ON 1
ci_003                -6.166440e-02 3 1  ON 2
ci_004                -6.167752e-02 3 1  ON 3
ci_005                 4.429946e-02 3 1  ON 4
ci_006                 4.425521e-02 3 1  ON 5
ci_007                 3.126037e-02 3 1  ON 6
ci_008                 3.122392e-02 3 1  ON 7
ci_009                -2.435314e-02 3 1  ON 8
ci_010                -2.439116e-02 3 1  ON 9
ci_011                -2.205942e-02 3 1  ON 10
ci_012                -2.207502e-02 3 1  ON 11
ci_013                 1.982543e-02 3 1  ON 12
ci_014                 1.988208e-02 3 1  ON 13
ci_015                 1.951935e-02 3 1  ON 14
ci_016                 1.953873e-02 3 1  ON 15
ci_017                 1.538068e-02 3 1  ON 16
ci_018                 1.542002e-02 3 1  ON 17
ci_019                 9.726839e-03 3 1  ON 18
ci_020                 9.827609e-03 3 1  ON 19
ci_021                -9.768499e-03 3 1  ON 20
ci_022                -9.822243e-03 3 1  ON 21
ci_023                 8.540916e-03 3 1  ON 22
ci_024                 8.564862e-03 3 1  ON 23
ci_025                 7.969608e-03 3 1  ON 24
ci_026                 7.999508e-03 3 1  ON 25
ci_027                 7.829098e-03 3 1  ON 26
ci_028                 7.825272e-03 3 1  ON 27
ci_029                -7.765714e-03 3 1  ON 28
ci_030                -7.776068e-03 3 1  ON 29
ci_031                -7.416202e-03 3 1  ON 30
ci_032                -7.437187e-03 3 1  ON 31
ci_033                 6.807724e-03 3 1  ON 32
ci_034                 6.811085e-03 3 1  ON 33
ci_035                 6.399723e-03 3 1  ON 34
ci_036                 6.399773e-03 3 1  ON 35
ci_037                 6.531277e-03 3 1  ON 36
ci_038                 6.567540e-03 3 1  ON 37
ci_039                 5.522734e-03 3 1  ON 38
ci_040                 5.563811e-03 3 1  ON 39
ci_041                 4.988526e-03 3 1  ON 40
ci_042                 4.934256e-03 3 1  ON 41
ci_043                 4.986409e-03 3 1  ON 42
ci_044                 5.031952e-03 3 1  ON 43
ci_045                 4.882912e-03 3 1  ON 44
ci_046                 4.888552e-03 3 1  ON 45
ci_047                -4.185389e-03 3 1  ON 46
ci_048                -4.121410e-03 3 1  ON 47
ci_049                 3.226900e-03 3 1  ON 48
ci_050                 3.208088e-03 3 1  ON 49
ci_051                -2.840057e-03 3 1  ON 50
ci_052                -2.806374e-03 3 1  ON 51
ci_053                -2.686982e-03 3 1  ON 52
ci_054                -2.794421e-03 3 1  ON 53
ci_055                -2.220129e-03 3 1  ON 54
ci_056                -2.148009e-03 3 1  ON 55
ci_057                -1.931704e-03 3 1  ON 56
ci_058                -1.956597e-03 3 1  ON 57
ci_059                -1.795229e-03 3 1  ON 58
ci_060                -1.766906e-03 3 1  ON 59
ci_061                -1.524503e-03 3 1  ON 60
ci_062                -1.524308e-03 3 1  ON 61
ci_063                -1.413961e-03 3 1  ON 62
ci_064                -1.425048e-03 3 1  ON 63
ci_065                -1.386842e-03 3 1  ON 64
ci_066                -1.378119e-03 3 1  ON 65
ci_067                -1.323999e-03 3 1  ON 66
ci_068                -1.334240e-03 3 1  ON 67
ci_069                 1.183519e-03 3 1  ON 68
ci_070                 1.125920e-03 3 1  ON 69
ci_071                -1.202685e-03 3 1  ON 70
ci_072                -1.227457e-03 3 1  ON 71
ci_073                 1.016160e-03 3 1  ON 72
ci_074                 1.075315e-03 3 1  ON 73
ci_075                -9.568151e-04 3 1  ON 74
ci_076                -1.026873e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4793e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6642
    reference variance = 0.499763
====================================================
  Execution time = 5.1455e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.2241e-01
  Total weights = 1.954544868e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4517e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509546620444
                                         uncertainty =       0.004231312030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509546620444
                                         uncertainty =       0.004231312030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504780134
  error estimate for blocks of size 2^( 2) =       0.000523161437
  error estimate for blocks of size 2^( 3) =       0.000540840510
  error estimate for blocks of size 2^( 4) =       0.000553633914
  error estimate for blocks of size 2^( 5) =       0.000560713194
  error estimate for blocks of size 2^( 6) =       0.000564775691
  error estimate for blocks of size 2^( 7) =       0.000567387199

      target function =      -0.602606399655
              le_mean =     -22.662797382981
             les_mean =     514.124791169534
             stat err =       0.000561627500
             autocorr =       1.237918973098
   target nu stat err =       0.000561627500
   target dn stat err =       0.004521635615
      target stat err =       0.001355061777
              std dev =       0.713866911878
             le_variance =       0.509605967875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266279738298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.602609183566       residual = 5.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603809273995       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603924086735       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603935145831       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603936360091       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603936955376       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603937057327       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603936978395       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603936968777       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603936979872       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 3.909037e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.602609183566       residual = 5.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.602941780417       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.602972267011       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.602975067633       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.602975354075       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.602975496708       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.602975515501       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.602975496238       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.602975494599       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 1.088571e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.602609183566       residual = 5.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.602694645904       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.602702383454       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.602703084663       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.602703154908       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.602703190071       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.602703194339       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.602703189578       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.602703189217       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 2.800919e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367909 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0919e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_001                -7.005278e-01 3 1  ON 0
ci_002                -7.003776e-01 3 1  ON 1
ci_003                -6.139998e-02 3 1  ON 2
ci_004                -6.144701e-02 3 1  ON 3
ci_005                 4.321089e-02 3 1  ON 4
ci_006                 4.317578e-02 3 1  ON 5
ci_007                 3.053162e-02 3 1  ON 6
ci_008                 3.058073e-02 3 1  ON 7
ci_009                -2.378299e-02 3 1  ON 8
ci_010                -2.391730e-02 3 1  ON 9
ci_011                -2.154269e-02 3 1  ON 10
ci_012                -2.153754e-02 3 1  ON 11
ci_013                 1.935677e-02 3 1  ON 12
ci_014                 1.944352e-02 3 1  ON 13
ci_015                 1.912546e-02 3 1  ON 14
ci_016                 1.919619e-02 3 1  ON 15
ci_017                 1.510836e-02 3 1  ON 16
ci_018                 1.520234e-02 3 1  ON 17
ci_019                 9.377223e-03 3 1  ON 18
ci_020                 9.526813e-03 3 1  ON 19
ci_021                -9.677726e-03 3 1  ON 20
ci_022                -9.745634e-03 3 1  ON 21
ci_023                 8.423692e-03 3 1  ON 22
ci_024                 8.408005e-03 3 1  ON 23
ci_025                 8.008275e-03 3 1  ON 24
ci_026                 8.029558e-03 3 1  ON 25
ci_027                 7.815643e-03 3 1  ON 26
ci_028                 7.742723e-03 3 1  ON 27
ci_029                -7.705046e-03 3 1  ON 28
ci_030                -7.729316e-03 3 1  ON 29
ci_031                -7.119956e-03 3 1  ON 30
ci_032                -7.157713e-03 3 1  ON 31
ci_033                 6.633571e-03 3 1  ON 32
ci_034                 6.723164e-03 3 1  ON 33
ci_035                 6.234470e-03 3 1  ON 34
ci_036                 6.198193e-03 3 1  ON 35
ci_037                 6.427070e-03 3 1  ON 36
ci_038                 6.453826e-03 3 1  ON 37
ci_039                 5.477478e-03 3 1  ON 38
ci_040                 5.511173e-03 3 1  ON 39
ci_041                 4.931022e-03 3 1  ON 40
ci_042                 4.840895e-03 3 1  ON 41
ci_043                 4.940432e-03 3 1  ON 42
ci_044                 5.069219e-03 3 1  ON 43
ci_045                 4.819297e-03 3 1  ON 44
ci_046                 4.776208e-03 3 1  ON 45
ci_047                -4.009449e-03 3 1  ON 46
ci_048                -3.969977e-03 3 1  ON 47
ci_049                 3.077396e-03 3 1  ON 48
ci_050                 3.133495e-03 3 1  ON 49
ci_051                -2.799766e-03 3 1  ON 50
ci_052                -2.735683e-03 3 1  ON 51
ci_053                -2.674712e-03 3 1  ON 52
ci_054                -2.755548e-03 3 1  ON 53
ci_055                -2.130244e-03 3 1  ON 54
ci_056                -2.100421e-03 3 1  ON 55
ci_057                -1.900707e-03 3 1  ON 56
ci_058                -1.914385e-03 3 1  ON 57
ci_059                -1.727631e-03 3 1  ON 58
ci_060                -1.699697e-03 3 1  ON 59
ci_061                -1.481532e-03 3 1  ON 60
ci_062                -1.427169e-03 3 1  ON 61
ci_063                -1.366451e-03 3 1  ON 62
ci_064                -1.405187e-03 3 1  ON 63
ci_065                -1.408745e-03 3 1  ON 64
ci_066                -1.373294e-03 3 1  ON 65
ci_067                -1.294951e-03 3 1  ON 66
ci_068                -1.361139e-03 3 1  ON 67
ci_069                 1.119179e-03 3 1  ON 68
ci_070                 1.081152e-03 3 1  ON 69
ci_071                -1.252243e-03 3 1  ON 70
ci_072                -1.318234e-03 3 1  ON 71
ci_073                 9.828501e-04 3 1  ON 72
ci_074                 1.009618e-03 3 1  ON 73
ci_075                -9.311009e-04 3 1  ON 74
ci_076                -9.828294e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6508
    reference variance = 0.644052
====================================================
  Execution time = 4.9785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 5.2761e-01
  Total weights = 1.9548e+06
  Execution time = 7.2408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 6.67622e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.539803164757
                                         uncertainty =       0.024827938546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.539803164757
                                         uncertainty =       0.024827938546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519462746
  error estimate for blocks of size 2^( 2) =       0.000537865466
  error estimate for blocks of size 2^( 3) =       0.000554771829
  error estimate for blocks of size 2^( 4) =       0.000566606741
  error estimate for blocks of size 2^( 5) =       0.000573562154
  error estimate for blocks of size 2^( 6) =       0.000577704333
  error estimate for blocks of size 2^( 7) =       0.000578117979

      target function =      -0.011233012814
              le_mean =     -22.662521136585
             les_mean =     569.167389317643
             stat err =       0.000573997802
             autocorr =       1.220988698161
   target nu stat err =       0.000573997802
   target dn stat err =      55.066919556523
      target stat err =       0.010831371506
              std dev =       0.734631260772
             le_variance =       0.539683089303

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 6.43831e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509245058312
                                         uncertainty =       0.003811479945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509245058312
                                         uncertainty =       0.003811479945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504607099
  error estimate for blocks of size 2^( 2) =       0.000523149293
  error estimate for blocks of size 2^( 3) =       0.000540090714
  error estimate for blocks of size 2^( 4) =       0.000551875076
  error estimate for blocks of size 2^( 5) =       0.000558503150
  error estimate for blocks of size 2^( 6) =       0.000562827176
  error estimate for blocks of size 2^( 7) =       0.000563246620

      target function =      -0.597954338741
              le_mean =     -22.662466386900
             les_mean =     514.125474361510
             stat err =       0.000559113006
             autocorr =       1.227700623373
   target nu stat err =       0.000559113006
   target dn stat err =       0.008132216008
      target stat err =       0.002365082892
              std dev =       0.713622203505
             le_variance =       0.509256649336

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 6.67613e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511422683160
                                         uncertainty =       0.003688399840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511422683160
                                         uncertainty =       0.003688399840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505684896
  error estimate for blocks of size 2^( 2) =       0.000524315715
  error estimate for blocks of size 2^( 3) =       0.000541362565
  error estimate for blocks of size 2^( 4) =       0.000553196903
  error estimate for blocks of size 2^( 5) =       0.000559850861
  error estimate for blocks of size 2^( 6) =       0.000564226810
  error estimate for blocks of size 2^( 7) =       0.000564600378

      target function =      -0.601039216021
              le_mean =     -22.662407385605
             les_mean =     514.112148600407
             stat err =       0.000560468738
             autocorr =       1.228408526800
   target nu stat err =       0.000560468738
   target dn stat err =       0.005170040567
      target stat err =       0.001533472982
              std dev =       0.715146438189
             le_variance =       0.511434428054

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 6.90269e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514453861373
                                         uncertainty =       0.003593697454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514453861373
                                         uncertainty =       0.003593697454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507180982
  error estimate for blocks of size 2^( 2) =       0.000525921061
  error estimate for blocks of size 2^( 3) =       0.000543086708
  error estimate for blocks of size 2^( 4) =       0.000554987562
  error estimate for blocks of size 2^( 5) =       0.000561694660
  error estimate for blocks of size 2^( 6) =       0.000566116842
  error estimate for blocks of size 2^( 7) =       0.000566494063

      target function =      -0.599638906642
              le_mean =     -22.662407705418
             les_mean =     514.116971359118
             stat err =       0.000562323282
             autocorr =       1.229266959722
   target nu stat err =       0.000562323282
   target dn stat err =       0.005267104687
      target stat err =       0.001554365471
              std dev =       0.717262223838
             le_variance =       0.514465097745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.011233012814        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 86.0664
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_001                -7.003395e-01 3 1  ON 0
ci_002                -7.001587e-01 3 1  ON 1
ci_003                -6.166440e-02 3 1  ON 2
ci_004                -6.167752e-02 3 1  ON 3
ci_005                 4.429946e-02 3 1  ON 4
ci_006                 4.425521e-02 3 1  ON 5
ci_007                 3.126037e-02 3 1  ON 6
ci_008                 3.122392e-02 3 1  ON 7
ci_009                -2.435314e-02 3 1  ON 8
ci_010                -2.439116e-02 3 1  ON 9
ci_011                -2.205942e-02 3 1  ON 10
ci_012                -2.207502e-02 3 1  ON 11
ci_013                 1.982543e-02 3 1  ON 12
ci_014                 1.988208e-02 3 1  ON 13
ci_015                 1.951935e-02 3 1  ON 14
ci_016                 1.953873e-02 3 1  ON 15
ci_017                 1.538068e-02 3 1  ON 16
ci_018                 1.542002e-02 3 1  ON 17
ci_019                 9.726839e-03 3 1  ON 18
ci_020                 9.827609e-03 3 1  ON 19
ci_021                -9.768499e-03 3 1  ON 20
ci_022                -9.822243e-03 3 1  ON 21
ci_023                 8.540916e-03 3 1  ON 22
ci_024                 8.564862e-03 3 1  ON 23
ci_025                 7.969608e-03 3 1  ON 24
ci_026                 7.999508e-03 3 1  ON 25
ci_027                 7.829098e-03 3 1  ON 26
ci_028                 7.825272e-03 3 1  ON 27
ci_029                -7.765714e-03 3 1  ON 28
ci_030                -7.776068e-03 3 1  ON 29
ci_031                -7.416202e-03 3 1  ON 30
ci_032                -7.437187e-03 3 1  ON 31
ci_033                 6.807724e-03 3 1  ON 32
ci_034                 6.811085e-03 3 1  ON 33
ci_035                 6.399723e-03 3 1  ON 34
ci_036                 6.399773e-03 3 1  ON 35
ci_037                 6.531277e-03 3 1  ON 36
ci_038                 6.567540e-03 3 1  ON 37
ci_039                 5.522734e-03 3 1  ON 38
ci_040                 5.563811e-03 3 1  ON 39
ci_041                 4.988526e-03 3 1  ON 40
ci_042                 4.934256e-03 3 1  ON 41
ci_043                 4.986409e-03 3 1  ON 42
ci_044                 5.031952e-03 3 1  ON 43
ci_045                 4.882912e-03 3 1  ON 44
ci_046                 4.888552e-03 3 1  ON 45
ci_047                -4.185389e-03 3 1  ON 46
ci_048                -4.121410e-03 3 1  ON 47
ci_049                 3.226900e-03 3 1  ON 48
ci_050                 3.208088e-03 3 1  ON 49
ci_051                -2.840057e-03 3 1  ON 50
ci_052                -2.806374e-03 3 1  ON 51
ci_053                -2.686982e-03 3 1  ON 52
ci_054                -2.794421e-03 3 1  ON 53
ci_055                -2.220129e-03 3 1  ON 54
ci_056                -2.148009e-03 3 1  ON 55
ci_057                -1.931704e-03 3 1  ON 56
ci_058                -1.956597e-03 3 1  ON 57
ci_059                -1.795229e-03 3 1  ON 58
ci_060                -1.766906e-03 3 1  ON 59
ci_061                -1.524503e-03 3 1  ON 60
ci_062                -1.524308e-03 3 1  ON 61
ci_063                -1.413961e-03 3 1  ON 62
ci_064                -1.425048e-03 3 1  ON 63
ci_065                -1.386842e-03 3 1  ON 64
ci_066                -1.378119e-03 3 1  ON 65
ci_067                -1.323999e-03 3 1  ON 66
ci_068                -1.334240e-03 3 1  ON 67
ci_069                 1.183519e-03 3 1  ON 68
ci_070                 1.125920e-03 3 1  ON 69
ci_071                -1.202685e-03 3 1  ON 70
ci_072                -1.227457e-03 3 1  ON 71
ci_073                 1.016160e-03 3 1  ON 72
ci_074                 1.075315e-03 3 1  ON 73
ci_075                -9.568151e-04 3 1  ON 74
ci_076                -1.026873e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4700e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7173
    reference variance = 1.04638
====================================================
  Execution time = 5.1336e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.2333e-01
  Total weights = 1.954425116e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508604806909
                                         uncertainty =       0.002696980155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508604806909
                                         uncertainty =       0.002696980155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504295061
  error estimate for blocks of size 2^( 2) =       0.000522900205
  error estimate for blocks of size 2^( 3) =       0.000539441884
  error estimate for blocks of size 2^( 4) =       0.000551391728
  error estimate for blocks of size 2^( 5) =       0.000558570839
  error estimate for blocks of size 2^( 6) =       0.000563326162
  error estimate for blocks of size 2^( 7) =       0.000565876929

      target function =      -0.602332677484
              le_mean =     -22.662776230051
             les_mean =     514.124752933860
             stat err =       0.000559791414
             autocorr =       1.232205200468
   target nu stat err =       0.000559791414
   target dn stat err =       0.003303017686
      target stat err =       0.001006192904
              std dev =       0.713180914442
             le_variance =       0.508627016724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266277623005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.602334063223       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.602461330105       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.602472831024       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.602473852617       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.602474076490       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.602474063718       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.602474093379       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.602474104360       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.602474103632       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.602474102979       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.602474102870       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 4.588810e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.602334063223       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.602366236634       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.602369129272       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.602369384827       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.602369440586       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.602369437216       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.602369444560       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.602369447267       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.602369447078       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.602369446915       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.602369446892       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.160666e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.602334063223       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.602342129175       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.602342853426       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.602342917323       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.602342931250       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.602342930396       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.602342932228       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.602342932902       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.602342932854       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.602342932813       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.602342932808       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 2.910199e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381666 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0764e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_001                -7.003643e-01 3 1  ON 0
ci_002                -7.001749e-01 3 1  ON 1
ci_003                -6.163266e-02 3 1  ON 2
ci_004                -6.164890e-02 3 1  ON 3
ci_005                 4.418339e-02 3 1  ON 4
ci_006                 4.414321e-02 3 1  ON 5
ci_007                 3.119421e-02 3 1  ON 6
ci_008                 3.116769e-02 3 1  ON 7
ci_009                -2.430533e-02 3 1  ON 8
ci_010                -2.434392e-02 3 1  ON 9
ci_011                -2.201242e-02 3 1  ON 10
ci_012                -2.203138e-02 3 1  ON 11
ci_013                 1.978384e-02 3 1  ON 12
ci_014                 1.983689e-02 3 1  ON 13
ci_015                 1.948416e-02 3 1  ON 14
ci_016                 1.950929e-02 3 1  ON 15
ci_017                 1.534969e-02 3 1  ON 16
ci_018                 1.539522e-02 3 1  ON 17
ci_019                 9.686484e-03 3 1  ON 18
ci_020                 9.803826e-03 3 1  ON 19
ci_021                -9.754215e-03 3 1  ON 20
ci_022                -9.817334e-03 3 1  ON 21
ci_023                 8.527488e-03 3 1  ON 22
ci_024                 8.552746e-03 3 1  ON 23
ci_025                 7.975769e-03 3 1  ON 24
ci_026                 8.000915e-03 3 1  ON 25
ci_027                 7.821769e-03 3 1  ON 26
ci_028                 7.818376e-03 3 1  ON 27
ci_029                -7.751714e-03 3 1  ON 28
ci_030                -7.758901e-03 3 1  ON 29
ci_031                -7.386882e-03 3 1  ON 30
ci_032                -7.410079e-03 3 1  ON 31
ci_033                 6.793950e-03 3 1  ON 32
ci_034                 6.800856e-03 3 1  ON 33
ci_035                 6.379855e-03 3 1  ON 34
ci_036                 6.379009e-03 3 1  ON 35
ci_037                 6.525304e-03 3 1  ON 36
ci_038                 6.557683e-03 3 1  ON 37
ci_039                 5.521693e-03 3 1  ON 38
ci_040                 5.556289e-03 3 1  ON 39
ci_041                 4.978380e-03 3 1  ON 40
ci_042                 4.923870e-03 3 1  ON 41
ci_043                 4.979064e-03 3 1  ON 42
ci_044                 5.028005e-03 3 1  ON 43
ci_045                 4.875148e-03 3 1  ON 44
ci_046                 4.878826e-03 3 1  ON 45
ci_047                -4.170986e-03 3 1  ON 46
ci_048                -4.110960e-03 3 1  ON 47
ci_049                 3.227642e-03 3 1  ON 48
ci_050                 3.199568e-03 3 1  ON 49
ci_051                -2.830348e-03 3 1  ON 50
ci_052                -2.809357e-03 3 1  ON 51
ci_053                -2.686753e-03 3 1  ON 52
ci_054                -2.793283e-03 3 1  ON 53
ci_055                -2.217481e-03 3 1  ON 54
ci_056                -2.145177e-03 3 1  ON 55
ci_057                -1.928625e-03 3 1  ON 56
ci_058                -1.951903e-03 3 1  ON 57
ci_059                -1.787418e-03 3 1  ON 58
ci_060                -1.760241e-03 3 1  ON 59
ci_061                -1.525560e-03 3 1  ON 60
ci_062                -1.522120e-03 3 1  ON 61
ci_063                -1.402150e-03 3 1  ON 62
ci_064                -1.422071e-03 3 1  ON 63
ci_065                -1.388672e-03 3 1  ON 64
ci_066                -1.373689e-03 3 1  ON 65
ci_067                -1.324000e-03 3 1  ON 66
ci_068                -1.331057e-03 3 1  ON 67
ci_069                 1.182404e-03 3 1  ON 68
ci_070                 1.125414e-03 3 1  ON 69
ci_071                -1.203457e-03 3 1  ON 70
ci_072                -1.236575e-03 3 1  ON 71
ci_073                 1.009124e-03 3 1  ON 72
ci_074                 1.072040e-03 3 1  ON 73
ci_075                -9.512077e-04 3 1  ON 74
ci_076                -1.021888e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7582
    reference variance = 0.65628
====================================================
  Execution time = 5.0588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 5.4055e-01
  Total weights = 1.9548e+06
  Execution time = 7.2415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521770147020
                                         uncertainty =       0.006550990478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521770147020
                                         uncertainty =       0.006550990478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510735199
  error estimate for blocks of size 2^( 2) =       0.000529622582
  error estimate for blocks of size 2^( 3) =       0.000547073684
  error estimate for blocks of size 2^( 4) =       0.000559343678
  error estimate for blocks of size 2^( 5) =       0.000568721014
  error estimate for blocks of size 2^( 6) =       0.000572287945
  error estimate for blocks of size 2^( 7) =       0.000573345920

      target function =      -0.596856057457
              le_mean =     -22.661598837816
             les_mean =     514.089262716982
             stat err =       0.000568424639
             autocorr =       1.238665980435
   target nu stat err =       0.000568424639
   target dn stat err =       0.008681177754
      target stat err =       0.002512243325
              std dev =       0.722288645389
             le_variance =       0.521700887258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520984338215
                                         uncertainty =       0.006533581768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520984338215
                                         uncertainty =       0.006533581768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510350602
  error estimate for blocks of size 2^( 2) =       0.000529212034
  error estimate for blocks of size 2^( 3) =       0.000546644040
  error estimate for blocks of size 2^( 4) =       0.000558891188
  error estimate for blocks of size 2^( 5) =       0.000568260819
  error estimate for blocks of size 2^( 6) =       0.000571808525
  error estimate for blocks of size 2^( 7) =       0.000572864970

      target function =      -0.597235675223
              le_mean =     -22.661602502997
             les_mean =     514.088112727224
             stat err =       0.000567956376
             autocorr =       1.238490547228
   target nu stat err =       0.000567956376
   target dn stat err =       0.008704534790
      target stat err =       0.002522091821
              std dev =       0.721744742249
             le_variance =       0.520915472964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521368180415
                                         uncertainty =       0.006541590609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521368180415
                                         uncertainty =       0.006541590609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510538502
  error estimate for blocks of size 2^( 2) =       0.000529412734
  error estimate for blocks of size 2^( 3) =       0.000546854206
  error estimate for blocks of size 2^( 4) =       0.000559112522
  error estimate for blocks of size 2^( 5) =       0.000568486110
  error estimate for blocks of size 2^( 6) =       0.000572043277
  error estimate for blocks of size 2^( 7) =       0.000573100524

      target function =      -0.597144469809
              le_mean =     -22.661600243991
             les_mean =     514.088325514555
             stat err =       0.000568185608
             autocorr =       1.238578278766
   target nu stat err =       0.000568185608
   target dn stat err =       0.008671197018
      target stat err =       0.002511790881
              std dev =       0.722010473193
             le_variance =       0.521299123400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521719218902
                                         uncertainty =       0.006549744161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521719218902
                                         uncertainty =       0.006549744161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510710282
  error estimate for blocks of size 2^( 2) =       0.000529596015
  error estimate for blocks of size 2^( 3) =       0.000547045916
  error estimate for blocks of size 2^( 4) =       0.000559314431
  error estimate for blocks of size 2^( 5) =       0.000568691323
  error estimate for blocks of size 2^( 6) =       0.000572256986
  error estimate for blocks of size 2^( 7) =       0.000573314856

      target function =      -0.596918687521
              le_mean =     -22.661598953858
             les_mean =     514.089050462344
             stat err =       0.000568394399
             autocorr =       1.238655045367
   target nu stat err =       0.000568394399
   target dn stat err =       0.008669643937
      target stat err =       0.002509467243
              std dev =       0.722253407735
             le_variance =       0.521649984985


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.596856057457        initial
     2.5000e+00     2.5000e+01             4.5888e-04        -0.597235675223  <--
     1.0000e+01     1.0000e+02             1.1607e-04        -0.597144469809
     4.0000e+01     4.0000e+02             2.9102e-05        -0.596918687521

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 8.6878e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_001                -7.004376e-01 3 1  ON 0
ci_002                -7.002225e-01 3 1  ON 1
ci_003                -6.153810e-02 3 1  ON 2
ci_004                -6.156355e-02 3 1  ON 3
ci_005                 4.384058e-02 3 1  ON 4
ci_006                 4.381239e-02 3 1  ON 5
ci_007                 3.099836e-02 3 1  ON 6
ci_008                 3.100123e-02 3 1  ON 7
ci_009                -2.416388e-02 3 1  ON 8
ci_010                -2.420410e-02 3 1  ON 9
ci_011                -2.187329e-02 3 1  ON 10
ci_012                -2.190216e-02 3 1  ON 11
ci_013                 1.966071e-02 3 1  ON 12
ci_014                 1.970308e-02 3 1  ON 13
ci_015                 1.937975e-02 3 1  ON 14
ci_016                 1.942201e-02 3 1  ON 15
ci_017                 1.525793e-02 3 1  ON 16
ci_018                 1.532183e-02 3 1  ON 17
ci_019                 9.566667e-03 3 1  ON 18
ci_020                 9.733216e-03 3 1  ON 19
ci_021                -9.711898e-03 3 1  ON 20
ci_022                -9.802800e-03 3 1  ON 21
ci_023                 8.487796e-03 3 1  ON 22
ci_024                 8.516939e-03 3 1  ON 23
ci_025                 7.994137e-03 3 1  ON 24
ci_026                 8.005135e-03 3 1  ON 25
ci_027                 7.800179e-03 3 1  ON 26
ci_028                 7.798052e-03 3 1  ON 27
ci_029                -7.710194e-03 3 1  ON 28
ci_030                -7.708004e-03 3 1  ON 29
ci_031                -7.300029e-03 3 1  ON 30
ci_032                -7.329826e-03 3 1  ON 31
ci_033                 6.753158e-03 3 1  ON 32
ci_034                 6.770553e-03 3 1  ON 33
ci_035                 6.321156e-03 3 1  ON 34
ci_036                 6.317648e-03 3 1  ON 35
ci_037                 6.507553e-03 3 1  ON 36
ci_038                 6.528402e-03 3 1  ON 37
ci_039                 5.518671e-03 3 1  ON 38
ci_040                 5.534116e-03 3 1  ON 39
ci_041                 4.948434e-03 3 1  ON 40
ci_042                 4.893200e-03 3 1  ON 41
ci_043                 4.957256e-03 3 1  ON 42
ci_044                 5.016223e-03 3 1  ON 43
ci_045                 4.852190e-03 3 1  ON 44
ci_046                 4.850074e-03 3 1  ON 45
ci_047                -4.128396e-03 3 1  ON 46
ci_048                -4.080023e-03 3 1  ON 47
ci_049                 3.229808e-03 3 1  ON 48
ci_050                 3.174344e-03 3 1  ON 49
ci_051                -2.801491e-03 3 1  ON 50
ci_052                -2.818073e-03 3 1  ON 51
ci_053                -2.686156e-03 3 1  ON 52
ci_054                -2.789979e-03 3 1  ON 53
ci_055                -2.209630e-03 3 1  ON 54
ci_056                -2.136682e-03 3 1  ON 55
ci_057                -1.919535e-03 3 1  ON 56
ci_058                -1.938000e-03 3 1  ON 57
ci_059                -1.764345e-03 3 1  ON 58
ci_060                -1.740565e-03 3 1  ON 59
ci_061                -1.528651e-03 3 1  ON 60
ci_062                -1.515628e-03 3 1  ON 61
ci_063                -1.367208e-03 3 1  ON 62
ci_064                -1.413334e-03 3 1  ON 63
ci_065                -1.394074e-03 3 1  ON 64
ci_066                -1.360532e-03 3 1  ON 65
ci_067                -1.324022e-03 3 1  ON 66
ci_068                -1.321670e-03 3 1  ON 67
ci_069                 1.179101e-03 3 1  ON 68
ci_070                 1.123911e-03 3 1  ON 69
ci_071                -1.205763e-03 3 1  ON 70
ci_072                -1.263516e-03 3 1  ON 71
ci_073                 9.883263e-04 3 1  ON 72
ci_074                 1.062355e-03 3 1  ON 73
ci_075                -9.345852e-04 3 1  ON 74
ci_076                -1.007109e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4766e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6482
    reference variance = 0.322845
====================================================
  Execution time = 5.1291e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 5.2039e-01
  Total weights = 1.954631550e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508282099357
                                         uncertainty =       0.003122337797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508282099357
                                         uncertainty =       0.003122337797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504168927
  error estimate for blocks of size 2^( 2) =       0.000522907484
  error estimate for blocks of size 2^( 3) =       0.000540637795
  error estimate for blocks of size 2^( 4) =       0.000554176495
  error estimate for blocks of size 2^( 5) =       0.000562390826
  error estimate for blocks of size 2^( 6) =       0.000567266364
  error estimate for blocks of size 2^( 7) =       0.000570356649

      target function =      -0.603027066415
              le_mean =     -22.662082144336
             les_mean =     514.090359992222
             stat err =       0.000563547583
             autocorr =       1.249421662926
   target nu stat err =       0.000563547583
   target dn stat err =       0.003695103562
      target stat err =       0.001119626183
              std dev =       0.713002534863
             le_variance =       0.508372614721


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266208214434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603028864152       residual = 5.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603545509182       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603589817049       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603593899033       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603594845867       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603595081401       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603595194143       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603595200626       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603595196989       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603595203271       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.603595205718       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 1.803378e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603028864152       residual = 5.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603163771697       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603175119928       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603176143961       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603176376428       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603176431716       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603176458064       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603176459477       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603176458609       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603176460134       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 4.717956e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603028864152       residual = 5.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603062969897       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603065824149       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603066080300       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603066138118       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603066151707       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603066158177       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603066158518       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603066158304       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603066158682       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.193347e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.387357 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0653e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_001                -7.005073e-01 3 1  ON 0
ci_002                -7.003213e-01 3 1  ON 1
ci_003                -6.139812e-02 3 1  ON 2
ci_004                -6.143187e-02 3 1  ON 3
ci_005                 4.336878e-02 3 1  ON 4
ci_006                 4.334747e-02 3 1  ON 5
ci_007                 3.075254e-02 3 1  ON 6
ci_008                 3.072012e-02 3 1  ON 7
ci_009                -2.396204e-02 3 1  ON 8
ci_010                -2.400768e-02 3 1  ON 9
ci_011                -2.167922e-02 3 1  ON 10
ci_012                -2.171079e-02 3 1  ON 11
ci_013                 1.946543e-02 3 1  ON 12
ci_014                 1.952324e-02 3 1  ON 13
ci_015                 1.922349e-02 3 1  ON 14
ci_016                 1.930553e-02 3 1  ON 15
ci_017                 1.514192e-02 3 1  ON 16
ci_018                 1.524200e-02 3 1  ON 17
ci_019                 9.459257e-03 3 1  ON 18
ci_020                 9.616157e-03 3 1  ON 19
ci_021                -9.709845e-03 3 1  ON 20
ci_022                -9.770722e-03 3 1  ON 21
ci_023                 8.439617e-03 3 1  ON 22
ci_024                 8.469609e-03 3 1  ON 23
ci_025                 8.010581e-03 3 1  ON 24
ci_026                 7.996135e-03 3 1  ON 25
ci_027                 7.770356e-03 3 1  ON 26
ci_028                 7.783167e-03 3 1  ON 27
ci_029                -7.685802e-03 3 1  ON 28
ci_030                -7.665045e-03 3 1  ON 29
ci_031                -7.168885e-03 3 1  ON 30
ci_032                -7.216324e-03 3 1  ON 31
ci_033                 6.709370e-03 3 1  ON 32
ci_034                 6.714561e-03 3 1  ON 33
ci_035                 6.243460e-03 3 1  ON 34
ci_036                 6.241069e-03 3 1  ON 35
ci_037                 6.473446e-03 3 1  ON 36
ci_038                 6.493112e-03 3 1  ON 37
ci_039                 5.507895e-03 3 1  ON 38
ci_040                 5.520923e-03 3 1  ON 39
ci_041                 4.914687e-03 3 1  ON 40
ci_042                 4.863250e-03 3 1  ON 41
ci_043                 4.938999e-03 3 1  ON 42
ci_044                 4.999875e-03 3 1  ON 43
ci_045                 4.791430e-03 3 1  ON 44
ci_046                 4.828636e-03 3 1  ON 45
ci_047                -4.078304e-03 3 1  ON 46
ci_048                -4.029169e-03 3 1  ON 47
ci_049                 3.195955e-03 3 1  ON 48
ci_050                 3.147316e-03 3 1  ON 49
ci_051                -2.790088e-03 3 1  ON 50
ci_052                -2.802713e-03 3 1  ON 51
ci_053                -2.688800e-03 3 1  ON 52
ci_054                -2.767572e-03 3 1  ON 53
ci_055                -2.211354e-03 3 1  ON 54
ci_056                -2.122168e-03 3 1  ON 55
ci_057                -1.908610e-03 3 1  ON 56
ci_058                -1.921400e-03 3 1  ON 57
ci_059                -1.731297e-03 3 1  ON 58
ci_060                -1.724011e-03 3 1  ON 59
ci_061                -1.521745e-03 3 1  ON 60
ci_062                -1.487444e-03 3 1  ON 61
ci_063                -1.361963e-03 3 1  ON 62
ci_064                -1.405785e-03 3 1  ON 63
ci_065                -1.386530e-03 3 1  ON 64
ci_066                -1.352507e-03 3 1  ON 65
ci_067                -1.315723e-03 3 1  ON 66
ci_068                -1.311688e-03 3 1  ON 67
ci_069                 1.159436e-03 3 1  ON 68
ci_070                 1.105326e-03 3 1  ON 69
ci_071                -1.225161e-03 3 1  ON 70
ci_072                -1.273404e-03 3 1  ON 71
ci_073                 1.000345e-03 3 1  ON 72
ci_074                 1.059025e-03 3 1  ON 73
ci_075                -9.212477e-04 3 1  ON 74
ci_076                -9.723188e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.5614
    reference variance = 0.579795
====================================================
  Execution time = 4.9815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.2571e-01
  Total weights = 1.9546e+06
  Execution time = 7.2389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506813378648
                                         uncertainty =       0.002674949820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506813378648
                                         uncertainty =       0.002674949820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503343884
  error estimate for blocks of size 2^( 2) =       0.000521752863
  error estimate for blocks of size 2^( 3) =       0.000538673638
  error estimate for blocks of size 2^( 4) =       0.000551773119
  error estimate for blocks of size 2^( 5) =       0.000558694060
  error estimate for blocks of size 2^( 6) =       0.000561967458
  error estimate for blocks of size 2^( 7) =       0.000566087390

      target function =      -0.404344213369
              le_mean =     -22.662905413324
             les_mean =     514.922190804434
             stat err =       0.000559630507
             autocorr =       1.236155681449
   target nu stat err =       0.000559630507
   target dn stat err =       0.781038145908
      target stat err =       0.110992635707
              std dev =       0.711835747801
             le_variance =       0.506710131847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507546189082
                                         uncertainty =       0.004827217956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507546189082
                                         uncertainty =       0.004827217956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503705716
  error estimate for blocks of size 2^( 2) =       0.000522000808
  error estimate for blocks of size 2^( 3) =       0.000538780139
  error estimate for blocks of size 2^( 4) =       0.000551757970
  error estimate for blocks of size 2^( 5) =       0.000558865012
  error estimate for blocks of size 2^( 6) =       0.000561984920
  error estimate for blocks of size 2^( 7) =       0.000565695522

      target function =      -0.458962221235
              le_mean =     -22.662880857195
             les_mean =     514.662613582355
             stat err =       0.000559575856
             autocorr =       1.234139284921
   target nu stat err =       0.000559575856
   target dn stat err =       0.530230909877
      target stat err =       0.094072340995
              std dev =       0.712347455113
             le_variance =       0.507438896805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505101291391
                                         uncertainty =       0.002687941308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505101291391
                                         uncertainty =       0.002687941308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502492882
  error estimate for blocks of size 2^( 2) =       0.000520843885
  error estimate for blocks of size 2^( 3) =       0.000537710582
  error estimate for blocks of size 2^( 4) =       0.000550785064
  error estimate for blocks of size 2^( 5) =       0.000557713062
  error estimate for blocks of size 2^( 6) =       0.000560947732
  error estimate for blocks of size 2^( 7) =       0.000565131495

      target function =      -0.598489720546
              le_mean =     -22.662917971495
             les_mean =     514.144394393064
             stat err =       0.000558644338
             autocorr =       1.235978668472
   target nu stat err =       0.000558644338
   target dn stat err =       0.013759888135
      target stat err =       0.003993427415
              std dev =       0.710632248223
             le_variance =       0.504998192214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506470574417
                                         uncertainty =       0.002673066686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506470574417
                                         uncertainty =       0.002673066686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503173676
  error estimate for blocks of size 2^( 2) =       0.000521578105
  error estimate for blocks of size 2^( 3) =       0.000538492294
  error estimate for blocks of size 2^( 4) =       0.000551595942
  error estimate for blocks of size 2^( 5) =       0.000558540788
  error estimate for blocks of size 2^( 6) =       0.000561779623
  error estimate for blocks of size 2^( 7) =       0.000565934452

      target function =      -0.598948155128
              le_mean =     -22.662912423174
             les_mean =     514.142597164468
             stat err =       0.000559462701
             autocorr =       1.236250416707
   target nu stat err =       0.000559462701
   target dn stat err =       0.010246774916
      target stat err =       0.002983820281
              std dev =       0.711595036816
             le_variance =       0.506367496421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.404344213369        initial
     6.2500e-01     6.2500e+00             1.8034e-03        -0.458962221235
     2.5000e+00     2.5000e+01             4.7180e-04        -0.598489720546
     1.0000e+01     1.0000e+02             1.1933e-04        -0.598948155128  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 8.6118e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_001                -7.004552e-01 3 1  ON 0
ci_002                -7.002474e-01 3 1  ON 1
ci_003                -6.150293e-02 3 1  ON 2
ci_004                -6.153048e-02 3 1  ON 3
ci_005                 4.372124e-02 3 1  ON 4
ci_006                 4.369479e-02 3 1  ON 5
ci_007                 3.093628e-02 3 1  ON 6
ci_008                 3.093022e-02 3 1  ON 7
ci_009                -2.411289e-02 3 1  ON 8
ci_010                -2.415448e-02 3 1  ON 9
ci_011                -2.182429e-02 3 1  ON 10
ci_012                -2.185383e-02 3 1  ON 11
ci_013                 1.961140e-02 3 1  ON 12
ci_014                 1.965767e-02 3 1  ON 13
ci_015                 1.934035e-02 3 1  ON 14
ci_016                 1.939264e-02 3 1  ON 15
ci_017                 1.522863e-02 3 1  ON 16
ci_018                 1.530166e-02 3 1  ON 17
ci_019                 9.539610e-03 3 1  ON 18
ci_020                 9.703721e-03 3 1  ON 19
ci_021                -9.711365e-03 3 1  ON 20
ci_022                -9.794700e-03 3 1  ON 21
ci_023                 8.475610e-03 3 1  ON 22
ci_024                 8.504967e-03 3 1  ON 23
ci_025                 7.998274e-03 3 1  ON 24
ci_026                 8.002841e-03 3 1  ON 25
ci_027                 7.792621e-03 3 1  ON 26
ci_028                 7.794279e-03 3 1  ON 27
ci_029                -7.704056e-03 3 1  ON 28
ci_030                -7.697179e-03 3 1  ON 29
ci_031                -7.266940e-03 3 1  ON 30
ci_032                -7.301185e-03 3 1  ON 31
ci_033                 6.742107e-03 3 1  ON 32
ci_034                 6.756415e-03 3 1  ON 33
ci_035                 6.301517e-03 3 1  ON 34
ci_036                 6.298285e-03 3 1  ON 35
ci_037                 6.498964e-03 3 1  ON 36
ci_038                 6.519513e-03 3 1  ON 37
ci_039                 5.515936e-03 3 1  ON 38
ci_040                 5.530771e-03 3 1  ON 39
ci_041                 4.939900e-03 3 1  ON 40
ci_042                 4.885630e-03 3 1  ON 41
ci_043                 4.952663e-03 3 1  ON 42
ci_044                 5.012123e-03 3 1  ON 43
ci_045                 4.836834e-03 3 1  ON 44
ci_046                 4.844650e-03 3 1  ON 45
ci_047                -4.115741e-03 3 1  ON 46
ci_048                -4.067184e-03 3 1  ON 47
ci_049                 3.221268e-03 3 1  ON 48
ci_050                 3.167521e-03 3 1  ON 49
ci_051                -2.798639e-03 3 1  ON 50
ci_052                -2.814222e-03 3 1  ON 51
ci_053                -2.686809e-03 3 1  ON 52
ci_054                -2.784304e-03 3 1  ON 53
ci_055                -2.210058e-03 3 1  ON 54
ci_056                -2.133023e-03 3 1  ON 55
ci_057                -1.916777e-03 3 1  ON 56
ci_058                -1.933809e-03 3 1  ON 57
ci_059                -1.755980e-03 3 1  ON 58
ci_060                -1.736374e-03 3 1  ON 59
ci_061                -1.526898e-03 3 1  ON 60
ci_062                -1.508518e-03 3 1  ON 61
ci_063                -1.365861e-03 3 1  ON 62
ci_064                -1.411414e-03 3 1  ON 63
ci_065                -1.392181e-03 3 1  ON 64
ci_066                -1.358517e-03 3 1  ON 65
ci_067                -1.321916e-03 3 1  ON 66
ci_068                -1.319149e-03 3 1  ON 67
ci_069                 1.174142e-03 3 1  ON 68
ci_070                 1.119224e-03 3 1  ON 69
ci_071                -1.210681e-03 3 1  ON 70
ci_072                -1.266025e-03 3 1  ON 71
ci_073                 9.913769e-04 3 1  ON 72
ci_074                 1.061520e-03 3 1  ON 73
ci_075                -9.312209e-04 3 1  ON 74
ci_076                -9.983293e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4678e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7649
    reference variance = 0.379372
====================================================
  Execution time = 5.1145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.1963e-01
  Total weights = 1.954441082e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508154384033
                                         uncertainty =       0.002921965959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508154384033
                                         uncertainty =       0.002921965959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503989656
  error estimate for blocks of size 2^( 2) =       0.000522757291
  error estimate for blocks of size 2^( 3) =       0.000540078854
  error estimate for blocks of size 2^( 4) =       0.000552780965
  error estimate for blocks of size 2^( 5) =       0.000558351593
  error estimate for blocks of size 2^( 6) =       0.000561599280
  error estimate for blocks of size 2^( 7) =       0.000562345701

      target function =      -0.603397958567
              le_mean =     -22.662689289397
             les_mean =     514.117115095291
             stat err =       0.000558769385
             autocorr =       1.229198322535
   target nu stat err =       0.000558769385
   target dn stat err =       0.003244313627
      target stat err =       0.000992796847
              std dev =       0.712749007476
             le_variance =       0.508011147658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266268928940e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603399287677       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603527477737       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603538830533       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603540065293       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603540351772       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603540382388       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603540401253       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603540402940       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603540403801       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603540402876       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 4.598748e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603399287677       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603431694904       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603434550171       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603434859489       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603434930574       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603434938085       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603434942682       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603434943080       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603434943308       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603434943067       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.163237e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603399287677       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603407412275       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603408127161       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603408204529       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603408222266       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603408224135       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603408225277       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603408225375       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603408225432       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 2.916802e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.392513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0635e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_001                -7.004793e-01 3 1  ON 0
ci_002                -7.002654e-01 3 1  ON 1
ci_003                -6.147097e-02 3 1  ON 2
ci_004                -6.149045e-02 3 1  ON 3
ci_005                 4.360492e-02 3 1  ON 4
ci_006                 4.358122e-02 3 1  ON 5
ci_007                 3.087560e-02 3 1  ON 6
ci_008                 3.086473e-02 3 1  ON 7
ci_009                -2.406471e-02 3 1  ON 8
ci_010                -2.410598e-02 3 1  ON 9
ci_011                -2.177237e-02 3 1  ON 10
ci_012                -2.180154e-02 3 1  ON 11
ci_013                 1.956331e-02 3 1  ON 12
ci_014                 1.961234e-02 3 1  ON 13
ci_015                 1.930971e-02 3 1  ON 14
ci_016                 1.936234e-02 3 1  ON 15
ci_017                 1.520410e-02 3 1  ON 16
ci_018                 1.527682e-02 3 1  ON 17
ci_019                 9.509070e-03 3 1  ON 18
ci_020                 9.677454e-03 3 1  ON 19
ci_021                -9.704322e-03 3 1  ON 20
ci_022                -9.788815e-03 3 1  ON 21
ci_023                 8.465352e-03 3 1  ON 22
ci_024                 8.492742e-03 3 1  ON 23
ci_025                 7.999683e-03 3 1  ON 24
ci_026                 8.003006e-03 3 1  ON 25
ci_027                 7.786670e-03 3 1  ON 26
ci_028                 7.788994e-03 3 1  ON 27
ci_029                -7.694769e-03 3 1  ON 28
ci_030                -7.685122e-03 3 1  ON 29
ci_031                -7.238602e-03 3 1  ON 30
ci_032                -7.268054e-03 3 1  ON 31
ci_033                 6.733367e-03 3 1  ON 32
ci_034                 6.742195e-03 3 1  ON 33
ci_035                 6.278531e-03 3 1  ON 34
ci_036                 6.279353e-03 3 1  ON 35
ci_037                 6.489386e-03 3 1  ON 36
ci_038                 6.508300e-03 3 1  ON 37
ci_039                 5.505194e-03 3 1  ON 38
ci_040                 5.522844e-03 3 1  ON 39
ci_041                 4.933201e-03 3 1  ON 40
ci_042                 4.876769e-03 3 1  ON 41
ci_043                 4.945242e-03 3 1  ON 42
ci_044                 5.008134e-03 3 1  ON 43
ci_045                 4.824743e-03 3 1  ON 44
ci_046                 4.832722e-03 3 1  ON 45
ci_047                -4.104888e-03 3 1  ON 46
ci_048                -4.057088e-03 3 1  ON 47
ci_049                 3.208264e-03 3 1  ON 48
ci_050                 3.155716e-03 3 1  ON 49
ci_051                -2.794817e-03 3 1  ON 50
ci_052                -2.810911e-03 3 1  ON 51
ci_053                -2.684649e-03 3 1  ON 52
ci_054                -2.782599e-03 3 1  ON 53
ci_055                -2.207489e-03 3 1  ON 54
ci_056                -2.125025e-03 3 1  ON 55
ci_057                -1.913539e-03 3 1  ON 56
ci_058                -1.927567e-03 3 1  ON 57
ci_059                -1.751299e-03 3 1  ON 58
ci_060                -1.732157e-03 3 1  ON 59
ci_061                -1.523849e-03 3 1  ON 60
ci_062                -1.503513e-03 3 1  ON 61
ci_063                -1.364186e-03 3 1  ON 62
ci_064                -1.404055e-03 3 1  ON 63
ci_065                -1.395302e-03 3 1  ON 64
ci_066                -1.362472e-03 3 1  ON 65
ci_067                -1.320742e-03 3 1  ON 66
ci_068                -1.320894e-03 3 1  ON 67
ci_069                 1.172682e-03 3 1  ON 68
ci_070                 1.117434e-03 3 1  ON 69
ci_071                -1.213612e-03 3 1  ON 70
ci_072                -1.268696e-03 3 1  ON 71
ci_073                 9.892034e-04 3 1  ON 72
ci_074                 1.056725e-03 3 1  ON 73
ci_075                -9.277300e-04 3 1  ON 74
ci_076                -9.947727e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.759
    reference variance = 1.02762
====================================================
  Execution time = 5.0369e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 5.3241e-01
  Total weights = 1.9546e+06
  Execution time = 7.2868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511461948034
                                         uncertainty =       0.003017982647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511461948034
                                         uncertainty =       0.003017982647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505693164
  error estimate for blocks of size 2^( 2) =       0.000524381008
  error estimate for blocks of size 2^( 3) =       0.000541204967
  error estimate for blocks of size 2^( 4) =       0.000553328762
  error estimate for blocks of size 2^( 5) =       0.000561229236
  error estimate for blocks of size 2^( 6) =       0.000565349713
  error estimate for blocks of size 2^( 7) =       0.000566874033

      target function =      -0.599543215151
              le_mean =     -22.662351065903
             les_mean =     514.114679553524
             stat err =       0.000561695436
             autocorr =       1.233751304838
   target nu stat err =       0.000561695436
   target dn stat err =       0.006703702737
      target stat err =       0.001965906776
              std dev =       0.715158130420
             le_variance =       0.511451151506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510678572009
                                         uncertainty =       0.003020451404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510678572009
                                         uncertainty =       0.003020451404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505305900
  error estimate for blocks of size 2^( 2) =       0.000523968594
  error estimate for blocks of size 2^( 3) =       0.000540776301
  error estimate for blocks of size 2^( 4) =       0.000552882981
  error estimate for blocks of size 2^( 5) =       0.000560776594
  error estimate for blocks of size 2^( 6) =       0.000564897937
  error estimate for blocks of size 2^( 7) =       0.000566412781

      target function =      -0.599488002119
              le_mean =     -22.662353683944
             les_mean =     514.114986659226
             stat err =       0.000561242573
             autocorr =       1.233651455751
   target nu stat err =       0.000561242573
   target dn stat err =       0.007263533830
      target stat err =       0.002126646830
              std dev =       0.714610457067
             le_variance =       0.510668105349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511060751963
                                         uncertainty =       0.003018692829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511060751963
                                         uncertainty =       0.003018692829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505494871
  error estimate for blocks of size 2^( 2) =       0.000524170079
  error estimate for blocks of size 2^( 3) =       0.000540985681
  error estimate for blocks of size 2^( 4) =       0.000553100956
  error estimate for blocks of size 2^( 5) =       0.000560998271
  error estimate for blocks of size 2^( 6) =       0.000565119176
  error estimate for blocks of size 2^( 7) =       0.000566638906

      target function =      -0.599509960349
              le_mean =     -22.662351875346
             les_mean =     514.114829654820
             stat err =       0.000561464327
             autocorr =       1.233703595702
   target nu stat err =       0.000561464327
   target dn stat err =       0.006967085125
      target stat err =       0.002041456915
              std dev =       0.714877701617
             le_variance =       0.511050128270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511411086796
                                         uncertainty =       0.003018016798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511411086796
                                         uncertainty =       0.003018016798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505668030
  error estimate for blocks of size 2^( 2) =       0.000524354276
  error estimate for blocks of size 2^( 3) =       0.000541177184
  error estimate for blocks of size 2^( 4) =       0.000553299913
  error estimate for blocks of size 2^( 5) =       0.000561199962
  error estimate for blocks of size 2^( 6) =       0.000565320486
  error estimate for blocks of size 2^( 7) =       0.000566844223

      target function =      -0.599551455990
              le_mean =     -22.662351110557
             les_mean =     514.114653040460
             stat err =       0.000561666146
             autocorr =       1.233745274588
   target nu stat err =       0.000561666146
   target dn stat err =       0.006734126281
      target stat err =       0.001974710225
              std dev =       0.715122585644
             le_variance =       0.511400312499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.599543215151        initial
     2.5000e+00     2.5000e+01             4.5987e-04        -0.599488002119
     1.0000e+01     1.0000e+02             1.1632e-04        -0.599509960349
     4.0000e+01     4.0000e+02             2.9168e-05        -0.599551455990  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 8.6866e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_001                -7.004612e-01 3 1  ON 0
ci_002                -7.002520e-01 3 1  ON 1
ci_003                -6.149493e-02 3 1  ON 2
ci_004                -6.152046e-02 3 1  ON 3
ci_005                 4.369207e-02 3 1  ON 4
ci_006                 4.366632e-02 3 1  ON 5
ci_007                 3.092108e-02 3 1  ON 6
ci_008                 3.091382e-02 3 1  ON 7
ci_009                -2.410082e-02 3 1  ON 8
ci_010                -2.414233e-02 3 1  ON 9
ci_011                -2.181127e-02 3 1  ON 10
ci_012                -2.184072e-02 3 1  ON 11
ci_013                 1.959935e-02 3 1  ON 12
ci_014                 1.964631e-02 3 1  ON 13
ci_015                 1.933267e-02 3 1  ON 14
ci_016                 1.938505e-02 3 1  ON 15
ci_017                 1.522248e-02 3 1  ON 16
ci_018                 1.529543e-02 3 1  ON 17
ci_019                 9.531957e-03 3 1  ON 18
ci_020                 9.697139e-03 3 1  ON 19
ci_021                -9.709600e-03 3 1  ON 20
ci_022                -9.793224e-03 3 1  ON 21
ci_023                 8.473040e-03 3 1  ON 22
ci_024                 8.501906e-03 3 1  ON 23
ci_025                 7.998625e-03 3 1  ON 24
ci_026                 8.002884e-03 3 1  ON 25
ci_027                 7.791129e-03 3 1  ON 26
ci_028                 7.792953e-03 3 1  ON 27
ci_029                -7.701730e-03 3 1  ON 28
ci_030                -7.694157e-03 3 1  ON 29
ci_031                -7.259830e-03 3 1  ON 30
ci_032                -7.292874e-03 3 1  ON 31
ci_033                 6.739913e-03 3 1  ON 32
ci_034                 6.752848e-03 3 1  ON 33
ci_035                 6.295764e-03 3 1  ON 34
ci_036                 6.293526e-03 3 1  ON 35
ci_037                 6.496568e-03 3 1  ON 36
ci_038                 6.516707e-03 3 1  ON 37
ci_039                 5.513242e-03 3 1  ON 38
ci_040                 5.528784e-03 3 1  ON 39
ci_041                 4.938222e-03 3 1  ON 40
ci_042                 4.883407e-03 3 1  ON 41
ci_043                 4.950803e-03 3 1  ON 42
ci_044                 5.011126e-03 3 1  ON 43
ci_045                 4.833804e-03 3 1  ON 44
ci_046                 4.841657e-03 3 1  ON 45
ci_047                -4.113019e-03 3 1  ON 46
ci_048                -4.064651e-03 3 1  ON 47
ci_049                 3.218007e-03 3 1  ON 48
ci_050                 3.164561e-03 3 1  ON 49
ci_051                -2.797682e-03 3 1  ON 50
ci_052                -2.813395e-03 3 1  ON 51
ci_053                -2.686258e-03 3 1  ON 52
ci_054                -2.783869e-03 3 1  ON 53
ci_055                -2.209411e-03 3 1  ON 54
ci_056                -2.131018e-03 3 1  ON 55
ci_057                -1.915965e-03 3 1  ON 56
ci_058                -1.932241e-03 3 1  ON 57
ci_059                -1.754808e-03 3 1  ON 58
ci_060                -1.735324e-03 3 1  ON 59
ci_061                -1.526134e-03 3 1  ON 60
ci_062                -1.507266e-03 3 1  ON 61
ci_063                -1.365438e-03 3 1  ON 62
ci_064                -1.409566e-03 3 1  ON 63
ci_065                -1.392965e-03 3 1  ON 64
ci_066                -1.359511e-03 3 1  ON 65
ci_067                -1.321619e-03 3 1  ON 66
ci_068                -1.319586e-03 3 1  ON 67
ci_069                 1.173776e-03 3 1  ON 68
ci_070                 1.118774e-03 3 1  ON 69
ci_071                -1.211411e-03 3 1  ON 70
ci_072                -1.266693e-03 3 1  ON 71
ci_073                 9.908291e-04 3 1  ON 72
ci_074                 1.060314e-03 3 1  ON 73
ci_075                -9.303432e-04 3 1  ON 74
ci_076                -9.974354e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4751e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7117
    reference variance = 0.391782
====================================================
  Execution time = 5.1036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.2104e-01
  Total weights = 1.954730189e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506766866997
                                         uncertainty =       0.002586310858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506766866997
                                         uncertainty =       0.002586310858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503360543
  error estimate for blocks of size 2^( 2) =       0.000522372523
  error estimate for blocks of size 2^( 3) =       0.000539705415
  error estimate for blocks of size 2^( 4) =       0.000551894148
  error estimate for blocks of size 2^( 5) =       0.000559028948
  error estimate for blocks of size 2^( 6) =       0.000564458853
  error estimate for blocks of size 2^( 7) =       0.000565842159

      target function =      -0.603113462127
              le_mean =     -22.663235377345
             les_mean =     514.143279729532
             stat err =       0.000560306027
             autocorr =       1.239059749364
   target nu stat err =       0.000560306027
   target dn stat err =       0.003303859463
      target stat err =       0.001009388166
              std dev =       0.711859306621
             le_variance =       0.506743672423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266323537735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603114849818       residual = 4.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603147313407       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603150064578       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603150351529       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603150406701       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603150421502       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603150428637       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603150430179       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603150429289       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603150428233       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.603150428196       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.145719e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603114849818       residual = 4.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603122988669       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603123677525       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603123749271       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603123763048       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603123766733       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603123768507       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603123768890       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603123768667       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603123768405       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.603123768396       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 2.872758e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603114849818       residual = 4.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603116885970       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603117058251       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603117076188       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603117079631       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603117080552       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603117080995       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603117081090       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603117081034       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603117080969       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.603117080966       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+02 is 7.187201e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.398699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0412e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_001                -7.004705e-01 3 1  ON 0
ci_002                -7.002527e-01 3 1  ON 1
ci_003                -6.148844e-02 3 1  ON 2
ci_004                -6.151295e-02 3 1  ON 3
ci_005                 4.366335e-02 3 1  ON 4
ci_006                 4.363795e-02 3 1  ON 5
ci_007                 3.090582e-02 3 1  ON 6
ci_008                 3.089830e-02 3 1  ON 7
ci_009                -2.408889e-02 3 1  ON 8
ci_010                -2.412921e-02 3 1  ON 9
ci_011                -2.179923e-02 3 1  ON 10
ci_012                -2.182842e-02 3 1  ON 11
ci_013                 1.958821e-02 3 1  ON 12
ci_014                 1.963591e-02 3 1  ON 13
ci_015                 1.932404e-02 3 1  ON 14
ci_016                 1.937783e-02 3 1  ON 15
ci_017                 1.521534e-02 3 1  ON 16
ci_018                 1.528868e-02 3 1  ON 17
ci_019                 9.525798e-03 3 1  ON 18
ci_020                 9.690986e-03 3 1  ON 19
ci_021                -9.708676e-03 3 1  ON 20
ci_022                -9.789679e-03 3 1  ON 21
ci_023                 8.469473e-03 3 1  ON 22
ci_024                 8.498878e-03 3 1  ON 23
ci_025                 8.001113e-03 3 1  ON 24
ci_026                 8.004176e-03 3 1  ON 25
ci_027                 7.790044e-03 3 1  ON 26
ci_028                 7.791105e-03 3 1  ON 27
ci_029                -7.698393e-03 3 1  ON 28
ci_030                -7.691519e-03 3 1  ON 29
ci_031                -7.253082e-03 3 1  ON 30
ci_032                -7.284390e-03 3 1  ON 31
ci_033                 6.737982e-03 3 1  ON 32
ci_034                 6.749686e-03 3 1  ON 33
ci_035                 6.290279e-03 3 1  ON 34
ci_036                 6.288734e-03 3 1  ON 35
ci_037                 6.492232e-03 3 1  ON 36
ci_038                 6.515022e-03 3 1  ON 37
ci_039                 5.511968e-03 3 1  ON 38
ci_040                 5.527152e-03 3 1  ON 39
ci_041                 4.936299e-03 3 1  ON 40
ci_042                 4.881370e-03 3 1  ON 41
ci_043                 4.948745e-03 3 1  ON 42
ci_044                 5.010918e-03 3 1  ON 43
ci_045                 4.832899e-03 3 1  ON 44
ci_046                 4.839169e-03 3 1  ON 45
ci_047                -4.110163e-03 3 1  ON 46
ci_048                -4.062528e-03 3 1  ON 47
ci_049                 3.215378e-03 3 1  ON 48
ci_050                 3.160644e-03 3 1  ON 49
ci_051                -2.798334e-03 3 1  ON 50
ci_052                -2.812149e-03 3 1  ON 51
ci_053                -2.685613e-03 3 1  ON 52
ci_054                -2.782282e-03 3 1  ON 53
ci_055                -2.209676e-03 3 1  ON 54
ci_056                -2.132076e-03 3 1  ON 55
ci_057                -1.915111e-03 3 1  ON 56
ci_058                -1.931312e-03 3 1  ON 57
ci_059                -1.752900e-03 3 1  ON 58
ci_060                -1.733231e-03 3 1  ON 59
ci_061                -1.525357e-03 3 1  ON 60
ci_062                -1.507539e-03 3 1  ON 61
ci_063                -1.361486e-03 3 1  ON 62
ci_064                -1.407902e-03 3 1  ON 63
ci_065                -1.393546e-03 3 1  ON 64
ci_066                -1.358445e-03 3 1  ON 65
ci_067                -1.322342e-03 3 1  ON 66
ci_068                -1.319286e-03 3 1  ON 67
ci_069                 1.172299e-03 3 1  ON 68
ci_070                 1.118337e-03 3 1  ON 69
ci_071                -1.212401e-03 3 1  ON 70
ci_072                -1.268990e-03 3 1  ON 71
ci_073                 9.896926e-04 3 1  ON 72
ci_074                 1.059280e-03 3 1  ON 73
ci_075                -9.284389e-04 3 1  ON 74
ci_076                -9.967795e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6492
    reference variance = 0.423319
====================================================
  Execution time = 4.9624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.1538e-01
  Total weights = 1.9546e+06
  Execution time = 7.2228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504641850114
                                         uncertainty =       0.002573278002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504641850114
                                         uncertainty =       0.002573278002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502267877
  error estimate for blocks of size 2^( 2) =       0.000521162673
  error estimate for blocks of size 2^( 3) =       0.000538320160
  error estimate for blocks of size 2^( 4) =       0.000550619432
  error estimate for blocks of size 2^( 5) =       0.000556990831
  error estimate for blocks of size 2^( 6) =       0.000559863159
  error estimate for blocks of size 2^( 7) =       0.000561073945

      target function =      -0.604600502428
              le_mean =     -22.662553647706
             les_mean =     514.106777328192
             stat err =       0.000557136842
             autocorr =       1.230418776242
   target nu stat err =       0.000557136842
   target dn stat err =       0.003186087937
      target stat err =       0.000979747063
              std dev =       0.710314043053
             le_variance =       0.504546039759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504444330402
                                         uncertainty =       0.002573247558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504444330402
                                         uncertainty =       0.002573247558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502169552
  error estimate for blocks of size 2^( 2) =       0.000521057355
  error estimate for blocks of size 2^( 3) =       0.000538209215
  error estimate for blocks of size 2^( 4) =       0.000550504564
  error estimate for blocks of size 2^( 5) =       0.000556873973
  error estimate for blocks of size 2^( 6) =       0.000559740660
  error estimate for blocks of size 2^( 7) =       0.000560953237

      target function =      -0.604611410423
              le_mean =     -22.662553468858
             les_mean =     514.106732120184
             stat err =       0.000557018109
             autocorr =       1.230376069261
   target nu stat err =       0.000557018109
   target dn stat err =       0.003195423065
      target stat err =       0.000982414280
              std dev =       0.710174990742
             le_variance =       0.504348517475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504542586605
                                         uncertainty =       0.002573257006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504542586605
                                         uncertainty =       0.002573257006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502218466
  error estimate for blocks of size 2^( 2) =       0.000521109756
  error estimate for blocks of size 2^( 3) =       0.000538264412
  error estimate for blocks of size 2^( 4) =       0.000550561703
  error estimate for blocks of size 2^( 5) =       0.000556932081
  error estimate for blocks of size 2^( 6) =       0.000559801592
  error estimate for blocks of size 2^( 7) =       0.000561013354

      target function =      -0.604626588884
              le_mean =     -22.662553534506
             les_mean =     514.106683800165
             stat err =       0.000557077182
             autocorr =       1.230397347390
   target nu stat err =       0.000557077182
   target dn stat err =       0.003185852901
      target stat err =       0.000979753457
              std dev =       0.710244165867
             le_variance =       0.504446775148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504629408298
                                         uncertainty =       0.002573274715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504629408298
                                         uncertainty =       0.002573274715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502261684
  error estimate for blocks of size 2^( 2) =       0.000521156041
  error estimate for blocks of size 2^( 3) =       0.000538313172
  error estimate for blocks of size 2^( 4) =       0.000550612196
  error estimate for blocks of size 2^( 5) =       0.000556983464
  error estimate for blocks of size 2^( 6) =       0.000559855439
  error estimate for blocks of size 2^( 7) =       0.000561066353

      target function =      -0.604605197838
              le_mean =     -22.662553630154
             les_mean =     514.106760624024
             stat err =       0.000557129363
             autocorr =       1.230416085314
   target nu stat err =       0.000557129363
   target dn stat err =       0.003185854623
      target stat err =       0.000979694456
              std dev =       0.710305284950
             le_variance =       0.504533597827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.604600502428        initial
     1.0000e+01     1.0000e+02             1.1457e-04        -0.604611410423
     4.0000e+01     4.0000e+02             2.8728e-05        -0.604626588884  <--
     1.6000e+02     1.6000e+03             7.1872e-06        -0.604605197838

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 8.5836e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_001                -7.004705e-01 3 1  ON 0
ci_002                -7.002527e-01 3 1  ON 1
ci_003                -6.148844e-02 3 1  ON 2
ci_004                -6.151295e-02 3 1  ON 3
ci_005                 4.366335e-02 3 1  ON 4
ci_006                 4.363795e-02 3 1  ON 5
ci_007                 3.090582e-02 3 1  ON 6
ci_008                 3.089830e-02 3 1  ON 7
ci_009                -2.408889e-02 3 1  ON 8
ci_010                -2.412921e-02 3 1  ON 9
ci_011                -2.179923e-02 3 1  ON 10
ci_012                -2.182842e-02 3 1  ON 11
ci_013                 1.958821e-02 3 1  ON 12
ci_014                 1.963591e-02 3 1  ON 13
ci_015                 1.932404e-02 3 1  ON 14
ci_016                 1.937783e-02 3 1  ON 15
ci_017                 1.521534e-02 3 1  ON 16
ci_018                 1.528868e-02 3 1  ON 17
ci_019                 9.525798e-03 3 1  ON 18
ci_020                 9.690986e-03 3 1  ON 19
ci_021                -9.708676e-03 3 1  ON 20
ci_022                -9.789679e-03 3 1  ON 21
ci_023                 8.469473e-03 3 1  ON 22
ci_024                 8.498878e-03 3 1  ON 23
ci_025                 8.001113e-03 3 1  ON 24
ci_026                 8.004176e-03 3 1  ON 25
ci_027                 7.790044e-03 3 1  ON 26
ci_028                 7.791105e-03 3 1  ON 27
ci_029                -7.698393e-03 3 1  ON 28
ci_030                -7.691519e-03 3 1  ON 29
ci_031                -7.253082e-03 3 1  ON 30
ci_032                -7.284390e-03 3 1  ON 31
ci_033                 6.737982e-03 3 1  ON 32
ci_034                 6.749686e-03 3 1  ON 33
ci_035                 6.290279e-03 3 1  ON 34
ci_036                 6.288734e-03 3 1  ON 35
ci_037                 6.492232e-03 3 1  ON 36
ci_038                 6.515022e-03 3 1  ON 37
ci_039                 5.511968e-03 3 1  ON 38
ci_040                 5.527152e-03 3 1  ON 39
ci_041                 4.936299e-03 3 1  ON 40
ci_042                 4.881370e-03 3 1  ON 41
ci_043                 4.948745e-03 3 1  ON 42
ci_044                 5.010918e-03 3 1  ON 43
ci_045                 4.832899e-03 3 1  ON 44
ci_046                 4.839169e-03 3 1  ON 45
ci_047                -4.110163e-03 3 1  ON 46
ci_048                -4.062528e-03 3 1  ON 47
ci_049                 3.215378e-03 3 1  ON 48
ci_050                 3.160644e-03 3 1  ON 49
ci_051                -2.798334e-03 3 1  ON 50
ci_052                -2.812149e-03 3 1  ON 51
ci_053                -2.685613e-03 3 1  ON 52
ci_054                -2.782282e-03 3 1  ON 53
ci_055                -2.209676e-03 3 1  ON 54
ci_056                -2.132076e-03 3 1  ON 55
ci_057                -1.915111e-03 3 1  ON 56
ci_058                -1.931312e-03 3 1  ON 57
ci_059                -1.752900e-03 3 1  ON 58
ci_060                -1.733231e-03 3 1  ON 59
ci_061                -1.525357e-03 3 1  ON 60
ci_062                -1.507539e-03 3 1  ON 61
ci_063                -1.361486e-03 3 1  ON 62
ci_064                -1.407902e-03 3 1  ON 63
ci_065                -1.393546e-03 3 1  ON 64
ci_066                -1.358445e-03 3 1  ON 65
ci_067                -1.322342e-03 3 1  ON 66
ci_068                -1.319286e-03 3 1  ON 67
ci_069                 1.172299e-03 3 1  ON 68
ci_070                 1.118337e-03 3 1  ON 69
ci_071                -1.212401e-03 3 1  ON 70
ci_072                -1.268990e-03 3 1  ON 71
ci_073                 9.896926e-04 3 1  ON 72
ci_074                 1.059280e-03 3 1  ON 73
ci_075                -9.284389e-04 3 1  ON 74
ci_076                -9.967795e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4625e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6549
    reference variance = 0.375841
====================================================
  Execution time = 5.1060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 5.4317e-01
  Total weights = 1.954416979e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520927478102
                                         uncertainty =       0.006272801150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520927478102
                                         uncertainty =       0.006272801150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510417880
  error estimate for blocks of size 2^( 2) =       0.000529308913
  error estimate for blocks of size 2^( 3) =       0.000546233296
  error estimate for blocks of size 2^( 4) =       0.000557534360
  error estimate for blocks of size 2^( 5) =       0.000563792201
  error estimate for blocks of size 2^( 6) =       0.000568238692
  error estimate for blocks of size 2^( 7) =       0.000570319482

      target function =      -0.596339190048
              le_mean =     -22.661838071003
             les_mean =     514.102077300020
             stat err =       0.000564971184
             autocorr =       1.225182644971
   target nu stat err =       0.000564971184
   target dn stat err =       0.010657302131
      target stat err =       0.003073102036
              std dev =       0.721839888376
             le_variance =       0.521052824451


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266183807100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.596354628641       residual = 8.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.596394376588       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.596401695453       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.596402919053       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.596403032854       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.596403073848       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.596403075260       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.596403081604       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.596403081921       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.596403082358       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.596403082937       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.596403082952       residual = 9.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.173120e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.596354628641       residual = 8.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.596364598680       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.596366430613       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.596366736522       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.596366764963       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.596366775186       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.596366775530       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.596366777110       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.596366777188       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.596366777297       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.596366777441       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.596366777444       residual = 8.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 2.941441e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.596354628641       residual = 8.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.596357123225       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.596357581346       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.596357657824       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.596357664934       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.596357667488       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.596357667573       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.596357667968       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.596357667987       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.596357668015       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.596357668050       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.596357668051       residual = 8.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+02 is 7.359021e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.405815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0473e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_001                -7.004786e-01 3 1  ON 0
ci_002                -7.002553e-01 3 1  ON 1
ci_003                -6.148122e-02 3 1  ON 2
ci_004                -6.150378e-02 3 1  ON 3
ci_005                 4.363431e-02 3 1  ON 4
ci_006                 4.360854e-02 3 1  ON 5
ci_007                 3.089126e-02 3 1  ON 6
ci_008                 3.088322e-02 3 1  ON 7
ci_009                -2.407644e-02 3 1  ON 8
ci_010                -2.410816e-02 3 1  ON 9
ci_011                -2.178664e-02 3 1  ON 10
ci_012                -2.181673e-02 3 1  ON 11
ci_013                 1.957697e-02 3 1  ON 12
ci_014                 1.962316e-02 3 1  ON 13
ci_015                 1.931622e-02 3 1  ON 14
ci_016                 1.937506e-02 3 1  ON 15
ci_017                 1.520319e-02 3 1  ON 16
ci_018                 1.528442e-02 3 1  ON 17
ci_019                 9.517265e-03 3 1  ON 18
ci_020                 9.685341e-03 3 1  ON 19
ci_021                -9.704282e-03 3 1  ON 20
ci_022                -9.782213e-03 3 1  ON 21
ci_023                 8.466527e-03 3 1  ON 22
ci_024                 8.495392e-03 3 1  ON 23
ci_025                 8.003263e-03 3 1  ON 24
ci_026                 8.004962e-03 3 1  ON 25
ci_027                 7.788742e-03 3 1  ON 26
ci_028                 7.791286e-03 3 1  ON 27
ci_029                -7.696197e-03 3 1  ON 28
ci_030                -7.691720e-03 3 1  ON 29
ci_031                -7.244314e-03 3 1  ON 30
ci_032                -7.273404e-03 3 1  ON 31
ci_033                 6.726210e-03 3 1  ON 32
ci_034                 6.747730e-03 3 1  ON 33
ci_035                 6.285241e-03 3 1  ON 34
ci_036                 6.279131e-03 3 1  ON 35
ci_037                 6.490097e-03 3 1  ON 36
ci_038                 6.511896e-03 3 1  ON 37
ci_039                 5.510325e-03 3 1  ON 38
ci_040                 5.525262e-03 3 1  ON 39
ci_041                 4.933850e-03 3 1  ON 40
ci_042                 4.879893e-03 3 1  ON 41
ci_043                 4.949041e-03 3 1  ON 42
ci_044                 5.008857e-03 3 1  ON 43
ci_045                 4.838560e-03 3 1  ON 44
ci_046                 4.837695e-03 3 1  ON 45
ci_047                -4.106712e-03 3 1  ON 46
ci_048                -4.061602e-03 3 1  ON 47
ci_049                 3.211975e-03 3 1  ON 48
ci_050                 3.156038e-03 3 1  ON 49
ci_051                -2.797581e-03 3 1  ON 50
ci_052                -2.811130e-03 3 1  ON 51
ci_053                -2.685759e-03 3 1  ON 52
ci_054                -2.783352e-03 3 1  ON 53
ci_055                -2.209676e-03 3 1  ON 54
ci_056                -2.131105e-03 3 1  ON 55
ci_057                -1.914640e-03 3 1  ON 56
ci_058                -1.932012e-03 3 1  ON 57
ci_059                -1.752269e-03 3 1  ON 58
ci_060                -1.733936e-03 3 1  ON 59
ci_061                -1.523907e-03 3 1  ON 60
ci_062                -1.506963e-03 3 1  ON 61
ci_063                -1.360374e-03 3 1  ON 62
ci_064                -1.406942e-03 3 1  ON 63
ci_065                -1.395242e-03 3 1  ON 64
ci_066                -1.362520e-03 3 1  ON 65
ci_067                -1.322440e-03 3 1  ON 66
ci_068                -1.320149e-03 3 1  ON 67
ci_069                 1.171217e-03 3 1  ON 68
ci_070                 1.118788e-03 3 1  ON 69
ci_071                -1.213906e-03 3 1  ON 70
ci_072                -1.269829e-03 3 1  ON 71
ci_073                 9.888555e-04 3 1  ON 72
ci_074                 1.057472e-03 3 1  ON 73
ci_075                -9.272919e-04 3 1  ON 74
ci_076                -9.947444e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6699
    reference variance = 0.386929
====================================================
  Execution time = 5.0186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 5.2828e-01
  Total weights = 1.9546e+06
  Execution time = 7.2290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513656846501
                                         uncertainty =       0.003312387769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513656846501
                                         uncertainty =       0.003312387769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506756473
  error estimate for blocks of size 2^( 2) =       0.000525177733
  error estimate for blocks of size 2^( 3) =       0.000542541126
  error estimate for blocks of size 2^( 4) =       0.000554069243
  error estimate for blocks of size 2^( 5) =       0.000562259552
  error estimate for blocks of size 2^( 6) =       0.000566325851
  error estimate for blocks of size 2^( 7) =       0.000567194281

      target function =      -0.600686189659
              le_mean =     -22.662034487192
             les_mean =     514.096157389556
             stat err =       0.000562462232
             autocorr =       1.231935930722
   target nu stat err =       0.000562462232
   target dn stat err =       0.004665125578
      target stat err =       0.001386847448
              std dev =       0.716661877032
             le_variance =       0.513604245990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513441819405
                                         uncertainty =       0.003307278958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513441819405
                                         uncertainty =       0.003307278958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506650401
  error estimate for blocks of size 2^( 2) =       0.000525065737
  error estimate for blocks of size 2^( 3) =       0.000542422169
  error estimate for blocks of size 2^( 4) =       0.000553945172
  error estimate for blocks of size 2^( 5) =       0.000562131611
  error estimate for blocks of size 2^( 6) =       0.000566193488
  error estimate for blocks of size 2^( 7) =       0.000567057793

      target function =      -0.600763790454
              le_mean =     -22.662034441133
             les_mean =     514.095889050968
             stat err =       0.000562332016
             autocorr =       1.231881234989
   target nu stat err =       0.000562332016
   target dn stat err =       0.004665940671
      target stat err =       0.001387419368
              std dev =       0.716511868210
             le_variance =       0.513389257286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513548721113
                                         uncertainty =       0.003309798693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513548721113
                                         uncertainty =       0.003309798693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506703138
  error estimate for blocks of size 2^( 2) =       0.000525121425
  error estimate for blocks of size 2^( 3) =       0.000542481327
  error estimate for blocks of size 2^( 4) =       0.000554006870
  error estimate for blocks of size 2^( 5) =       0.000562195241
  error estimate for blocks of size 2^( 6) =       0.000566259294
  error estimate for blocks of size 2^( 7) =       0.000567125655

      target function =      -0.600726953668
              le_mean =     -22.662034427227
             les_mean =     514.096014771926
             stat err =       0.000562396765
             autocorr =       1.231908466778
   target nu stat err =       0.000562396765
   target dn stat err =       0.004665432288
      target stat err =       0.001387113383
              std dev =       0.716586449843
             le_variance =       0.513496140098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513643287183
                                         uncertainty =       0.003312061035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513643287183
                                         uncertainty =       0.003312061035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506749785
  error estimate for blocks of size 2^( 2) =       0.000525170672
  error estimate for blocks of size 2^( 3) =       0.000542533629
  error estimate for blocks of size 2^( 4) =       0.000554061423
  error estimate for blocks of size 2^( 5) =       0.000562251490
  error estimate for blocks of size 2^( 6) =       0.000566317503
  error estimate for blocks of size 2^( 7) =       0.000567185675

      target function =      -0.600691547853
              le_mean =     -22.662034475493
             les_mean =     514.096138466148
             stat err =       0.000562454023
             autocorr =       1.231932487187
   target nu stat err =       0.000562454023
   target dn stat err =       0.004665151687
      target stat err =       0.001386878376
              std dev =       0.716652418638
             le_variance =       0.513590689139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.600686189659        initial
     1.0000e+01     1.0000e+02             1.1731e-04        -0.600763790454  <--
     4.0000e+01     4.0000e+02             2.9414e-05        -0.600726953668
     1.6000e+02     1.6000e+03             7.3590e-06        -0.600691547853

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 8.6474e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_001                -7.005028e-01 3 1  ON 0
ci_002                -7.002630e-01 3 1  ON 1
ci_003                -6.145960e-02 3 1  ON 2
ci_004                -6.147632e-02 3 1  ON 3
ci_005                 4.354754e-02 3 1  ON 4
ci_006                 4.352064e-02 3 1  ON 5
ci_007                 3.084774e-02 3 1  ON 6
ci_008                 3.083815e-02 3 1  ON 7
ci_009                -2.403924e-02 3 1  ON 8
ci_010                -2.404528e-02 3 1  ON 9
ci_011                -2.174899e-02 3 1  ON 10
ci_012                -2.178177e-02 3 1  ON 11
ci_013                 1.954336e-02 3 1  ON 12
ci_014                 1.958501e-02 3 1  ON 13
ci_015                 1.929282e-02 3 1  ON 14
ci_016                 1.936675e-02 3 1  ON 15
ci_017                 1.516688e-02 3 1  ON 16
ci_018                 1.527169e-02 3 1  ON 17
ci_019                 9.491733e-03 3 1  ON 18
ci_020                 9.668443e-03 3 1  ON 19
ci_021                -9.691140e-03 3 1  ON 20
ci_022                -9.759913e-03 3 1  ON 21
ci_023                 8.457708e-03 3 1  ON 22
ci_024                 8.484972e-03 3 1  ON 23
ci_025                 8.009697e-03 3 1  ON 24
ci_026                 8.007315e-03 3 1  ON 25
ci_027                 7.784853e-03 3 1  ON 26
ci_028                 7.791817e-03 3 1  ON 27
ci_029                -7.689627e-03 3 1  ON 28
ci_030                -7.692291e-03 3 1  ON 29
ci_031                -7.218091e-03 3 1  ON 30
ci_032                -7.240566e-03 3 1  ON 31
ci_033                 6.691060e-03 3 1  ON 32
ci_034                 6.741882e-03 3 1  ON 33
ci_035                 6.270185e-03 3 1  ON 34
ci_036                 6.250467e-03 3 1  ON 35
ci_037                 6.483707e-03 3 1  ON 36
ci_038                 6.502545e-03 3 1  ON 37
ci_039                 5.505416e-03 3 1  ON 38
ci_040                 5.519619e-03 3 1  ON 39
ci_041                 4.926532e-03 3 1  ON 40
ci_042                 4.875479e-03 3 1  ON 41
ci_043                 4.949918e-03 3 1  ON 42
ci_044                 5.002694e-03 3 1  ON 43
ci_045                 4.855457e-03 3 1  ON 44
ci_046                 4.833289e-03 3 1  ON 45
ci_047                -4.096395e-03 3 1  ON 46
ci_048                -4.058815e-03 3 1  ON 47
ci_049                 3.201807e-03 3 1  ON 48
ci_050                 3.142272e-03 3 1  ON 49
ci_051                -2.795330e-03 3 1  ON 50
ci_052                -2.808077e-03 3 1  ON 51
ci_053                -2.686200e-03 3 1  ON 52
ci_054                -2.786552e-03 3 1  ON 53
ci_055                -2.209677e-03 3 1  ON 54
ci_056                -2.128196e-03 3 1  ON 55
ci_057                -1.913232e-03 3 1  ON 56
ci_058                -1.934094e-03 3 1  ON 57
ci_059                -1.750386e-03 3 1  ON 58
ci_060                -1.736031e-03 3 1  ON 59
ci_061                -1.519577e-03 3 1  ON 60
ci_062                -1.505241e-03 3 1  ON 61
ci_063                -1.357051e-03 3 1  ON 62
ci_064                -1.404074e-03 3 1  ON 63
ci_065                -1.400311e-03 3 1  ON 64
ci_066                -1.374666e-03 3 1  ON 65
ci_067                -1.322737e-03 3 1  ON 66
ci_068                -1.322733e-03 3 1  ON 67
ci_069                 1.167978e-03 3 1  ON 68
ci_070                 1.120122e-03 3 1  ON 69
ci_071                -1.218418e-03 3 1  ON 70
ci_072                -1.272332e-03 3 1  ON 71
ci_073                 9.863535e-04 3 1  ON 72
ci_074                 1.052077e-03 3 1  ON 73
ci_075                -9.238615e-04 3 1  ON 74
ci_076                -9.886720e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4695e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6949
    reference variance = 0.754852
====================================================
  Execution time = 5.1126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 5.2446e-01
  Total weights = 1.954387846e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3543e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506556938312
                                         uncertainty =       0.002734737354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506556938312
                                         uncertainty =       0.002734737354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503307391
  error estimate for blocks of size 2^( 2) =       0.000522256208
  error estimate for blocks of size 2^( 3) =       0.000539455348
  error estimate for blocks of size 2^( 4) =       0.000551678013
  error estimate for blocks of size 2^( 5) =       0.000559691118
  error estimate for blocks of size 2^( 6) =       0.000563056799
  error estimate for blocks of size 2^( 7) =       0.000566859377

      target function =      -0.601882963326
              le_mean =     -22.662290516044
             les_mean =     514.103871277313
             stat err =       0.000560321327
             autocorr =       1.239389149749
   target nu stat err =       0.000560321327
   target dn stat err =       0.004885755126
      target stat err =       0.001455738855
              std dev =       0.711784138035
             le_variance =       0.506636659158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266229051604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.601886179176       residual = 4.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.602009824463       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.602021330891       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.602022542840       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.602022769275       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.602022818101       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.602022839026       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.602022846821       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.602022850236       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.602022853120       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.602022851884       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 4.577319e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.601886179176       residual = 4.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.601917440051       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.601920334404       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.601920637525       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.601920693794       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.601920705761       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.601920710870       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.601920712782       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.601920713612       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.601920714307       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.601920714005       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.157798e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.601886179176       residual = 4.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.601894016545       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.601894741246       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.601894817033       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.601894831078       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.601894834055       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.601894835324       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.601894835800       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.601894836006       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.601894836179       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.601894836103       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 2.903036e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.412032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0493e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_001                -7.005080e-01 3 1  ON 0
ci_002                -7.002979e-01 3 1  ON 1
ci_003                -6.142817e-02 3 1  ON 2
ci_004                -6.144384e-02 3 1  ON 3
ci_005                 4.343176e-02 3 1  ON 4
ci_006                 4.341059e-02 3 1  ON 5
ci_007                 3.078838e-02 3 1  ON 6
ci_008                 3.077465e-02 3 1  ON 7
ci_009                -2.399409e-02 3 1  ON 8
ci_010                -2.399476e-02 3 1  ON 9
ci_011                -2.169845e-02 3 1  ON 10
ci_012                -2.173885e-02 3 1  ON 11
ci_013                 1.950030e-02 3 1  ON 12
ci_014                 1.954391e-02 3 1  ON 13
ci_015                 1.926210e-02 3 1  ON 14
ci_016                 1.932421e-02 3 1  ON 15
ci_017                 1.514495e-02 3 1  ON 16
ci_018                 1.524510e-02 3 1  ON 17
ci_019                 9.468501e-03 3 1  ON 18
ci_020                 9.637213e-03 3 1  ON 19
ci_021                -9.687386e-03 3 1  ON 20
ci_022                -9.758214e-03 3 1  ON 21
ci_023                 8.445795e-03 3 1  ON 22
ci_024                 8.476090e-03 3 1  ON 23
ci_025                 8.011011e-03 3 1  ON 24
ci_026                 8.015976e-03 3 1  ON 25
ci_027                 7.773458e-03 3 1  ON 26
ci_028                 7.787189e-03 3 1  ON 27
ci_029                -7.679009e-03 3 1  ON 28
ci_030                -7.682122e-03 3 1  ON 29
ci_031                -7.187330e-03 3 1  ON 30
ci_032                -7.210761e-03 3 1  ON 31
ci_033                 6.678047e-03 3 1  ON 32
ci_034                 6.729136e-03 3 1  ON 33
ci_035                 6.247079e-03 3 1  ON 34
ci_036                 6.226667e-03 3 1  ON 35
ci_037                 6.477136e-03 3 1  ON 36
ci_038                 6.493833e-03 3 1  ON 37
ci_039                 5.502710e-03 3 1  ON 38
ci_040                 5.513925e-03 3 1  ON 39
ci_041                 4.922270e-03 3 1  ON 40
ci_042                 4.869839e-03 3 1  ON 41
ci_043                 4.948929e-03 3 1  ON 42
ci_044                 5.001052e-03 3 1  ON 43
ci_045                 4.851108e-03 3 1  ON 44
ci_046                 4.826303e-03 3 1  ON 45
ci_047                -4.087055e-03 3 1  ON 46
ci_048                -4.047714e-03 3 1  ON 47
ci_049                 3.194940e-03 3 1  ON 48
ci_050                 3.138448e-03 3 1  ON 49
ci_051                -2.788160e-03 3 1  ON 50
ci_052                -2.803294e-03 3 1  ON 51
ci_053                -2.681039e-03 3 1  ON 52
ci_054                -2.772772e-03 3 1  ON 53
ci_055                -2.208463e-03 3 1  ON 54
ci_056                -2.122637e-03 3 1  ON 55
ci_057                -1.906767e-03 3 1  ON 56
ci_058                -1.929606e-03 3 1  ON 57
ci_059                -1.746321e-03 3 1  ON 58
ci_060                -1.726415e-03 3 1  ON 59
ci_061                -1.518762e-03 3 1  ON 60
ci_062                -1.509656e-03 3 1  ON 61
ci_063                -1.347500e-03 3 1  ON 62
ci_064                -1.399693e-03 3 1  ON 63
ci_065                -1.400191e-03 3 1  ON 64
ci_066                -1.380723e-03 3 1  ON 65
ci_067                -1.319082e-03 3 1  ON 66
ci_068                -1.326658e-03 3 1  ON 67
ci_069                 1.166426e-03 3 1  ON 68
ci_070                 1.121434e-03 3 1  ON 69
ci_071                -1.221543e-03 3 1  ON 70
ci_072                -1.272989e-03 3 1  ON 71
ci_073                 9.797972e-04 3 1  ON 72
ci_074                 1.046947e-03 3 1  ON 73
ci_075                -9.214236e-04 3 1  ON 74
ci_076                -9.898350e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6843
    reference variance = 0.472584
====================================================
  Execution time = 4.9621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 5.2057e-01
  Total weights = 1.9547e+06
  Execution time = 7.2061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506398224934
                                         uncertainty =       0.002570515184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506398224934
                                         uncertainty =       0.002570515184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503187774
  error estimate for blocks of size 2^( 2) =       0.000521621728
  error estimate for blocks of size 2^( 3) =       0.000539677137
  error estimate for blocks of size 2^( 4) =       0.000552343978
  error estimate for blocks of size 2^( 5) =       0.000559687373
  error estimate for blocks of size 2^( 6) =       0.000562577742
  error estimate for blocks of size 2^( 7) =       0.000566293981

      target function =      -0.603006890801
              le_mean =     -22.662388514400
             les_mean =     514.104565589091
             stat err =       0.000560225768
             autocorr =       1.239555567228
   target nu stat err =       0.000560225768
   target dn stat err =       0.003560431091
      target stat err =       0.001081104376
              std dev =       0.711614975097
             le_variance =       0.506395872782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505651603691
                                         uncertainty =       0.002566616019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505651603691
                                         uncertainty =       0.002566616019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502816570
  error estimate for blocks of size 2^( 2) =       0.000521225976
  error estimate for blocks of size 2^( 3) =       0.000539255241
  error estimate for blocks of size 2^( 4) =       0.000551911175
  error estimate for blocks of size 2^( 5) =       0.000559250242
  error estimate for blocks of size 2^( 6) =       0.000562131920
  error estimate for blocks of size 2^( 7) =       0.000565842099

      target function =      -0.603127303022
              le_mean =     -22.662389739506
             les_mean =     514.104212151961
             stat err =       0.000559783859
             autocorr =       1.239428792067
   target nu stat err =       0.000559783859
   target dn stat err =       0.003622003514
      target stat err =       0.001098991117
              std dev =       0.711090012770
             le_variance =       0.505649006261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506017123155
                                         uncertainty =       0.002568425156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506017123155
                                         uncertainty =       0.002568425156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502998334
  error estimate for blocks of size 2^( 2) =       0.000521419814
  error estimate for blocks of size 2^( 3) =       0.000539462003
  error estimate for blocks of size 2^( 4) =       0.000552123230
  error estimate for blocks of size 2^( 5) =       0.000559464363
  error estimate for blocks of size 2^( 6) =       0.000562350310
  error estimate for blocks of size 2^( 7) =       0.000566063368

      target function =      -0.603093272014
              le_mean =     -22.662388737395
             les_mean =     514.104281829339
             stat err =       0.000560000318
             autocorr =       1.239491213361
   target nu stat err =       0.000560000318
   target dn stat err =       0.003584640109
      target stat err =       0.001088262785
              std dev =       0.711347066487
             le_variance =       0.506014649000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506350046998
                                         uncertainty =       0.002570240284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506350046998
                                         uncertainty =       0.002570240284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503163830
  error estimate for blocks of size 2^( 2) =       0.000521596212
  error estimate for blocks of size 2^( 3) =       0.000539649964
  error estimate for blocks of size 2^( 4) =       0.000552316092
  error estimate for blocks of size 2^( 5) =       0.000559659198
  error estimate for blocks of size 2^( 6) =       0.000562549008
  error estimate for blocks of size 2^( 7) =       0.000566264837

      target function =      -0.603017013117
              le_mean =     -22.662388497474
             les_mean =     514.104530347714
             stat err =       0.000560197284
             autocorr =       1.239547485762
   target nu stat err =       0.000560197284
   target dn stat err =       0.003562905432
      target stat err =       0.001081839467
              std dev =       0.711581112564
             le_variance =       0.506347679758


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.603006890801        initial
     2.5000e+00     2.5000e+01             4.5773e-04        -0.603127303022  <--
     1.0000e+01     1.0000e+02             1.1578e-04        -0.603093272014
     4.0000e+01     4.0000e+02             2.9030e-05        -0.603017013117

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 8.5779e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_001                -7.005227e-01 3 1  ON 0
ci_002                -7.004019e-01 3 1  ON 1
ci_003                -6.133448e-02 3 1  ON 2
ci_004                -6.134705e-02 3 1  ON 3
ci_005                 4.308981e-02 3 1  ON 4
ci_006                 4.308556e-02 3 1  ON 5
ci_007                 3.061266e-02 3 1  ON 6
ci_008                 3.058669e-02 3 1  ON 7
ci_009                -2.386047e-02 3 1  ON 8
ci_010                -2.384529e-02 3 1  ON 9
ci_011                -2.154879e-02 3 1  ON 10
ci_012                -2.161189e-02 3 1  ON 11
ci_013                 1.937282e-02 3 1  ON 12
ci_014                 1.942226e-02 3 1  ON 13
ci_015                 1.917096e-02 3 1  ON 14
ci_016                 1.919805e-02 3 1  ON 15
ci_017                 1.508008e-02 3 1  ON 16
ci_018                 1.516641e-02 3 1  ON 17
ci_019                 9.399515e-03 3 1  ON 18
ci_020                 9.544475e-03 3 1  ON 19
ci_021                -9.676269e-03 3 1  ON 20
ci_022                -9.753184e-03 3 1  ON 21
ci_023                 8.410596e-03 3 1  ON 22
ci_024                 8.449809e-03 3 1  ON 23
ci_025                 8.014953e-03 3 1  ON 24
ci_026                 8.041733e-03 3 1  ON 25
ci_027                 7.739861e-03 3 1  ON 26
ci_028                 7.773554e-03 3 1  ON 27
ci_029                -7.647521e-03 3 1  ON 28
ci_030                -7.651929e-03 3 1  ON 29
ci_031                -7.096185e-03 3 1  ON 30
ci_032                -7.122441e-03 3 1  ON 31
ci_033                 6.639443e-03 3 1  ON 32
ci_034                 6.691343e-03 3 1  ON 33
ci_035                 6.178792e-03 3 1  ON 34
ci_036                 6.156372e-03 3 1  ON 35
ci_037                 6.457605e-03 3 1  ON 36
ci_038                 6.467985e-03 3 1  ON 37
ci_039                 5.494744e-03 3 1  ON 38
ci_040                 5.497167e-03 3 1  ON 39
ci_041                 4.909710e-03 3 1  ON 40
ci_042                 4.853179e-03 3 1  ON 41
ci_043                 4.945948e-03 3 1  ON 42
ci_044                 4.996154e-03 3 1  ON 43
ci_045                 4.838277e-03 3 1  ON 44
ci_046                 4.805663e-03 3 1  ON 45
ci_047                -4.059432e-03 3 1  ON 46
ci_048                -4.014850e-03 3 1  ON 47
ci_049                 3.174607e-03 3 1  ON 48
ci_050                 3.127068e-03 3 1  ON 49
ci_051                -2.766797e-03 3 1  ON 50
ci_052                -2.789011e-03 3 1  ON 51
ci_053                -2.665875e-03 3 1  ON 52
ci_054                -2.731915e-03 3 1  ON 53
ci_055                -2.204853e-03 3 1  ON 54
ci_056                -2.106176e-03 3 1  ON 55
ci_057                -1.887634e-03 3 1  ON 56
ci_058                -1.916313e-03 3 1  ON 57
ci_059                -1.734323e-03 3 1  ON 58
ci_060                -1.697980e-03 3 1  ON 59
ci_061                -1.516332e-03 3 1  ON 60
ci_062                -1.522737e-03 3 1  ON 61
ci_063                -1.319285e-03 3 1  ON 62
ci_064                -1.386771e-03 3 1  ON 63
ci_065                -1.399796e-03 3 1  ON 64
ci_066                -1.398636e-03 3 1  ON 65
ci_067                -1.308301e-03 3 1  ON 66
ci_068                -1.338334e-03 3 1  ON 67
ci_069                 1.161817e-03 3 1  ON 68
ci_070                 1.125397e-03 3 1  ON 69
ci_071                -1.230760e-03 3 1  ON 70
ci_072                -1.274862e-03 3 1  ON 71
ci_073                 9.604275e-04 3 1  ON 72
ci_074                 1.031746e-03 3 1  ON 73
ci_075                -9.142187e-04 3 1  ON 74
ci_076                -9.932923e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4628e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2683e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8252
    reference variance = 1.00721
====================================================
  Execution time = 5.1188e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.1951e-01
  Total weights = 1.954679439e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504705704710
                                         uncertainty =       0.002960140885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504705704710
                                         uncertainty =       0.002960140885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502332679
  error estimate for blocks of size 2^( 2) =       0.000521271622
  error estimate for blocks of size 2^( 3) =       0.000538551100
  error estimate for blocks of size 2^( 4) =       0.000549890805
  error estimate for blocks of size 2^( 5) =       0.000557827397
  error estimate for blocks of size 2^( 6) =       0.000561552429
  error estimate for blocks of size 2^( 7) =       0.000562882660

      target function =      -0.603499650375
              le_mean =     -22.662961550475
             les_mean =     514.129331741593
             stat err =       0.000558038323
             autocorr =       1.234085318676
   target nu stat err =       0.000558038323
   target dn stat err =       0.003493791498
      target stat err =       0.001064069500
              std dev =       0.710405687241
             le_variance =       0.504676240465


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266296155048e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603501205764       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603956266012       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603995003942       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603998389405       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603999042744       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603999607102       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603999848694       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603999896994       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603999901544       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603999902425       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 1.674311e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603501205764       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603620067310       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603629990735       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603630843517       residual = 9.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603631001907       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603631137480       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603631194339       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603631205353       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603631206316       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603631206546       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 4.382324e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603501205764       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603531257346       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603533753356       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603533966891       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603534006157       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603534039677       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603534053663       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603534056349       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603534056580       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603534056637       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.108579e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.417284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0522e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_001                -7.005914e-01 3 1  ON 0
ci_002                -7.004900e-01 3 1  ON 1
ci_003                -6.118681e-02 3 1  ON 2
ci_004                -6.122391e-02 3 1  ON 3
ci_005                 4.265957e-02 3 1  ON 4
ci_006                 4.264732e-02 3 1  ON 5
ci_007                 3.036568e-02 3 1  ON 6
ci_008                 3.036213e-02 3 1  ON 7
ci_009                -2.367457e-02 3 1  ON 8
ci_010                -2.364646e-02 3 1  ON 9
ci_011                -2.136584e-02 3 1  ON 10
ci_012                -2.143062e-02 3 1  ON 11
ci_013                 1.920497e-02 3 1  ON 12
ci_014                 1.923140e-02 3 1  ON 13
ci_015                 1.903686e-02 3 1  ON 14
ci_016                 1.907566e-02 3 1  ON 15
ci_017                 1.499254e-02 3 1  ON 16
ci_018                 1.507008e-02 3 1  ON 17
ci_019                 9.296277e-03 3 1  ON 18
ci_020                 9.436608e-03 3 1  ON 19
ci_021                -9.641806e-03 3 1  ON 20
ci_022                -9.703197e-03 3 1  ON 21
ci_023                 8.363285e-03 3 1  ON 22
ci_024                 8.401647e-03 3 1  ON 23
ci_025                 8.023061e-03 3 1  ON 24
ci_026                 8.044970e-03 3 1  ON 25
ci_027                 7.707902e-03 3 1  ON 26
ci_028                 7.758146e-03 3 1  ON 27
ci_029                -7.610703e-03 3 1  ON 28
ci_030                -7.604306e-03 3 1  ON 29
ci_031                -6.993362e-03 3 1  ON 30
ci_032                -7.004621e-03 3 1  ON 31
ci_033                 6.600489e-03 3 1  ON 32
ci_034                 6.648076e-03 3 1  ON 33
ci_035                 6.103008e-03 3 1  ON 34
ci_036                 6.088866e-03 3 1  ON 35
ci_037                 6.427870e-03 3 1  ON 36
ci_038                 6.434942e-03 3 1  ON 37
ci_039                 5.462782e-03 3 1  ON 38
ci_040                 5.471483e-03 3 1  ON 39
ci_041                 4.879403e-03 3 1  ON 40
ci_042                 4.830641e-03 3 1  ON 41
ci_043                 4.927633e-03 3 1  ON 42
ci_044                 4.987579e-03 3 1  ON 43
ci_045                 4.812104e-03 3 1  ON 44
ci_046                 4.790183e-03 3 1  ON 45
ci_047                -4.001819e-03 3 1  ON 46
ci_048                -3.981390e-03 3 1  ON 47
ci_049                 3.142128e-03 3 1  ON 48
ci_050                 3.084865e-03 3 1  ON 49
ci_051                -2.756268e-03 3 1  ON 50
ci_052                -2.806994e-03 3 1  ON 51
ci_053                -2.661279e-03 3 1  ON 52
ci_054                -2.717871e-03 3 1  ON 53
ci_055                -2.206078e-03 3 1  ON 54
ci_056                -2.098707e-03 3 1  ON 55
ci_057                -1.893329e-03 3 1  ON 56
ci_058                -1.908608e-03 3 1  ON 57
ci_059                -1.719415e-03 3 1  ON 58
ci_060                -1.687358e-03 3 1  ON 59
ci_061                -1.510572e-03 3 1  ON 60
ci_062                -1.499420e-03 3 1  ON 61
ci_063                -1.333222e-03 3 1  ON 62
ci_064                -1.383466e-03 3 1  ON 63
ci_065                -1.404665e-03 3 1  ON 64
ci_066                -1.401154e-03 3 1  ON 65
ci_067                -1.317059e-03 3 1  ON 66
ci_068                -1.352659e-03 3 1  ON 67
ci_069                 1.133716e-03 3 1  ON 68
ci_070                 1.091821e-03 3 1  ON 69
ci_071                -1.250820e-03 3 1  ON 70
ci_072                -1.274098e-03 3 1  ON 71
ci_073                 9.460964e-04 3 1  ON 72
ci_074                 1.017413e-03 3 1  ON 73
ci_075                -8.972334e-04 3 1  ON 74
ci_076                -9.827765e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7162
    reference variance = 0.395478
====================================================
  Execution time = 5.0138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.2163e-01
  Total weights = 1.9548e+06
  Execution time = 7.2438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508475087186
                                         uncertainty =       0.002647873504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508475087186
                                         uncertainty =       0.002647873504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504271007
  error estimate for blocks of size 2^( 2) =       0.000523619813
  error estimate for blocks of size 2^( 3) =       0.000540636698
  error estimate for blocks of size 2^( 4) =       0.000552858565
  error estimate for blocks of size 2^( 5) =       0.000558999953
  error estimate for blocks of size 2^( 6) =       0.000562831604
  error estimate for blocks of size 2^( 7) =       0.000564517006

      target function =      -0.585364851460
              le_mean =     -22.663112860218
             les_mean =     514.198204381804
             stat err =       0.000559801782
             autocorr =       1.232368403107
   target nu stat err =       0.000559801782
   target dn stat err =       0.058325611522
      target stat err =       0.016172297393
              std dev =       0.713146897498
             le_variance =       0.508578497411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505736809839
                                         uncertainty =       0.002645639526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505736809839
                                         uncertainty =       0.002645639526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502908813
  error estimate for blocks of size 2^( 2) =       0.000522182398
  error estimate for blocks of size 2^( 3) =       0.000539133290
  error estimate for blocks of size 2^( 4) =       0.000551301564
  error estimate for blocks of size 2^( 5) =       0.000557427656
  error estimate for blocks of size 2^( 6) =       0.000561238976
  error estimate for blocks of size 2^( 7) =       0.000562871607

      target function =      -0.599886152263
              le_mean =     -22.663138118119
             les_mean =     514.149750094565
             stat err =       0.000558209951
             autocorr =       1.232016872690
   target nu stat err =       0.000558209951
   target dn stat err =       0.012852419512
      target stat err =       0.003749327165
              std dev =       0.711220463863
             le_variance =       0.505834548217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506953275980
                                         uncertainty =       0.002647582718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506953275980
                                         uncertainty =       0.002647582718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503514556
  error estimate for blocks of size 2^( 2) =       0.000522817183
  error estimate for blocks of size 2^( 3) =       0.000539797404
  error estimate for blocks of size 2^( 4) =       0.000551988166
  error estimate for blocks of size 2^( 5) =       0.000558121138
  error estimate for blocks of size 2^( 6) =       0.000561942294
  error estimate for blocks of size 2^( 7) =       0.000563602370

      target function =      -0.601838779230
              le_mean =     -22.663113157227
             les_mean =     514.141974651843
             stat err =       0.000558913492
             autocorr =       1.232154382501
   target nu stat err =       0.000558913492
   target dn stat err =       0.005451538439
      target stat err =       0.001619437254
              std dev =       0.712077114479
             le_variance =       0.507053816965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508239587493
                                         uncertainty =       0.002648845116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508239587493
                                         uncertainty =       0.002648845116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504154071
  error estimate for blocks of size 2^( 2) =       0.000523499087
  error estimate for blocks of size 2^( 3) =       0.000540508282
  error estimate for blocks of size 2^( 4) =       0.000552722766
  error estimate for blocks of size 2^( 5) =       0.000558870538
  error estimate for blocks of size 2^( 6) =       0.000562700166
  error estimate for blocks of size 2^( 7) =       0.000564381067

      target function =      -0.601649681432
              le_mean =     -22.663108661369
             les_mean =     514.142416594089
             stat err =       0.000559668634
             autocorr =       1.232353714949
   target nu stat err =       0.000559668634
   target dn stat err =       0.004766017584
      target stat err =       0.001421124351
              std dev =       0.712981525296
             le_variance =       0.508342655414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.585364851460        initial
     6.2500e-01     6.2500e+00             1.6743e-03        -0.599886152263
     2.5000e+00     2.5000e+01             4.3823e-04        -0.601838779230  <--
     1.0000e+01     1.0000e+02             1.1086e-04        -0.601649681432

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 8.6459e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_001                -7.005914e-01 3 1  ON 0
ci_002                -7.004900e-01 3 1  ON 1
ci_003                -6.118681e-02 3 1  ON 2
ci_004                -6.122391e-02 3 1  ON 3
ci_005                 4.265957e-02 3 1  ON 4
ci_006                 4.264732e-02 3 1  ON 5
ci_007                 3.036568e-02 3 1  ON 6
ci_008                 3.036213e-02 3 1  ON 7
ci_009                -2.367457e-02 3 1  ON 8
ci_010                -2.364646e-02 3 1  ON 9
ci_011                -2.136584e-02 3 1  ON 10
ci_012                -2.143062e-02 3 1  ON 11
ci_013                 1.920497e-02 3 1  ON 12
ci_014                 1.923140e-02 3 1  ON 13
ci_015                 1.903686e-02 3 1  ON 14
ci_016                 1.907566e-02 3 1  ON 15
ci_017                 1.499254e-02 3 1  ON 16
ci_018                 1.507008e-02 3 1  ON 17
ci_019                 9.296277e-03 3 1  ON 18
ci_020                 9.436608e-03 3 1  ON 19
ci_021                -9.641806e-03 3 1  ON 20
ci_022                -9.703197e-03 3 1  ON 21
ci_023                 8.363285e-03 3 1  ON 22
ci_024                 8.401647e-03 3 1  ON 23
ci_025                 8.023061e-03 3 1  ON 24
ci_026                 8.044970e-03 3 1  ON 25
ci_027                 7.707902e-03 3 1  ON 26
ci_028                 7.758146e-03 3 1  ON 27
ci_029                -7.610703e-03 3 1  ON 28
ci_030                -7.604306e-03 3 1  ON 29
ci_031                -6.993362e-03 3 1  ON 30
ci_032                -7.004621e-03 3 1  ON 31
ci_033                 6.600489e-03 3 1  ON 32
ci_034                 6.648076e-03 3 1  ON 33
ci_035                 6.103008e-03 3 1  ON 34
ci_036                 6.088866e-03 3 1  ON 35
ci_037                 6.427870e-03 3 1  ON 36
ci_038                 6.434942e-03 3 1  ON 37
ci_039                 5.462782e-03 3 1  ON 38
ci_040                 5.471483e-03 3 1  ON 39
ci_041                 4.879403e-03 3 1  ON 40
ci_042                 4.830641e-03 3 1  ON 41
ci_043                 4.927633e-03 3 1  ON 42
ci_044                 4.987579e-03 3 1  ON 43
ci_045                 4.812104e-03 3 1  ON 44
ci_046                 4.790183e-03 3 1  ON 45
ci_047                -4.001819e-03 3 1  ON 46
ci_048                -3.981390e-03 3 1  ON 47
ci_049                 3.142128e-03 3 1  ON 48
ci_050                 3.084865e-03 3 1  ON 49
ci_051                -2.756268e-03 3 1  ON 50
ci_052                -2.806994e-03 3 1  ON 51
ci_053                -2.661279e-03 3 1  ON 52
ci_054                -2.717871e-03 3 1  ON 53
ci_055                -2.206078e-03 3 1  ON 54
ci_056                -2.098707e-03 3 1  ON 55
ci_057                -1.893329e-03 3 1  ON 56
ci_058                -1.908608e-03 3 1  ON 57
ci_059                -1.719415e-03 3 1  ON 58
ci_060                -1.687358e-03 3 1  ON 59
ci_061                -1.510572e-03 3 1  ON 60
ci_062                -1.499420e-03 3 1  ON 61
ci_063                -1.333222e-03 3 1  ON 62
ci_064                -1.383466e-03 3 1  ON 63
ci_065                -1.404665e-03 3 1  ON 64
ci_066                -1.401154e-03 3 1  ON 65
ci_067                -1.317059e-03 3 1  ON 66
ci_068                -1.352659e-03 3 1  ON 67
ci_069                 1.133716e-03 3 1  ON 68
ci_070                 1.091821e-03 3 1  ON 69
ci_071                -1.250820e-03 3 1  ON 70
ci_072                -1.274098e-03 3 1  ON 71
ci_073                 9.460964e-04 3 1  ON 72
ci_074                 1.017413e-03 3 1  ON 73
ci_075                -8.972334e-04 3 1  ON 74
ci_076                -9.827765e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4699e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2692e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.5443
    reference variance = 0.391404
====================================================
  Execution time = 5.1070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 5.2135e-01
  Total weights = 1.954605988e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506168965215
                                         uncertainty =       0.002688532956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506168965215
                                         uncertainty =       0.002688532956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503050363
  error estimate for blocks of size 2^( 2) =       0.000521689335
  error estimate for blocks of size 2^( 3) =       0.000539006033
  error estimate for blocks of size 2^( 4) =       0.000551066673
  error estimate for blocks of size 2^( 5) =       0.000559687706
  error estimate for blocks of size 2^( 6) =       0.000564721240
  error estimate for blocks of size 2^( 7) =       0.000565824857

      target function =      -0.602788173531
              le_mean =     -22.662262766683
             les_mean =     514.099508098272
             stat err =       0.000560325119
             autocorr =       1.240672771109
   target nu stat err =       0.000560325119
   target dn stat err =       0.003587044220
      target stat err =       0.001087808800
              std dev =       0.711420645707
             le_variance =       0.506119335138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266226276668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.602789841823       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603251709790       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603292501325       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603296263157       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603296961783       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603297160708       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603297219359       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603297217948       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603297213408       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.603297215493       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.603297214979       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 1.667408e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.602789841823       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.602910435128       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.602920880513       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.602921823219       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.602921993734       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.602922041074       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.602922054239       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.602922053719       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.602922052606       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.602922053104       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.602922052956       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 4.362796e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.602789841823       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.602820328139       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.602822955168       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.602823190907       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.602823233248       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.602823244927       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.602823248124       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.602823247984       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.602823247707       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.602823247830       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.602823247792       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.103540e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.423422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0432e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_001                -7.006901e-01 3 1  ON 0
ci_002                -7.005488e-01 3 1  ON 1
ci_003                -6.105737e-02 3 1  ON 2
ci_004                -6.109059e-02 3 1  ON 3
ci_005                 4.222329e-02 3 1  ON 4
ci_006                 4.221581e-02 3 1  ON 5
ci_007                 3.011138e-02 3 1  ON 6
ci_008                 3.011188e-02 3 1  ON 7
ci_009                -2.349149e-02 3 1  ON 8
ci_010                -2.344720e-02 3 1  ON 9
ci_011                -2.117979e-02 3 1  ON 10
ci_012                -2.124263e-02 3 1  ON 11
ci_013                 1.903834e-02 3 1  ON 12
ci_014                 1.904154e-02 3 1  ON 13
ci_015                 1.888573e-02 3 1  ON 14
ci_016                 1.893826e-02 3 1  ON 15
ci_017                 1.491321e-02 3 1  ON 16
ci_018                 1.498951e-02 3 1  ON 17
ci_019                 9.184323e-03 3 1  ON 18
ci_020                 9.329664e-03 3 1  ON 19
ci_021                -9.595740e-03 3 1  ON 20
ci_022                -9.691332e-03 3 1  ON 21
ci_023                 8.312756e-03 3 1  ON 22
ci_024                 8.328393e-03 3 1  ON 23
ci_025                 8.020880e-03 3 1  ON 24
ci_026                 8.058989e-03 3 1  ON 25
ci_027                 7.692390e-03 3 1  ON 26
ci_028                 7.726814e-03 3 1  ON 27
ci_029                -7.569354e-03 3 1  ON 28
ci_030                -7.555828e-03 3 1  ON 29
ci_031                -6.881047e-03 3 1  ON 30
ci_032                -6.903295e-03 3 1  ON 31
ci_033                 6.562840e-03 3 1  ON 32
ci_034                 6.610496e-03 3 1  ON 33
ci_035                 6.033137e-03 3 1  ON 34
ci_036                 6.015988e-03 3 1  ON 35
ci_037                 6.382041e-03 3 1  ON 36
ci_038                 6.397621e-03 3 1  ON 37
ci_039                 5.442880e-03 3 1  ON 38
ci_040                 5.460811e-03 3 1  ON 39
ci_041                 4.853781e-03 3 1  ON 40
ci_042                 4.811092e-03 3 1  ON 41
ci_043                 4.889874e-03 3 1  ON 42
ci_044                 4.968841e-03 3 1  ON 43
ci_045                 4.773838e-03 3 1  ON 44
ci_046                 4.744800e-03 3 1  ON 45
ci_047                -3.961700e-03 3 1  ON 46
ci_048                -3.929369e-03 3 1  ON 47
ci_049                 3.090352e-03 3 1  ON 48
ci_050                 3.059376e-03 3 1  ON 49
ci_051                -2.735904e-03 3 1  ON 50
ci_052                -2.785676e-03 3 1  ON 51
ci_053                -2.647145e-03 3 1  ON 52
ci_054                -2.696602e-03 3 1  ON 53
ci_055                -2.203246e-03 3 1  ON 54
ci_056                -2.091433e-03 3 1  ON 55
ci_057                -1.882921e-03 3 1  ON 56
ci_058                -1.902844e-03 3 1  ON 57
ci_059                -1.692730e-03 3 1  ON 58
ci_060                -1.664458e-03 3 1  ON 59
ci_061                -1.494890e-03 3 1  ON 60
ci_062                -1.489586e-03 3 1  ON 61
ci_063                -1.280070e-03 3 1  ON 62
ci_064                -1.413220e-03 3 1  ON 63
ci_065                -1.418126e-03 3 1  ON 64
ci_066                -1.416538e-03 3 1  ON 65
ci_067                -1.326518e-03 3 1  ON 66
ci_068                -1.333038e-03 3 1  ON 67
ci_069                 1.113575e-03 3 1  ON 68
ci_070                 1.059458e-03 3 1  ON 69
ci_071                -1.274227e-03 3 1  ON 70
ci_072                -1.301636e-03 3 1  ON 71
ci_073                 9.428986e-04 3 1  ON 72
ci_074                 9.952158e-04 3 1  ON 73
ci_075                -8.813069e-04 3 1  ON 74
ci_076                -9.767268e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.749
    reference variance = 0.629094
====================================================
  Execution time = 4.9627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.2206e-01
  Total weights = 1.9546e+06
  Execution time = 7.2089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508626630543
                                         uncertainty =       0.003511364227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508626630543
                                         uncertainty =       0.003511364227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504317100
  error estimate for blocks of size 2^( 2) =       0.000523043213
  error estimate for blocks of size 2^( 3) =       0.000539771190
  error estimate for blocks of size 2^( 4) =       0.000551813465
  error estimate for blocks of size 2^( 5) =       0.000558972979
  error estimate for blocks of size 2^( 6) =       0.000563381185
  error estimate for blocks of size 2^( 7) =       0.000565584786

      target function =      -0.576811707200
              le_mean =     -22.663476196738
             les_mean =     514.244253420110
             stat err =       0.000559938104
             autocorr =       1.232743313812
   target nu stat err =       0.000559938104
   target dn stat err =       0.088189184697
      target stat err =       0.023770774372
              std dev =       0.713212082904
             le_variance =       0.508671475200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505839393229
                                         uncertainty =       0.003555268100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505839393229
                                         uncertainty =       0.003555268100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502929030
  error estimate for blocks of size 2^( 2) =       0.000521557603
  error estimate for blocks of size 2^( 3) =       0.000538206063
  error estimate for blocks of size 2^( 4) =       0.000550205244
  error estimate for blocks of size 2^( 5) =       0.000557335040
  error estimate for blocks of size 2^( 6) =       0.000561767171
  error estimate for blocks of size 2^( 7) =       0.000563921563

      target function =      -0.602985859648
              le_mean =     -22.663487816870
             les_mean =     514.155357160033
             stat err =       0.000558307255
             autocorr =       1.232347341659
   target nu stat err =       0.000558307255
   target dn stat err =       0.004511758519
      target stat err =       0.001354320570
              std dev =       0.711249055309
             le_variance =       0.505875218677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507115854385
                                         uncertainty =       0.003532550129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507115854385
                                         uncertainty =       0.003532550129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503564969
  error estimate for blocks of size 2^( 2) =       0.000522241550
  error estimate for blocks of size 2^( 3) =       0.000538927618
  error estimate for blocks of size 2^( 4) =       0.000550949089
  error estimate for blocks of size 2^( 5) =       0.000558095675
  error estimate for blocks of size 2^( 6) =       0.000562509274
  error estimate for blocks of size 2^( 7) =       0.000564686208

      target function =      -0.601709024092
              le_mean =     -22.663476757927
             les_mean =     514.159188400851
             stat err =       0.000559060062
             autocorr =       1.232553885036
   target nu stat err =       0.000559060062
   target dn stat err =       0.006402319593
      target stat err =       0.001894252374
              std dev =       0.712148409043
             le_variance =       0.507155356502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508423218646
                                         uncertainty =       0.003513759819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508423218646
                                         uncertainty =       0.003513759819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504215867
  error estimate for blocks of size 2^( 2) =       0.000522936687
  error estimate for blocks of size 2^( 3) =       0.000539660207
  error estimate for blocks of size 2^( 4) =       0.000551702246
  error estimate for blocks of size 2^( 5) =       0.000558864387
  error estimate for blocks of size 2^( 6) =       0.000563268391
  error estimate for blocks of size 2^( 7) =       0.000565460450

      target function =      -0.602635514862
              le_mean =     -22.663477296444
             les_mean =     514.156064343982
             stat err =       0.000559823868
             autocorr =       1.232735223351
   target nu stat err =       0.000559823868
   target dn stat err =       0.004403400482
      target stat err =       0.001321760432
              std dev =       0.713068917466
             le_variance =       0.508467281057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.576811707200        initial
     6.2500e-01     6.2500e+00             1.6674e-03        -0.602985859648  <--
     2.5000e+00     2.5000e+01             4.3628e-04        -0.601709024092
     1.0000e+01     1.0000e+02             1.1035e-04        -0.602635514862

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 8.5820e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_001                -7.009728e-01 3 1  ON 0
ci_002                -7.007149e-01 3 1  ON 1
ci_003                -6.067964e-02 3 1  ON 2
ci_004                -6.070184e-02 3 1  ON 3
ci_005                 4.099216e-02 3 1  ON 4
ci_006                 4.099763e-02 3 1  ON 5
ci_007                 2.938787e-02 3 1  ON 6
ci_008                 2.939957e-02 3 1  ON 7
ci_009                -2.297152e-02 3 1  ON 8
ci_010                -2.288075e-02 3 1  ON 9
ci_011                -2.064975e-02 3 1  ON 10
ci_012                -2.070714e-02 3 1  ON 11
ci_013                 1.856421e-02 3 1  ON 12
ci_014                 1.850088e-02 3 1  ON 13
ci_015                 1.845210e-02 3 1  ON 14
ci_016                 1.854447e-02 3 1  ON 15
ci_017                 1.468801e-02 3 1  ON 16
ci_018                 1.476064e-02 3 1  ON 17
ci_019                 8.861993e-03 3 1  ON 18
ci_020                 9.022116e-03 3 1  ON 19
ci_021                -9.464428e-03 3 1  ON 20
ci_022                -9.657879e-03 3 1  ON 21
ci_023                 8.169453e-03 3 1  ON 22
ci_024                 8.121272e-03 3 1  ON 23
ci_025                 8.015786e-03 3 1  ON 24
ci_026                 8.099857e-03 3 1  ON 25
ci_027                 7.649212e-03 3 1  ON 26
ci_028                 7.639120e-03 3 1  ON 27
ci_029                -7.450560e-03 3 1  ON 28
ci_030                -7.416651e-03 3 1  ON 29
ci_031                -6.560407e-03 3 1  ON 30
ci_032                -6.614069e-03 3 1  ON 31
ci_033                 6.455457e-03 3 1  ON 32
ci_034                 6.503076e-03 3 1  ON 33
ci_035                 5.835211e-03 3 1  ON 34
ci_036                 5.810111e-03 3 1  ON 35
ci_037                 6.250590e-03 3 1  ON 36
ci_038                 6.290346e-03 3 1  ON 37
ci_039                 5.387509e-03 3 1  ON 38
ci_040                 5.431501e-03 3 1  ON 39
ci_041                 4.781587e-03 3 1  ON 40
ci_042                 4.756112e-03 3 1  ON 41
ci_043                 4.781206e-03 3 1  ON 42
ci_044                 4.914439e-03 3 1  ON 43
ci_045                 4.665250e-03 3 1  ON 44
ci_046                 4.615837e-03 3 1  ON 45
ci_047                -3.847360e-03 3 1  ON 46
ci_048                -3.781815e-03 3 1  ON 47
ci_049                 2.943151e-03 3 1  ON 48
ci_050                 2.986720e-03 3 1  ON 49
ci_051                -2.676158e-03 3 1  ON 50
ci_052                -2.723066e-03 3 1  ON 51
ci_053                -2.607951e-03 3 1  ON 52
ci_054                -2.636935e-03 3 1  ON 53
ci_055                -2.195523e-03 3 1  ON 54
ci_056                -2.070678e-03 3 1  ON 55
ci_057                -1.853368e-03 3 1  ON 56
ci_058                -1.886499e-03 3 1  ON 57
ci_059                -1.617462e-03 3 1  ON 58
ci_060                -1.599798e-03 3 1  ON 59
ci_061                -1.450178e-03 3 1  ON 60
ci_062                -1.461365e-03 3 1  ON 61
ci_063                -1.129222e-03 3 1  ON 62
ci_064                -1.499346e-03 3 1  ON 63
ci_065                -1.455897e-03 3 1  ON 64
ci_066                -1.459661e-03 3 1  ON 65
ci_067                -1.353964e-03 3 1  ON 66
ci_068                -1.277532e-03 3 1  ON 67
ci_069                 1.056025e-03 3 1  ON 68
ci_070                 9.672323e-04 3 1  ON 69
ci_071                -1.340041e-03 3 1  ON 70
ci_072                -1.379722e-03 3 1  ON 71
ci_073                 9.335229e-04 3 1  ON 72
ci_074                 9.317563e-04 3 1  ON 73
ci_075                -8.360005e-04 3 1  ON 74
ci_076                -9.589277e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4626e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2688e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.672
    reference variance = 0.434026
====================================================
  Execution time = 5.1056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.2037e-01
  Total weights = 1.954760937e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505213407514
                                         uncertainty =       0.002625352985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505213407514
                                         uncertainty =       0.002625352985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502608520
  error estimate for blocks of size 2^( 2) =       0.000521464468
  error estimate for blocks of size 2^( 3) =       0.000538689241
  error estimate for blocks of size 2^( 4) =       0.000551702800
  error estimate for blocks of size 2^( 5) =       0.000559442641
  error estimate for blocks of size 2^( 6) =       0.000561592882
  error estimate for blocks of size 2^( 7) =       0.000562796600

      target function =      -0.603166561591
              le_mean =     -22.662633276141
             les_mean =     514.115315382889
             stat err =       0.000558883731
             autocorr =       1.236469027180
   target nu stat err =       0.000558883731
   target dn stat err =       0.003776543794
      target stat err =       0.001143313385
              std dev =       0.710795785705
             le_variance =       0.505230648977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266263327614e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603168423974       residual = 4.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.604573455387       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.604708587694       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.604724303605       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.604727148794       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.604727521940       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.604727732252       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.604727814528       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.604727828169       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 5.386874e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603168423974       residual = 4.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603579954824       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603617119263       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603621159305       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603621824966       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603621888266       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603621926036       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603621940793       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603621943990       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 1.587543e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.603168423974       residual = 4.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.603275902519       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.603285420985       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.603286434486       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.603286596643       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.603286610386       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.603286618894       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.603286622208       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.603286622990       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 4.153908e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.428022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0484e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_001                -7.012593e-01 3 1  ON 0
ci_002                -7.009856e-01 3 1  ON 1
ci_003                -6.017353e-02 3 1  ON 2
ci_004                -6.018683e-02 3 1  ON 3
ci_005                 3.940462e-02 3 1  ON 4
ci_006                 3.942000e-02 3 1  ON 5
ci_007                 2.846760e-02 3 1  ON 6
ci_008                 2.854637e-02 3 1  ON 7
ci_009                -2.230826e-02 3 1  ON 8
ci_010                -2.214957e-02 3 1  ON 9
ci_011                -2.001602e-02 3 1  ON 10
ci_012                -1.999459e-02 3 1  ON 11
ci_013                 1.793361e-02 3 1  ON 12
ci_014                 1.787700e-02 3 1  ON 13
ci_015                 1.802854e-02 3 1  ON 14
ci_016                 1.798794e-02 3 1  ON 15
ci_017                 1.434171e-02 3 1  ON 16
ci_018                 1.437889e-02 3 1  ON 17
ci_019                 8.348166e-03 3 1  ON 18
ci_020                 8.566438e-03 3 1  ON 19
ci_021                -9.377970e-03 3 1  ON 20
ci_022                -9.620526e-03 3 1  ON 21
ci_023                 7.980386e-03 3 1  ON 22
ci_024                 7.984955e-03 3 1  ON 23
ci_025                 8.058793e-03 3 1  ON 24
ci_026                 8.262040e-03 3 1  ON 25
ci_027                 7.571564e-03 3 1  ON 26
ci_028                 7.510277e-03 3 1  ON 27
ci_029                -7.250245e-03 3 1  ON 28
ci_030                -7.057097e-03 3 1  ON 29
ci_031                -6.185693e-03 3 1  ON 30
ci_032                -6.320723e-03 3 1  ON 31
ci_033                 6.256990e-03 3 1  ON 32
ci_034                 6.309407e-03 3 1  ON 33
ci_035                 5.581748e-03 3 1  ON 34
ci_036                 5.569413e-03 3 1  ON 35
ci_037                 6.105627e-03 3 1  ON 36
ci_038                 6.080499e-03 3 1  ON 37
ci_039                 5.303072e-03 3 1  ON 38
ci_040                 5.407558e-03 3 1  ON 39
ci_041                 4.692829e-03 3 1  ON 40
ci_042                 4.718521e-03 3 1  ON 41
ci_043                 4.723850e-03 3 1  ON 42
ci_044                 4.871844e-03 3 1  ON 43
ci_045                 4.592576e-03 3 1  ON 44
ci_046                 4.506090e-03 3 1  ON 45
ci_047                -3.607674e-03 3 1  ON 46
ci_048                -3.605975e-03 3 1  ON 47
ci_049                 2.796078e-03 3 1  ON 48
ci_050                 2.860766e-03 3 1  ON 49
ci_051                -2.703282e-03 3 1  ON 50
ci_052                -2.767890e-03 3 1  ON 51
ci_053                -2.537190e-03 3 1  ON 52
ci_054                -2.592516e-03 3 1  ON 53
ci_055                -2.035418e-03 3 1  ON 54
ci_056                -1.991454e-03 3 1  ON 55
ci_057                -1.781023e-03 3 1  ON 56
ci_058                -1.838332e-03 3 1  ON 57
ci_059                -1.478514e-03 3 1  ON 58
ci_060                -1.540429e-03 3 1  ON 59
ci_061                -1.442415e-03 3 1  ON 60
ci_062                -1.393627e-03 3 1  ON 61
ci_063                -1.115901e-03 3 1  ON 62
ci_064                -1.442696e-03 3 1  ON 63
ci_065                -1.442983e-03 3 1  ON 64
ci_066                -1.580321e-03 3 1  ON 65
ci_067                -1.357934e-03 3 1  ON 66
ci_068                -1.289206e-03 3 1  ON 67
ci_069                 9.510417e-04 3 1  ON 68
ci_070                 9.121856e-04 3 1  ON 69
ci_071                -1.445285e-03 3 1  ON 70
ci_072                -1.368401e-03 3 1  ON 71
ci_073                 9.277113e-04 3 1  ON 72
ci_074                 9.666752e-04 3 1  ON 73
ci_075                -8.366938e-04 3 1  ON 74
ci_076                -8.962503e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6813
    reference variance = 0.34818
====================================================
  Execution time = 4.9771e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2664e+01
  VMC Evar = 5.1694e-01
  Total weights = 1.9547e+06
  Execution time = 7.2068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505957533573
                                         uncertainty =       0.003004621633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505957533573
                                         uncertainty =       0.003004621633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502973295
  error estimate for blocks of size 2^( 2) =       0.000521552026
  error estimate for blocks of size 2^( 3) =       0.000538437203
  error estimate for blocks of size 2^( 4) =       0.000551146799
  error estimate for blocks of size 2^( 5) =       0.000558304862
  error estimate for blocks of size 2^( 6) =       0.000563245232
  error estimate for blocks of size 2^( 7) =       0.000564685683

      target function =      -0.602412225093
              le_mean =     -22.663885450687
             les_mean =     514.175656123731
             stat err =       0.000559345644
             autocorr =       1.236717957237
   target nu stat err =       0.000559345644
   target dn stat err =       0.004596259150
      target stat err =       0.001376641963
              std dev =       0.711311654933
             le_variance =       0.505964270443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497785673127
                                         uncertainty =       0.002768160911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497785673127
                                         uncertainty =       0.002768160911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498899776
  error estimate for blocks of size 2^( 2) =       0.000517254882
  error estimate for blocks of size 2^( 3) =       0.000533942444
  error estimate for blocks of size 2^( 4) =       0.000546509567
  error estimate for blocks of size 2^( 5) =       0.000553512404
  error estimate for blocks of size 2^( 6) =       0.000558455327
  error estimate for blocks of size 2^( 7) =       0.000559803178

      target function =      -0.603095506500
              le_mean =     -22.663985185108
             les_mean =     514.177927287038
             stat err =       0.000554570119
             autocorr =       1.235623937315
   target nu stat err =       0.000554570119
   target dn stat err =       0.005789294785
      target stat err =       0.001724994613
              std dev =       0.705550829115
             le_variance =       0.497801972465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500535224119
                                         uncertainty =       0.002822768522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500535224119
                                         uncertainty =       0.002822768522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500273895
  error estimate for blocks of size 2^( 2) =       0.000518716824
  error estimate for blocks of size 2^( 3) =       0.000535483754
  error estimate for blocks of size 2^( 4) =       0.000548105857
  error estimate for blocks of size 2^( 5) =       0.000555163515
  error estimate for blocks of size 2^( 6) =       0.000560084147
  error estimate for blocks of size 2^( 7) =       0.000561453828

      target function =      -0.605016777685
              le_mean =     -22.663876556838
             les_mean =     514.166415659803
             stat err =       0.000556201837
             autocorr =       1.236087330594
   target nu stat err =       0.000556201837
   target dn stat err =       0.003758214953
      target stat err =       0.001145711664
              std dev =       0.707494127056
             le_variance =       0.500547939818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505142613071
                                         uncertainty =       0.002970502478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505142613071
                                         uncertainty =       0.002970502478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502568521
  error estimate for blocks of size 2^( 2) =       0.000521127779
  error estimate for blocks of size 2^( 3) =       0.000537996323
  error estimate for blocks of size 2^( 4) =       0.000550693524
  error estimate for blocks of size 2^( 5) =       0.000557838613
  error estimate for blocks of size 2^( 6) =       0.000562775240
  error estimate for blocks of size 2^( 7) =       0.000564207135

      target function =      -0.602887564182
              le_mean =     -22.663870860855
             les_mean =     514.173366906512
             stat err =       0.000558878628
             autocorr =       1.236643272725
   target nu stat err =       0.000558878628
   target dn stat err =       0.004177596657
      target stat err =       0.001258270850
              std dev =       0.710739218028
             le_variance =       0.505150236043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.602412225093        initial
     1.5625e-01     1.5625e+00             5.3869e-03        -0.603095506500
     6.2500e-01     6.2500e+00             1.5875e-03        -0.605016777685  <--
     2.5000e+00     2.5000e+01             4.1539e-04        -0.602887564182

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 8.5913e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_001                -7.012593e-01 3 1  ON 0
ci_002                -7.009856e-01 3 1  ON 1
ci_003                -6.017353e-02 3 1  ON 2
ci_004                -6.018683e-02 3 1  ON 3
ci_005                 3.940462e-02 3 1  ON 4
ci_006                 3.942000e-02 3 1  ON 5
ci_007                 2.846760e-02 3 1  ON 6
ci_008                 2.854637e-02 3 1  ON 7
ci_009                -2.230826e-02 3 1  ON 8
ci_010                -2.214957e-02 3 1  ON 9
ci_011                -2.001602e-02 3 1  ON 10
ci_012                -1.999459e-02 3 1  ON 11
ci_013                 1.793361e-02 3 1  ON 12
ci_014                 1.787700e-02 3 1  ON 13
ci_015                 1.802854e-02 3 1  ON 14
ci_016                 1.798794e-02 3 1  ON 15
ci_017                 1.434171e-02 3 1  ON 16
ci_018                 1.437889e-02 3 1  ON 17
ci_019                 8.348166e-03 3 1  ON 18
ci_020                 8.566438e-03 3 1  ON 19
ci_021                -9.377970e-03 3 1  ON 20
ci_022                -9.620526e-03 3 1  ON 21
ci_023                 7.980386e-03 3 1  ON 22
ci_024                 7.984955e-03 3 1  ON 23
ci_025                 8.058793e-03 3 1  ON 24
ci_026                 8.262040e-03 3 1  ON 25
ci_027                 7.571564e-03 3 1  ON 26
ci_028                 7.510277e-03 3 1  ON 27
ci_029                -7.250245e-03 3 1  ON 28
ci_030                -7.057097e-03 3 1  ON 29
ci_031                -6.185693e-03 3 1  ON 30
ci_032                -6.320723e-03 3 1  ON 31
ci_033                 6.256990e-03 3 1  ON 32
ci_034                 6.309407e-03 3 1  ON 33
ci_035                 5.581748e-03 3 1  ON 34
ci_036                 5.569413e-03 3 1  ON 35
ci_037                 6.105627e-03 3 1  ON 36
ci_038                 6.080499e-03 3 1  ON 37
ci_039                 5.303072e-03 3 1  ON 38
ci_040                 5.407558e-03 3 1  ON 39
ci_041                 4.692829e-03 3 1  ON 40
ci_042                 4.718521e-03 3 1  ON 41
ci_043                 4.723850e-03 3 1  ON 42
ci_044                 4.871844e-03 3 1  ON 43
ci_045                 4.592576e-03 3 1  ON 44
ci_046                 4.506090e-03 3 1  ON 45
ci_047                -3.607674e-03 3 1  ON 46
ci_048                -3.605975e-03 3 1  ON 47
ci_049                 2.796078e-03 3 1  ON 48
ci_050                 2.860766e-03 3 1  ON 49
ci_051                -2.703282e-03 3 1  ON 50
ci_052                -2.767890e-03 3 1  ON 51
ci_053                -2.537190e-03 3 1  ON 52
ci_054                -2.592516e-03 3 1  ON 53
ci_055                -2.035418e-03 3 1  ON 54
ci_056                -1.991454e-03 3 1  ON 55
ci_057                -1.781023e-03 3 1  ON 56
ci_058                -1.838332e-03 3 1  ON 57
ci_059                -1.478514e-03 3 1  ON 58
ci_060                -1.540429e-03 3 1  ON 59
ci_061                -1.442415e-03 3 1  ON 60
ci_062                -1.393627e-03 3 1  ON 61
ci_063                -1.115901e-03 3 1  ON 62
ci_064                -1.442696e-03 3 1  ON 63
ci_065                -1.442983e-03 3 1  ON 64
ci_066                -1.580321e-03 3 1  ON 65
ci_067                -1.357934e-03 3 1  ON 66
ci_068                -1.289206e-03 3 1  ON 67
ci_069                 9.510417e-04 3 1  ON 68
ci_070                 9.121856e-04 3 1  ON 69
ci_071                -1.445285e-03 3 1  ON 70
ci_072                -1.368401e-03 3 1  ON 71
ci_073                 9.277113e-04 3 1  ON 72
ci_074                 9.666752e-04 3 1  ON 73
ci_075                -8.366938e-04 3 1  ON 74
ci_076                -8.962503e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4640e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7377
    reference variance = 0.418067
====================================================
  Execution time = 5.1024e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2665e+01
  VMC Evar = 5.1891e-01
  Total weights = 1.954572313e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503358768297
                                         uncertainty =       0.003038816534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503358768297
                                         uncertainty =       0.003038816534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501730552
  error estimate for blocks of size 2^( 2) =       0.000520784774
  error estimate for blocks of size 2^( 3) =       0.000537321527
  error estimate for blocks of size 2^( 4) =       0.000549993963
  error estimate for blocks of size 2^( 5) =       0.000558550076
  error estimate for blocks of size 2^( 6) =       0.000563944551
  error estimate for blocks of size 2^( 7) =       0.000566408073

      target function =      -0.604065016850
              le_mean =     -22.664585968772
             les_mean =     514.202370010786
             stat err =       0.000559724166
             autocorr =       1.244534727994
   target nu stat err =       0.000559724166
   target dn stat err =       0.003842269426
      target stat err =       0.001167398481
              std dev =       0.709554151824
             le_variance =       0.503467094370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266458596877e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.604066967431       residual = 3.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.605302694562       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.605424084305       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.605434463195       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.605436640698       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.605437037509       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.605437255526       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.605437442752       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.605437471298       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 4.884535e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.604066967431       residual = 3.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.604429335031       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.604462776672       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.604465422867       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.604465958358       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.604466041608       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.604466087289       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.604466126655       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.604466132172       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 1.442290e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.604066967431       residual = 3.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.604161641843       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.604170210903       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.604170872875       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.604171005404       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.604171024945       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.604171035760       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.604171045071       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.604171046341       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 3.776149e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.432488 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0431e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_001                -7.014880e-01 3 1  ON 0
ci_002                -7.012267e-01 3 1  ON 1
ci_003                -5.984598e-02 3 1  ON 2
ci_004                -5.989548e-02 3 1  ON 3
ci_005                 3.796233e-02 3 1  ON 4
ci_006                 3.801165e-02 3 1  ON 5
ci_007                 2.761867e-02 3 1  ON 6
ci_008                 2.768926e-02 3 1  ON 7
ci_009                -2.153452e-02 3 1  ON 8
ci_010                -2.156454e-02 3 1  ON 9
ci_011                -1.944696e-02 3 1  ON 10
ci_012                -1.943260e-02 3 1  ON 11
ci_013                 1.741821e-02 3 1  ON 12
ci_014                 1.731295e-02 3 1  ON 13
ci_015                 1.757020e-02 3 1  ON 14
ci_016                 1.754148e-02 3 1  ON 15
ci_017                 1.402764e-02 3 1  ON 16
ci_018                 1.394016e-02 3 1  ON 17
ci_019                 7.842181e-03 3 1  ON 18
ci_020                 8.135644e-03 3 1  ON 19
ci_021                -9.181761e-03 3 1  ON 20
ci_022                -9.464227e-03 3 1  ON 21
ci_023                 7.787909e-03 3 1  ON 22
ci_024                 7.819217e-03 3 1  ON 23
ci_025                 8.168869e-03 3 1  ON 24
ci_026                 8.324186e-03 3 1  ON 25
ci_027                 7.478418e-03 3 1  ON 26
ci_028                 7.488893e-03 3 1  ON 27
ci_029                -7.123846e-03 3 1  ON 28
ci_030                -6.949933e-03 3 1  ON 29
ci_031                -5.856397e-03 3 1  ON 30
ci_032                -5.933707e-03 3 1  ON 31
ci_033                 6.112266e-03 3 1  ON 32
ci_034                 6.243611e-03 3 1  ON 33
ci_035                 5.324266e-03 3 1  ON 34
ci_036                 5.333449e-03 3 1  ON 35
ci_037                 5.933609e-03 3 1  ON 36
ci_038                 5.893218e-03 3 1  ON 37
ci_039                 5.232179e-03 3 1  ON 38
ci_040                 5.297706e-03 3 1  ON 39
ci_041                 4.609289e-03 3 1  ON 40
ci_042                 4.689806e-03 3 1  ON 41
ci_043                 4.721351e-03 3 1  ON 42
ci_044                 4.907115e-03 3 1  ON 43
ci_045                 4.508660e-03 3 1  ON 44
ci_046                 4.497000e-03 3 1  ON 45
ci_047                -3.387394e-03 3 1  ON 46
ci_048                -3.364655e-03 3 1  ON 47
ci_049                 2.673134e-03 3 1  ON 48
ci_050                 2.762975e-03 3 1  ON 49
ci_051                -2.681917e-03 3 1  ON 50
ci_052                -2.701340e-03 3 1  ON 51
ci_053                -2.470582e-03 3 1  ON 52
ci_054                -2.492639e-03 3 1  ON 53
ci_055                -1.936789e-03 3 1  ON 54
ci_056                -1.941094e-03 3 1  ON 55
ci_057                -1.637463e-03 3 1  ON 56
ci_058                -1.887529e-03 3 1  ON 57
ci_059                -1.357797e-03 3 1  ON 58
ci_060                -1.466395e-03 3 1  ON 59
ci_061                -1.424436e-03 3 1  ON 60
ci_062                -1.290969e-03 3 1  ON 61
ci_063                -1.045568e-03 3 1  ON 62
ci_064                -1.384489e-03 3 1  ON 63
ci_065                -1.490861e-03 3 1  ON 64
ci_066                -1.596537e-03 3 1  ON 65
ci_067                -1.375697e-03 3 1  ON 66
ci_068                -1.344124e-03 3 1  ON 67
ci_069                 7.567057e-04 3 1  ON 68
ci_070                 8.935571e-04 3 1  ON 69
ci_071                -1.507361e-03 3 1  ON 70
ci_072                -1.451893e-03 3 1  ON 71
ci_073                 9.307807e-04 3 1  ON 72
ci_074                 9.179260e-04 3 1  ON 73
ci_075                -8.255424e-04 3 1  ON 74
ci_076                -7.636974e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7402
    reference variance = 0.572062
====================================================
  Execution time = 4.9640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2665e+01
  VMC Evar = 5.0853e-01
  Total weights = 1.9549e+06
  Execution time = 7.2171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499289161745
                                         uncertainty =       0.002295206147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499289161745
                                         uncertainty =       0.002295206147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499624286
  error estimate for blocks of size 2^( 2) =       0.000518548626
  error estimate for blocks of size 2^( 3) =       0.000535340176
  error estimate for blocks of size 2^( 4) =       0.000547091976
  error estimate for blocks of size 2^( 5) =       0.000553210492
  error estimate for blocks of size 2^( 6) =       0.000557438711
  error estimate for blocks of size 2^( 7) =       0.000561061254

      target function =      -0.604332336532
              le_mean =     -22.664808372475
             les_mean =     514.211715540622
             stat err =       0.000554700608
             autocorr =       1.232622817728
   target nu stat err =       0.000554700608
   target dn stat err =       0.006378110067
      target stat err =       0.001905305216
              std dev =       0.706575441141
             le_variance =       0.499248854023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492798165484
                                         uncertainty =       0.002237913664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492798165484
                                         uncertainty =       0.002237913664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496367053
  error estimate for blocks of size 2^( 2) =       0.000515085088
  error estimate for blocks of size 2^( 3) =       0.000531681157
  error estimate for blocks of size 2^( 4) =       0.000543275124
  error estimate for blocks of size 2^( 5) =       0.000549343803
  error estimate for blocks of size 2^( 6) =       0.000553402333
  error estimate for blocks of size 2^( 7) =       0.000557158317

      target function =      -0.606737385986
              le_mean =     -22.664961354564
             les_mean =     514.210686701587
             stat err =       0.000550794894
             autocorr =       1.231328458465
   target nu stat err =       0.000550794894
   target dn stat err =       0.003870977348
      target stat err =       0.001185136902
              std dev =       0.701969018762
             le_variance =       0.492760503302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495094716386
                                         uncertainty =       0.002257240046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495094716386
                                         uncertainty =       0.002257240046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497521964
  error estimate for blocks of size 2^( 2) =       0.000516316798
  error estimate for blocks of size 2^( 3) =       0.000532987866
  error estimate for blocks of size 2^( 4) =       0.000544640374
  error estimate for blocks of size 2^( 5) =       0.000550736275
  error estimate for blocks of size 2^( 6) =       0.000554852423
  error estimate for blocks of size 2^( 7) =       0.000558561882

      target function =      -0.606815934029
              le_mean =     -22.664847327845
             les_mean =     514.205161602184
             stat err =       0.000552197738
             autocorr =       1.231869577510
   target nu stat err =       0.000552197738
   target dn stat err =       0.003604127538
      target stat err =       0.001108190070
              std dev =       0.703602309472
             le_variance =       0.495056209894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498680955196
                                         uncertainty =       0.002290145148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498680955196
                                         uncertainty =       0.002290145148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499320004
  error estimate for blocks of size 2^( 2) =       0.000518226726
  error estimate for blocks of size 2^( 3) =       0.000534995193
  error estimate for blocks of size 2^( 4) =       0.000546737564
  error estimate for blocks of size 2^( 5) =       0.000552865079
  error estimate for blocks of size 2^( 6) =       0.000557076779
  error estimate for blocks of size 2^( 7) =       0.000560743048

      target function =      -0.602592949484
              le_mean =     -22.664808458414
             les_mean =     514.217597690221
             stat err =       0.000554355618
             autocorr =       1.232590948507
   target nu stat err =       0.000554355618
   target dn stat err =       0.009213181630
      target stat err =       0.002721988529
              std dev =       0.706145122275
             le_variance =       0.498640933713


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.604332336532        initial
     1.5625e-01     1.5625e+00             4.8845e-03        -0.606737385986
     6.2500e-01     6.2500e+00             1.4423e-03        -0.606815934029  <--
     2.5000e+00     2.5000e+01             3.7761e-04        -0.602592949484

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 8.5870e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_001                -7.014880e-01 3 1  ON 0
ci_002                -7.012267e-01 3 1  ON 1
ci_003                -5.984598e-02 3 1  ON 2
ci_004                -5.989548e-02 3 1  ON 3
ci_005                 3.796233e-02 3 1  ON 4
ci_006                 3.801165e-02 3 1  ON 5
ci_007                 2.761867e-02 3 1  ON 6
ci_008                 2.768926e-02 3 1  ON 7
ci_009                -2.153452e-02 3 1  ON 8
ci_010                -2.156454e-02 3 1  ON 9
ci_011                -1.944696e-02 3 1  ON 10
ci_012                -1.943260e-02 3 1  ON 11
ci_013                 1.741821e-02 3 1  ON 12
ci_014                 1.731295e-02 3 1  ON 13
ci_015                 1.757020e-02 3 1  ON 14
ci_016                 1.754148e-02 3 1  ON 15
ci_017                 1.402764e-02 3 1  ON 16
ci_018                 1.394016e-02 3 1  ON 17
ci_019                 7.842181e-03 3 1  ON 18
ci_020                 8.135644e-03 3 1  ON 19
ci_021                -9.181761e-03 3 1  ON 20
ci_022                -9.464227e-03 3 1  ON 21
ci_023                 7.787909e-03 3 1  ON 22
ci_024                 7.819217e-03 3 1  ON 23
ci_025                 8.168869e-03 3 1  ON 24
ci_026                 8.324186e-03 3 1  ON 25
ci_027                 7.478418e-03 3 1  ON 26
ci_028                 7.488893e-03 3 1  ON 27
ci_029                -7.123846e-03 3 1  ON 28
ci_030                -6.949933e-03 3 1  ON 29
ci_031                -5.856397e-03 3 1  ON 30
ci_032                -5.933707e-03 3 1  ON 31
ci_033                 6.112266e-03 3 1  ON 32
ci_034                 6.243611e-03 3 1  ON 33
ci_035                 5.324266e-03 3 1  ON 34
ci_036                 5.333449e-03 3 1  ON 35
ci_037                 5.933609e-03 3 1  ON 36
ci_038                 5.893218e-03 3 1  ON 37
ci_039                 5.232179e-03 3 1  ON 38
ci_040                 5.297706e-03 3 1  ON 39
ci_041                 4.609289e-03 3 1  ON 40
ci_042                 4.689806e-03 3 1  ON 41
ci_043                 4.721351e-03 3 1  ON 42
ci_044                 4.907115e-03 3 1  ON 43
ci_045                 4.508660e-03 3 1  ON 44
ci_046                 4.497000e-03 3 1  ON 45
ci_047                -3.387394e-03 3 1  ON 46
ci_048                -3.364655e-03 3 1  ON 47
ci_049                 2.673134e-03 3 1  ON 48
ci_050                 2.762975e-03 3 1  ON 49
ci_051                -2.681917e-03 3 1  ON 50
ci_052                -2.701340e-03 3 1  ON 51
ci_053                -2.470582e-03 3 1  ON 52
ci_054                -2.492639e-03 3 1  ON 53
ci_055                -1.936789e-03 3 1  ON 54
ci_056                -1.941094e-03 3 1  ON 55
ci_057                -1.637463e-03 3 1  ON 56
ci_058                -1.887529e-03 3 1  ON 57
ci_059                -1.357797e-03 3 1  ON 58
ci_060                -1.466395e-03 3 1  ON 59
ci_061                -1.424436e-03 3 1  ON 60
ci_062                -1.290969e-03 3 1  ON 61
ci_063                -1.045568e-03 3 1  ON 62
ci_064                -1.384489e-03 3 1  ON 63
ci_065                -1.490861e-03 3 1  ON 64
ci_066                -1.596537e-03 3 1  ON 65
ci_067                -1.375697e-03 3 1  ON 66
ci_068                -1.344124e-03 3 1  ON 67
ci_069                 7.567057e-04 3 1  ON 68
ci_070                 8.935571e-04 3 1  ON 69
ci_071                -1.507361e-03 3 1  ON 70
ci_072                -1.451893e-03 3 1  ON 71
ci_073                 9.307807e-04 3 1  ON 72
ci_074                 9.179260e-04 3 1  ON 73
ci_075                -8.255424e-04 3 1  ON 74
ci_076                -7.636974e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4631e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2691e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6755
    reference variance = 0.270838
====================================================
  Execution time = 5.1176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -2.2665e+01
  VMC Evar = 5.3434e-01
  Total weights = 1.954668482e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517836931618
                                         uncertainty =       0.014511875557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517836931618
                                         uncertainty =       0.014511875557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508763706
  error estimate for blocks of size 2^( 2) =       0.000526560371
  error estimate for blocks of size 2^( 3) =       0.000543421998
  error estimate for blocks of size 2^( 4) =       0.000554601481
  error estimate for blocks of size 2^( 5) =       0.000563443866
  error estimate for blocks of size 2^( 6) =       0.000565660069
  error estimate for blocks of size 2^( 7) =       0.000569334639

      target function =      -0.599508348850
              le_mean =     -22.664611218452
             les_mean =     514.218938311713
             stat err =       0.000563260014
             autocorr =       1.225703986060
   target nu stat err =       0.000563260014
   target dn stat err =       0.017534178762
      target stat err =       0.005108882044
              std dev =       0.719500533358
             le_variance =       0.517681017503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266461121845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.599551342929       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.600638452867       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.600746722966       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.600761749448       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.600770028289       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.600773993927       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.600774852989       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.600775200527       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.600775702610       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.600775744394       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.600775705941       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.600775694026       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 4.411724e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.599551342929       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.599869525005       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.599899367063       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.599903250930       residual = 8.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.599905149119       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.599905927031       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.599906080419       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.599906143855       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.599906236619       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.599906237286       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.599906229946       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 1.301111e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.599551342929       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.599634426109       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.599642074883       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.599643050678       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.599643510080       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.599643690285       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.599643725099       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.599643739613       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.599643760792       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.599643760514       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.599643758832       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 3.404996e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.438919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0605e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_001                -7.024472e-01 3 1  ON 0
ci_002                -7.007140e-01 3 1  ON 1
ci_003                -5.940963e-02 3 1  ON 2
ci_004                -5.932145e-02 3 1  ON 3
ci_005                 3.666122e-02 3 1  ON 4
ci_006                 3.685030e-02 3 1  ON 5
ci_007                 2.681329e-02 3 1  ON 6
ci_008                 2.720258e-02 3 1  ON 7
ci_009                -2.096831e-02 3 1  ON 8
ci_010                -2.100683e-02 3 1  ON 9
ci_011                -1.892274e-02 3 1  ON 10
ci_012                -1.861840e-02 3 1  ON 11
ci_013                 1.678361e-02 3 1  ON 12
ci_014                 1.634223e-02 3 1  ON 13
ci_015                 1.735279e-02 3 1  ON 14
ci_016                 1.719942e-02 3 1  ON 15
ci_017                 1.361314e-02 3 1  ON 16
ci_018                 1.353833e-02 3 1  ON 17
ci_019                 7.515559e-03 3 1  ON 18
ci_020                 8.175089e-03 3 1  ON 19
ci_021                -8.999596e-03 3 1  ON 20
ci_022                -9.186455e-03 3 1  ON 21
ci_023                 7.731578e-03 3 1  ON 22
ci_024                 7.555407e-03 3 1  ON 23
ci_025                 8.195551e-03 3 1  ON 24
ci_026                 8.528195e-03 3 1  ON 25
ci_027                 7.342548e-03 3 1  ON 26
ci_028                 7.384423e-03 3 1  ON 27
ci_029                -7.010087e-03 3 1  ON 28
ci_030                -6.980777e-03 3 1  ON 29
ci_031                -5.600833e-03 3 1  ON 30
ci_032                -5.891120e-03 3 1  ON 31
ci_033                 6.070214e-03 3 1  ON 32
ci_034                 6.036336e-03 3 1  ON 33
ci_035                 5.047787e-03 3 1  ON 34
ci_036                 5.089824e-03 3 1  ON 35
ci_037                 5.796627e-03 3 1  ON 36
ci_038                 5.684636e-03 3 1  ON 37
ci_039                 5.194790e-03 3 1  ON 38
ci_040                 5.083754e-03 3 1  ON 39
ci_041                 4.532396e-03 3 1  ON 40
ci_042                 4.637550e-03 3 1  ON 41
ci_043                 4.708036e-03 3 1  ON 42
ci_044                 4.690484e-03 3 1  ON 43
ci_045                 4.350341e-03 3 1  ON 44
ci_046                 4.325979e-03 3 1  ON 45
ci_047                -3.221411e-03 3 1  ON 46
ci_048                -3.328671e-03 3 1  ON 47
ci_049                 2.584954e-03 3 1  ON 48
ci_050                 2.671434e-03 3 1  ON 49
ci_051                -2.655612e-03 3 1  ON 50
ci_052                -2.643714e-03 3 1  ON 51
ci_053                -2.442591e-03 3 1  ON 52
ci_054                -2.609904e-03 3 1  ON 53
ci_055                -1.646042e-03 3 1  ON 54
ci_056                -1.951327e-03 3 1  ON 55
ci_057                -1.572476e-03 3 1  ON 56
ci_058                -1.927069e-03 3 1  ON 57
ci_059                -1.372374e-03 3 1  ON 58
ci_060                -1.399275e-03 3 1  ON 59
ci_061                -1.438506e-03 3 1  ON 60
ci_062                -1.249950e-03 3 1  ON 61
ci_063                -1.017255e-03 3 1  ON 62
ci_064                -1.127094e-03 3 1  ON 63
ci_065                -1.521084e-03 3 1  ON 64
ci_066                -1.749052e-03 3 1  ON 65
ci_067                -1.556152e-03 3 1  ON 66
ci_068                -1.225083e-03 3 1  ON 67
ci_069                 6.196910e-04 3 1  ON 68
ci_070                 6.944621e-04 3 1  ON 69
ci_071                -1.557681e-03 3 1  ON 70
ci_072                -1.516634e-03 3 1  ON 71
ci_073                 8.093159e-04 3 1  ON 72
ci_074                 9.865923e-04 3 1  ON 73
ci_075                -8.308210e-04 3 1  ON 74
ci_076                -6.839695e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6825
    reference variance = 0.450887
====================================================
  Execution time = 4.9616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2665e+01
  VMC Evar = 5.0665e-01
  Total weights = 1.9546e+06
  Execution time = 7.2033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493147040084
                                         uncertainty =       0.002297499362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493147040084
                                         uncertainty =       0.002297499362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496582828
  error estimate for blocks of size 2^( 2) =       0.000515333577
  error estimate for blocks of size 2^( 3) =       0.000532074760
  error estimate for blocks of size 2^( 4) =       0.000543936048
  error estimate for blocks of size 2^( 5) =       0.000550997161
  error estimate for blocks of size 2^( 6) =       0.000553968823
  error estimate for blocks of size 2^( 7) =       0.000555251269

      target function =      -0.603121749665
              le_mean =     -22.665175845374
             les_mean =     514.232707035836
             stat err =       0.000551038325
             autocorr =       1.231346317987
   target nu stat err =       0.000551038325
   target dn stat err =       0.013400329780
      target stat err =       0.003956814160
              std dev =       0.702274170116
             le_variance =       0.493189010012

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0443779
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488377964320
                                         uncertainty =       0.002276139703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488377964320
                                         uncertainty =       0.002276139703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494178562
  error estimate for blocks of size 2^( 2) =       0.000512755165
  error estimate for blocks of size 2^( 3) =       0.000529318638
  error estimate for blocks of size 2^( 4) =       0.000541126696
  error estimate for blocks of size 2^( 5) =       0.000548126613
  error estimate for blocks of size 2^( 6) =       0.000551075733
  error estimate for blocks of size 2^( 7) =       0.000552355668

      target function =      -0.597157703161
              le_mean =     -22.665261567895
             les_mean =     514.257019910767
             stat err =       0.000548171177
             autocorr =       1.230451759553
   target nu stat err =       0.000548171177
   target dn stat err =       0.019075876903
      target stat err =       0.005516030428
              std dev =       0.698874024123
             le_variance =       0.488424901595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489749670840
                                         uncertainty =       0.002249254295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489749670840
                                         uncertainty =       0.002249254295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494871224
  error estimate for blocks of size 2^( 2) =       0.000513506631
  error estimate for blocks of size 2^( 3) =       0.000530151717
  error estimate for blocks of size 2^( 4) =       0.000541978392
  error estimate for blocks of size 2^( 5) =       0.000548996659
  error estimate for blocks of size 2^( 6) =       0.000551977042
  error estimate for blocks of size 2^( 7) =       0.000553256032

      target function =      -0.605897726693
              le_mean =     -22.665170268188
             les_mean =     514.223130111565
             stat err =       0.000549052031
             autocorr =       1.230956207769
   target nu stat err =       0.000549052031
   target dn stat err =       0.007292900462
      target stat err =       0.002184862888
              std dev =       0.699853596996
             le_variance =       0.489795057228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492633155980
                                         uncertainty =       0.002284205910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492633155980
                                         uncertainty =       0.002284205910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496324300
  error estimate for blocks of size 2^( 2) =       0.000515058556
  error estimate for blocks of size 2^( 3) =       0.000531784557
  error estimate for blocks of size 2^( 4) =       0.000543643808
  error estimate for blocks of size 2^( 5) =       0.000550698817
  error estimate for blocks of size 2^( 6) =       0.000553693155
  error estimate for blocks of size 2^( 7) =       0.000554990568

      target function =      -0.603930863728
              le_mean =     -22.665164078237
             les_mean =     514.229438941103
             stat err =       0.000550756587
             autocorr =       1.231369303159
   target nu stat err =       0.000550756587
   target dn stat err =       0.016792232556
      target stat err =       0.004967382675
              std dev =       0.701908556378
             le_variance =       0.492675621517


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.603121749665        initial
     1.5625e-01     1.5625e+00             4.4117e-03        -0.597157703161
     6.2500e-01     6.2500e+00             1.3011e-03        -0.605897726693  <--
     2.5000e+00     2.5000e+01             3.4050e-04        -0.603930863728

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 8.5740e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_001                -7.024472e-01 3 1  ON 0
ci_002                -7.007140e-01 3 1  ON 1
ci_003                -5.940963e-02 3 1  ON 2
ci_004                -5.932145e-02 3 1  ON 3
ci_005                 3.666122e-02 3 1  ON 4
ci_006                 3.685030e-02 3 1  ON 5
ci_007                 2.681329e-02 3 1  ON 6
ci_008                 2.720258e-02 3 1  ON 7
ci_009                -2.096831e-02 3 1  ON 8
ci_010                -2.100683e-02 3 1  ON 9
ci_011                -1.892274e-02 3 1  ON 10
ci_012                -1.861840e-02 3 1  ON 11
ci_013                 1.678361e-02 3 1  ON 12
ci_014                 1.634223e-02 3 1  ON 13
ci_015                 1.735279e-02 3 1  ON 14
ci_016                 1.719942e-02 3 1  ON 15
ci_017                 1.361314e-02 3 1  ON 16
ci_018                 1.353833e-02 3 1  ON 17
ci_019                 7.515559e-03 3 1  ON 18
ci_020                 8.175089e-03 3 1  ON 19
ci_021                -8.999596e-03 3 1  ON 20
ci_022                -9.186455e-03 3 1  ON 21
ci_023                 7.731578e-03 3 1  ON 22
ci_024                 7.555407e-03 3 1  ON 23
ci_025                 8.195551e-03 3 1  ON 24
ci_026                 8.528195e-03 3 1  ON 25
ci_027                 7.342548e-03 3 1  ON 26
ci_028                 7.384423e-03 3 1  ON 27
ci_029                -7.010087e-03 3 1  ON 28
ci_030                -6.980777e-03 3 1  ON 29
ci_031                -5.600833e-03 3 1  ON 30
ci_032                -5.891120e-03 3 1  ON 31
ci_033                 6.070214e-03 3 1  ON 32
ci_034                 6.036336e-03 3 1  ON 33
ci_035                 5.047787e-03 3 1  ON 34
ci_036                 5.089824e-03 3 1  ON 35
ci_037                 5.796627e-03 3 1  ON 36
ci_038                 5.684636e-03 3 1  ON 37
ci_039                 5.194790e-03 3 1  ON 38
ci_040                 5.083754e-03 3 1  ON 39
ci_041                 4.532396e-03 3 1  ON 40
ci_042                 4.637550e-03 3 1  ON 41
ci_043                 4.708036e-03 3 1  ON 42
ci_044                 4.690484e-03 3 1  ON 43
ci_045                 4.350341e-03 3 1  ON 44
ci_046                 4.325979e-03 3 1  ON 45
ci_047                -3.221411e-03 3 1  ON 46
ci_048                -3.328671e-03 3 1  ON 47
ci_049                 2.584954e-03 3 1  ON 48
ci_050                 2.671434e-03 3 1  ON 49
ci_051                -2.655612e-03 3 1  ON 50
ci_052                -2.643714e-03 3 1  ON 51
ci_053                -2.442591e-03 3 1  ON 52
ci_054                -2.609904e-03 3 1  ON 53
ci_055                -1.646042e-03 3 1  ON 54
ci_056                -1.951327e-03 3 1  ON 55
ci_057                -1.572476e-03 3 1  ON 56
ci_058                -1.927069e-03 3 1  ON 57
ci_059                -1.372374e-03 3 1  ON 58
ci_060                -1.399275e-03 3 1  ON 59
ci_061                -1.438506e-03 3 1  ON 60
ci_062                -1.249950e-03 3 1  ON 61
ci_063                -1.017255e-03 3 1  ON 62
ci_064                -1.127094e-03 3 1  ON 63
ci_065                -1.521084e-03 3 1  ON 64
ci_066                -1.749052e-03 3 1  ON 65
ci_067                -1.556152e-03 3 1  ON 66
ci_068                -1.225083e-03 3 1  ON 67
ci_069                 6.196910e-04 3 1  ON 68
ci_070                 6.944621e-04 3 1  ON 69
ci_071                -1.557681e-03 3 1  ON 70
ci_072                -1.516634e-03 3 1  ON 71
ci_073                 8.093159e-04 3 1  ON 72
ci_074                 9.865923e-04 3 1  ON 73
ci_075                -8.308210e-04 3 1  ON 74
ci_076                -6.839695e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4636e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2690e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7096
    reference variance = 0.469391
====================================================
  Execution time = 5.1169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2665e+01
  VMC Evar = 5.0562e-01
  Total weights = 1.955260225e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494117689833
                                         uncertainty =       0.002630753141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494117689833
                                         uncertainty =       0.002630753141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497058916
  error estimate for blocks of size 2^( 2) =       0.000515512247
  error estimate for blocks of size 2^( 3) =       0.000532061324
  error estimate for blocks of size 2^( 4) =       0.000544570761
  error estimate for blocks of size 2^( 5) =       0.000550611435
  error estimate for blocks of size 2^( 6) =       0.000553503839
  error estimate for blocks of size 2^( 7) =       0.000555811393

      target function =      -0.608210850573
              le_mean =     -22.665370180833
             les_mean =     514.224626632729
             stat err =       0.000551124357
             autocorr =       1.229372444817
   target nu stat err =       0.000551124357
   target dn stat err =       0.003398385501
      target stat err =       0.001053803066
              std dev =       0.702947459663
             le_variance =       0.494135131046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266537018083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608212403186       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609240890705       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609344948643       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609357273331       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609360351624       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609361307662       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609361763242       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609361922892       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609361966786       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609361937004       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609361941386       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.609361937963       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 4.674306e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608212403186       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608514321230       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608543066832       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608546230805       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608546975952       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608547187595       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608547276421       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608547308118       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608547315982       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608547309499       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608547310006       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 1.378395e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608212403186       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608291311660       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608298684012       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608299477307       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608299660804       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608299711587       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608299732128       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608299739498       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608299741268       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608299739735       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608299739833       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 3.607987e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.452424 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0631e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_001                -7.025415e-01 3 1  ON 0
ci_002                -7.010527e-01 3 1  ON 1
ci_003                -5.888264e-02 3 1  ON 2
ci_004                -5.903748e-02 3 1  ON 3
ci_005                 3.528282e-02 3 1  ON 4
ci_006                 3.557919e-02 3 1  ON 5
ci_007                 2.598962e-02 3 1  ON 6
ci_008                 2.645294e-02 3 1  ON 7
ci_009                -2.039902e-02 3 1  ON 8
ci_010                -2.043797e-02 3 1  ON 9
ci_011                -1.831167e-02 3 1  ON 10
ci_012                -1.795092e-02 3 1  ON 11
ci_013                 1.612885e-02 3 1  ON 12
ci_014                 1.585655e-02 3 1  ON 13
ci_015                 1.696099e-02 3 1  ON 14
ci_016                 1.675048e-02 3 1  ON 15
ci_017                 1.334377e-02 3 1  ON 16
ci_018                 1.322240e-02 3 1  ON 17
ci_019                 7.057541e-03 3 1  ON 18
ci_020                 7.792800e-03 3 1  ON 19
ci_021                -8.867448e-03 3 1  ON 20
ci_022                -9.120013e-03 3 1  ON 21
ci_023                 7.592448e-03 3 1  ON 22
ci_024                 7.448245e-03 3 1  ON 23
ci_025                 8.329081e-03 3 1  ON 24
ci_026                 8.597084e-03 3 1  ON 25
ci_027                 7.255340e-03 3 1  ON 26
ci_028                 7.366416e-03 3 1  ON 27
ci_029                -6.783143e-03 3 1  ON 28
ci_030                -6.845779e-03 3 1  ON 29
ci_031                -5.280322e-03 3 1  ON 30
ci_032                -5.620837e-03 3 1  ON 31
ci_033                 5.930891e-03 3 1  ON 32
ci_034                 5.840732e-03 3 1  ON 33
ci_035                 4.809103e-03 3 1  ON 34
ci_036                 4.913044e-03 3 1  ON 35
ci_037                 5.684793e-03 3 1  ON 36
ci_038                 5.594371e-03 3 1  ON 37
ci_039                 5.148858e-03 3 1  ON 38
ci_040                 5.044206e-03 3 1  ON 39
ci_041                 4.498134e-03 3 1  ON 40
ci_042                 4.540437e-03 3 1  ON 41
ci_043                 4.629512e-03 3 1  ON 42
ci_044                 4.599464e-03 3 1  ON 43
ci_045                 4.205015e-03 3 1  ON 44
ci_046                 4.201988e-03 3 1  ON 45
ci_047                -3.029369e-03 3 1  ON 46
ci_048                -3.169660e-03 3 1  ON 47
ci_049                 2.534004e-03 3 1  ON 48
ci_050                 2.578886e-03 3 1  ON 49
ci_051                -2.603621e-03 3 1  ON 50
ci_052                -2.572222e-03 3 1  ON 51
ci_053                -2.412338e-03 3 1  ON 52
ci_054                -2.593580e-03 3 1  ON 53
ci_055                -1.600256e-03 3 1  ON 54
ci_056                -1.899778e-03 3 1  ON 55
ci_057                -1.539903e-03 3 1  ON 56
ci_058                -1.884010e-03 3 1  ON 57
ci_059                -1.302474e-03 3 1  ON 58
ci_060                -1.315989e-03 3 1  ON 59
ci_061                -1.350394e-03 3 1  ON 60
ci_062                -1.151751e-03 3 1  ON 61
ci_063                -1.016508e-03 3 1  ON 62
ci_064                -1.024824e-03 3 1  ON 63
ci_065                -1.615531e-03 3 1  ON 64
ci_066                -1.771244e-03 3 1  ON 65
ci_067                -1.498109e-03 3 1  ON 66
ci_068                -1.213399e-03 3 1  ON 67
ci_069                 6.547582e-04 3 1  ON 68
ci_070                 6.802123e-04 3 1  ON 69
ci_071                -1.652492e-03 3 1  ON 70
ci_072                -1.493283e-03 3 1  ON 71
ci_073                 7.636101e-04 3 1  ON 72
ci_074                 9.547640e-04 3 1  ON 73
ci_075                -7.998663e-04 3 1  ON 74
ci_076                -6.459413e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6856
    reference variance = 0.433658
====================================================
  Execution time = 4.9692e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2664e+01
  VMC Evar = 5.2068e-01
  Total weights = 1.9545e+06
  Execution time = 7.1914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506427891660
                                         uncertainty =       0.005182698522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506427891660
                                         uncertainty =       0.005182698522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503132374
  error estimate for blocks of size 2^( 2) =       0.000521788445
  error estimate for blocks of size 2^( 3) =       0.000538327826
  error estimate for blocks of size 2^( 4) =       0.000550394552
  error estimate for blocks of size 2^( 5) =       0.000557380497
  error estimate for blocks of size 2^( 6) =       0.000560440190
  error estimate for blocks of size 2^( 7) =       0.000563871980

      target function =      -0.587108453372
              le_mean =     -22.664483810995
             les_mean =     514.255434009333
             stat err =       0.000558021805
             autocorr =       1.230092619538
   target nu stat err =       0.000558021805
   target dn stat err =       0.052360194142
      target stat err =       0.014619398004
              std dev =       0.711536627043
             le_variance =       0.506284371624

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.25435
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500997338766
                                         uncertainty =       0.005102551110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500997338766
                                         uncertainty =       0.005102551110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500428249
  error estimate for blocks of size 2^( 2) =       0.000518943379
  error estimate for blocks of size 2^( 3) =       0.000535363944
  error estimate for blocks of size 2^( 4) =       0.000547265412
  error estimate for blocks of size 2^( 5) =       0.000554285887
  error estimate for blocks of size 2^( 6) =       0.000557303803
  error estimate for blocks of size 2^( 7) =       0.000560763686

      target function =      -0.595059155518
              le_mean =     -22.664562034507
             les_mean =     514.232054190386
             stat err =       0.000554904697
             autocorr =       1.229569740296
   target nu stat err =       0.000554904697
   target dn stat err =       0.018888024144
      target stat err =       0.005420635427
              std dev =       0.707712417091
             le_variance =       0.500856865304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502652232005
                                         uncertainty =       0.005113838296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502652232005
                                         uncertainty =       0.005113838296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501253963
  error estimate for blocks of size 2^( 2) =       0.000519830827
  error estimate for blocks of size 2^( 3) =       0.000536292961
  error estimate for blocks of size 2^( 4) =       0.000548266230
  error estimate for blocks of size 2^( 5) =       0.000555244148
  error estimate for blocks of size 2^( 6) =       0.000558270440
  error estimate for blocks of size 2^( 7) =       0.000561686475

      target function =      -0.603741716232
              le_mean =     -22.664479347482
             les_mean =     514.198534229028
             stat err =       0.000555866823
             autocorr =       1.229775592249
   target nu stat err =       0.000555866823
   target dn stat err =       0.006156170810
      target stat err =       0.001836412385
              std dev =       0.708880153290
             le_variance =       0.502511071729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505842462429
                                         uncertainty =       0.005171142346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505842462429
                                         uncertainty =       0.005171142346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502841659
  error estimate for blocks of size 2^( 2) =       0.000521488012
  error estimate for blocks of size 2^( 3) =       0.000538009773
  error estimate for blocks of size 2^( 4) =       0.000550058721
  error estimate for blocks of size 2^( 5) =       0.000557038743
  error estimate for blocks of size 2^( 6) =       0.000560091104
  error estimate for blocks of size 2^( 7) =       0.000563501489

      target function =      -0.595248476631
              le_mean =     -22.664478391007
             les_mean =     514.227506286633
             stat err =       0.000557672515
             autocorr =       1.229974139591
   target nu stat err =       0.000557672515
   target dn stat err =       0.020465581531
      target stat err =       0.005875798081
              std dev =       0.711125493256
             le_variance =       0.505699467159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.587108453372        initial
     1.5625e-01     1.5625e+00             4.6743e-03        -0.595059155518
     6.2500e-01     6.2500e+00             1.3784e-03        -0.603741716232  <--
     2.5000e+00     2.5000e+01             3.6080e-04        -0.595248476631

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 8.5769e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_001                -7.025415e-01 3 1  ON 0
ci_002                -7.010527e-01 3 1  ON 1
ci_003                -5.888264e-02 3 1  ON 2
ci_004                -5.903748e-02 3 1  ON 3
ci_005                 3.528282e-02 3 1  ON 4
ci_006                 3.557919e-02 3 1  ON 5
ci_007                 2.598962e-02 3 1  ON 6
ci_008                 2.645294e-02 3 1  ON 7
ci_009                -2.039902e-02 3 1  ON 8
ci_010                -2.043797e-02 3 1  ON 9
ci_011                -1.831167e-02 3 1  ON 10
ci_012                -1.795092e-02 3 1  ON 11
ci_013                 1.612885e-02 3 1  ON 12
ci_014                 1.585655e-02 3 1  ON 13
ci_015                 1.696099e-02 3 1  ON 14
ci_016                 1.675048e-02 3 1  ON 15
ci_017                 1.334377e-02 3 1  ON 16
ci_018                 1.322240e-02 3 1  ON 17
ci_019                 7.057541e-03 3 1  ON 18
ci_020                 7.792800e-03 3 1  ON 19
ci_021                -8.867448e-03 3 1  ON 20
ci_022                -9.120013e-03 3 1  ON 21
ci_023                 7.592448e-03 3 1  ON 22
ci_024                 7.448245e-03 3 1  ON 23
ci_025                 8.329081e-03 3 1  ON 24
ci_026                 8.597084e-03 3 1  ON 25
ci_027                 7.255340e-03 3 1  ON 26
ci_028                 7.366416e-03 3 1  ON 27
ci_029                -6.783143e-03 3 1  ON 28
ci_030                -6.845779e-03 3 1  ON 29
ci_031                -5.280322e-03 3 1  ON 30
ci_032                -5.620837e-03 3 1  ON 31
ci_033                 5.930891e-03 3 1  ON 32
ci_034                 5.840732e-03 3 1  ON 33
ci_035                 4.809103e-03 3 1  ON 34
ci_036                 4.913044e-03 3 1  ON 35
ci_037                 5.684793e-03 3 1  ON 36
ci_038                 5.594371e-03 3 1  ON 37
ci_039                 5.148858e-03 3 1  ON 38
ci_040                 5.044206e-03 3 1  ON 39
ci_041                 4.498134e-03 3 1  ON 40
ci_042                 4.540437e-03 3 1  ON 41
ci_043                 4.629512e-03 3 1  ON 42
ci_044                 4.599464e-03 3 1  ON 43
ci_045                 4.205015e-03 3 1  ON 44
ci_046                 4.201988e-03 3 1  ON 45
ci_047                -3.029369e-03 3 1  ON 46
ci_048                -3.169660e-03 3 1  ON 47
ci_049                 2.534004e-03 3 1  ON 48
ci_050                 2.578886e-03 3 1  ON 49
ci_051                -2.603621e-03 3 1  ON 50
ci_052                -2.572222e-03 3 1  ON 51
ci_053                -2.412338e-03 3 1  ON 52
ci_054                -2.593580e-03 3 1  ON 53
ci_055                -1.600256e-03 3 1  ON 54
ci_056                -1.899778e-03 3 1  ON 55
ci_057                -1.539903e-03 3 1  ON 56
ci_058                -1.884010e-03 3 1  ON 57
ci_059                -1.302474e-03 3 1  ON 58
ci_060                -1.315989e-03 3 1  ON 59
ci_061                -1.350394e-03 3 1  ON 60
ci_062                -1.151751e-03 3 1  ON 61
ci_063                -1.016508e-03 3 1  ON 62
ci_064                -1.024824e-03 3 1  ON 63
ci_065                -1.615531e-03 3 1  ON 64
ci_066                -1.771244e-03 3 1  ON 65
ci_067                -1.498109e-03 3 1  ON 66
ci_068                -1.213399e-03 3 1  ON 67
ci_069                 6.547582e-04 3 1  ON 68
ci_070                 6.802123e-04 3 1  ON 69
ci_071                -1.652492e-03 3 1  ON 70
ci_072                -1.493283e-03 3 1  ON 71
ci_073                 7.636101e-04 3 1  ON 72
ci_074                 9.547640e-04 3 1  ON 73
ci_075                -7.998663e-04 3 1  ON 74
ci_076                -6.459413e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4642e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2691e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6292
    reference variance = 0.423488
====================================================
  Execution time = 5.1051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.1326e-01
  Total weights = 1.954491213e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499573556522
                                         uncertainty =       0.004664193902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499573556522
                                         uncertainty =       0.004664193902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499783055
  error estimate for blocks of size 2^( 2) =       0.000517985287
  error estimate for blocks of size 2^( 3) =       0.000534956619
  error estimate for blocks of size 2^( 4) =       0.000546057202
  error estimate for blocks of size 2^( 5) =       0.000554069226
  error estimate for blocks of size 2^( 6) =       0.000557357838
  error estimate for blocks of size 2^( 7) =       0.000557640499

      target function =      -0.606044245599
              le_mean =     -22.665847610487
             les_mean =     514.253908510965
             stat err =       0.000553781191
             autocorr =       1.227759626198
   target nu stat err =       0.000553781191
   target dn stat err =       0.005431816861
      target stat err =       0.001639259192
              std dev =       0.706799974313
             le_variance =       0.499566203688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266584761049e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.606048315175       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607004375263       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607098079082       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607106902906       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607109378527       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607109684951       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607109710387       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607109606260       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607109590600       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607109615507       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607109621916       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 4.314034e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.606048315175       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.606328879383       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.606354611747       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.606356840930       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.606357441504       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.606357497247       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.606357492879       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.606357468483       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.606357466386       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.606357471318       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.606357472154       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 1.273103e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.606048315175       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.606121635803       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.606128223441       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.606128779494       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.606128927488       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.606128939919       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.606128938188       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.606128932261       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.606128931856       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.606128932999       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.606128933164       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 3.332789e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.465575 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0491e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_001                -7.028234e-01 3 1  ON 0
ci_002                -7.011681e-01 3 1  ON 1
ci_003                -5.839903e-02 3 1  ON 2
ci_004                -5.876259e-02 3 1  ON 3
ci_005                 3.403413e-02 3 1  ON 4
ci_006                 3.430608e-02 3 1  ON 5
ci_007                 2.521313e-02 3 1  ON 6
ci_008                 2.568472e-02 3 1  ON 7
ci_009                -1.982814e-02 3 1  ON 8
ci_010                -1.990717e-02 3 1  ON 9
ci_011                -1.774339e-02 3 1  ON 10
ci_012                -1.742749e-02 3 1  ON 11
ci_013                 1.563516e-02 3 1  ON 12
ci_014                 1.528744e-02 3 1  ON 13
ci_015                 1.653688e-02 3 1  ON 14
ci_016                 1.627309e-02 3 1  ON 15
ci_017                 1.302889e-02 3 1  ON 16
ci_018                 1.289569e-02 3 1  ON 17
ci_019                 6.695363e-03 3 1  ON 18
ci_020                 7.340226e-03 3 1  ON 19
ci_021                -8.903681e-03 3 1  ON 20
ci_022                -9.176812e-03 3 1  ON 21
ci_023                 7.408709e-03 3 1  ON 22
ci_024                 7.237398e-03 3 1  ON 23
ci_025                 8.433739e-03 3 1  ON 24
ci_026                 8.773594e-03 3 1  ON 25
ci_027                 7.210752e-03 3 1  ON 26
ci_028                 7.290049e-03 3 1  ON 27
ci_029                -6.542409e-03 3 1  ON 28
ci_030                -6.712126e-03 3 1  ON 29
ci_031                -4.944104e-03 3 1  ON 30
ci_032                -5.345170e-03 3 1  ON 31
ci_033                 5.797140e-03 3 1  ON 32
ci_034                 5.785628e-03 3 1  ON 33
ci_035                 4.583496e-03 3 1  ON 34
ci_036                 4.688295e-03 3 1  ON 35
ci_037                 5.564206e-03 3 1  ON 36
ci_038                 5.449099e-03 3 1  ON 37
ci_039                 5.129588e-03 3 1  ON 38
ci_040                 4.939224e-03 3 1  ON 39
ci_041                 4.486545e-03 3 1  ON 40
ci_042                 4.410837e-03 3 1  ON 41
ci_043                 4.618265e-03 3 1  ON 42
ci_044                 4.530103e-03 3 1  ON 43
ci_045                 4.133230e-03 3 1  ON 44
ci_046                 4.080666e-03 3 1  ON 45
ci_047                -2.896620e-03 3 1  ON 46
ci_048                -3.045274e-03 3 1  ON 47
ci_049                 2.485562e-03 3 1  ON 48
ci_050                 2.428875e-03 3 1  ON 49
ci_051                -2.583699e-03 3 1  ON 50
ci_052                -2.547735e-03 3 1  ON 51
ci_053                -2.435363e-03 3 1  ON 52
ci_054                -2.584136e-03 3 1  ON 53
ci_055                -1.612140e-03 3 1  ON 54
ci_056                -1.821266e-03 3 1  ON 55
ci_057                -1.489928e-03 3 1  ON 56
ci_058                -1.845368e-03 3 1  ON 57
ci_059                -1.188885e-03 3 1  ON 58
ci_060                -1.299119e-03 3 1  ON 59
ci_061                -1.290273e-03 3 1  ON 60
ci_062                -1.171527e-03 3 1  ON 61
ci_063                -1.157551e-03 3 1  ON 62
ci_064                -1.115294e-03 3 1  ON 63
ci_065                -1.631043e-03 3 1  ON 64
ci_066                -1.720302e-03 3 1  ON 65
ci_067                -1.488602e-03 3 1  ON 66
ci_068                -1.219906e-03 3 1  ON 67
ci_069                 6.318215e-04 3 1  ON 68
ci_070                 5.848864e-04 3 1  ON 69
ci_071                -1.696025e-03 3 1  ON 70
ci_072                -1.662072e-03 3 1  ON 71
ci_073                 7.185589e-04 3 1  ON 72
ci_074                 9.877454e-04 3 1  ON 73
ci_075                -8.368118e-04 3 1  ON 74
ci_076                -5.655488e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7556
    reference variance = 0.373114
====================================================
  Execution time = 4.9587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0636e-01
  Total weights = 1.9545e+06
  Execution time = 7.2400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493957919684
                                         uncertainty =       0.002534490641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493957919684
                                         uncertainty =       0.002534490641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497033254
  error estimate for blocks of size 2^( 2) =       0.000515456321
  error estimate for blocks of size 2^( 3) =       0.000532404026
  error estimate for blocks of size 2^( 4) =       0.000543739938
  error estimate for blocks of size 2^( 5) =       0.000550818912
  error estimate for blocks of size 2^( 6) =       0.000552961829
  error estimate for blocks of size 2^( 7) =       0.000554617314

      target function =      -0.607408544556
              le_mean =     -22.666057777639
             les_mean =     514.259042976904
             stat err =       0.000550534498
             autocorr =       1.226868976445
   target nu stat err =       0.000550534498
   target dn stat err =       0.003443988735
      target stat err =       0.001064808335
              std dev =       0.702911168526
             le_variance =       0.494084110839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489959401324
                                         uncertainty =       0.002605707179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489959401324
                                         uncertainty =       0.002605707179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495017956
  error estimate for blocks of size 2^( 2) =       0.000513288694
  error estimate for blocks of size 2^( 3) =       0.000530101875
  error estimate for blocks of size 2^( 4) =       0.000541339792
  error estimate for blocks of size 2^( 5) =       0.000548408326
  error estimate for blocks of size 2^( 6) =       0.000550611047
  error estimate for blocks of size 2^( 7) =       0.000552227395

      target function =      -0.591985399845
              le_mean =     -22.666102740906
             les_mean =     514.313249210251
             stat err =       0.000548146640
             autocorr =       1.226172599250
   target nu stat err =       0.000548146640
   target dn stat err =       0.040848247464
      target stat err =       0.011608989597
              std dev =       0.700061107584
             le_variance =       0.490085554352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490902420220
                                         uncertainty =       0.002531160650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490902420220
                                         uncertainty =       0.002531160650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495494295
  error estimate for blocks of size 2^( 2) =       0.000513828096
  error estimate for blocks of size 2^( 3) =       0.000530702221
  error estimate for blocks of size 2^( 4) =       0.000541965691
  error estimate for blocks of size 2^( 5) =       0.000549042930
  error estimate for blocks of size 2^( 6) =       0.000551241620
  error estimate for blocks of size 2^( 7) =       0.000552848286

      target function =      -0.598555339713
              le_mean =     -22.666052964543
             les_mean =     514.288472044576
             stat err =       0.000548774632
             autocorr =       1.226621964948
   target nu stat err =       0.000548774632
   target dn stat err =       0.028807832774
      target stat err =       0.008370031280
              std dev =       0.700734751910
             le_variance =       0.491029192534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493507267252
                                         uncertainty =       0.002533708691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493507267252
                                         uncertainty =       0.002533708691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496806579
  error estimate for blocks of size 2^( 2) =       0.000515217697
  error estimate for blocks of size 2^( 3) =       0.000532154776
  error estimate for blocks of size 2^( 4) =       0.000543475973
  error estimate for blocks of size 2^( 5) =       0.000550545474
  error estimate for blocks of size 2^( 6) =       0.000552694599
  error estimate for blocks of size 2^( 7) =       0.000554350794

      target function =      -0.607182166194
              le_mean =     -22.666050894031
             les_mean =     514.259482144065
             stat err =       0.000550266710
             autocorr =       1.226794449026
   target nu stat err =       0.000550266710
   target dn stat err =       0.003602554497
      target stat err =       0.001109882313
              std dev =       0.702590602464
             le_variance =       0.493633554670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607408544556        initial  <--
     1.5625e-01     1.5625e+00             4.3140e-03        -0.591985399845
     6.2500e-01     6.2500e+00             1.2731e-03        -0.598555339713
     2.5000e+00     2.5000e+01             3.3328e-04        -0.607182166194

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 89.6068
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_001                -7.025415e-01 3 1  ON 0
ci_002                -7.010527e-01 3 1  ON 1
ci_003                -5.888264e-02 3 1  ON 2
ci_004                -5.903748e-02 3 1  ON 3
ci_005                 3.528282e-02 3 1  ON 4
ci_006                 3.557919e-02 3 1  ON 5
ci_007                 2.598962e-02 3 1  ON 6
ci_008                 2.645294e-02 3 1  ON 7
ci_009                -2.039902e-02 3 1  ON 8
ci_010                -2.043797e-02 3 1  ON 9
ci_011                -1.831167e-02 3 1  ON 10
ci_012                -1.795092e-02 3 1  ON 11
ci_013                 1.612885e-02 3 1  ON 12
ci_014                 1.585655e-02 3 1  ON 13
ci_015                 1.696099e-02 3 1  ON 14
ci_016                 1.675048e-02 3 1  ON 15
ci_017                 1.334377e-02 3 1  ON 16
ci_018                 1.322240e-02 3 1  ON 17
ci_019                 7.057541e-03 3 1  ON 18
ci_020                 7.792800e-03 3 1  ON 19
ci_021                -8.867448e-03 3 1  ON 20
ci_022                -9.120013e-03 3 1  ON 21
ci_023                 7.592448e-03 3 1  ON 22
ci_024                 7.448245e-03 3 1  ON 23
ci_025                 8.329081e-03 3 1  ON 24
ci_026                 8.597084e-03 3 1  ON 25
ci_027                 7.255340e-03 3 1  ON 26
ci_028                 7.366416e-03 3 1  ON 27
ci_029                -6.783143e-03 3 1  ON 28
ci_030                -6.845779e-03 3 1  ON 29
ci_031                -5.280322e-03 3 1  ON 30
ci_032                -5.620837e-03 3 1  ON 31
ci_033                 5.930891e-03 3 1  ON 32
ci_034                 5.840732e-03 3 1  ON 33
ci_035                 4.809103e-03 3 1  ON 34
ci_036                 4.913044e-03 3 1  ON 35
ci_037                 5.684793e-03 3 1  ON 36
ci_038                 5.594371e-03 3 1  ON 37
ci_039                 5.148858e-03 3 1  ON 38
ci_040                 5.044206e-03 3 1  ON 39
ci_041                 4.498134e-03 3 1  ON 40
ci_042                 4.540437e-03 3 1  ON 41
ci_043                 4.629512e-03 3 1  ON 42
ci_044                 4.599464e-03 3 1  ON 43
ci_045                 4.205015e-03 3 1  ON 44
ci_046                 4.201988e-03 3 1  ON 45
ci_047                -3.029369e-03 3 1  ON 46
ci_048                -3.169660e-03 3 1  ON 47
ci_049                 2.534004e-03 3 1  ON 48
ci_050                 2.578886e-03 3 1  ON 49
ci_051                -2.603621e-03 3 1  ON 50
ci_052                -2.572222e-03 3 1  ON 51
ci_053                -2.412338e-03 3 1  ON 52
ci_054                -2.593580e-03 3 1  ON 53
ci_055                -1.600256e-03 3 1  ON 54
ci_056                -1.899778e-03 3 1  ON 55
ci_057                -1.539903e-03 3 1  ON 56
ci_058                -1.884010e-03 3 1  ON 57
ci_059                -1.302474e-03 3 1  ON 58
ci_060                -1.315989e-03 3 1  ON 59
ci_061                -1.350394e-03 3 1  ON 60
ci_062                -1.151751e-03 3 1  ON 61
ci_063                -1.016508e-03 3 1  ON 62
ci_064                -1.024824e-03 3 1  ON 63
ci_065                -1.615531e-03 3 1  ON 64
ci_066                -1.771244e-03 3 1  ON 65
ci_067                -1.498109e-03 3 1  ON 66
ci_068                -1.213399e-03 3 1  ON 67
ci_069                 6.547582e-04 3 1  ON 68
ci_070                 6.802123e-04 3 1  ON 69
ci_071                -1.652492e-03 3 1  ON 70
ci_072                -1.493283e-03 3 1  ON 71
ci_073                 7.636101e-04 3 1  ON 72
ci_074                 9.547640e-04 3 1  ON 73
ci_075                -7.998663e-04 3 1  ON 74
ci_076                -6.459413e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.5011e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2691e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6513
    reference variance = 0.406798
====================================================
  Execution time = 5.1204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2665e+01
  VMC Evar = 5.0623e-01
  Total weights = 1.954760639e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494028248066
                                         uncertainty =       0.002718062752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494028248066
                                         uncertainty =       0.002718062752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496942723
  error estimate for blocks of size 2^( 2) =       0.000515725574
  error estimate for blocks of size 2^( 3) =       0.000533162830
  error estimate for blocks of size 2^( 4) =       0.000545460676
  error estimate for blocks of size 2^( 5) =       0.000552043947
  error estimate for blocks of size 2^( 6) =       0.000554911692
  error estimate for blocks of size 2^( 7) =       0.000558072648

      target function =      -0.607945931063
              le_mean =     -22.665037979355
             les_mean =     514.210178678554
             stat err =       0.000552622241
             autocorr =       1.236642159699
   target nu stat err =       0.000552622241
   target dn stat err =       0.003354351151
      target stat err =       0.001040097178
              std dev =       0.702783138635
             le_variance =       0.493904139949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266503797935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607947399420       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608054798088       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608064732599       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608065828397       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608066145477       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608066205706       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608066235215       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608066240736       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608066243560       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 5.255749e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607947399420       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607974744029       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607977253931       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607977528638       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607977607638       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607977622312       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607977629470       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607977630810       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607977631494       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.338916e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607947399420       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607954267214       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607954896345       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607954965067       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607954984798       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607954988442       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607954990218       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607954990550       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607954990720       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 3.363270e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.470084 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0542e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_001                -7.025622e-01 3 1  ON 0
ci_002                -7.010722e-01 3 1  ON 1
ci_003                -5.883922e-02 3 1  ON 2
ci_004                -5.900356e-02 3 1  ON 3
ci_005                 3.514893e-02 3 1  ON 4
ci_006                 3.544563e-02 3 1  ON 5
ci_007                 2.591836e-02 3 1  ON 6
ci_008                 2.637767e-02 3 1  ON 7
ci_009                -2.034411e-02 3 1  ON 8
ci_010                -2.037772e-02 3 1  ON 9
ci_011                -1.825189e-02 3 1  ON 10
ci_012                -1.789309e-02 3 1  ON 11
ci_013                 1.607961e-02 3 1  ON 12
ci_014                 1.581728e-02 3 1  ON 13
ci_015                 1.691794e-02 3 1  ON 14
ci_016                 1.671675e-02 3 1  ON 15
ci_017                 1.330221e-02 3 1  ON 16
ci_018                 1.319121e-02 3 1  ON 17
ci_019                 7.019435e-03 3 1  ON 18
ci_020                 7.763594e-03 3 1  ON 19
ci_021                -8.860240e-03 3 1  ON 20
ci_022                -9.121503e-03 3 1  ON 21
ci_023                 7.584290e-03 3 1  ON 22
ci_024                 7.438495e-03 3 1  ON 23
ci_025                 8.330075e-03 3 1  ON 24
ci_026                 8.605482e-03 3 1  ON 25
ci_027                 7.246366e-03 3 1  ON 26
ci_028                 7.361507e-03 3 1  ON 27
ci_029                -6.769022e-03 3 1  ON 28
ci_030                -6.834202e-03 3 1  ON 29
ci_031                -5.249919e-03 3 1  ON 30
ci_032                -5.583338e-03 3 1  ON 31
ci_033                 5.917724e-03 3 1  ON 32
ci_034                 5.817382e-03 3 1  ON 33
ci_035                 4.791417e-03 3 1  ON 34
ci_036                 4.887834e-03 3 1  ON 35
ci_037                 5.669497e-03 3 1  ON 36
ci_038                 5.589010e-03 3 1  ON 37
ci_039                 5.147622e-03 3 1  ON 38
ci_040                 5.038097e-03 3 1  ON 39
ci_041                 4.492472e-03 3 1  ON 40
ci_042                 4.533810e-03 3 1  ON 41
ci_043                 4.630770e-03 3 1  ON 42
ci_044                 4.593970e-03 3 1  ON 43
ci_045                 4.193798e-03 3 1  ON 44
ci_046                 4.202203e-03 3 1  ON 45
ci_047                -3.018193e-03 3 1  ON 46
ci_048                -3.156380e-03 3 1  ON 47
ci_049                 2.512382e-03 3 1  ON 48
ci_050                 2.575769e-03 3 1  ON 49
ci_051                -2.603316e-03 3 1  ON 50
ci_052                -2.559571e-03 3 1  ON 51
ci_053                -2.410661e-03 3 1  ON 52
ci_054                -2.587543e-03 3 1  ON 53
ci_055                -1.604004e-03 3 1  ON 54
ci_056                -1.899576e-03 3 1  ON 55
ci_057                -1.536902e-03 3 1  ON 56
ci_058                -1.881894e-03 3 1  ON 57
ci_059                -1.296384e-03 3 1  ON 58
ci_060                -1.310154e-03 3 1  ON 59
ci_061                -1.345241e-03 3 1  ON 60
ci_062                -1.145867e-03 3 1  ON 61
ci_063                -1.017354e-03 3 1  ON 62
ci_064                -1.012614e-03 3 1  ON 63
ci_065                -1.610222e-03 3 1  ON 64
ci_066                -1.777439e-03 3 1  ON 65
ci_067                -1.490623e-03 3 1  ON 66
ci_068                -1.211259e-03 3 1  ON 67
ci_069                 6.524882e-04 3 1  ON 68
ci_070                 6.776968e-04 3 1  ON 69
ci_071                -1.659649e-03 3 1  ON 70
ci_072                -1.494899e-03 3 1  ON 71
ci_073                 7.545073e-04 3 1  ON 72
ci_074                 9.473496e-04 3 1  ON 73
ci_075                -7.921613e-04 3 1  ON 74
ci_076                -6.450158e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.612
    reference variance = 0.421448
====================================================
  Execution time = 4.9597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2665e+01
  VMC Evar = 5.0845e-01
  Total weights = 1.9550e+06
  Execution time = 7.2192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495500413412
                                         uncertainty =       0.002730547652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495500413412
                                         uncertainty =       0.002730547652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497727186
  error estimate for blocks of size 2^( 2) =       0.000516131256
  error estimate for blocks of size 2^( 3) =       0.000533064961
  error estimate for blocks of size 2^( 4) =       0.000546750913
  error estimate for blocks of size 2^( 5) =       0.000555024649
  error estimate for blocks of size 2^( 6) =       0.000560321783
  error estimate for blocks of size 2^( 7) =       0.000564983219

      target function =      -0.607246138060
              le_mean =     -22.665461845648
             les_mean =     514.232081700872
             stat err =       0.000556770141
             autocorr =       1.251322196688
   target nu stat err =       0.000556770141
   target dn stat err =       0.003533503728
      target stat err =       0.001090388171
              std dev =       0.703892536239
             le_variance =       0.495464702573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494837144577
                                         uncertainty =       0.002731641197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494837144577
                                         uncertainty =       0.002731641197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497394024
  error estimate for blocks of size 2^( 2) =       0.000515782742
  error estimate for blocks of size 2^( 3) =       0.000532695638
  error estimate for blocks of size 2^( 4) =       0.000546372153
  error estimate for blocks of size 2^( 5) =       0.000554635620
  error estimate for blocks of size 2^( 6) =       0.000559930583
  error estimate for blocks of size 2^( 7) =       0.000564587290

      target function =      -0.607402624302
              le_mean =     -22.665463698691
             les_mean =     514.231643344969
             stat err =       0.000556381412
             autocorr =       1.251250021310
   target nu stat err =       0.000556381412
   target dn stat err =       0.003565688155
      target stat err =       0.001100199336
              std dev =       0.703421374494
             le_variance =       0.494801630095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495159128251
                                         uncertainty =       0.002730779255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495159128251
                                         uncertainty =       0.002730779255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497555787
  error estimate for blocks of size 2^( 2) =       0.000515951144
  error estimate for blocks of size 2^( 3) =       0.000532874207
  error estimate for blocks of size 2^( 4) =       0.000546558449
  error estimate for blocks of size 2^( 5) =       0.000554824768
  error estimate for blocks of size 2^( 6) =       0.000560120787
  error estimate for blocks of size 2^( 7) =       0.000564776997

      target function =      -0.599620397461
              le_mean =     -22.665461212497
             les_mean =     514.257574561036
             stat err =       0.000556570250
             autocorr =       1.251285505442
   target nu stat err =       0.000556570250
   target dn stat err =       0.026434382690
      target stat err =       0.007704707322
              std dev =       0.703650141803
             le_variance =       0.495123522059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495456777978
                                         uncertainty =       0.002730583369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495456777978
                                         uncertainty =       0.002730583369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497705275
  error estimate for blocks of size 2^( 2) =       0.000516108379
  error estimate for blocks of size 2^( 3) =       0.000533040732
  error estimate for blocks of size 2^( 4) =       0.000546726128
  error estimate for blocks of size 2^( 5) =       0.000554999174
  error estimate for blocks of size 2^( 6) =       0.000560296168
  error estimate for blocks of size 2^( 7) =       0.000564957284

      target function =      -0.607340795003
              le_mean =     -22.665461760399
             les_mean =     514.231760947894
             stat err =       0.000556744688
             autocorr =       1.251317959741
   target nu stat err =       0.000556744688
   target dn stat err =       0.003522998499
      target stat err =       0.001087676212
              std dev =       0.703861549549
             le_variance =       0.495421080934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607246138060        initial
     1.5625e+00     1.5625e+01             5.2557e-04        -0.607402624302  <--
     6.2500e+00     6.2500e+01             1.3389e-04        -0.599620397461
     2.5000e+01     2.5000e+02             3.3633e-05        -0.607340795003

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.5884e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_001                -7.026231e-01 3 1  ON 0
ci_002                -7.011295e-01 3 1  ON 1
ci_003                -5.871036e-02 3 1  ON 2
ci_004                -5.890299e-02 3 1  ON 3
ci_005                 3.475725e-02 3 1  ON 4
ci_006                 3.505496e-02 3 1  ON 5
ci_007                 2.570926e-02 3 1  ON 6
ci_008                 2.615678e-02 3 1  ON 7
ci_009                -2.018307e-02 3 1  ON 8
ci_010                -2.020100e-02 3 1  ON 9
ci_011                -1.807632e-02 3 1  ON 10
ci_012                -1.772318e-02 3 1  ON 11
ci_013                 1.593509e-02 3 1  ON 12
ci_014                 1.570205e-02 3 1  ON 13
ci_015                 1.679123e-02 3 1  ON 14
ci_016                 1.661743e-02 3 1  ON 15
ci_017                 1.318013e-02 3 1  ON 16
ci_018                 1.309962e-02 3 1  ON 17
ci_019                 6.907073e-03 3 1  ON 18
ci_020                 7.677364e-03 3 1  ON 19
ci_021                -8.839065e-03 3 1  ON 20
ci_022                -9.126096e-03 3 1  ON 21
ci_023                 7.560408e-03 3 1  ON 22
ci_024                 7.409970e-03 3 1  ON 23
ci_025                 8.333215e-03 3 1  ON 24
ci_026                 8.630378e-03 3 1  ON 25
ci_027                 7.220203e-03 3 1  ON 26
ci_028                 7.347213e-03 3 1  ON 27
ci_029                -6.727526e-03 3 1  ON 28
ci_030                -6.800085e-03 3 1  ON 29
ci_031                -5.160572e-03 3 1  ON 30
ci_032                -5.473054e-03 3 1  ON 31
ci_033                 5.878939e-03 3 1  ON 32
ci_034                 5.748679e-03 3 1  ON 33
ci_035                 4.739598e-03 3 1  ON 34
ci_036                 4.814059e-03 3 1  ON 35
ci_037                 5.624430e-03 3 1  ON 36
ci_038                 5.573166e-03 3 1  ON 37
ci_039                 5.144054e-03 3 1  ON 38
ci_040                 5.020256e-03 3 1  ON 39
ci_041                 4.475917e-03 3 1  ON 40
ci_042                 4.514420e-03 3 1  ON 41
ci_043                 4.634247e-03 3 1  ON 42
ci_044                 4.577695e-03 3 1  ON 43
ci_045                 4.160967e-03 3 1  ON 44
ci_046                 4.202933e-03 3 1  ON 45
ci_047                -2.985445e-03 3 1  ON 46
ci_048                -3.117395e-03 3 1  ON 47
ci_049                 2.448884e-03 3 1  ON 48
ci_050                 2.566625e-03 3 1  ON 49
ci_051                -2.602222e-03 3 1  ON 50
ci_052                -2.522166e-03 3 1  ON 51
ci_053                -2.405882e-03 3 1  ON 52
ci_054                -2.569942e-03 3 1  ON 53
ci_055                -1.615054e-03 3 1  ON 54
ci_056                -1.899046e-03 3 1  ON 55
ci_057                -1.528063e-03 3 1  ON 56
ci_058                -1.875672e-03 3 1  ON 57
ci_059                -1.278588e-03 3 1  ON 58
ci_060                -1.293145e-03 3 1  ON 59
ci_061                -1.330052e-03 3 1  ON 60
ci_062                -1.128540e-03 3 1  ON 61
ci_063                -1.019927e-03 3 1  ON 62
ci_064                -9.767846e-04 3 1  ON 63
ci_065                -1.594534e-03 3 1  ON 64
ci_066                -1.795556e-03 3 1  ON 65
ci_067                -1.468632e-03 3 1  ON 66
ci_068                -1.204941e-03 3 1  ON 67
ci_069                 6.457872e-04 3 1  ON 68
ci_070                 6.702798e-04 3 1  ON 69
ci_071                -1.680560e-03 3 1  ON 70
ci_072                -1.499590e-03 3 1  ON 71
ci_073                 7.278622e-04 3 1  ON 72
ci_074                 9.256030e-04 3 1  ON 73
ci_075                -7.695454e-04 3 1  ON 74
ci_076                -6.422667e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4643e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7209
    reference variance = 0.407575
====================================================
  Execution time = 5.1157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0557e-01
  Total weights = 1.954786767e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492729659183
                                         uncertainty =       0.003356654273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492729659183
                                         uncertainty =       0.003356654273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496302105
  error estimate for blocks of size 2^( 2) =       0.000514745735
  error estimate for blocks of size 2^( 3) =       0.000531701564
  error estimate for blocks of size 2^( 4) =       0.000543370391
  error estimate for blocks of size 2^( 5) =       0.000550318328
  error estimate for blocks of size 2^( 6) =       0.000553187209
  error estimate for blocks of size 2^( 7) =       0.000554551537

      target function =      -0.608265278516
              le_mean =     -22.665540114058
             les_mean =     514.232281980211
             stat err =       0.000550356866
             autocorr =       1.229692555221
   target nu stat err =       0.000550356866
   target dn stat err =       0.004997141071
      target stat err =       0.001522081139
              std dev =       0.701877168060
             le_variance =       0.492631559044


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266554011406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608268763700       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608638473757       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608678228011       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608681923953       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608683017479       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608683261021       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608683331424       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608683372024       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608683375977       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.865687e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608268763700       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608367850482       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608378200215       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608379128740       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608379395793       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608379451282       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608379466492       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608379475779       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608379476613       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 5.011866e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608268763700       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608293989369       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608296603321       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608296835551       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608296901830       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608296915345       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608296918998       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608296921263       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608296921462       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.276734e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.474493 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0559e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_001                -7.026970e-01 3 1  ON 0
ci_002                -7.012135e-01 3 1  ON 1
ci_003                -5.855700e-02 3 1  ON 2
ci_004                -5.870551e-02 3 1  ON 3
ci_005                 3.430122e-02 3 1  ON 4
ci_006                 3.455377e-02 3 1  ON 5
ci_007                 2.545621e-02 3 1  ON 6
ci_008                 2.583092e-02 3 1  ON 7
ci_009                -1.997385e-02 3 1  ON 8
ci_010                -1.998638e-02 3 1  ON 9
ci_011                -1.780907e-02 3 1  ON 10
ci_012                -1.747363e-02 3 1  ON 11
ci_013                 1.574782e-02 3 1  ON 12
ci_014                 1.549741e-02 3 1  ON 13
ci_015                 1.666393e-02 3 1  ON 14
ci_016                 1.646018e-02 3 1  ON 15
ci_017                 1.307263e-02 3 1  ON 16
ci_018                 1.300253e-02 3 1  ON 17
ci_019                 6.760841e-03 3 1  ON 18
ci_020                 7.521859e-03 3 1  ON 19
ci_021                -8.819826e-03 3 1  ON 20
ci_022                -9.091707e-03 3 1  ON 21
ci_023                 7.520139e-03 3 1  ON 22
ci_024                 7.361634e-03 3 1  ON 23
ci_025                 8.347450e-03 3 1  ON 24
ci_026                 8.682029e-03 3 1  ON 25
ci_027                 7.168095e-03 3 1  ON 26
ci_028                 7.319118e-03 3 1  ON 27
ci_029                -6.678609e-03 3 1  ON 28
ci_030                -6.736139e-03 3 1  ON 29
ci_031                -5.009200e-03 3 1  ON 30
ci_032                -5.311804e-03 3 1  ON 31
ci_033                 5.797280e-03 3 1  ON 32
ci_034                 5.687222e-03 3 1  ON 33
ci_035                 4.664005e-03 3 1  ON 34
ci_036                 4.720966e-03 3 1  ON 35
ci_037                 5.585601e-03 3 1  ON 36
ci_038                 5.517634e-03 3 1  ON 37
ci_039                 5.111196e-03 3 1  ON 38
ci_040                 5.051784e-03 3 1  ON 39
ci_041                 4.433834e-03 3 1  ON 40
ci_042                 4.484065e-03 3 1  ON 41
ci_043                 4.571304e-03 3 1  ON 42
ci_044                 4.547599e-03 3 1  ON 43
ci_045                 4.158610e-03 3 1  ON 44
ci_046                 4.162163e-03 3 1  ON 45
ci_047                -2.915834e-03 3 1  ON 46
ci_048                -3.058096e-03 3 1  ON 47
ci_049                 2.389853e-03 3 1  ON 48
ci_050                 2.497935e-03 3 1  ON 49
ci_051                -2.567888e-03 3 1  ON 50
ci_052                -2.485475e-03 3 1  ON 51
ci_053                -2.350239e-03 3 1  ON 52
ci_054                -2.559414e-03 3 1  ON 53
ci_055                -1.579261e-03 3 1  ON 54
ci_056                -1.906240e-03 3 1  ON 55
ci_057                -1.555178e-03 3 1  ON 56
ci_058                -1.821262e-03 3 1  ON 57
ci_059                -1.239547e-03 3 1  ON 58
ci_060                -1.294592e-03 3 1  ON 59
ci_061                -1.292144e-03 3 1  ON 60
ci_062                -1.136409e-03 3 1  ON 61
ci_063                -9.767742e-04 3 1  ON 62
ci_064                -9.513966e-04 3 1  ON 63
ci_065                -1.567502e-03 3 1  ON 64
ci_066                -1.798855e-03 3 1  ON 65
ci_067                -1.458259e-03 3 1  ON 66
ci_068                -1.204104e-03 3 1  ON 67
ci_069                 6.479072e-04 3 1  ON 68
ci_070                 6.758256e-04 3 1  ON 69
ci_071                -1.702675e-03 3 1  ON 70
ci_072                -1.476216e-03 3 1  ON 71
ci_073                 7.356913e-04 3 1  ON 72
ci_074                 9.379743e-04 3 1  ON 73
ci_075                -7.576876e-04 3 1  ON 74
ci_076                -6.239507e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6057
    reference variance = 1.0001
====================================================
  Execution time = 4.9700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0730e-01
  Total weights = 1.9545e+06
  Execution time = 7.2316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494394976870
                                         uncertainty =       0.002093634037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494394976870
                                         uncertainty =       0.002093634037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497206090
  error estimate for blocks of size 2^( 2) =       0.000515872003
  error estimate for blocks of size 2^( 3) =       0.000532624611
  error estimate for blocks of size 2^( 4) =       0.000545121077
  error estimate for blocks of size 2^( 5) =       0.000553051874
  error estimate for blocks of size 2^( 6) =       0.000556753790
  error estimate for blocks of size 2^( 7) =       0.000559659278

      target function =      -0.607713306562
              le_mean =     -22.666450334358
             les_mean =     514.276143177484
             stat err =       0.000553646505
             autocorr =       1.239915950553
   target nu stat err =       0.000553646505
   target dn stat err =       0.003212226791
      target stat err =       0.000999649256
              std dev =       0.703155595367
             le_variance =       0.494427791296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492069401391
                                         uncertainty =       0.002063609042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492069401391
                                         uncertainty =       0.002063609042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496035945
  error estimate for blocks of size 2^( 2) =       0.000514657040
  error estimate for blocks of size 2^( 3) =       0.000531365253
  error estimate for blocks of size 2^( 4) =       0.000543816460
  error estimate for blocks of size 2^( 5) =       0.000551729901
  error estimate for blocks of size 2^( 6) =       0.000555388186
  error estimate for blocks of size 2^( 7) =       0.000558303330

      target function =      -0.606683420843
              le_mean =     -22.666460761579
             les_mean =     514.280065744351
             stat err =       0.000552309469
             autocorr =       1.239763028548
   target nu stat err =       0.000552309469
   target dn stat err =       0.004394175774
      target stat err =       0.001338987672
              std dev =       0.701500761051
             le_variance =       0.492103317755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493082952775
                                         uncertainty =       0.002077649721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493082952775
                                         uncertainty =       0.002077649721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496546277
  error estimate for blocks of size 2^( 2) =       0.000515187000
  error estimate for blocks of size 2^( 3) =       0.000531912833
  error estimate for blocks of size 2^( 4) =       0.000544382649
  error estimate for blocks of size 2^( 5) =       0.000552301753
  error estimate for blocks of size 2^( 6) =       0.000555978310
  error estimate for blocks of size 2^( 7) =       0.000558877863

      target function =      -0.607772492343
              le_mean =     -22.666447990182
             les_mean =     514.275836473713
             stat err =       0.000552885144
             autocorr =       1.239796429177
   target nu stat err =       0.000552885144
   target dn stat err =       0.003469942950
      target stat err =       0.001074192012
              std dev =       0.702222479211
             le_variance =       0.493116410309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494220276463
                                         uncertainty =       0.002091447717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494220276463
                                         uncertainty =       0.002091447717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497118286
  error estimate for blocks of size 2^( 2) =       0.000515780881
  error estimate for blocks of size 2^( 3) =       0.000532529983
  error estimate for blocks of size 2^( 4) =       0.000545022954
  error estimate for blocks of size 2^( 5) =       0.000552952358
  error estimate for blocks of size 2^( 6) =       0.000556651104
  error estimate for blocks of size 2^( 7) =       0.000559556272

      target function =      -0.607812258706
              le_mean =     -22.666448940321
             les_mean =     514.275748367400
             stat err =       0.000553545672
             autocorr =       1.239902235152
   target nu stat err =       0.000553545672
   target dn stat err =       0.003216323610
      target stat err =       0.001001128515
              std dev =       0.703031421639
             le_variance =       0.494253179812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607713306562        initial
     3.9062e-01     3.9062e+00             1.8657e-03        -0.606683420843
     1.5625e+00     1.5625e+01             5.0119e-04        -0.607772492343
     6.2500e+00     6.2500e+01             1.2767e-04        -0.607812258706  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.6198e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_001                -7.026419e-01 3 1  ON 0
ci_002                -7.011509e-01 3 1  ON 1
ci_003                -5.867171e-02 3 1  ON 2
ci_004                -5.885324e-02 3 1  ON 3
ci_005                 3.464107e-02 3 1  ON 4
ci_006                 3.492729e-02 3 1  ON 5
ci_007                 2.564496e-02 3 1  ON 6
ci_008                 2.607399e-02 3 1  ON 7
ci_009                -2.012988e-02 3 1  ON 8
ci_010                -2.014643e-02 3 1  ON 9
ci_011                -1.800843e-02 3 1  ON 10
ci_012                -1.765979e-02 3 1  ON 11
ci_013                 1.588752e-02 3 1  ON 12
ci_014                 1.565005e-02 3 1  ON 13
ci_015                 1.675894e-02 3 1  ON 14
ci_016                 1.657757e-02 3 1  ON 15
ci_017                 1.315281e-02 3 1  ON 16
ci_018                 1.307494e-02 3 1  ON 17
ci_019                 6.870044e-03 3 1  ON 18
ci_020                 7.637971e-03 3 1  ON 19
ci_021                -8.834175e-03 3 1  ON 20
ci_022                -9.117351e-03 3 1  ON 21
ci_023                 7.550159e-03 3 1  ON 22
ci_024                 7.397673e-03 3 1  ON 23
ci_025                 8.336785e-03 3 1  ON 24
ci_026                 8.643445e-03 3 1  ON 25
ci_027                 7.206911e-03 3 1  ON 26
ci_028                 7.340037e-03 3 1  ON 27
ci_029                -6.715109e-03 3 1  ON 28
ci_030                -6.783873e-03 3 1  ON 29
ci_031                -5.122112e-03 3 1  ON 30
ci_032                -5.432123e-03 3 1  ON 31
ci_033                 5.858210e-03 3 1  ON 32
ci_034                 5.733076e-03 3 1  ON 33
ci_035                 4.720349e-03 3 1  ON 34
ci_036                 4.790358e-03 3 1  ON 35
ci_037                 5.614591e-03 3 1  ON 36
ci_038                 5.559095e-03 3 1  ON 37
ci_039                 5.135672e-03 3 1  ON 38
ci_040                 5.028288e-03 3 1  ON 39
ci_041                 4.465209e-03 3 1  ON 40
ci_042                 4.506690e-03 3 1  ON 41
ci_043                 4.618318e-03 3 1  ON 42
ci_044                 4.570078e-03 3 1  ON 43
ci_045                 4.160362e-03 3 1  ON 44
ci_046                 4.192545e-03 3 1  ON 45
ci_047                -2.967729e-03 3 1  ON 46
ci_048                -3.102300e-03 3 1  ON 47
ci_049                 2.433881e-03 3 1  ON 48
ci_050                 2.549173e-03 3 1  ON 49
ci_051                -2.593561e-03 3 1  ON 50
ci_052                -2.512902e-03 3 1  ON 51
ci_053                -2.391729e-03 3 1  ON 52
ci_054                -2.567214e-03 3 1  ON 53
ci_055                -1.605988e-03 3 1  ON 54
ci_056                -1.900884e-03 3 1  ON 55
ci_057                -1.534965e-03 3 1  ON 56
ci_058                -1.861829e-03 3 1  ON 57
ci_059                -1.268634e-03 3 1  ON 58
ci_060                -1.293509e-03 3 1  ON 59
ci_061                -1.320422e-03 3 1  ON 60
ci_062                -1.130551e-03 3 1  ON 61
ci_063                -1.008939e-03 3 1  ON 62
ci_064                -9.703097e-04 3 1  ON 63
ci_065                -1.587718e-03 3 1  ON 64
ci_066                -1.796397e-03 3 1  ON 65
ci_067                -1.465974e-03 3 1  ON 66
ci_068                -1.204720e-03 3 1  ON 67
ci_069                 6.463292e-04 3 1  ON 68
ci_070                 6.717056e-04 3 1  ON 69
ci_071                -1.686198e-03 3 1  ON 70
ci_072                -1.493686e-03 3 1  ON 71
ci_073                 7.298514e-04 3 1  ON 72
ci_074                 9.287770e-04 3 1  ON 73
ci_075                -7.665351e-04 3 1  ON 74
ci_076                -6.376148e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4676e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6936
    reference variance = 0.489861
====================================================
  Execution time = 5.1077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0929e-01
  Total weights = 1.954696272e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496529545371
                                         uncertainty =       0.003513240008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496529545371
                                         uncertainty =       0.003513240008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498209482
  error estimate for blocks of size 2^( 2) =       0.000516365200
  error estimate for blocks of size 2^( 3) =       0.000532502758
  error estimate for blocks of size 2^( 4) =       0.000544944586
  error estimate for blocks of size 2^( 5) =       0.000552560161
  error estimate for blocks of size 2^( 6) =       0.000556981536
  error estimate for blocks of size 2^( 7) =       0.000558487598

      target function =      -0.607161906598
              le_mean =     -22.665571036526
             les_mean =     514.237398157871
             stat err =       0.000553243470
             autocorr =       1.233129297157
   target nu stat err =       0.000553243470
   target dn stat err =       0.004805859474
      target stat err =       0.001460781635
              std dev =       0.704574606174
             le_variance =       0.496425375665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266557103653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607165103176       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607270920548       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607280015553       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607280731972       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607280848736       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607280871447       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607280871969       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607280876024       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607280879364       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607280881740       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607280880423       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 5.231028e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607165103176       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607192042927       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607194340445       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607194519536       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607194548441       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607194553901       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607194553946       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607194554924       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607194555730       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607194556303       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607194555983       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.332611e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607165103176       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607171869143       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607172445020       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607172489789       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607172496997       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607172498348       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607172498354       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607172498596       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607172498796       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607172498938       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607172498858       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 3.347428e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.480584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0510e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_001                -7.026713e-01 3 1  ON 0
ci_002                -7.011602e-01 3 1  ON 1
ci_003                -5.863375e-02 3 1  ON 2
ci_004                -5.881691e-02 3 1  ON 3
ci_005                 3.451588e-02 3 1  ON 4
ci_006                 3.479403e-02 3 1  ON 5
ci_007                 2.557019e-02 3 1  ON 6
ci_008                 2.599852e-02 3 1  ON 7
ci_009                -2.007880e-02 3 1  ON 8
ci_010                -2.009181e-02 3 1  ON 9
ci_011                -1.795672e-02 3 1  ON 10
ci_012                -1.760789e-02 3 1  ON 11
ci_013                 1.583600e-02 3 1  ON 12
ci_014                 1.560475e-02 3 1  ON 13
ci_015                 1.672248e-02 3 1  ON 14
ci_016                 1.654068e-02 3 1  ON 15
ci_017                 1.312342e-02 3 1  ON 16
ci_018                 1.303957e-02 3 1  ON 17
ci_019                 6.835752e-03 3 1  ON 18
ci_020                 7.597292e-03 3 1  ON 19
ci_021                -8.831879e-03 3 1  ON 20
ci_022                -9.101064e-03 3 1  ON 21
ci_023                 7.544060e-03 3 1  ON 22
ci_024                 7.378281e-03 3 1  ON 23
ci_025                 8.347914e-03 3 1  ON 24
ci_026                 8.644528e-03 3 1  ON 25
ci_027                 7.200121e-03 3 1  ON 26
ci_028                 7.331481e-03 3 1  ON 27
ci_029                -6.700318e-03 3 1  ON 28
ci_030                -6.773328e-03 3 1  ON 29
ci_031                -5.087662e-03 3 1  ON 30
ci_032                -5.402749e-03 3 1  ON 31
ci_033                 5.840391e-03 3 1  ON 32
ci_034                 5.717544e-03 3 1  ON 33
ci_035                 4.704213e-03 3 1  ON 34
ci_036                 4.769435e-03 3 1  ON 35
ci_037                 5.607245e-03 3 1  ON 36
ci_038                 5.558055e-03 3 1  ON 37
ci_039                 5.131757e-03 3 1  ON 38
ci_040                 5.029617e-03 3 1  ON 39
ci_041                 4.444058e-03 3 1  ON 40
ci_042                 4.497404e-03 3 1  ON 41
ci_043                 4.612483e-03 3 1  ON 42
ci_044                 4.561403e-03 3 1  ON 43
ci_045                 4.145333e-03 3 1  ON 44
ci_046                 4.184643e-03 3 1  ON 45
ci_047                -2.953785e-03 3 1  ON 46
ci_048                -3.084267e-03 3 1  ON 47
ci_049                 2.423330e-03 3 1  ON 48
ci_050                 2.536346e-03 3 1  ON 49
ci_051                -2.596704e-03 3 1  ON 50
ci_052                -2.513945e-03 3 1  ON 51
ci_053                -2.391639e-03 3 1  ON 52
ci_054                -2.555496e-03 3 1  ON 53
ci_055                -1.598244e-03 3 1  ON 54
ci_056                -1.897877e-03 3 1  ON 55
ci_057                -1.523679e-03 3 1  ON 56
ci_058                -1.858541e-03 3 1  ON 57
ci_059                -1.261176e-03 3 1  ON 58
ci_060                -1.284093e-03 3 1  ON 59
ci_061                -1.312663e-03 3 1  ON 60
ci_062                -1.128668e-03 3 1  ON 61
ci_063                -1.010180e-03 3 1  ON 62
ci_064                -9.701041e-04 3 1  ON 63
ci_065                -1.581602e-03 3 1  ON 64
ci_066                -1.801191e-03 3 1  ON 65
ci_067                -1.470807e-03 3 1  ON 66
ci_068                -1.203528e-03 3 1  ON 67
ci_069                 6.388347e-04 3 1  ON 68
ci_070                 6.702494e-04 3 1  ON 69
ci_071                -1.680116e-03 3 1  ON 70
ci_072                -1.504639e-03 3 1  ON 71
ci_073                 7.200372e-04 3 1  ON 72
ci_074                 9.318622e-04 3 1  ON 73
ci_075                -7.626626e-04 3 1  ON 74
ci_076                -6.364631e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6189
    reference variance = 0.389592
====================================================
  Execution time = 4.9634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.1208e-01
  Total weights = 1.9549e+06
  Execution time = 7.2084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497627496061
                                         uncertainty =       0.005108418631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497627496061
                                         uncertainty =       0.005108418631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498820361
  error estimate for blocks of size 2^( 2) =       0.000516859216
  error estimate for blocks of size 2^( 3) =       0.000533766465
  error estimate for blocks of size 2^( 4) =       0.000545793761
  error estimate for blocks of size 2^( 5) =       0.000552384384
  error estimate for blocks of size 2^( 6) =       0.000554478537
  error estimate for blocks of size 2^( 7) =       0.000554871040

      target function =      -0.606139778312
              le_mean =     -22.665925322833
             les_mean =     514.257168963861
             stat err =       0.000551881931
             autocorr =       1.224063661577
   target nu stat err =       0.000551881931
   target dn stat err =       0.006270113145
      target stat err =       0.001886316653
              std dev =       0.705438519442
             le_variance =       0.497643504713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497023403933
                                         uncertainty =       0.005114435042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497023403933
                                         uncertainty =       0.005114435042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498517887
  error estimate for blocks of size 2^( 2) =       0.000516538392
  error estimate for blocks of size 2^( 3) =       0.000533435649
  error estimate for blocks of size 2^( 4) =       0.000545458057
  error estimate for blocks of size 2^( 5) =       0.000552037730
  error estimate for blocks of size 2^( 6) =       0.000554136008
  error estimate for blocks of size 2^( 7) =       0.000554520382

      target function =      -0.606530895920
              le_mean =     -22.665928630572
             les_mean =     514.256008741928
             stat err =       0.000551538044
             autocorr =       1.224022661000
   target nu stat err =       0.000551538044
   target dn stat err =       0.006269827329
      target stat err =       0.001888623115
              std dev =       0.705010757291
             le_variance =       0.497040167896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497315716189
                                         uncertainty =       0.005111353407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497315716189
                                         uncertainty =       0.005111353407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498664271
  error estimate for blocks of size 2^( 2) =       0.000516693699
  error estimate for blocks of size 2^( 3) =       0.000533595903
  error estimate for blocks of size 2^( 4) =       0.000545620645
  error estimate for blocks of size 2^( 5) =       0.000552205642
  error estimate for blocks of size 2^( 6) =       0.000554301701
  error estimate for blocks of size 2^( 7) =       0.000554690430

      target function =      -0.606479655248
              le_mean =     -22.665926406985
             les_mean =     514.256078104457
             stat err =       0.000551704604
             autocorr =       1.224043107467
   target nu stat err =       0.000551704604
   target dn stat err =       0.006256758730
      target stat err =       0.001884460875
              std dev =       0.705217774636
             le_variance =       0.497332109662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497587853024
                                         uncertainty =       0.005108776459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497587853024
                                         uncertainty =       0.005108776459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498800516
  error estimate for blocks of size 2^( 2) =       0.000516838181
  error estimate for blocks of size 2^( 3) =       0.000533744788
  error estimate for blocks of size 2^( 4) =       0.000545771804
  error estimate for blocks of size 2^( 5) =       0.000552361724
  error estimate for blocks of size 2^( 6) =       0.000554456086
  error estimate for blocks of size 2^( 7) =       0.000554848140

      target function =      -0.606309052769
              le_mean =     -22.665925407227
             les_mean =     514.256604544439
             stat err =       0.000551859439
             autocorr =       1.224061282029
   target nu stat err =       0.000551859439
   target dn stat err =       0.006253031874
      target stat err =       0.001882322586
              std dev =       0.705410455027
             le_variance =       0.497603910061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.606139778312        initial
     1.5625e+00     1.5625e+01             5.2310e-04        -0.606530895920  <--
     6.2500e+00     6.2500e+01             1.3326e-04        -0.606479655248
     2.5000e+01     2.5000e+02             3.3474e-05        -0.606309052769

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.5805e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_001                -7.027587e-01 3 1  ON 0
ci_002                -7.011867e-01 3 1  ON 1
ci_003                -5.852111e-02 3 1  ON 2
ci_004                -5.870916e-02 3 1  ON 3
ci_005                 3.414967e-02 3 1  ON 4
ci_006                 3.440418e-02 3 1  ON 5
ci_007                 2.535070e-02 3 1  ON 6
ci_008                 2.577697e-02 3 1  ON 7
ci_009                -1.992894e-02 3 1  ON 8
ci_010                -1.993160e-02 3 1  ON 9
ci_011                -1.780493e-02 3 1  ON 10
ci_012                -1.745552e-02 3 1  ON 11
ci_013                 1.568485e-02 3 1  ON 12
ci_014                 1.547177e-02 3 1  ON 13
ci_015                 1.661508e-02 3 1  ON 14
ci_016                 1.643206e-02 3 1  ON 15
ci_017                 1.303709e-02 3 1  ON 16
ci_018                 1.293574e-02 3 1  ON 17
ci_019                 6.734599e-03 3 1  ON 18
ci_020                 7.477414e-03 3 1  ON 19
ci_021                -8.825129e-03 3 1  ON 20
ci_022                -9.053218e-03 3 1  ON 21
ci_023                 7.526226e-03 3 1  ON 22
ci_024                 7.321454e-03 3 1  ON 23
ci_025                 8.380843e-03 3 1  ON 24
ci_026                 8.647831e-03 3 1  ON 25
ci_027                 7.180328e-03 3 1  ON 26
ci_028                 7.306531e-03 3 1  ON 27
ci_029                -6.656775e-03 3 1  ON 28
ci_030                -6.742207e-03 3 1  ON 29
ci_031                -4.986296e-03 3 1  ON 30
ci_032                -5.316468e-03 3 1  ON 31
ci_033                 5.788073e-03 3 1  ON 32
ci_034                 5.671910e-03 3 1  ON 33
ci_035                 4.656940e-03 3 1  ON 34
ci_036                 4.708203e-03 3 1  ON 35
ci_037                 5.585610e-03 3 1  ON 36
ci_038                 5.554881e-03 3 1  ON 37
ci_039                 5.120394e-03 3 1  ON 38
ci_040                 5.033581e-03 3 1  ON 39
ci_041                 4.382114e-03 3 1  ON 40
ci_042                 4.470217e-03 3 1  ON 41
ci_043                 4.595206e-03 3 1  ON 42
ci_044                 4.535789e-03 3 1  ON 43
ci_045                 4.101259e-03 3 1  ON 44
ci_046                 4.161485e-03 3 1  ON 45
ci_047                -2.912894e-03 3 1  ON 46
ci_048                -3.031424e-03 3 1  ON 47
ci_049                 2.392383e-03 3 1  ON 48
ci_050                 2.498686e-03 3 1  ON 49
ci_051                -2.605714e-03 3 1  ON 50
ci_052                -2.516730e-03 3 1  ON 51
ci_053                -2.391526e-03 3 1  ON 52
ci_054                -2.521208e-03 3 1  ON 53
ci_055                -1.575492e-03 3 1  ON 54
ci_056                -1.889073e-03 3 1  ON 55
ci_057                -1.490584e-03 3 1  ON 56
ci_058                -1.848858e-03 3 1  ON 57
ci_059                -1.239305e-03 3 1  ON 58
ci_060                -1.256532e-03 3 1  ON 59
ci_061                -1.289862e-03 3 1  ON 60
ci_062                -1.123118e-03 3 1  ON 61
ci_063                -1.013874e-03 3 1  ON 62
ci_064                -9.696358e-04 3 1  ON 63
ci_065                -1.563591e-03 3 1  ON 64
ci_066                -1.815222e-03 3 1  ON 65
ci_067                -1.485110e-03 3 1  ON 66
ci_068                -1.200065e-03 3 1  ON 67
ci_069                 6.168217e-04 3 1  ON 68
ci_070                 6.659413e-04 3 1  ON 69
ci_071                -1.662099e-03 3 1  ON 70
ci_072                -1.536705e-03 3 1  ON 71
ci_073                 6.913225e-04 3 1  ON 72
ci_074                 9.408120e-04 3 1  ON 73
ci_075                -7.512766e-04 3 1  ON 74
ci_076                -6.330891e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4632e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2684e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6745
    reference variance = 0.29102
====================================================
  Execution time = 5.1173e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.1019e-01
  Total weights = 1.954812932e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495262020209
                                         uncertainty =       0.002435738189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495262020209
                                         uncertainty =       0.002435738189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497568159
  error estimate for blocks of size 2^( 2) =       0.000516335582
  error estimate for blocks of size 2^( 3) =       0.000533749539
  error estimate for blocks of size 2^( 4) =       0.000545619430
  error estimate for blocks of size 2^( 5) =       0.000553135361
  error estimate for blocks of size 2^( 6) =       0.000556592398
  error estimate for blocks of size 2^( 7) =       0.000560751224

      target function =      -0.607231935855
              le_mean =     -22.666950129380
             les_mean =     514.300817372071
             stat err =       0.000554024603
             autocorr =       1.239803738735
   target nu stat err =       0.000554024603
   target dn stat err =       0.003806436495
      target stat err =       0.001170520409
              std dev =       0.703667638608
             le_variance =       0.495148145624


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266695012938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607233892657       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607592034310       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607625082796       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607628407785       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607629328553       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607629641172       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607629685510       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607629707043       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607629705543       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607629705539       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607629704081       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.829210e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607233892657       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607329846948       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607338441501       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607339280565       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607339508162       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607339580443       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607339589089       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607339593941       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607339593392       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607339593354       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607339593120       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 4.912345e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607233892657       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607258318640       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607260488668       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607260698790       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607260755465       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607260773135       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607260775146       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607260776326       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607260776179       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607260776168       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607260776117       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.251277e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.486660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0587e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_001                -7.027900e-01 3 1  ON 0
ci_002                -7.013034e-01 3 1  ON 1
ci_003                -5.840545e-02 3 1  ON 2
ci_004                -5.854276e-02 3 1  ON 3
ci_005                 3.365844e-02 3 1  ON 4
ci_006                 3.393406e-02 3 1  ON 5
ci_007                 2.503134e-02 3 1  ON 6
ci_008                 2.549333e-02 3 1  ON 7
ci_009                -1.972269e-02 3 1  ON 8
ci_010                -1.972499e-02 3 1  ON 9
ci_011                -1.760310e-02 3 1  ON 10
ci_012                -1.726357e-02 3 1  ON 11
ci_013                 1.549264e-02 3 1  ON 12
ci_014                 1.528012e-02 3 1  ON 13
ci_015                 1.643167e-02 3 1  ON 14
ci_016                 1.627538e-02 3 1  ON 15
ci_017                 1.293071e-02 3 1  ON 16
ci_018                 1.283692e-02 3 1  ON 17
ci_019                 6.612917e-03 3 1  ON 18
ci_020                 7.306955e-03 3 1  ON 19
ci_021                -8.779912e-03 3 1  ON 20
ci_022                -9.037374e-03 3 1  ON 21
ci_023                 7.470802e-03 3 1  ON 22
ci_024                 7.288738e-03 3 1  ON 23
ci_025                 8.394910e-03 3 1  ON 24
ci_026                 8.646187e-03 3 1  ON 25
ci_027                 7.155166e-03 3 1  ON 26
ci_028                 7.263875e-03 3 1  ON 27
ci_029                -6.570550e-03 3 1  ON 28
ci_030                -6.681568e-03 3 1  ON 29
ci_031                -4.902406e-03 3 1  ON 30
ci_032                -5.201680e-03 3 1  ON 31
ci_033                 5.759254e-03 3 1  ON 32
ci_034                 5.637613e-03 3 1  ON 33
ci_035                 4.584662e-03 3 1  ON 34
ci_036                 4.623375e-03 3 1  ON 35
ci_037                 5.542815e-03 3 1  ON 36
ci_038                 5.501675e-03 3 1  ON 37
ci_039                 5.067700e-03 3 1  ON 38
ci_040                 5.012046e-03 3 1  ON 39
ci_041                 4.341175e-03 3 1  ON 40
ci_042                 4.434196e-03 3 1  ON 41
ci_043                 4.576300e-03 3 1  ON 42
ci_044                 4.552906e-03 3 1  ON 43
ci_045                 4.022391e-03 3 1  ON 44
ci_046                 4.108215e-03 3 1  ON 45
ci_047                -2.850038e-03 3 1  ON 46
ci_048                -2.978927e-03 3 1  ON 47
ci_049                 2.361732e-03 3 1  ON 48
ci_050                 2.445096e-03 3 1  ON 49
ci_051                -2.560296e-03 3 1  ON 50
ci_052                -2.507981e-03 3 1  ON 51
ci_053                -2.394025e-03 3 1  ON 52
ci_054                -2.544540e-03 3 1  ON 53
ci_055                -1.595182e-03 3 1  ON 54
ci_056                -1.874716e-03 3 1  ON 55
ci_057                -1.467281e-03 3 1  ON 56
ci_058                -1.815243e-03 3 1  ON 57
ci_059                -1.221752e-03 3 1  ON 58
ci_060                -1.235535e-03 3 1  ON 59
ci_061                -1.282949e-03 3 1  ON 60
ci_062                -1.088751e-03 3 1  ON 61
ci_063                -9.902161e-04 3 1  ON 62
ci_064                -9.443389e-04 3 1  ON 63
ci_065                -1.566873e-03 3 1  ON 64
ci_066                -1.823132e-03 3 1  ON 65
ci_067                -1.482765e-03 3 1  ON 66
ci_068                -1.179859e-03 3 1  ON 67
ci_069                 6.028946e-04 3 1  ON 68
ci_070                 6.478097e-04 3 1  ON 69
ci_071                -1.656914e-03 3 1  ON 70
ci_072                -1.553419e-03 3 1  ON 71
ci_073                 6.900766e-04 3 1  ON 72
ci_074                 9.294333e-04 3 1  ON 73
ci_075                -7.391169e-04 3 1  ON 74
ci_076                -5.994017e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6742
    reference variance = 0.370136
====================================================
  Execution time = 4.9710e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0883e-01
  Total weights = 1.9540e+06
  Execution time = 7.2341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495921144074
                                         uncertainty =       0.002967009383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495921144074
                                         uncertainty =       0.002967009383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498002533
  error estimate for blocks of size 2^( 2) =       0.000516628681
  error estimate for blocks of size 2^( 3) =       0.000534336405
  error estimate for blocks of size 2^( 4) =       0.000547091803
  error estimate for blocks of size 2^( 5) =       0.000554659601
  error estimate for blocks of size 2^( 6) =       0.000557467897
  error estimate for blocks of size 2^( 7) =       0.000558805750

      target function =      -0.606517573019
              le_mean =     -22.665915402992
             les_mean =     514.255455426347
             stat err =       0.000554506263
             autocorr =       1.239794790936
   target nu stat err =       0.000554506263
   target dn stat err =       0.003733397389
      target stat err =       0.001145759983
              std dev =       0.704281936699
             le_variance =       0.496013046360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493621913023
                                         uncertainty =       0.002931270139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493621913023
                                         uncertainty =       0.002931270139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496846572
  error estimate for blocks of size 2^( 2) =       0.000515419265
  error estimate for blocks of size 2^( 3) =       0.000533081811
  error estimate for blocks of size 2^( 4) =       0.000545800692
  error estimate for blocks of size 2^( 5) =       0.000553343537
  error estimate for blocks of size 2^( 6) =       0.000556147144
  error estimate for blocks of size 2^( 7) =       0.000557400220

      target function =      -0.607107989005
              le_mean =     -22.665927913661
             les_mean =     514.254053826283
             stat err =       0.000553172898
             autocorr =       1.239587514224
   target nu stat err =       0.000553172898
   target dn stat err =       0.003798998349
      target stat err =       0.001166828350
              std dev =       0.702647160662
             le_variance =       0.493713032387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494629660326
                                         uncertainty =       0.002946133784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494629660326
                                         uncertainty =       0.002946133784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497353585
  error estimate for blocks of size 2^( 2) =       0.000515950156
  error estimate for blocks of size 2^( 3) =       0.000533634240
  error estimate for blocks of size 2^( 4) =       0.000546369505
  error estimate for blocks of size 2^( 5) =       0.000553926203
  error estimate for blocks of size 2^( 6) =       0.000556731533
  error estimate for blocks of size 2^( 7) =       0.000558021296

      target function =      -0.607365552141
              le_mean =     -22.665914869694
             les_mean =     514.252590721158
             stat err =       0.000553762134
             autocorr =       1.239698303064
   target nu stat err =       0.000553762134
   target dn stat err =       0.003543549633
      target stat err =       0.001093741065
              std dev =       0.703364184598
             le_variance =       0.494721176175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495748559575
                                         uncertainty =       0.002964044580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495748559575
                                         uncertainty =       0.002964044580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497915863
  error estimate for blocks of size 2^( 2) =       0.000516538270
  error estimate for blocks of size 2^( 3) =       0.000534243071
  error estimate for blocks of size 2^( 4) =       0.000546995888
  error estimate for blocks of size 2^( 5) =       0.000554562531
  error estimate for blocks of size 2^( 6) =       0.000557370627
  error estimate for blocks of size 2^( 7) =       0.000558700177

      target function =      -0.607035561320
              le_mean =     -22.665913899420
             les_mean =     514.253650509857
             stat err =       0.000554407306
             autocorr =       1.239783821502
   target nu stat err =       0.000554407306
   target dn stat err =       0.003532768972
      target stat err =       0.001089551175
              std dev =       0.704159365884
             le_variance =       0.495840412562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.606517573019        initial
     3.9062e-01     3.9062e+00             1.8292e-03        -0.607107989005
     1.5625e+00     1.5625e+01             4.9123e-04        -0.607365552141  <--
     6.2500e+00     6.2500e+01             1.2513e-04        -0.607035561320

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.7450e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_001                -7.027900e-01 3 1  ON 0
ci_002                -7.013034e-01 3 1  ON 1
ci_003                -5.840545e-02 3 1  ON 2
ci_004                -5.854276e-02 3 1  ON 3
ci_005                 3.365844e-02 3 1  ON 4
ci_006                 3.393406e-02 3 1  ON 5
ci_007                 2.503134e-02 3 1  ON 6
ci_008                 2.549333e-02 3 1  ON 7
ci_009                -1.972269e-02 3 1  ON 8
ci_010                -1.972499e-02 3 1  ON 9
ci_011                -1.760310e-02 3 1  ON 10
ci_012                -1.726357e-02 3 1  ON 11
ci_013                 1.549264e-02 3 1  ON 12
ci_014                 1.528012e-02 3 1  ON 13
ci_015                 1.643167e-02 3 1  ON 14
ci_016                 1.627538e-02 3 1  ON 15
ci_017                 1.293071e-02 3 1  ON 16
ci_018                 1.283692e-02 3 1  ON 17
ci_019                 6.612917e-03 3 1  ON 18
ci_020                 7.306955e-03 3 1  ON 19
ci_021                -8.779912e-03 3 1  ON 20
ci_022                -9.037374e-03 3 1  ON 21
ci_023                 7.470802e-03 3 1  ON 22
ci_024                 7.288738e-03 3 1  ON 23
ci_025                 8.394910e-03 3 1  ON 24
ci_026                 8.646187e-03 3 1  ON 25
ci_027                 7.155166e-03 3 1  ON 26
ci_028                 7.263875e-03 3 1  ON 27
ci_029                -6.570550e-03 3 1  ON 28
ci_030                -6.681568e-03 3 1  ON 29
ci_031                -4.902406e-03 3 1  ON 30
ci_032                -5.201680e-03 3 1  ON 31
ci_033                 5.759254e-03 3 1  ON 32
ci_034                 5.637613e-03 3 1  ON 33
ci_035                 4.584662e-03 3 1  ON 34
ci_036                 4.623375e-03 3 1  ON 35
ci_037                 5.542815e-03 3 1  ON 36
ci_038                 5.501675e-03 3 1  ON 37
ci_039                 5.067700e-03 3 1  ON 38
ci_040                 5.012046e-03 3 1  ON 39
ci_041                 4.341175e-03 3 1  ON 40
ci_042                 4.434196e-03 3 1  ON 41
ci_043                 4.576300e-03 3 1  ON 42
ci_044                 4.552906e-03 3 1  ON 43
ci_045                 4.022391e-03 3 1  ON 44
ci_046                 4.108215e-03 3 1  ON 45
ci_047                -2.850038e-03 3 1  ON 46
ci_048                -2.978927e-03 3 1  ON 47
ci_049                 2.361732e-03 3 1  ON 48
ci_050                 2.445096e-03 3 1  ON 49
ci_051                -2.560296e-03 3 1  ON 50
ci_052                -2.507981e-03 3 1  ON 51
ci_053                -2.394025e-03 3 1  ON 52
ci_054                -2.544540e-03 3 1  ON 53
ci_055                -1.595182e-03 3 1  ON 54
ci_056                -1.874716e-03 3 1  ON 55
ci_057                -1.467281e-03 3 1  ON 56
ci_058                -1.815243e-03 3 1  ON 57
ci_059                -1.221752e-03 3 1  ON 58
ci_060                -1.235535e-03 3 1  ON 59
ci_061                -1.282949e-03 3 1  ON 60
ci_062                -1.088751e-03 3 1  ON 61
ci_063                -9.902161e-04 3 1  ON 62
ci_064                -9.443389e-04 3 1  ON 63
ci_065                -1.566873e-03 3 1  ON 64
ci_066                -1.823132e-03 3 1  ON 65
ci_067                -1.482765e-03 3 1  ON 66
ci_068                -1.179859e-03 3 1  ON 67
ci_069                 6.028946e-04 3 1  ON 68
ci_070                 6.478097e-04 3 1  ON 69
ci_071                -1.656914e-03 3 1  ON 70
ci_072                -1.553419e-03 3 1  ON 71
ci_073                 6.900766e-04 3 1  ON 72
ci_074                 9.294333e-04 3 1  ON 73
ci_075                -7.391169e-04 3 1  ON 74
ci_076                -5.994017e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4804e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2684e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6727
    reference variance = 0.412482
====================================================
  Execution time = 5.1156e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0631e-01
  Total weights = 1.954625936e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495899028808
                                         uncertainty =       0.003032301429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495899028808
                                         uncertainty =       0.003032301429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497921293
  error estimate for blocks of size 2^( 2) =       0.000516724107
  error estimate for blocks of size 2^( 3) =       0.000533866070
  error estimate for blocks of size 2^( 4) =       0.000546162645
  error estimate for blocks of size 2^( 5) =       0.000555189369
  error estimate for blocks of size 2^( 6) =       0.000557911281
  error estimate for blocks of size 2^( 7) =       0.000561578756

      target function =      -0.608299353215
              le_mean =     -22.666563565477
             les_mean =     514.279413075473
             stat err =       0.000555210513
             autocorr =       1.243351619855
   target nu stat err =       0.000555210513
   target dn stat err =       0.003463193164
      target stat err =       0.001074429075
              std dev =       0.704167045138
             le_variance =       0.495851227459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266656356548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608300957722       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608649201350       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608682183264       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608685701317       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608686763686       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608686956582       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608687129791       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608687170578       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608687181852       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608687180033       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.770748e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608300957722       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608394301603       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608402889842       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608403774896       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608404037006       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608404081191       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608404120671       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608404129884       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608404132349       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 4.758066e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608300957722       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608324722097       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608326891274       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608327112717       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608327177952       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608327188729       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608327198350       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608327200589       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608327201183       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.212119e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.491396 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0598e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_001                -7.028755e-01 3 1  ON 0
ci_002                -7.013641e-01 3 1  ON 1
ci_003                -5.825419e-02 3 1  ON 2
ci_004                -5.836985e-02 3 1  ON 3
ci_005                 3.318263e-02 3 1  ON 4
ci_006                 3.347317e-02 3 1  ON 5
ci_007                 2.473509e-02 3 1  ON 6
ci_008                 2.520880e-02 3 1  ON 7
ci_009                -1.956219e-02 3 1  ON 8
ci_010                -1.949518e-02 3 1  ON 9
ci_011                -1.737370e-02 3 1  ON 10
ci_012                -1.706371e-02 3 1  ON 11
ci_013                 1.533531e-02 3 1  ON 12
ci_014                 1.509099e-02 3 1  ON 13
ci_015                 1.627965e-02 3 1  ON 14
ci_016                 1.614099e-02 3 1  ON 15
ci_017                 1.278478e-02 3 1  ON 16
ci_018                 1.272005e-02 3 1  ON 17
ci_019                 6.470517e-03 3 1  ON 18
ci_020                 7.195790e-03 3 1  ON 19
ci_021                -8.701340e-03 3 1  ON 20
ci_022                -9.065025e-03 3 1  ON 21
ci_023                 7.426303e-03 3 1  ON 22
ci_024                 7.236658e-03 3 1  ON 23
ci_025                 8.410770e-03 3 1  ON 24
ci_026                 8.671224e-03 3 1  ON 25
ci_027                 7.138466e-03 3 1  ON 26
ci_028                 7.252270e-03 3 1  ON 27
ci_029                -6.497746e-03 3 1  ON 28
ci_030                -6.634253e-03 3 1  ON 29
ci_031                -4.791839e-03 3 1  ON 30
ci_032                -5.081926e-03 3 1  ON 31
ci_033                 5.703470e-03 3 1  ON 32
ci_034                 5.608282e-03 3 1  ON 33
ci_035                 4.518906e-03 3 1  ON 34
ci_036                 4.524232e-03 3 1  ON 35
ci_037                 5.512449e-03 3 1  ON 36
ci_038                 5.437680e-03 3 1  ON 37
ci_039                 5.047827e-03 3 1  ON 38
ci_040                 4.987813e-03 3 1  ON 39
ci_041                 4.307798e-03 3 1  ON 40
ci_042                 4.353605e-03 3 1  ON 41
ci_043                 4.571033e-03 3 1  ON 42
ci_044                 4.539854e-03 3 1  ON 43
ci_045                 3.970646e-03 3 1  ON 44
ci_046                 4.053613e-03 3 1  ON 45
ci_047                -2.766945e-03 3 1  ON 46
ci_048                -2.923854e-03 3 1  ON 47
ci_049                 2.299918e-03 3 1  ON 48
ci_050                 2.388785e-03 3 1  ON 49
ci_051                -2.559450e-03 3 1  ON 50
ci_052                -2.454181e-03 3 1  ON 51
ci_053                -2.365118e-03 3 1  ON 52
ci_054                -2.518875e-03 3 1  ON 53
ci_055                -1.548818e-03 3 1  ON 54
ci_056                -1.883554e-03 3 1  ON 55
ci_057                -1.482119e-03 3 1  ON 56
ci_058                -1.798572e-03 3 1  ON 57
ci_059                -1.165170e-03 3 1  ON 58
ci_060                -1.227845e-03 3 1  ON 59
ci_061                -1.256970e-03 3 1  ON 60
ci_062                -1.087509e-03 3 1  ON 61
ci_063                -9.815674e-04 3 1  ON 62
ci_064                -9.093635e-04 3 1  ON 63
ci_065                -1.596318e-03 3 1  ON 64
ci_066                -1.841057e-03 3 1  ON 65
ci_067                -1.472371e-03 3 1  ON 66
ci_068                -1.180783e-03 3 1  ON 67
ci_069                 5.762292e-04 3 1  ON 68
ci_070                 6.443241e-04 3 1  ON 69
ci_071                -1.665990e-03 3 1  ON 70
ci_072                -1.577852e-03 3 1  ON 71
ci_073                 6.732417e-04 3 1  ON 72
ci_074                 9.195822e-04 3 1  ON 73
ci_075                -7.043481e-04 3 1  ON 74
ci_076                -5.999011e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5812
    reference variance = 0.560472
====================================================
  Execution time = 4.9655e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0810e-01
  Total weights = 1.9548e+06
  Execution time = 7.2296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492897091810
                                         uncertainty =       0.002437553355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492897091810
                                         uncertainty =       0.002437553355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496440691
  error estimate for blocks of size 2^( 2) =       0.000514929775
  error estimate for blocks of size 2^( 3) =       0.000531530480
  error estimate for blocks of size 2^( 4) =       0.000544039673
  error estimate for blocks of size 2^( 5) =       0.000550603169
  error estimate for blocks of size 2^( 6) =       0.000553980586
  error estimate for blocks of size 2^( 7) =       0.000556124549

      target function =      -0.607243544143
              le_mean =     -22.665621736100
             les_mean =     514.239466129757
             stat err =       0.000551186994
             autocorr =       1.232716416940
   target nu stat err =       0.000551186994
   target dn stat err =       0.004508816430
      target stat err =       0.001373943106
              std dev =       0.702073158075
             le_variance =       0.492906719290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490785174780
                                         uncertainty =       0.002420126488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490785174780
                                         uncertainty =       0.002420126488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495374947
  error estimate for blocks of size 2^( 2) =       0.000513820746
  error estimate for blocks of size 2^( 3) =       0.000530377917
  error estimate for blocks of size 2^( 4) =       0.000542849120
  error estimate for blocks of size 2^( 5) =       0.000549379856
  error estimate for blocks of size 2^( 6) =       0.000552724163
  error estimate for blocks of size 2^( 7) =       0.000554814179

      target function =      -0.607096719207
              le_mean =     -22.665641420496
             les_mean =     514.240864791292
             stat err =       0.000549941829
             autocorr =       1.232438990507
   target nu stat err =       0.000549941829
   target dn stat err =       0.004823848805
      target stat err =       0.001465533952
              std dev =       0.700565969206
             le_variance =       0.490792677210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491717313151
                                         uncertainty =       0.002427085286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491717313151
                                         uncertainty =       0.002427085286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495845632
  error estimate for blocks of size 2^( 2) =       0.000514309937
  error estimate for blocks of size 2^( 3) =       0.000530887446
  error estimate for blocks of size 2^( 4) =       0.000543376084
  error estimate for blocks of size 2^( 5) =       0.000549924690
  error estimate for blocks of size 2^( 6) =       0.000553283998
  error estimate for blocks of size 2^( 7) =       0.000555398308

      target function =      -0.607017475645
              le_mean =     -22.665624956400
             les_mean =     514.240370875751
             stat err =       0.000550495770
             autocorr =       1.232579638674
   target nu stat err =       0.000550495770
   target dn stat err =       0.004714777176
      target stat err =       0.001433202628
              std dev =       0.701231617459
             le_variance =       0.491725781324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492740438154
                                         uncertainty =       0.002436077397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492740438154
                                         uncertainty =       0.002436077397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496361721
  error estimate for blocks of size 2^( 2) =       0.000514847570
  error estimate for blocks of size 2^( 3) =       0.000531445104
  error estimate for blocks of size 2^( 4) =       0.000543951596
  error estimate for blocks of size 2^( 5) =       0.000550513016
  error estimate for blocks of size 2^( 6) =       0.000553888097
  error estimate for blocks of size 2^( 7) =       0.000556028270

      target function =      -0.607397998361
              le_mean =     -22.665621211290
             les_mean =     514.238925053563
             stat err =       0.000551095245
             autocorr =       1.232698205426
   target nu stat err =       0.000551095245
   target dn stat err =       0.004496725958
      target stat err =       0.001371076562
              std dev =       0.701961477837
             le_variance =       0.492749916367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607243544143        initial
     3.9062e-01     3.9062e+00             1.7707e-03        -0.607096719207
     1.5625e+00     1.5625e+01             4.7581e-04        -0.607017475645
     6.2500e+00     6.2500e+01             1.2121e-04        -0.607397998361  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.5911e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_001                -7.028117e-01 3 1  ON 0
ci_002                -7.013189e-01 3 1  ON 1
ci_003                -5.836733e-02 3 1  ON 2
ci_004                -5.849918e-02 3 1  ON 3
ci_005                 3.353723e-02 3 1  ON 4
ci_006                 3.381665e-02 3 1  ON 5
ci_007                 2.495607e-02 3 1  ON 6
ci_008                 2.542102e-02 3 1  ON 7
ci_009                -1.968188e-02 3 1  ON 8
ci_010                -1.966656e-02 3 1  ON 9
ci_011                -1.754483e-02 3 1  ON 10
ci_012                -1.721281e-02 3 1  ON 11
ci_013                 1.545266e-02 3 1  ON 12
ci_014                 1.523206e-02 3 1  ON 13
ci_015                 1.639313e-02 3 1  ON 14
ci_016                 1.624130e-02 3 1  ON 15
ci_017                 1.289364e-02 3 1  ON 16
ci_018                 1.280723e-02 3 1  ON 17
ci_019                 6.576870e-03 3 1  ON 18
ci_020                 7.278799e-03 3 1  ON 19
ci_021                -8.759969e-03 3 1  ON 20
ci_022                -9.044368e-03 3 1  ON 21
ci_023                 7.459474e-03 3 1  ON 22
ci_024                 7.275470e-03 3 1  ON 23
ci_025                 8.398897e-03 3 1  ON 24
ci_026                 8.652507e-03 3 1  ON 25
ci_027                 7.150896e-03 3 1  ON 26
ci_028                 7.260903e-03 3 1  ON 27
ci_029                -6.552095e-03 3 1  ON 28
ci_030                -6.669594e-03 3 1  ON 29
ci_031                -4.874333e-03 3 1  ON 30
ci_032                -5.171305e-03 3 1  ON 31
ci_033                 5.745090e-03 3 1  ON 32
ci_034                 5.630167e-03 3 1  ON 33
ci_035                 4.567926e-03 3 1  ON 34
ci_036                 4.598117e-03 3 1  ON 35
ci_037                 5.535126e-03 3 1  ON 36
ci_038                 5.485466e-03 3 1  ON 37
ci_039                 5.062619e-03 3 1  ON 38
ci_040                 5.005845e-03 3 1  ON 39
ci_041                 4.332657e-03 3 1  ON 40
ci_042                 4.413659e-03 3 1  ON 41
ci_043                 4.575001e-03 3 1  ON 42
ci_044                 4.549608e-03 3 1  ON 43
ci_045                 4.009228e-03 3 1  ON 44
ci_046                 4.094333e-03 3 1  ON 45
ci_047                -2.828889e-03 3 1  ON 46
ci_048                -2.964919e-03 3 1  ON 47
ci_049                 2.346004e-03 3 1  ON 48
ci_050                 2.430775e-03 3 1  ON 49
ci_051                -2.560141e-03 3 1  ON 50
ci_052                -2.494371e-03 3 1  ON 51
ci_053                -2.386649e-03 3 1  ON 52
ci_054                -2.537988e-03 3 1  ON 53
ci_055                -1.583410e-03 3 1  ON 54
ci_056                -1.876943e-03 3 1  ON 55
ci_057                -1.471063e-03 3 1  ON 56
ci_058                -1.810993e-03 3 1  ON 57
ci_059                -1.207334e-03 3 1  ON 58
ci_060                -1.233580e-03 3 1  ON 59
ci_061                -1.276364e-03 3 1  ON 60
ci_062                -1.088435e-03 3 1  ON 61
ci_063                -9.879910e-04 3 1  ON 62
ci_064                -9.354460e-04 3 1  ON 63
ci_065                -1.574352e-03 3 1  ON 64
ci_066                -1.827706e-03 3 1  ON 65
ci_067                -1.480104e-03 3 1  ON 66
ci_068                -1.180076e-03 3 1  ON 67
ci_069                 5.961239e-04 3 1  ON 68
ci_070                 6.469363e-04 3 1  ON 69
ci_071                -1.659249e-03 3 1  ON 70
ci_072                -1.559639e-03 3 1  ON 71
ci_073                 6.857999e-04 3 1  ON 72
ci_074                 9.269434e-04 3 1  ON 73
ci_075                -7.302844e-04 3 1  ON 74
ci_076                -5.995269e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4652e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2681e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7651
    reference variance = 0.547665
====================================================
  Execution time = 5.1049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0525e-01
  Total weights = 1.954803617e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489823330094
                                         uncertainty =       0.002529447642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489823330094
                                         uncertainty =       0.002529447642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494840541
  error estimate for blocks of size 2^( 2) =       0.000513757264
  error estimate for blocks of size 2^( 3) =       0.000530322050
  error estimate for blocks of size 2^( 4) =       0.000542092169
  error estimate for blocks of size 2^( 5) =       0.000550554577
  error estimate for blocks of size 2^( 6) =       0.000554141517
  error estimate for blocks of size 2^( 7) =       0.000559372161

      target function =      -0.608539027852
              le_mean =     -22.666254235953
             les_mean =     514.264332739423
             stat err =       0.000551540106
             autocorr =       1.242291888948
   target nu stat err =       0.000551540106
   target dn stat err =       0.004525395600
      target stat err =       0.001385318244
              std dev =       0.699810204871
             le_variance =       0.489734322842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266625423595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608541860990       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608636763188       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608645807994       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608646642890       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608646767677       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608646881116       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608646896303       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608646901418       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608646900848       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 4.778339e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608541860990       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608566025009       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608568309054       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608568518182       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608568549011       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608568576968       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608568580646       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608568581902       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608568581756       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.217512e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608541860990       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608547930029       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608548502478       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608548554783       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608548562466       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608548569430       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608548570342       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608548570655       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608548570618       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 3.058453e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.495937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0436e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_001                -7.028278e-01 3 1  ON 0
ci_002                -7.013394e-01 3 1  ON 1
ci_003                -5.832647e-02 3 1  ON 2
ci_004                -5.846630e-02 3 1  ON 3
ci_005                 3.342220e-02 3 1  ON 4
ci_006                 3.369490e-02 3 1  ON 5
ci_007                 2.488746e-02 3 1  ON 6
ci_008                 2.535702e-02 3 1  ON 7
ci_009                -1.963075e-02 3 1  ON 8
ci_010                -1.961406e-02 3 1  ON 9
ci_011                -1.747958e-02 3 1  ON 10
ci_012                -1.714850e-02 3 1  ON 11
ci_013                 1.539845e-02 3 1  ON 12
ci_014                 1.519108e-02 3 1  ON 13
ci_015                 1.634522e-02 3 1  ON 14
ci_016                 1.620012e-02 3 1  ON 15
ci_017                 1.286216e-02 3 1  ON 16
ci_018                 1.278524e-02 3 1  ON 17
ci_019                 6.536777e-03 3 1  ON 18
ci_020                 7.250668e-03 3 1  ON 19
ci_021                -8.755048e-03 3 1  ON 20
ci_022                -9.043912e-03 3 1  ON 21
ci_023                 7.449119e-03 3 1  ON 22
ci_024                 7.259698e-03 3 1  ON 23
ci_025                 8.401645e-03 3 1  ON 24
ci_026                 8.657205e-03 3 1  ON 25
ci_027                 7.144419e-03 3 1  ON 26
ci_028                 7.252811e-03 3 1  ON 27
ci_029                -6.534722e-03 3 1  ON 28
ci_030                -6.650688e-03 3 1  ON 29
ci_031                -4.842307e-03 3 1  ON 30
ci_032                -5.122603e-03 3 1  ON 31
ci_033                 5.721908e-03 3 1  ON 32
ci_034                 5.611774e-03 3 1  ON 33
ci_035                 4.553352e-03 3 1  ON 34
ci_036                 4.575292e-03 3 1  ON 35
ci_037                 5.521598e-03 3 1  ON 36
ci_038                 5.481993e-03 3 1  ON 37
ci_039                 5.054099e-03 3 1  ON 38
ci_040                 5.000179e-03 3 1  ON 39
ci_041                 4.326774e-03 3 1  ON 40
ci_042                 4.406277e-03 3 1  ON 41
ci_043                 4.578413e-03 3 1  ON 42
ci_044                 4.535865e-03 3 1  ON 43
ci_045                 4.003023e-03 3 1  ON 44
ci_046                 4.093694e-03 3 1  ON 45
ci_047                -2.818834e-03 3 1  ON 46
ci_048                -2.952094e-03 3 1  ON 47
ci_049                 2.340466e-03 3 1  ON 48
ci_050                 2.411874e-03 3 1  ON 49
ci_051                -2.552793e-03 3 1  ON 50
ci_052                -2.494998e-03 3 1  ON 51
ci_053                -2.392888e-03 3 1  ON 52
ci_054                -2.536763e-03 3 1  ON 53
ci_055                -1.582553e-03 3 1  ON 54
ci_056                -1.880250e-03 3 1  ON 55
ci_057                -1.470200e-03 3 1  ON 56
ci_058                -1.809310e-03 3 1  ON 57
ci_059                -1.204944e-03 3 1  ON 58
ci_060                -1.224133e-03 3 1  ON 59
ci_061                -1.268112e-03 3 1  ON 60
ci_062                -1.090174e-03 3 1  ON 61
ci_063                -9.840426e-04 3 1  ON 62
ci_064                -9.237571e-04 3 1  ON 63
ci_065                -1.574233e-03 3 1  ON 64
ci_066                -1.832112e-03 3 1  ON 65
ci_067                -1.481986e-03 3 1  ON 66
ci_068                -1.182111e-03 3 1  ON 67
ci_069                 5.886671e-04 3 1  ON 68
ci_070                 6.493042e-04 3 1  ON 69
ci_071                -1.669132e-03 3 1  ON 70
ci_072                -1.567395e-03 3 1  ON 71
ci_073                 6.878673e-04 3 1  ON 72
ci_074                 9.338544e-04 3 1  ON 73
ci_075                -7.239345e-04 3 1  ON 74
ci_076                -5.976936e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7166
    reference variance = 0.404462
====================================================
  Execution time = 4.9648e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0275e-01
  Total weights = 1.9550e+06
  Execution time = 7.2111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489440635878
                                         uncertainty =       0.002301319641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489440635878
                                         uncertainty =       0.002301319641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494651054
  error estimate for blocks of size 2^( 2) =       0.000513380820
  error estimate for blocks of size 2^( 3) =       0.000530628671
  error estimate for blocks of size 2^( 4) =       0.000543381643
  error estimate for blocks of size 2^( 5) =       0.000550343849
  error estimate for blocks of size 2^( 6) =       0.000554679603
  error estimate for blocks of size 2^( 7) =       0.000557220993

      target function =      -0.609182412113
              le_mean =     -22.666892236808
             les_mean =     514.291644685710
             stat err =       0.000551406522
             autocorr =       1.242641689228
   target nu stat err =       0.000551406522
   target dn stat err =       0.003488164393
      target stat err =       0.001084532429
              std dev =       0.699542228941
             le_variance =       0.489359330071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488809422951
                                         uncertainty =       0.002286138266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488809422951
                                         uncertainty =       0.002286138266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494332138
  error estimate for blocks of size 2^( 2) =       0.000513049423
  error estimate for blocks of size 2^( 3) =       0.000530285788
  error estimate for blocks of size 2^( 4) =       0.000543028403
  error estimate for blocks of size 2^( 5) =       0.000549977991
  error estimate for blocks of size 2^( 6) =       0.000554300622
  error estimate for blocks of size 2^( 7) =       0.000556833447

      target function =      -0.609886087089
              le_mean =     -22.666890204649
             les_mean =     514.289217004496
             stat err =       0.000551035116
             autocorr =       1.242569987482
   target nu stat err =       0.000551035116
   target dn stat err =       0.002985465610
      target stat err =       0.000940887798
              std dev =       0.699091213862
             le_variance =       0.488728525299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489113543888
                                         uncertainty =       0.002293430796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489113543888
                                         uncertainty =       0.002293430796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494485819
  error estimate for blocks of size 2^( 2) =       0.000513209270
  error estimate for blocks of size 2^( 3) =       0.000530451330
  error estimate for blocks of size 2^( 4) =       0.000543199058
  error estimate for blocks of size 2^( 5) =       0.000550154804
  error estimate for blocks of size 2^( 6) =       0.000554483777
  error estimate for blocks of size 2^( 7) =       0.000557021229

      target function =      -0.609638191658
              le_mean =     -22.666890548447
             les_mean =     514.290054564410
             stat err =       0.000551214717
             autocorr =       1.242607374379
   target nu stat err =       0.000551214717
   target dn stat err =       0.003135988065
      target stat err =       0.000983689167
              std dev =       0.699308551286
             le_variance =       0.489032449902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489398768685
                                         uncertainty =       0.002300308770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489398768685
                                         uncertainty =       0.002300308770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494629907
  error estimate for blocks of size 2^( 2) =       0.000513358888
  error estimate for blocks of size 2^( 3) =       0.000530606020
  error estimate for blocks of size 2^( 4) =       0.000543358335
  error estimate for blocks of size 2^( 5) =       0.000550319731
  error estimate for blocks of size 2^( 6) =       0.000554654606
  error estimate for blocks of size 2^( 7) =       0.000557195563

      target function =      -0.609261950244
              le_mean =     -22.666891948120
             les_mean =     514.291367331727
             stat err =       0.000551382059
             autocorr =       1.242637677368
   target nu stat err =       0.000551382059
   target dn stat err =       0.003421403955
      target stat err =       0.001065362506
              std dev =       0.699512323076
             le_variance =       0.489317490136


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609182412113        initial
     1.5625e+00     1.5625e+01             4.7783e-04        -0.609886087089  <--
     6.2500e+00     6.2500e+01             1.2175e-04        -0.609638191658
     2.5000e+01     2.5000e+02             3.0585e-05        -0.609261950244

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.6777e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_001                -7.028751e-01 3 1  ON 0
ci_002                -7.013998e-01 3 1  ON 1
ci_003                -5.820516e-02 3 1  ON 2
ci_004                -5.836862e-02 3 1  ON 3
ci_005                 3.308580e-02 3 1  ON 4
ci_006                 3.333881e-02 3 1  ON 5
ci_007                 2.468612e-02 3 1  ON 6
ci_008                 2.516917e-02 3 1  ON 7
ci_009                -1.948080e-02 3 1  ON 8
ci_010                -1.946011e-02 3 1  ON 9
ci_011                -1.728806e-02 3 1  ON 10
ci_012                -1.695985e-02 3 1  ON 11
ci_013                 1.523952e-02 3 1  ON 12
ci_014                 1.507090e-02 3 1  ON 13
ci_015                 1.620416e-02 3 1  ON 14
ci_016                 1.607884e-02 3 1  ON 15
ci_017                 1.276974e-02 3 1  ON 16
ci_018                 1.272073e-02 3 1  ON 17
ci_019                 6.418673e-03 3 1  ON 18
ci_020                 7.167627e-03 3 1  ON 19
ci_021                -8.740585e-03 3 1  ON 20
ci_022                -9.042651e-03 3 1  ON 21
ci_023                 7.418834e-03 3 1  ON 22
ci_024                 7.213484e-03 3 1  ON 23
ci_025                 8.409888e-03 3 1  ON 24
ci_026                 8.671143e-03 3 1  ON 25
ci_027                 7.125566e-03 3 1  ON 26
ci_028                 7.229224e-03 3 1  ON 27
ci_029                -6.483575e-03 3 1  ON 28
ci_030                -6.595016e-03 3 1  ON 29
ci_031                -4.748046e-03 3 1  ON 30
ci_032                -4.979389e-03 3 1  ON 31
ci_033                 5.653775e-03 3 1  ON 32
ci_034                 5.557725e-03 3 1  ON 33
ci_035                 4.510600e-03 3 1  ON 34
ci_036                 4.508466e-03 3 1  ON 35
ci_037                 5.481811e-03 3 1  ON 36
ci_038                 5.471728e-03 3 1  ON 37
ci_039                 5.029283e-03 3 1  ON 38
ci_040                 4.983664e-03 3 1  ON 39
ci_041                 4.309552e-03 3 1  ON 40
ci_042                 4.384688e-03 3 1  ON 41
ci_043                 4.588260e-03 3 1  ON 42
ci_044                 4.495453e-03 3 1  ON 43
ci_045                 3.984837e-03 3 1  ON 44
ci_046                 4.091888e-03 3 1  ON 45
ci_047                -2.789361e-03 3 1  ON 46
ci_048                -2.914487e-03 3 1  ON 47
ci_049                 2.324228e-03 3 1  ON 48
ci_050                 2.356425e-03 3 1  ON 49
ci_051                -2.530999e-03 3 1  ON 50
ci_052                -2.496690e-03 3 1  ON 51
ci_053                -2.411420e-03 3 1  ON 52
ci_054                -2.533238e-03 3 1  ON 53
ci_055                -1.580037e-03 3 1  ON 54
ci_056                -1.890053e-03 3 1  ON 55
ci_057                -1.467651e-03 3 1  ON 56
ci_058                -1.804357e-03 3 1  ON 57
ci_059                -1.197845e-03 3 1  ON 58
ci_060                -1.196386e-03 3 1  ON 59
ci_061                -1.243854e-03 3 1  ON 60
ci_062                -1.095253e-03 3 1  ON 61
ci_063                -9.725896e-04 3 1  ON 62
ci_064                -8.894441e-04 3 1  ON 63
ci_065                -1.573809e-03 3 1  ON 64
ci_066                -1.844979e-03 3 1  ON 65
ci_067                -1.487559e-03 3 1  ON 66
ci_068                -1.188135e-03 3 1  ON 67
ci_069                 5.667508e-04 3 1  ON 68
ci_070                 6.561551e-04 3 1  ON 69
ci_071                -1.698074e-03 3 1  ON 70
ci_072                -1.590077e-03 3 1  ON 71
ci_073                 6.938830e-04 3 1  ON 72
ci_074                 9.539511e-04 3 1  ON 73
ci_075                -7.052595e-04 3 1  ON 74
ci_076                -5.922425e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4723e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2684e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7516
    reference variance = 0.508866
====================================================
  Execution time = 5.1280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.1031e-01
  Total weights = 1.955028450e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495827719047
                                         uncertainty =       0.002967483300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495827719047
                                         uncertainty =       0.002967483300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497913057
  error estimate for blocks of size 2^( 2) =       0.000516119082
  error estimate for blocks of size 2^( 3) =       0.000533222816
  error estimate for blocks of size 2^( 4) =       0.000544498563
  error estimate for blocks of size 2^( 5) =       0.000551844464
  error estimate for blocks of size 2^( 6) =       0.000556287794
  error estimate for blocks of size 2^( 7) =       0.000555311472

      target function =      -0.606962554054
              le_mean =     -22.665995125301
             les_mean =     514.257643021832
             stat err =       0.000551985573
             autocorr =       1.228990210343
   target nu stat err =       0.000551985573
   target dn stat err =       0.003756272007
      target stat err =       0.001153810542
              std dev =       0.704155398572
             le_variance =       0.495834825338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266599512530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.606964446084       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607310855084       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607343875351       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607347152372       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607347841155       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607348203397       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607348237168       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607348237624       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607348253017       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607348263046       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607348262017       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.739454e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.606964446084       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607057333451       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607065934845       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607066750740       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607066915615       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607067000400       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607067006581       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607067006489       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607067010045       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607067012088       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607067011778       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 4.673823e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.606964446084       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.606988096687       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.606990269391       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.606990472936       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.606990513628       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.606990534435       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.606990535842       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.606990535808       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.606990536678       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.606990537160       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.606990537081       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.190692e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.502122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0850e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_001                -7.029964e-01 3 1  ON 0
ci_002                -7.014220e-01 3 1  ON 1
ci_003                -5.801628e-02 3 1  ON 2
ci_004                -5.821017e-02 3 1  ON 3
ci_005                 3.261842e-02 3 1  ON 4
ci_006                 3.288185e-02 3 1  ON 5
ci_007                 2.442119e-02 3 1  ON 6
ci_008                 2.487201e-02 3 1  ON 7
ci_009                -1.929379e-02 3 1  ON 8
ci_010                -1.926020e-02 3 1  ON 9
ci_011                -1.709731e-02 3 1  ON 10
ci_012                -1.672794e-02 3 1  ON 11
ci_013                 1.505094e-02 3 1  ON 12
ci_014                 1.490367e-02 3 1  ON 13
ci_015                 1.607053e-02 3 1  ON 14
ci_016                 1.591112e-02 3 1  ON 15
ci_017                 1.267025e-02 3 1  ON 16
ci_018                 1.263260e-02 3 1  ON 17
ci_019                 6.282653e-03 3 1  ON 18
ci_020                 7.097331e-03 3 1  ON 19
ci_021                -8.674076e-03 3 1  ON 20
ci_022                -8.990026e-03 3 1  ON 21
ci_023                 7.397564e-03 3 1  ON 22
ci_024                 7.178608e-03 3 1  ON 23
ci_025                 8.421343e-03 3 1  ON 24
ci_026                 8.701512e-03 3 1  ON 25
ci_027                 7.072487e-03 3 1  ON 26
ci_028                 7.170293e-03 3 1  ON 27
ci_029                -6.423800e-03 3 1  ON 28
ci_030                -6.566713e-03 3 1  ON 29
ci_031                -4.587243e-03 3 1  ON 30
ci_032                -4.871053e-03 3 1  ON 31
ci_033                 5.593833e-03 3 1  ON 32
ci_034                 5.483427e-03 3 1  ON 33
ci_035                 4.430053e-03 3 1  ON 34
ci_036                 4.421272e-03 3 1  ON 35
ci_037                 5.437192e-03 3 1  ON 36
ci_038                 5.431307e-03 3 1  ON 37
ci_039                 5.003758e-03 3 1  ON 38
ci_040                 4.977378e-03 3 1  ON 39
ci_041                 4.285982e-03 3 1  ON 40
ci_042                 4.347457e-03 3 1  ON 41
ci_043                 4.593921e-03 3 1  ON 42
ci_044                 4.468716e-03 3 1  ON 43
ci_045                 3.956986e-03 3 1  ON 44
ci_046                 4.075583e-03 3 1  ON 45
ci_047                -2.732081e-03 3 1  ON 46
ci_048                -2.843111e-03 3 1  ON 47
ci_049                 2.322786e-03 3 1  ON 48
ci_050                 2.312290e-03 3 1  ON 49
ci_051                -2.542094e-03 3 1  ON 50
ci_052                -2.490058e-03 3 1  ON 51
ci_053                -2.435647e-03 3 1  ON 52
ci_054                -2.525419e-03 3 1  ON 53
ci_055                -1.527772e-03 3 1  ON 54
ci_056                -1.921161e-03 3 1  ON 55
ci_057                -1.485037e-03 3 1  ON 56
ci_058                -1.787218e-03 3 1  ON 57
ci_059                -1.176487e-03 3 1  ON 58
ci_060                -1.208782e-03 3 1  ON 59
ci_061                -1.218138e-03 3 1  ON 60
ci_062                -1.090384e-03 3 1  ON 61
ci_063                -9.745170e-04 3 1  ON 62
ci_064                -8.941702e-04 3 1  ON 63
ci_065                -1.607083e-03 3 1  ON 64
ci_066                -1.820152e-03 3 1  ON 65
ci_067                -1.506757e-03 3 1  ON 66
ci_068                -1.158337e-03 3 1  ON 67
ci_069                 5.381676e-04 3 1  ON 68
ci_070                 6.354799e-04 3 1  ON 69
ci_071                -1.691435e-03 3 1  ON 70
ci_072                -1.601010e-03 3 1  ON 71
ci_073                 6.819875e-04 3 1  ON 72
ci_074                 9.456816e-04 3 1  ON 73
ci_075                -6.490192e-04 3 1  ON 74
ci_076                -5.824849e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7166
    reference variance = 0.451272
====================================================
  Execution time = 4.9689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.1075e-01
  Total weights = 1.9553e+06
  Execution time = 7.2034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493914503165
                                         uncertainty =       0.002476589363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493914503165
                                         uncertainty =       0.002476589363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496956139
  error estimate for blocks of size 2^( 2) =       0.000515479623
  error estimate for blocks of size 2^( 3) =       0.000531649935
  error estimate for blocks of size 2^( 4) =       0.000543649411
  error estimate for blocks of size 2^( 5) =       0.000550866254
  error estimate for blocks of size 2^( 6) =       0.000557049953
  error estimate for blocks of size 2^( 7) =       0.000558988388

      target function =      -0.606927867068
              le_mean =     -22.666095094684
             les_mean =     514.262372907656
             stat err =       0.000552638501
             autocorr =       1.236648164326
   target nu stat err =       0.000552638501
   target dn stat err =       0.003820193766
      target stat err =       0.001172405810
              std dev =       0.702802111175
             le_variance =       0.493930807472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.148719247560
                                         uncertainty =       0.653694687039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.148719247560
                                         uncertainty =       0.653694687039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000757791053
  error estimate for blocks of size 2^( 2) =       0.000769968572
  error estimate for blocks of size 2^( 3) =       0.000780914780
  error estimate for blocks of size 2^( 4) =       0.000786175315
  error estimate for blocks of size 2^( 5) =       0.000791811019
  error estimate for blocks of size 2^( 6) =       0.000794395180
  error estimate for blocks of size 2^( 7) =       0.000798083572

      target function =      -0.155665725890
              le_mean =     -22.666694113761
             les_mean =     517.883309664372
             stat err =       0.000792616271
             autocorr =       1.094024431917
   target nu stat err =       0.000792616271
   target dn stat err =       3.595361609093
      target stat err =       0.099491897457
              std dev =       1.071678384189
             le_variance =       1.148494559137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493898156905
                                         uncertainty =       0.002770152294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493898156905
                                         uncertainty =       0.002770152294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496947938
  error estimate for blocks of size 2^( 2) =       0.000515431115
  error estimate for blocks of size 2^( 3) =       0.000531567031
  error estimate for blocks of size 2^( 4) =       0.000543646805
  error estimate for blocks of size 2^( 5) =       0.000550834832
  error estimate for blocks of size 2^( 6) =       0.000557073638
  error estimate for blocks of size 2^( 7) =       0.000558951152

      target function =      -0.604541634449
              le_mean =     -22.666080188698
             les_mean =     514.269676329766
             stat err =       0.000552626606
             autocorr =       1.236635744625
   target nu stat err =       0.000552626606
   target dn stat err =       0.009170319242
      target stat err =       0.002729640443
              std dev =       0.702790513241
             le_variance =       0.493914505501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493809277992
                                         uncertainty =       0.002478516472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493809277992
                                         uncertainty =       0.002478516472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496903224
  error estimate for blocks of size 2^( 2) =       0.000515422939
  error estimate for blocks of size 2^( 3) =       0.000531590376
  error estimate for blocks of size 2^( 4) =       0.000543594175
  error estimate for blocks of size 2^( 5) =       0.000550808938
  error estimate for blocks of size 2^( 6) =       0.000556996379
  error estimate for blocks of size 2^( 7) =       0.000558932223

      target function =      -0.606938272686
              le_mean =     -22.666093206821
             les_mean =     514.262250558575
             stat err =       0.000552582929
             autocorr =       1.236662804305
   target nu stat err =       0.000552582929
   target dn stat err =       0.003920687889
      target stat err =       0.001201641668
              std dev =       0.702727278770
             le_variance =       0.493825628327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.606927867068        initial
     3.9062e-01     3.9062e+00             1.7395e-03        -0.155665725890
     1.5625e+00     1.5625e+01             4.6738e-04        -0.604541634449
     6.2500e+00     6.2500e+01             1.1907e-04        -0.606938272686  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.5818e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_001                -7.029057e-01 3 1  ON 0
ci_002                -7.014056e-01 3 1  ON 1
ci_003                -5.815759e-02 3 1  ON 2
ci_004                -5.832870e-02 3 1  ON 3
ci_005                 3.296673e-02 3 1  ON 4
ci_006                 3.322240e-02 3 1  ON 5
ci_007                 2.461880e-02 3 1  ON 6
ci_008                 2.509360e-02 3 1  ON 7
ci_009                -1.943325e-02 3 1  ON 8
ci_010                -1.940930e-02 3 1  ON 9
ci_011                -1.723960e-02 3 1  ON 10
ci_012                -1.690095e-02 3 1  ON 11
ci_013                 1.519162e-02 3 1  ON 12
ci_014                 1.502847e-02 3 1  ON 13
ci_015                 1.617027e-02 3 1  ON 14
ci_016                 1.603629e-02 3 1  ON 15
ci_017                 1.274445e-02 3 1  ON 16
ci_018                 1.269834e-02 3 1  ON 17
ci_019                 6.384225e-03 3 1  ON 18
ci_020                 7.149870e-03 3 1  ON 19
ci_021                -8.723643e-03 3 1  ON 20
ci_022                -9.029268e-03 3 1  ON 21
ci_023                 7.413412e-03 3 1  ON 22
ci_024                 7.204610e-03 3 1  ON 23
ci_025                 8.412753e-03 3 1  ON 24
ci_026                 8.678813e-03 3 1  ON 25
ci_027                 7.112025e-03 3 1  ON 26
ci_028                 7.214191e-03 3 1  ON 27
ci_029                -6.468418e-03 3 1  ON 28
ci_030                -6.587859e-03 3 1  ON 29
ci_031                -4.707227e-03 3 1  ON 30
ci_032                -4.951907e-03 3 1  ON 31
ci_033                 5.638554e-03 3 1  ON 32
ci_034                 5.538864e-03 3 1  ON 33
ci_035                 4.490102e-03 3 1  ON 34
ci_036                 4.486237e-03 3 1  ON 35
ci_037                 5.470512e-03 3 1  ON 36
ci_038                 5.461488e-03 3 1  ON 37
ci_039                 5.022762e-03 3 1  ON 38
ci_040                 4.982053e-03 3 1  ON 39
ci_041                 4.303524e-03 3 1  ON 40
ci_042                 4.375211e-03 3 1  ON 41
ci_043                 4.589718e-03 3 1  ON 42
ci_044                 4.488698e-03 3 1  ON 43
ci_045                 3.977746e-03 3 1  ON 44
ci_046                 4.087728e-03 3 1  ON 45
ci_047                -2.774780e-03 3 1  ON 46
ci_048                -2.896328e-03 3 1  ON 47
ci_049                 2.323871e-03 3 1  ON 48
ci_050                 2.345216e-03 3 1  ON 49
ci_051                -2.533857e-03 3 1  ON 50
ci_052                -2.495081e-03 3 1  ON 51
ci_053                -2.417532e-03 3 1  ON 52
ci_054                -2.531214e-03 3 1  ON 53
ci_055                -1.566767e-03 3 1  ON 54
ci_056                -1.897939e-03 3 1  ON 55
ci_057                -1.472087e-03 3 1  ON 56
ci_058                -1.800001e-03 3 1  ON 57
ci_059                -1.192417e-03 3 1  ON 58
ci_060                -1.199548e-03 3 1  ON 59
ci_061                -1.237342e-03 3 1  ON 60
ci_062                -1.094021e-03 3 1  ON 61
ci_063                -9.730607e-04 3 1  ON 62
ci_064                -8.906006e-04 3 1  ON 63
ci_065                -1.582264e-03 3 1  ON 64
ci_066                -1.838688e-03 3 1  ON 65
ci_067                -1.492426e-03 3 1  ON 66
ci_068                -1.180560e-03 3 1  ON 67
ci_069                 5.594915e-04 3 1  ON 68
ci_070                 6.509087e-04 3 1  ON 69
ci_071                -1.696418e-03 3 1  ON 70
ci_072                -1.592887e-03 3 1  ON 71
ci_073                 6.908618e-04 3 1  ON 72
ci_074                 9.518538e-04 3 1  ON 73
ci_075                -6.909708e-04 3 1  ON 74
ci_076                -5.897734e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4667e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.612
    reference variance = 0.428907
====================================================
  Execution time = 5.1201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0498e-01
  Total weights = 1.955170215e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491133144096
                                         uncertainty =       0.002490152529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491133144096
                                         uncertainty =       0.002490152529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495539230
  error estimate for blocks of size 2^( 2) =       0.000513965048
  error estimate for blocks of size 2^( 3) =       0.000530768429
  error estimate for blocks of size 2^( 4) =       0.000543053870
  error estimate for blocks of size 2^( 5) =       0.000550263237
  error estimate for blocks of size 2^( 6) =       0.000553546152
  error estimate for blocks of size 2^( 7) =       0.000559700351

      target function =      -0.608703282562
              le_mean =     -22.666580898454
             les_mean =     514.278866817140
             stat err =       0.000551640903
             autocorr =       1.239244034050
   target nu stat err =       0.000551640903
   target dn stat err =       0.003666889195
      target stat err =       0.001134681320
              std dev =       0.700798300251
             le_variance =       0.491118257634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266658089845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608705114472       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608793408593       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608802664126       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608803787564       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608804165859       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608804237631       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608804263953       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608804266303       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608804267370       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608804269031       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608804268456       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 4.523329e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608705114472       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608727594024       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608729931297       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608730212658       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608730306327       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608730323592       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608730329954       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608730330526       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608730330782       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608730331174       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608730331030       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.152521e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608705114472       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608710760317       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608711346107       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608711416476       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608711439834       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608711444108       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608711445685       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608711445827       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608711445890       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608711445986       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608711445951       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.895179e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.508031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0590e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_001                -7.029120e-01 3 1  ON 0
ci_002                -7.014389e-01 3 1  ON 1
ci_003                -5.809846e-02 3 1  ON 2
ci_004                -5.827195e-02 3 1  ON 3
ci_005                 3.285578e-02 3 1  ON 4
ci_006                 3.310715e-02 3 1  ON 5
ci_007                 2.454747e-02 3 1  ON 6
ci_008                 2.501828e-02 3 1  ON 7
ci_009                -1.938058e-02 3 1  ON 8
ci_010                -1.936159e-02 3 1  ON 9
ci_011                -1.717904e-02 3 1  ON 10
ci_012                -1.683424e-02 3 1  ON 11
ci_013                 1.514257e-02 3 1  ON 12
ci_014                 1.498427e-02 3 1  ON 13
ci_015                 1.612912e-02 3 1  ON 14
ci_016                 1.599722e-02 3 1  ON 15
ci_017                 1.271336e-02 3 1  ON 16
ci_018                 1.267877e-02 3 1  ON 17
ci_019                 6.354479e-03 3 1  ON 18
ci_020                 7.112389e-03 3 1  ON 19
ci_021                -8.715196e-03 3 1  ON 20
ci_022                -9.014302e-03 3 1  ON 21
ci_023                 7.400224e-03 3 1  ON 22
ci_024                 7.188121e-03 3 1  ON 23
ci_025                 8.411302e-03 3 1  ON 24
ci_026                 8.673594e-03 3 1  ON 25
ci_027                 7.106807e-03 3 1  ON 26
ci_028                 7.204987e-03 3 1  ON 27
ci_029                -6.459739e-03 3 1  ON 28
ci_030                -6.576526e-03 3 1  ON 29
ci_031                -4.675645e-03 3 1  ON 30
ci_032                -4.920426e-03 3 1  ON 31
ci_033                 5.629036e-03 3 1  ON 32
ci_034                 5.521723e-03 3 1  ON 33
ci_035                 4.463378e-03 3 1  ON 34
ci_036                 4.470354e-03 3 1  ON 35
ci_037                 5.454093e-03 3 1  ON 36
ci_038                 5.449433e-03 3 1  ON 37
ci_039                 5.012031e-03 3 1  ON 38
ci_040                 4.980965e-03 3 1  ON 39
ci_041                 4.303640e-03 3 1  ON 40
ci_042                 4.365452e-03 3 1  ON 41
ci_043                 4.584247e-03 3 1  ON 42
ci_044                 4.481798e-03 3 1  ON 43
ci_045                 3.962661e-03 3 1  ON 44
ci_046                 4.071753e-03 3 1  ON 45
ci_047                -2.762967e-03 3 1  ON 46
ci_048                -2.882758e-03 3 1  ON 47
ci_049                 2.318637e-03 3 1  ON 48
ci_050                 2.332858e-03 3 1  ON 49
ci_051                -2.526872e-03 3 1  ON 50
ci_052                -2.493015e-03 3 1  ON 51
ci_053                -2.418308e-03 3 1  ON 52
ci_054                -2.532838e-03 3 1  ON 53
ci_055                -1.564624e-03 3 1  ON 54
ci_056                -1.905237e-03 3 1  ON 55
ci_057                -1.471511e-03 3 1  ON 56
ci_058                -1.799397e-03 3 1  ON 57
ci_059                -1.191343e-03 3 1  ON 58
ci_060                -1.191762e-03 3 1  ON 59
ci_061                -1.235162e-03 3 1  ON 60
ci_062                -1.086763e-03 3 1  ON 61
ci_063                -9.646185e-04 3 1  ON 62
ci_064                -8.829064e-04 3 1  ON 63
ci_065                -1.582428e-03 3 1  ON 64
ci_066                -1.840175e-03 3 1  ON 65
ci_067                -1.496265e-03 3 1  ON 66
ci_068                -1.182721e-03 3 1  ON 67
ci_069                 5.541768e-04 3 1  ON 68
ci_070                 6.556945e-04 3 1  ON 69
ci_071                -1.698488e-03 3 1  ON 70
ci_072                -1.597131e-03 3 1  ON 71
ci_073                 6.855025e-04 3 1  ON 72
ci_074                 9.544389e-04 3 1  ON 73
ci_075                -6.928970e-04 3 1  ON 74
ci_076                -5.932301e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.5781
    reference variance = 0.727832
====================================================
  Execution time = 4.9669e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.1171e-01
  Total weights = 1.9547e+06
  Execution time = 7.2262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500237989889
                                         uncertainty =       0.003093231040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500237989889
                                         uncertainty =       0.003093231040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500120953
  error estimate for blocks of size 2^( 2) =       0.000518539196
  error estimate for blocks of size 2^( 3) =       0.000535752703
  error estimate for blocks of size 2^( 4) =       0.000548694769
  error estimate for blocks of size 2^( 5) =       0.000554750800
  error estimate for blocks of size 2^( 6) =       0.000556584546
  error estimate for blocks of size 2^( 7) =       0.000555601715

      target function =      -0.606662826996
              le_mean =     -22.666836725796
             les_mean =     514.297487949621
             stat err =       0.000553907958
             autocorr =       1.226662556175
   target nu stat err =       0.000553907958
   target dn stat err =       0.003957625888
      target stat err =       0.001212190374
              std dev =       0.707277834554
             le_variance =       0.500241935251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499718240827
                                         uncertainty =       0.003097778227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499718240827
                                         uncertainty =       0.003097778227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499861171
  error estimate for blocks of size 2^( 2) =       0.000518264807
  error estimate for blocks of size 2^( 3) =       0.000535466743
  error estimate for blocks of size 2^( 4) =       0.000548399375
  error estimate for blocks of size 2^( 5) =       0.000554444210
  error estimate for blocks of size 2^( 6) =       0.000556258513
  error estimate for blocks of size 2^( 7) =       0.000555258073

      target function =      -0.606872382152
              le_mean =     -22.666839444402
             les_mean =     514.296911494492
             stat err =       0.000553590043
             autocorr =       1.226528760163
   target nu stat err =       0.000553590043
   target dn stat err =       0.003964495302
      target stat err =       0.001214973620
              std dev =       0.706910446852
             le_variance =       0.499722379869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499969925098
                                         uncertainty =       0.003095409328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499969925098
                                         uncertainty =       0.003095409328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499986986
  error estimate for blocks of size 2^( 2) =       0.000518397753
  error estimate for blocks of size 2^( 3) =       0.000535605354
  error estimate for blocks of size 2^( 4) =       0.000548542462
  error estimate for blocks of size 2^( 5) =       0.000554593003
  error estimate for blocks of size 2^( 6) =       0.000556416860
  error estimate for blocks of size 2^( 7) =       0.000555425124

      target function =      -0.606814005747
              le_mean =     -22.666837592381
             les_mean =     514.297021529565
             stat err =       0.000553744362
             autocorr =       1.226595127015
   target nu stat err =       0.000553744362
   target dn stat err =       0.003956635009
      target stat err =       0.001212473782
              std dev =       0.707088376042
             le_variance =       0.499973971533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500203926071
                                         uncertainty =       0.003093492452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500203926071
                                         uncertainty =       0.003093492452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500103931
  error estimate for blocks of size 2^( 2) =       0.000518521230
  error estimate for blocks of size 2^( 3) =       0.000535733995
  error estimate for blocks of size 2^( 4) =       0.000548675404
  error estimate for blocks of size 2^( 5) =       0.000554730764
  error estimate for blocks of size 2^( 6) =       0.000556563269
  error estimate for blocks of size 2^( 7) =       0.000555579344

      target function =      -0.606693043882
              le_mean =     -22.666836767943
             les_mean =     514.297388660931
             stat err =       0.000553887195
             autocorr =       1.226654095496
   target nu stat err =       0.000553887195
   target dn stat err =       0.003955812566
      target stat err =       0.001211778434
              std dev =       0.707253762290
             le_variance =       0.500207884273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.606662826996        initial
     1.5625e+00     1.5625e+01             4.5233e-04        -0.606872382152  <--
     6.2500e+00     6.2500e+01             1.1525e-04        -0.606814005747
     2.5000e+01     2.5000e+02             2.8952e-05        -0.606693043882

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.9843e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_001                -7.029298e-01 3 1  ON 0
ci_002                -7.015374e-01 3 1  ON 1
ci_003                -5.792285e-02 3 1  ON 2
ci_004                -5.810345e-02 3 1  ON 3
ci_005                 3.253121e-02 3 1  ON 4
ci_006                 3.277007e-02 3 1  ON 5
ci_007                 2.433805e-02 3 1  ON 6
ci_008                 2.479719e-02 3 1  ON 7
ci_009                -1.922611e-02 3 1  ON 8
ci_010                -1.922167e-02 3 1  ON 9
ci_011                -1.700112e-02 3 1  ON 10
ci_012                -1.663829e-02 3 1  ON 11
ci_013                 1.499859e-02 3 1  ON 12
ci_014                 1.485462e-02 3 1  ON 13
ci_015                 1.600807e-02 3 1  ON 14
ci_016                 1.588221e-02 3 1  ON 15
ci_017                 1.262211e-02 3 1  ON 16
ci_018                 1.262140e-02 3 1  ON 17
ci_019                 6.266789e-03 3 1  ON 18
ci_020                 7.001856e-03 3 1  ON 19
ci_021                -8.690419e-03 3 1  ON 20
ci_022                -8.970275e-03 3 1  ON 21
ci_023                 7.361604e-03 3 1  ON 22
ci_024                 7.139839e-03 3 1  ON 23
ci_025                 8.407149e-03 3 1  ON 24
ci_026                 8.658442e-03 3 1  ON 25
ci_027                 7.091603e-03 3 1  ON 26
ci_028                 7.178131e-03 3 1  ON 27
ci_029                -6.434128e-03 3 1  ON 28
ci_030                -6.543148e-03 3 1  ON 29
ci_031                -4.582791e-03 3 1  ON 30
ci_032                -4.827899e-03 3 1  ON 31
ci_033                 5.601138e-03 3 1  ON 32
ci_034                 5.471402e-03 3 1  ON 33
ci_035                 4.385166e-03 3 1  ON 34
ci_036                 4.423814e-03 3 1  ON 35
ci_037                 5.405717e-03 3 1  ON 36
ci_038                 5.413919e-03 3 1  ON 37
ci_039                 4.980686e-03 3 1  ON 38
ci_040                 4.977851e-03 3 1  ON 39
ci_041                 4.304009e-03 3 1  ON 40
ci_042                 4.336896e-03 3 1  ON 41
ci_043                 4.568007e-03 3 1  ON 42
ci_044                 4.461436e-03 3 1  ON 43
ci_045                 3.918412e-03 3 1  ON 44
ci_046                 4.024927e-03 3 1  ON 45
ci_047                -2.728327e-03 3 1  ON 46
ci_048                -2.842966e-03 3 1  ON 47
ci_049                 2.303273e-03 3 1  ON 48
ci_050                 2.296575e-03 3 1  ON 49
ci_051                -2.506101e-03 3 1  ON 50
ci_052                -2.486711e-03 3 1  ON 51
ci_053                -2.420774e-03 3 1  ON 52
ci_054                -2.537790e-03 3 1  ON 53
ci_055                -1.558355e-03 3 1  ON 54
ci_056                -1.926766e-03 3 1  ON 55
ci_057                -1.469785e-03 3 1  ON 56
ci_058                -1.797615e-03 3 1  ON 57
ci_059                -1.188211e-03 3 1  ON 58
ci_060                -1.169042e-03 3 1  ON 59
ci_061                -1.228708e-03 3 1  ON 60
ci_062                -1.065432e-03 3 1  ON 61
ci_063                -9.399379e-04 3 1  ON 62
ci_064                -8.604194e-04 3 1  ON 63
ci_065                -1.582837e-03 3 1  ON 64
ci_066                -1.844475e-03 3 1  ON 65
ci_067                -1.507536e-03 3 1  ON 66
ci_068                -1.189078e-03 3 1  ON 67
ci_069                 5.385553e-04 3 1  ON 68
ci_070                 6.697621e-04 3 1  ON 69
ci_071                -1.704485e-03 3 1  ON 70
ci_072                -1.609462e-03 3 1  ON 71
ci_073                 6.697897e-04 3 1  ON 72
ci_074                 9.619332e-04 3 1  ON 73
ci_075                -6.985433e-04 3 1  ON 74
ci_076                -6.033407e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.5044e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.9979
    reference variance = 6.22962
====================================================
  Execution time = 5.1143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2665e+01
  VMC Evar = 5.1890e-01
  Total weights = 1.954794559e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498203694811
                                         uncertainty =       0.003601396745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498203694811
                                         uncertainty =       0.003601396745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499226867
  error estimate for blocks of size 2^( 2) =       0.000517496967
  error estimate for blocks of size 2^( 3) =       0.000534182734
  error estimate for blocks of size 2^( 4) =       0.000546623148
  error estimate for blocks of size 2^( 5) =       0.000555755337
  error estimate for blocks of size 2^( 6) =       0.000559171291
  error estimate for blocks of size 2^( 7) =       0.000562075676

      target function =      -0.604264652304
              le_mean =     -22.665430318230
             les_mean =     514.240627540484
             stat err =       0.000555906363
             autocorr =       1.239959186932
   target nu stat err =       0.000555906363
   target dn stat err =       0.008618191851
      target stat err =       0.002563438541
              std dev =       0.706013405590
             le_variance =       0.498454928872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266543031823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.604275294316       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.604598284042       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.604633175829       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.604635996564       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.604636844011       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.604637419702       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.604637600111       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.604637620788       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.604637663619       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.604637707532       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.604637694718       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.701741e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.604275294316       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.604361821985       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.604370888742       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.604371597123       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.604371803733       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.604371937296       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.604371975560       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.604371978837       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.604371988370       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.604371997633       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.604371994784       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 4.572165e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.604275294316       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.604297320106       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.604299608895       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.604299786060       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.604299837320       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.604299870016       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.604299879155       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.604299879863       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.604299882174       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.604299884386       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.604299883697       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.164761e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.514251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0584e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_001                -7.028507e-01 3 1  ON 0
ci_002                -7.017529e-01 3 1  ON 1
ci_003                -5.776428e-02 3 1  ON 2
ci_004                -5.798807e-02 3 1  ON 3
ci_005                 3.209673e-02 3 1  ON 4
ci_006                 3.231285e-02 3 1  ON 5
ci_007                 2.405560e-02 3 1  ON 6
ci_008                 2.454234e-02 3 1  ON 7
ci_009                -1.903594e-02 3 1  ON 8
ci_010                -1.904067e-02 3 1  ON 9
ci_011                -1.677002e-02 3 1  ON 10
ci_012                -1.637501e-02 3 1  ON 11
ci_013                 1.481958e-02 3 1  ON 12
ci_014                 1.469801e-02 3 1  ON 13
ci_015                 1.583513e-02 3 1  ON 14
ci_016                 1.575618e-02 3 1  ON 15
ci_017                 1.249551e-02 3 1  ON 16
ci_018                 1.252889e-02 3 1  ON 17
ci_019                 6.126248e-03 3 1  ON 18
ci_020                 6.869523e-03 3 1  ON 19
ci_021                -8.586237e-03 3 1  ON 20
ci_022                -9.005789e-03 3 1  ON 21
ci_023                 7.314633e-03 3 1  ON 22
ci_024                 7.078925e-03 3 1  ON 23
ci_025                 8.406283e-03 3 1  ON 24
ci_026                 8.665301e-03 3 1  ON 25
ci_027                 7.066676e-03 3 1  ON 26
ci_028                 7.151469e-03 3 1  ON 27
ci_029                -6.367027e-03 3 1  ON 28
ci_030                -6.483304e-03 3 1  ON 29
ci_031                -4.455413e-03 3 1  ON 30
ci_032                -4.672925e-03 3 1  ON 31
ci_033                 5.509518e-03 3 1  ON 32
ci_034                 5.408138e-03 3 1  ON 33
ci_035                 4.354164e-03 3 1  ON 34
ci_036                 4.358714e-03 3 1  ON 35
ci_037                 5.339007e-03 3 1  ON 36
ci_038                 5.362687e-03 3 1  ON 37
ci_039                 4.941746e-03 3 1  ON 38
ci_040                 4.927432e-03 3 1  ON 39
ci_041                 4.286176e-03 3 1  ON 40
ci_042                 4.299883e-03 3 1  ON 41
ci_043                 4.548112e-03 3 1  ON 42
ci_044                 4.387579e-03 3 1  ON 43
ci_045                 3.899652e-03 3 1  ON 44
ci_046                 3.989108e-03 3 1  ON 45
ci_047                -2.640263e-03 3 1  ON 46
ci_048                -2.799476e-03 3 1  ON 47
ci_049                 2.291277e-03 3 1  ON 48
ci_050                 2.265273e-03 3 1  ON 49
ci_051                -2.517127e-03 3 1  ON 50
ci_052                -2.490078e-03 3 1  ON 51
ci_053                -2.442761e-03 3 1  ON 52
ci_054                -2.558199e-03 3 1  ON 53
ci_055                -1.553184e-03 3 1  ON 54
ci_056                -1.948210e-03 3 1  ON 55
ci_057                -1.438123e-03 3 1  ON 56
ci_058                -1.801932e-03 3 1  ON 57
ci_059                -1.156291e-03 3 1  ON 58
ci_060                -1.172763e-03 3 1  ON 59
ci_061                -1.211084e-03 3 1  ON 60
ci_062                -1.059038e-03 3 1  ON 61
ci_063                -9.445442e-04 3 1  ON 62
ci_064                -8.129069e-04 3 1  ON 63
ci_065                -1.590791e-03 3 1  ON 64
ci_066                -1.839620e-03 3 1  ON 65
ci_067                -1.504270e-03 3 1  ON 66
ci_068                -1.155575e-03 3 1  ON 67
ci_069                 5.137603e-04 3 1  ON 68
ci_070                 6.372802e-04 3 1  ON 69
ci_071                -1.700659e-03 3 1  ON 70
ci_072                -1.610766e-03 3 1  ON 71
ci_073                 6.592178e-04 3 1  ON 72
ci_074                 9.545296e-04 3 1  ON 73
ci_075                -6.726182e-04 3 1  ON 74
ci_076                -6.030261e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7046
    reference variance = 0.431929
====================================================
  Execution time = 4.9699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0963e-01
  Total weights = 1.9549e+06
  Execution time = 7.2107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497643514996
                                         uncertainty =       0.002877408593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497643514996
                                         uncertainty =       0.002877408593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498798221
  error estimate for blocks of size 2^( 2) =       0.000517274521
  error estimate for blocks of size 2^( 3) =       0.000533878035
  error estimate for blocks of size 2^( 4) =       0.000546188540
  error estimate for blocks of size 2^( 5) =       0.000553371448
  error estimate for blocks of size 2^( 6) =       0.000556279607
  error estimate for blocks of size 2^( 7) =       0.000558338752

      target function =      -0.606942048532
              le_mean =     -22.666356305321
             les_mean =     514.274382116091
             stat err =       0.000553544587
             autocorr =       1.231559573082
   target nu stat err =       0.000553544587
   target dn stat err =       0.003436156336
      target stat err =       0.001061601050
              std dev =       0.705407209213
             le_variance =       0.497599330809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495350418881
                                         uncertainty =       0.002784487306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495350418881
                                         uncertainty =       0.002784487306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497648107
  error estimate for blocks of size 2^( 2) =       0.000516096719
  error estimate for blocks of size 2^( 3) =       0.000532674171
  error estimate for blocks of size 2^( 4) =       0.000544942097
  error estimate for blocks of size 2^( 5) =       0.000552111652
  error estimate for blocks of size 2^( 6) =       0.000554979028
  error estimate for blocks of size 2^( 7) =       0.000556989385

      target function =      -0.594522372289
              le_mean =     -22.666372319670
             les_mean =     514.317217763157
             stat err =       0.000552255541
             autocorr =       1.231502934436
   target nu stat err =       0.000552255541
   target dn stat err =       0.027688955750
      target stat err =       0.007939263220
              std dev =       0.703780701772
             le_variance =       0.495307276187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496275274728
                                         uncertainty =       0.002797948733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496275274728
                                         uncertainty =       0.002797948733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498112377
  error estimate for blocks of size 2^( 2) =       0.000516573043
  error estimate for blocks of size 2^( 3) =       0.000533166564
  error estimate for blocks of size 2^( 4) =       0.000545454948
  error estimate for blocks of size 2^( 5) =       0.000552625085
  error estimate for blocks of size 2^( 6) =       0.000555512318
  error estimate for blocks of size 2^( 7) =       0.000557546705

      target function =      -0.607312456351
              le_mean =     -22.666360167206
             les_mean =     514.273320839073
             stat err =       0.000552784764
             autocorr =       1.231565355644
   target nu stat err =       0.000552784764
   target dn stat err =       0.003384047206
      target stat err =       0.001047709555
              std dev =       0.704437278563
             le_variance =       0.496231879429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497448959788
                                         uncertainty =       0.002861232675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497448959788
                                         uncertainty =       0.002861232675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498700775
  error estimate for blocks of size 2^( 2) =       0.000517175228
  error estimate for blocks of size 2^( 3) =       0.000533777623
  error estimate for blocks of size 2^( 4) =       0.000546085707
  error estimate for blocks of size 2^( 5) =       0.000553267337
  error estimate for blocks of size 2^( 6) =       0.000556172350
  error estimate for blocks of size 2^( 7) =       0.000558228409

      target function =      -0.607059789667
              le_mean =     -22.666355985056
             les_mean =     514.273973210244
             stat err =       0.000553438451
             autocorr =       1.231568496886
   target nu stat err =       0.000553438451
   target dn stat err =       0.003407081563
      target stat err =       0.001053593089
              std dev =       0.705269399859
             le_variance =       0.497404926378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.606942048532        initial
     3.9062e-01     3.9062e+00             1.7017e-03        -0.594522372289
     1.5625e+00     1.5625e+01             4.5722e-04        -0.607312456351  <--
     6.2500e+00     6.2500e+01             1.1648e-04        -0.607059789667

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.5895e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_001                -7.028507e-01 3 1  ON 0
ci_002                -7.017529e-01 3 1  ON 1
ci_003                -5.776428e-02 3 1  ON 2
ci_004                -5.798807e-02 3 1  ON 3
ci_005                 3.209673e-02 3 1  ON 4
ci_006                 3.231285e-02 3 1  ON 5
ci_007                 2.405560e-02 3 1  ON 6
ci_008                 2.454234e-02 3 1  ON 7
ci_009                -1.903594e-02 3 1  ON 8
ci_010                -1.904067e-02 3 1  ON 9
ci_011                -1.677002e-02 3 1  ON 10
ci_012                -1.637501e-02 3 1  ON 11
ci_013                 1.481958e-02 3 1  ON 12
ci_014                 1.469801e-02 3 1  ON 13
ci_015                 1.583513e-02 3 1  ON 14
ci_016                 1.575618e-02 3 1  ON 15
ci_017                 1.249551e-02 3 1  ON 16
ci_018                 1.252889e-02 3 1  ON 17
ci_019                 6.126248e-03 3 1  ON 18
ci_020                 6.869523e-03 3 1  ON 19
ci_021                -8.586237e-03 3 1  ON 20
ci_022                -9.005789e-03 3 1  ON 21
ci_023                 7.314633e-03 3 1  ON 22
ci_024                 7.078925e-03 3 1  ON 23
ci_025                 8.406283e-03 3 1  ON 24
ci_026                 8.665301e-03 3 1  ON 25
ci_027                 7.066676e-03 3 1  ON 26
ci_028                 7.151469e-03 3 1  ON 27
ci_029                -6.367027e-03 3 1  ON 28
ci_030                -6.483304e-03 3 1  ON 29
ci_031                -4.455413e-03 3 1  ON 30
ci_032                -4.672925e-03 3 1  ON 31
ci_033                 5.509518e-03 3 1  ON 32
ci_034                 5.408138e-03 3 1  ON 33
ci_035                 4.354164e-03 3 1  ON 34
ci_036                 4.358714e-03 3 1  ON 35
ci_037                 5.339007e-03 3 1  ON 36
ci_038                 5.362687e-03 3 1  ON 37
ci_039                 4.941746e-03 3 1  ON 38
ci_040                 4.927432e-03 3 1  ON 39
ci_041                 4.286176e-03 3 1  ON 40
ci_042                 4.299883e-03 3 1  ON 41
ci_043                 4.548112e-03 3 1  ON 42
ci_044                 4.387579e-03 3 1  ON 43
ci_045                 3.899652e-03 3 1  ON 44
ci_046                 3.989108e-03 3 1  ON 45
ci_047                -2.640263e-03 3 1  ON 46
ci_048                -2.799476e-03 3 1  ON 47
ci_049                 2.291277e-03 3 1  ON 48
ci_050                 2.265273e-03 3 1  ON 49
ci_051                -2.517127e-03 3 1  ON 50
ci_052                -2.490078e-03 3 1  ON 51
ci_053                -2.442761e-03 3 1  ON 52
ci_054                -2.558199e-03 3 1  ON 53
ci_055                -1.553184e-03 3 1  ON 54
ci_056                -1.948210e-03 3 1  ON 55
ci_057                -1.438123e-03 3 1  ON 56
ci_058                -1.801932e-03 3 1  ON 57
ci_059                -1.156291e-03 3 1  ON 58
ci_060                -1.172763e-03 3 1  ON 59
ci_061                -1.211084e-03 3 1  ON 60
ci_062                -1.059038e-03 3 1  ON 61
ci_063                -9.445442e-04 3 1  ON 62
ci_064                -8.129069e-04 3 1  ON 63
ci_065                -1.590791e-03 3 1  ON 64
ci_066                -1.839620e-03 3 1  ON 65
ci_067                -1.504270e-03 3 1  ON 66
ci_068                -1.155575e-03 3 1  ON 67
ci_069                 5.137603e-04 3 1  ON 68
ci_070                 6.372802e-04 3 1  ON 69
ci_071                -1.700659e-03 3 1  ON 70
ci_072                -1.610766e-03 3 1  ON 71
ci_073                 6.592178e-04 3 1  ON 72
ci_074                 9.545296e-04 3 1  ON 73
ci_075                -6.726182e-04 3 1  ON 74
ci_076                -6.030261e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4649e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2689e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7239
    reference variance = 0.326015
====================================================
  Execution time = 5.1282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.4616e-01
  Total weights = 1.955086589e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507664965564
                                         uncertainty =       0.007264901966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507664965564
                                         uncertainty =       0.007264901966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503738256
  error estimate for blocks of size 2^( 2) =       0.000521855033
  error estimate for blocks of size 2^( 3) =       0.000538348466
  error estimate for blocks of size 2^( 4) =       0.000549090364
  error estimate for blocks of size 2^( 5) =       0.000557167052
  error estimate for blocks of size 2^( 6) =       0.000560588823
  error estimate for blocks of size 2^( 7) =       0.000563571011

      target function =      -0.596343736637
              le_mean =     -22.665871216179
             les_mean =     514.287874612381
             stat err =       0.000557604313
             autocorr =       1.225299844992
   target nu stat err =       0.000557604313
   target dn stat err =       0.023353112177
      target stat err =       0.006735662375
              std dev =       0.712393474166
             le_variance =       0.507504462034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266587121618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.596419191687       residual = 3.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.596939461653       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.596995988118       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.597005251911       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.597007476748       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.597008128693       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.597008260688       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.597008266096       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.597008258423       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.597008275437       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.597008274178       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 2.013123e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.596419191687       residual = 3.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.596558824963       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.596573574612       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.596575893274       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.596576427489       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.596576577580       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.596576605321       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.596576606216       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.596576604495       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.596576608452       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.596576608040       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 5.410533e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.596419191687       residual = 3.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.596454753062       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.596458480451       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.596459059753       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.596459191736       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.596459228413       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.596459235022       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.596459235218       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.596459234802       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.596459235770       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.596459235663       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.378455e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.520373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0649e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_001                -7.029935e-01 3 1  ON 0
ci_002                -7.017631e-01 3 1  ON 1
ci_003                -5.737786e-02 3 1  ON 2
ci_004                -5.785462e-02 3 1  ON 3
ci_005                 3.161506e-02 3 1  ON 4
ci_006                 3.177180e-02 3 1  ON 5
ci_007                 2.392071e-02 3 1  ON 6
ci_008                 2.432298e-02 3 1  ON 7
ci_009                -1.880471e-02 3 1  ON 8
ci_010                -1.874299e-02 3 1  ON 9
ci_011                -1.671611e-02 3 1  ON 10
ci_012                -1.614633e-02 3 1  ON 11
ci_013                 1.449519e-02 3 1  ON 12
ci_014                 1.450080e-02 3 1  ON 13
ci_015                 1.568379e-02 3 1  ON 14
ci_016                 1.563082e-02 3 1  ON 15
ci_017                 1.236019e-02 3 1  ON 16
ci_018                 1.255354e-02 3 1  ON 17
ci_019                 5.962681e-03 3 1  ON 18
ci_020                 6.887020e-03 3 1  ON 19
ci_021                -8.517487e-03 3 1  ON 20
ci_022                -9.181656e-03 3 1  ON 21
ci_023                 7.280290e-03 3 1  ON 22
ci_024                 7.054665e-03 3 1  ON 23
ci_025                 8.397784e-03 3 1  ON 24
ci_026                 8.732744e-03 3 1  ON 25
ci_027                 6.976374e-03 3 1  ON 26
ci_028                 7.161972e-03 3 1  ON 27
ci_029                -6.334653e-03 3 1  ON 28
ci_030                -6.392668e-03 3 1  ON 29
ci_031                -4.362220e-03 3 1  ON 30
ci_032                -4.472976e-03 3 1  ON 31
ci_033                 5.498591e-03 3 1  ON 32
ci_034                 5.360927e-03 3 1  ON 33
ci_035                 4.067278e-03 3 1  ON 34
ci_036                 4.283736e-03 3 1  ON 35
ci_037                 5.248940e-03 3 1  ON 36
ci_038                 5.248315e-03 3 1  ON 37
ci_039                 4.909627e-03 3 1  ON 38
ci_040                 4.911173e-03 3 1  ON 39
ci_041                 4.273117e-03 3 1  ON 40
ci_042                 4.322798e-03 3 1  ON 41
ci_043                 4.587388e-03 3 1  ON 42
ci_044                 4.329853e-03 3 1  ON 43
ci_045                 3.878010e-03 3 1  ON 44
ci_046                 3.895171e-03 3 1  ON 45
ci_047                -2.614533e-03 3 1  ON 46
ci_048                -2.669831e-03 3 1  ON 47
ci_049                 2.271764e-03 3 1  ON 48
ci_050                 2.180647e-03 3 1  ON 49
ci_051                -2.507445e-03 3 1  ON 50
ci_052                -2.431724e-03 3 1  ON 51
ci_053                -2.223800e-03 3 1  ON 52
ci_054                -2.526156e-03 3 1  ON 53
ci_055                -1.541477e-03 3 1  ON 54
ci_056                -1.927214e-03 3 1  ON 55
ci_057                -1.409347e-03 3 1  ON 56
ci_058                -1.793429e-03 3 1  ON 57
ci_059                -1.222956e-03 3 1  ON 58
ci_060                -1.100180e-03 3 1  ON 59
ci_061                -1.229464e-03 3 1  ON 60
ci_062                -1.000097e-03 3 1  ON 61
ci_063                -9.366782e-04 3 1  ON 62
ci_064                -1.010070e-03 3 1  ON 63
ci_065                -1.572469e-03 3 1  ON 64
ci_066                -1.850728e-03 3 1  ON 65
ci_067                -1.538877e-03 3 1  ON 66
ci_068                -1.126599e-03 3 1  ON 67
ci_069                 3.829900e-04 3 1  ON 68
ci_070                 6.485473e-04 3 1  ON 69
ci_071                -1.756451e-03 3 1  ON 70
ci_072                -1.617676e-03 3 1  ON 71
ci_073                 7.451460e-04 3 1  ON 72
ci_074                 9.236994e-04 3 1  ON 73
ci_075                -6.048935e-04 3 1  ON 74
ci_076                -5.722790e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6468
    reference variance = 0.400212
====================================================
  Execution time = 4.9746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0572e-01
  Total weights = 1.9548e+06
  Execution time = 7.2380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491546384259
                                         uncertainty =       0.002585082775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491546384259
                                         uncertainty =       0.002585082775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495736439
  error estimate for blocks of size 2^( 2) =       0.000514372791
  error estimate for blocks of size 2^( 3) =       0.000530937786
  error estimate for blocks of size 2^( 4) =       0.000543099144
  error estimate for blocks of size 2^( 5) =       0.000550188962
  error estimate for blocks of size 2^( 6) =       0.000553860614
  error estimate for blocks of size 2^( 7) =       0.000557289637

      target function =      -0.607914433798
              le_mean =     -22.665613180245
             les_mean =     514.236832309381
             stat err =       0.000551109589
             autocorr =       1.235874151621
   target nu stat err =       0.000551109589
   target dn stat err =       0.003345944347
      target stat err =       0.001037853601
              std dev =       0.701077196078
             le_variance =       0.491509234861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500159104893
                                         uncertainty =       0.010730505778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500159104893
                                         uncertainty =       0.010730505778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500079855
  error estimate for blocks of size 2^( 2) =       0.000518505583
  error estimate for blocks of size 2^( 3) =       0.000534967432
  error estimate for blocks of size 2^( 4) =       0.000547049135
  error estimate for blocks of size 2^( 5) =       0.000554142506
  error estimate for blocks of size 2^( 6) =       0.000557660036
  error estimate for blocks of size 2^( 7) =       0.000561466683

      target function =      -0.188119098187
              le_mean =     -22.665548172435
             les_mean =     517.100377556349
             stat err =       0.000555079590
             autocorr =       1.232059829786
   target nu stat err =       0.000555079590
   target dn stat err =       2.856815486297
      target stat err =       0.109741171607
              std dev =       0.707219713313
             le_variance =       0.500159722899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490405061433
                                         uncertainty =       0.002571316098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490405061433
                                         uncertainty =       0.002571316098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495160601
  error estimate for blocks of size 2^( 2) =       0.000513772834
  error estimate for blocks of size 2^( 3) =       0.000530323557
  error estimate for blocks of size 2^( 4) =       0.000542485249
  error estimate for blocks of size 2^( 5) =       0.000549559773
  error estimate for blocks of size 2^( 6) =       0.000553221631
  error estimate for blocks of size 2^( 7) =       0.000556652829

      target function =      -0.608064214666
              le_mean =     -22.665610737288
             les_mean =     514.236219090204
             stat err =       0.000550479870
             autocorr =       1.235921029445
   target nu stat err =       0.000550479870
   target dn stat err =       0.003434739444
      target stat err =       0.001063961410
              std dev =       0.700262838002
             le_variance =       0.490368042286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491391332906
                                         uncertainty =       0.002583156280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491391332906
                                         uncertainty =       0.002583156280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495658252
  error estimate for blocks of size 2^( 2) =       0.000514291535
  error estimate for blocks of size 2^( 3) =       0.000530854764
  error estimate for blocks of size 2^( 4) =       0.000543016430
  error estimate for blocks of size 2^( 5) =       0.000550103977
  error estimate for blocks of size 2^( 6) =       0.000553774009
  error estimate for blocks of size 2^( 7) =       0.000557203490

      target function =      -0.608077136762
              le_mean =     -22.665611351831
             les_mean =     514.236204647487
             stat err =       0.000551024477
             autocorr =       1.235882261789
   target nu stat err =       0.000551024477
   target dn stat err =       0.003334572600
      target stat err =       0.001035090151
              std dev =       0.700966622624
             le_variance =       0.491354206033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607914433798        initial
     3.9062e-01     3.9062e+00             2.0131e-03        -0.188119098187
     1.5625e+00     1.5625e+01             5.4105e-04        -0.608064214666
     6.2500e+00     6.2500e+01             1.3785e-04        -0.608077136762  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.6060e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_001                -7.028868e-01 3 1  ON 0
ci_002                -7.017556e-01 3 1  ON 1
ci_003                -5.766697e-02 3 1  ON 2
ci_004                -5.795446e-02 3 1  ON 3
ci_005                 3.197406e-02 3 1  ON 4
ci_006                 3.217501e-02 3 1  ON 5
ci_007                 2.402136e-02 3 1  ON 6
ci_008                 2.448667e-02 3 1  ON 7
ci_009                -1.897718e-02 3 1  ON 8
ci_010                -1.896500e-02 3 1  ON 9
ci_011                -1.675630e-02 3 1  ON 10
ci_012                -1.631692e-02 3 1  ON 11
ci_013                 1.473716e-02 3 1  ON 12
ci_014                 1.464794e-02 3 1  ON 13
ci_015                 1.579680e-02 3 1  ON 14
ci_016                 1.572441e-02 3 1  ON 15
ci_017                 1.246112e-02 3 1  ON 16
ci_018                 1.253519e-02 3 1  ON 17
ci_019                 6.084793e-03 3 1  ON 18
ci_020                 6.874049e-03 3 1  ON 19
ci_021                -8.568762e-03 3 1  ON 20
ci_022                -9.050488e-03 3 1  ON 21
ci_023                 7.305868e-03 3 1  ON 22
ci_024                 7.072762e-03 3 1  ON 23
ci_025                 8.404076e-03 3 1  ON 24
ci_026                 8.682488e-03 3 1  ON 25
ci_027                 7.043644e-03 3 1  ON 26
ci_028                 7.154134e-03 3 1  ON 27
ci_029                -6.358848e-03 3 1  ON 28
ci_030                -6.460300e-03 3 1  ON 29
ci_031                -4.431771e-03 3 1  ON 30
ci_032                -4.622235e-03 3 1  ON 31
ci_033                 5.506752e-03 3 1  ON 32
ci_034                 5.396194e-03 3 1  ON 33
ci_035                 4.280969e-03 3 1  ON 34
ci_036                 4.339618e-03 3 1  ON 35
ci_037                 5.316191e-03 3 1  ON 36
ci_038                 5.333622e-03 3 1  ON 37
ci_039                 4.933542e-03 3 1  ON 38
ci_040                 4.923263e-03 3 1  ON 39
ci_041                 4.282842e-03 3 1  ON 40
ci_042                 4.305732e-03 3 1  ON 41
ci_043                 4.558125e-03 3 1  ON 42
ci_044                 4.372934e-03 3 1  ON 43
ci_045                 3.894131e-03 3 1  ON 44
ci_046                 3.965199e-03 3 1  ON 45
ci_047                -2.633758e-03 3 1  ON 46
ci_048                -2.766417e-03 3 1  ON 47
ci_049                 2.286329e-03 3 1  ON 48
ci_050                 2.243753e-03 3 1  ON 49
ci_051                -2.514713e-03 3 1  ON 50
ci_052                -2.475271e-03 3 1  ON 51
ci_053                -2.387056e-03 3 1  ON 52
ci_054                -2.550014e-03 3 1  ON 53
ci_055                -1.550216e-03 3 1  ON 54
ci_056                -1.942893e-03 3 1  ON 55
ci_057                -1.430794e-03 3 1  ON 56
ci_058                -1.799771e-03 3 1  ON 57
ci_059                -1.173326e-03 3 1  ON 58
ci_060                -1.154272e-03 3 1  ON 59
ci_061                -1.215773e-03 3 1  ON 60
ci_062                -1.044050e-03 3 1  ON 61
ci_063                -9.425148e-04 3 1  ON 62
ci_064                -8.630440e-04 3 1  ON 63
ci_065                -1.586160e-03 3 1  ON 64
ci_066                -1.842452e-03 3 1  ON 65
ci_067                -1.513056e-03 3 1  ON 66
ci_068                -1.148164e-03 3 1  ON 67
ci_069                 4.804817e-04 3 1  ON 68
ci_070                 6.401477e-04 3 1  ON 69
ci_071                -1.714854e-03 3 1  ON 70
ci_072                -1.612531e-03 3 1  ON 71
ci_073                 6.811646e-04 3 1  ON 72
ci_074                 9.467042e-04 3 1  ON 73
ci_075                -6.553806e-04 3 1  ON 74
ci_076                -5.952111e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4672e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2689e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7344
    reference variance = 0.385887
====================================================
  Execution time = 5.1737e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0956e-01
  Total weights = 1.954708956e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496169660523
                                         uncertainty =       0.002639535810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496169660523
                                         uncertainty =       0.002639535810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498063401
  error estimate for blocks of size 2^( 2) =       0.000516329529
  error estimate for blocks of size 2^( 3) =       0.000532368106
  error estimate for blocks of size 2^( 4) =       0.000544481115
  error estimate for blocks of size 2^( 5) =       0.000552596092
  error estimate for blocks of size 2^( 6) =       0.000555546022
  error estimate for blocks of size 2^( 7) =       0.000557299522

      target function =      -0.607168712558
              le_mean =     -22.665921796594
             les_mean =     514.253567778165
             stat err =       0.000552480688
             autocorr =       1.230452756182
   target nu stat err =       0.000552480688
   target dn stat err =       0.003912094725
      target stat err =       0.001199852187
              std dev =       0.704368016762
             le_variance =       0.496134303037


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266592179659e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607170781783       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607255446672       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607263930085       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607264551001       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607264682722       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607264713631       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607264731121       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607264733056       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607264732318       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 4.570622e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607170781783       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607192334693       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607194476547       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607194631990       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607194664633       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607194672196       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607194676469       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607194676937       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607194676753       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.164429e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607170781783       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607176194728       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607176731513       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607176770385       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607176778527       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607176780407       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607176781469       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607176781585       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607176781539       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.925002e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.524963 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1162e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_001                -7.029074e-01 3 1  ON 0
ci_002                -7.017678e-01 3 1  ON 1
ci_003                -5.764193e-02 3 1  ON 2
ci_004                -5.791798e-02 3 1  ON 3
ci_005                 3.187113e-02 3 1  ON 4
ci_006                 3.205856e-02 3 1  ON 5
ci_007                 2.395922e-02 3 1  ON 6
ci_008                 2.441427e-02 3 1  ON 7
ci_009                -1.892645e-02 3 1  ON 8
ci_010                -1.891325e-02 3 1  ON 9
ci_011                -1.670909e-02 3 1  ON 10
ci_012                -1.625995e-02 3 1  ON 11
ci_013                 1.469479e-02 3 1  ON 12
ci_014                 1.459732e-02 3 1  ON 13
ci_015                 1.575749e-02 3 1  ON 14
ci_016                 1.568506e-02 3 1  ON 15
ci_017                 1.243237e-02 3 1  ON 16
ci_018                 1.250582e-02 3 1  ON 17
ci_019                 6.044497e-03 3 1  ON 18
ci_020                 6.823402e-03 3 1  ON 19
ci_021                -8.557820e-03 3 1  ON 20
ci_022                -9.042839e-03 3 1  ON 21
ci_023                 7.293752e-03 3 1  ON 22
ci_024                 7.054238e-03 3 1  ON 23
ci_025                 8.410111e-03 3 1  ON 24
ci_026                 8.685208e-03 3 1  ON 25
ci_027                 7.036125e-03 3 1  ON 26
ci_028                 7.148055e-03 3 1  ON 27
ci_029                -6.344151e-03 3 1  ON 28
ci_030                -6.445196e-03 3 1  ON 29
ci_031                -4.406017e-03 3 1  ON 30
ci_032                -4.604990e-03 3 1  ON 31
ci_033                 5.494049e-03 3 1  ON 32
ci_034                 5.380300e-03 3 1  ON 33
ci_035                 4.259436e-03 3 1  ON 34
ci_036                 4.324598e-03 3 1  ON 35
ci_037                 5.313479e-03 3 1  ON 36
ci_038                 5.320705e-03 3 1  ON 37
ci_039                 4.929942e-03 3 1  ON 38
ci_040                 4.916140e-03 3 1  ON 39
ci_041                 4.277187e-03 3 1  ON 40
ci_042                 4.294118e-03 3 1  ON 41
ci_043                 4.558312e-03 3 1  ON 42
ci_044                 4.360076e-03 3 1  ON 43
ci_045                 3.882110e-03 3 1  ON 44
ci_046                 3.962095e-03 3 1  ON 45
ci_047                -2.621704e-03 3 1  ON 46
ci_048                -2.750911e-03 3 1  ON 47
ci_049                 2.279255e-03 3 1  ON 48
ci_050                 2.235185e-03 3 1  ON 49
ci_051                -2.501521e-03 3 1  ON 50
ci_052                -2.468275e-03 3 1  ON 51
ci_053                -2.385041e-03 3 1  ON 52
ci_054                -2.548594e-03 3 1  ON 53
ci_055                -1.552767e-03 3 1  ON 54
ci_056                -1.936308e-03 3 1  ON 55
ci_057                -1.429509e-03 3 1  ON 56
ci_058                -1.789677e-03 3 1  ON 57
ci_059                -1.168576e-03 3 1  ON 58
ci_060                -1.153582e-03 3 1  ON 59
ci_061                -1.216371e-03 3 1  ON 60
ci_062                -1.049548e-03 3 1  ON 61
ci_063                -9.409055e-04 3 1  ON 62
ci_064                -8.703248e-04 3 1  ON 63
ci_065                -1.594729e-03 3 1  ON 64
ci_066                -1.845733e-03 3 1  ON 65
ci_067                -1.510945e-03 3 1  ON 66
ci_068                -1.152542e-03 3 1  ON 67
ci_069                 4.873155e-04 3 1  ON 68
ci_070                 6.363926e-04 3 1  ON 69
ci_071                -1.722357e-03 3 1  ON 70
ci_072                -1.611164e-03 3 1  ON 71
ci_073                 6.765336e-04 3 1  ON 72
ci_074                 9.354998e-04 3 1  ON 73
ci_075                -6.580185e-04 3 1  ON 74
ci_076                -5.859330e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.6909
    reference variance = 0.466885
====================================================
  Execution time = 4.9622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0580e-01
  Total weights = 1.9548e+06
  Execution time = 7.2474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491123396185
                                         uncertainty =       0.002961599089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491123396185
                                         uncertainty =       0.002961599089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495502283
  error estimate for blocks of size 2^( 2) =       0.000513906379
  error estimate for blocks of size 2^( 3) =       0.000530841682
  error estimate for blocks of size 2^( 4) =       0.000543174208
  error estimate for blocks of size 2^( 5) =       0.000550363971
  error estimate for blocks of size 2^( 6) =       0.000553551117
  error estimate for blocks of size 2^( 7) =       0.000553808321

      target function =      -0.608353946108
              le_mean =     -22.666528161769
             les_mean =     514.277587969387
             stat err =       0.000550224404
             autocorr =       1.233071837097
   target nu stat err =       0.000550224404
   target dn stat err =       0.005505232649
      target stat err =       0.001673961158
              std dev =       0.700746048323
             le_variance =       0.491045024240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490609648379
                                         uncertainty =       0.002956758604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490609648379
                                         uncertainty =       0.002956758604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495243021
  error estimate for blocks of size 2^( 2) =       0.000513635956
  error estimate for blocks of size 2^( 3) =       0.000530560257
  error estimate for blocks of size 2^( 4) =       0.000542880884
  error estimate for blocks of size 2^( 5) =       0.000550063682
  error estimate for blocks of size 2^( 6) =       0.000553247564
  error estimate for blocks of size 2^( 7) =       0.000553497102

      target function =      -0.608584494764
              le_mean =     -22.666529251789
             les_mean =     514.276871442405
             stat err =       0.000549922308
             autocorr =       1.233008148412
   target nu stat err =       0.000549922308
   target dn stat err =       0.005268885358
      target stat err =       0.001605199421
              std dev =       0.700379396933
             le_variance =       0.490531299649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490858865344
                                         uncertainty =       0.002959063403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490858865344
                                         uncertainty =       0.002959063403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495368806
  error estimate for blocks of size 2^( 2) =       0.000513767187
  error estimate for blocks of size 2^( 3) =       0.000530696707
  error estimate for blocks of size 2^( 4) =       0.000543023219
  error estimate for blocks of size 2^( 5) =       0.000550209496
  error estimate for blocks of size 2^( 6) =       0.000553394933
  error estimate for blocks of size 2^( 7) =       0.000553648647

      target function =      -0.608516508577
              le_mean =     -22.666528166647
             les_mean =     514.277047232794
             stat err =       0.000550069074
             autocorr =       1.233039948845
   target nu stat err =       0.000550069074
   target dn stat err =       0.005376309551
      target stat err =       0.001636651206
              std dev =       0.700557283215
             le_variance =       0.490780507066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491089818843
                                         uncertainty =       0.002961271238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491089818843
                                         uncertainty =       0.002961271238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495485342
  error estimate for blocks of size 2^( 2) =       0.000513888714
  error estimate for blocks of size 2^( 3) =       0.000530823290
  error estimate for blocks of size 2^( 4) =       0.000543155038
  error estimate for blocks of size 2^( 5) =       0.000550344340
  error estimate for blocks of size 2^( 6) =       0.000553531341
  error estimate for blocks of size 2^( 7) =       0.000553788073

      target function =      -0.608229521858
              le_mean =     -22.666528091197
             les_mean =     514.277999404587
             stat err =       0.000550204698
             autocorr =       1.233067826452
   target nu stat err =       0.000550204698
   target dn stat err =       0.005520485505
      target stat err =       0.001677798181
              std dev =       0.700722090964
             le_variance =       0.491011448765


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.608353946108        initial
     1.5625e+00     1.5625e+01             4.5706e-04        -0.608584494764  <--
     6.2500e+00     6.2500e+01             1.1644e-04        -0.608516508577
     2.5000e+01     2.5000e+02             2.9250e-05        -0.608229521858

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.5963e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_001                -7.029682e-01 3 1  ON 0
ci_002                -7.018035e-01 3 1  ON 1
ci_003                -5.756774e-02 3 1  ON 2
ci_004                -5.780965e-02 3 1  ON 3
ci_005                 3.156999e-02 3 1  ON 4
ci_006                 3.171794e-02 3 1  ON 5
ci_007                 2.377685e-02 3 1  ON 6
ci_008                 2.420170e-02 3 1  ON 7
ci_009                -1.877758e-02 3 1  ON 8
ci_010                -1.876147e-02 3 1  ON 9
ci_011                -1.657036e-02 3 1  ON 10
ci_012                -1.609271e-02 3 1  ON 11
ci_013                 1.457035e-02 3 1  ON 12
ci_014                 1.444882e-02 3 1  ON 13
ci_015                 1.564179e-02 3 1  ON 14
ci_016                 1.556930e-02 3 1  ON 15
ci_017                 1.234796e-02 3 1  ON 16
ci_018                 1.241958e-02 3 1  ON 17
ci_019                 5.925691e-03 3 1  ON 18
ci_020                 6.674288e-03 3 1  ON 19
ci_021                -8.525661e-03 3 1  ON 20
ci_022                -9.020335e-03 3 1  ON 21
ci_023                 7.258265e-03 3 1  ON 22
ci_024                 7.000010e-03 3 1  ON 23
ci_025                 8.428053e-03 3 1  ON 24
ci_026                 8.693417e-03 3 1  ON 25
ci_027                 7.014174e-03 3 1  ON 26
ci_028                 7.130314e-03 3 1  ON 27
ci_029                -6.300850e-03 3 1  ON 28
ci_030                -6.400707e-03 3 1  ON 29
ci_031                -4.330307e-03 3 1  ON 30
ci_032                -4.554320e-03 3 1  ON 31
ci_033                 5.456724e-03 3 1  ON 32
ci_034                 5.333544e-03 3 1  ON 33
ci_035                 4.196411e-03 3 1  ON 34
ci_036                 4.280556e-03 3 1  ON 35
ci_037                 5.305371e-03 3 1  ON 36
ci_038                 5.282676e-03 3 1  ON 37
ci_039                 4.919495e-03 3 1  ON 38
ci_040                 4.895371e-03 3 1  ON 39
ci_041                 4.260632e-03 3 1  ON 40
ci_042                 4.260130e-03 3 1  ON 41
ci_043                 4.558792e-03 3 1  ON 42
ci_044                 4.322174e-03 3 1  ON 43
ci_045                 3.846875e-03 3 1  ON 44
ci_046                 3.953110e-03 3 1  ON 45
ci_047                -2.586343e-03 3 1  ON 46
ci_048                -2.705502e-03 3 1  ON 47
ci_049                 2.258472e-03 3 1  ON 48
ci_050                 2.210055e-03 3 1  ON 49
ci_051                -2.462571e-03 3 1  ON 50
ci_052                -2.447570e-03 3 1  ON 51
ci_053                -2.379332e-03 3 1  ON 52
ci_054                -2.544500e-03 3 1  ON 53
ci_055                -1.560303e-03 3 1  ON 54
ci_056                -1.917033e-03 3 1  ON 55
ci_057                -1.425720e-03 3 1  ON 56
ci_058                -1.760099e-03 3 1  ON 57
ci_059                -1.154687e-03 3 1  ON 58
ci_060                -1.151476e-03 3 1  ON 59
ci_061                -1.218104e-03 3 1  ON 60
ci_062                -1.065680e-03 3 1  ON 61
ci_063                -9.363069e-04 3 1  ON 62
ci_064                -8.916558e-04 3 1  ON 63
ci_065                -1.619868e-03 3 1  ON 64
ci_066                -1.855344e-03 3 1  ON 65
ci_067                -1.504741e-03 3 1  ON 66
ci_068                -1.165478e-03 3 1  ON 67
ci_069                 5.073434e-04 3 1  ON 68
ci_070                 6.253294e-04 3 1  ON 69
ci_071                -1.744336e-03 3 1  ON 70
ci_072                -1.607045e-03 3 1  ON 71
ci_073                 6.629723e-04 3 1  ON 72
ci_074                 9.027503e-04 3 1  ON 73
ci_075                -6.657577e-04 3 1  ON 74
ci_076                -5.586894e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4713e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2690e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7499
    reference variance = 0.383631
====================================================
  Execution time = 5.1247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0720e-01
  Total weights = 1.954882992e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494100811190
                                         uncertainty =       0.002756128850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494100811190
                                         uncertainty =       0.002756128850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497018620
  error estimate for blocks of size 2^( 2) =       0.000515481448
  error estimate for blocks of size 2^( 3) =       0.000532861332
  error estimate for blocks of size 2^( 4) =       0.000544661102
  error estimate for blocks of size 2^( 5) =       0.000552491247
  error estimate for blocks of size 2^( 6) =       0.000555786765
  error estimate for blocks of size 2^( 7) =       0.000556474407

      target function =      -0.608073590354
              le_mean =     -22.666733977856
             les_mean =     514.288030951892
             stat err =       0.000552353380
             autocorr =       1.235061871190
   target nu stat err =       0.000552353380
   target dn stat err =       0.003582903079
      target stat err =       0.001108202070
              std dev =       0.702890472723
             le_variance =       0.494055016645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266673397786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608075317537       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608350730699       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608377028202       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608379898477       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608380447989       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608380649587       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608380748067       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608380765328       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608380770821       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.508758e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608075317537       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608149124384       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608155953354       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608156675898       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608156809691       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608156856399       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608156878892       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608156882725       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608156883965       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 4.052274e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608075317537       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608094106975       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608095830539       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608096011361       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608096044541       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608096055968       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608096061453       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608096062381       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608096062683       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.032238e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.529382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0637e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_001                -7.030397e-01 3 1  ON 0
ci_002                -7.018515e-01 3 1  ON 1
ci_003                -5.741394e-02 3 1  ON 2
ci_004                -5.769614e-02 3 1  ON 3
ci_005                 3.116616e-02 3 1  ON 4
ci_006                 3.131272e-02 3 1  ON 5
ci_007                 2.352652e-02 3 1  ON 6
ci_008                 2.395115e-02 3 1  ON 7
ci_009                -1.857840e-02 3 1  ON 8
ci_010                -1.856617e-02 3 1  ON 9
ci_011                -1.637975e-02 3 1  ON 10
ci_012                -1.594858e-02 3 1  ON 11
ci_013                 1.442696e-02 3 1  ON 12
ci_014                 1.430646e-02 3 1  ON 13
ci_015                 1.547856e-02 3 1  ON 14
ci_016                 1.546336e-02 3 1  ON 15
ci_017                 1.225926e-02 3 1  ON 16
ci_018                 1.231288e-02 3 1  ON 17
ci_019                 5.764966e-03 3 1  ON 18
ci_020                 6.493957e-03 3 1  ON 19
ci_021                -8.509402e-03 3 1  ON 20
ci_022                -9.012374e-03 3 1  ON 21
ci_023                 7.224335e-03 3 1  ON 22
ci_024                 6.969842e-03 3 1  ON 23
ci_025                 8.490672e-03 3 1  ON 24
ci_026                 8.725212e-03 3 1  ON 25
ci_027                 7.010857e-03 3 1  ON 26
ci_028                 7.092465e-03 3 1  ON 27
ci_029                -6.234463e-03 3 1  ON 28
ci_030                -6.335258e-03 3 1  ON 29
ci_031                -4.164544e-03 3 1  ON 30
ci_032                -4.433842e-03 3 1  ON 31
ci_033                 5.396706e-03 3 1  ON 32
ci_034                 5.283353e-03 3 1  ON 33
ci_035                 4.106173e-03 3 1  ON 34
ci_036                 4.199001e-03 3 1  ON 35
ci_037                 5.261057e-03 3 1  ON 36
ci_038                 5.227120e-03 3 1  ON 37
ci_039                 4.897705e-03 3 1  ON 38
ci_040                 4.890697e-03 3 1  ON 39
ci_041                 4.236284e-03 3 1  ON 40
ci_042                 4.230950e-03 3 1  ON 41
ci_043                 4.562205e-03 3 1  ON 42
ci_044                 4.298414e-03 3 1  ON 43
ci_045                 3.828158e-03 3 1  ON 44
ci_046                 3.886438e-03 3 1  ON 45
ci_047                -2.560333e-03 3 1  ON 46
ci_048                -2.668901e-03 3 1  ON 47
ci_049                 2.223863e-03 3 1  ON 48
ci_050                 2.168222e-03 3 1  ON 49
ci_051                -2.488540e-03 3 1  ON 50
ci_052                -2.414856e-03 3 1  ON 51
ci_053                -2.392385e-03 3 1  ON 52
ci_054                -2.563269e-03 3 1  ON 53
ci_055                -1.549598e-03 3 1  ON 54
ci_056                -1.935077e-03 3 1  ON 55
ci_057                -1.410861e-03 3 1  ON 56
ci_058                -1.731660e-03 3 1  ON 57
ci_059                -1.141565e-03 3 1  ON 58
ci_060                -1.143845e-03 3 1  ON 59
ci_061                -1.204948e-03 3 1  ON 60
ci_062                -1.050772e-03 3 1  ON 61
ci_063                -9.358860e-04 3 1  ON 62
ci_064                -9.042883e-04 3 1  ON 63
ci_065                -1.649682e-03 3 1  ON 64
ci_066                -1.881628e-03 3 1  ON 65
ci_067                -1.514557e-03 3 1  ON 66
ci_068                -1.189523e-03 3 1  ON 67
ci_069                 5.001792e-04 3 1  ON 68
ci_070                 6.062511e-04 3 1  ON 69
ci_071                -1.797585e-03 3 1  ON 70
ci_072                -1.601364e-03 3 1  ON 71
ci_073                 6.458078e-04 3 1  ON 72
ci_074                 8.714794e-04 3 1  ON 73
ci_075                -6.479543e-04 3 1  ON 74
ci_076                -5.413006e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7099
    reference variance = 0.536082
====================================================
  Execution time = 4.9656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0324e-01
  Total weights = 1.9546e+06
  Execution time = 7.2206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492355680784
                                         uncertainty =       0.002831706056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492355680784
                                         uncertainty =       0.002831706056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496175505
  error estimate for blocks of size 2^( 2) =       0.000514576281
  error estimate for blocks of size 2^( 3) =       0.000531408748
  error estimate for blocks of size 2^( 4) =       0.000543140243
  error estimate for blocks of size 2^( 5) =       0.000550829578
  error estimate for blocks of size 2^( 6) =       0.000555746335
  error estimate for blocks of size 2^( 7) =       0.000556405302

      target function =      -0.604018124413
              le_mean =     -22.666033094923
             les_mean =     514.269177896172
             stat err =       0.000551530365
             autocorr =       1.235572444001
   target nu stat err =       0.000551530365
   target dn stat err =       0.016620177135
      target stat err =       0.004921698196
              std dev =       0.701698128804
             le_variance =       0.492380263968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490782469401
                                         uncertainty =       0.002824860108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490782469401
                                         uncertainty =       0.002824860108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495381118
  error estimate for blocks of size 2^( 2) =       0.000513765647
  error estimate for blocks of size 2^( 3) =       0.000530556477
  error estimate for blocks of size 2^( 4) =       0.000542268952
  error estimate for blocks of size 2^( 5) =       0.000549927085
  error estimate for blocks of size 2^( 6) =       0.000554836052
  error estimate for blocks of size 2^( 7) =       0.000555526722

      target function =      -0.608187092273
              le_mean =     -22.666044446344
             les_mean =     514.255823612699
             stat err =       0.000550639703
             autocorr =       1.235538112459
   target nu stat err =       0.000550639703
   target dn stat err =       0.004414318661
      target stat err =       0.001350790551
              std dev =       0.700574695191
             le_variance =       0.490804903542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491473437420
                                         uncertainty =       0.002826512110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491473437420
                                         uncertainty =       0.002826512110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495730198
  error estimate for blocks of size 2^( 2) =       0.000514120996
  error estimate for blocks of size 2^( 3) =       0.000530930531
  error estimate for blocks of size 2^( 4) =       0.000542651129
  error estimate for blocks of size 2^( 5) =       0.000550323107
  error estimate for blocks of size 2^( 6) =       0.000555235897
  error estimate for blocks of size 2^( 7) =       0.000555911575

      target function =      -0.609202547008
              le_mean =     -22.666033402484
             les_mean =     514.251935325738
             stat err =       0.000551030427
             autocorr =       1.235550243012
   target nu stat err =       0.000551030427
   target dn stat err =       0.003551959145
      target stat err =       0.001102383551
              std dev =       0.701068369395
             le_variance =       0.491496858566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492237311311
                                         uncertainty =       0.002830868922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492237311311
                                         uncertainty =       0.002830868922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496115786
  error estimate for blocks of size 2^( 2) =       0.000514515257
  error estimate for blocks of size 2^( 3) =       0.000531343914
  error estimate for blocks of size 2^( 4) =       0.000543075398
  error estimate for blocks of size 2^( 5) =       0.000550761331
  error estimate for blocks of size 2^( 6) =       0.000555680439
  error estimate for blocks of size 2^( 7) =       0.000556343428

      target function =      -0.608592205660
              le_mean =     -22.666033225057
             les_mean =     514.253957781457
             stat err =       0.000551465149
             autocorr =       1.235577670156
   target nu stat err =       0.000551465149
   target dn stat err =       0.003749819576
      target stat err =       0.001157935690
              std dev =       0.701613672552
             le_variance =       0.492261745512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.604018124413        initial
     3.9062e-01     3.9062e+00             1.5088e-03        -0.608187092273
     1.5625e+00     1.5625e+01             4.0523e-04        -0.609202547008  <--
     6.2500e+00     6.2500e+01             1.0322e-04        -0.608592205660

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.5880e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_001                -7.030397e-01 3 1  ON 0
ci_002                -7.018515e-01 3 1  ON 1
ci_003                -5.741394e-02 3 1  ON 2
ci_004                -5.769614e-02 3 1  ON 3
ci_005                 3.116616e-02 3 1  ON 4
ci_006                 3.131272e-02 3 1  ON 5
ci_007                 2.352652e-02 3 1  ON 6
ci_008                 2.395115e-02 3 1  ON 7
ci_009                -1.857840e-02 3 1  ON 8
ci_010                -1.856617e-02 3 1  ON 9
ci_011                -1.637975e-02 3 1  ON 10
ci_012                -1.594858e-02 3 1  ON 11
ci_013                 1.442696e-02 3 1  ON 12
ci_014                 1.430646e-02 3 1  ON 13
ci_015                 1.547856e-02 3 1  ON 14
ci_016                 1.546336e-02 3 1  ON 15
ci_017                 1.225926e-02 3 1  ON 16
ci_018                 1.231288e-02 3 1  ON 17
ci_019                 5.764966e-03 3 1  ON 18
ci_020                 6.493957e-03 3 1  ON 19
ci_021                -8.509402e-03 3 1  ON 20
ci_022                -9.012374e-03 3 1  ON 21
ci_023                 7.224335e-03 3 1  ON 22
ci_024                 6.969842e-03 3 1  ON 23
ci_025                 8.490672e-03 3 1  ON 24
ci_026                 8.725212e-03 3 1  ON 25
ci_027                 7.010857e-03 3 1  ON 26
ci_028                 7.092465e-03 3 1  ON 27
ci_029                -6.234463e-03 3 1  ON 28
ci_030                -6.335258e-03 3 1  ON 29
ci_031                -4.164544e-03 3 1  ON 30
ci_032                -4.433842e-03 3 1  ON 31
ci_033                 5.396706e-03 3 1  ON 32
ci_034                 5.283353e-03 3 1  ON 33
ci_035                 4.106173e-03 3 1  ON 34
ci_036                 4.199001e-03 3 1  ON 35
ci_037                 5.261057e-03 3 1  ON 36
ci_038                 5.227120e-03 3 1  ON 37
ci_039                 4.897705e-03 3 1  ON 38
ci_040                 4.890697e-03 3 1  ON 39
ci_041                 4.236284e-03 3 1  ON 40
ci_042                 4.230950e-03 3 1  ON 41
ci_043                 4.562205e-03 3 1  ON 42
ci_044                 4.298414e-03 3 1  ON 43
ci_045                 3.828158e-03 3 1  ON 44
ci_046                 3.886438e-03 3 1  ON 45
ci_047                -2.560333e-03 3 1  ON 46
ci_048                -2.668901e-03 3 1  ON 47
ci_049                 2.223863e-03 3 1  ON 48
ci_050                 2.168222e-03 3 1  ON 49
ci_051                -2.488540e-03 3 1  ON 50
ci_052                -2.414856e-03 3 1  ON 51
ci_053                -2.392385e-03 3 1  ON 52
ci_054                -2.563269e-03 3 1  ON 53
ci_055                -1.549598e-03 3 1  ON 54
ci_056                -1.935077e-03 3 1  ON 55
ci_057                -1.410861e-03 3 1  ON 56
ci_058                -1.731660e-03 3 1  ON 57
ci_059                -1.141565e-03 3 1  ON 58
ci_060                -1.143845e-03 3 1  ON 59
ci_061                -1.204948e-03 3 1  ON 60
ci_062                -1.050772e-03 3 1  ON 61
ci_063                -9.358860e-04 3 1  ON 62
ci_064                -9.042883e-04 3 1  ON 63
ci_065                -1.649682e-03 3 1  ON 64
ci_066                -1.881628e-03 3 1  ON 65
ci_067                -1.514557e-03 3 1  ON 66
ci_068                -1.189523e-03 3 1  ON 67
ci_069                 5.001792e-04 3 1  ON 68
ci_070                 6.062511e-04 3 1  ON 69
ci_071                -1.797585e-03 3 1  ON 70
ci_072                -1.601364e-03 3 1  ON 71
ci_073                 6.458078e-04 3 1  ON 72
ci_074                 8.714794e-04 3 1  ON 73
ci_075                -6.479543e-04 3 1  ON 74
ci_076                -5.413006e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4652e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2691e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.5716
    reference variance = 0.507263
====================================================
  Execution time = 5.1993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0616e-01
  Total weights = 1.954794670e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491001920259
                                         uncertainty =       0.002966398697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491001920259
                                         uncertainty =       0.002966398697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495436144
  error estimate for blocks of size 2^( 2) =       0.000513708110
  error estimate for blocks of size 2^( 3) =       0.000529652979
  error estimate for blocks of size 2^( 4) =       0.000542706960
  error estimate for blocks of size 2^( 5) =       0.000550120097
  error estimate for blocks of size 2^( 6) =       0.000554346066
  error estimate for blocks of size 2^( 7) =       0.000556729677

      target function =      -0.608225180195
              le_mean =     -22.666081252172
             les_mean =     514.257397454954
             stat err =       0.000550975700
             autocorr =       1.236771634400
   target nu stat err =       0.000550975700
   target dn stat err =       0.003857157643
      target stat err =       0.001187871683
              std dev =       0.700652514629
             le_variance =       0.490913946256


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266608125217e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608227174134       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608513219883       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608540164840       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608543510491       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608544593877       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608544912804       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608544969332       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608544959590       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608544979828       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608544974378       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608544973819       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.590689e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608227174134       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608303873022       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608310891532       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608311731923       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608311994923       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608312067120       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608312077085       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608312074386       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608312078898       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608312077467       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608312077354       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 4.273126e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608227174134       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608246702772       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608248475632       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608248685813       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608248750975       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608248768526       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608248770762       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608248770075       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608248771169       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608248770809       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608248770783       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.088556e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.535663 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1343e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_001                -7.032084e-01 3 1  ON 0
ci_002                -7.018079e-01 3 1  ON 1
ci_003                -5.723136e-02 3 1  ON 2
ci_004                -5.754518e-02 3 1  ON 3
ci_005                 3.076332e-02 3 1  ON 4
ci_006                 3.088540e-02 3 1  ON 5
ci_007                 2.328047e-02 3 1  ON 6
ci_008                 2.369673e-02 3 1  ON 7
ci_009                -1.841930e-02 3 1  ON 8
ci_010                -1.834588e-02 3 1  ON 9
ci_011                -1.616590e-02 3 1  ON 10
ci_012                -1.578306e-02 3 1  ON 11
ci_013                 1.425801e-02 3 1  ON 12
ci_014                 1.415474e-02 3 1  ON 13
ci_015                 1.537039e-02 3 1  ON 14
ci_016                 1.535863e-02 3 1  ON 15
ci_017                 1.213947e-02 3 1  ON 16
ci_018                 1.227909e-02 3 1  ON 17
ci_019                 5.692035e-03 3 1  ON 18
ci_020                 6.344119e-03 3 1  ON 19
ci_021                -8.464974e-03 3 1  ON 20
ci_022                -8.935539e-03 3 1  ON 21
ci_023                 7.179775e-03 3 1  ON 22
ci_024                 6.944465e-03 3 1  ON 23
ci_025                 8.529852e-03 3 1  ON 24
ci_026                 8.709425e-03 3 1  ON 25
ci_027                 6.971971e-03 3 1  ON 26
ci_028                 7.078280e-03 3 1  ON 27
ci_029                -6.219486e-03 3 1  ON 28
ci_030                -6.286186e-03 3 1  ON 29
ci_031                -3.996937e-03 3 1  ON 30
ci_032                -4.281397e-03 3 1  ON 31
ci_033                 5.352496e-03 3 1  ON 32
ci_034                 5.220659e-03 3 1  ON 33
ci_035                 4.023519e-03 3 1  ON 34
ci_036                 4.134227e-03 3 1  ON 35
ci_037                 5.236496e-03 3 1  ON 36
ci_038                 5.180725e-03 3 1  ON 37
ci_039                 4.895096e-03 3 1  ON 38
ci_040                 4.885673e-03 3 1  ON 39
ci_041                 4.213743e-03 3 1  ON 40
ci_042                 4.180092e-03 3 1  ON 41
ci_043                 4.497962e-03 3 1  ON 42
ci_044                 4.310082e-03 3 1  ON 43
ci_045                 3.766320e-03 3 1  ON 44
ci_046                 3.856008e-03 3 1  ON 45
ci_047                -2.523945e-03 3 1  ON 46
ci_048                -2.607185e-03 3 1  ON 47
ci_049                 2.193152e-03 3 1  ON 48
ci_050                 2.104828e-03 3 1  ON 49
ci_051                -2.523880e-03 3 1  ON 50
ci_052                -2.386584e-03 3 1  ON 51
ci_053                -2.386636e-03 3 1  ON 52
ci_054                -2.556014e-03 3 1  ON 53
ci_055                -1.574441e-03 3 1  ON 54
ci_056                -1.901580e-03 3 1  ON 55
ci_057                -1.410374e-03 3 1  ON 56
ci_058                -1.739830e-03 3 1  ON 57
ci_059                -1.134095e-03 3 1  ON 58
ci_060                -1.121697e-03 3 1  ON 59
ci_061                -1.239245e-03 3 1  ON 60
ci_062                -9.889057e-04 3 1  ON 61
ci_063                -9.256120e-04 3 1  ON 62
ci_064                -9.101834e-04 3 1  ON 63
ci_065                -1.658566e-03 3 1  ON 64
ci_066                -1.920908e-03 3 1  ON 65
ci_067                -1.512181e-03 3 1  ON 66
ci_068                -1.173853e-03 3 1  ON 67
ci_069                 4.594699e-04 3 1  ON 68
ci_070                 5.783039e-04 3 1  ON 69
ci_071                -1.786758e-03 3 1  ON 70
ci_072                -1.614911e-03 3 1  ON 71
ci_073                 6.420314e-04 3 1  ON 72
ci_074                 8.364408e-04 3 1  ON 73
ci_075                -6.297588e-04 3 1  ON 74
ci_076                -5.229291e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7567
    reference variance = 0.737325
====================================================
  Execution time = 4.9660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0578e-01
  Total weights = 1.9550e+06
  Execution time = 7.2225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494753448682
                                         uncertainty =       0.002899011078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494753448682
                                         uncertainty =       0.002899011078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497347297
  error estimate for blocks of size 2^( 2) =       0.000515854514
  error estimate for blocks of size 2^( 3) =       0.000532338497
  error estimate for blocks of size 2^( 4) =       0.000544942084
  error estimate for blocks of size 2^( 5) =       0.000553147274
  error estimate for blocks of size 2^( 6) =       0.000554957737
  error estimate for blocks of size 2^( 7) =       0.000556830265

      target function =      -0.595982606671
              le_mean =     -22.667893832850
             les_mean =     514.382001544497
             stat err =       0.000552469340
             autocorr =       1.233947946056
   target nu stat err =       0.000552469340
   target dn stat err =       0.037412222891
      target stat err =       0.010792146155
              std dev =       0.703355292241
             le_variance =       0.494708667124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493152091795
                                         uncertainty =       0.002882094505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493152091795
                                         uncertainty =       0.002882094505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496541325
  error estimate for blocks of size 2^( 2) =       0.000515014152
  error estimate for blocks of size 2^( 3) =       0.000531464848
  error estimate for blocks of size 2^( 4) =       0.000544036923
  error estimate for blocks of size 2^( 5) =       0.000552245607
  error estimate for blocks of size 2^( 6) =       0.000554047538
  error estimate for blocks of size 2^( 7) =       0.000555861597

      target function =      -0.608877982486
              le_mean =     -22.667902391327
             les_mean =     514.339282460843
             stat err =       0.000551547916
             autocorr =       1.233831059248
   target nu stat err =       0.000551547916
   target dn stat err =       0.003653845428
      target stat err =       0.001132710734
              std dev =       0.702215476264
             le_variance =       0.493106575104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493854930133
                                         uncertainty =       0.002889572492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493854930133
                                         uncertainty =       0.002889572492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496895242
  error estimate for blocks of size 2^( 2) =       0.000515383797
  error estimate for blocks of size 2^( 3) =       0.000531847827
  error estimate for blocks of size 2^( 4) =       0.000544433670
  error estimate for blocks of size 2^( 5) =       0.000552641860
  error estimate for blocks of size 2^( 6) =       0.000554446692
  error estimate for blocks of size 2^( 7) =       0.000556296551

      target function =      -0.608642139314
              le_mean =     -22.667891492242
             les_mean =     514.339563094984
             stat err =       0.000551954693
             autocorr =       1.233892102914
   target nu stat err =       0.000551954693
   target dn stat err =       0.003764208682
      target stat err =       0.001164129636
              std dev =       0.702715990292
             le_variance =       0.493809763013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494628041980
                                         uncertainty =       0.002897665424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494628041980
                                         uncertainty =       0.002897665424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497284227
  error estimate for blocks of size 2^( 2) =       0.000515790090
  error estimate for blocks of size 2^( 3) =       0.000532269905
  error estimate for blocks of size 2^( 4) =       0.000544870589
  error estimate for blocks of size 2^( 5) =       0.000553078423
  error estimate for blocks of size 2^( 6) =       0.000554890910
  error estimate for blocks of size 2^( 7) =       0.000556765606

      target function =      -0.608470248485
              le_mean =     -22.667891020886
             les_mean =     514.340113333019
             stat err =       0.000552401382
             autocorr =       1.233957334178
   target nu stat err =       0.000552401382
   target dn stat err =       0.003731742605
      target stat err =       0.001154059852
              std dev =       0.703266098720
             le_variance =       0.494583205608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.595982606671        initial
     3.9062e-01     3.9062e+00             1.5907e-03        -0.608877982486  <--
     1.5625e+00     1.5625e+01             4.2731e-04        -0.608642139314
     6.2500e+00     6.2500e+01             1.0886e-04        -0.608470248485

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 8.5883e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_001                -7.036988e-01 3 1  ON 0
ci_002                -7.016643e-01 3 1  ON 1
ci_003                -5.670715e-02 3 1  ON 2
ci_004                -5.711003e-02 3 1  ON 3
ci_005                 2.966773e-02 3 1  ON 4
ci_006                 2.972203e-02 3 1  ON 5
ci_007                 2.260267e-02 3 1  ON 6
ci_008                 2.299384e-02 3 1  ON 7
ci_009                -1.798181e-02 3 1  ON 8
ci_010                -1.773872e-02 3 1  ON 9
ci_011                -1.557829e-02 3 1  ON 10
ci_012                -1.532621e-02 3 1  ON 11
ci_013                 1.379351e-02 3 1  ON 12
ci_014                 1.373516e-02 3 1  ON 13
ci_015                 1.506866e-02 3 1  ON 14
ci_016                 1.506623e-02 3 1  ON 15
ci_017                 1.180968e-02 3 1  ON 16
ci_018                 1.218372e-02 3 1  ON 17
ci_019                 5.486534e-03 3 1  ON 18
ci_020                 5.925705e-03 3 1  ON 19
ci_021                -8.342279e-03 3 1  ON 20
ci_022                -8.722716e-03 3 1  ON 21
ci_023                 7.059147e-03 3 1  ON 22
ci_024                 6.874866e-03 3 1  ON 23
ci_025                 8.640200e-03 3 1  ON 24
ci_026                 8.667464e-03 3 1  ON 25
ci_027                 6.867401e-03 3 1  ON 26
ci_028                 7.039902e-03 3 1  ON 27
ci_029                -6.176941e-03 3 1  ON 28
ci_030                -6.148162e-03 3 1  ON 29
ci_031                -3.533199e-03 3 1  ON 30
ci_032                -3.856857e-03 3 1  ON 31
ci_033                 5.230452e-03 3 1  ON 32
ci_034                 5.046795e-03 3 1  ON 33
ci_035                 3.799684e-03 3 1  ON 34
ci_036                 3.957228e-03 3 1  ON 35
ci_037                 5.167144e-03 3 1  ON 36
ci_038                 5.051644e-03 3 1  ON 37
ci_039                 4.889246e-03 3 1  ON 38
ci_040                 4.872072e-03 3 1  ON 39
ci_041                 4.152081e-03 3 1  ON 40
ci_042                 4.041926e-03 3 1  ON 41
ci_043                 4.322723e-03 3 1  ON 42
ci_044                 4.340125e-03 3 1  ON 43
ci_045                 3.596591e-03 3 1  ON 44
ci_046                 3.772964e-03 3 1  ON 45
ci_047                -2.422819e-03 3 1  ON 46
ci_048                -2.438167e-03 3 1  ON 47
ci_049                 2.107992e-03 3 1  ON 48
ci_050                 1.930733e-03 3 1  ON 49
ci_051                -2.619361e-03 3 1  ON 50
ci_052                -2.304703e-03 3 1  ON 51
ci_053                -2.371391e-03 3 1  ON 52
ci_054                -2.537281e-03 3 1  ON 53
ci_055                -1.643839e-03 3 1  ON 54
ci_056                -1.809814e-03 3 1  ON 55
ci_057                -1.409485e-03 3 1  ON 56
ci_058                -1.762182e-03 3 1  ON 57
ci_059                -1.112333e-03 3 1  ON 58
ci_060                -1.061686e-03 3 1  ON 59
ci_061                -1.331740e-03 3 1  ON 60
ci_062                -8.185246e-04 3 1  ON 61
ci_063                -8.975583e-04 3 1  ON 62
ci_064                -9.268939e-04 3 1  ON 63
ci_065                -1.682777e-03 3 1  ON 64
ci_066                -2.028342e-03 3 1  ON 65
ci_067                -1.505983e-03 3 1  ON 66
ci_068                -1.131893e-03 3 1  ON 67
ci_069                 3.489100e-04 3 1  ON 68
ci_070                 5.009914e-04 3 1  ON 69
ci_071                -1.755045e-03 3 1  ON 70
ci_072                -1.651136e-03 3 1  ON 71
ci_073                 6.288210e-04 3 1  ON 72
ci_074                 7.410096e-04 3 1  ON 73
ci_075                -5.782638e-04 3 1  ON 74
ci_076                -4.725705e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4723e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2690e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.5735
    reference variance = 0.774884
====================================================
  Execution time = 5.1341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 4.9993e-01
  Total weights = 1.955138012e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488985035642
                                         uncertainty =       0.002577072575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488985035642
                                         uncertainty =       0.002577072575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494436518
  error estimate for blocks of size 2^( 2) =       0.000513433900
  error estimate for blocks of size 2^( 3) =       0.000530604508
  error estimate for blocks of size 2^( 4) =       0.000542111784
  error estimate for blocks of size 2^( 5) =       0.000549326525
  error estimate for blocks of size 2^( 6) =       0.000553384887
  error estimate for blocks of size 2^( 7) =       0.000555487295

      target function =      -0.610351679876
              le_mean =     -22.667096250831
             les_mean =     514.297185933814
             stat err =       0.000550077623
             autocorr =       1.237732739146
   target nu stat err =       0.000550077623
   target dn stat err =       0.003035280766
      target stat err =       0.000956704665
              std dev =       0.699238828919
             le_variance =       0.488934939868


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266709625083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610352876630       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611085056636       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611175832971       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611186433046       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611190710943       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611191710294       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611192063739       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611192143393       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611192158739       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611192142191       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.611192154802       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 4.394756e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610352876630       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610585437913       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610611727486       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610614514488       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610615509569       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610615684583       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610615746138       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610615758396       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610615760644       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610615756120       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.610615757750       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.406936e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610352876630       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610415227024       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610422054690       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610422754854       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610422994600       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610423032849       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610423046438       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610423049044       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610423049529       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610423048429       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.610423048763       residual = 8.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.781810e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.541803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0745e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_001                -7.037077e-01 3 1  ON 0
ci_002                -7.020982e-01 3 1  ON 1
ci_003                -5.608446e-02 3 1  ON 2
ci_004                -5.635287e-02 3 1  ON 3
ci_005                 2.832047e-02 3 1  ON 4
ci_006                 2.831509e-02 3 1  ON 5
ci_007                 2.166202e-02 3 1  ON 6
ci_008                 2.215356e-02 3 1  ON 7
ci_009                -1.735215e-02 3 1  ON 8
ci_010                -1.707336e-02 3 1  ON 9
ci_011                -1.490696e-02 3 1  ON 10
ci_012                -1.473048e-02 3 1  ON 11
ci_013                 1.323249e-02 3 1  ON 12
ci_014                 1.309934e-02 3 1  ON 13
ci_015                 1.453441e-02 3 1  ON 14
ci_016                 1.436221e-02 3 1  ON 15
ci_017                 1.165738e-02 3 1  ON 16
ci_018                 1.186027e-02 3 1  ON 17
ci_019                 5.027413e-03 3 1  ON 18
ci_020                 5.200607e-03 3 1  ON 19
ci_021                -8.406865e-03 3 1  ON 20
ci_022                -8.473834e-03 3 1  ON 21
ci_023                 6.832857e-03 3 1  ON 22
ci_024                 6.836981e-03 3 1  ON 23
ci_025                 8.721193e-03 3 1  ON 24
ci_026                 8.670439e-03 3 1  ON 25
ci_027                 6.843980e-03 3 1  ON 26
ci_028                 6.930951e-03 3 1  ON 27
ci_029                -6.054272e-03 3 1  ON 28
ci_030                -6.005556e-03 3 1  ON 29
ci_031                -3.174174e-03 3 1  ON 30
ci_032                -3.455473e-03 3 1  ON 31
ci_033                 5.077155e-03 3 1  ON 32
ci_034                 4.987672e-03 3 1  ON 33
ci_035                 3.544613e-03 3 1  ON 34
ci_036                 3.758161e-03 3 1  ON 35
ci_037                 5.058724e-03 3 1  ON 36
ci_038                 5.007779e-03 3 1  ON 37
ci_039                 4.759130e-03 3 1  ON 38
ci_040                 4.801681e-03 3 1  ON 39
ci_041                 4.016105e-03 3 1  ON 40
ci_042                 3.922739e-03 3 1  ON 41
ci_043                 4.129715e-03 3 1  ON 42
ci_044                 4.146256e-03 3 1  ON 43
ci_045                 3.557678e-03 3 1  ON 44
ci_046                 3.557784e-03 3 1  ON 45
ci_047                -2.209250e-03 3 1  ON 46
ci_048                -2.272052e-03 3 1  ON 47
ci_049                 1.985811e-03 3 1  ON 48
ci_050                 1.900426e-03 3 1  ON 49
ci_051                -2.453024e-03 3 1  ON 50
ci_052                -2.222480e-03 3 1  ON 51
ci_053                -2.329517e-03 3 1  ON 52
ci_054                -2.602175e-03 3 1  ON 53
ci_055                -1.538557e-03 3 1  ON 54
ci_056                -1.706995e-03 3 1  ON 55
ci_057                -1.412410e-03 3 1  ON 56
ci_058                -1.565792e-03 3 1  ON 57
ci_059                -1.049004e-03 3 1  ON 58
ci_060                -1.013563e-03 3 1  ON 59
ci_061                -1.369749e-03 3 1  ON 60
ci_062                -7.837761e-04 3 1  ON 61
ci_063                -8.134955e-04 3 1  ON 62
ci_064                -8.662186e-04 3 1  ON 63
ci_065                -1.728849e-03 3 1  ON 64
ci_066                -1.964739e-03 3 1  ON 65
ci_067                -1.454921e-03 3 1  ON 66
ci_068                -1.143720e-03 3 1  ON 67
ci_069                 3.358416e-04 3 1  ON 68
ci_070                 3.023693e-04 3 1  ON 69
ci_071                -1.783106e-03 3 1  ON 70
ci_072                -1.702518e-03 3 1  ON 71
ci_073                 6.795232e-04 3 1  ON 72
ci_074                 5.965712e-04 3 1  ON 73
ci_075                -5.046039e-04 3 1  ON 74
ci_076                -4.164652e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6449
    reference variance = 0.335608
====================================================
  Execution time = 4.9686e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0022e-01
  Total weights = 1.9545e+06
  Execution time = 7.2461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489767795202
                                         uncertainty =       0.002888875227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489767795202
                                         uncertainty =       0.002888875227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494791133
  error estimate for blocks of size 2^( 2) =       0.000513437373
  error estimate for blocks of size 2^( 3) =       0.000530256610
  error estimate for blocks of size 2^( 4) =       0.000541745642
  error estimate for blocks of size 2^( 5) =       0.000547863558
  error estimate for blocks of size 2^( 6) =       0.000552238647
  error estimate for blocks of size 2^( 7) =       0.000555576585

      target function =      -0.609222897515
              le_mean =     -22.667563316484
             les_mean =     514.322482765573
             stat err =       0.000549356108
             autocorr =       1.232719024697
   target nu stat err =       0.000549356108
   target dn stat err =       0.004364469353
      target stat err =       0.001342140609
              std dev =       0.699740330948
             le_variance =       0.489636530755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486154759653
                                         uncertainty =       0.002858004988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486154759653
                                         uncertainty =       0.002858004988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492964832
  error estimate for blocks of size 2^( 2) =       0.000511568206
  error estimate for blocks of size 2^( 3) =       0.000528321049
  error estimate for blocks of size 2^( 4) =       0.000539743444
  error estimate for blocks of size 2^( 5) =       0.000545721335
  error estimate for blocks of size 2^( 6) =       0.000550021334
  error estimate for blocks of size 2^( 7) =       0.000553438689

      target function =      -0.588508011819
              le_mean =     -22.667610725373
             les_mean =     514.394245862769
             stat err =       0.000547231200
             autocorr =       1.232281210028
   target nu stat err =       0.000547231200
   target dn stat err =       0.058582345755
      target stat err =       0.016478512379
              std dev =       0.697157550675
             le_variance =       0.486028650464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487103189120
                                         uncertainty =       0.002867064912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487103189120
                                         uncertainty =       0.002867064912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493444677
  error estimate for blocks of size 2^( 2) =       0.000512057204
  error estimate for blocks of size 2^( 3) =       0.000528832836
  error estimate for blocks of size 2^( 4) =       0.000540295993
  error estimate for blocks of size 2^( 5) =       0.000546337651
  error estimate for blocks of size 2^( 6) =       0.000550664426
  error estimate for blocks of size 2^( 7) =       0.000554039387

      target function =      -0.610009684438
              le_mean =     -22.667546293413
             les_mean =     514.319087990800
             stat err =       0.000547834364
             autocorr =       1.232598414695
   target nu stat err =       0.000547834364
   target dn stat err =       0.004297364417
      target stat err =       0.001325528894
              std dev =       0.697836154883
             le_variance =       0.486975299062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489339729882
                                         uncertainty =       0.002885309172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489339729882
                                         uncertainty =       0.002885309172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494575089
  error estimate for blocks of size 2^( 2) =       0.000513216068
  error estimate for blocks of size 2^( 3) =       0.000530027457
  error estimate for blocks of size 2^( 4) =       0.000541511793
  error estimate for blocks of size 2^( 5) =       0.000547618731
  error estimate for blocks of size 2^( 6) =       0.000551984938
  error estimate for blocks of size 2^( 7) =       0.000555316408

      target function =      -0.609058450279
              le_mean =     -22.667550682482
             les_mean =     514.322443213902
             stat err =       0.000549107968
             autocorr =       1.232681886720
   target nu stat err =       0.000549107968
   target dn stat err =       0.004934519921
      target stat err =       0.001509824761
              std dev =       0.699434799024
             le_variance =       0.489209038086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609222897515        initial
     9.7656e-02     9.7656e-01             4.3948e-03        -0.588508011819
     3.9062e-01     3.9062e+00             1.4069e-03        -0.610009684438  <--
     1.5625e+00     1.5625e+01             3.7818e-04        -0.609058450279

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 8.6027e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_001                -7.037077e-01 3 1  ON 0
ci_002                -7.020982e-01 3 1  ON 1
ci_003                -5.608446e-02 3 1  ON 2
ci_004                -5.635287e-02 3 1  ON 3
ci_005                 2.832047e-02 3 1  ON 4
ci_006                 2.831509e-02 3 1  ON 5
ci_007                 2.166202e-02 3 1  ON 6
ci_008                 2.215356e-02 3 1  ON 7
ci_009                -1.735215e-02 3 1  ON 8
ci_010                -1.707336e-02 3 1  ON 9
ci_011                -1.490696e-02 3 1  ON 10
ci_012                -1.473048e-02 3 1  ON 11
ci_013                 1.323249e-02 3 1  ON 12
ci_014                 1.309934e-02 3 1  ON 13
ci_015                 1.453441e-02 3 1  ON 14
ci_016                 1.436221e-02 3 1  ON 15
ci_017                 1.165738e-02 3 1  ON 16
ci_018                 1.186027e-02 3 1  ON 17
ci_019                 5.027413e-03 3 1  ON 18
ci_020                 5.200607e-03 3 1  ON 19
ci_021                -8.406865e-03 3 1  ON 20
ci_022                -8.473834e-03 3 1  ON 21
ci_023                 6.832857e-03 3 1  ON 22
ci_024                 6.836981e-03 3 1  ON 23
ci_025                 8.721193e-03 3 1  ON 24
ci_026                 8.670439e-03 3 1  ON 25
ci_027                 6.843980e-03 3 1  ON 26
ci_028                 6.930951e-03 3 1  ON 27
ci_029                -6.054272e-03 3 1  ON 28
ci_030                -6.005556e-03 3 1  ON 29
ci_031                -3.174174e-03 3 1  ON 30
ci_032                -3.455473e-03 3 1  ON 31
ci_033                 5.077155e-03 3 1  ON 32
ci_034                 4.987672e-03 3 1  ON 33
ci_035                 3.544613e-03 3 1  ON 34
ci_036                 3.758161e-03 3 1  ON 35
ci_037                 5.058724e-03 3 1  ON 36
ci_038                 5.007779e-03 3 1  ON 37
ci_039                 4.759130e-03 3 1  ON 38
ci_040                 4.801681e-03 3 1  ON 39
ci_041                 4.016105e-03 3 1  ON 40
ci_042                 3.922739e-03 3 1  ON 41
ci_043                 4.129715e-03 3 1  ON 42
ci_044                 4.146256e-03 3 1  ON 43
ci_045                 3.557678e-03 3 1  ON 44
ci_046                 3.557784e-03 3 1  ON 45
ci_047                -2.209250e-03 3 1  ON 46
ci_048                -2.272052e-03 3 1  ON 47
ci_049                 1.985811e-03 3 1  ON 48
ci_050                 1.900426e-03 3 1  ON 49
ci_051                -2.453024e-03 3 1  ON 50
ci_052                -2.222480e-03 3 1  ON 51
ci_053                -2.329517e-03 3 1  ON 52
ci_054                -2.602175e-03 3 1  ON 53
ci_055                -1.538557e-03 3 1  ON 54
ci_056                -1.706995e-03 3 1  ON 55
ci_057                -1.412410e-03 3 1  ON 56
ci_058                -1.565792e-03 3 1  ON 57
ci_059                -1.049004e-03 3 1  ON 58
ci_060                -1.013563e-03 3 1  ON 59
ci_061                -1.369749e-03 3 1  ON 60
ci_062                -7.837761e-04 3 1  ON 61
ci_063                -8.134955e-04 3 1  ON 62
ci_064                -8.662186e-04 3 1  ON 63
ci_065                -1.728849e-03 3 1  ON 64
ci_066                -1.964739e-03 3 1  ON 65
ci_067                -1.454921e-03 3 1  ON 66
ci_068                -1.143720e-03 3 1  ON 67
ci_069                 3.358416e-04 3 1  ON 68
ci_070                 3.023693e-04 3 1  ON 69
ci_071                -1.783106e-03 3 1  ON 70
ci_072                -1.702518e-03 3 1  ON 71
ci_073                 6.795232e-04 3 1  ON 72
ci_074                 5.965712e-04 3 1  ON 73
ci_075                -5.046039e-04 3 1  ON 74
ci_076                -4.164652e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4678e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6511
    reference variance = 0.343869
====================================================
  Execution time = 5.1780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0256e-01
  Total weights = 1.954866586e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491425159088
                                         uncertainty =       0.003456884478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491425159088
                                         uncertainty =       0.003456884478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495678155
  error estimate for blocks of size 2^( 2) =       0.000513800219
  error estimate for blocks of size 2^( 3) =       0.000530243404
  error estimate for blocks of size 2^( 4) =       0.000542410397
  error estimate for blocks of size 2^( 5) =       0.000549383231
  error estimate for blocks of size 2^( 6) =       0.000553243537
  error estimate for blocks of size 2^( 7) =       0.000557942472

      target function =      -0.609478435423
              le_mean =     -22.666776173002
             les_mean =     514.285302777974
             stat err =       0.000550744909
             autocorr =       1.234529362819
   target nu stat err =       0.000550744909
   target dn stat err =       0.003833851330
      target stat err =       0.001186455925
              std dev =       0.700994769471
             le_variance =       0.491393666825


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266677617300e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609480468462       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610087687004       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610154943117       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610163348326       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610166558613       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610167197826       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610167554615       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610167659520       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610167699028       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610167726772       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.610167726252       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.610167722279       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 3.914331e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609480468462       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609673966033       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609693444488       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609695692847       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609696482279       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609696587184       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609696648826       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609696666333       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609696674116       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609696677927       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609696676374       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.250026e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609480468462       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609532404344       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609537462792       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609538031379       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609538225310       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609538247302       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609538260859       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609538264668       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609538266476       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609538267251       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609538266824       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.358038e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.548252 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1123e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_001                -7.040783e-01 3 1  ON 0
ci_002                -7.020938e-01 3 1  ON 1
ci_003                -5.555350e-02 3 1  ON 2
ci_004                -5.581310e-02 3 1  ON 3
ci_005                 2.711045e-02 3 1  ON 4
ci_006                 2.706507e-02 3 1  ON 5
ci_007                 2.091813e-02 3 1  ON 6
ci_008                 2.148079e-02 3 1  ON 7
ci_009                -1.669735e-02 3 1  ON 8
ci_010                -1.637430e-02 3 1  ON 9
ci_011                -1.438472e-02 3 1  ON 10
ci_012                -1.412649e-02 3 1  ON 11
ci_013                 1.264322e-02 3 1  ON 12
ci_014                 1.264604e-02 3 1  ON 13
ci_015                 1.407919e-02 3 1  ON 14
ci_016                 1.379769e-02 3 1  ON 15
ci_017                 1.136819e-02 3 1  ON 16
ci_018                 1.161540e-02 3 1  ON 17
ci_019                 4.722141e-03 3 1  ON 18
ci_020                 4.687071e-03 3 1  ON 19
ci_021                -8.152639e-03 3 1  ON 20
ci_022                -8.525657e-03 3 1  ON 21
ci_023                 6.713732e-03 3 1  ON 22
ci_024                 6.692808e-03 3 1  ON 23
ci_025                 8.611114e-03 3 1  ON 24
ci_026                 8.782231e-03 3 1  ON 25
ci_027                 6.732475e-03 3 1  ON 26
ci_028                 6.905769e-03 3 1  ON 27
ci_029                -5.883349e-03 3 1  ON 28
ci_030                -5.926192e-03 3 1  ON 29
ci_031                -2.776296e-03 3 1  ON 30
ci_032                -3.069461e-03 3 1  ON 31
ci_033                 4.957617e-03 3 1  ON 32
ci_034                 4.742934e-03 3 1  ON 33
ci_035                 3.330210e-03 3 1  ON 34
ci_036                 3.494808e-03 3 1  ON 35
ci_037                 4.968435e-03 3 1  ON 36
ci_038                 4.893802e-03 3 1  ON 37
ci_039                 4.758712e-03 3 1  ON 38
ci_040                 4.850515e-03 3 1  ON 39
ci_041                 3.885040e-03 3 1  ON 40
ci_042                 3.790891e-03 3 1  ON 41
ci_043                 4.036544e-03 3 1  ON 42
ci_044                 4.041039e-03 3 1  ON 43
ci_045                 3.441931e-03 3 1  ON 44
ci_046                 3.500072e-03 3 1  ON 45
ci_047                -2.089973e-03 3 1  ON 46
ci_048                -2.165241e-03 3 1  ON 47
ci_049                 1.866753e-03 3 1  ON 48
ci_050                 1.805350e-03 3 1  ON 49
ci_051                -2.376099e-03 3 1  ON 50
ci_052                -2.142215e-03 3 1  ON 51
ci_053                -2.308033e-03 3 1  ON 52
ci_054                -2.379672e-03 3 1  ON 53
ci_055                -1.544919e-03 3 1  ON 54
ci_056                -1.537568e-03 3 1  ON 55
ci_057                -1.427154e-03 3 1  ON 56
ci_058                -1.599476e-03 3 1  ON 57
ci_059                -1.017874e-03 3 1  ON 58
ci_060                -8.707704e-04 3 1  ON 59
ci_061                -1.233305e-03 3 1  ON 60
ci_062                -8.520605e-04 3 1  ON 61
ci_063                -8.044366e-04 3 1  ON 62
ci_064                -8.218472e-04 3 1  ON 63
ci_065                -1.691205e-03 3 1  ON 64
ci_066                -1.940666e-03 3 1  ON 65
ci_067                -1.474458e-03 3 1  ON 66
ci_068                -1.176973e-03 3 1  ON 67
ci_069                 2.862143e-04 3 1  ON 68
ci_070                 2.199531e-04 3 1  ON 69
ci_071                -1.773897e-03 3 1  ON 70
ci_072                -1.829276e-03 3 1  ON 71
ci_073                 6.519379e-04 3 1  ON 72
ci_074                 5.710227e-04 3 1  ON 73
ci_075                -3.529353e-04 3 1  ON 74
ci_076                -3.882948e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.606
    reference variance = 0.481299
====================================================
  Execution time = 4.9646e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0146e-01
  Total weights = 1.9548e+06
  Execution time = 7.2213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490053487840
                                         uncertainty =       0.003107130306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490053487840
                                         uncertainty =       0.003107130306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494975565
  error estimate for blocks of size 2^( 2) =       0.000514190412
  error estimate for blocks of size 2^( 3) =       0.000530635469
  error estimate for blocks of size 2^( 4) =       0.000542913773
  error estimate for blocks of size 2^( 5) =       0.000549489794
  error estimate for blocks of size 2^( 6) =       0.000553592052
  error estimate for blocks of size 2^( 7) =       0.000555698995

      target function =      -0.607281406701
              le_mean =     -22.667711782997
             les_mean =     514.335794129094
             stat err =       0.000550423653
             autocorr =       1.236592641305
   target nu stat err =       0.000550423653
   target dn stat err =       0.005992815440
      target stat err =       0.001813900096
              std dev =       0.700001156600
             le_variance =       0.490001619241

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0948128
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487944530715
                                         uncertainty =       0.003374822882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487944530715
                                         uncertainty =       0.003374822882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493908638
  error estimate for blocks of size 2^( 2) =       0.000513053658
  error estimate for blocks of size 2^( 3) =       0.000529462105
  error estimate for blocks of size 2^( 4) =       0.000541634338
  error estimate for blocks of size 2^( 5) =       0.000548186077
  error estimate for blocks of size 2^( 6) =       0.000552247981
  error estimate for blocks of size 2^( 7) =       0.000554350134

      target function =      -0.555191380912
              le_mean =     -22.667791387641
             les_mean =     514.518679884520
             stat err =       0.000549104633
             autocorr =       1.235995733565
   target nu stat err =       0.000549104633
   target dn stat err =       0.157193136433
      target stat err =       0.039521758446
              std dev =       0.698492294797
             le_variance =       0.487891485890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488038127422
                                         uncertainty =       0.003226101005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488038127422
                                         uncertainty =       0.003226101005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493957032
  error estimate for blocks of size 2^( 2) =       0.000513142245
  error estimate for blocks of size 2^( 3) =       0.000529572993
  error estimate for blocks of size 2^( 4) =       0.000541807875
  error estimate for blocks of size 2^( 5) =       0.000548367282
  error estimate for blocks of size 2^( 6) =       0.000552443602
  error estimate for blocks of size 2^( 7) =       0.000554544743

      target function =      -0.609748986719
              le_mean =     -22.667733584663
             les_mean =     514.328596029107
             stat err =       0.000549290876
             autocorr =       1.236591980359
   target nu stat err =       0.000549290876
   target dn stat err =       0.004561743073
      target stat err =       0.001402935619
              std dev =       0.698560733237
             le_variance =       0.487987098021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489716977786
                                         uncertainty =       0.003119548774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489716977786
                                         uncertainty =       0.003119548774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494805663
  error estimate for blocks of size 2^( 2) =       0.000514017494
  error estimate for blocks of size 2^( 3) =       0.000530458530
  error estimate for blocks of size 2^( 4) =       0.000542728529
  error estimate for blocks of size 2^( 5) =       0.000549308513
  error estimate for blocks of size 2^( 6) =       0.000553410651
  error estimate for blocks of size 2^( 7) =       0.000555515823

      target function =      -0.609756968138
              le_mean =     -22.667709786779
             les_mean =     514.327473941085
             stat err =       0.000550240879
             autocorr =       1.236620327245
   target nu stat err =       0.000550240879
   target dn stat err =       0.003875256820
      target stat err =       0.001200518582
              std dev =       0.699760879950
             le_variance =       0.489665289108


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607281406701        initial
     9.7656e-02     9.7656e-01             3.9143e-03        -0.555191380912
     3.9062e-01     3.9062e+00             1.2500e-03        -0.609748986719
     1.5625e+00     1.5625e+01             3.3580e-04        -0.609756968138  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.5849e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_001                -7.038032e-01 3 1  ON 0
ci_002                -7.020998e-01 3 1  ON 1
ci_003                -5.594753e-02 3 1  ON 2
ci_004                -5.621396e-02 3 1  ON 3
ci_005                 2.799460e-02 3 1  ON 4
ci_006                 2.797929e-02 3 1  ON 5
ci_007                 2.146427e-02 3 1  ON 6
ci_008                 2.197430e-02 3 1  ON 7
ci_009                -1.717754e-02 3 1  ON 8
ci_010                -1.688713e-02 3 1  ON 9
ci_011                -1.476783e-02 3 1  ON 10
ci_012                -1.456971e-02 3 1  ON 11
ci_013                 1.307595e-02 3 1  ON 12
ci_014                 1.297873e-02 3 1  ON 13
ci_015                 1.441430e-02 3 1  ON 14
ci_016                 1.421155e-02 3 1  ON 15
ci_017                 1.157981e-02 3 1  ON 16
ci_018                 1.179505e-02 3 1  ON 17
ci_019                 4.947932e-03 3 1  ON 18
ci_020                 5.065344e-03 3 1  ON 19
ci_021                -8.339391e-03 3 1  ON 20
ci_022                -8.487553e-03 3 1  ON 21
ci_023                 6.800848e-03 3 1  ON 22
ci_024                 6.798506e-03 3 1  ON 23
ci_025                 8.690919e-03 3 1  ON 24
ci_026                 8.699424e-03 3 1  ON 25
ci_027                 6.813689e-03 3 1  ON 26
ci_028                 6.924082e-03 3 1  ON 27
ci_029                -6.009193e-03 3 1  ON 28
ci_030                -5.984908e-03 3 1  ON 29
ci_031                -3.068800e-03 3 1  ON 30
ci_032                -3.353368e-03 3 1  ON 31
ci_033                 5.045475e-03 3 1  ON 32
ci_034                 4.922742e-03 3 1  ON 33
ci_035                 3.487173e-03 3 1  ON 34
ci_036                 3.687505e-03 3 1  ON 35
ci_037                 5.034685e-03 3 1  ON 36
ci_038                 4.977847e-03 3 1  ON 37
ci_039                 4.758971e-03 3 1  ON 38
ci_040                 4.814693e-03 3 1  ON 39
ci_041                 3.980895e-03 3 1  ON 40
ci_042                 3.887382e-03 3 1  ON 41
ci_043                 4.105263e-03 3 1  ON 42
ci_044                 4.118697e-03 3 1  ON 43
ci_045                 3.526880e-03 3 1  ON 44
ci_046                 3.542098e-03 3 1  ON 45
ci_047                -2.177527e-03 3 1  ON 46
ci_048                -2.243699e-03 3 1  ON 47
ci_049                 1.954345e-03 3 1  ON 48
ci_050                 1.875015e-03 3 1  ON 49
ci_051                -2.433678e-03 3 1  ON 50
ci_052                -2.201838e-03 3 1  ON 51
ci_053                -2.323557e-03 3 1  ON 52
ci_054                -2.542741e-03 3 1  ON 53
ci_055                -1.540174e-03 3 1  ON 54
ci_056                -1.661427e-03 3 1  ON 55
ci_057                -1.416532e-03 3 1  ON 56
ci_058                -1.574795e-03 3 1  ON 57
ci_059                -1.040912e-03 3 1  ON 58
ci_060                -9.751408e-04 3 1  ON 59
ci_061                -1.333112e-03 3 1  ON 60
ci_062                -8.018854e-04 3 1  ON 61
ci_063                -8.103771e-04 3 1  ON 62
ci_064                -8.540888e-04 3 1  ON 63
ci_065                -1.718922e-03 3 1  ON 64
ci_066                -1.958669e-03 3 1  ON 65
ci_067                -1.459985e-03 3 1  ON 66
ci_068                -1.152247e-03 3 1  ON 67
ci_069                 3.227364e-04 3 1  ON 68
ci_070                 2.804902e-04 3 1  ON 69
ci_071                -1.780588e-03 3 1  ON 70
ci_072                -1.736564e-03 3 1  ON 71
ci_073                 6.722062e-04 3 1  ON 72
ci_074                 5.898601e-04 3 1  ON 73
ci_075                -4.642798e-04 3 1  ON 74
ci_076                -4.090257e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4699e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7024
    reference variance = 0.624954
====================================================
  Execution time = 5.1067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0447e-01
  Total weights = 1.954784318e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492051581075
                                         uncertainty =       0.002799983865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492051581075
                                         uncertainty =       0.002799983865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496021940
  error estimate for blocks of size 2^( 2) =       0.000514681520
  error estimate for blocks of size 2^( 3) =       0.000531647911
  error estimate for blocks of size 2^( 4) =       0.000544229658
  error estimate for blocks of size 2^( 5) =       0.000552590327
  error estimate for blocks of size 2^( 6) =       0.000557209834
  error estimate for blocks of size 2^( 7) =       0.000559972387

      target function =      -0.608992182316
              le_mean =     -22.667136898619
             les_mean =     514.303566376595
             stat err =       0.000553500552
             autocorr =       1.245186323991
   target nu stat err =       0.000553500552
   target dn stat err =       0.004427823653
      target stat err =       0.001359760879
              std dev =       0.701480955330
             le_variance =       0.492075530691


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266713689862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608994921036       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609244515794       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609268382392       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609271279718       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609271928148       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609272090877       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609272088788       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609272102421       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609272095944       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.512944e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608994921036       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609062004558       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609068228502       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609068963841       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609069117022       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609069153294       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609069151781       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609069154806       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609069153296       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 4.081693e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608994921036       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609012012539       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609013585216       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609013769653       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609013807318       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609013816099       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609013815663       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609013816395       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609013816025       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 1.040999e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.559610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0401e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_001                -7.038674e-01 3 1  ON 0
ci_002                -7.021431e-01 3 1  ON 1
ci_003                -5.577140e-02 3 1  ON 2
ci_004                -5.606092e-02 3 1  ON 3
ci_005                 2.758643e-02 3 1  ON 4
ci_006                 2.767209e-02 3 1  ON 5
ci_007                 2.126610e-02 3 1  ON 6
ci_008                 2.173156e-02 3 1  ON 7
ci_009                -1.703066e-02 3 1  ON 8
ci_010                -1.674969e-02 3 1  ON 9
ci_011                -1.462901e-02 3 1  ON 10
ci_012                -1.442857e-02 3 1  ON 11
ci_013                 1.293555e-02 3 1  ON 12
ci_014                 1.283653e-02 3 1  ON 13
ci_015                 1.415909e-02 3 1  ON 14
ci_016                 1.409780e-02 3 1  ON 15
ci_017                 1.152040e-02 3 1  ON 16
ci_018                 1.165192e-02 3 1  ON 17
ci_019                 4.860612e-03 3 1  ON 18
ci_020                 4.979759e-03 3 1  ON 19
ci_021                -8.171552e-03 3 1  ON 20
ci_022                -8.480920e-03 3 1  ON 21
ci_023                 6.782146e-03 3 1  ON 22
ci_024                 6.742555e-03 3 1  ON 23
ci_025                 8.671355e-03 3 1  ON 24
ci_026                 8.670525e-03 3 1  ON 25
ci_027                 6.813478e-03 3 1  ON 26
ci_028                 6.920787e-03 3 1  ON 27
ci_029                -5.963674e-03 3 1  ON 28
ci_030                -5.950779e-03 3 1  ON 29
ci_031                -2.973073e-03 3 1  ON 30
ci_032                -3.259524e-03 3 1  ON 31
ci_033                 5.021843e-03 3 1  ON 32
ci_034                 4.837737e-03 3 1  ON 33
ci_035                 3.453053e-03 3 1  ON 34
ci_036                 3.636724e-03 3 1  ON 35
ci_037                 4.995496e-03 3 1  ON 36
ci_038                 4.920777e-03 3 1  ON 37
ci_039                 4.751405e-03 3 1  ON 38
ci_040                 4.797986e-03 3 1  ON 39
ci_041                 3.954328e-03 3 1  ON 40
ci_042                 3.851606e-03 3 1  ON 41
ci_043                 4.114869e-03 3 1  ON 42
ci_044                 4.092730e-03 3 1  ON 43
ci_045                 3.496015e-03 3 1  ON 44
ci_046                 3.504461e-03 3 1  ON 45
ci_047                -2.127155e-03 3 1  ON 46
ci_048                -2.217447e-03 3 1  ON 47
ci_049                 1.909349e-03 3 1  ON 48
ci_050                 1.793903e-03 3 1  ON 49
ci_051                -2.425850e-03 3 1  ON 50
ci_052                -2.109291e-03 3 1  ON 51
ci_053                -2.314814e-03 3 1  ON 52
ci_054                -2.514704e-03 3 1  ON 53
ci_055                -1.505799e-03 3 1  ON 54
ci_056                -1.651567e-03 3 1  ON 55
ci_057                -1.402571e-03 3 1  ON 56
ci_058                -1.568867e-03 3 1  ON 57
ci_059                -9.975641e-04 3 1  ON 58
ci_060                -9.659039e-04 3 1  ON 59
ci_061                -1.312814e-03 3 1  ON 60
ci_062                -7.686623e-04 3 1  ON 61
ci_063                -7.875315e-04 3 1  ON 62
ci_064                -8.606247e-04 3 1  ON 63
ci_065                -1.755316e-03 3 1  ON 64
ci_066                -1.954091e-03 3 1  ON 65
ci_067                -1.495881e-03 3 1  ON 66
ci_068                -1.162096e-03 3 1  ON 67
ci_069                 3.024148e-04 3 1  ON 68
ci_070                 2.551775e-04 3 1  ON 69
ci_071                -1.781681e-03 3 1  ON 70
ci_072                -1.725349e-03 3 1  ON 71
ci_073                 6.900671e-04 3 1  ON 72
ci_074                 5.887058e-04 3 1  ON 73
ci_075                -4.586621e-04 3 1  ON 74
ci_076                -3.955032e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7557
    reference variance = 0.679295
====================================================
  Execution time = 4.9452e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0598e-01
  Total weights = 1.9549e+06
  Execution time = 7.2362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492149036006
                                         uncertainty =       0.003212847973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492149036006
                                         uncertainty =       0.003212847973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496000423
  error estimate for blocks of size 2^( 2) =       0.000514301272
  error estimate for blocks of size 2^( 3) =       0.000530985135
  error estimate for blocks of size 2^( 4) =       0.000542589922
  error estimate for blocks of size 2^( 5) =       0.000549714940
  error estimate for blocks of size 2^( 6) =       0.000554244928
  error estimate for blocks of size 2^( 7) =       0.000556534897

      target function =      -0.607446823758
              le_mean =     -22.667694684280
             les_mean =     514.334455086222
             stat err =       0.000550771172
             autocorr =       1.233043239730
   target nu stat err =       0.000550771172
   target dn stat err =       0.005531123364
      target stat err =       0.001678312099
              std dev =       0.701450525624
             le_variance =       0.492032839898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490879120368
                                         uncertainty =       0.003181215597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490879120368
                                         uncertainty =       0.003181215597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495359676
  error estimate for blocks of size 2^( 2) =       0.000513653472
  error estimate for blocks of size 2^( 3) =       0.000530335305
  error estimate for blocks of size 2^( 4) =       0.000541924578
  error estimate for blocks of size 2^( 5) =       0.000549060777
  error estimate for blocks of size 2^( 6) =       0.000553581426
  error estimate for blocks of size 2^( 7) =       0.000555864369

      target function =      -0.608254133614
              le_mean =     -22.667699256156
             les_mean =     514.331979357425
             stat err =       0.000550107787
             autocorr =       1.233258976610
   target nu stat err =       0.000550107787
   target dn stat err =       0.004330229880
      target stat err =       0.001328121288
              std dev =       0.700544371642
             le_variance =       0.490762416639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491436731831
                                         uncertainty =       0.003195407028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491436731831
                                         uncertainty =       0.003195407028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495641112
  error estimate for blocks of size 2^( 2) =       0.000513937839
  error estimate for blocks of size 2^( 3) =       0.000530619598
  error estimate for blocks of size 2^( 4) =       0.000542215750
  error estimate for blocks of size 2^( 5) =       0.000549346113
  error estimate for blocks of size 2^( 6) =       0.000553870207
  error estimate for blocks of size 2^( 7) =       0.000556154721

      target function =      -0.607685621990
              le_mean =     -22.667691560553
             les_mean =     514.333514720666
             stat err =       0.000550396697
             autocorr =       1.233153082766
   target nu stat err =       0.000550396697
   target dn stat err =       0.005339529097
      target stat err =       0.001622946060
              std dev =       0.700942382865
             le_variance =       0.491320224097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492054141598
                                         uncertainty =       0.003210538785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492054141598
                                         uncertainty =       0.003210538785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495952554
  error estimate for blocks of size 2^( 2) =       0.000514252793
  error estimate for blocks of size 2^( 3) =       0.000530936054
  error estimate for blocks of size 2^( 4) =       0.000542539688
  error estimate for blocks of size 2^( 5) =       0.000549665974
  error estimate for blocks of size 2^( 6) =       0.000554194603
  error estimate for blocks of size 2^( 7) =       0.000556482450

      target function =      -0.608599664693
              le_mean =     -22.667693855001
             les_mean =     514.330580824165
             stat err =       0.000550720679
             autocorr =       1.233055163649
   target nu stat err =       0.000550720679
   target dn stat err =       0.004086327361
      target stat err =       0.001257984094
              std dev =       0.701382827663
             le_variance =       0.491937870941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607446823758        initial
     3.9062e-01     3.9062e+00             1.5129e-03        -0.608254133614
     1.5625e+00     1.5625e+01             4.0817e-04        -0.607685621990
     6.2500e+00     6.2500e+01             1.0410e-04        -0.608599664693  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.5771e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_001                -7.038195e-01 3 1  ON 0
ci_002                -7.021108e-01 3 1  ON 1
ci_003                -5.590319e-02 3 1  ON 2
ci_004                -5.617541e-02 3 1  ON 3
ci_005                 2.789050e-02 3 1  ON 4
ci_006                 2.790103e-02 3 1  ON 5
ci_007                 2.141391e-02 3 1  ON 6
ci_008                 2.191261e-02 3 1  ON 7
ci_009                -1.714020e-02 3 1  ON 8
ci_010                -1.685219e-02 3 1  ON 9
ci_011                -1.473254e-02 3 1  ON 10
ci_012                -1.453385e-02 3 1  ON 11
ci_013                 1.304028e-02 3 1  ON 12
ci_014                 1.294260e-02 3 1  ON 13
ci_015                 1.434933e-02 3 1  ON 14
ci_016                 1.418271e-02 3 1  ON 15
ci_017                 1.156470e-02 3 1  ON 16
ci_018                 1.175862e-02 3 1  ON 17
ci_019                 4.925817e-03 3 1  ON 18
ci_020                 5.043678e-03 3 1  ON 19
ci_021                -8.296635e-03 3 1  ON 20
ci_022                -8.485862e-03 3 1  ON 21
ci_023                 6.796081e-03 3 1  ON 22
ci_024                 6.784250e-03 3 1  ON 23
ci_025                 8.685940e-03 3 1  ON 24
ci_026                 8.691971e-03 3 1  ON 25
ci_027                 6.813636e-03 3 1  ON 26
ci_028                 6.923240e-03 3 1  ON 27
ci_029                -5.997657e-03 3 1  ON 28
ci_030                -5.976253e-03 3 1  ON 29
ci_031                -3.044486e-03 3 1  ON 30
ci_032                -3.329555e-03 3 1  ON 31
ci_033                 5.039478e-03 3 1  ON 32
ci_034                 4.901113e-03 3 1  ON 33
ci_035                 3.478499e-03 3 1  ON 34
ci_036                 3.674585e-03 3 1  ON 35
ci_037                 5.024748e-03 3 1  ON 36
ci_038                 4.963331e-03 3 1  ON 37
ci_039                 4.757030e-03 3 1  ON 38
ci_040                 4.810437e-03 3 1  ON 39
ci_041                 3.974111e-03 3 1  ON 40
ci_042                 3.878273e-03 3 1  ON 41
ci_043                 4.107720e-03 3 1  ON 42
ci_044                 4.112121e-03 3 1  ON 43
ci_045                 3.519023e-03 3 1  ON 44
ci_046                 3.532504e-03 3 1  ON 45
ci_047                -2.164693e-03 3 1  ON 46
ci_048                -2.237032e-03 3 1  ON 47
ci_049                 1.942897e-03 3 1  ON 48
ci_050                 1.854305e-03 3 1  ON 49
ci_051                -2.431721e-03 3 1  ON 50
ci_052                -2.178283e-03 3 1  ON 51
ci_053                -2.321314e-03 3 1  ON 52
ci_054                -2.535611e-03 3 1  ON 53
ci_055                -1.531329e-03 3 1  ON 54
ci_056                -1.658933e-03 3 1  ON 55
ci_057                -1.412960e-03 3 1  ON 56
ci_058                -1.573293e-03 3 1  ON 57
ci_059                -1.029866e-03 3 1  ON 58
ci_060                -9.727894e-04 3 1  ON 59
ci_061                -1.327958e-03 3 1  ON 60
ci_062                -7.934003e-04 3 1  ON 61
ci_063                -8.045493e-04 3 1  ON 62
ci_064                -8.557395e-04 3 1  ON 63
ci_065                -1.728184e-03 3 1  ON 64
ci_066                -1.957514e-03 3 1  ON 65
ci_067                -1.469114e-03 3 1  ON 66
ci_068                -1.154742e-03 3 1  ON 67
ci_069                 3.175783e-04 3 1  ON 68
ci_070                 2.740676e-04 3 1  ON 69
ci_071                -1.780881e-03 3 1  ON 70
ci_072                -1.733696e-03 3 1  ON 71
ci_073                 6.767721e-04 3 1  ON 72
ci_074                 5.895826e-04 3 1  ON 73
ci_075                -4.628589e-04 3 1  ON 74
ci_076                -4.055986e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4620e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7469
    reference variance = 0.396322
====================================================
  Execution time = 5.1831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0864e-01
  Total weights = 1.954795622e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492196961468
                                         uncertainty =       0.003322594334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492196961468
                                         uncertainty =       0.003322594334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496038539
  error estimate for blocks of size 2^( 2) =       0.000514593617
  error estimate for blocks of size 2^( 3) =       0.000530863729
  error estimate for blocks of size 2^( 4) =       0.000543168105
  error estimate for blocks of size 2^( 5) =       0.000551570827
  error estimate for blocks of size 2^( 6) =       0.000554379766
  error estimate for blocks of size 2^( 7) =       0.000556864246

      target function =      -0.607964043534
              le_mean =     -22.668042704314
             les_mean =     514.348795101320
             stat err =       0.000551495736
             autocorr =       1.236099635220
   target nu stat err =       0.000551495736
   target dn stat err =       0.004945597474
      target stat err =       0.001508573661
              std dev =       0.701504429398
             le_variance =       0.492108464464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266804270431e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607967506410       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608016291180       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608021331473       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608021777530       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608021881660       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608021917886       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608021926618       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608021932333       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608021930018       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608021931655       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608021931006       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.264629e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607967506410       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607979926119       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607981199025       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607981310669       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607981336485       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607981345389       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607981347483       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607981348863       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607981348294       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607981348686       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607981348530       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.316194e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607967506410       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607970625627       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607970944661       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607970972579       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607970979019       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607970981235       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607970981753       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607970982095       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607970981954       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607970982050       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.607970982012       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.088941e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.565654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1239e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_001                -7.038180e-01 3 1  ON 0
ci_002                -7.021349e-01 3 1  ON 1
ci_003                -5.588649e-02 3 1  ON 2
ci_004                -5.614451e-02 3 1  ON 3
ci_005                 2.780734e-02 3 1  ON 4
ci_006                 2.782325e-02 3 1  ON 5
ci_007                 2.135924e-02 3 1  ON 6
ci_008                 2.186367e-02 3 1  ON 7
ci_009                -1.708986e-02 3 1  ON 8
ci_010                -1.682129e-02 3 1  ON 9
ci_011                -1.469377e-02 3 1  ON 10
ci_012                -1.449363e-02 3 1  ON 11
ci_013                 1.299651e-02 3 1  ON 12
ci_014                 1.289465e-02 3 1  ON 13
ci_015                 1.432822e-02 3 1  ON 14
ci_016                 1.414654e-02 3 1  ON 15
ci_017                 1.154016e-02 3 1  ON 16
ci_018                 1.174002e-02 3 1  ON 17
ci_019                 4.896932e-03 3 1  ON 18
ci_020                 5.024528e-03 3 1  ON 19
ci_021                -8.286572e-03 3 1  ON 20
ci_022                -8.474910e-03 3 1  ON 21
ci_023                 6.780774e-03 3 1  ON 22
ci_024                 6.782651e-03 3 1  ON 23
ci_025                 8.689358e-03 3 1  ON 24
ci_026                 8.697872e-03 3 1  ON 25
ci_027                 6.810251e-03 3 1  ON 26
ci_028                 6.920610e-03 3 1  ON 27
ci_029                -5.983504e-03 3 1  ON 28
ci_030                -5.967065e-03 3 1  ON 29
ci_031                -3.024388e-03 3 1  ON 30
ci_032                -3.302913e-03 3 1  ON 31
ci_033                 5.020863e-03 3 1  ON 32
ci_034                 4.876298e-03 3 1  ON 33
ci_035                 3.463270e-03 3 1  ON 34
ci_036                 3.658485e-03 3 1  ON 35
ci_037                 5.017153e-03 3 1  ON 36
ci_038                 4.952013e-03 3 1  ON 37
ci_039                 4.757917e-03 3 1  ON 38
ci_040                 4.800841e-03 3 1  ON 39
ci_041                 3.964385e-03 3 1  ON 40
ci_042                 3.874417e-03 3 1  ON 41
ci_043                 4.101358e-03 3 1  ON 42
ci_044                 4.113626e-03 3 1  ON 43
ci_045                 3.509568e-03 3 1  ON 44
ci_046                 3.529098e-03 3 1  ON 45
ci_047                -2.154260e-03 3 1  ON 46
ci_048                -2.234926e-03 3 1  ON 47
ci_049                 1.940356e-03 3 1  ON 48
ci_050                 1.850319e-03 3 1  ON 49
ci_051                -2.430464e-03 3 1  ON 50
ci_052                -2.178501e-03 3 1  ON 51
ci_053                -2.316828e-03 3 1  ON 52
ci_054                -2.531153e-03 3 1  ON 53
ci_055                -1.521035e-03 3 1  ON 54
ci_056                -1.650770e-03 3 1  ON 55
ci_057                -1.406363e-03 3 1  ON 56
ci_058                -1.571622e-03 3 1  ON 57
ci_059                -1.033359e-03 3 1  ON 58
ci_060                -9.685166e-04 3 1  ON 59
ci_061                -1.319030e-03 3 1  ON 60
ci_062                -7.871428e-04 3 1  ON 61
ci_063                -8.137605e-04 3 1  ON 62
ci_064                -8.582660e-04 3 1  ON 63
ci_065                -1.734834e-03 3 1  ON 64
ci_066                -1.963789e-03 3 1  ON 65
ci_067                -1.467006e-03 3 1  ON 66
ci_068                -1.150954e-03 3 1  ON 67
ci_069                 3.108555e-04 3 1  ON 68
ci_070                 2.699544e-04 3 1  ON 69
ci_071                -1.788564e-03 3 1  ON 70
ci_072                -1.732381e-03 3 1  ON 71
ci_073                 6.656865e-04 3 1  ON 72
ci_074                 5.847345e-04 3 1  ON 73
ci_075                -4.582513e-04 3 1  ON 74
ci_076                -3.993160e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6079
    reference variance = 0.261498
====================================================
  Execution time = 5.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0530e-01
  Total weights = 1.9549e+06
  Execution time = 7.2267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492692665710
                                         uncertainty =       0.008393875936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492692665710
                                         uncertainty =       0.008393875936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496272619
  error estimate for blocks of size 2^( 2) =       0.000515200967
  error estimate for blocks of size 2^( 3) =       0.000531530122
  error estimate for blocks of size 2^( 4) =       0.000543314890
  error estimate for blocks of size 2^( 5) =       0.000549250915
  error estimate for blocks of size 2^( 6) =       0.000553106047
  error estimate for blocks of size 2^( 7) =       0.000556226902

      target function =      -0.608775822300
              le_mean =     -22.667442503520
             les_mean =     514.318355734957
             stat err =       0.000550474689
             autocorr =       1.230365315007
   target nu stat err =       0.000550474689
   target dn stat err =       0.009572641826
      target stat err =       0.002891198845
              std dev =       0.701835468963
             le_variance =       0.492573025495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492349108159
                                         uncertainty =       0.008360516526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492349108159
                                         uncertainty =       0.008360516526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496099378
  error estimate for blocks of size 2^( 2) =       0.000515025321
  error estimate for blocks of size 2^( 3) =       0.000531351876
  error estimate for blocks of size 2^( 4) =       0.000543136589
  error estimate for blocks of size 2^( 5) =       0.000549072227
  error estimate for blocks of size 2^( 6) =       0.000552922445
  error estimate for blocks of size 2^( 7) =       0.000556050799

      target function =      -0.608827924348
              le_mean =     -22.667443800069
             les_mean =     514.318242620547
             stat err =       0.000550295515
             autocorr =       1.230423397777
   target nu stat err =       0.000550295515
   target dn stat err =       0.009540354634
      target stat err =       0.002882018930
              std dev =       0.701590468865
             le_variance =       0.492229186002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492516200825
                                         uncertainty =       0.008377023024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492516200825
                                         uncertainty =       0.008377023024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496183645
  error estimate for blocks of size 2^( 2) =       0.000515110712
  error estimate for blocks of size 2^( 3) =       0.000531438523
  error estimate for blocks of size 2^( 4) =       0.000543223293
  error estimate for blocks of size 2^( 5) =       0.000549159095
  error estimate for blocks of size 2^( 6) =       0.000553011719
  error estimate for blocks of size 2^( 7) =       0.000556136386

      target function =      -0.608833531578
              le_mean =     -22.667442882126
             les_mean =     514.318181461631
             stat err =       0.000550382623
             autocorr =       1.230394944370
   target nu stat err =       0.000550382623
   target dn stat err =       0.009555326200
      target stat err =       0.002886556487
              std dev =       0.701709639585
             le_variance =       0.492396418287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492670306574
                                         uncertainty =       0.008391762502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492670306574
                                         uncertainty =       0.008391762502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496261347
  error estimate for blocks of size 2^( 2) =       0.000515189528
  error estimate for blocks of size 2^( 3) =       0.000531518512
  error estimate for blocks of size 2^( 4) =       0.000543303280
  error estimate for blocks of size 2^( 5) =       0.000549239276
  error estimate for blocks of size 2^( 6) =       0.000553094094
  error estimate for blocks of size 2^( 7) =       0.000556215427

      target function =      -0.608785708728
              le_mean =     -22.667442517820
             les_mean =     514.318323535723
             stat err =       0.000550463020
             autocorr =       1.230369046149
   target nu stat err =       0.000550463020
   target dn stat err =       0.009570452141
      target stat err =       0.002890636283
              std dev =       0.701819527098
             le_variance =       0.492550648615


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.608775822300        initial
     1.5625e+00     1.5625e+01             3.2646e-04        -0.608827924348
     6.2500e+00     6.2500e+01             8.3162e-05        -0.608833531578  <--
     2.5000e+01     2.5000e+02             2.0889e-05        -0.608785708728

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.6354e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_001                -7.038180e-01 3 1  ON 0
ci_002                -7.021349e-01 3 1  ON 1
ci_003                -5.588649e-02 3 1  ON 2
ci_004                -5.614451e-02 3 1  ON 3
ci_005                 2.780734e-02 3 1  ON 4
ci_006                 2.782325e-02 3 1  ON 5
ci_007                 2.135924e-02 3 1  ON 6
ci_008                 2.186367e-02 3 1  ON 7
ci_009                -1.708986e-02 3 1  ON 8
ci_010                -1.682129e-02 3 1  ON 9
ci_011                -1.469377e-02 3 1  ON 10
ci_012                -1.449363e-02 3 1  ON 11
ci_013                 1.299651e-02 3 1  ON 12
ci_014                 1.289465e-02 3 1  ON 13
ci_015                 1.432822e-02 3 1  ON 14
ci_016                 1.414654e-02 3 1  ON 15
ci_017                 1.154016e-02 3 1  ON 16
ci_018                 1.174002e-02 3 1  ON 17
ci_019                 4.896932e-03 3 1  ON 18
ci_020                 5.024528e-03 3 1  ON 19
ci_021                -8.286572e-03 3 1  ON 20
ci_022                -8.474910e-03 3 1  ON 21
ci_023                 6.780774e-03 3 1  ON 22
ci_024                 6.782651e-03 3 1  ON 23
ci_025                 8.689358e-03 3 1  ON 24
ci_026                 8.697872e-03 3 1  ON 25
ci_027                 6.810251e-03 3 1  ON 26
ci_028                 6.920610e-03 3 1  ON 27
ci_029                -5.983504e-03 3 1  ON 28
ci_030                -5.967065e-03 3 1  ON 29
ci_031                -3.024388e-03 3 1  ON 30
ci_032                -3.302913e-03 3 1  ON 31
ci_033                 5.020863e-03 3 1  ON 32
ci_034                 4.876298e-03 3 1  ON 33
ci_035                 3.463270e-03 3 1  ON 34
ci_036                 3.658485e-03 3 1  ON 35
ci_037                 5.017153e-03 3 1  ON 36
ci_038                 4.952013e-03 3 1  ON 37
ci_039                 4.757917e-03 3 1  ON 38
ci_040                 4.800841e-03 3 1  ON 39
ci_041                 3.964385e-03 3 1  ON 40
ci_042                 3.874417e-03 3 1  ON 41
ci_043                 4.101358e-03 3 1  ON 42
ci_044                 4.113626e-03 3 1  ON 43
ci_045                 3.509568e-03 3 1  ON 44
ci_046                 3.529098e-03 3 1  ON 45
ci_047                -2.154260e-03 3 1  ON 46
ci_048                -2.234926e-03 3 1  ON 47
ci_049                 1.940356e-03 3 1  ON 48
ci_050                 1.850319e-03 3 1  ON 49
ci_051                -2.430464e-03 3 1  ON 50
ci_052                -2.178501e-03 3 1  ON 51
ci_053                -2.316828e-03 3 1  ON 52
ci_054                -2.531153e-03 3 1  ON 53
ci_055                -1.521035e-03 3 1  ON 54
ci_056                -1.650770e-03 3 1  ON 55
ci_057                -1.406363e-03 3 1  ON 56
ci_058                -1.571622e-03 3 1  ON 57
ci_059                -1.033359e-03 3 1  ON 58
ci_060                -9.685166e-04 3 1  ON 59
ci_061                -1.319030e-03 3 1  ON 60
ci_062                -7.871428e-04 3 1  ON 61
ci_063                -8.137605e-04 3 1  ON 62
ci_064                -8.582660e-04 3 1  ON 63
ci_065                -1.734834e-03 3 1  ON 64
ci_066                -1.963789e-03 3 1  ON 65
ci_067                -1.467006e-03 3 1  ON 66
ci_068                -1.150954e-03 3 1  ON 67
ci_069                 3.108555e-04 3 1  ON 68
ci_070                 2.699544e-04 3 1  ON 69
ci_071                -1.788564e-03 3 1  ON 70
ci_072                -1.732381e-03 3 1  ON 71
ci_073                 6.656865e-04 3 1  ON 72
ci_074                 5.847345e-04 3 1  ON 73
ci_075                -4.582513e-04 3 1  ON 74
ci_076                -3.993160e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4760e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7752
    reference variance = 0.56163
====================================================
  Execution time = 5.1223e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 4.9483e-01
  Total weights = 1.954648352e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484603302281
                                         uncertainty =       0.002285930564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484603302281
                                         uncertainty =       0.002285930564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492217125
  error estimate for blocks of size 2^( 2) =       0.000510382789
  error estimate for blocks of size 2^( 3) =       0.000527384371
  error estimate for blocks of size 2^( 4) =       0.000539068995
  error estimate for blocks of size 2^( 5) =       0.000547106673
  error estimate for blocks of size 2^( 6) =       0.000550204738
  error estimate for blocks of size 2^( 7) =       0.000550395784

      target function =      -0.611902219904
              le_mean =     -22.667107957134
             les_mean =     514.292608320199
             stat err =       0.000546694047
             autocorr =       1.233602531118
   target nu stat err =       0.000546694047
   target dn stat err =       0.002841429353
      target stat err =       0.000904584389
              std dev =       0.696100133605
             le_variance =       0.484555396005


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266710795713e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611903258296       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611953218608       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611958803403       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611959553873       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611959598001       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611959637977       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611959645722       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611959656872       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611959656246       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611959654302       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.611959653198       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.382978e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611903258296       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611915984815       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611917396391       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611917584039       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611917594470       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611917604251       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611917606106       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611917608823       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611917608656       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611917608182       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.611917607919       residual = 9.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.618856e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611903258296       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611906455053       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611906808917       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611906855828       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611906858397       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611906860829       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611906861288       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611906861963       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611906861920       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611906861803       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.611906861738       residual = 9.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.165043e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.571744 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0805e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_001                -7.038408e-01 3 1  ON 0
ci_002                -7.021359e-01 3 1  ON 1
ci_003                -5.584879e-02 3 1  ON 2
ci_004                -5.610410e-02 3 1  ON 3
ci_005                 2.772540e-02 3 1  ON 4
ci_006                 2.773706e-02 3 1  ON 5
ci_007                 2.131016e-02 3 1  ON 6
ci_008                 2.180836e-02 3 1  ON 7
ci_009                -1.705550e-02 3 1  ON 8
ci_010                -1.678138e-02 3 1  ON 9
ci_011                -1.465687e-02 3 1  ON 10
ci_012                -1.445630e-02 3 1  ON 11
ci_013                 1.296750e-02 3 1  ON 12
ci_014                 1.286257e-02 3 1  ON 13
ci_015                 1.430565e-02 3 1  ON 14
ci_016                 1.412098e-02 3 1  ON 15
ci_017                 1.152592e-02 3 1  ON 16
ci_018                 1.172123e-02 3 1  ON 17
ci_019                 4.873750e-03 3 1  ON 18
ci_020                 5.000471e-03 3 1  ON 19
ci_021                -8.280357e-03 3 1  ON 20
ci_022                -8.472428e-03 3 1  ON 21
ci_023                 6.773815e-03 3 1  ON 22
ci_024                 6.774290e-03 3 1  ON 23
ci_025                 8.697375e-03 3 1  ON 24
ci_026                 8.703811e-03 3 1  ON 25
ci_027                 6.805851e-03 3 1  ON 26
ci_028                 6.916862e-03 3 1  ON 27
ci_029                -5.973220e-03 3 1  ON 28
ci_030                -5.957300e-03 3 1  ON 29
ci_031                -2.991288e-03 3 1  ON 30
ci_032                -3.274745e-03 3 1  ON 31
ci_033                 5.009343e-03 3 1  ON 32
ci_034                 4.866637e-03 3 1  ON 33
ci_035                 3.444011e-03 3 1  ON 34
ci_036                 3.639741e-03 3 1  ON 35
ci_037                 5.011831e-03 3 1  ON 36
ci_038                 4.938420e-03 3 1  ON 37
ci_039                 4.759841e-03 3 1  ON 38
ci_040                 4.793233e-03 3 1  ON 39
ci_041                 3.962945e-03 3 1  ON 40
ci_042                 3.871268e-03 3 1  ON 41
ci_043                 4.109485e-03 3 1  ON 42
ci_044                 4.106718e-03 3 1  ON 43
ci_045                 3.501440e-03 3 1  ON 44
ci_046                 3.523292e-03 3 1  ON 45
ci_047                -2.141572e-03 3 1  ON 46
ci_048                -2.224537e-03 3 1  ON 47
ci_049                 1.936552e-03 3 1  ON 48
ci_050                 1.837824e-03 3 1  ON 49
ci_051                -2.425596e-03 3 1  ON 50
ci_052                -2.175737e-03 3 1  ON 51
ci_053                -2.312525e-03 3 1  ON 52
ci_054                -2.524905e-03 3 1  ON 53
ci_055                -1.524731e-03 3 1  ON 54
ci_056                -1.648683e-03 3 1  ON 55
ci_057                -1.404944e-03 3 1  ON 56
ci_058                -1.572531e-03 3 1  ON 57
ci_059                -1.027332e-03 3 1  ON 58
ci_060                -9.644707e-04 3 1  ON 59
ci_061                -1.317144e-03 3 1  ON 60
ci_062                -7.817393e-04 3 1  ON 61
ci_063                -8.104453e-04 3 1  ON 62
ci_064                -8.549205e-04 3 1  ON 63
ci_065                -1.731950e-03 3 1  ON 64
ci_066                -1.967105e-03 3 1  ON 65
ci_067                -1.470001e-03 3 1  ON 66
ci_068                -1.150407e-03 3 1  ON 67
ci_069                 3.089155e-04 3 1  ON 68
ci_070                 2.737361e-04 3 1  ON 69
ci_071                -1.791968e-03 3 1  ON 70
ci_072                -1.741402e-03 3 1  ON 71
ci_073                 6.629463e-04 3 1  ON 72
ci_074                 5.888754e-04 3 1  ON 73
ci_075                -4.536479e-04 3 1  ON 74
ci_076                -3.984705e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.635
    reference variance = 0.5697
====================================================
  Execution time = 5.0198e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0211e-01
  Total weights = 1.9551e+06
  Execution time = 7.2141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490524293771
                                         uncertainty =       0.002718899787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490524293771
                                         uncertainty =       0.002718899787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495234108
  error estimate for blocks of size 2^( 2) =       0.000514294663
  error estimate for blocks of size 2^( 3) =       0.000530799296
  error estimate for blocks of size 2^( 4) =       0.000543361218
  error estimate for blocks of size 2^( 5) =       0.000551449241
  error estimate for blocks of size 2^( 6) =       0.000555647271
  error estimate for blocks of size 2^( 7) =       0.000558296815

      target function =      -0.610007419108
              le_mean =     -22.668672888195
             les_mean =     514.371103767737
             stat err =       0.000552188636
             autocorr =       1.243236735508
   target nu stat err =       0.000552188636
   target dn stat err =       0.003294133427
      target stat err =       0.001032397124
              std dev =       0.700366791486
             le_variance =       0.490513642616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490217563949
                                         uncertainty =       0.002714345664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490217563949
                                         uncertainty =       0.002714345664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495079391
  error estimate for blocks of size 2^( 2) =       0.000514135024
  error estimate for blocks of size 2^( 3) =       0.000530639280
  error estimate for blocks of size 2^( 4) =       0.000543196253
  error estimate for blocks of size 2^( 5) =       0.000551284184
  error estimate for blocks of size 2^( 6) =       0.000555489445
  error estimate for blocks of size 2^( 7) =       0.000558147069

      target function =      -0.610042531329
              le_mean =     -22.668674414920
             les_mean =     514.371058041262
             stat err =       0.000552029238
             autocorr =       1.243295793265
   target nu stat err =       0.000552029238
   target dn stat err =       0.003299992299
      target stat err =       0.001034199798
              std dev =       0.700147989537
             le_variance =       0.490207207253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490366417188
                                         uncertainty =       0.002716531076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490366417188
                                         uncertainty =       0.002716531076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495154479
  error estimate for blocks of size 2^( 2) =       0.000514212541
  error estimate for blocks of size 2^( 3) =       0.000530716924
  error estimate for blocks of size 2^( 4) =       0.000543276299
  error estimate for blocks of size 2^( 5) =       0.000551364151
  error estimate for blocks of size 2^( 6) =       0.000555565923
  error estimate for blocks of size 2^( 7) =       0.000558219464

      target function =      -0.610087258350
              le_mean =     -22.668673446986
             les_mean =     514.370865413184
             stat err =       0.000552106459
             autocorr =       1.243266502915
   target nu stat err =       0.000552106459
   target dn stat err =       0.003291598344
      target stat err =       0.001031908665
              std dev =       0.700254179652
             le_variance =       0.490355916120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490504268523
                                         uncertainty =       0.002718596693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490504268523
                                         uncertainty =       0.002718596693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495224008
  error estimate for blocks of size 2^( 2) =       0.000514284261
  error estimate for blocks of size 2^( 3) =       0.000530788836
  error estimate for blocks of size 2^( 4) =       0.000543350449
  error estimate for blocks of size 2^( 5) =       0.000551438418
  error estimate for blocks of size 2^( 6) =       0.000555636893
  error estimate for blocks of size 2^( 7) =       0.000558286852

      target function =      -0.610056782687
              le_mean =     -22.668672914095
             les_mean =     514.370941640947
             stat err =       0.000552178153
             autocorr =       1.243240238208
   target nu stat err =       0.000552178153
   target dn stat err =       0.003290915584
      target stat err =       0.001031619188
              std dev =       0.700352508577
             le_variance =       0.490493636270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610007419108        initial
     1.5625e+00     1.5625e+01             3.3830e-04        -0.610042531329
     6.2500e+00     6.2500e+01             8.6189e-05        -0.610087258350  <--
     2.5000e+01     2.5000e+02             2.1650e-05        -0.610056782687

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.6435e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_001                -7.038408e-01 3 1  ON 0
ci_002                -7.021359e-01 3 1  ON 1
ci_003                -5.584879e-02 3 1  ON 2
ci_004                -5.610410e-02 3 1  ON 3
ci_005                 2.772540e-02 3 1  ON 4
ci_006                 2.773706e-02 3 1  ON 5
ci_007                 2.131016e-02 3 1  ON 6
ci_008                 2.180836e-02 3 1  ON 7
ci_009                -1.705550e-02 3 1  ON 8
ci_010                -1.678138e-02 3 1  ON 9
ci_011                -1.465687e-02 3 1  ON 10
ci_012                -1.445630e-02 3 1  ON 11
ci_013                 1.296750e-02 3 1  ON 12
ci_014                 1.286257e-02 3 1  ON 13
ci_015                 1.430565e-02 3 1  ON 14
ci_016                 1.412098e-02 3 1  ON 15
ci_017                 1.152592e-02 3 1  ON 16
ci_018                 1.172123e-02 3 1  ON 17
ci_019                 4.873750e-03 3 1  ON 18
ci_020                 5.000471e-03 3 1  ON 19
ci_021                -8.280357e-03 3 1  ON 20
ci_022                -8.472428e-03 3 1  ON 21
ci_023                 6.773815e-03 3 1  ON 22
ci_024                 6.774290e-03 3 1  ON 23
ci_025                 8.697375e-03 3 1  ON 24
ci_026                 8.703811e-03 3 1  ON 25
ci_027                 6.805851e-03 3 1  ON 26
ci_028                 6.916862e-03 3 1  ON 27
ci_029                -5.973220e-03 3 1  ON 28
ci_030                -5.957300e-03 3 1  ON 29
ci_031                -2.991288e-03 3 1  ON 30
ci_032                -3.274745e-03 3 1  ON 31
ci_033                 5.009343e-03 3 1  ON 32
ci_034                 4.866637e-03 3 1  ON 33
ci_035                 3.444011e-03 3 1  ON 34
ci_036                 3.639741e-03 3 1  ON 35
ci_037                 5.011831e-03 3 1  ON 36
ci_038                 4.938420e-03 3 1  ON 37
ci_039                 4.759841e-03 3 1  ON 38
ci_040                 4.793233e-03 3 1  ON 39
ci_041                 3.962945e-03 3 1  ON 40
ci_042                 3.871268e-03 3 1  ON 41
ci_043                 4.109485e-03 3 1  ON 42
ci_044                 4.106718e-03 3 1  ON 43
ci_045                 3.501440e-03 3 1  ON 44
ci_046                 3.523292e-03 3 1  ON 45
ci_047                -2.141572e-03 3 1  ON 46
ci_048                -2.224537e-03 3 1  ON 47
ci_049                 1.936552e-03 3 1  ON 48
ci_050                 1.837824e-03 3 1  ON 49
ci_051                -2.425596e-03 3 1  ON 50
ci_052                -2.175737e-03 3 1  ON 51
ci_053                -2.312525e-03 3 1  ON 52
ci_054                -2.524905e-03 3 1  ON 53
ci_055                -1.524731e-03 3 1  ON 54
ci_056                -1.648683e-03 3 1  ON 55
ci_057                -1.404944e-03 3 1  ON 56
ci_058                -1.572531e-03 3 1  ON 57
ci_059                -1.027332e-03 3 1  ON 58
ci_060                -9.644707e-04 3 1  ON 59
ci_061                -1.317144e-03 3 1  ON 60
ci_062                -7.817393e-04 3 1  ON 61
ci_063                -8.104453e-04 3 1  ON 62
ci_064                -8.549205e-04 3 1  ON 63
ci_065                -1.731950e-03 3 1  ON 64
ci_066                -1.967105e-03 3 1  ON 65
ci_067                -1.470001e-03 3 1  ON 66
ci_068                -1.150407e-03 3 1  ON 67
ci_069                 3.089155e-04 3 1  ON 68
ci_070                 2.737361e-04 3 1  ON 69
ci_071                -1.791968e-03 3 1  ON 70
ci_072                -1.741402e-03 3 1  ON 71
ci_073                 6.629463e-04 3 1  ON 72
ci_074                 5.888754e-04 3 1  ON 73
ci_075                -4.536479e-04 3 1  ON 74
ci_076                -3.984705e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4725e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.5886
    reference variance = 0.403983
====================================================
  Execution time = 5.3148e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0227e-01
  Total weights = 1.955055190e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486951397771
                                         uncertainty =       0.002356544069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486951397771
                                         uncertainty =       0.002356544069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493414194
  error estimate for blocks of size 2^( 2) =       0.000511901665
  error estimate for blocks of size 2^( 3) =       0.000528742487
  error estimate for blocks of size 2^( 4) =       0.000540813901
  error estimate for blocks of size 2^( 5) =       0.000548737429
  error estimate for blocks of size 2^( 6) =       0.000551897336
  error estimate for blocks of size 2^( 7) =       0.000554967187

      target function =      -0.609611771477
              le_mean =     -22.666957752047
             les_mean =     514.293240174939
             stat err =       0.000549103963
             autocorr =       1.238471108832
   target nu stat err =       0.000549103963
   target dn stat err =       0.004267891092
      target stat err =       0.001314640096
              std dev =       0.697793044598
             le_variance =       0.486915133090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266695775205e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609614304045       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609660356356       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609664997110       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609665432980       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609665552828       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609665574401       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609665564844       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609665571944       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609665569136       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609665569671       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.170501e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609614304045       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609626028369       residual = 8.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609627199890       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609627309031       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609627338703       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609627343918       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609627341514       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609627343259       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609627342561       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609627342690       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.077627e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609614304045       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609617248632       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609617542225       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609617569520       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609617576919       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609617578211       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609617577610       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609617578044       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609617577870       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.028553e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.576734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2607e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_001                -7.038458e-01 3 1  ON 0
ci_002                -7.021535e-01 3 1  ON 1
ci_003                -5.582219e-02 3 1  ON 2
ci_004                -5.606783e-02 3 1  ON 3
ci_005                 2.764744e-02 3 1  ON 4
ci_006                 2.765629e-02 3 1  ON 5
ci_007                 2.126099e-02 3 1  ON 6
ci_008                 2.176053e-02 3 1  ON 7
ci_009                -1.701902e-02 3 1  ON 8
ci_010                -1.674801e-02 3 1  ON 9
ci_011                -1.461408e-02 3 1  ON 10
ci_012                -1.441842e-02 3 1  ON 11
ci_013                 1.293451e-02 3 1  ON 12
ci_014                 1.283026e-02 3 1  ON 13
ci_015                 1.427559e-02 3 1  ON 14
ci_016                 1.408653e-02 3 1  ON 15
ci_017                 1.149678e-02 3 1  ON 16
ci_018                 1.170982e-02 3 1  ON 17
ci_019                 4.838904e-03 3 1  ON 18
ci_020                 4.971871e-03 3 1  ON 19
ci_021                -8.271636e-03 3 1  ON 20
ci_022                -8.463391e-03 3 1  ON 21
ci_023                 6.764759e-03 3 1  ON 22
ci_024                 6.766080e-03 3 1  ON 23
ci_025                 8.706924e-03 3 1  ON 24
ci_026                 8.703070e-03 3 1  ON 25
ci_027                 6.807194e-03 3 1  ON 26
ci_028                 6.911700e-03 3 1  ON 27
ci_029                -5.965230e-03 3 1  ON 28
ci_030                -5.945583e-03 3 1  ON 29
ci_031                -2.955931e-03 3 1  ON 30
ci_032                -3.241353e-03 3 1  ON 31
ci_033                 4.998084e-03 3 1  ON 32
ci_034                 4.850894e-03 3 1  ON 33
ci_035                 3.430291e-03 3 1  ON 34
ci_036                 3.630269e-03 3 1  ON 35
ci_037                 4.999729e-03 3 1  ON 36
ci_038                 4.939854e-03 3 1  ON 37
ci_039                 4.753923e-03 3 1  ON 38
ci_040                 4.789696e-03 3 1  ON 39
ci_041                 3.951885e-03 3 1  ON 40
ci_042                 3.866804e-03 3 1  ON 41
ci_043                 4.100197e-03 3 1  ON 42
ci_044                 4.111458e-03 3 1  ON 43
ci_045                 3.501100e-03 3 1  ON 44
ci_046                 3.521342e-03 3 1  ON 45
ci_047                -2.137535e-03 3 1  ON 46
ci_048                -2.217850e-03 3 1  ON 47
ci_049                 1.928288e-03 3 1  ON 48
ci_050                 1.828744e-03 3 1  ON 49
ci_051                -2.421944e-03 3 1  ON 50
ci_052                -2.176805e-03 3 1  ON 51
ci_053                -2.310483e-03 3 1  ON 52
ci_054                -2.525647e-03 3 1  ON 53
ci_055                -1.528697e-03 3 1  ON 54
ci_056                -1.653156e-03 3 1  ON 55
ci_057                -1.403743e-03 3 1  ON 56
ci_058                -1.561688e-03 3 1  ON 57
ci_059                -1.021697e-03 3 1  ON 58
ci_060                -9.635921e-04 3 1  ON 59
ci_061                -1.312281e-03 3 1  ON 60
ci_062                -7.797274e-04 3 1  ON 61
ci_063                -8.000875e-04 3 1  ON 62
ci_064                -8.534360e-04 3 1  ON 63
ci_065                -1.733502e-03 3 1  ON 64
ci_066                -1.970787e-03 3 1  ON 65
ci_067                -1.466917e-03 3 1  ON 66
ci_068                -1.153984e-03 3 1  ON 67
ci_069                 3.105727e-04 3 1  ON 68
ci_070                 2.723829e-04 3 1  ON 69
ci_071                -1.797863e-03 3 1  ON 70
ci_072                -1.747736e-03 3 1  ON 71
ci_073                 6.608161e-04 3 1  ON 72
ci_074                 5.884154e-04 3 1  ON 73
ci_075                -4.490097e-04 3 1  ON 74
ci_076                -3.918858e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.6515
    reference variance = 0.451047
====================================================
  Execution time = 4.9786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0596e-01
  Total weights = 1.9545e+06
  Execution time = 7.2364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489129704933
                                         uncertainty =       0.002636316101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489129704933
                                         uncertainty =       0.002636316101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494519172
  error estimate for blocks of size 2^( 2) =       0.000512699697
  error estimate for blocks of size 2^( 3) =       0.000529528419
  error estimate for blocks of size 2^( 4) =       0.000541257936
  error estimate for blocks of size 2^( 5) =       0.000549137837
  error estimate for blocks of size 2^( 6) =       0.000551276746
  error estimate for blocks of size 2^( 7) =       0.000551989931

      target function =      -0.608553429554
              le_mean =     -22.667285784042
             les_mean =     514.311897130739
             stat err =       0.000548415613
             autocorr =       1.229853421234
   target nu stat err =       0.000548415613
   target dn stat err =       0.004620878988
      target stat err =       0.001414384511
              std dev =       0.699355719482
             le_variance =       0.489098422372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488922633429
                                         uncertainty =       0.002643926938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488922633429
                                         uncertainty =       0.002643926938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494414354
  error estimate for blocks of size 2^( 2) =       0.000512588920
  error estimate for blocks of size 2^( 3) =       0.000529410103
  error estimate for blocks of size 2^( 4) =       0.000541137168
  error estimate for blocks of size 2^( 5) =       0.000549021070
  error estimate for blocks of size 2^( 6) =       0.000551159285
  error estimate for blocks of size 2^( 7) =       0.000551858847

      target function =      -0.608552864046
              le_mean =     -22.667285056910
             les_mean =     514.311864624599
             stat err =       0.000548294093
             autocorr =       1.229829744426
   target nu stat err =       0.000548294093
   target dn stat err =       0.004799664946
      target stat err =       0.001467125218
              std dev =       0.699207484365
             le_variance =       0.488891106192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489017108386
                                         uncertainty =       0.002639560033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489017108386
                                         uncertainty =       0.002639560033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494462191
  error estimate for blocks of size 2^( 2) =       0.000512639791
  error estimate for blocks of size 2^( 3) =       0.000529464782
  error estimate for blocks of size 2^( 4) =       0.000541193109
  error estimate for blocks of size 2^( 5) =       0.000549074864
  error estimate for blocks of size 2^( 6) =       0.000551213314
  error estimate for blocks of size 2^( 7) =       0.000551919486

      target function =      -0.608579599748
              le_mean =     -22.667285217795
             les_mean =     514.311783524146
             stat err =       0.000548350193
             autocorr =       1.229843428272
   target nu stat err =       0.000548350193
   target dn stat err =       0.004700294803
      target stat err =       0.001437924132
              std dev =       0.699275135893
             le_variance =       0.488985715678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489114845267
                                         uncertainty =       0.002636666910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489114845267
                                         uncertainty =       0.002636666910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494511653
  error estimate for blocks of size 2^( 2) =       0.000512691821
  error estimate for blocks of size 2^( 3) =       0.000529520083
  error estimate for blocks of size 2^( 4) =       0.000541249453
  error estimate for blocks of size 2^( 5) =       0.000549129558
  error estimate for blocks of size 2^( 6) =       0.000551268394
  error estimate for blocks of size 2^( 7) =       0.000551980694

      target function =      -0.608566179490
              le_mean =     -22.667285687339
             les_mean =     514.311850189424
             stat err =       0.000548407025
             autocorr =       1.229852301609
   target nu stat err =       0.000548407025
   target dn stat err =       0.004629455572
      target stat err =       0.001416970974
              std dev =       0.699345086634
             le_variance =       0.489083550200


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.608553429554        initial
     1.5625e+00     1.5625e+01             3.1705e-04        -0.608552864046
     6.2500e+00     6.2500e+01             8.0776e-05        -0.608579599748  <--
     2.5000e+01     2.5000e+02             2.0286e-05        -0.608566179490

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.6043e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_001                -7.038458e-01 3 1  ON 0
ci_002                -7.021535e-01 3 1  ON 1
ci_003                -5.582219e-02 3 1  ON 2
ci_004                -5.606783e-02 3 1  ON 3
ci_005                 2.764744e-02 3 1  ON 4
ci_006                 2.765629e-02 3 1  ON 5
ci_007                 2.126099e-02 3 1  ON 6
ci_008                 2.176053e-02 3 1  ON 7
ci_009                -1.701902e-02 3 1  ON 8
ci_010                -1.674801e-02 3 1  ON 9
ci_011                -1.461408e-02 3 1  ON 10
ci_012                -1.441842e-02 3 1  ON 11
ci_013                 1.293451e-02 3 1  ON 12
ci_014                 1.283026e-02 3 1  ON 13
ci_015                 1.427559e-02 3 1  ON 14
ci_016                 1.408653e-02 3 1  ON 15
ci_017                 1.149678e-02 3 1  ON 16
ci_018                 1.170982e-02 3 1  ON 17
ci_019                 4.838904e-03 3 1  ON 18
ci_020                 4.971871e-03 3 1  ON 19
ci_021                -8.271636e-03 3 1  ON 20
ci_022                -8.463391e-03 3 1  ON 21
ci_023                 6.764759e-03 3 1  ON 22
ci_024                 6.766080e-03 3 1  ON 23
ci_025                 8.706924e-03 3 1  ON 24
ci_026                 8.703070e-03 3 1  ON 25
ci_027                 6.807194e-03 3 1  ON 26
ci_028                 6.911700e-03 3 1  ON 27
ci_029                -5.965230e-03 3 1  ON 28
ci_030                -5.945583e-03 3 1  ON 29
ci_031                -2.955931e-03 3 1  ON 30
ci_032                -3.241353e-03 3 1  ON 31
ci_033                 4.998084e-03 3 1  ON 32
ci_034                 4.850894e-03 3 1  ON 33
ci_035                 3.430291e-03 3 1  ON 34
ci_036                 3.630269e-03 3 1  ON 35
ci_037                 4.999729e-03 3 1  ON 36
ci_038                 4.939854e-03 3 1  ON 37
ci_039                 4.753923e-03 3 1  ON 38
ci_040                 4.789696e-03 3 1  ON 39
ci_041                 3.951885e-03 3 1  ON 40
ci_042                 3.866804e-03 3 1  ON 41
ci_043                 4.100197e-03 3 1  ON 42
ci_044                 4.111458e-03 3 1  ON 43
ci_045                 3.501100e-03 3 1  ON 44
ci_046                 3.521342e-03 3 1  ON 45
ci_047                -2.137535e-03 3 1  ON 46
ci_048                -2.217850e-03 3 1  ON 47
ci_049                 1.928288e-03 3 1  ON 48
ci_050                 1.828744e-03 3 1  ON 49
ci_051                -2.421944e-03 3 1  ON 50
ci_052                -2.176805e-03 3 1  ON 51
ci_053                -2.310483e-03 3 1  ON 52
ci_054                -2.525647e-03 3 1  ON 53
ci_055                -1.528697e-03 3 1  ON 54
ci_056                -1.653156e-03 3 1  ON 55
ci_057                -1.403743e-03 3 1  ON 56
ci_058                -1.561688e-03 3 1  ON 57
ci_059                -1.021697e-03 3 1  ON 58
ci_060                -9.635921e-04 3 1  ON 59
ci_061                -1.312281e-03 3 1  ON 60
ci_062                -7.797274e-04 3 1  ON 61
ci_063                -8.000875e-04 3 1  ON 62
ci_064                -8.534360e-04 3 1  ON 63
ci_065                -1.733502e-03 3 1  ON 64
ci_066                -1.970787e-03 3 1  ON 65
ci_067                -1.466917e-03 3 1  ON 66
ci_068                -1.153984e-03 3 1  ON 67
ci_069                 3.105727e-04 3 1  ON 68
ci_070                 2.723829e-04 3 1  ON 69
ci_071                -1.797863e-03 3 1  ON 70
ci_072                -1.747736e-03 3 1  ON 71
ci_073                 6.608161e-04 3 1  ON 72
ci_074                 5.884154e-04 3 1  ON 73
ci_075                -4.490097e-04 3 1  ON 74
ci_076                -3.918858e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4866e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.544
    reference variance = 0.372296
====================================================
  Execution time = 5.1391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0751e-01
  Total weights = 1.954693518e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489266797641
                                         uncertainty =       0.002760435192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489266797641
                                         uncertainty =       0.002760435192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494596259
  error estimate for blocks of size 2^( 2) =       0.000512884090
  error estimate for blocks of size 2^( 3) =       0.000530082174
  error estimate for blocks of size 2^( 4) =       0.000542766606
  error estimate for blocks of size 2^( 5) =       0.000551443524
  error estimate for blocks of size 2^( 6) =       0.000554493388
  error estimate for blocks of size 2^( 7) =       0.000556473422

      target function =      -0.608041545547
              le_mean =     -22.666991054860
             les_mean =     514.299992134003
             stat err =       0.000551294235
             autocorr =       1.242410882564
   target nu stat err =       0.000551294235
   target dn stat err =       0.005961665815
      target stat err =       0.001808159554
              std dev =       0.699464738045
             le_variance =       0.489250919768


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266699105486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608046627627       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608096595559       residual = 9.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608101626081       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608102198476       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608102386156       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608102416014       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608102424777       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608102432406       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608102426782       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608102425346       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608102427025       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.293812e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608046627627       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608059351936       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608060621956       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608060765273       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608060811948       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608060819119       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608060821182       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608060823047       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608060821642       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608060821301       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608060821705       residual = 1.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.391707e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608046627627       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608049823562       residual = 9.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608050141846       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608050177687       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608050189340       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608050191114       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608050191622       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608050192085       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608050191734       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608050191650       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608050191750       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.107985e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.582724 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0764e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_001                -7.038399e-01 3 1  ON 0
ci_002                -7.021820e-01 3 1  ON 1
ci_003                -5.579961e-02 3 1  ON 2
ci_004                -5.602968e-02 3 1  ON 3
ci_005                 2.756352e-02 3 1  ON 4
ci_006                 2.757279e-02 3 1  ON 5
ci_007                 2.121657e-02 3 1  ON 6
ci_008                 2.170225e-02 3 1  ON 7
ci_009                -1.697774e-02 3 1  ON 8
ci_010                -1.671302e-02 3 1  ON 9
ci_011                -1.456451e-02 3 1  ON 10
ci_012                -1.437960e-02 3 1  ON 11
ci_013                 1.289792e-02 3 1  ON 12
ci_014                 1.280575e-02 3 1  ON 13
ci_015                 1.425074e-02 3 1  ON 14
ci_016                 1.405941e-02 3 1  ON 15
ci_017                 1.147818e-02 3 1  ON 16
ci_018                 1.168063e-02 3 1  ON 17
ci_019                 4.830541e-03 3 1  ON 18
ci_020                 4.960852e-03 3 1  ON 19
ci_021                -8.290527e-03 3 1  ON 20
ci_022                -8.462362e-03 3 1  ON 21
ci_023                 6.763457e-03 3 1  ON 22
ci_024                 6.761548e-03 3 1  ON 23
ci_025                 8.712329e-03 3 1  ON 24
ci_026                 8.702015e-03 3 1  ON 25
ci_027                 6.801835e-03 3 1  ON 26
ci_028                 6.907753e-03 3 1  ON 27
ci_029                -5.954776e-03 3 1  ON 28
ci_030                -5.932785e-03 3 1  ON 29
ci_031                -2.912016e-03 3 1  ON 30
ci_032                -3.221505e-03 3 1  ON 31
ci_033                 4.981396e-03 3 1  ON 32
ci_034                 4.843963e-03 3 1  ON 33
ci_035                 3.415083e-03 3 1  ON 34
ci_036                 3.614678e-03 3 1  ON 35
ci_037                 4.990316e-03 3 1  ON 36
ci_038                 4.941838e-03 3 1  ON 37
ci_039                 4.749019e-03 3 1  ON 38
ci_040                 4.781213e-03 3 1  ON 39
ci_041                 3.951733e-03 3 1  ON 40
ci_042                 3.861598e-03 3 1  ON 41
ci_043                 4.093517e-03 3 1  ON 42
ci_044                 4.106395e-03 3 1  ON 43
ci_045                 3.498758e-03 3 1  ON 44
ci_046                 3.520920e-03 3 1  ON 45
ci_047                -2.124044e-03 3 1  ON 46
ci_048                -2.210486e-03 3 1  ON 47
ci_049                 1.924759e-03 3 1  ON 48
ci_050                 1.818923e-03 3 1  ON 49
ci_051                -2.418179e-03 3 1  ON 50
ci_052                -2.170145e-03 3 1  ON 51
ci_053                -2.317695e-03 3 1  ON 52
ci_054                -2.519588e-03 3 1  ON 53
ci_055                -1.523575e-03 3 1  ON 54
ci_056                -1.661972e-03 3 1  ON 55
ci_057                -1.403281e-03 3 1  ON 56
ci_058                -1.563800e-03 3 1  ON 57
ci_059                -1.010877e-03 3 1  ON 58
ci_060                -9.532149e-04 3 1  ON 59
ci_061                -1.304095e-03 3 1  ON 60
ci_062                -7.728524e-04 3 1  ON 61
ci_063                -7.923744e-04 3 1  ON 62
ci_064                -8.571970e-04 3 1  ON 63
ci_065                -1.733156e-03 3 1  ON 64
ci_066                -1.969403e-03 3 1  ON 65
ci_067                -1.467391e-03 3 1  ON 66
ci_068                -1.150240e-03 3 1  ON 67
ci_069                 3.004180e-04 3 1  ON 68
ci_070                 2.677656e-04 3 1  ON 69
ci_071                -1.793422e-03 3 1  ON 70
ci_072                -1.749579e-03 3 1  ON 71
ci_073                 6.541163e-04 3 1  ON 72
ci_074                 5.878064e-04 3 1  ON 73
ci_075                -4.464516e-04 3 1  ON 74
ci_076                -3.860583e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7015
    reference variance = 0.316915
====================================================
  Execution time = 5.0002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0459e-01
  Total weights = 1.9551e+06
  Execution time = 7.2089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492462121965
                                         uncertainty =       0.002571087597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492462121965
                                         uncertainty =       0.002571087597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496209157
  error estimate for blocks of size 2^( 2) =       0.000515074008
  error estimate for blocks of size 2^( 3) =       0.000531488398
  error estimate for blocks of size 2^( 4) =       0.000543188766
  error estimate for blocks of size 2^( 5) =       0.000551528123
  error estimate for blocks of size 2^( 6) =       0.000555724509
  error estimate for blocks of size 2^( 7) =       0.000558249306

      target function =      -0.609074982212
              le_mean =     -22.667704235568
             les_mean =     514.329482754890
             stat err =       0.000552172676
             autocorr =       1.238284041209
   target nu stat err =       0.000552172676
   target dn stat err =       0.003281649263
      target stat err =       0.001024919778
              std dev =       0.701745719034
             le_variance =       0.492447054183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492167938129
                                         uncertainty =       0.002567608178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492167938129
                                         uncertainty =       0.002567608178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496060898
  error estimate for blocks of size 2^( 2) =       0.000514924038
  error estimate for blocks of size 2^( 3) =       0.000531333511
  error estimate for blocks of size 2^( 4) =       0.000543032439
  error estimate for blocks of size 2^( 5) =       0.000551370607
  error estimate for blocks of size 2^( 6) =       0.000555561963
  error estimate for blocks of size 2^( 7) =       0.000558083605

      target function =      -0.609104058602
              le_mean =     -22.667702994256
             les_mean =     514.329328871501
             stat err =       0.000552012153
             autocorr =       1.238304034733
   target nu stat err =       0.000552012153
   target dn stat err =       0.003283172671
      target stat err =       0.001025434125
              std dev =       0.701536050253
             le_variance =       0.492152829805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492310523886
                                         uncertainty =       0.002569274670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492310523886
                                         uncertainty =       0.002569274670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496132763
  error estimate for blocks of size 2^( 2) =       0.000514996713
  error estimate for blocks of size 2^( 3) =       0.000531408559
  error estimate for blocks of size 2^( 4) =       0.000543108169
  error estimate for blocks of size 2^( 5) =       0.000551446913
  error estimate for blocks of size 2^( 6) =       0.000555640796
  error estimate for blocks of size 2^( 7) =       0.000558163980

      target function =      -0.609117163034
              le_mean =     -22.667703351264
             les_mean =     514.329301834861
             stat err =       0.000552089965
             autocorr =       1.238294350089
   target nu stat err =       0.000552089965
   target dn stat err =       0.003280048492
      target stat err =       0.001024580522
              std dev =       0.701637682205
             le_variance =       0.492295437090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492442875275
                                         uncertainty =       0.002570855927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492442875275
                                         uncertainty =       0.002570855927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496199459
  error estimate for blocks of size 2^( 2) =       0.000515064193
  error estimate for blocks of size 2^( 3) =       0.000531478259
  error estimate for blocks of size 2^( 4) =       0.000543178529
  error estimate for blocks of size 2^( 5) =       0.000551517813
  error estimate for blocks of size 2^( 6) =       0.000555713891
  error estimate for blocks of size 2^( 7) =       0.000558238483

      target function =      -0.609081403580
              le_mean =     -22.667704094116
             les_mean =     514.329454896230
             stat err =       0.000552162179
             autocorr =       1.238285364290
   target nu stat err =       0.000552162179
   target dn stat err =       0.003281380888
      target stat err =       0.001024861247
              std dev =       0.701732003859
             le_variance =       0.492427805240


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609074982212        initial
     1.5625e+00     1.5625e+01             3.2938e-04        -0.609104058602
     6.2500e+00     6.2500e+01             8.3917e-05        -0.609117163034  <--
     2.5000e+01     2.5000e+02             2.1080e-05        -0.609081403580

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.6181e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_001                -7.038399e-01 3 1  ON 0
ci_002                -7.021820e-01 3 1  ON 1
ci_003                -5.579961e-02 3 1  ON 2
ci_004                -5.602968e-02 3 1  ON 3
ci_005                 2.756352e-02 3 1  ON 4
ci_006                 2.757279e-02 3 1  ON 5
ci_007                 2.121657e-02 3 1  ON 6
ci_008                 2.170225e-02 3 1  ON 7
ci_009                -1.697774e-02 3 1  ON 8
ci_010                -1.671302e-02 3 1  ON 9
ci_011                -1.456451e-02 3 1  ON 10
ci_012                -1.437960e-02 3 1  ON 11
ci_013                 1.289792e-02 3 1  ON 12
ci_014                 1.280575e-02 3 1  ON 13
ci_015                 1.425074e-02 3 1  ON 14
ci_016                 1.405941e-02 3 1  ON 15
ci_017                 1.147818e-02 3 1  ON 16
ci_018                 1.168063e-02 3 1  ON 17
ci_019                 4.830541e-03 3 1  ON 18
ci_020                 4.960852e-03 3 1  ON 19
ci_021                -8.290527e-03 3 1  ON 20
ci_022                -8.462362e-03 3 1  ON 21
ci_023                 6.763457e-03 3 1  ON 22
ci_024                 6.761548e-03 3 1  ON 23
ci_025                 8.712329e-03 3 1  ON 24
ci_026                 8.702015e-03 3 1  ON 25
ci_027                 6.801835e-03 3 1  ON 26
ci_028                 6.907753e-03 3 1  ON 27
ci_029                -5.954776e-03 3 1  ON 28
ci_030                -5.932785e-03 3 1  ON 29
ci_031                -2.912016e-03 3 1  ON 30
ci_032                -3.221505e-03 3 1  ON 31
ci_033                 4.981396e-03 3 1  ON 32
ci_034                 4.843963e-03 3 1  ON 33
ci_035                 3.415083e-03 3 1  ON 34
ci_036                 3.614678e-03 3 1  ON 35
ci_037                 4.990316e-03 3 1  ON 36
ci_038                 4.941838e-03 3 1  ON 37
ci_039                 4.749019e-03 3 1  ON 38
ci_040                 4.781213e-03 3 1  ON 39
ci_041                 3.951733e-03 3 1  ON 40
ci_042                 3.861598e-03 3 1  ON 41
ci_043                 4.093517e-03 3 1  ON 42
ci_044                 4.106395e-03 3 1  ON 43
ci_045                 3.498758e-03 3 1  ON 44
ci_046                 3.520920e-03 3 1  ON 45
ci_047                -2.124044e-03 3 1  ON 46
ci_048                -2.210486e-03 3 1  ON 47
ci_049                 1.924759e-03 3 1  ON 48
ci_050                 1.818923e-03 3 1  ON 49
ci_051                -2.418179e-03 3 1  ON 50
ci_052                -2.170145e-03 3 1  ON 51
ci_053                -2.317695e-03 3 1  ON 52
ci_054                -2.519588e-03 3 1  ON 53
ci_055                -1.523575e-03 3 1  ON 54
ci_056                -1.661972e-03 3 1  ON 55
ci_057                -1.403281e-03 3 1  ON 56
ci_058                -1.563800e-03 3 1  ON 57
ci_059                -1.010877e-03 3 1  ON 58
ci_060                -9.532149e-04 3 1  ON 59
ci_061                -1.304095e-03 3 1  ON 60
ci_062                -7.728524e-04 3 1  ON 61
ci_063                -7.923744e-04 3 1  ON 62
ci_064                -8.571970e-04 3 1  ON 63
ci_065                -1.733156e-03 3 1  ON 64
ci_066                -1.969403e-03 3 1  ON 65
ci_067                -1.467391e-03 3 1  ON 66
ci_068                -1.150240e-03 3 1  ON 67
ci_069                 3.004180e-04 3 1  ON 68
ci_070                 2.677656e-04 3 1  ON 69
ci_071                -1.793422e-03 3 1  ON 70
ci_072                -1.749579e-03 3 1  ON 71
ci_073                 6.541163e-04 3 1  ON 72
ci_074                 5.878064e-04 3 1  ON 73
ci_075                -4.464516e-04 3 1  ON 74
ci_076                -3.860583e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4695e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2683e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7484
    reference variance = 0.36334
====================================================
  Execution time = 5.4039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1034e-01
  Total weights = 1.954934563e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496201443568
                                         uncertainty =       0.003706067934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496201443568
                                         uncertainty =       0.003706067934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498010355
  error estimate for blocks of size 2^( 2) =       0.000516318397
  error estimate for blocks of size 2^( 3) =       0.000533033329
  error estimate for blocks of size 2^( 4) =       0.000544702515
  error estimate for blocks of size 2^( 5) =       0.000551201274
  error estimate for blocks of size 2^( 6) =       0.000555042421
  error estimate for blocks of size 2^( 7) =       0.000554550335

      target function =      -0.607435375507
              le_mean =     -22.667972911391
             les_mean =     514.347333520117
             stat err =       0.000551374136
             autocorr =       1.225789889104
   target nu stat err =       0.000551374136
   target dn stat err =       0.005711391833
      target stat err =       0.001731975755
              std dev =       0.704292998391
             le_variance =       0.496028627583


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266797291139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607440024387       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607487103679       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607491903966       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607492315603       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607492439813       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607492470796       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607492463615       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607492457125       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607492462613       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607492464357       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.475305e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607440024387       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607452009804       residual = 8.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607453221825       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607453325064       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607453356021       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607453363532       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607453361701       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607453360113       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607453361466       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607453361879       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.853002e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607440024387       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607443034525       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607443338282       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607443364111       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607443371844       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607443373707       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607443373247       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607443372852       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607443373189       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607443373291       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.223791e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.587985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3461e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_001                -7.038619e-01 3 1  ON 0
ci_002                -7.021809e-01 3 1  ON 1
ci_003                -5.578396e-02 3 1  ON 2
ci_004                -5.599921e-02 3 1  ON 3
ci_005                 2.749342e-02 3 1  ON 4
ci_006                 2.748426e-02 3 1  ON 5
ci_007                 2.116796e-02 3 1  ON 6
ci_008                 2.164431e-02 3 1  ON 7
ci_009                -1.694691e-02 3 1  ON 8
ci_010                -1.668523e-02 3 1  ON 9
ci_011                -1.451586e-02 3 1  ON 10
ci_012                -1.434691e-02 3 1  ON 11
ci_013                 1.287340e-02 3 1  ON 12
ci_014                 1.276090e-02 3 1  ON 13
ci_015                 1.422312e-02 3 1  ON 14
ci_016                 1.405626e-02 3 1  ON 15
ci_017                 1.143501e-02 3 1  ON 16
ci_018                 1.166591e-02 3 1  ON 17
ci_019                 4.806769e-03 3 1  ON 18
ci_020                 4.925638e-03 3 1  ON 19
ci_021                -8.279132e-03 3 1  ON 20
ci_022                -8.462703e-03 3 1  ON 21
ci_023                 6.758764e-03 3 1  ON 22
ci_024                 6.752948e-03 3 1  ON 23
ci_025                 8.707739e-03 3 1  ON 24
ci_026                 8.704583e-03 3 1  ON 25
ci_027                 6.791716e-03 3 1  ON 26
ci_028                 6.910833e-03 3 1  ON 27
ci_029                -5.938525e-03 3 1  ON 28
ci_030                -5.926555e-03 3 1  ON 29
ci_031                -2.894843e-03 3 1  ON 30
ci_032                -3.189942e-03 3 1  ON 31
ci_033                 4.964204e-03 3 1  ON 32
ci_034                 4.835786e-03 3 1  ON 33
ci_035                 3.411132e-03 3 1  ON 34
ci_036                 3.606920e-03 3 1  ON 35
ci_037                 4.982189e-03 3 1  ON 36
ci_038                 4.930744e-03 3 1  ON 37
ci_039                 4.742173e-03 3 1  ON 38
ci_040                 4.786258e-03 3 1  ON 39
ci_041                 3.948306e-03 3 1  ON 40
ci_042                 3.866168e-03 3 1  ON 41
ci_043                 4.088715e-03 3 1  ON 42
ci_044                 4.104228e-03 3 1  ON 43
ci_045                 3.497821e-03 3 1  ON 44
ci_046                 3.505255e-03 3 1  ON 45
ci_047                -2.110584e-03 3 1  ON 46
ci_048                -2.193919e-03 3 1  ON 47
ci_049                 1.911627e-03 3 1  ON 48
ci_050                 1.815192e-03 3 1  ON 49
ci_051                -2.419214e-03 3 1  ON 50
ci_052                -2.176024e-03 3 1  ON 51
ci_053                -2.318945e-03 3 1  ON 52
ci_054                -2.515259e-03 3 1  ON 53
ci_055                -1.515070e-03 3 1  ON 54
ci_056                -1.652409e-03 3 1  ON 55
ci_057                -1.408448e-03 3 1  ON 56
ci_058                -1.561927e-03 3 1  ON 57
ci_059                -1.001340e-03 3 1  ON 58
ci_060                -9.524924e-04 3 1  ON 59
ci_061                -1.298753e-03 3 1  ON 60
ci_062                -7.770975e-04 3 1  ON 61
ci_063                -7.930438e-04 3 1  ON 62
ci_064                -8.543407e-04 3 1  ON 63
ci_065                -1.732641e-03 3 1  ON 64
ci_066                -1.970642e-03 3 1  ON 65
ci_067                -1.474096e-03 3 1  ON 66
ci_068                -1.152192e-03 3 1  ON 67
ci_069                 3.025398e-04 3 1  ON 68
ci_070                 2.684633e-04 3 1  ON 69
ci_071                -1.790616e-03 3 1  ON 70
ci_072                -1.748447e-03 3 1  ON 71
ci_073                 6.440674e-04 3 1  ON 72
ci_074                 5.802383e-04 3 1  ON 73
ci_075                -4.379771e-04 3 1  ON 74
ci_076                -3.823018e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7054
    reference variance = 0.346862
====================================================
  Execution time = 4.9746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0334e-01
  Total weights = 1.9548e+06
  Execution time = 7.2099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489332117299
                                         uncertainty =       0.003112568709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489332117299
                                         uncertainty =       0.003112568709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494591032
  error estimate for blocks of size 2^( 2) =       0.000513038245
  error estimate for blocks of size 2^( 3) =       0.000529302864
  error estimate for blocks of size 2^( 4) =       0.000542764877
  error estimate for blocks of size 2^( 5) =       0.000550642489
  error estimate for blocks of size 2^( 6) =       0.000554571330
  error estimate for blocks of size 2^( 7) =       0.000557218688

      target function =      -0.609306610643
              le_mean =     -22.667336800208
             les_mean =     514.311751518117
             stat err =       0.000551299346
             autocorr =       1.242460179781
   target nu stat err =       0.000551299346
   target dn stat err =       0.003837447934
      target stat err =       0.001187461031
              std dev =       0.699457345911
             le_variance =       0.489240578749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489060184032
                                         uncertainty =       0.003117963443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489060184032
                                         uncertainty =       0.003117963443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494453683
  error estimate for blocks of size 2^( 2) =       0.000512897244
  error estimate for blocks of size 2^( 3) =       0.000529157173
  error estimate for blocks of size 2^( 4) =       0.000542614936
  error estimate for blocks of size 2^( 5) =       0.000550487715
  error estimate for blocks of size 2^( 6) =       0.000554410989
  error estimate for blocks of size 2^( 7) =       0.000557058299

      target function =      -0.609322458677
              le_mean =     -22.667342067121
             les_mean =     514.311941281636
             stat err =       0.000551142985
             autocorr =       1.242445465718
   target nu stat err =       0.000551142985
   target dn stat err =       0.004026775304
      target stat err =       0.001243081953
              std dev =       0.699263104322
             le_variance =       0.488968889066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489191609361
                                         uncertainty =       0.003115301547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489191609361
                                         uncertainty =       0.003115301547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494520068
  error estimate for blocks of size 2^( 2) =       0.000512965389
  error estimate for blocks of size 2^( 3) =       0.000529227618
  error estimate for blocks of size 2^( 4) =       0.000542687551
  error estimate for blocks of size 2^( 5) =       0.000550562728
  error estimate for blocks of size 2^( 6) =       0.000554488762
  error estimate for blocks of size 2^( 7) =       0.000557136031

      target function =      -0.609378799927
              le_mean =     -22.667339200200
             les_mean =     514.311622417562
             stat err =       0.000551218768
             autocorr =       1.242453521415
   target nu stat err =       0.000551218768
   target dn stat err =       0.003895633660
      target stat err =       0.001204796118
              std dev =       0.699356987487
             le_variance =       0.489100195946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489314245231
                                         uncertainty =       0.003112909853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489314245231
                                         uncertainty =       0.003112909853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494582007
  error estimate for blocks of size 2^( 2) =       0.000513028933
  error estimate for blocks of size 2^( 3) =       0.000529293280
  error estimate for blocks of size 2^( 4) =       0.000542755094
  error estimate for blocks of size 2^( 5) =       0.000550632151
  error estimate for blocks of size 2^( 6) =       0.000554560576
  error estimate for blocks of size 2^( 7) =       0.000557207834

      target function =      -0.609297323868
              le_mean =     -22.667337121581
             les_mean =     514.311797155361
             stat err =       0.000551288914
             autocorr =       1.242458505295
   target nu stat err =       0.000551288914
   target dn stat err =       0.003846002616
      target stat err =       0.001189932754
              std dev =       0.699444581493
             le_variance =       0.489222722580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609306610643        initial
     1.5625e+00     1.5625e+01             3.4753e-04        -0.609322458677
     6.2500e+00     6.2500e+01             8.8530e-05        -0.609378799927  <--
     2.5000e+01     2.5000e+02             2.2238e-05        -0.609297323868

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.5905e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_001                -7.038619e-01 3 1  ON 0
ci_002                -7.021809e-01 3 1  ON 1
ci_003                -5.578396e-02 3 1  ON 2
ci_004                -5.599921e-02 3 1  ON 3
ci_005                 2.749342e-02 3 1  ON 4
ci_006                 2.748426e-02 3 1  ON 5
ci_007                 2.116796e-02 3 1  ON 6
ci_008                 2.164431e-02 3 1  ON 7
ci_009                -1.694691e-02 3 1  ON 8
ci_010                -1.668523e-02 3 1  ON 9
ci_011                -1.451586e-02 3 1  ON 10
ci_012                -1.434691e-02 3 1  ON 11
ci_013                 1.287340e-02 3 1  ON 12
ci_014                 1.276090e-02 3 1  ON 13
ci_015                 1.422312e-02 3 1  ON 14
ci_016                 1.405626e-02 3 1  ON 15
ci_017                 1.143501e-02 3 1  ON 16
ci_018                 1.166591e-02 3 1  ON 17
ci_019                 4.806769e-03 3 1  ON 18
ci_020                 4.925638e-03 3 1  ON 19
ci_021                -8.279132e-03 3 1  ON 20
ci_022                -8.462703e-03 3 1  ON 21
ci_023                 6.758764e-03 3 1  ON 22
ci_024                 6.752948e-03 3 1  ON 23
ci_025                 8.707739e-03 3 1  ON 24
ci_026                 8.704583e-03 3 1  ON 25
ci_027                 6.791716e-03 3 1  ON 26
ci_028                 6.910833e-03 3 1  ON 27
ci_029                -5.938525e-03 3 1  ON 28
ci_030                -5.926555e-03 3 1  ON 29
ci_031                -2.894843e-03 3 1  ON 30
ci_032                -3.189942e-03 3 1  ON 31
ci_033                 4.964204e-03 3 1  ON 32
ci_034                 4.835786e-03 3 1  ON 33
ci_035                 3.411132e-03 3 1  ON 34
ci_036                 3.606920e-03 3 1  ON 35
ci_037                 4.982189e-03 3 1  ON 36
ci_038                 4.930744e-03 3 1  ON 37
ci_039                 4.742173e-03 3 1  ON 38
ci_040                 4.786258e-03 3 1  ON 39
ci_041                 3.948306e-03 3 1  ON 40
ci_042                 3.866168e-03 3 1  ON 41
ci_043                 4.088715e-03 3 1  ON 42
ci_044                 4.104228e-03 3 1  ON 43
ci_045                 3.497821e-03 3 1  ON 44
ci_046                 3.505255e-03 3 1  ON 45
ci_047                -2.110584e-03 3 1  ON 46
ci_048                -2.193919e-03 3 1  ON 47
ci_049                 1.911627e-03 3 1  ON 48
ci_050                 1.815192e-03 3 1  ON 49
ci_051                -2.419214e-03 3 1  ON 50
ci_052                -2.176024e-03 3 1  ON 51
ci_053                -2.318945e-03 3 1  ON 52
ci_054                -2.515259e-03 3 1  ON 53
ci_055                -1.515070e-03 3 1  ON 54
ci_056                -1.652409e-03 3 1  ON 55
ci_057                -1.408448e-03 3 1  ON 56
ci_058                -1.561927e-03 3 1  ON 57
ci_059                -1.001340e-03 3 1  ON 58
ci_060                -9.524924e-04 3 1  ON 59
ci_061                -1.298753e-03 3 1  ON 60
ci_062                -7.770975e-04 3 1  ON 61
ci_063                -7.930438e-04 3 1  ON 62
ci_064                -8.543407e-04 3 1  ON 63
ci_065                -1.732641e-03 3 1  ON 64
ci_066                -1.970642e-03 3 1  ON 65
ci_067                -1.474096e-03 3 1  ON 66
ci_068                -1.152192e-03 3 1  ON 67
ci_069                 3.025398e-04 3 1  ON 68
ci_070                 2.684633e-04 3 1  ON 69
ci_071                -1.790616e-03 3 1  ON 70
ci_072                -1.748447e-03 3 1  ON 71
ci_073                 6.440674e-04 3 1  ON 72
ci_074                 5.802383e-04 3 1  ON 73
ci_075                -4.379771e-04 3 1  ON 74
ci_076                -3.823018e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4937e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6906
    reference variance = 0.497347
====================================================
  Execution time = 5.1332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0327e-01
  Total weights = 1.954695167e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490457165950
                                         uncertainty =       0.003027057491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490457165950
                                         uncertainty =       0.003027057491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495208759
  error estimate for blocks of size 2^( 2) =       0.000513203357
  error estimate for blocks of size 2^( 3) =       0.000530182789
  error estimate for blocks of size 2^( 4) =       0.000542097742
  error estimate for blocks of size 2^( 5) =       0.000549002542
  error estimate for blocks of size 2^( 6) =       0.000553700601
  error estimate for blocks of size 2^( 7) =       0.000554453560

      target function =      -0.609662194545
              le_mean =     -22.668381473012
             les_mean =     514.358793440685
             stat err =       0.000549813611
             autocorr =       1.232691322910
   target nu stat err =       0.000549813611
   target dn stat err =       0.003757233824
      target stat err =       0.001166098190
              std dev =       0.700330943177
             le_variance =       0.490463429971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266838147301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609664141274       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609713471286       residual = 9.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609719060210       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609719560929       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609719736942       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609719748123       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609719747628       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609719752382       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609719752696       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.305783e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609664141274       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609676701804       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609678112975       residual = 9.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609678238177       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609678281854       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609678284441       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609678284293       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609678285452       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609678285526       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.423856e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609664141274       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609667295987       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609667649657       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609667680957       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609667691855       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609667692489       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609667692450       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609667692738       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609667692756       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.116166e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.592531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0662e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_001                -7.038712e-01 3 1  ON 0
ci_002                -7.021943e-01 3 1  ON 1
ci_003                -5.575246e-02 3 1  ON 2
ci_004                -5.596886e-02 3 1  ON 3
ci_005                 2.740918e-02 3 1  ON 4
ci_006                 2.740421e-02 3 1  ON 5
ci_007                 2.112677e-02 3 1  ON 6
ci_008                 2.158860e-02 3 1  ON 7
ci_009                -1.691389e-02 3 1  ON 8
ci_010                -1.665240e-02 3 1  ON 9
ci_011                -1.447031e-02 3 1  ON 10
ci_012                -1.430335e-02 3 1  ON 11
ci_013                 1.284471e-02 3 1  ON 12
ci_014                 1.272790e-02 3 1  ON 13
ci_015                 1.419280e-02 3 1  ON 14
ci_016                 1.401401e-02 3 1  ON 15
ci_017                 1.141120e-02 3 1  ON 16
ci_018                 1.164812e-02 3 1  ON 17
ci_019                 4.775412e-03 3 1  ON 18
ci_020                 4.902496e-03 3 1  ON 19
ci_021                -8.270423e-03 3 1  ON 20
ci_022                -8.456688e-03 3 1  ON 21
ci_023                 6.744302e-03 3 1  ON 22
ci_024                 6.745182e-03 3 1  ON 23
ci_025                 8.715857e-03 3 1  ON 24
ci_026                 8.723736e-03 3 1  ON 25
ci_027                 6.789468e-03 3 1  ON 26
ci_028                 6.904369e-03 3 1  ON 27
ci_029                -5.925841e-03 3 1  ON 28
ci_030                -5.919124e-03 3 1  ON 29
ci_031                -2.861047e-03 3 1  ON 30
ci_032                -3.168310e-03 3 1  ON 31
ci_033                 4.945154e-03 3 1  ON 32
ci_034                 4.827417e-03 3 1  ON 33
ci_035                 3.393383e-03 3 1  ON 34
ci_036                 3.589215e-03 3 1  ON 35
ci_037                 4.979926e-03 3 1  ON 36
ci_038                 4.920504e-03 3 1  ON 37
ci_039                 4.739970e-03 3 1  ON 38
ci_040                 4.784397e-03 3 1  ON 39
ci_041                 3.947855e-03 3 1  ON 40
ci_042                 3.859449e-03 3 1  ON 41
ci_043                 4.081472e-03 3 1  ON 42
ci_044                 4.104748e-03 3 1  ON 43
ci_045                 3.486018e-03 3 1  ON 44
ci_046                 3.509858e-03 3 1  ON 45
ci_047                -2.097999e-03 3 1  ON 46
ci_048                -2.180570e-03 3 1  ON 47
ci_049                 1.904729e-03 3 1  ON 48
ci_050                 1.809497e-03 3 1  ON 49
ci_051                -2.411481e-03 3 1  ON 50
ci_052                -2.165428e-03 3 1  ON 51
ci_053                -2.321653e-03 3 1  ON 52
ci_054                -2.512690e-03 3 1  ON 53
ci_055                -1.509392e-03 3 1  ON 54
ci_056                -1.638293e-03 3 1  ON 55
ci_057                -1.412341e-03 3 1  ON 56
ci_058                -1.556696e-03 3 1  ON 57
ci_059                -9.994954e-04 3 1  ON 58
ci_060                -9.466004e-04 3 1  ON 59
ci_061                -1.281434e-03 3 1  ON 60
ci_062                -7.784141e-04 3 1  ON 61
ci_063                -8.030781e-04 3 1  ON 62
ci_064                -8.525355e-04 3 1  ON 63
ci_065                -1.734193e-03 3 1  ON 64
ci_066                -1.976284e-03 3 1  ON 65
ci_067                -1.467845e-03 3 1  ON 66
ci_068                -1.146628e-03 3 1  ON 67
ci_069                 2.965269e-04 3 1  ON 68
ci_070                 2.643951e-04 3 1  ON 69
ci_071                -1.780724e-03 3 1  ON 70
ci_072                -1.742396e-03 3 1  ON 71
ci_073                 6.433402e-04 3 1  ON 72
ci_074                 5.789316e-04 3 1  ON 73
ci_075                -4.322516e-04 3 1  ON 74
ci_076                -3.786778e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7175
    reference variance = 0.464313
====================================================
  Execution time = 4.9863e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.1905e-01
  Total weights = 1.9553e+06
  Execution time = 7.2544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500540579225
                                         uncertainty =       0.012728139569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500540579225
                                         uncertainty =       0.012728139569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500198568
  error estimate for blocks of size 2^( 2) =       0.000518334916
  error estimate for blocks of size 2^( 3) =       0.000534478464
  error estimate for blocks of size 2^( 4) =       0.000546957375
  error estimate for blocks of size 2^( 5) =       0.000554732726
  error estimate for blocks of size 2^( 6) =       0.000558986460
  error estimate for blocks of size 2^( 7) =       0.000562368991

      target function =      -0.604554078542
              le_mean =     -22.667108517306
             les_mean =     514.316952010869
             stat err =       0.000555761388
             autocorr =       1.234502155619
   target nu stat err =       0.000555761388
   target dn stat err =       0.018890150066
      target stat err =       0.005607015958
              std dev =       0.707387598997
             le_variance =       0.500397215215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500123451329
                                         uncertainty =       0.012582949046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500123451329
                                         uncertainty =       0.012582949046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499990401
  error estimate for blocks of size 2^( 2) =       0.000518127708
  error estimate for blocks of size 2^( 3) =       0.000534271011
  error estimate for blocks of size 2^( 4) =       0.000546744026
  error estimate for blocks of size 2^( 5) =       0.000554521521
  error estimate for blocks of size 2^( 6) =       0.000558771230
  error estimate for blocks of size 2^( 7) =       0.000562162270

      target function =      -0.601398171276
              le_mean =     -22.667113891049
             les_mean =     514.327850213622
             stat err =       0.000555549762
             autocorr =       1.234589554311
   target nu stat err =       0.000555549762
   target dn stat err =       0.021545319001
      target stat err =       0.006327045412
              std dev =       0.707093206151
             le_variance =       0.499980802184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500326513950
                                         uncertainty =       0.012654417166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500326513950
                                         uncertainty =       0.012654417166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500091749
  error estimate for blocks of size 2^( 2) =       0.000518228515
  error estimate for blocks of size 2^( 3) =       0.000534371946
  error estimate for blocks of size 2^( 4) =       0.000546847666
  error estimate for blocks of size 2^( 5) =       0.000554624027
  error estimate for blocks of size 2^( 6) =       0.000558876242
  error estimate for blocks of size 2^( 7) =       0.000562263030

      target function =      -0.604591278004
              le_mean =     -22.667111112906
             les_mean =     514.316948394455
             stat err =       0.000555652741
             autocorr =       1.234546761889
   target nu stat err =       0.000555652741
   target dn stat err =       0.018777215925
      target stat err =       0.005574262608
              std dev =       0.707236533410
             le_variance =       0.500183514189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500513463946
                                         uncertainty =       0.012718864160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500513463946
                                         uncertainty =       0.012718864160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500185039
  error estimate for blocks of size 2^( 2) =       0.000518321437
  error estimate for blocks of size 2^( 3) =       0.000534464971
  error estimate for blocks of size 2^( 4) =       0.000546943487
  error estimate for blocks of size 2^( 5) =       0.000554718961
  error estimate for blocks of size 2^( 6) =       0.000558972492
  error estimate for blocks of size 2^( 7) =       0.000562355565

      target function =      -0.604534746218
              le_mean =     -22.667108810181
             les_mean =     514.317031006940
             stat err =       0.000555747626
             autocorr =       1.234507800757
   target nu stat err =       0.000555747626
   target dn stat err =       0.018876177512
      target stat err =       0.005602520749
              std dev =       0.707368465416
             le_variance =       0.500370145866


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.604554078542        initial
     1.5625e+00     1.5625e+01             3.3058e-04        -0.601398171276
     6.2500e+00     6.2500e+01             8.4239e-05        -0.604591278004  <--
     2.5000e+01     2.5000e+02             2.1162e-05        -0.604534746218

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.6261e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_001                -7.038712e-01 3 1  ON 0
ci_002                -7.021943e-01 3 1  ON 1
ci_003                -5.575246e-02 3 1  ON 2
ci_004                -5.596886e-02 3 1  ON 3
ci_005                 2.740918e-02 3 1  ON 4
ci_006                 2.740421e-02 3 1  ON 5
ci_007                 2.112677e-02 3 1  ON 6
ci_008                 2.158860e-02 3 1  ON 7
ci_009                -1.691389e-02 3 1  ON 8
ci_010                -1.665240e-02 3 1  ON 9
ci_011                -1.447031e-02 3 1  ON 10
ci_012                -1.430335e-02 3 1  ON 11
ci_013                 1.284471e-02 3 1  ON 12
ci_014                 1.272790e-02 3 1  ON 13
ci_015                 1.419280e-02 3 1  ON 14
ci_016                 1.401401e-02 3 1  ON 15
ci_017                 1.141120e-02 3 1  ON 16
ci_018                 1.164812e-02 3 1  ON 17
ci_019                 4.775412e-03 3 1  ON 18
ci_020                 4.902496e-03 3 1  ON 19
ci_021                -8.270423e-03 3 1  ON 20
ci_022                -8.456688e-03 3 1  ON 21
ci_023                 6.744302e-03 3 1  ON 22
ci_024                 6.745182e-03 3 1  ON 23
ci_025                 8.715857e-03 3 1  ON 24
ci_026                 8.723736e-03 3 1  ON 25
ci_027                 6.789468e-03 3 1  ON 26
ci_028                 6.904369e-03 3 1  ON 27
ci_029                -5.925841e-03 3 1  ON 28
ci_030                -5.919124e-03 3 1  ON 29
ci_031                -2.861047e-03 3 1  ON 30
ci_032                -3.168310e-03 3 1  ON 31
ci_033                 4.945154e-03 3 1  ON 32
ci_034                 4.827417e-03 3 1  ON 33
ci_035                 3.393383e-03 3 1  ON 34
ci_036                 3.589215e-03 3 1  ON 35
ci_037                 4.979926e-03 3 1  ON 36
ci_038                 4.920504e-03 3 1  ON 37
ci_039                 4.739970e-03 3 1  ON 38
ci_040                 4.784397e-03 3 1  ON 39
ci_041                 3.947855e-03 3 1  ON 40
ci_042                 3.859449e-03 3 1  ON 41
ci_043                 4.081472e-03 3 1  ON 42
ci_044                 4.104748e-03 3 1  ON 43
ci_045                 3.486018e-03 3 1  ON 44
ci_046                 3.509858e-03 3 1  ON 45
ci_047                -2.097999e-03 3 1  ON 46
ci_048                -2.180570e-03 3 1  ON 47
ci_049                 1.904729e-03 3 1  ON 48
ci_050                 1.809497e-03 3 1  ON 49
ci_051                -2.411481e-03 3 1  ON 50
ci_052                -2.165428e-03 3 1  ON 51
ci_053                -2.321653e-03 3 1  ON 52
ci_054                -2.512690e-03 3 1  ON 53
ci_055                -1.509392e-03 3 1  ON 54
ci_056                -1.638293e-03 3 1  ON 55
ci_057                -1.412341e-03 3 1  ON 56
ci_058                -1.556696e-03 3 1  ON 57
ci_059                -9.994954e-04 3 1  ON 58
ci_060                -9.466004e-04 3 1  ON 59
ci_061                -1.281434e-03 3 1  ON 60
ci_062                -7.784141e-04 3 1  ON 61
ci_063                -8.030781e-04 3 1  ON 62
ci_064                -8.525355e-04 3 1  ON 63
ci_065                -1.734193e-03 3 1  ON 64
ci_066                -1.976284e-03 3 1  ON 65
ci_067                -1.467845e-03 3 1  ON 66
ci_068                -1.146628e-03 3 1  ON 67
ci_069                 2.965269e-04 3 1  ON 68
ci_070                 2.643951e-04 3 1  ON 69
ci_071                -1.780724e-03 3 1  ON 70
ci_072                -1.742396e-03 3 1  ON 71
ci_073                 6.433402e-04 3 1  ON 72
ci_074                 5.789316e-04 3 1  ON 73
ci_075                -4.322516e-04 3 1  ON 74
ci_076                -3.786778e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4693e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7459
    reference variance = 0.988643
====================================================
  Execution time = 5.2295e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0389e-01
  Total weights = 1.955004060e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488416942569
                                         uncertainty =       0.002525797582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488416942569
                                         uncertainty =       0.002525797582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494170402
  error estimate for blocks of size 2^( 2) =       0.000512527407
  error estimate for blocks of size 2^( 3) =       0.000528863603
  error estimate for blocks of size 2^( 4) =       0.000541478410
  error estimate for blocks of size 2^( 5) =       0.000549314614
  error estimate for blocks of size 2^( 6) =       0.000554142261
  error estimate for blocks of size 2^( 7) =       0.000556294579

      target function =      -0.609367223342
              le_mean =     -22.667938484620
             les_mean =     514.339322303961
             stat err =       0.000550307466
             autocorr =       1.240101834794
   target nu stat err =       0.000550307466
   target dn stat err =       0.004059190853
      target stat err =       0.001253306507
              std dev =       0.698862484297
             le_variance =       0.488408771958


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266793848462e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609369510810       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609414469568       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609419508911       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609420045333       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609420226195       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609420290516       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609420311277       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609420313442       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.192865e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609369510810       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609380957166       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609382229117       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609382363206       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609382407875       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609382423572       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609382428645       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609382429173       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.134859e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609369510810       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609372385613       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609372704362       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609372737881       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609372749013       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609372752913       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609372754174       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609372754305       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.043486e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.596441 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1746e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_001                -7.038844e-01 3 1  ON 0
ci_002                -7.022046e-01 3 1  ON 1
ci_003                -5.570264e-02 3 1  ON 2
ci_004                -5.593522e-02 3 1  ON 3
ci_005                 2.732783e-02 3 1  ON 4
ci_006                 2.733166e-02 3 1  ON 5
ci_007                 2.107903e-02 3 1  ON 6
ci_008                 2.153699e-02 3 1  ON 7
ci_009                -1.687565e-02 3 1  ON 8
ci_010                -1.661056e-02 3 1  ON 9
ci_011                -1.444210e-02 3 1  ON 10
ci_012                -1.426163e-02 3 1  ON 11
ci_013                 1.281399e-02 3 1  ON 12
ci_014                 1.270070e-02 3 1  ON 13
ci_015                 1.416334e-02 3 1  ON 14
ci_016                 1.398184e-02 3 1  ON 15
ci_017                 1.139525e-02 3 1  ON 16
ci_018                 1.162029e-02 3 1  ON 17
ci_019                 4.747090e-03 3 1  ON 18
ci_020                 4.889975e-03 3 1  ON 19
ci_021                -8.267014e-03 3 1  ON 20
ci_022                -8.452565e-03 3 1  ON 21
ci_023                 6.741791e-03 3 1  ON 22
ci_024                 6.740017e-03 3 1  ON 23
ci_025                 8.739674e-03 3 1  ON 24
ci_026                 8.720455e-03 3 1  ON 25
ci_027                 6.787991e-03 3 1  ON 26
ci_028                 6.905776e-03 3 1  ON 27
ci_029                -5.904416e-03 3 1  ON 28
ci_030                -5.896841e-03 3 1  ON 29
ci_031                -2.832102e-03 3 1  ON 30
ci_032                -3.154200e-03 3 1  ON 31
ci_033                 4.945023e-03 3 1  ON 32
ci_034                 4.810529e-03 3 1  ON 33
ci_035                 3.380236e-03 3 1  ON 34
ci_036                 3.582377e-03 3 1  ON 35
ci_037                 4.980463e-03 3 1  ON 36
ci_038                 4.915525e-03 3 1  ON 37
ci_039                 4.740868e-03 3 1  ON 38
ci_040                 4.780604e-03 3 1  ON 39
ci_041                 3.938489e-03 3 1  ON 40
ci_042                 3.848315e-03 3 1  ON 41
ci_043                 4.084636e-03 3 1  ON 42
ci_044                 4.104043e-03 3 1  ON 43
ci_045                 3.464495e-03 3 1  ON 44
ci_046                 3.518082e-03 3 1  ON 45
ci_047                -2.088175e-03 3 1  ON 46
ci_048                -2.174099e-03 3 1  ON 47
ci_049                 1.896310e-03 3 1  ON 48
ci_050                 1.804774e-03 3 1  ON 49
ci_051                -2.395599e-03 3 1  ON 50
ci_052                -2.161137e-03 3 1  ON 51
ci_053                -2.315330e-03 3 1  ON 52
ci_054                -2.508880e-03 3 1  ON 53
ci_055                -1.495969e-03 3 1  ON 54
ci_056                -1.631989e-03 3 1  ON 55
ci_057                -1.406723e-03 3 1  ON 56
ci_058                -1.544015e-03 3 1  ON 57
ci_059                -9.944071e-04 3 1  ON 58
ci_060                -9.458475e-04 3 1  ON 59
ci_061                -1.269715e-03 3 1  ON 60
ci_062                -7.828960e-04 3 1  ON 61
ci_063                -7.880387e-04 3 1  ON 62
ci_064                -8.592716e-04 3 1  ON 63
ci_065                -1.736707e-03 3 1  ON 64
ci_066                -1.985788e-03 3 1  ON 65
ci_067                -1.479597e-03 3 1  ON 66
ci_068                -1.135761e-03 3 1  ON 67
ci_069                 2.854980e-04 3 1  ON 68
ci_070                 2.634817e-04 3 1  ON 69
ci_071                -1.785532e-03 3 1  ON 70
ci_072                -1.748982e-03 3 1  ON 71
ci_073                 6.412646e-04 3 1  ON 72
ci_074                 5.783238e-04 3 1  ON 73
ci_075                -4.337250e-04 3 1  ON 74
ci_076                -3.801862e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.649
    reference variance = 0.340597
====================================================
  Execution time = 4.9819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9976e-01
  Total weights = 1.9550e+06
  Execution time = 7.2431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488717154207
                                         uncertainty =       0.002264675035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488717154207
                                         uncertainty =       0.002264675035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494369890
  error estimate for blocks of size 2^( 2) =       0.000512581785
  error estimate for blocks of size 2^( 3) =       0.000529550325
  error estimate for blocks of size 2^( 4) =       0.000540870321
  error estimate for blocks of size 2^( 5) =       0.000548503083
  error estimate for blocks of size 2^( 6) =       0.000552170988
  error estimate for blocks of size 2^( 7) =       0.000553198759

      target function =      -0.610652001882
              le_mean =     -22.668566054229
             les_mean =     514.364041867889
             stat err =       0.000548685788
             autocorr =       1.231809073156
   target nu stat err =       0.000548685788
   target dn stat err =       0.003110345463
      target stat err =       0.000980372197
              std dev =       0.699144603350
             le_variance =       0.488803176393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488457637897
                                         uncertainty =       0.002265609702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488457637897
                                         uncertainty =       0.002265609702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494238800
  error estimate for blocks of size 2^( 2) =       0.000512448379
  error estimate for blocks of size 2^( 3) =       0.000529416628
  error estimate for blocks of size 2^( 4) =       0.000540733358
  error estimate for blocks of size 2^( 5) =       0.000548364059
  error estimate for blocks of size 2^( 6) =       0.000552034656
  error estimate for blocks of size 2^( 7) =       0.000553061052

      target function =      -0.610830677246
              le_mean =     -22.668569305226
             les_mean =     514.363602059405
             stat err =       0.000548548281
             autocorr =       1.231844941504
   target nu stat err =       0.000548548281
   target dn stat err =       0.003110348376
      target stat err =       0.000980908411
              std dev =       0.698959214004
             le_variance =       0.488543982841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488583185061
                                         uncertainty =       0.002265015051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488583185061
                                         uncertainty =       0.002265015051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494302222
  error estimate for blocks of size 2^( 2) =       0.000512512925
  error estimate for blocks of size 2^( 3) =       0.000529481308
  error estimate for blocks of size 2^( 4) =       0.000540799625
  error estimate for blocks of size 2^( 5) =       0.000548431341
  error estimate for blocks of size 2^( 6) =       0.000552100579
  error estimate for blocks of size 2^( 7) =       0.000553127689

      target function =      -0.610797248621
              le_mean =     -22.668567456624
             les_mean =     514.363627077816
             stat err =       0.000548614809
             autocorr =       1.231827591452
   target nu stat err =       0.000548614809
   target dn stat err =       0.003103741542
      target stat err =       0.000978889985
              std dev =       0.699048905781
             le_variance =       0.488669372674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488700113943
                                         uncertainty =       0.002264703209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488700113943
                                         uncertainty =       0.002264703209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494361283
  error estimate for blocks of size 2^( 2) =       0.000512573033
  error estimate for blocks of size 2^( 3) =       0.000529541560
  error estimate for blocks of size 2^( 4) =       0.000540861298
  error estimate for blocks of size 2^( 5) =       0.000548493917
  error estimate for blocks of size 2^( 6) =       0.000552161982
  error estimate for blocks of size 2^( 7) =       0.000553189778

      target function =      -0.610742047309
              le_mean =     -22.668566195509
             les_mean =     514.363751099568
             stat err =       0.000548676744
             autocorr =       1.231811354455
   target nu stat err =       0.000548676744
   target dn stat err =       0.003099260968
      target stat err =       0.000977423825
              std dev =       0.699132431708
             le_variance =       0.488786157066


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610652001882        initial
     1.5625e+00     1.5625e+01             3.1929e-04        -0.610830677246  <--
     6.2500e+00     6.2500e+01             8.1349e-05        -0.610797248621
     2.5000e+01     2.5000e+02             2.0435e-05        -0.610742047309

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.6126e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_001                -7.039232e-01 3 1  ON 0
ci_002                -7.022346e-01 3 1  ON 1
ci_003                -5.555464e-02 3 1  ON 2
ci_004                -5.583532e-02 3 1  ON 3
ci_005                 2.708989e-02 3 1  ON 4
ci_006                 2.711944e-02 3 1  ON 5
ci_007                 2.093892e-02 3 1  ON 6
ci_008                 2.138553e-02 3 1  ON 7
ci_009                -1.676349e-02 3 1  ON 8
ci_010                -1.648778e-02 3 1  ON 9
ci_011                -1.435939e-02 3 1  ON 10
ci_012                -1.413917e-02 3 1  ON 11
ci_013                 1.272385e-02 3 1  ON 12
ci_014                 1.262082e-02 3 1  ON 13
ci_015                 1.407661e-02 3 1  ON 14
ci_016                 1.388710e-02 3 1  ON 15
ci_017                 1.134854e-02 3 1  ON 16
ci_018                 1.153854e-02 3 1  ON 17
ci_019                 4.663647e-03 3 1  ON 18
ci_020                 4.853037e-03 3 1  ON 19
ci_021                -8.257088e-03 3 1  ON 20
ci_022                -8.440444e-03 3 1  ON 21
ci_023                 6.734414e-03 3 1  ON 22
ci_024                 6.724888e-03 3 1  ON 23
ci_025                 8.809784e-03 3 1  ON 24
ci_026                 8.710815e-03 3 1  ON 25
ci_027                 6.783725e-03 3 1  ON 26
ci_028                 6.909928e-03 3 1  ON 27
ci_029                -5.841398e-03 3 1  ON 28
ci_030                -5.831256e-03 3 1  ON 29
ci_031                -2.747022e-03 3 1  ON 30
ci_032                -3.112707e-03 3 1  ON 31
ci_033                 4.944646e-03 3 1  ON 32
ci_034                 4.760859e-03 3 1  ON 33
ci_035                 3.341731e-03 3 1  ON 34
ci_036                 3.562324e-03 3 1  ON 35
ci_037                 4.981952e-03 3 1  ON 36
ci_038                 4.900874e-03 3 1  ON 37
ci_039                 4.743520e-03 3 1  ON 38
ci_040                 4.769543e-03 3 1  ON 39
ci_041                 3.911081e-03 3 1  ON 40
ci_042                 3.815748e-03 3 1  ON 41
ci_043                 4.093889e-03 3 1  ON 42
ci_044                 4.101870e-03 3 1  ON 43
ci_045                 3.401326e-03 3 1  ON 44
ci_046                 3.542364e-03 3 1  ON 45
ci_047                -2.059407e-03 3 1  ON 46
ci_048                -2.155100e-03 3 1  ON 47
ci_049                 1.871622e-03 3 1  ON 48
ci_050                 1.790928e-03 3 1  ON 49
ci_051                -2.348825e-03 3 1  ON 50
ci_052                -2.148367e-03 3 1  ON 51
ci_053                -2.296836e-03 3 1  ON 52
ci_054                -2.497771e-03 3 1  ON 53
ci_055                -1.456485e-03 3 1  ON 54
ci_056                -1.613520e-03 3 1  ON 55
ci_057                -1.390250e-03 3 1  ON 56
ci_058                -1.506846e-03 3 1  ON 57
ci_059                -9.795129e-04 3 1  ON 58
ci_060                -9.436222e-04 3 1  ON 59
ci_061                -1.235272e-03 3 1  ON 60
ci_062                -7.960588e-04 3 1  ON 61
ci_063                -7.439590e-04 3 1  ON 62
ci_064                -8.791464e-04 3 1  ON 63
ci_065                -1.744018e-03 3 1  ON 64
ci_066                -2.013672e-03 3 1  ON 65
ci_067                -1.514207e-03 3 1  ON 66
ci_068                -1.103839e-03 3 1  ON 67
ci_069                 2.531153e-04 3 1  ON 68
ci_070                 2.607610e-04 3 1  ON 69
ci_071                -1.799616e-03 3 1  ON 70
ci_072                -1.768289e-03 3 1  ON 71
ci_073                 6.351001e-04 3 1  ON 72
ci_074                 5.765061e-04 3 1  ON 73
ci_075                -4.380421e-04 3 1  ON 74
ci_076                -3.845488e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4788e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6487
    reference variance = 0.365727
====================================================
  Execution time = 5.1118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0526e-01
  Total weights = 1.955051777e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492261785393
                                         uncertainty =       0.002508578886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492261785393
                                         uncertainty =       0.002508578886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496094332
  error estimate for blocks of size 2^( 2) =       0.000514205376
  error estimate for blocks of size 2^( 3) =       0.000531045097
  error estimate for blocks of size 2^( 4) =       0.000543078232
  error estimate for blocks of size 2^( 5) =       0.000550575306
  error estimate for blocks of size 2^( 6) =       0.000554763606
  error estimate for blocks of size 2^( 7) =       0.000559532507

      target function =      -0.608957043193
              le_mean =     -22.667947625660
             les_mean =     514.341106243105
             stat err =       0.000551987413
             autocorr =       1.238026153835
   target nu stat err =       0.000551987413
   target dn stat err =       0.004062233297
      target stat err =       0.001252743233
              std dev =       0.701583331916
             le_variance =       0.492219171622


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266794762566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608959291611       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609115360827       residual = 9.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609136263781       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609139189218       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609140175003       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609140514120       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609140583594       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609140603661       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609140627570       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609140636331       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609140628300       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.142865e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608959291611       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609001151266       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609006589067       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609007322986       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609007556841       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609007633366       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609007648196       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609007652484       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609007657796       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609007659366       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609007657597       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.074067e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608959291611       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608969950577       residual = 9.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608971323675       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608971507161       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608971564737       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608971583330       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608971586879       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608971587907       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608971589192       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608971589549       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608971589123       residual = 9.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 7.833678e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.602539 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0479e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_001                -7.038853e-01 3 1  ON 0
ci_002                -7.023615e-01 3 1  ON 1
ci_003                -5.535629e-02 3 1  ON 2
ci_004                -5.564482e-02 3 1  ON 3
ci_005                 2.685860e-02 3 1  ON 4
ci_006                 2.681204e-02 3 1  ON 5
ci_007                 2.071610e-02 3 1  ON 6
ci_008                 2.125984e-02 3 1  ON 7
ci_009                -1.662113e-02 3 1  ON 8
ci_010                -1.635551e-02 3 1  ON 9
ci_011                -1.425847e-02 3 1  ON 10
ci_012                -1.401691e-02 3 1  ON 11
ci_013                 1.260339e-02 3 1  ON 12
ci_014                 1.251516e-02 3 1  ON 13
ci_015                 1.402399e-02 3 1  ON 14
ci_016                 1.378542e-02 3 1  ON 15
ci_017                 1.125431e-02 3 1  ON 16
ci_018                 1.138378e-02 3 1  ON 17
ci_019                 4.519681e-03 3 1  ON 18
ci_020                 4.776742e-03 3 1  ON 19
ci_021                -8.346722e-03 3 1  ON 20
ci_022                -8.474056e-03 3 1  ON 21
ci_023                 6.813957e-03 3 1  ON 22
ci_024                 6.689755e-03 3 1  ON 23
ci_025                 8.826568e-03 3 1  ON 24
ci_026                 8.775768e-03 3 1  ON 25
ci_027                 6.803081e-03 3 1  ON 26
ci_028                 6.874382e-03 3 1  ON 27
ci_029                -5.726403e-03 3 1  ON 28
ci_030                -5.821918e-03 3 1  ON 29
ci_031                -2.659697e-03 3 1  ON 30
ci_032                -3.021921e-03 3 1  ON 31
ci_033                 4.860056e-03 3 1  ON 32
ci_034                 4.729484e-03 3 1  ON 33
ci_035                 3.270585e-03 3 1  ON 34
ci_036                 3.488414e-03 3 1  ON 35
ci_037                 4.956494e-03 3 1  ON 36
ci_038                 4.884242e-03 3 1  ON 37
ci_039                 4.707136e-03 3 1  ON 38
ci_040                 4.784639e-03 3 1  ON 39
ci_041                 3.872957e-03 3 1  ON 40
ci_042                 3.780776e-03 3 1  ON 41
ci_043                 4.080376e-03 3 1  ON 42
ci_044                 4.107505e-03 3 1  ON 43
ci_045                 3.380260e-03 3 1  ON 44
ci_046                 3.491850e-03 3 1  ON 45
ci_047                -1.969691e-03 3 1  ON 46
ci_048                -2.127077e-03 3 1  ON 47
ci_049                 1.816535e-03 3 1  ON 48
ci_050                 1.793256e-03 3 1  ON 49
ci_051                -2.285297e-03 3 1  ON 50
ci_052                -2.123867e-03 3 1  ON 51
ci_053                -2.282971e-03 3 1  ON 52
ci_054                -2.487579e-03 3 1  ON 53
ci_055                -1.469099e-03 3 1  ON 54
ci_056                -1.583767e-03 3 1  ON 55
ci_057                -1.399061e-03 3 1  ON 56
ci_058                -1.460809e-03 3 1  ON 57
ci_059                -9.827669e-04 3 1  ON 58
ci_060                -9.310562e-04 3 1  ON 59
ci_061                -1.215047e-03 3 1  ON 60
ci_062                -7.597123e-04 3 1  ON 61
ci_063                -7.438969e-04 3 1  ON 62
ci_064                -8.164809e-04 3 1  ON 63
ci_065                -1.678915e-03 3 1  ON 64
ci_066                -2.032358e-03 3 1  ON 65
ci_067                -1.449040e-03 3 1  ON 66
ci_068                -1.134605e-03 3 1  ON 67
ci_069                 2.342726e-04 3 1  ON 68
ci_070                 2.350037e-04 3 1  ON 69
ci_071                -1.842578e-03 3 1  ON 70
ci_072                -1.777605e-03 3 1  ON 71
ci_073                 6.305939e-04 3 1  ON 72
ci_074                 5.753798e-04 3 1  ON 73
ci_075                -4.228157e-04 3 1  ON 74
ci_076                -3.824603e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7764
    reference variance = 0.632729
====================================================
  Execution time = 4.9888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 4.9660e-01
  Total weights = 1.9551e+06
  Execution time = 7.2324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484602957389
                                         uncertainty =       0.002430760498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484602957389
                                         uncertainty =       0.002430760498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492241174
  error estimate for blocks of size 2^( 2) =       0.000510871208
  error estimate for blocks of size 2^( 3) =       0.000527240761
  error estimate for blocks of size 2^( 4) =       0.000538669947
  error estimate for blocks of size 2^( 5) =       0.000545734038
  error estimate for blocks of size 2^( 6) =       0.000550914859
  error estimate for blocks of size 2^( 7) =       0.000552402821

      target function =      -0.610785686756
              le_mean =     -22.666578150153
             les_mean =     514.271830108632
             stat err =       0.000546930416
             autocorr =       1.234548841125
   target nu stat err =       0.000546930416
   target dn stat err =       0.004044959100
      target stat err =       0.001253057295
              std dev =       0.696134144885
             le_variance =       0.484602747674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483688408084
                                         uncertainty =       0.002421295820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483688408084
                                         uncertainty =       0.002421295820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491773721
  error estimate for blocks of size 2^( 2) =       0.000510397603
  error estimate for blocks of size 2^( 3) =       0.000526755497
  error estimate for blocks of size 2^( 4) =       0.000538179392
  error estimate for blocks of size 2^( 5) =       0.000545228947
  error estimate for blocks of size 2^( 6) =       0.000550402109
  error estimate for blocks of size 2^( 7) =       0.000551844229

      target function =      -0.610776012023
              le_mean =     -22.666585748142
             les_mean =     514.272212224603
             stat err =       0.000546413669
             autocorr =       1.234560776679
   target nu stat err =       0.000546413669
   target dn stat err =       0.004197544661
      target stat err =       0.001298070487
              std dev =       0.695473066283
             le_variance =       0.483682785925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484090612057
                                         uncertainty =       0.002425334449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484090612057
                                         uncertainty =       0.002425334449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491979413
  error estimate for blocks of size 2^( 2) =       0.000510606288
  error estimate for blocks of size 2^( 3) =       0.000526969370
  error estimate for blocks of size 2^( 4) =       0.000538395790
  error estimate for blocks of size 2^( 5) =       0.000545453284
  error estimate for blocks of size 2^( 6) =       0.000550628545
  error estimate for blocks of size 2^( 7) =       0.000552090412

      target function =      -0.610398941443
              le_mean =     -22.666577989274
             les_mean =     514.273101830681
             stat err =       0.000546642008
             autocorr =       1.234559839999
   target nu stat err =       0.000546642008
   target dn stat err =       0.004130217110
      target stat err =       0.001276634875
              std dev =       0.695763958465
             le_variance =       0.484087485898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484534745771
                                         uncertainty =       0.002430050246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484534745771
                                         uncertainty =       0.002430050246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492206339
  error estimate for blocks of size 2^( 2) =       0.000510835907
  error estimate for blocks of size 2^( 3) =       0.000527204619
  error estimate for blocks of size 2^( 4) =       0.000538633385
  error estimate for blocks of size 2^( 5) =       0.000545696642
  error estimate for blocks of size 2^( 6) =       0.000550876658
  error estimate for blocks of size 2^( 7) =       0.000552361198

      target function =      -0.610946823084
              le_mean =     -22.666577769203
             les_mean =     514.271280748521
             stat err =       0.000546891971
             autocorr =       1.234550013559
   target nu stat err =       0.000546891971
   target dn stat err =       0.003829496202
      target stat err =       0.001190118560
              std dev =       0.696084880749
             le_variance =       0.484534161208


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610785686756        initial
     3.9062e-01     3.9062e+00             1.1429e-03        -0.610776012023
     1.5625e+00     1.5625e+01             3.0741e-04        -0.610398941443
     6.2500e+00     6.2500e+01             7.8337e-05        -0.610946823084  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 8.6180e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_001                -7.039139e-01 3 1  ON 0
ci_002                -7.022665e-01 3 1  ON 1
ci_003                -5.550468e-02 3 1  ON 2
ci_004                -5.578736e-02 3 1  ON 3
ci_005                 2.703099e-02 3 1  ON 4
ci_006                 2.704111e-02 3 1  ON 5
ci_007                 2.088232e-02 3 1  ON 6
ci_008                 2.135359e-02 3 1  ON 7
ci_009                -1.672733e-02 3 1  ON 8
ci_010                -1.645414e-02 3 1  ON 9
ci_011                -1.433375e-02 3 1  ON 10
ci_012                -1.410812e-02 3 1  ON 11
ci_013                 1.269324e-02 3 1  ON 12
ci_014                 1.259395e-02 3 1  ON 13
ci_015                 1.406327e-02 3 1  ON 14
ci_016                 1.386131e-02 3 1  ON 15
ci_017                 1.132461e-02 3 1  ON 16
ci_018                 1.149923e-02 3 1  ON 17
ci_019                 4.627138e-03 3 1  ON 18
ci_020                 4.833705e-03 3 1  ON 19
ci_021                -8.279864e-03 3 1  ON 20
ci_022                -8.448946e-03 3 1  ON 21
ci_023                 6.754678e-03 3 1  ON 22
ci_024                 6.715933e-03 3 1  ON 23
ci_025                 8.814007e-03 3 1  ON 24
ci_026                 8.727268e-03 3 1  ON 25
ci_027                 6.788665e-03 3 1  ON 26
ci_028                 6.900853e-03 3 1  ON 27
ci_029                -5.812190e-03 3 1  ON 28
ci_030                -5.828904e-03 3 1  ON 29
ci_031                -2.724869e-03 3 1  ON 30
ci_032                -3.089673e-03 3 1  ON 31
ci_033                 4.923157e-03 3 1  ON 32
ci_034                 4.752893e-03 3 1  ON 33
ci_035                 3.323608e-03 3 1  ON 34
ci_036                 3.543494e-03 3 1  ON 35
ci_037                 4.975500e-03 3 1  ON 36
ci_038                 4.896672e-03 3 1  ON 37
ci_039                 4.734238e-03 3 1  ON 38
ci_040                 4.773387e-03 3 1  ON 39
ci_041                 3.901373e-03 3 1  ON 40
ci_042                 3.806841e-03 3 1  ON 41
ci_043                 4.090473e-03 3 1  ON 42
ci_044                 4.103319e-03 3 1  ON 43
ci_045                 3.395950e-03 3 1  ON 44
ci_046                 3.529505e-03 3 1  ON 45
ci_047                -2.036528e-03 3 1  ON 46
ci_048                -2.147975e-03 3 1  ON 47
ci_049                 1.857610e-03 3 1  ON 48
ci_050                 1.791522e-03 3 1  ON 49
ci_051                -2.332745e-03 3 1  ON 50
ci_052                -2.142165e-03 3 1  ON 51
ci_053                -2.293279e-03 3 1  ON 52
ci_054                -2.495156e-03 3 1  ON 53
ci_055                -1.459674e-03 3 1  ON 54
ci_056                -1.605976e-03 3 1  ON 55
ci_057                -1.392496e-03 3 1  ON 56
ci_058                -1.495128e-03 3 1  ON 57
ci_059                -9.803491e-04 3 1  ON 58
ci_060                -9.404245e-04 3 1  ON 59
ci_061                -1.230132e-03 3 1  ON 60
ci_062                -7.868329e-04 3 1  ON 61
ci_063                -7.439250e-04 3 1  ON 62
ci_064                -8.632136e-04 3 1  ON 63
ci_065                -1.727458e-03 3 1  ON 64
ci_066                -2.018437e-03 3 1  ON 65
ci_067                -1.497650e-03 3 1  ON 66
ci_068                -1.111639e-03 3 1  ON 67
ci_069                 2.483430e-04 3 1  ON 68
ci_070                 2.542116e-04 3 1  ON 69
ci_071                -1.810555e-03 3 1  ON 70
ci_072                -1.770672e-03 3 1  ON 71
ci_073                 6.339484e-04 3 1  ON 72
ci_074                 5.762270e-04 3 1  ON 73
ci_075                -4.341619e-04 3 1  ON 74
ci_076                -3.840274e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4667e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.5661
    reference variance = 0.706285
====================================================
  Execution time = 5.2632e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9866e-01
  Total weights = 1.955016630e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484733293982
                                         uncertainty =       0.002418909994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484733293982
                                         uncertainty =       0.002418909994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492274478
  error estimate for blocks of size 2^( 2) =       0.000510425713
  error estimate for blocks of size 2^( 3) =       0.000526892031
  error estimate for blocks of size 2^( 4) =       0.000539385463
  error estimate for blocks of size 2^( 5) =       0.000546996283
  error estimate for blocks of size 2^( 6) =       0.000548476061
  error estimate for blocks of size 2^( 7) =       0.000547990177

      target function =      -0.610852034451
              le_mean =     -22.667554220709
             les_mean =     514.316670710777
             stat err =       0.000545711996
             autocorr =       1.228888163381
   target nu stat err =       0.000545711996
   target dn stat err =       0.003601154253
      target stat err =       0.001123351640
              std dev =       0.696181242784
             le_variance =       0.484668322805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266755422071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610853798803       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610897225191       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610901751594       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610902067887       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610902136064       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610902168100       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610902170273       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610902173044       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.262894e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610853798803       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610864856780       residual = 7.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610865999980       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610866078712       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610866095368       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610866103196       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610866103701       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610866104368       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.313334e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610853798803       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610856576175       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610856862706       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610856882366       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610856886505       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610856888450       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610856888574       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610856888740       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.088323e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.606405 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2039e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_001                -7.039237e-01 3 1  ON 0
ci_002                -7.022795e-01 3 1  ON 1
ci_003                -5.545249e-02 3 1  ON 2
ci_004                -5.576179e-02 3 1  ON 3
ci_005                 2.694786e-02 3 1  ON 4
ci_006                 2.696809e-02 3 1  ON 5
ci_007                 2.083243e-02 3 1  ON 6
ci_008                 2.130404e-02 3 1  ON 7
ci_009                -1.669415e-02 3 1  ON 8
ci_010                -1.641459e-02 3 1  ON 9
ci_011                -1.430471e-02 3 1  ON 10
ci_012                -1.406685e-02 3 1  ON 11
ci_013                 1.265835e-02 3 1  ON 12
ci_014                 1.256097e-02 3 1  ON 13
ci_015                 1.403723e-02 3 1  ON 14
ci_016                 1.383267e-02 3 1  ON 15
ci_017                 1.130796e-02 3 1  ON 16
ci_018                 1.147268e-02 3 1  ON 17
ci_019                 4.599697e-03 3 1  ON 18
ci_020                 4.808749e-03 3 1  ON 19
ci_021                -8.274695e-03 3 1  ON 20
ci_022                -8.443504e-03 3 1  ON 21
ci_023                 6.748306e-03 3 1  ON 22
ci_024                 6.713530e-03 3 1  ON 23
ci_025                 8.818993e-03 3 1  ON 24
ci_026                 8.725332e-03 3 1  ON 25
ci_027                 6.782395e-03 3 1  ON 26
ci_028                 6.897265e-03 3 1  ON 27
ci_029                -5.803712e-03 3 1  ON 28
ci_030                -5.821174e-03 3 1  ON 29
ci_031                -2.710046e-03 3 1  ON 30
ci_032                -3.067328e-03 3 1  ON 31
ci_033                 4.911328e-03 3 1  ON 32
ci_034                 4.749676e-03 3 1  ON 33
ci_035                 3.318292e-03 3 1  ON 34
ci_036                 3.529307e-03 3 1  ON 35
ci_037                 4.974092e-03 3 1  ON 36
ci_038                 4.890261e-03 3 1  ON 37
ci_039                 4.734967e-03 3 1  ON 38
ci_040                 4.767109e-03 3 1  ON 39
ci_041                 3.897755e-03 3 1  ON 40
ci_042                 3.809864e-03 3 1  ON 41
ci_043                 4.086379e-03 3 1  ON 42
ci_044                 4.100174e-03 3 1  ON 43
ci_045                 3.395032e-03 3 1  ON 44
ci_046                 3.515668e-03 3 1  ON 45
ci_047                -2.026354e-03 3 1  ON 46
ci_048                -2.137723e-03 3 1  ON 47
ci_049                 1.843134e-03 3 1  ON 48
ci_050                 1.786135e-03 3 1  ON 49
ci_051                -2.324404e-03 3 1  ON 50
ci_052                -2.138644e-03 3 1  ON 51
ci_053                -2.295978e-03 3 1  ON 52
ci_054                -2.480085e-03 3 1  ON 53
ci_055                -1.453780e-03 3 1  ON 54
ci_056                -1.603799e-03 3 1  ON 55
ci_057                -1.388804e-03 3 1  ON 56
ci_058                -1.490409e-03 3 1  ON 57
ci_059                -9.754364e-04 3 1  ON 58
ci_060                -9.315534e-04 3 1  ON 59
ci_061                -1.227009e-03 3 1  ON 60
ci_062                -7.901972e-04 3 1  ON 61
ci_063                -7.393160e-04 3 1  ON 62
ci_064                -8.668281e-04 3 1  ON 63
ci_065                -1.731704e-03 3 1  ON 64
ci_066                -2.020665e-03 3 1  ON 65
ci_067                -1.496375e-03 3 1  ON 66
ci_068                -1.109453e-03 3 1  ON 67
ci_069                 2.439774e-04 3 1  ON 68
ci_070                 2.552533e-04 3 1  ON 69
ci_071                -1.813917e-03 3 1  ON 70
ci_072                -1.767100e-03 3 1  ON 71
ci_073                 6.317858e-04 3 1  ON 72
ci_074                 5.702960e-04 3 1  ON 73
ci_075                -4.237236e-04 3 1  ON 74
ci_076                -3.829354e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7737
    reference variance = 0.405522
====================================================
  Execution time = 4.9797e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0881e-01
  Total weights = 1.9549e+06
  Execution time = 7.2334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495640018018
                                         uncertainty =       0.003408753828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495640018018
                                         uncertainty =       0.003408753828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497795217
  error estimate for blocks of size 2^( 2) =       0.000516176105
  error estimate for blocks of size 2^( 3) =       0.000533425284
  error estimate for blocks of size 2^( 4) =       0.000545877221
  error estimate for blocks of size 2^( 5) =       0.000552938327
  error estimate for blocks of size 2^( 6) =       0.000557013440
  error estimate for blocks of size 2^( 7) =       0.000561966268

      target function =      -0.607652466384
              le_mean =     -22.667321683005
             les_mean =     514.316558975886
             stat err =       0.000554448814
             autocorr =       1.240570586180
   target nu stat err =       0.000554448814
   target dn stat err =       0.004301768239
      target stat err =       0.001317242194
              std dev =       0.703988746539
             le_variance =       0.495600155254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495411421382
                                         uncertainty =       0.003417298268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495411421382
                                         uncertainty =       0.003417298268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497680468
  error estimate for blocks of size 2^( 2) =       0.000516059311
  error estimate for blocks of size 2^( 3) =       0.000533301892
  error estimate for blocks of size 2^( 4) =       0.000545748148
  error estimate for blocks of size 2^( 5) =       0.000552807553
  error estimate for blocks of size 2^( 6) =       0.000556872471
  error estimate for blocks of size 2^( 7) =       0.000561821786

      target function =      -0.607823858637
              le_mean =     -22.667323329236
             les_mean =     514.316062920677
             stat err =       0.000554312489
             autocorr =       1.240532466289
   target nu stat err =       0.000554312489
   target dn stat err =       0.004306690439
      target stat err =       0.001319400424
              std dev =       0.703826467195
             le_variance =       0.495371695924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495522209336
                                         uncertainty =       0.003413074518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495522209336
                                         uncertainty =       0.003413074518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497736083
  error estimate for blocks of size 2^( 2) =       0.000516115910
  error estimate for blocks of size 2^( 3) =       0.000533361884
  error estimate for blocks of size 2^( 4) =       0.000545810636
  error estimate for blocks of size 2^( 5) =       0.000552870778
  error estimate for blocks of size 2^( 6) =       0.000556941276
  error estimate for blocks of size 2^( 7) =       0.000561891885

      target function =      -0.557446486925
              le_mean =     -22.667321820065
             les_mean =     514.486138443284
             stat err =       0.000554378644
             autocorr =       1.240551310233
   target nu stat err =       0.000554378644
   target dn stat err =       0.170023573519
      target stat err =       0.043118263591
              std dev =       0.703905119387
             le_variance =       0.495482417099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495624981408
                                         uncertainty =       0.003409287219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495624981408
                                         uncertainty =       0.003409287219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497787669
  error estimate for blocks of size 2^( 2) =       0.000516168427
  error estimate for blocks of size 2^( 3) =       0.000533417189
  error estimate for blocks of size 2^( 4) =       0.000545868729
  error estimate for blocks of size 2^( 5) =       0.000552929697
  error estimate for blocks of size 2^( 6) =       0.000557004136
  error estimate for blocks of size 2^( 7) =       0.000561956783

      target function =      -0.607684748825
              le_mean =     -22.667321708451
             les_mean =     514.316452399550
             stat err =       0.000554439836
             autocorr =       1.240568027571
   target nu stat err =       0.000554439836
   target dn stat err =       0.004298105383
      target stat err =       0.001316304834
              std dev =       0.703978073341
             le_variance =       0.495585127745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607652466384        initial
     1.5625e+00     1.5625e+01             3.2629e-04        -0.607823858637  <--
     6.2500e+00     6.2500e+01             8.3133e-05        -0.557446486925
     2.5000e+01     2.5000e+02             2.0883e-05        -0.607684748825

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.6059e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_001                -7.039526e-01 3 1  ON 0
ci_002                -7.023179e-01 3 1  ON 1
ci_003                -5.529746e-02 3 1  ON 2
ci_004                -5.568589e-02 3 1  ON 3
ci_005                 2.670470e-02 3 1  ON 4
ci_006                 2.675455e-02 3 1  ON 5
ci_007                 2.068599e-02 3 1  ON 6
ci_008                 2.115859e-02 3 1  ON 7
ci_009                -1.659691e-02 3 1  ON 8
ci_010                -1.629861e-02 3 1  ON 9
ci_011                -1.421952e-02 3 1  ON 10
ci_012                -1.394569e-02 3 1  ON 11
ci_013                 1.255593e-02 3 1  ON 12
ci_014                 1.246415e-02 3 1  ON 13
ci_015                 1.396058e-02 3 1  ON 14
ci_016                 1.374839e-02 3 1  ON 15
ci_017                 1.125913e-02 3 1  ON 16
ci_018                 1.139476e-02 3 1  ON 17
ci_019                 4.518788e-03 3 1  ON 18
ci_020                 4.735196e-03 3 1  ON 19
ci_021                -8.259477e-03 3 1  ON 20
ci_022                -8.427573e-03 3 1  ON 21
ci_023                 6.729663e-03 3 1  ON 22
ci_024                 6.706492e-03 3 1  ON 23
ci_025                 8.833799e-03 3 1  ON 24
ci_026                 8.719763e-03 3 1  ON 25
ci_027                 6.764080e-03 3 1  ON 26
ci_028                 6.886824e-03 3 1  ON 27
ci_029                -5.778779e-03 3 1  ON 28
ci_030                -5.798395e-03 3 1  ON 29
ci_031                -2.666491e-03 3 1  ON 30
ci_032                -3.001645e-03 3 1  ON 31
ci_033                 4.876543e-03 3 1  ON 32
ci_034                 4.740248e-03 3 1  ON 33
ci_035                 3.302629e-03 3 1  ON 34
ci_036                 3.487778e-03 3 1  ON 35
ci_037                 4.969909e-03 3 1  ON 36
ci_038                 4.871369e-03 3 1  ON 37
ci_039                 4.737161e-03 3 1  ON 38
ci_040                 4.748796e-03 3 1  ON 39
ci_041                 3.887180e-03 3 1  ON 40
ci_042                 3.818711e-03 3 1  ON 41
ci_043                 4.074300e-03 3 1  ON 42
ci_044                 4.090864e-03 3 1  ON 43
ci_045                 3.392410e-03 3 1  ON 44
ci_046                 3.475043e-03 3 1  ON 45
ci_047                -1.996538e-03 3 1  ON 46
ci_048                -2.107702e-03 3 1  ON 47
ci_049                 1.800710e-03 3 1  ON 48
ci_050                 1.770323e-03 3 1  ON 49
ci_051                -2.299783e-03 3 1  ON 50
ci_052                -2.128173e-03 3 1  ON 51
ci_053                -2.303961e-03 3 1  ON 52
ci_054                -2.435908e-03 3 1  ON 53
ci_055                -1.436434e-03 3 1  ON 54
ci_056                -1.597409e-03 3 1  ON 55
ci_057                -1.377983e-03 3 1  ON 56
ci_058                -1.476579e-03 3 1  ON 57
ci_059                -9.610837e-04 3 1  ON 58
ci_060                -9.056166e-04 3 1  ON 59
ci_061                -1.217819e-03 3 1  ON 60
ci_062                -8.000858e-04 3 1  ON 61
ci_063                -7.258361e-04 3 1  ON 62
ci_064                -8.775351e-04 3 1  ON 63
ci_065                -1.744133e-03 3 1  ON 64
ci_066                -2.027142e-03 3 1  ON 65
ci_067                -1.492670e-03 3 1  ON 66
ci_068                -1.103091e-03 3 1  ON 67
ci_069                 2.312058e-04 3 1  ON 68
ci_070                 2.582862e-04 3 1  ON 69
ci_071                -1.823703e-03 3 1  ON 70
ci_072                -1.756511e-03 3 1  ON 71
ci_073                 6.254194e-04 3 1  ON 72
ci_074                 5.529180e-04 3 1  ON 73
ci_075                -3.930720e-04 3 1  ON 74
ci_076                -3.797277e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4810e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7048
    reference variance = 0.472529
====================================================
  Execution time = 5.1274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9907e-01
  Total weights = 1.954653840e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488036968703
                                         uncertainty =       0.002418788703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488036968703
                                         uncertainty =       0.002418788703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493956403
  error estimate for blocks of size 2^( 2) =       0.000512966691
  error estimate for blocks of size 2^( 3) =       0.000530271782
  error estimate for blocks of size 2^( 4) =       0.000542478565
  error estimate for blocks of size 2^( 5) =       0.000550715329
  error estimate for blocks of size 2^( 6) =       0.000553916256
  error estimate for blocks of size 2^( 7) =       0.000557161712

      target function =      -0.610724072423
              le_mean =     -22.667542743142
             les_mean =     514.316563343595
             stat err =       0.000551067966
             autocorr =       1.244609444615
   target nu stat err =       0.000551067966
   target dn stat err =       0.003677337714
      target stat err =       0.001145904637
              std dev =       0.698559844276
             le_variance =       0.487985856034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266754274314e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610725917405       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610883663427       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610901414042       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610902932871       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610903214820       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610903509713       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610903531053       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610903532789       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610903534285       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610903543360       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.610903543361       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.183174e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610725917405       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610768222444       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610772834257       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610773212714       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610773278166       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610773348307       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610773352344       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610773352531       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610773352760       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610773354697       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 3.179027e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610725917405       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610736689478       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610737853623       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610737948068       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610737964088       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610737981382       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610737982310       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610737982342       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610737982391       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610737982855       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.099043e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.611940 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0599e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_001                -7.040410e-01 3 1  ON 0
ci_002                -7.023125e-01 3 1  ON 1
ci_003                -5.514633e-02 3 1  ON 2
ci_004                -5.558324e-02 3 1  ON 3
ci_005                 2.640985e-02 3 1  ON 4
ci_006                 2.643665e-02 3 1  ON 5
ci_007                 2.053224e-02 3 1  ON 6
ci_008                 2.097931e-02 3 1  ON 7
ci_009                -1.644710e-02 3 1  ON 8
ci_010                -1.616393e-02 3 1  ON 9
ci_011                -1.405508e-02 3 1  ON 10
ci_012                -1.379039e-02 3 1  ON 11
ci_013                 1.245039e-02 3 1  ON 12
ci_014                 1.233851e-02 3 1  ON 13
ci_015                 1.382938e-02 3 1  ON 14
ci_016                 1.362007e-02 3 1  ON 15
ci_017                 1.119410e-02 3 1  ON 16
ci_018                 1.133044e-02 3 1  ON 17
ci_019                 4.373449e-03 3 1  ON 18
ci_020                 4.658121e-03 3 1  ON 19
ci_021                -8.245605e-03 3 1  ON 20
ci_022                -8.432590e-03 3 1  ON 21
ci_023                 6.687304e-03 3 1  ON 22
ci_024                 6.679537e-03 3 1  ON 23
ci_025                 8.866719e-03 3 1  ON 24
ci_026                 8.743143e-03 3 1  ON 25
ci_027                 6.753105e-03 3 1  ON 26
ci_028                 6.855569e-03 3 1  ON 27
ci_029                -5.766175e-03 3 1  ON 28
ci_030                -5.752940e-03 3 1  ON 29
ci_031                -2.588624e-03 3 1  ON 30
ci_032                -2.903684e-03 3 1  ON 31
ci_033                 4.819194e-03 3 1  ON 32
ci_034                 4.700004e-03 3 1  ON 33
ci_035                 3.268345e-03 3 1  ON 34
ci_036                 3.417061e-03 3 1  ON 35
ci_037                 4.944995e-03 3 1  ON 36
ci_038                 4.815675e-03 3 1  ON 37
ci_039                 4.712949e-03 3 1  ON 38
ci_040                 4.768978e-03 3 1  ON 39
ci_041                 3.875819e-03 3 1  ON 40
ci_042                 3.819862e-03 3 1  ON 41
ci_043                 4.068916e-03 3 1  ON 42
ci_044                 4.073655e-03 3 1  ON 43
ci_045                 3.365437e-03 3 1  ON 44
ci_046                 3.480682e-03 3 1  ON 45
ci_047                -1.968576e-03 3 1  ON 46
ci_048                -2.079571e-03 3 1  ON 47
ci_049                 1.773021e-03 3 1  ON 48
ci_050                 1.749418e-03 3 1  ON 49
ci_051                -2.290885e-03 3 1  ON 50
ci_052                -2.120215e-03 3 1  ON 51
ci_053                -2.300931e-03 3 1  ON 52
ci_054                -2.460369e-03 3 1  ON 53
ci_055                -1.429414e-03 3 1  ON 54
ci_056                -1.578057e-03 3 1  ON 55
ci_057                -1.369371e-03 3 1  ON 56
ci_058                -1.476507e-03 3 1  ON 57
ci_059                -9.366651e-04 3 1  ON 58
ci_060                -8.877992e-04 3 1  ON 59
ci_061                -1.203656e-03 3 1  ON 60
ci_062                -7.920228e-04 3 1  ON 61
ci_063                -7.396368e-04 3 1  ON 62
ci_064                -8.671458e-04 3 1  ON 63
ci_065                -1.769950e-03 3 1  ON 64
ci_066                -2.059032e-03 3 1  ON 65
ci_067                -1.491846e-03 3 1  ON 66
ci_068                -1.070292e-03 3 1  ON 67
ci_069                 2.276973e-04 3 1  ON 68
ci_070                 2.374049e-04 3 1  ON 69
ci_071                -1.830307e-03 3 1  ON 70
ci_072                -1.751812e-03 3 1  ON 71
ci_073                 6.322657e-04 3 1  ON 72
ci_074                 5.319173e-04 3 1  ON 73
ci_075                -3.704916e-04 3 1  ON 74
ci_076                -3.596643e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7176
    reference variance = 0.561212
====================================================
  Execution time = 4.9876e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0127e-01
  Total weights = 1.9547e+06
  Execution time = 7.2500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487635246627
                                         uncertainty =       0.002827993235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487635246627
                                         uncertainty =       0.002827993235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493844435
  error estimate for blocks of size 2^( 2) =       0.000512472571
  error estimate for blocks of size 2^( 3) =       0.000529247012
  error estimate for blocks of size 2^( 4) =       0.000541709308
  error estimate for blocks of size 2^( 5) =       0.000548824316
  error estimate for blocks of size 2^( 6) =       0.000552152164
  error estimate for blocks of size 2^( 7) =       0.000555082272

      target function =      -0.609449419126
              le_mean =     -22.667450335434
             les_mean =     514.316513149981
             stat err =       0.000549442015
             autocorr =       1.237836839741
   target nu stat err =       0.000549442015
   target dn stat err =       0.004934396449
      target stat err =       0.001511602457
              std dev =       0.698401497803
             le_variance =       0.487764652134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486882157122
                                         uncertainty =       0.002831219362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486882157122
                                         uncertainty =       0.002831219362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493463546
  error estimate for blocks of size 2^( 2) =       0.000512082822
  error estimate for blocks of size 2^( 3) =       0.000528846153
  error estimate for blocks of size 2^( 4) =       0.000541294780
  error estimate for blocks of size 2^( 5) =       0.000548414237
  error estimate for blocks of size 2^( 6) =       0.000551710908
  error estimate for blocks of size 2^( 7) =       0.000554716231

      target function =      -0.609677767612
              le_mean =     -22.667462201804
             les_mean =     514.316304148197
             stat err =       0.000549034039
             autocorr =       1.237908058289
   target nu stat err =       0.000549034039
   target dn stat err =       0.004786354922
      target stat err =       0.001468795819
              std dev =       0.697862839736
             le_variance =       0.487012543085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487207249872
                                         uncertainty =       0.002828532495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487207249872
                                         uncertainty =       0.002828532495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493627995
  error estimate for blocks of size 2^( 2) =       0.000512250536
  error estimate for blocks of size 2^( 3) =       0.000529019888
  error estimate for blocks of size 2^( 4) =       0.000541473695
  error estimate for blocks of size 2^( 5) =       0.000548592969
  error estimate for blocks of size 2^( 6) =       0.000551903167
  error estimate for blocks of size 2^( 7) =       0.000554872365

      target function =      -0.610113077155
              le_mean =     -22.667453819504
             les_mean =     514.314475434697
             stat err =       0.000549210549
             autocorr =       1.237878948317
   target nu stat err =       0.000549210549
   target dn stat err =       0.004648871258
      target stat err =       0.001430078552
              std dev =       0.698095405312
             le_variance =       0.487337194917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487576584220
                                         uncertainty =       0.002827822858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487576584220
                                         uncertainty =       0.002827822858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493814775
  error estimate for blocks of size 2^( 2) =       0.000512442021
  error estimate for blocks of size 2^( 3) =       0.000529215648
  error estimate for blocks of size 2^( 4) =       0.000541675982
  error estimate for blocks of size 2^( 5) =       0.000548792187
  error estimate for blocks of size 2^( 6) =       0.000552117058
  error estimate for blocks of size 2^( 7) =       0.000555052730

      target function =      -0.609876322516
              le_mean =     -22.667450063865
             les_mean =     514.315086068670
             stat err =       0.000549409489
             autocorr =       1.237838972146
   target nu stat err =       0.000549409489
   target dn stat err =       0.004702757447
      target stat err =       0.001444971238
              std dev =       0.698359552717
             le_variance =       0.487706064871


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609449419126        initial
     3.9062e-01     3.9062e+00             1.1832e-03        -0.609677767612
     1.5625e+00     1.5625e+01             3.1790e-04        -0.610113077155  <--
     6.2500e+00     6.2500e+01             8.0990e-05        -0.609876322516

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 8.6229e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_001                -7.040410e-01 3 1  ON 0
ci_002                -7.023125e-01 3 1  ON 1
ci_003                -5.514633e-02 3 1  ON 2
ci_004                -5.558324e-02 3 1  ON 3
ci_005                 2.640985e-02 3 1  ON 4
ci_006                 2.643665e-02 3 1  ON 5
ci_007                 2.053224e-02 3 1  ON 6
ci_008                 2.097931e-02 3 1  ON 7
ci_009                -1.644710e-02 3 1  ON 8
ci_010                -1.616393e-02 3 1  ON 9
ci_011                -1.405508e-02 3 1  ON 10
ci_012                -1.379039e-02 3 1  ON 11
ci_013                 1.245039e-02 3 1  ON 12
ci_014                 1.233851e-02 3 1  ON 13
ci_015                 1.382938e-02 3 1  ON 14
ci_016                 1.362007e-02 3 1  ON 15
ci_017                 1.119410e-02 3 1  ON 16
ci_018                 1.133044e-02 3 1  ON 17
ci_019                 4.373449e-03 3 1  ON 18
ci_020                 4.658121e-03 3 1  ON 19
ci_021                -8.245605e-03 3 1  ON 20
ci_022                -8.432590e-03 3 1  ON 21
ci_023                 6.687304e-03 3 1  ON 22
ci_024                 6.679537e-03 3 1  ON 23
ci_025                 8.866719e-03 3 1  ON 24
ci_026                 8.743143e-03 3 1  ON 25
ci_027                 6.753105e-03 3 1  ON 26
ci_028                 6.855569e-03 3 1  ON 27
ci_029                -5.766175e-03 3 1  ON 28
ci_030                -5.752940e-03 3 1  ON 29
ci_031                -2.588624e-03 3 1  ON 30
ci_032                -2.903684e-03 3 1  ON 31
ci_033                 4.819194e-03 3 1  ON 32
ci_034                 4.700004e-03 3 1  ON 33
ci_035                 3.268345e-03 3 1  ON 34
ci_036                 3.417061e-03 3 1  ON 35
ci_037                 4.944995e-03 3 1  ON 36
ci_038                 4.815675e-03 3 1  ON 37
ci_039                 4.712949e-03 3 1  ON 38
ci_040                 4.768978e-03 3 1  ON 39
ci_041                 3.875819e-03 3 1  ON 40
ci_042                 3.819862e-03 3 1  ON 41
ci_043                 4.068916e-03 3 1  ON 42
ci_044                 4.073655e-03 3 1  ON 43
ci_045                 3.365437e-03 3 1  ON 44
ci_046                 3.480682e-03 3 1  ON 45
ci_047                -1.968576e-03 3 1  ON 46
ci_048                -2.079571e-03 3 1  ON 47
ci_049                 1.773021e-03 3 1  ON 48
ci_050                 1.749418e-03 3 1  ON 49
ci_051                -2.290885e-03 3 1  ON 50
ci_052                -2.120215e-03 3 1  ON 51
ci_053                -2.300931e-03 3 1  ON 52
ci_054                -2.460369e-03 3 1  ON 53
ci_055                -1.429414e-03 3 1  ON 54
ci_056                -1.578057e-03 3 1  ON 55
ci_057                -1.369371e-03 3 1  ON 56
ci_058                -1.476507e-03 3 1  ON 57
ci_059                -9.366651e-04 3 1  ON 58
ci_060                -8.877992e-04 3 1  ON 59
ci_061                -1.203656e-03 3 1  ON 60
ci_062                -7.920228e-04 3 1  ON 61
ci_063                -7.396368e-04 3 1  ON 62
ci_064                -8.671458e-04 3 1  ON 63
ci_065                -1.769950e-03 3 1  ON 64
ci_066                -2.059032e-03 3 1  ON 65
ci_067                -1.491846e-03 3 1  ON 66
ci_068                -1.070292e-03 3 1  ON 67
ci_069                 2.276973e-04 3 1  ON 68
ci_070                 2.374049e-04 3 1  ON 69
ci_071                -1.830307e-03 3 1  ON 70
ci_072                -1.751812e-03 3 1  ON 71
ci_073                 6.322657e-04 3 1  ON 72
ci_074                 5.319173e-04 3 1  ON 73
ci_075                -3.704916e-04 3 1  ON 74
ci_076                -3.596643e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4683e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7044
    reference variance = 0.545614
====================================================
  Execution time = 5.2264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9843e-01
  Total weights = 1.954781903e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483638976642
                                         uncertainty =       0.002400360163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483638976642
                                         uncertainty =       0.002400360163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491758525
  error estimate for blocks of size 2^( 2) =       0.000509862042
  error estimate for blocks of size 2^( 3) =       0.000527033474
  error estimate for blocks of size 2^( 4) =       0.000539079371
  error estimate for blocks of size 2^( 5) =       0.000547188124
  error estimate for blocks of size 2^( 6) =       0.000550341778
  error estimate for blocks of size 2^( 7) =       0.000549068080

      target function =      -0.611008548469
              le_mean =     -22.667902861216
             les_mean =     514.332248421378
             stat err =       0.000546419339
             autocorr =       1.234662700245
   target nu stat err =       0.000546419339
   target dn stat err =       0.003568280167
      target stat err =       0.001114648324
              std dev =       0.695451575010
             le_variance =       0.483652893184


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266790286122e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611010280491       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611144687343       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611159805304       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611160689781       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611160902064       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611161059577       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611161040314       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611161078664       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611161081538       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611161093514       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.611161093512       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.089063e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611010280491       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611046316886       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611050251566       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611050472366       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611050522859       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611050560297       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611050554644       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611050563438       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611050564119       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611050566584       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.926707e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611010280491       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611019455740       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611020449448       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611020504574       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611020517013       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611020526241       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611020524778       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611020526926       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611020527094       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611020527678       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 7.456243e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.624134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1579e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_001                -7.041387e-01 3 1  ON 0
ci_002                -7.022914e-01 3 1  ON 1
ci_003                -5.502331e-02 3 1  ON 2
ci_004                -5.550239e-02 3 1  ON 3
ci_005                 2.613320e-02 3 1  ON 4
ci_006                 2.614398e-02 3 1  ON 5
ci_007                 2.037801e-02 3 1  ON 6
ci_008                 2.078311e-02 3 1  ON 7
ci_009                -1.629351e-02 3 1  ON 8
ci_010                -1.603380e-02 3 1  ON 9
ci_011                -1.389859e-02 3 1  ON 10
ci_012                -1.366644e-02 3 1  ON 11
ci_013                 1.231072e-02 3 1  ON 12
ci_014                 1.221623e-02 3 1  ON 13
ci_015                 1.371531e-02 3 1  ON 14
ci_016                 1.352051e-02 3 1  ON 15
ci_017                 1.106668e-02 3 1  ON 16
ci_018                 1.131410e-02 3 1  ON 17
ci_019                 4.281576e-03 3 1  ON 18
ci_020                 4.588431e-03 3 1  ON 19
ci_021                -8.227407e-03 3 1  ON 20
ci_022                -8.385417e-03 3 1  ON 21
ci_023                 6.643015e-03 3 1  ON 22
ci_024                 6.681474e-03 3 1  ON 23
ci_025                 8.858958e-03 3 1  ON 24
ci_026                 8.767189e-03 3 1  ON 25
ci_027                 6.760948e-03 3 1  ON 26
ci_028                 6.842128e-03 3 1  ON 27
ci_029                -5.749765e-03 3 1  ON 28
ci_030                -5.702342e-03 3 1  ON 29
ci_031                -2.474960e-03 3 1  ON 30
ci_032                -2.810022e-03 3 1  ON 31
ci_033                 4.796425e-03 3 1  ON 32
ci_034                 4.665482e-03 3 1  ON 33
ci_035                 3.228181e-03 3 1  ON 34
ci_036                 3.389834e-03 3 1  ON 35
ci_037                 4.900134e-03 3 1  ON 36
ci_038                 4.758031e-03 3 1  ON 37
ci_039                 4.713801e-03 3 1  ON 38
ci_040                 4.755352e-03 3 1  ON 39
ci_041                 3.840150e-03 3 1  ON 40
ci_042                 3.812893e-03 3 1  ON 41
ci_043                 4.038612e-03 3 1  ON 42
ci_044                 4.060161e-03 3 1  ON 43
ci_045                 3.379355e-03 3 1  ON 44
ci_046                 3.470216e-03 3 1  ON 45
ci_047                -1.943813e-03 3 1  ON 46
ci_048                -2.060019e-03 3 1  ON 47
ci_049                 1.767521e-03 3 1  ON 48
ci_050                 1.760692e-03 3 1  ON 49
ci_051                -2.264163e-03 3 1  ON 50
ci_052                -2.115042e-03 3 1  ON 51
ci_053                -2.311118e-03 3 1  ON 52
ci_054                -2.449417e-03 3 1  ON 53
ci_055                -1.410654e-03 3 1  ON 54
ci_056                -1.564633e-03 3 1  ON 55
ci_057                -1.354616e-03 3 1  ON 56
ci_058                -1.476977e-03 3 1  ON 57
ci_059                -9.307520e-04 3 1  ON 58
ci_060                -8.664807e-04 3 1  ON 59
ci_061                -1.194547e-03 3 1  ON 60
ci_062                -8.032616e-04 3 1  ON 61
ci_063                -7.600917e-04 3 1  ON 62
ci_064                -8.923828e-04 3 1  ON 63
ci_065                -1.773493e-03 3 1  ON 64
ci_066                -2.075713e-03 3 1  ON 65
ci_067                -1.478623e-03 3 1  ON 66
ci_068                -1.080671e-03 3 1  ON 67
ci_069                 2.133006e-04 3 1  ON 68
ci_070                 2.087815e-04 3 1  ON 69
ci_071                -1.845517e-03 3 1  ON 70
ci_072                -1.745303e-03 3 1  ON 71
ci_073                 6.239849e-04 3 1  ON 72
ci_074                 5.190394e-04 3 1  ON 73
ci_075                -3.686591e-04 3 1  ON 74
ci_076                -3.367623e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6832
    reference variance = 0.352946
====================================================
  Execution time = 4.9709e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0188e-01
  Total weights = 1.9549e+06
  Execution time = 7.2021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490195491671
                                         uncertainty =       0.002660719522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490195491671
                                         uncertainty =       0.002660719522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495045022
  error estimate for blocks of size 2^( 2) =       0.000513700396
  error estimate for blocks of size 2^( 3) =       0.000530875920
  error estimate for blocks of size 2^( 4) =       0.000543510636
  error estimate for blocks of size 2^( 5) =       0.000550796337
  error estimate for blocks of size 2^( 6) =       0.000553817838
  error estimate for blocks of size 2^( 7) =       0.000556506986

      target function =      -0.609846633818
              le_mean =     -22.668091488500
             les_mean =     514.344798014660
             stat err =       0.000551157949
             autocorr =       1.239546305499
   target nu stat err =       0.000551157949
   target dn stat err =       0.003407703114
      target stat err =       0.001064353714
              std dev =       0.700099384409
             le_variance =       0.490139148050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489377626865
                                         uncertainty =       0.002656135359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489377626865
                                         uncertainty =       0.002656135359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494632140
  error estimate for blocks of size 2^( 2) =       0.000513272705
  error estimate for blocks of size 2^( 3) =       0.000530445239
  error estimate for blocks of size 2^( 4) =       0.000543068759
  error estimate for blocks of size 2^( 5) =       0.000550352797
  error estimate for blocks of size 2^( 6) =       0.000553363954
  error estimate for blocks of size 2^( 7) =       0.000556051839

      target function =      -0.606395062901
              le_mean =     -22.668093637899
             les_mean =     514.356324333186
             stat err =       0.000550709337
             autocorr =       1.239596138765
   target nu stat err =       0.000550709337
   target dn stat err =       0.012472218361
      target stat err =       0.003732860521
              std dev =       0.699515481320
             le_variance =       0.489321908606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489737788251
                                         uncertainty =       0.002657736824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489737788251
                                         uncertainty =       0.002657736824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494814002
  error estimate for blocks of size 2^( 2) =       0.000513461250
  error estimate for blocks of size 2^( 3) =       0.000530634413
  error estimate for blocks of size 2^( 4) =       0.000543262065
  error estimate for blocks of size 2^( 5) =       0.000550546515
  error estimate for blocks of size 2^( 6) =       0.000553563087
  error estimate for blocks of size 2^( 7) =       0.000556251978

      target function =      -0.609696305352
              le_mean =     -22.668089135484
             les_mean =     514.345186663168
             stat err =       0.000550905911
             autocorr =       1.239569562626
   target nu stat err =       0.000550905911
   target dn stat err =       0.003640809958
      target stat err =       0.001131946999
              std dev =       0.699772672738
             le_variance =       0.489681793511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490134808438
                                         uncertainty =       0.002660281905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490134808438
                                         uncertainty =       0.002660281905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495014399
  error estimate for blocks of size 2^( 2) =       0.000513668870
  error estimate for blocks of size 2^( 3) =       0.000530844096
  error estimate for blocks of size 2^( 4) =       0.000543477931
  error estimate for blocks of size 2^( 5) =       0.000550763271
  error estimate for blocks of size 2^( 6) =       0.000553784034
  error estimate for blocks of size 2^( 7) =       0.000556474878

      target function =      -0.608284858259
              le_mean =     -22.668091076660
             les_mean =     514.349952721397
             stat err =       0.000551125029
             autocorr =       1.239551583777
   target nu stat err =       0.000551125029
   target dn stat err =       0.006115187307
      target stat err =       0.001856795598
              std dev =       0.700056077029
             le_variance =       0.490078510985


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609846633818        initial  <--
     3.9062e-01     3.9062e+00             1.0891e-03        -0.606395062901
     1.5625e+00     1.5625e+01             2.9267e-04        -0.609696305352
     6.2500e+00     6.2500e+01             7.4562e-05        -0.608284858259

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 85.8492
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_001                -7.040410e-01 3 1  ON 0
ci_002                -7.023125e-01 3 1  ON 1
ci_003                -5.514633e-02 3 1  ON 2
ci_004                -5.558324e-02 3 1  ON 3
ci_005                 2.640985e-02 3 1  ON 4
ci_006                 2.643665e-02 3 1  ON 5
ci_007                 2.053224e-02 3 1  ON 6
ci_008                 2.097931e-02 3 1  ON 7
ci_009                -1.644710e-02 3 1  ON 8
ci_010                -1.616393e-02 3 1  ON 9
ci_011                -1.405508e-02 3 1  ON 10
ci_012                -1.379039e-02 3 1  ON 11
ci_013                 1.245039e-02 3 1  ON 12
ci_014                 1.233851e-02 3 1  ON 13
ci_015                 1.382938e-02 3 1  ON 14
ci_016                 1.362007e-02 3 1  ON 15
ci_017                 1.119410e-02 3 1  ON 16
ci_018                 1.133044e-02 3 1  ON 17
ci_019                 4.373449e-03 3 1  ON 18
ci_020                 4.658121e-03 3 1  ON 19
ci_021                -8.245605e-03 3 1  ON 20
ci_022                -8.432590e-03 3 1  ON 21
ci_023                 6.687304e-03 3 1  ON 22
ci_024                 6.679537e-03 3 1  ON 23
ci_025                 8.866719e-03 3 1  ON 24
ci_026                 8.743143e-03 3 1  ON 25
ci_027                 6.753105e-03 3 1  ON 26
ci_028                 6.855569e-03 3 1  ON 27
ci_029                -5.766175e-03 3 1  ON 28
ci_030                -5.752940e-03 3 1  ON 29
ci_031                -2.588624e-03 3 1  ON 30
ci_032                -2.903684e-03 3 1  ON 31
ci_033                 4.819194e-03 3 1  ON 32
ci_034                 4.700004e-03 3 1  ON 33
ci_035                 3.268345e-03 3 1  ON 34
ci_036                 3.417061e-03 3 1  ON 35
ci_037                 4.944995e-03 3 1  ON 36
ci_038                 4.815675e-03 3 1  ON 37
ci_039                 4.712949e-03 3 1  ON 38
ci_040                 4.768978e-03 3 1  ON 39
ci_041                 3.875819e-03 3 1  ON 40
ci_042                 3.819862e-03 3 1  ON 41
ci_043                 4.068916e-03 3 1  ON 42
ci_044                 4.073655e-03 3 1  ON 43
ci_045                 3.365437e-03 3 1  ON 44
ci_046                 3.480682e-03 3 1  ON 45
ci_047                -1.968576e-03 3 1  ON 46
ci_048                -2.079571e-03 3 1  ON 47
ci_049                 1.773021e-03 3 1  ON 48
ci_050                 1.749418e-03 3 1  ON 49
ci_051                -2.290885e-03 3 1  ON 50
ci_052                -2.120215e-03 3 1  ON 51
ci_053                -2.300931e-03 3 1  ON 52
ci_054                -2.460369e-03 3 1  ON 53
ci_055                -1.429414e-03 3 1  ON 54
ci_056                -1.578057e-03 3 1  ON 55
ci_057                -1.369371e-03 3 1  ON 56
ci_058                -1.476507e-03 3 1  ON 57
ci_059                -9.366651e-04 3 1  ON 58
ci_060                -8.877992e-04 3 1  ON 59
ci_061                -1.203656e-03 3 1  ON 60
ci_062                -7.920228e-04 3 1  ON 61
ci_063                -7.396368e-04 3 1  ON 62
ci_064                -8.671458e-04 3 1  ON 63
ci_065                -1.769950e-03 3 1  ON 64
ci_066                -2.059032e-03 3 1  ON 65
ci_067                -1.491846e-03 3 1  ON 66
ci_068                -1.070292e-03 3 1  ON 67
ci_069                 2.276973e-04 3 1  ON 68
ci_070                 2.374049e-04 3 1  ON 69
ci_071                -1.830307e-03 3 1  ON 70
ci_072                -1.751812e-03 3 1  ON 71
ci_073                 6.322657e-04 3 1  ON 72
ci_074                 5.319173e-04 3 1  ON 73
ci_075                -3.704916e-04 3 1  ON 74
ci_076                -3.596643e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4745e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.6506
    reference variance = 0.959074
====================================================
  Execution time = 5.1190e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0238e-01
  Total weights = 1.955044569e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489550258549
                                         uncertainty =       0.002971877682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489550258549
                                         uncertainty =       0.002971877682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494812778
  error estimate for blocks of size 2^( 2) =       0.000513248727
  error estimate for blocks of size 2^( 3) =       0.000529497857
  error estimate for blocks of size 2^( 4) =       0.000540949922
  error estimate for blocks of size 2^( 5) =       0.000548166180
  error estimate for blocks of size 2^( 6) =       0.000551086330
  error estimate for blocks of size 2^( 7) =       0.000552682875

      target function =      -0.609883548503
              le_mean =     -22.668181641361
             les_mean =     514.348836401542
             stat err =       0.000548221327
             autocorr =       1.227524134225
   target nu stat err =       0.000548221327
   target dn stat err =       0.003638497408
      target stat err =       0.001131710013
              std dev =       0.699770941766
             le_variance =       0.489679370940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266818164136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609885355455       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609901221142       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609902866845       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609903054518       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609903119073       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609903141201       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609903150850       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609903151169       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609903151175       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 1.194582e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609885355455       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609889351161       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609889764184       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609889811099       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609889827159       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609889832648       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609889835036       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609889835113       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 3.009069e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609885355455       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609886356229       residual = 7.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609886459585       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609886471313       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609886475323       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609886476692       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609886477288       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609886477307       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 7.537014e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.634861 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0526e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_001                -7.040465e-01 3 1  ON 0
ci_002                -7.023160e-01 3 1  ON 1
ci_003                -5.512909e-02 3 1  ON 2
ci_004                -5.556893e-02 3 1  ON 3
ci_005                 2.638114e-02 3 1  ON 4
ci_006                 2.640656e-02 3 1  ON 5
ci_007                 2.051567e-02 3 1  ON 6
ci_008                 2.095843e-02 3 1  ON 7
ci_009                -1.643287e-02 3 1  ON 8
ci_010                -1.614898e-02 3 1  ON 9
ci_011                -1.404313e-02 3 1  ON 10
ci_012                -1.377647e-02 3 1  ON 11
ci_013                 1.243815e-02 3 1  ON 12
ci_014                 1.232524e-02 3 1  ON 13
ci_015                 1.381881e-02 3 1  ON 14
ci_016                 1.360475e-02 3 1  ON 15
ci_017                 1.118586e-02 3 1  ON 16
ci_018                 1.131947e-02 3 1  ON 17
ci_019                 4.364463e-03 3 1  ON 18
ci_020                 4.649601e-03 3 1  ON 19
ci_021                -8.242361e-03 3 1  ON 20
ci_022                -8.435767e-03 3 1  ON 21
ci_023                 6.684273e-03 3 1  ON 22
ci_024                 6.674803e-03 3 1  ON 23
ci_025                 8.863875e-03 3 1  ON 24
ci_026                 8.743338e-03 3 1  ON 25
ci_027                 6.752041e-03 3 1  ON 26
ci_028                 6.854709e-03 3 1  ON 27
ci_029                -5.761769e-03 3 1  ON 28
ci_030                -5.749402e-03 3 1  ON 29
ci_031                -2.580550e-03 3 1  ON 30
ci_032                -2.897195e-03 3 1  ON 31
ci_033                 4.814339e-03 3 1  ON 32
ci_034                 4.696372e-03 3 1  ON 33
ci_035                 3.262480e-03 3 1  ON 34
ci_036                 3.412482e-03 3 1  ON 35
ci_037                 4.941695e-03 3 1  ON 36
ci_038                 4.809866e-03 3 1  ON 37
ci_039                 4.711409e-03 3 1  ON 38
ci_040                 4.767371e-03 3 1  ON 39
ci_041                 3.873559e-03 3 1  ON 40
ci_042                 3.817682e-03 3 1  ON 41
ci_043                 4.069133e-03 3 1  ON 42
ci_044                 4.074803e-03 3 1  ON 43
ci_045                 3.366424e-03 3 1  ON 44
ci_046                 3.481196e-03 3 1  ON 45
ci_047                -1.965475e-03 3 1  ON 46
ci_048                -2.075179e-03 3 1  ON 47
ci_049                 1.769446e-03 3 1  ON 48
ci_050                 1.744420e-03 3 1  ON 49
ci_051                -2.286740e-03 3 1  ON 50
ci_052                -2.118598e-03 3 1  ON 51
ci_053                -2.300184e-03 3 1  ON 52
ci_054                -2.457781e-03 3 1  ON 53
ci_055                -1.425509e-03 3 1  ON 54
ci_056                -1.577207e-03 3 1  ON 55
ci_057                -1.368587e-03 3 1  ON 56
ci_058                -1.473583e-03 3 1  ON 57
ci_059                -9.337717e-04 3 1  ON 58
ci_060                -8.879049e-04 3 1  ON 59
ci_061                -1.205020e-03 3 1  ON 60
ci_062                -7.912814e-04 3 1  ON 61
ci_063                -7.379231e-04 3 1  ON 62
ci_064                -8.670173e-04 3 1  ON 63
ci_065                -1.774932e-03 3 1  ON 64
ci_066                -2.057298e-03 3 1  ON 65
ci_067                -1.492288e-03 3 1  ON 66
ci_068                -1.070474e-03 3 1  ON 67
ci_069                 2.240664e-04 3 1  ON 68
ci_070                 2.359566e-04 3 1  ON 69
ci_071                -1.831501e-03 3 1  ON 70
ci_072                -1.751993e-03 3 1  ON 71
ci_073                 6.302011e-04 3 1  ON 72
ci_074                 5.279578e-04 3 1  ON 73
ci_075                -3.694772e-04 3 1  ON 74
ci_076                -3.585961e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.5973
    reference variance = 0.292058
====================================================
  Execution time = 4.9649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0768e-01
  Total weights = 1.9547e+06
  Execution time = 7.2243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491798518824
                                         uncertainty =       0.003498679937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491798518824
                                         uncertainty =       0.003498679937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495877229
  error estimate for blocks of size 2^( 2) =       0.000514194378
  error estimate for blocks of size 2^( 3) =       0.000530774958
  error estimate for blocks of size 2^( 4) =       0.000542116288
  error estimate for blocks of size 2^( 5) =       0.000548740251
  error estimate for blocks of size 2^( 6) =       0.000553598024
  error estimate for blocks of size 2^( 7) =       0.000557980858

      target function =      -0.608389995390
              le_mean =     -22.668945575732
             les_mean =     514.389046439965
             stat err =       0.000550608855
             autocorr =       1.232928954979
   target nu stat err =       0.000550608855
   target dn stat err =       0.005585854280
      target stat err =       0.001701399555
              std dev =       0.701276302471
             le_variance =       0.491788452407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491701411658
                                         uncertainty =       0.003495705729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491701411658
                                         uncertainty =       0.003495705729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495828248
  error estimate for blocks of size 2^( 2) =       0.000514145004
  error estimate for blocks of size 2^( 3) =       0.000530725312
  error estimate for blocks of size 2^( 4) =       0.000542065695
  error estimate for blocks of size 2^( 5) =       0.000548688048
  error estimate for blocks of size 2^( 6) =       0.000553546478
  error estimate for blocks of size 2^( 7) =       0.000557930444

      target function =      -0.608553243570
              le_mean =     -22.668946248237
             les_mean =     514.388534811401
             stat err =       0.000550557666
             autocorr =       1.232943281138
   target nu stat err =       0.000550557666
   target dn stat err =       0.005560443872
      target stat err =       0.001694752359
              std dev =       0.701207032816
             le_variance =       0.491691302870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491749322687
                                         uncertainty =       0.003497175182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491749322687
                                         uncertainty =       0.003497175182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495852415
  error estimate for blocks of size 2^( 2) =       0.000514169344
  error estimate for blocks of size 2^( 3) =       0.000530749795
  error estimate for blocks of size 2^( 4) =       0.000542090658
  error estimate for blocks of size 2^( 5) =       0.000548713814
  error estimate for blocks of size 2^( 6) =       0.000553571928
  error estimate for blocks of size 2^( 7) =       0.000557955346

      target function =      -0.608472710740
              le_mean =     -22.668945865022
             les_mean =     514.388784813941
             stat err =       0.000550582937
             autocorr =       1.232936273326
   target nu stat err =       0.000550582937
   target dn stat err =       0.005569469936
      target stat err =       0.001696990555
              std dev =       0.701241210379
             le_variance =       0.491739235133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491792325355
                                         uncertainty =       0.003498491134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491792325355
                                         uncertainty =       0.003498491134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495874105
  error estimate for blocks of size 2^( 2) =       0.000514191228
  error estimate for blocks of size 2^( 3) =       0.000530771791
  error estimate for blocks of size 2^( 4) =       0.000542113060
  error estimate for blocks of size 2^( 5) =       0.000548736921
  error estimate for blocks of size 2^( 6) =       0.000553594735
  error estimate for blocks of size 2^( 7) =       0.000557977648

      target function =      -0.608420708127
              le_mean =     -22.668945608778
             les_mean =     514.388945853341
             stat err =       0.000550605591
             autocorr =       1.232929871625
   target nu stat err =       0.000550605591
   target dn stat err =       0.005580093062
      target stat err =       0.001699858825
              std dev =       0.701271884728
             le_variance =       0.491782256309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.608389995390        initial
     3.9062e+00     3.9062e+01             1.1946e-04        -0.608553243570  <--
     1.5625e+01     1.5625e+02             3.0091e-05        -0.608472710740
     6.2500e+01     6.2500e+02             7.5370e-06        -0.608420708127

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 8.5931e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_001                -7.040629e-01 3 1  ON 0
ci_002                -7.023260e-01 3 1  ON 1
ci_003                -5.507753e-02 3 1  ON 2
ci_004                -5.552620e-02 3 1  ON 3
ci_005                 2.629589e-02 3 1  ON 4
ci_006                 2.631719e-02 3 1  ON 5
ci_007                 2.046637e-02 3 1  ON 6
ci_008                 2.089631e-02 3 1  ON 7
ci_009                -1.639055e-02 3 1  ON 8
ci_010                -1.610448e-02 3 1  ON 9
ci_011                -1.400763e-02 3 1  ON 10
ci_012                -1.373512e-02 3 1  ON 11
ci_013                 1.240180e-02 3 1  ON 12
ci_014                 1.228580e-02 3 1  ON 13
ci_015                 1.378734e-02 3 1  ON 14
ci_016                 1.355916e-02 3 1  ON 15
ci_017                 1.116134e-02 3 1  ON 16
ci_018                 1.128681e-02 3 1  ON 17
ci_019                 4.337715e-03 3 1  ON 18
ci_020                 4.624257e-03 3 1  ON 19
ci_021                -8.232690e-03 3 1  ON 20
ci_022                -8.445196e-03 3 1  ON 21
ci_023                 6.675238e-03 3 1  ON 22
ci_024                 6.660699e-03 3 1  ON 23
ci_025                 8.855384e-03 3 1  ON 24
ci_026                 8.743874e-03 3 1  ON 25
ci_027                 6.748885e-03 3 1  ON 26
ci_028                 6.852230e-03 3 1  ON 27
ci_029                -5.748621e-03 3 1  ON 28
ci_030                -5.738844e-03 3 1  ON 29
ci_031                -2.556553e-03 3 1  ON 30
ci_032                -2.877939e-03 3 1  ON 31
ci_033                 4.799899e-03 3 1  ON 32
ci_034                 4.685574e-03 3 1  ON 33
ci_035                 3.245133e-03 3 1  ON 34
ci_036                 3.398737e-03 3 1  ON 35
ci_037                 4.931908e-03 3 1  ON 36
ci_038                 4.792592e-03 3 1  ON 37
ci_039                 4.706775e-03 3 1  ON 38
ci_040                 4.762560e-03 3 1  ON 39
ci_041                 3.866830e-03 3 1  ON 40
ci_042                 3.811195e-03 3 1  ON 41
ci_043                 4.069761e-03 3 1  ON 42
ci_044                 4.078236e-03 3 1  ON 43
ci_045                 3.369398e-03 3 1  ON 44
ci_046                 3.482747e-03 3 1  ON 45
ci_047                -1.956276e-03 3 1  ON 46
ci_048                -2.062132e-03 3 1  ON 47
ci_049                 1.758831e-03 3 1  ON 48
ci_050                 1.729583e-03 3 1  ON 49
ci_051                -2.274371e-03 3 1  ON 50
ci_052                -2.113729e-03 3 1  ON 51
ci_053                -2.298009e-03 3 1  ON 52
ci_054                -2.450158e-03 3 1  ON 53
ci_055                -1.413916e-03 3 1  ON 54
ci_056                -1.574685e-03 3 1  ON 55
ci_057                -1.366253e-03 3 1  ON 56
ci_058                -1.464875e-03 3 1  ON 57
ci_059                -9.251969e-04 3 1  ON 58
ci_060                -8.882390e-04 3 1  ON 59
ci_061                -1.209087e-03 3 1  ON 60
ci_062                -7.890923e-04 3 1  ON 61
ci_063                -7.328907e-04 3 1  ON 62
ci_064                -8.666701e-04 3 1  ON 63
ci_065                -1.789720e-03 3 1  ON 64
ci_066                -2.052113e-03 3 1  ON 65
ci_067                -1.493642e-03 3 1  ON 66
ci_068                -1.071049e-03 3 1  ON 67
ci_069                 2.132627e-04 3 1  ON 68
ci_070                 2.316409e-04 3 1  ON 69
ci_071                -1.835025e-03 3 1  ON 70
ci_072                -1.752495e-03 3 1  ON 71
ci_073                 6.240512e-04 3 1  ON 72
ci_074                 5.161922e-04 3 1  ON 73
ci_075                -3.664630e-04 3 1  ON 74
ci_076                -3.554080e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4648e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7696
    reference variance = 0.739501
====================================================
  Execution time = 5.1261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0268e-01
  Total weights = 1.955102590e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491462506748
                                         uncertainty =       0.003356300508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491462506748
                                         uncertainty =       0.003356300508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495650240
  error estimate for blocks of size 2^( 2) =       0.000514226171
  error estimate for blocks of size 2^( 3) =       0.000531966187
  error estimate for blocks of size 2^( 4) =       0.000544266331
  error estimate for blocks of size 2^( 5) =       0.000551219226
  error estimate for blocks of size 2^( 6) =       0.000555926732
  error estimate for blocks of size 2^( 7) =       0.000559610565

      target function =      -0.609748374236
              le_mean =     -22.668002756340
             les_mean =     514.341025277237
             stat err =       0.000552755713
             autocorr =       1.243700585169
   target nu stat err =       0.000552755713
   target dn stat err =       0.004068041177
      target stat err =       0.001257773634
              std dev =       0.700955291878
             le_variance =       0.491338321212


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266800275634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609750649070       residual = 9.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609813437924       residual = 7.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609819973863       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609820472763       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609820693665       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609820699826       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609820712711       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609820708870       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609820715468       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609820715955       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 4.549177e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609750649070       residual = 9.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609766805553       residual = 7.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609768464380       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609768589240       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609768644006       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609768645126       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609768648195       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609768647240       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609768648837       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609768648925       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 1.171791e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609750649070       residual = 9.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609754717948       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609755134223       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609755165442       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609755179102       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609755179356       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609755180113       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609755179875       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609755180271       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609755180291       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 2.951859e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.640010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0670e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_001                -7.040919e-01 3 1  ON 0
ci_002                -7.023300e-01 3 1  ON 1
ci_003                -5.502650e-02 3 1  ON 2
ci_004                -5.547601e-02 3 1  ON 3
ci_005                 2.618034e-02 3 1  ON 4
ci_006                 2.620001e-02 3 1  ON 5
ci_007                 2.039465e-02 3 1  ON 6
ci_008                 2.081752e-02 3 1  ON 7
ci_009                -1.634057e-02 3 1  ON 8
ci_010                -1.604888e-02 3 1  ON 9
ci_011                -1.395943e-02 3 1  ON 10
ci_012                -1.368263e-02 3 1  ON 11
ci_013                 1.235238e-02 3 1  ON 12
ci_014                 1.223162e-02 3 1  ON 13
ci_015                 1.373869e-02 3 1  ON 14
ci_016                 1.351629e-02 3 1  ON 15
ci_017                 1.112247e-02 3 1  ON 16
ci_018                 1.124609e-02 3 1  ON 17
ci_019                 4.291696e-03 3 1  ON 18
ci_020                 4.564278e-03 3 1  ON 19
ci_021                -8.210143e-03 3 1  ON 20
ci_022                -8.436401e-03 3 1  ON 21
ci_023                 6.664701e-03 3 1  ON 22
ci_024                 6.641617e-03 3 1  ON 23
ci_025                 8.844518e-03 3 1  ON 24
ci_026                 8.764713e-03 3 1  ON 25
ci_027                 6.746562e-03 3 1  ON 26
ci_028                 6.854238e-03 3 1  ON 27
ci_029                -5.729139e-03 3 1  ON 28
ci_030                -5.729164e-03 3 1  ON 29
ci_031                -2.506541e-03 3 1  ON 30
ci_032                -2.854184e-03 3 1  ON 31
ci_033                 4.784774e-03 3 1  ON 32
ci_034                 4.671048e-03 3 1  ON 33
ci_035                 3.231622e-03 3 1  ON 34
ci_036                 3.379796e-03 3 1  ON 35
ci_037                 4.924624e-03 3 1  ON 36
ci_038                 4.782183e-03 3 1  ON 37
ci_039                 4.707855e-03 3 1  ON 38
ci_040                 4.762073e-03 3 1  ON 39
ci_041                 3.863168e-03 3 1  ON 40
ci_042                 3.821765e-03 3 1  ON 41
ci_043                 4.052034e-03 3 1  ON 42
ci_044                 4.078570e-03 3 1  ON 43
ci_045                 3.351719e-03 3 1  ON 44
ci_046                 3.469003e-03 3 1  ON 45
ci_047                -1.947632e-03 3 1  ON 46
ci_048                -2.052564e-03 3 1  ON 47
ci_049                 1.741716e-03 3 1  ON 48
ci_050                 1.724975e-03 3 1  ON 49
ci_051                -2.252336e-03 3 1  ON 50
ci_052                -2.112657e-03 3 1  ON 51
ci_053                -2.304187e-03 3 1  ON 52
ci_054                -2.458125e-03 3 1  ON 53
ci_055                -1.411257e-03 3 1  ON 54
ci_056                -1.587627e-03 3 1  ON 55
ci_057                -1.358121e-03 3 1  ON 56
ci_058                -1.454993e-03 3 1  ON 57
ci_059                -9.235719e-04 3 1  ON 58
ci_060                -8.843476e-04 3 1  ON 59
ci_061                -1.191883e-03 3 1  ON 60
ci_062                -7.667170e-04 3 1  ON 61
ci_063                -7.283243e-04 3 1  ON 62
ci_064                -8.647340e-04 3 1  ON 63
ci_065                -1.793621e-03 3 1  ON 64
ci_066                -2.050077e-03 3 1  ON 65
ci_067                -1.499437e-03 3 1  ON 66
ci_068                -1.076114e-03 3 1  ON 67
ci_069                 2.036148e-04 3 1  ON 68
ci_070                 2.299650e-04 3 1  ON 69
ci_071                -1.846186e-03 3 1  ON 70
ci_072                -1.751569e-03 3 1  ON 71
ci_073                 6.164135e-04 3 1  ON 72
ci_074                 5.090444e-04 3 1  ON 73
ci_075                -3.642093e-04 3 1  ON 74
ci_076                -3.522598e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7436
    reference variance = 0.431949
====================================================
  Execution time = 4.9858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0106e-01
  Total weights = 1.9549e+06
  Execution time = 7.2389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488641089026
                                         uncertainty =       0.002666415369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488641089026
                                         uncertainty =       0.002666415369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494267653
  error estimate for blocks of size 2^( 2) =       0.000512793457
  error estimate for blocks of size 2^( 3) =       0.000529461989
  error estimate for blocks of size 2^( 4) =       0.000542537058
  error estimate for blocks of size 2^( 5) =       0.000549184937
  error estimate for blocks of size 2^( 6) =       0.000553519387
  error estimate for blocks of size 2^( 7) =       0.000556347375

      target function =      -0.610028250613
              le_mean =     -22.667207526938
             les_mean =     514.303391456411
             stat err =       0.000550397189
             autocorr =       1.240018135295
   target nu stat err =       0.000550397189
   target dn stat err =       0.003644493471
      target stat err =       0.001133352533
              std dev =       0.699000017978
             le_variance =       0.488601025134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488254072479
                                         uncertainty =       0.002660216897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488254072479
                                         uncertainty =       0.002660216897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494071917
  error estimate for blocks of size 2^( 2) =       0.000512597381
  error estimate for blocks of size 2^( 3) =       0.000529261204
  error estimate for blocks of size 2^( 4) =       0.000542327169
  error estimate for blocks of size 2^( 5) =       0.000548973061
  error estimate for blocks of size 2^( 6) =       0.000553293601
  error estimate for blocks of size 2^( 7) =       0.000556109886

      target function =      -0.605789081531
              le_mean =     -22.667208109164
             les_mean =     514.317495280239
             stat err =       0.000550175929
             autocorr =       1.240003277624
   target nu stat err =       0.000550175929
   target dn stat err =       0.012047240942
      target stat err =       0.003596551506
              std dev =       0.698723205213
             le_variance =       0.488214117503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488438372476
                                         uncertainty =       0.002663189551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488438372476
                                         uncertainty =       0.002663189551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494165138
  error estimate for blocks of size 2^( 2) =       0.000512690846
  error estimate for blocks of size 2^( 3) =       0.000529356870
  error estimate for blocks of size 2^( 4) =       0.000542427226
  error estimate for blocks of size 2^( 5) =       0.000549074191
  error estimate for blocks of size 2^( 6) =       0.000553402983
  error estimate for blocks of size 2^( 7) =       0.000556224254

      target function =      -0.609975878766
              le_mean =     -22.667207005786
             les_mean =     514.303540705229
             stat err =       0.000550282164
             autocorr =       1.240014218447
   target nu stat err =       0.000550282164
   target dn stat err =       0.003701255426
      target stat err =       0.001149786424
              std dev =       0.698855040088
             le_variance =       0.488398367056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488615176234
                                         uncertainty =       0.002666002789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488615176234
                                         uncertainty =       0.002666002789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494254550
  error estimate for blocks of size 2^( 2) =       0.000512780333
  error estimate for blocks of size 2^( 3) =       0.000529448555
  error estimate for blocks of size 2^( 4) =       0.000542523009
  error estimate for blocks of size 2^( 5) =       0.000549170707
  error estimate for blocks of size 2^( 6) =       0.000553504432
  error estimate for blocks of size 2^( 7) =       0.000556331614

      target function =      -0.609909513837
              le_mean =     -22.667207417536
             les_mean =     514.303779727864
             stat err =       0.000550382441
             autocorr =       1.240017424561
   target nu stat err =       0.000550382441
   target dn stat err =       0.003672910657
      target stat err =       0.001141247609
              std dev =       0.698981487468
             le_variance =       0.488575119823


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610028250613        initial  <--
     9.7656e-01     9.7656e+00             4.5492e-04        -0.605789081531
     3.9062e+00     3.9062e+01             1.1718e-04        -0.609975878766
     1.5625e+01     1.5625e+02             2.9519e-05        -0.609909513837

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 86.1641
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_001                -7.040629e-01 3 1  ON 0
ci_002                -7.023260e-01 3 1  ON 1
ci_003                -5.507753e-02 3 1  ON 2
ci_004                -5.552620e-02 3 1  ON 3
ci_005                 2.629589e-02 3 1  ON 4
ci_006                 2.631719e-02 3 1  ON 5
ci_007                 2.046637e-02 3 1  ON 6
ci_008                 2.089631e-02 3 1  ON 7
ci_009                -1.639055e-02 3 1  ON 8
ci_010                -1.610448e-02 3 1  ON 9
ci_011                -1.400763e-02 3 1  ON 10
ci_012                -1.373512e-02 3 1  ON 11
ci_013                 1.240180e-02 3 1  ON 12
ci_014                 1.228580e-02 3 1  ON 13
ci_015                 1.378734e-02 3 1  ON 14
ci_016                 1.355916e-02 3 1  ON 15
ci_017                 1.116134e-02 3 1  ON 16
ci_018                 1.128681e-02 3 1  ON 17
ci_019                 4.337715e-03 3 1  ON 18
ci_020                 4.624257e-03 3 1  ON 19
ci_021                -8.232690e-03 3 1  ON 20
ci_022                -8.445196e-03 3 1  ON 21
ci_023                 6.675238e-03 3 1  ON 22
ci_024                 6.660699e-03 3 1  ON 23
ci_025                 8.855384e-03 3 1  ON 24
ci_026                 8.743874e-03 3 1  ON 25
ci_027                 6.748885e-03 3 1  ON 26
ci_028                 6.852230e-03 3 1  ON 27
ci_029                -5.748621e-03 3 1  ON 28
ci_030                -5.738844e-03 3 1  ON 29
ci_031                -2.556553e-03 3 1  ON 30
ci_032                -2.877939e-03 3 1  ON 31
ci_033                 4.799899e-03 3 1  ON 32
ci_034                 4.685574e-03 3 1  ON 33
ci_035                 3.245133e-03 3 1  ON 34
ci_036                 3.398737e-03 3 1  ON 35
ci_037                 4.931908e-03 3 1  ON 36
ci_038                 4.792592e-03 3 1  ON 37
ci_039                 4.706775e-03 3 1  ON 38
ci_040                 4.762560e-03 3 1  ON 39
ci_041                 3.866830e-03 3 1  ON 40
ci_042                 3.811195e-03 3 1  ON 41
ci_043                 4.069761e-03 3 1  ON 42
ci_044                 4.078236e-03 3 1  ON 43
ci_045                 3.369398e-03 3 1  ON 44
ci_046                 3.482747e-03 3 1  ON 45
ci_047                -1.956276e-03 3 1  ON 46
ci_048                -2.062132e-03 3 1  ON 47
ci_049                 1.758831e-03 3 1  ON 48
ci_050                 1.729583e-03 3 1  ON 49
ci_051                -2.274371e-03 3 1  ON 50
ci_052                -2.113729e-03 3 1  ON 51
ci_053                -2.298009e-03 3 1  ON 52
ci_054                -2.450158e-03 3 1  ON 53
ci_055                -1.413916e-03 3 1  ON 54
ci_056                -1.574685e-03 3 1  ON 55
ci_057                -1.366253e-03 3 1  ON 56
ci_058                -1.464875e-03 3 1  ON 57
ci_059                -9.251969e-04 3 1  ON 58
ci_060                -8.882390e-04 3 1  ON 59
ci_061                -1.209087e-03 3 1  ON 60
ci_062                -7.890923e-04 3 1  ON 61
ci_063                -7.328907e-04 3 1  ON 62
ci_064                -8.666701e-04 3 1  ON 63
ci_065                -1.789720e-03 3 1  ON 64
ci_066                -2.052113e-03 3 1  ON 65
ci_067                -1.493642e-03 3 1  ON 66
ci_068                -1.071049e-03 3 1  ON 67
ci_069                 2.132627e-04 3 1  ON 68
ci_070                 2.316409e-04 3 1  ON 69
ci_071                -1.835025e-03 3 1  ON 70
ci_072                -1.752495e-03 3 1  ON 71
ci_073                 6.240512e-04 3 1  ON 72
ci_074                 5.161922e-04 3 1  ON 73
ci_075                -3.664630e-04 3 1  ON 74
ci_076                -3.554080e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4684e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.6328
    reference variance = 0.500572
====================================================
  Execution time = 5.1208e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9950e-01
  Total weights = 1.955183746e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487541921816
                                         uncertainty =       0.002625462689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487541921816
                                         uncertainty =       0.002625462689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493704774
  error estimate for blocks of size 2^( 2) =       0.000512614052
  error estimate for blocks of size 2^( 3) =       0.000529981391
  error estimate for blocks of size 2^( 4) =       0.000541845452
  error estimate for blocks of size 2^( 5) =       0.000548828166
  error estimate for blocks of size 2^( 6) =       0.000551007340
  error estimate for blocks of size 2^( 7) =       0.000552278355

      target function =      -0.610727808959
              le_mean =     -22.668078913612
             les_mean =     514.341303142761
             stat err =       0.000548489828
             autocorr =       1.234248198234
   target nu stat err =       0.000548489828
   target dn stat err =       0.003338537052
      target stat err =       0.001046745366
              std dev =       0.698203987718
             le_variance =       0.487488808466


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266807891361e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610729316189       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610735240683       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610735962500       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610736021635       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610736033730       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610736036595       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610736036516       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610736036567       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610736036432       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610736036692       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 4.659418e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610729316189       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610730801694       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610730982436       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610730997222       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610731000237       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610731000949       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610731000929       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610731000942       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610731000908       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610731000973       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 1.168439e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610729316189       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610729687840       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610729733044       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610729736741       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610729737494       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610729737671       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610729737666       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610729737669       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610729737661       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610729737677       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+02 is 2.923347e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.645209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0623e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_001                -7.040637e-01 3 1  ON 0
ci_002                -7.023284e-01 3 1  ON 1
ci_003                -5.507166e-02 3 1  ON 2
ci_004                -5.552209e-02 3 1  ON 3
ci_005                 2.628528e-02 3 1  ON 4
ci_006                 2.630551e-02 3 1  ON 5
ci_007                 2.046000e-02 3 1  ON 6
ci_008                 2.088862e-02 3 1  ON 7
ci_009                -1.638510e-02 3 1  ON 8
ci_010                -1.609872e-02 3 1  ON 9
ci_011                -1.399971e-02 3 1  ON 10
ci_012                -1.372996e-02 3 1  ON 11
ci_013                 1.239738e-02 3 1  ON 12
ci_014                 1.228070e-02 3 1  ON 13
ci_015                 1.378369e-02 3 1  ON 14
ci_016                 1.355695e-02 3 1  ON 15
ci_017                 1.115773e-02 3 1  ON 16
ci_018                 1.128337e-02 3 1  ON 17
ci_019                 4.334266e-03 3 1  ON 18
ci_020                 4.620087e-03 3 1  ON 19
ci_021                -8.231987e-03 3 1  ON 20
ci_022                -8.445292e-03 3 1  ON 21
ci_023                 6.673964e-03 3 1  ON 22
ci_024                 6.659424e-03 3 1  ON 23
ci_025                 8.856769e-03 3 1  ON 24
ci_026                 8.744427e-03 3 1  ON 25
ci_027                 6.747779e-03 3 1  ON 26
ci_028                 6.852428e-03 3 1  ON 27
ci_029                -5.746091e-03 3 1  ON 28
ci_030                -5.735129e-03 3 1  ON 29
ci_031                -2.552359e-03 3 1  ON 30
ci_032                -2.874723e-03 3 1  ON 31
ci_033                 4.797833e-03 3 1  ON 32
ci_034                 4.682943e-03 3 1  ON 33
ci_035                 3.243369e-03 3 1  ON 34
ci_036                 3.396442e-03 3 1  ON 35
ci_037                 4.930519e-03 3 1  ON 36
ci_038                 4.791332e-03 3 1  ON 37
ci_039                 4.705940e-03 3 1  ON 38
ci_040                 4.762328e-03 3 1  ON 39
ci_041                 3.865904e-03 3 1  ON 40
ci_042                 3.810359e-03 3 1  ON 41
ci_043                 4.068642e-03 3 1  ON 42
ci_044                 4.078372e-03 3 1  ON 43
ci_045                 3.369844e-03 3 1  ON 44
ci_046                 3.482470e-03 3 1  ON 45
ci_047                -1.955280e-03 3 1  ON 46
ci_048                -2.060193e-03 3 1  ON 47
ci_049                 1.758067e-03 3 1  ON 48
ci_050                 1.728121e-03 3 1  ON 49
ci_051                -2.273443e-03 3 1  ON 50
ci_052                -2.113297e-03 3 1  ON 51
ci_053                -2.298166e-03 3 1  ON 52
ci_054                -2.450261e-03 3 1  ON 53
ci_055                -1.415062e-03 3 1  ON 54
ci_056                -1.574016e-03 3 1  ON 55
ci_057                -1.366088e-03 3 1  ON 56
ci_058                -1.464471e-03 3 1  ON 57
ci_059                -9.240644e-04 3 1  ON 58
ci_060                -8.874988e-04 3 1  ON 59
ci_061                -1.208563e-03 3 1  ON 60
ci_062                -7.898022e-04 3 1  ON 61
ci_063                -7.321851e-04 3 1  ON 62
ci_064                -8.678274e-04 3 1  ON 63
ci_065                -1.790464e-03 3 1  ON 64
ci_066                -2.051858e-03 3 1  ON 65
ci_067                -1.491633e-03 3 1  ON 66
ci_068                -1.071680e-03 3 1  ON 67
ci_069                 2.118587e-04 3 1  ON 68
ci_070                 2.313965e-04 3 1  ON 69
ci_071                -1.834767e-03 3 1  ON 70
ci_072                -1.752057e-03 3 1  ON 71
ci_073                 6.242802e-04 3 1  ON 72
ci_074                 5.159855e-04 3 1  ON 73
ci_075                -3.644569e-04 3 1  ON 74
ci_076                -3.531494e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7042
    reference variance = 0.950477
====================================================
  Execution time = 4.9785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0419e-01
  Total weights = 1.9548e+06
  Execution time = 7.2355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486700285785
                                         uncertainty =       0.003496414696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486700285785
                                         uncertainty =       0.003496414696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493331633
  error estimate for blocks of size 2^( 2) =       0.000511838588
  error estimate for blocks of size 2^( 3) =       0.000528780831
  error estimate for blocks of size 2^( 4) =       0.000541270896
  error estimate for blocks of size 2^( 5) =       0.000547766671
  error estimate for blocks of size 2^( 6) =       0.000552245558
  error estimate for blocks of size 2^( 7) =       0.000555470742

      target function =      -0.609295569887
              le_mean =     -22.668137032930
             les_mean =     514.348710263574
             stat err =       0.000549188467
             autocorr =       1.239267008702
   target nu stat err =       0.000549188467
   target dn stat err =       0.006782157606
      target stat err =       0.002061902249
              std dev =       0.697676286503
             le_variance =       0.486752200749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486683667450
                                         uncertainty =       0.003504130679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486683667450
                                         uncertainty =       0.003504130679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493323204
  error estimate for blocks of size 2^( 2) =       0.000511829430
  error estimate for blocks of size 2^( 3) =       0.000528771238
  error estimate for blocks of size 2^( 4) =       0.000541260923
  error estimate for blocks of size 2^( 5) =       0.000547755637
  error estimate for blocks of size 2^( 6) =       0.000552234317
  error estimate for blocks of size 2^( 7) =       0.000555459713

      target function =      -0.609300197824
              le_mean =     -22.668136788498
             les_mean =     514.348683279427
             stat err =       0.000549177648
             autocorr =       1.239260528572
   target nu stat err =       0.000549177648
   target dn stat err =       0.006833568884
      target stat err =       0.002077292494
              std dev =       0.697664366263
             le_variance =       0.486735567954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486691880994
                                         uncertainty =       0.003500264788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486691880994
                                         uncertainty =       0.003500264788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493327370
  error estimate for blocks of size 2^( 2) =       0.000511833958
  error estimate for blocks of size 2^( 3) =       0.000528775989
  error estimate for blocks of size 2^( 4) =       0.000541265859
  error estimate for blocks of size 2^( 5) =       0.000547761130
  error estimate for blocks of size 2^( 6) =       0.000552239908
  error estimate for blocks of size 2^( 7) =       0.000555465202

      target function =      -0.609314758216
              le_mean =     -22.668136901167
             les_mean =     514.348640343154
             stat err =       0.000549183025
             autocorr =       1.239263865160
   target nu stat err =       0.000549183025
   target dn stat err =       0.006807374944
      target stat err =       0.002069564794
              std dev =       0.697670257900
             le_variance =       0.486743788758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486699226844
                                         uncertainty =       0.003496894385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486699226844
                                         uncertainty =       0.003496894385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493331096
  error estimate for blocks of size 2^( 2) =       0.000511838009
  error estimate for blocks of size 2^( 3) =       0.000528780224
  error estimate for blocks of size 2^( 4) =       0.000541270263
  error estimate for blocks of size 2^( 5) =       0.000547765967
  error estimate for blocks of size 2^( 6) =       0.000552244839
  error estimate for blocks of size 2^( 7) =       0.000555470014

      target function =      -0.608066318887
              le_mean =     -22.668137010488
             les_mean =     514.352787800917
             stat err =       0.000549187770
             autocorr =       1.239266565252
   target nu stat err =       0.000549187770
   target dn stat err =       0.007968355090
      target stat err =       0.002407058295
              std dev =       0.697675526953
             le_variance =       0.486751140909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609295569887        initial
     9.7656e+00     9.7656e+01             4.6594e-05        -0.609300197824
     3.9062e+01     3.9062e+02             1.1684e-05        -0.609314758216  <--
     1.5625e+02     1.5625e+03             2.9233e-06        -0.608066318887

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 8.6082e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_001                -7.040637e-01 3 1  ON 0
ci_002                -7.023284e-01 3 1  ON 1
ci_003                -5.507166e-02 3 1  ON 2
ci_004                -5.552209e-02 3 1  ON 3
ci_005                 2.628528e-02 3 1  ON 4
ci_006                 2.630551e-02 3 1  ON 5
ci_007                 2.046000e-02 3 1  ON 6
ci_008                 2.088862e-02 3 1  ON 7
ci_009                -1.638510e-02 3 1  ON 8
ci_010                -1.609872e-02 3 1  ON 9
ci_011                -1.399971e-02 3 1  ON 10
ci_012                -1.372996e-02 3 1  ON 11
ci_013                 1.239738e-02 3 1  ON 12
ci_014                 1.228070e-02 3 1  ON 13
ci_015                 1.378369e-02 3 1  ON 14
ci_016                 1.355695e-02 3 1  ON 15
ci_017                 1.115773e-02 3 1  ON 16
ci_018                 1.128337e-02 3 1  ON 17
ci_019                 4.334266e-03 3 1  ON 18
ci_020                 4.620087e-03 3 1  ON 19
ci_021                -8.231987e-03 3 1  ON 20
ci_022                -8.445292e-03 3 1  ON 21
ci_023                 6.673964e-03 3 1  ON 22
ci_024                 6.659424e-03 3 1  ON 23
ci_025                 8.856769e-03 3 1  ON 24
ci_026                 8.744427e-03 3 1  ON 25
ci_027                 6.747779e-03 3 1  ON 26
ci_028                 6.852428e-03 3 1  ON 27
ci_029                -5.746091e-03 3 1  ON 28
ci_030                -5.735129e-03 3 1  ON 29
ci_031                -2.552359e-03 3 1  ON 30
ci_032                -2.874723e-03 3 1  ON 31
ci_033                 4.797833e-03 3 1  ON 32
ci_034                 4.682943e-03 3 1  ON 33
ci_035                 3.243369e-03 3 1  ON 34
ci_036                 3.396442e-03 3 1  ON 35
ci_037                 4.930519e-03 3 1  ON 36
ci_038                 4.791332e-03 3 1  ON 37
ci_039                 4.705940e-03 3 1  ON 38
ci_040                 4.762328e-03 3 1  ON 39
ci_041                 3.865904e-03 3 1  ON 40
ci_042                 3.810359e-03 3 1  ON 41
ci_043                 4.068642e-03 3 1  ON 42
ci_044                 4.078372e-03 3 1  ON 43
ci_045                 3.369844e-03 3 1  ON 44
ci_046                 3.482470e-03 3 1  ON 45
ci_047                -1.955280e-03 3 1  ON 46
ci_048                -2.060193e-03 3 1  ON 47
ci_049                 1.758067e-03 3 1  ON 48
ci_050                 1.728121e-03 3 1  ON 49
ci_051                -2.273443e-03 3 1  ON 50
ci_052                -2.113297e-03 3 1  ON 51
ci_053                -2.298166e-03 3 1  ON 52
ci_054                -2.450261e-03 3 1  ON 53
ci_055                -1.415062e-03 3 1  ON 54
ci_056                -1.574016e-03 3 1  ON 55
ci_057                -1.366088e-03 3 1  ON 56
ci_058                -1.464471e-03 3 1  ON 57
ci_059                -9.240644e-04 3 1  ON 58
ci_060                -8.874988e-04 3 1  ON 59
ci_061                -1.208563e-03 3 1  ON 60
ci_062                -7.898022e-04 3 1  ON 61
ci_063                -7.321851e-04 3 1  ON 62
ci_064                -8.678274e-04 3 1  ON 63
ci_065                -1.790464e-03 3 1  ON 64
ci_066                -2.051858e-03 3 1  ON 65
ci_067                -1.491633e-03 3 1  ON 66
ci_068                -1.071680e-03 3 1  ON 67
ci_069                 2.118587e-04 3 1  ON 68
ci_070                 2.313965e-04 3 1  ON 69
ci_071                -1.834767e-03 3 1  ON 70
ci_072                -1.752057e-03 3 1  ON 71
ci_073                 6.242802e-04 3 1  ON 72
ci_074                 5.159855e-04 3 1  ON 73
ci_075                -3.644569e-04 3 1  ON 74
ci_076                -3.531494e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4671e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6161
    reference variance = 0.888846
====================================================
  Execution time = 5.1218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0367e-01
  Total weights = 1.955136554e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488549755464
                                         uncertainty =       0.002790022540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488549755464
                                         uncertainty =       0.002790022540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494218092
  error estimate for blocks of size 2^( 2) =       0.000512582765
  error estimate for blocks of size 2^( 3) =       0.000528927409
  error estimate for blocks of size 2^( 4) =       0.000540474622
  error estimate for blocks of size 2^( 5) =       0.000547367679
  error estimate for blocks of size 2^( 6) =       0.000549658991
  error estimate for blocks of size 2^( 7) =       0.000550134770

      target function =      -0.609441129501
              le_mean =     -22.667977117442
             les_mean =     514.340856720624
             stat err =       0.000546909015
             autocorr =       1.224596139546
   target nu stat err =       0.000546909015
   target dn stat err =       0.004877456271
      target stat err =       0.001495097731
              std dev =       0.698929927932
             le_variance =       0.488503044159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266797711744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609444518615       residual = 3.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609449176998       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609453243622       residual = 5.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609453724031       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609453762812       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609453768074       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609453774389       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609453778345       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609453778137       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609453778132       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609453777806       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 4.263290e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609444518615       residual = 3.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609445688311       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609446707377       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609446827599       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609446837290       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609446838598       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609446840172       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609446841157       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609446841105       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609446841104       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609446841022       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 1.069098e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609444518615       residual = 3.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609444811359       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609445066277       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609445096340       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609445098762       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609445099088       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609445099482       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609445099728       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609445099715       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609445099715       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609445099694       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+02 is 2.674801e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.651274 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2934e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_001                -7.040641e-01 3 1  ON 0
ci_002                -7.023313e-01 3 1  ON 1
ci_003                -5.506634e-02 3 1  ON 2
ci_004                -5.551636e-02 3 1  ON 3
ci_005                 2.627539e-02 3 1  ON 4
ci_006                 2.629481e-02 3 1  ON 5
ci_007                 2.045303e-02 3 1  ON 6
ci_008                 2.088289e-02 3 1  ON 7
ci_009                -1.637996e-02 3 1  ON 8
ci_010                -1.609180e-02 3 1  ON 9
ci_011                -1.399334e-02 3 1  ON 10
ci_012                -1.372391e-02 3 1  ON 11
ci_013                 1.239174e-02 3 1  ON 12
ci_014                 1.227581e-02 3 1  ON 13
ci_015                 1.377961e-02 3 1  ON 14
ci_016                 1.355268e-02 3 1  ON 15
ci_017                 1.115594e-02 3 1  ON 16
ci_018                 1.127942e-02 3 1  ON 17
ci_019                 4.330162e-03 3 1  ON 18
ci_020                 4.616355e-03 3 1  ON 19
ci_021                -8.229321e-03 3 1  ON 20
ci_022                -8.445194e-03 3 1  ON 21
ci_023                 6.672615e-03 3 1  ON 22
ci_024                 6.658984e-03 3 1  ON 23
ci_025                 8.859350e-03 3 1  ON 24
ci_026                 8.744433e-03 3 1  ON 25
ci_027                 6.746857e-03 3 1  ON 26
ci_028                 6.851991e-03 3 1  ON 27
ci_029                -5.745344e-03 3 1  ON 28
ci_030                -5.734703e-03 3 1  ON 29
ci_031                -2.548330e-03 3 1  ON 30
ci_032                -2.872898e-03 3 1  ON 31
ci_033                 4.796186e-03 3 1  ON 32
ci_034                 4.680645e-03 3 1  ON 33
ci_035                 3.241106e-03 3 1  ON 34
ci_036                 3.394287e-03 3 1  ON 35
ci_037                 4.928299e-03 3 1  ON 36
ci_038                 4.790372e-03 3 1  ON 37
ci_039                 4.706077e-03 3 1  ON 38
ci_040                 4.761739e-03 3 1  ON 39
ci_041                 3.865250e-03 3 1  ON 40
ci_042                 3.807530e-03 3 1  ON 41
ci_043                 4.069499e-03 3 1  ON 42
ci_044                 4.074305e-03 3 1  ON 43
ci_045                 3.370821e-03 3 1  ON 44
ci_046                 3.482505e-03 3 1  ON 45
ci_047                -1.954013e-03 3 1  ON 46
ci_048                -2.058943e-03 3 1  ON 47
ci_049                 1.758562e-03 3 1  ON 48
ci_050                 1.726035e-03 3 1  ON 49
ci_051                -2.272281e-03 3 1  ON 50
ci_052                -2.111939e-03 3 1  ON 51
ci_053                -2.297529e-03 3 1  ON 52
ci_054                -2.448925e-03 3 1  ON 53
ci_055                -1.414460e-03 3 1  ON 54
ci_056                -1.577305e-03 3 1  ON 55
ci_057                -1.366718e-03 3 1  ON 56
ci_058                -1.464923e-03 3 1  ON 57
ci_059                -9.225522e-04 3 1  ON 58
ci_060                -8.870035e-04 3 1  ON 59
ci_061                -1.208035e-03 3 1  ON 60
ci_062                -7.881409e-04 3 1  ON 61
ci_063                -7.372562e-04 3 1  ON 62
ci_064                -8.679028e-04 3 1  ON 63
ci_065                -1.789590e-03 3 1  ON 64
ci_066                -2.051191e-03 3 1  ON 65
ci_067                -1.492964e-03 3 1  ON 66
ci_068                -1.073219e-03 3 1  ON 67
ci_069                 2.120859e-04 3 1  ON 68
ci_070                 2.308321e-04 3 1  ON 69
ci_071                -1.835426e-03 3 1  ON 70
ci_072                -1.753254e-03 3 1  ON 71
ci_073                 6.237660e-04 3 1  ON 72
ci_074                 5.136209e-04 3 1  ON 73
ci_075                -3.644443e-04 3 1  ON 74
ci_076                -3.530882e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6257
    reference variance = 0.406721
====================================================
  Execution time = 4.9709e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0189e-01
  Total weights = 1.9549e+06
  Execution time = 7.2311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488816574121
                                         uncertainty =       0.002560259350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488816574121
                                         uncertainty =       0.002560259350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494350365
  error estimate for blocks of size 2^( 2) =       0.000512368748
  error estimate for blocks of size 2^( 3) =       0.000529625370
  error estimate for blocks of size 2^( 4) =       0.000542605544
  error estimate for blocks of size 2^( 5) =       0.000549193475
  error estimate for blocks of size 2^( 6) =       0.000553560256
  error estimate for blocks of size 2^( 7) =       0.000556480838

      target function =      -0.609815245762
              le_mean =     -22.667316352073
             les_mean =     514.309122141261
             stat err =       0.000550460028
             autocorr =       1.239886291390
   target nu stat err =       0.000550460028
   target dn stat err =       0.003230951811
      target stat err =       0.001012037333
              std dev =       0.699116990479
             le_variance =       0.488764566377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488784223138
                                         uncertainty =       0.002560559641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488784223138
                                         uncertainty =       0.002560559641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494334006
  error estimate for blocks of size 2^( 2) =       0.000512351969
  error estimate for blocks of size 2^( 3) =       0.000529608505
  error estimate for blocks of size 2^( 4) =       0.000542587911
  error estimate for blocks of size 2^( 5) =       0.000549175130
  error estimate for blocks of size 2^( 6) =       0.000553541798
  error estimate for blocks of size 2^( 7) =       0.000556463180

      target function =      -0.609811380659
              le_mean =     -22.667315638737
             les_mean =     514.309102031254
             stat err =       0.000550442005
             autocorr =       1.239887156089
   target nu stat err =       0.000550442005
   target dn stat err =       0.003229255845
      target stat err =       0.001011529227
              std dev =       0.699093855378
             le_variance =       0.488732218627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488800309473
                                         uncertainty =       0.002560409968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488800309473
                                         uncertainty =       0.002560409968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494342140
  error estimate for blocks of size 2^( 2) =       0.000512360313
  error estimate for blocks of size 2^( 3) =       0.000529616895
  error estimate for blocks of size 2^( 4) =       0.000542596688
  error estimate for blocks of size 2^( 5) =       0.000549184259
  error estimate for blocks of size 2^( 6) =       0.000553550982
  error estimate for blocks of size 2^( 7) =       0.000556471957

      target function =      -0.609813184186
              le_mean =     -22.667315988876
             les_mean =     514.309112213046
             stat err =       0.000550450971
             autocorr =       1.239886746427
   target nu stat err =       0.000550450971
   target dn stat err =       0.003229934183
      target stat err =       0.001011733562
              std dev =       0.699105359281
             le_variance =       0.488748303376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488814534818
                                         uncertainty =       0.002560278188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488814534818
                                         uncertainty =       0.002560278188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494349334
  error estimate for blocks of size 2^( 2) =       0.000512367691
  error estimate for blocks of size 2^( 3) =       0.000529624307
  error estimate for blocks of size 2^( 4) =       0.000542604433
  error estimate for blocks of size 2^( 5) =       0.000549192319
  error estimate for blocks of size 2^( 6) =       0.000553559093
  error estimate for blocks of size 2^( 7) =       0.000556479724

      target function =      -0.609815603424
              le_mean =     -22.667316306352
             les_mean =     514.309118845650
             stat err =       0.000550458892
             autocorr =       1.239886346571
   target nu stat err =       0.000550458892
   target dn stat err =       0.003230809516
      target stat err =       0.001011996944
              std dev =       0.699115532142
             le_variance =       0.488762527283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609815245762        initial
     9.7656e+00     9.7656e+01             4.2633e-05        -0.609811380659
     3.9062e+01     3.9062e+02             1.0691e-05        -0.609813184186
     1.5625e+02     1.5625e+03             2.6748e-06        -0.609815603424  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 8.6253e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_001                -7.040638e-01 3 1  ON 0
ci_002                -7.023292e-01 3 1  ON 1
ci_003                -5.507033e-02 3 1  ON 2
ci_004                -5.552066e-02 3 1  ON 3
ci_005                 2.628280e-02 3 1  ON 4
ci_006                 2.630283e-02 3 1  ON 5
ci_007                 2.045826e-02 3 1  ON 6
ci_008                 2.088719e-02 3 1  ON 7
ci_009                -1.638382e-02 3 1  ON 8
ci_010                -1.609699e-02 3 1  ON 9
ci_011                -1.399812e-02 3 1  ON 10
ci_012                -1.372845e-02 3 1  ON 11
ci_013                 1.239597e-02 3 1  ON 12
ci_014                 1.227948e-02 3 1  ON 13
ci_015                 1.378267e-02 3 1  ON 14
ci_016                 1.355588e-02 3 1  ON 15
ci_017                 1.115728e-02 3 1  ON 16
ci_018                 1.128238e-02 3 1  ON 17
ci_019                 4.333240e-03 3 1  ON 18
ci_020                 4.619153e-03 3 1  ON 19
ci_021                -8.231321e-03 3 1  ON 20
ci_022                -8.445268e-03 3 1  ON 21
ci_023                 6.673627e-03 3 1  ON 22
ci_024                 6.659314e-03 3 1  ON 23
ci_025                 8.857414e-03 3 1  ON 24
ci_026                 8.744429e-03 3 1  ON 25
ci_027                 6.747548e-03 3 1  ON 26
ci_028                 6.852319e-03 3 1  ON 27
ci_029                -5.745904e-03 3 1  ON 28
ci_030                -5.735022e-03 3 1  ON 29
ci_031                -2.551351e-03 3 1  ON 30
ci_032                -2.874266e-03 3 1  ON 31
ci_033                 4.797421e-03 3 1  ON 32
ci_034                 4.682368e-03 3 1  ON 33
ci_035                 3.242803e-03 3 1  ON 34
ci_036                 3.395903e-03 3 1  ON 35
ci_037                 4.929964e-03 3 1  ON 36
ci_038                 4.791092e-03 3 1  ON 37
ci_039                 4.705974e-03 3 1  ON 38
ci_040                 4.762180e-03 3 1  ON 39
ci_041                 3.865740e-03 3 1  ON 40
ci_042                 3.809651e-03 3 1  ON 41
ci_043                 4.068856e-03 3 1  ON 42
ci_044                 4.077354e-03 3 1  ON 43
ci_045                 3.370089e-03 3 1  ON 44
ci_046                 3.482479e-03 3 1  ON 45
ci_047                -1.954963e-03 3 1  ON 46
ci_048                -2.059881e-03 3 1  ON 47
ci_049                 1.758190e-03 3 1  ON 48
ci_050                 1.727599e-03 3 1  ON 49
ci_051                -2.273152e-03 3 1  ON 50
ci_052                -2.112958e-03 3 1  ON 51
ci_053                -2.298007e-03 3 1  ON 52
ci_054                -2.449927e-03 3 1  ON 53
ci_055                -1.414911e-03 3 1  ON 54
ci_056                -1.574839e-03 3 1  ON 55
ci_057                -1.366246e-03 3 1  ON 56
ci_058                -1.464584e-03 3 1  ON 57
ci_059                -9.236861e-04 3 1  ON 58
ci_060                -8.873749e-04 3 1  ON 59
ci_061                -1.208431e-03 3 1  ON 60
ci_062                -7.893866e-04 3 1  ON 61
ci_063                -7.334537e-04 3 1  ON 62
ci_064                -8.678462e-04 3 1  ON 63
ci_065                -1.790245e-03 3 1  ON 64
ci_066                -2.051691e-03 3 1  ON 65
ci_067                -1.491966e-03 3 1  ON 66
ci_068                -1.072065e-03 3 1  ON 67
ci_069                 2.119156e-04 3 1  ON 68
ci_070                 2.312554e-04 3 1  ON 69
ci_071                -1.834932e-03 3 1  ON 70
ci_072                -1.752356e-03 3 1  ON 71
ci_073                 6.241516e-04 3 1  ON 72
ci_074                 5.153937e-04 3 1  ON 73
ci_075                -3.644538e-04 3 1  ON 74
ci_076                -3.531342e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4919e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6932
    reference variance = 0.586336
====================================================
  Execution time = 5.1183e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0680e-01
  Total weights = 1.954846894e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491362154635
                                         uncertainty =       0.003275001726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491362154635
                                         uncertainty =       0.003275001726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495782308
  error estimate for blocks of size 2^( 2) =       0.000514311995
  error estimate for blocks of size 2^( 3) =       0.000530668684
  error estimate for blocks of size 2^( 4) =       0.000543202997
  error estimate for blocks of size 2^( 5) =       0.000551126359
  error estimate for blocks of size 2^( 6) =       0.000554491623
  error estimate for blocks of size 2^( 7) =       0.000557743034

      target function =      -0.608315357314
              le_mean =     -22.667237463157
             les_mean =     514.310454460723
             stat err =       0.000551641003
             autocorr =       1.238029604718
   target nu stat err =       0.000551641003
   target dn stat err =       0.005650609103
      target stat err =       0.001717902148
              std dev =       0.701142063470
             le_variance =       0.491600193167


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266723746316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608319894267       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608321423605       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608321579537       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608321593705       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608321600369       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608321601381       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608321602211       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608321602040       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608321601911       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608321601845       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 1.240169e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608319894267       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608320276885       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608320315883       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608320319425       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608320321090       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608320321343       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608320321550       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608320321507       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608320321475       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608320321459       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+02 is 3.102783e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608319894267       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608319989940       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608319999690       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608320000576       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608320000992       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608320001055       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608320001107       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608320001096       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608320001088       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608320001084       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+02 is 7.758433e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.656293 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0565e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_001                -7.040650e-01 3 1  ON 0
ci_002                -7.023287e-01 3 1  ON 1
ci_003                -5.506921e-02 3 1  ON 2
ci_004                -5.551944e-02 3 1  ON 3
ci_005                 2.628017e-02 3 1  ON 4
ci_006                 2.629973e-02 3 1  ON 5
ci_007                 2.045670e-02 3 1  ON 6
ci_008                 2.088539e-02 3 1  ON 7
ci_009                -1.638257e-02 3 1  ON 8
ci_010                -1.609594e-02 3 1  ON 9
ci_011                -1.399679e-02 3 1  ON 10
ci_012                -1.372695e-02 3 1  ON 11
ci_013                 1.239485e-02 3 1  ON 12
ci_014                 1.227851e-02 3 1  ON 13
ci_015                 1.378197e-02 3 1  ON 14
ci_016                 1.355482e-02 3 1  ON 15
ci_017                 1.115705e-02 3 1  ON 16
ci_018                 1.128162e-02 3 1  ON 17
ci_019                 4.332303e-03 3 1  ON 18
ci_020                 4.617816e-03 3 1  ON 19
ci_021                -8.230885e-03 3 1  ON 20
ci_022                -8.444532e-03 3 1  ON 21
ci_023                 6.673600e-03 3 1  ON 22
ci_024                 6.659350e-03 3 1  ON 23
ci_025                 8.857480e-03 3 1  ON 24
ci_026                 8.744031e-03 3 1  ON 25
ci_027                 6.747646e-03 3 1  ON 26
ci_028                 6.852239e-03 3 1  ON 27
ci_029                -5.745740e-03 3 1  ON 28
ci_030                -5.734620e-03 3 1  ON 29
ci_031                -2.550552e-03 3 1  ON 30
ci_032                -2.872918e-03 3 1  ON 31
ci_033                 4.796933e-03 3 1  ON 32
ci_034                 4.682090e-03 3 1  ON 33
ci_035                 3.242177e-03 3 1  ON 34
ci_036                 3.395318e-03 3 1  ON 35
ci_037                 4.929619e-03 3 1  ON 36
ci_038                 4.790816e-03 3 1  ON 37
ci_039                 4.706074e-03 3 1  ON 38
ci_040                 4.762401e-03 3 1  ON 39
ci_041                 3.865575e-03 3 1  ON 40
ci_042                 3.809345e-03 3 1  ON 41
ci_043                 4.068532e-03 3 1  ON 42
ci_044                 4.076964e-03 3 1  ON 43
ci_045                 3.369851e-03 3 1  ON 44
ci_046                 3.482539e-03 3 1  ON 45
ci_047                -1.954381e-03 3 1  ON 46
ci_048                -2.059458e-03 3 1  ON 47
ci_049                 1.758219e-03 3 1  ON 48
ci_050                 1.727175e-03 3 1  ON 49
ci_051                -2.273026e-03 3 1  ON 50
ci_052                -2.113085e-03 3 1  ON 51
ci_053                -2.297675e-03 3 1  ON 52
ci_054                -2.449857e-03 3 1  ON 53
ci_055                -1.414842e-03 3 1  ON 54
ci_056                -1.574971e-03 3 1  ON 55
ci_057                -1.366089e-03 3 1  ON 56
ci_058                -1.464533e-03 3 1  ON 57
ci_059                -9.235116e-04 3 1  ON 58
ci_060                -8.868091e-04 3 1  ON 59
ci_061                -1.208292e-03 3 1  ON 60
ci_062                -7.892202e-04 3 1  ON 61
ci_063                -7.333928e-04 3 1  ON 62
ci_064                -8.675088e-04 3 1  ON 63
ci_065                -1.790388e-03 3 1  ON 64
ci_066                -2.051774e-03 3 1  ON 65
ci_067                -1.491882e-03 3 1  ON 66
ci_068                -1.072277e-03 3 1  ON 67
ci_069                 2.119213e-04 3 1  ON 68
ci_070                 2.309506e-04 3 1  ON 69
ci_071                -1.834942e-03 3 1  ON 70
ci_072                -1.752780e-03 3 1  ON 71
ci_073                 6.240370e-04 3 1  ON 72
ci_074                 5.152062e-04 3 1  ON 73
ci_075                -3.643253e-04 3 1  ON 74
ci_076                -3.527167e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.5794
    reference variance = 0.513021
====================================================
  Execution time = 4.9500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0225e-01
  Total weights = 1.9553e+06
  Execution time = 7.2268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488625124441
                                         uncertainty =       0.002932399677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488625124441
                                         uncertainty =       0.002932399677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494236940
  error estimate for blocks of size 2^( 2) =       0.000512882456
  error estimate for blocks of size 2^( 3) =       0.000529691282
  error estimate for blocks of size 2^( 4) =       0.000541604428
  error estimate for blocks of size 2^( 5) =       0.000548037098
  error estimate for blocks of size 2^( 6) =       0.000549785556
  error estimate for blocks of size 2^( 7) =       0.000550784240

      target function =      -0.610094192757
              le_mean =     -22.668871517027
             les_mean =     514.379984763053
             stat err =       0.000547552831
             autocorr =       1.227387377145
   target nu stat err =       0.000547552831
   target dn stat err =       0.003497253551
      target stat err =       0.001091611702
              std dev =       0.698956583918
             le_variance =       0.488540306202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488614650201
                                         uncertainty =       0.002932169001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488614650201
                                         uncertainty =       0.002932169001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494231648
  error estimate for blocks of size 2^( 2) =       0.000512877041
  error estimate for blocks of size 2^( 3) =       0.000529685740
  error estimate for blocks of size 2^( 4) =       0.000541598610
  error estimate for blocks of size 2^( 5) =       0.000548031328
  error estimate for blocks of size 2^( 6) =       0.000549779766
  error estimate for blocks of size 2^( 7) =       0.000550778033

      target function =      -0.610097757160
              le_mean =     -22.668871380272
             les_mean =     514.379966661491
             stat err =       0.000547546935
             autocorr =       1.227387229401
   target nu stat err =       0.000547546935
   target dn stat err =       0.003497076615
      target stat err =       0.001091571400
              std dev =       0.698949099292
             le_variance =       0.488529843401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488619881252
                                         uncertainty =       0.002932284184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488619881252
                                         uncertainty =       0.002932284184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494234291
  error estimate for blocks of size 2^( 2) =       0.000512879745
  error estimate for blocks of size 2^( 3) =       0.000529688508
  error estimate for blocks of size 2^( 4) =       0.000541601516
  error estimate for blocks of size 2^( 5) =       0.000548034210
  error estimate for blocks of size 2^( 6) =       0.000549782658
  error estimate for blocks of size 2^( 7) =       0.000550781134

      target function =      -0.610096204377
              le_mean =     -22.668871448319
             les_mean =     514.379974938181
             stat err =       0.000547549879
             autocorr =       1.227387303101
   target nu stat err =       0.000547549879
   target dn stat err =       0.003497159879
      target stat err =       0.001091590822
              std dev =       0.698952837277
             le_variance =       0.488535068738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488624468663
                                         uncertainty =       0.002932385230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488624468663
                                         uncertainty =       0.002932385230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494236609
  error estimate for blocks of size 2^( 2) =       0.000512882117
  error estimate for blocks of size 2^( 3) =       0.000529690935
  error estimate for blocks of size 2^( 4) =       0.000541604064
  error estimate for blocks of size 2^( 5) =       0.000548036737
  error estimate for blocks of size 2^( 6) =       0.000549785194
  error estimate for blocks of size 2^( 7) =       0.000550783852

      target function =      -0.610094486528
              le_mean =     -22.668871508406
             les_mean =     514.379983393464
             stat err =       0.000547552462
             autocorr =       1.227387367852
   target nu stat err =       0.000547552462
   target dn stat err =       0.003497241169
      target stat err =       0.001091609042
              std dev =       0.698956115317
             le_variance =       0.488539651139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610094192757        initial
     3.9062e+01     3.9062e+02             1.2402e-05        -0.610097757160  <--
     1.5625e+02     1.5625e+03             3.1028e-06        -0.610096204377
     6.2500e+02     6.2500e+03             7.7584e-07        -0.610094486528

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 8.5747e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_001                -7.040686e-01 3 1  ON 0
ci_002                -7.023274e-01 3 1  ON 1
ci_003                -5.506587e-02 3 1  ON 2
ci_004                -5.551581e-02 3 1  ON 3
ci_005                 2.627228e-02 3 1  ON 4
ci_006                 2.629043e-02 3 1  ON 5
ci_007                 2.045204e-02 3 1  ON 6
ci_008                 2.088000e-02 3 1  ON 7
ci_009                -1.637885e-02 3 1  ON 8
ci_010                -1.609280e-02 3 1  ON 9
ci_011                -1.399282e-02 3 1  ON 10
ci_012                -1.372246e-02 3 1  ON 11
ci_013                 1.239149e-02 3 1  ON 12
ci_014                 1.227562e-02 3 1  ON 13
ci_015                 1.377989e-02 3 1  ON 14
ci_016                 1.355165e-02 3 1  ON 15
ci_017                 1.115637e-02 3 1  ON 16
ci_018                 1.127935e-02 3 1  ON 17
ci_019                 4.329493e-03 3 1  ON 18
ci_020                 4.613806e-03 3 1  ON 19
ci_021                -8.229580e-03 3 1  ON 20
ci_022                -8.442325e-03 3 1  ON 21
ci_023                 6.673519e-03 3 1  ON 22
ci_024                 6.659457e-03 3 1  ON 23
ci_025                 8.857678e-03 3 1  ON 24
ci_026                 8.742839e-03 3 1  ON 25
ci_027                 6.747941e-03 3 1  ON 26
ci_028                 6.851999e-03 3 1  ON 27
ci_029                -5.745249e-03 3 1  ON 28
ci_030                -5.733413e-03 3 1  ON 29
ci_031                -2.548157e-03 3 1  ON 30
ci_032                -2.868877e-03 3 1  ON 31
ci_033                 4.795472e-03 3 1  ON 32
ci_034                 4.681255e-03 3 1  ON 33
ci_035                 3.240303e-03 3 1  ON 34
ci_036                 3.393564e-03 3 1  ON 35
ci_037                 4.928585e-03 3 1  ON 36
ci_038                 4.789991e-03 3 1  ON 37
ci_039                 4.706373e-03 3 1  ON 38
ci_040                 4.763063e-03 3 1  ON 39
ci_041                 3.865080e-03 3 1  ON 40
ci_042                 3.808428e-03 3 1  ON 41
ci_043                 4.067561e-03 3 1  ON 42
ci_044                 4.075792e-03 3 1  ON 43
ci_045                 3.369139e-03 3 1  ON 44
ci_046                 3.482719e-03 3 1  ON 45
ci_047                -1.952636e-03 3 1  ON 46
ci_048                -2.058193e-03 3 1  ON 47
ci_049                 1.758303e-03 3 1  ON 48
ci_050                 1.725902e-03 3 1  ON 49
ci_051                -2.272648e-03 3 1  ON 50
ci_052                -2.113469e-03 3 1  ON 51
ci_053                -2.296680e-03 3 1  ON 52
ci_054                -2.449649e-03 3 1  ON 53
ci_055                -1.414635e-03 3 1  ON 54
ci_056                -1.575365e-03 3 1  ON 55
ci_057                -1.365620e-03 3 1  ON 56
ci_058                -1.464379e-03 3 1  ON 57
ci_059                -9.229888e-04 3 1  ON 58
ci_060                -8.851133e-04 3 1  ON 59
ci_061                -1.207876e-03 3 1  ON 60
ci_062                -7.887213e-04 3 1  ON 61
ci_063                -7.332104e-04 3 1  ON 62
ci_064                -8.664973e-04 3 1  ON 63
ci_065                -1.790818e-03 3 1  ON 64
ci_066                -2.052022e-03 3 1  ON 65
ci_067                -1.491628e-03 3 1  ON 66
ci_068                -1.072911e-03 3 1  ON 67
ci_069                 2.119384e-04 3 1  ON 68
ci_070                 2.300371e-04 3 1  ON 69
ci_071                -1.834972e-03 3 1  ON 70
ci_072                -1.754049e-03 3 1  ON 71
ci_073                 6.236939e-04 3 1  ON 72
ci_074                 5.146443e-04 3 1  ON 73
ci_075                -3.639403e-04 3 1  ON 74
ci_076                -3.514653e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4632e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2684e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6037
    reference variance = 0.324799
====================================================
  Execution time = 5.1214e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0188e-01
  Total weights = 1.955222484e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489717588012
                                         uncertainty =       0.003640724480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489717588012
                                         uncertainty =       0.003640724480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494796742
  error estimate for blocks of size 2^( 2) =       0.000513009418
  error estimate for blocks of size 2^( 3) =       0.000529859369
  error estimate for blocks of size 2^( 4) =       0.000542562343
  error estimate for blocks of size 2^( 5) =       0.000548990162
  error estimate for blocks of size 2^( 6) =       0.000554661610
  error estimate for blocks of size 2^( 7) =       0.000560305471

      target function =      -0.609919078227
              le_mean =     -22.667718985529
             les_mean =     514.327359586593
             stat err =       0.000551629896
             autocorr =       1.242916427521
   target nu stat err =       0.000551629896
   target dn stat err =       0.004354126623
      target stat err =       0.001342487537
              std dev =       0.699748263137
             le_variance =       0.489647631763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266771898553e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609921718462       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609927393244       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609927944184       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609928016364       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609928045635       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609928047762       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609928047496       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609928046979       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 4.712417e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609921718462       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609923141371       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609923279327       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609923297380       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609923304688       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609923305214       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609923305146       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609923305017       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 1.181712e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609921718462       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609922074454       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609922108957       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609922113470       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609922115297       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609922115428       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609922115411       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609922115378       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+02 is 2.956544e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.660243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0575e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_001                -7.040699e-01 3 1  ON 0
ci_002                -7.023293e-01 3 1  ON 1
ci_003                -5.506018e-02 3 1  ON 2
ci_004                -5.551038e-02 3 1  ON 3
ci_005                 2.626133e-02 3 1  ON 4
ci_006                 2.627861e-02 3 1  ON 5
ci_007                 2.044522e-02 3 1  ON 6
ci_008                 2.087364e-02 3 1  ON 7
ci_009                -1.637398e-02 3 1  ON 8
ci_010                -1.608798e-02 3 1  ON 9
ci_011                -1.398692e-02 3 1  ON 10
ci_012                -1.371735e-02 3 1  ON 11
ci_013                 1.238713e-02 3 1  ON 12
ci_014                 1.227172e-02 3 1  ON 13
ci_015                 1.377529e-02 3 1  ON 14
ci_016                 1.354712e-02 3 1  ON 15
ci_017                 1.115353e-02 3 1  ON 16
ci_018                 1.127692e-02 3 1  ON 17
ci_019                 4.326420e-03 3 1  ON 18
ci_020                 4.610702e-03 3 1  ON 19
ci_021                -8.229085e-03 3 1  ON 20
ci_022                -8.441779e-03 3 1  ON 21
ci_023                 6.671804e-03 3 1  ON 22
ci_024                 6.657926e-03 3 1  ON 23
ci_025                 8.858633e-03 3 1  ON 24
ci_026                 8.744347e-03 3 1  ON 25
ci_027                 6.747099e-03 3 1  ON 26
ci_028                 6.851876e-03 3 1  ON 27
ci_029                -5.744328e-03 3 1  ON 28
ci_030                -5.731770e-03 3 1  ON 29
ci_031                -2.544725e-03 3 1  ON 30
ci_032                -2.865743e-03 3 1  ON 31
ci_033                 4.793967e-03 3 1  ON 32
ci_034                 4.679417e-03 3 1  ON 33
ci_035                 3.237685e-03 3 1  ON 34
ci_036                 3.391325e-03 3 1  ON 35
ci_037                 4.928662e-03 3 1  ON 36
ci_038                 4.790737e-03 3 1  ON 37
ci_039                 4.706175e-03 3 1  ON 38
ci_040                 4.763338e-03 3 1  ON 39
ci_041                 3.864670e-03 3 1  ON 40
ci_042                 3.807938e-03 3 1  ON 41
ci_043                 4.066375e-03 3 1  ON 42
ci_044                 4.074952e-03 3 1  ON 43
ci_045                 3.369248e-03 3 1  ON 44
ci_046                 3.481403e-03 3 1  ON 45
ci_047                -1.951152e-03 3 1  ON 46
ci_048                -2.056570e-03 3 1  ON 47
ci_049                 1.756856e-03 3 1  ON 48
ci_050                 1.725611e-03 3 1  ON 49
ci_051                -2.272029e-03 3 1  ON 50
ci_052                -2.112479e-03 3 1  ON 51
ci_053                -2.296311e-03 3 1  ON 52
ci_054                -2.449875e-03 3 1  ON 53
ci_055                -1.414741e-03 3 1  ON 54
ci_056                -1.575126e-03 3 1  ON 55
ci_057                -1.365376e-03 3 1  ON 56
ci_058                -1.464089e-03 3 1  ON 57
ci_059                -9.233538e-04 3 1  ON 58
ci_060                -8.849767e-04 3 1  ON 59
ci_061                -1.206469e-03 3 1  ON 60
ci_062                -7.880985e-04 3 1  ON 61
ci_063                -7.330567e-04 3 1  ON 62
ci_064                -8.658424e-04 3 1  ON 63
ci_065                -1.791597e-03 3 1  ON 64
ci_066                -2.051616e-03 3 1  ON 65
ci_067                -1.493982e-03 3 1  ON 66
ci_068                -1.073974e-03 3 1  ON 67
ci_069                 2.109338e-04 3 1  ON 68
ci_070                 2.294146e-04 3 1  ON 69
ci_071                -1.835450e-03 3 1  ON 70
ci_072                -1.755819e-03 3 1  ON 71
ci_073                 6.227769e-04 3 1  ON 72
ci_074                 5.146282e-04 3 1  ON 73
ci_075                -3.643913e-04 3 1  ON 74
ci_076                -3.507053e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.5692
    reference variance = 0.375123
====================================================
  Execution time = 5.1784e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0210e-01
  Total weights = 1.9547e+06
  Execution time = 7.2341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489620049675
                                         uncertainty =       0.003286275237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489620049675
                                         uncertainty =       0.003286275237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494776059
  error estimate for blocks of size 2^( 2) =       0.000513072462
  error estimate for blocks of size 2^( 3) =       0.000530013169
  error estimate for blocks of size 2^( 4) =       0.000541055753
  error estimate for blocks of size 2^( 5) =       0.000548278851
  error estimate for blocks of size 2^( 6) =       0.000550885891
  error estimate for blocks of size 2^( 7) =       0.000554780722

      target function =      -0.609983201477
              le_mean =     -22.668262284605
             les_mean =     514.352228061456
             stat err =       0.000548750304
             autocorr =       1.230076705976
   target nu stat err =       0.000548750304
   target dn stat err =       0.003906041803
      target stat err =       0.001210818817
              std dev =       0.699719012498
             le_variance =       0.489606696451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489589378162
                                         uncertainty =       0.003292139517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489589378162
                                         uncertainty =       0.003292139517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494760570
  error estimate for blocks of size 2^( 2) =       0.000513056864
  error estimate for blocks of size 2^( 3) =       0.000529996877
  error estimate for blocks of size 2^( 4) =       0.000541038894
  error estimate for blocks of size 2^( 5) =       0.000548261586
  error estimate for blocks of size 2^( 6) =       0.000550868071
  error estimate for blocks of size 2^( 7) =       0.000554762704

      target function =      -0.610003653137
              le_mean =     -22.668262690309
             les_mean =     514.352179093879
             stat err =       0.000548732814
             autocorr =       1.230075308795
   target nu stat err =       0.000548732814
   target dn stat err =       0.003904549542
      target stat err =       0.001210457113
              std dev =       0.699697107625
             le_variance =       0.489576042418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489604616935
                                         uncertainty =       0.003289207539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489604616935
                                         uncertainty =       0.003289207539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494768265
  error estimate for blocks of size 2^( 2) =       0.000513064614
  error estimate for blocks of size 2^( 3) =       0.000530004972
  error estimate for blocks of size 2^( 4) =       0.000541047272
  error estimate for blocks of size 2^( 5) =       0.000548270167
  error estimate for blocks of size 2^( 6) =       0.000550876928
  error estimate for blocks of size 2^( 7) =       0.000554771657

      target function =      -0.609993942292
              le_mean =     -22.668262483227
             les_mean =     514.352201677490
             stat err =       0.000548741506
             autocorr =       1.230076013576
   target nu stat err =       0.000548741506
   target dn stat err =       0.003905193313
      target stat err =       0.001210609821
              std dev =       0.699707990884
             le_variance =       0.489591272507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489618113434
                                         uncertainty =       0.003286641285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489618113434
                                         uncertainty =       0.003286641285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494775081
  error estimate for blocks of size 2^( 2) =       0.000513071477
  error estimate for blocks of size 2^( 3) =       0.000530012140
  error estimate for blocks of size 2^( 4) =       0.000541054689
  error estimate for blocks of size 2^( 5) =       0.000548277761
  error estimate for blocks of size 2^( 6) =       0.000550884767
  error estimate for blocks of size 2^( 7) =       0.000554779585

      target function =      -0.609984588106
              le_mean =     -22.668262308922
             les_mean =     514.352224594107
             stat err =       0.000548749200
             autocorr =       1.230076620060
   target nu stat err =       0.000548749200
   target dn stat err =       0.003905924483
      target stat err =       0.001210789549
              std dev =       0.699717629700
             le_variance =       0.489604761313


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609983201477        initial
     9.7656e+00     9.7656e+01             4.7124e-05        -0.610003653137  <--
     3.9062e+01     3.9062e+02             1.1817e-05        -0.609993942292
     1.5625e+02     1.5625e+03             2.9565e-06        -0.609984588106

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 8.8051e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_001                -7.040735e-01 3 1  ON 0
ci_002                -7.023350e-01 3 1  ON 1
ci_003                -5.504313e-02 3 1  ON 2
ci_004                -5.549411e-02 3 1  ON 3
ci_005                 2.622864e-02 3 1  ON 4
ci_006                 2.624330e-02 3 1  ON 5
ci_007                 2.042484e-02 3 1  ON 6
ci_008                 2.085464e-02 3 1  ON 7
ci_009                -1.635945e-02 3 1  ON 8
ci_010                -1.607359e-02 3 1  ON 9
ci_011                -1.396925e-02 3 1  ON 10
ci_012                -1.370207e-02 3 1  ON 11
ci_013                 1.237411e-02 3 1  ON 12
ci_014                 1.226005e-02 3 1  ON 13
ci_015                 1.376153e-02 3 1  ON 14
ci_016                 1.353357e-02 3 1  ON 15
ci_017                 1.114504e-02 3 1  ON 16
ci_018                 1.126963e-02 3 1  ON 17
ci_019                 4.317226e-03 3 1  ON 18
ci_020                 4.601416e-03 3 1  ON 19
ci_021                -8.227605e-03 3 1  ON 20
ci_022                -8.440146e-03 3 1  ON 21
ci_023                 6.666678e-03 3 1  ON 22
ci_024                 6.653351e-03 3 1  ON 23
ci_025                 8.861492e-03 3 1  ON 24
ci_026                 8.748861e-03 3 1  ON 25
ci_027                 6.744586e-03 3 1  ON 26
ci_028                 6.851511e-03 3 1  ON 27
ci_029                -5.741572e-03 3 1  ON 28
ci_030                -5.726857e-03 3 1  ON 29
ci_031                -2.534463e-03 3 1  ON 30
ci_032                -2.856370e-03 3 1  ON 31
ci_033                 4.789468e-03 3 1  ON 32
ci_034                 4.673922e-03 3 1  ON 33
ci_035                 3.229862e-03 3 1  ON 34
ci_036                 3.384635e-03 3 1  ON 35
ci_037                 4.928891e-03 3 1  ON 36
ci_038                 4.792968e-03 3 1  ON 37
ci_039                 4.705585e-03 3 1  ON 38
ci_040                 4.764159e-03 3 1  ON 39
ci_041                 3.863445e-03 3 1  ON 40
ci_042                 3.806474e-03 3 1  ON 41
ci_043                 4.062826e-03 3 1  ON 42
ci_044                 4.072437e-03 3 1  ON 43
ci_045                 3.369578e-03 3 1  ON 44
ci_046                 3.477468e-03 3 1  ON 45
ci_047                -1.946715e-03 3 1  ON 46
ci_048                -2.051721e-03 3 1  ON 47
ci_049                 1.752529e-03 3 1  ON 48
ci_050                 1.724740e-03 3 1  ON 49
ci_051                -2.270173e-03 3 1  ON 50
ci_052                -2.109514e-03 3 1  ON 51
ci_053                -2.295212e-03 3 1  ON 52
ci_054                -2.450550e-03 3 1  ON 53
ci_055                -1.415057e-03 3 1  ON 54
ci_056                -1.574412e-03 3 1  ON 55
ci_057                -1.364648e-03 3 1  ON 56
ci_058                -1.463223e-03 3 1  ON 57
ci_059                -9.244442e-04 3 1  ON 58
ci_060                -8.845684e-04 3 1  ON 59
ci_061                -1.202262e-03 3 1  ON 60
ci_062                -7.862355e-04 3 1  ON 61
ci_063                -7.325991e-04 3 1  ON 62
ci_064                -8.638864e-04 3 1  ON 63
ci_065                -1.793925e-03 3 1  ON 64
ci_066                -2.050401e-03 3 1  ON 65
ci_067                -1.501021e-03 3 1  ON 66
ci_068                -1.077154e-03 3 1  ON 67
ci_069                 2.079303e-04 3 1  ON 68
ci_070                 2.275528e-04 3 1  ON 69
ci_071                -1.836878e-03 3 1  ON 70
ci_072                -1.761110e-03 3 1  ON 71
ci_073                 6.200366e-04 3 1  ON 72
ci_074                 5.145794e-04 3 1  ON 73
ci_075                -3.657389e-04 3 1  ON 74
ci_076                -3.484320e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4863e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.6901
    reference variance = 0.632528
====================================================
  Execution time = 5.1266e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0392e-01
  Total weights = 1.954746145e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490839680851
                                         uncertainty =       0.003168167550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490839680851
                                         uncertainty =       0.003168167550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495345475
  error estimate for blocks of size 2^( 2) =       0.000513674815
  error estimate for blocks of size 2^( 3) =       0.000530697836
  error estimate for blocks of size 2^( 4) =       0.000543184452
  error estimate for blocks of size 2^( 5) =       0.000551026505
  error estimate for blocks of size 2^( 6) =       0.000554612429
  error estimate for blocks of size 2^( 7) =       0.000557903410

      target function =      -0.609287606196
              le_mean =     -22.667664801750
             les_mean =     514.326952538186
             stat err =       0.000551681699
             autocorr =       1.240397136472
   target nu stat err =       0.000551681699
   target dn stat err =       0.004317324340
      target stat err =       0.001328860529
              std dev =       0.700524288459
             le_variance =       0.490734278721


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266766480175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609290228039       residual = 9.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609315658863       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609318466607       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609318717997       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609318763144       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609318787562       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609318793206       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609318794653       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609318795839       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609318795451       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 2.030754e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609290228039       residual = 9.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609296661211       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609297367683       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609297430510       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609297441657       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609297447683       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609297449055       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609297449403       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609297449695       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609297449599       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 5.139124e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609290228039       residual = 9.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609291841118       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609292018021       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609292033727       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609292036504       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609292038006       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609292038346       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609292038433       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609292038505       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609292038481       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 1.288731e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.665468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0632e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_001                -7.040881e-01 3 1  ON 0
ci_002                -7.023333e-01 3 1  ON 1
ci_003                -5.502512e-02 3 1  ON 2
ci_004                -5.547080e-02 3 1  ON 3
ci_005                 2.618527e-02 3 1  ON 4
ci_006                 2.619191e-02 3 1  ON 5
ci_007                 2.039344e-02 3 1  ON 6
ci_008                 2.082950e-02 3 1  ON 7
ci_009                -1.634561e-02 3 1  ON 8
ci_010                -1.605579e-02 3 1  ON 9
ci_011                -1.394661e-02 3 1  ON 10
ci_012                -1.368142e-02 3 1  ON 11
ci_013                 1.235715e-02 3 1  ON 12
ci_014                 1.223989e-02 3 1  ON 13
ci_015                 1.373719e-02 3 1  ON 14
ci_016                 1.351653e-02 3 1  ON 15
ci_017                 1.113698e-02 3 1  ON 16
ci_018                 1.125478e-02 3 1  ON 17
ci_019                 4.305048e-03 3 1  ON 18
ci_020                 4.580102e-03 3 1  ON 19
ci_021                -8.225984e-03 3 1  ON 20
ci_022                -8.434087e-03 3 1  ON 21
ci_023                 6.661993e-03 3 1  ON 22
ci_024                 6.649398e-03 3 1  ON 23
ci_025                 8.864357e-03 3 1  ON 24
ci_026                 8.758677e-03 3 1  ON 25
ci_027                 6.743628e-03 3 1  ON 26
ci_028                 6.847791e-03 3 1  ON 27
ci_029                -5.734795e-03 3 1  ON 28
ci_030                -5.717047e-03 3 1  ON 29
ci_031                -2.519410e-03 3 1  ON 30
ci_032                -2.832954e-03 3 1  ON 31
ci_033                 4.786150e-03 3 1  ON 32
ci_034                 4.666204e-03 3 1  ON 33
ci_035                 3.222415e-03 3 1  ON 34
ci_036                 3.377279e-03 3 1  ON 35
ci_037                 4.922262e-03 3 1  ON 36
ci_038                 4.779874e-03 3 1  ON 37
ci_039                 4.702398e-03 3 1  ON 38
ci_040                 4.761913e-03 3 1  ON 39
ci_041                 3.859460e-03 3 1  ON 40
ci_042                 3.808691e-03 3 1  ON 41
ci_043                 4.065488e-03 3 1  ON 42
ci_044                 4.068739e-03 3 1  ON 43
ci_045                 3.368318e-03 3 1  ON 44
ci_046                 3.469769e-03 3 1  ON 45
ci_047                -1.936904e-03 3 1  ON 46
ci_048                -2.043570e-03 3 1  ON 47
ci_049                 1.747404e-03 3 1  ON 48
ci_050                 1.722561e-03 3 1  ON 49
ci_051                -2.267976e-03 3 1  ON 50
ci_052                -2.112551e-03 3 1  ON 51
ci_053                -2.297182e-03 3 1  ON 52
ci_054                -2.450079e-03 3 1  ON 53
ci_055                -1.413096e-03 3 1  ON 54
ci_056                -1.574339e-03 3 1  ON 55
ci_057                -1.368382e-03 3 1  ON 56
ci_058                -1.462971e-03 3 1  ON 57
ci_059                -9.230731e-04 3 1  ON 58
ci_060                -8.804755e-04 3 1  ON 59
ci_061                -1.199096e-03 3 1  ON 60
ci_062                -7.878507e-04 3 1  ON 61
ci_063                -7.271996e-04 3 1  ON 62
ci_064                -8.615565e-04 3 1  ON 63
ci_065                -1.796079e-03 3 1  ON 64
ci_066                -2.052922e-03 3 1  ON 65
ci_067                -1.494907e-03 3 1  ON 66
ci_068                -1.076044e-03 3 1  ON 67
ci_069                 2.031722e-04 3 1  ON 68
ci_070                 2.263517e-04 3 1  ON 69
ci_071                -1.837341e-03 3 1  ON 70
ci_072                -1.766403e-03 3 1  ON 71
ci_073                 6.201424e-04 3 1  ON 72
ci_074                 5.143021e-04 3 1  ON 73
ci_075                -3.611507e-04 3 1  ON 74
ci_076                -3.451843e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.6931
    reference variance = 0.48927
====================================================
  Execution time = 4.9676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0068e-01
  Total weights = 1.9550e+06
  Execution time = 7.2345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488385320748
                                         uncertainty =       0.002982030600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488385320748
                                         uncertainty =       0.002982030600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494114540
  error estimate for blocks of size 2^( 2) =       0.000512603763
  error estimate for blocks of size 2^( 3) =       0.000529076917
  error estimate for blocks of size 2^( 4) =       0.000540263688
  error estimate for blocks of size 2^( 5) =       0.000547066036
  error estimate for blocks of size 2^( 6) =       0.000552409956
  error estimate for blocks of size 2^( 7) =       0.000557923308

      target function =      -0.610370179620
              le_mean =     -22.668086077466
             les_mean =     514.342815307758
             stat err =       0.000549415747
             autocorr =       1.236365667588
   target nu stat err =       0.000549415747
   target dn stat err =       0.003454780589
      target stat err =       0.001079667629
              std dev =       0.698783484442
             le_variance =       0.488298358129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488218886812
                                         uncertainty =       0.002981493336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488218886812
                                         uncertainty =       0.002981493336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494030318
  error estimate for blocks of size 2^( 2) =       0.000512518737
  error estimate for blocks of size 2^( 3) =       0.000528994375
  error estimate for blocks of size 2^( 4) =       0.000540180464
  error estimate for blocks of size 2^( 5) =       0.000546984961
  error estimate for blocks of size 2^( 6) =       0.000552327632
  error estimate for blocks of size 2^( 7) =       0.000557838237

      target function =      -0.609313973185
              le_mean =     -22.668084763805
             les_mean =     514.346246502920
             stat err =       0.000549332824
             autocorr =       1.236413946808
   target nu stat err =       0.000549332824
   target dn stat err =       0.005080658243
      target stat err =       0.001555092098
              std dev =       0.698664376171
             le_variance =       0.488131910530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488300493097
                                         uncertainty =       0.002981740652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488300493097
                                         uncertainty =       0.002981740652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494071616
  error estimate for blocks of size 2^( 2) =       0.000512560462
  error estimate for blocks of size 2^( 3) =       0.000529033736
  error estimate for blocks of size 2^( 4) =       0.000540220250
  error estimate for blocks of size 2^( 5) =       0.000547023346
  error estimate for blocks of size 2^( 6) =       0.000552366809
  error estimate for blocks of size 2^( 7) =       0.000557878282

      target function =      -0.610317890863
              le_mean =     -22.668085534079
             les_mean =     514.342963102470
             stat err =       0.000549372172
             autocorr =       1.236384363431
   target nu stat err =       0.000549372172
   target dn stat err =       0.003467816158
      target stat err =       0.001083297261
              std dev =       0.698722780292
             le_variance =       0.488213523699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488374617299
                                         uncertainty =       0.002981992782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488374617299
                                         uncertainty =       0.002981992782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494109125
  error estimate for blocks of size 2^( 2) =       0.000512598298
  error estimate for blocks of size 2^( 3) =       0.000529071483
  error estimate for blocks of size 2^( 4) =       0.000540258222
  error estimate for blocks of size 2^( 5) =       0.000547060667
  error estimate for blocks of size 2^( 6) =       0.000552404523
  error estimate for blocks of size 2^( 7) =       0.000557917647

      target function =      -0.610372424783
              le_mean =     -22.668085995692
             les_mean =     514.342804108497
             stat err =       0.000549410265
             autocorr =       1.236368097940
   target nu stat err =       0.000549410265
   target dn stat err =       0.003454952184
      target stat err =       0.001079724781
              std dev =       0.698775825180
             le_variance =       0.488287653856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610370179620        initial
     2.4414e+00     2.4414e+01             2.0308e-04        -0.609313973185
     9.7656e+00     9.7656e+01             5.1391e-05        -0.610317890863
     3.9062e+01     3.9062e+02             1.2887e-05        -0.610372424783  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 8.5905e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_001                -7.040772e-01 3 1  ON 0
ci_002                -7.023346e-01 3 1  ON 1
ci_003                -5.503862e-02 3 1  ON 2
ci_004                -5.548828e-02 3 1  ON 3
ci_005                 2.621776e-02 3 1  ON 4
ci_006                 2.623042e-02 3 1  ON 5
ci_007                 2.041697e-02 3 1  ON 6
ci_008                 2.084834e-02 3 1  ON 7
ci_009                -1.635598e-02 3 1  ON 8
ci_010                -1.606913e-02 3 1  ON 9
ci_011                -1.396358e-02 3 1  ON 10
ci_012                -1.369689e-02 3 1  ON 11
ci_013                 1.236986e-02 3 1  ON 12
ci_014                 1.225500e-02 3 1  ON 13
ci_015                 1.375543e-02 3 1  ON 14
ci_016                 1.352930e-02 3 1  ON 15
ci_017                 1.114302e-02 3 1  ON 16
ci_018                 1.126591e-02 3 1  ON 17
ci_019                 4.314175e-03 3 1  ON 18
ci_020                 4.596076e-03 3 1  ON 19
ci_021                -8.227199e-03 3 1  ON 20
ci_022                -8.438627e-03 3 1  ON 21
ci_023                 6.665503e-03 3 1  ON 22
ci_024                 6.652360e-03 3 1  ON 23
ci_025                 8.862209e-03 3 1  ON 24
ci_026                 8.751320e-03 3 1  ON 25
ci_027                 6.744345e-03 3 1  ON 26
ci_028                 6.850578e-03 3 1  ON 27
ci_029                -5.739874e-03 3 1  ON 28
ci_030                -5.724399e-03 3 1  ON 29
ci_031                -2.530690e-03 3 1  ON 30
ci_032                -2.850502e-03 3 1  ON 31
ci_033                 4.788636e-03 3 1  ON 32
ci_034                 4.671988e-03 3 1  ON 33
ci_035                 3.227995e-03 3 1  ON 34
ci_036                 3.382790e-03 3 1  ON 35
ci_037                 4.927230e-03 3 1  ON 36
ci_038                 4.789687e-03 3 1  ON 37
ci_039                 4.704786e-03 3 1  ON 38
ci_040                 4.763596e-03 3 1  ON 39
ci_041                 3.862446e-03 3 1  ON 40
ci_042                 3.807030e-03 3 1  ON 41
ci_043                 4.063493e-03 3 1  ON 42
ci_044                 4.071511e-03 3 1  ON 43
ci_045                 3.369261e-03 3 1  ON 44
ci_046                 3.475538e-03 3 1  ON 45
ci_047                -1.944255e-03 3 1  ON 46
ci_048                -2.049677e-03 3 1  ON 47
ci_049                 1.751244e-03 3 1  ON 48
ci_050                 1.724194e-03 3 1  ON 49
ci_051                -2.269624e-03 3 1  ON 50
ci_052                -2.110276e-03 3 1  ON 51
ci_053                -2.295705e-03 3 1  ON 52
ci_054                -2.450432e-03 3 1  ON 53
ci_055                -1.414565e-03 3 1  ON 54
ci_056                -1.574393e-03 3 1  ON 55
ci_057                -1.365584e-03 3 1  ON 56
ci_058                -1.463160e-03 3 1  ON 57
ci_059                -9.241005e-04 3 1  ON 58
ci_060                -8.835420e-04 3 1  ON 59
ci_061                -1.201469e-03 3 1  ON 60
ci_062                -7.866401e-04 3 1  ON 61
ci_063                -7.312454e-04 3 1  ON 62
ci_064                -8.633019e-04 3 1  ON 63
ci_065                -1.794465e-03 3 1  ON 64
ci_066                -2.051033e-03 3 1  ON 65
ci_067                -1.499488e-03 3 1  ON 66
ci_068                -1.076875e-03 3 1  ON 67
ci_069                 2.067377e-04 3 1  ON 68
ci_070                 2.272519e-04 3 1  ON 69
ci_071                -1.836995e-03 3 1  ON 70
ci_072                -1.762437e-03 3 1  ON 71
ci_073                 6.200633e-04 3 1  ON 72
ci_074                 5.145101e-04 3 1  ON 73
ci_075                -3.645888e-04 3 1  ON 74
ci_076                -3.476179e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4654e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.701
    reference variance = 0.39369
====================================================
  Execution time = 5.1220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0358e-01
  Total weights = 1.954946884e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488898311748
                                         uncertainty =       0.003147981466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488898311748
                                         uncertainty =       0.003147981466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494417559
  error estimate for blocks of size 2^( 2) =       0.000512848158
  error estimate for blocks of size 2^( 3) =       0.000529652778
  error estimate for blocks of size 2^( 4) =       0.000541314864
  error estimate for blocks of size 2^( 5) =       0.000549233912
  error estimate for blocks of size 2^( 6) =       0.000553788684
  error estimate for blocks of size 2^( 7) =       0.000553398065

      target function =      -0.609550208295
              le_mean =     -22.668305310373
             les_mean =     514.355647065307
             stat err =       0.000549433881
             autocorr =       1.234932161177
   target nu stat err =       0.000549433881
   target dn stat err =       0.004255992764
      target stat err =       0.001312340391
              std dev =       0.699212017950
             le_variance =       0.488897446046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266830531037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609552725221       residual = 9.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609558718630       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609559432606       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609559600926       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609559626098       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609559636421       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609559642456       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609559641644       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609559641896       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609559642026       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609559642028       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 4.829237e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609552725221       residual = 9.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609554228140       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609554406990       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609554449038       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609554455321       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609554457891       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609554459394       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609554459191       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609554459254       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609554459287       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609554459287       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 1.211051e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609552725221       residual = 9.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609553101238       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609553145972       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609553156482       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609553158052       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609553158694       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609553159070       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609553159019       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609553159034       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609553159042       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609553159043       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+02 is 3.029974e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.671444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0559e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_001                -7.040774e-01 3 1  ON 0
ci_002                -7.023377e-01 3 1  ON 1
ci_003                -5.503308e-02 3 1  ON 2
ci_004                -5.548210e-02 3 1  ON 3
ci_005                 2.620660e-02 3 1  ON 4
ci_006                 2.621831e-02 3 1  ON 5
ci_007                 2.041002e-02 3 1  ON 6
ci_008                 2.084284e-02 3 1  ON 7
ci_009                -1.634886e-02 3 1  ON 8
ci_010                -1.606406e-02 3 1  ON 9
ci_011                -1.395727e-02 3 1  ON 10
ci_012                -1.369250e-02 3 1  ON 11
ci_013                 1.236459e-02 3 1  ON 12
ci_014                 1.225042e-02 3 1  ON 13
ci_015                 1.375035e-02 3 1  ON 14
ci_016                 1.352469e-02 3 1  ON 15
ci_017                 1.114235e-02 3 1  ON 16
ci_018                 1.126374e-02 3 1  ON 17
ci_019                 4.309832e-03 3 1  ON 18
ci_020                 4.593052e-03 3 1  ON 19
ci_021                -8.226663e-03 3 1  ON 20
ci_022                -8.438255e-03 3 1  ON 21
ci_023                 6.663642e-03 3 1  ON 22
ci_024                 6.651649e-03 3 1  ON 23
ci_025                 8.861920e-03 3 1  ON 24
ci_026                 8.749590e-03 3 1  ON 25
ci_027                 6.745607e-03 3 1  ON 26
ci_028                 6.851471e-03 3 1  ON 27
ci_029                -5.738524e-03 3 1  ON 28
ci_030                -5.724450e-03 3 1  ON 29
ci_031                -2.525363e-03 3 1  ON 30
ci_032                -2.846576e-03 3 1  ON 31
ci_033                 4.786192e-03 3 1  ON 32
ci_034                 4.671004e-03 3 1  ON 33
ci_035                 3.226016e-03 3 1  ON 34
ci_036                 3.379617e-03 3 1  ON 35
ci_037                 4.924947e-03 3 1  ON 36
ci_038                 4.788276e-03 3 1  ON 37
ci_039                 4.705345e-03 3 1  ON 38
ci_040                 4.763113e-03 3 1  ON 39
ci_041                 3.860584e-03 3 1  ON 40
ci_042                 3.806121e-03 3 1  ON 41
ci_043                 4.062013e-03 3 1  ON 42
ci_044                 4.071550e-03 3 1  ON 43
ci_045                 3.366855e-03 3 1  ON 44
ci_046                 3.475081e-03 3 1  ON 45
ci_047                -1.942668e-03 3 1  ON 46
ci_048                -2.048248e-03 3 1  ON 47
ci_049                 1.750558e-03 3 1  ON 48
ci_050                 1.723779e-03 3 1  ON 49
ci_051                -2.268694e-03 3 1  ON 50
ci_052                -2.108632e-03 3 1  ON 51
ci_053                -2.295011e-03 3 1  ON 52
ci_054                -2.449214e-03 3 1  ON 53
ci_055                -1.413627e-03 3 1  ON 54
ci_056                -1.575584e-03 3 1  ON 55
ci_057                -1.366418e-03 3 1  ON 56
ci_058                -1.463074e-03 3 1  ON 57
ci_059                -9.236889e-04 3 1  ON 58
ci_060                -8.833624e-04 3 1  ON 59
ci_061                -1.199985e-03 3 1  ON 60
ci_062                -7.875796e-04 3 1  ON 61
ci_063                -7.324150e-04 3 1  ON 62
ci_064                -8.628311e-04 3 1  ON 63
ci_065                -1.794541e-03 3 1  ON 64
ci_066                -2.049300e-03 3 1  ON 65
ci_067                -1.499588e-03 3 1  ON 66
ci_068                -1.076968e-03 3 1  ON 67
ci_069                 2.066807e-04 3 1  ON 68
ci_070                 2.245454e-04 3 1  ON 69
ci_071                -1.835838e-03 3 1  ON 70
ci_072                -1.762583e-03 3 1  ON 71
ci_073                 6.204153e-04 3 1  ON 72
ci_074                 5.145055e-04 3 1  ON 73
ci_075                -3.655827e-04 3 1  ON 74
ci_076                -3.480887e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6544
    reference variance = 0.405926
====================================================
  Execution time = 5.0139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0355e-01
  Total weights = 1.9551e+06
  Execution time = 7.2414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489543647846
                                         uncertainty =       0.002756493744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489543647846
                                         uncertainty =       0.002756493744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494777285
  error estimate for blocks of size 2^( 2) =       0.000512653667
  error estimate for blocks of size 2^( 3) =       0.000529461536
  error estimate for blocks of size 2^( 4) =       0.000542201110
  error estimate for blocks of size 2^( 5) =       0.000549927251
  error estimate for blocks of size 2^( 6) =       0.000553127218
  error estimate for blocks of size 2^( 7) =       0.000555356219

      target function =      -0.609482266473
              le_mean =     -22.668016749290
             les_mean =     514.342554170643
             stat err =       0.000550152950
             autocorr =       1.236366943057
   target nu stat err =       0.000550152950
   target dn stat err =       0.003850940666
      target stat err =       0.001192614286
              std dev =       0.699720747016
             le_variance =       0.489609123805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489509923494
                                         uncertainty =       0.002756598819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489509923494
                                         uncertainty =       0.002756598819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494760238
  error estimate for blocks of size 2^( 2) =       0.000512636265
  error estimate for blocks of size 2^( 3) =       0.000529444116
  error estimate for blocks of size 2^( 4) =       0.000542183724
  error estimate for blocks of size 2^( 5) =       0.000549909964
  error estimate for blocks of size 2^( 6) =       0.000553109882
  error estimate for blocks of size 2^( 7) =       0.000555337730

      target function =      -0.609493287909
              le_mean =     -22.668016673114
             les_mean =     514.342514059510
             stat err =       0.000550135325
             autocorr =       1.236372924424
   target nu stat err =       0.000550135325
   target dn stat err =       0.003862150638
      target stat err =       0.001195945489
              std dev =       0.699696638517
             le_variance =       0.489575385952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489526692986
                                         uncertainty =       0.002756544027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489526692986
                                         uncertainty =       0.002756544027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494768715
  error estimate for blocks of size 2^( 2) =       0.000512644919
  error estimate for blocks of size 2^( 3) =       0.000529452780
  error estimate for blocks of size 2^( 4) =       0.000542192372
  error estimate for blocks of size 2^( 5) =       0.000549918563
  error estimate for blocks of size 2^( 6) =       0.000553118503
  error estimate for blocks of size 2^( 7) =       0.000555346934

      target function =      -0.609492972366
              le_mean =     -22.668016706079
             les_mean =     514.342516650073
             stat err =       0.000550144093
             autocorr =       1.236369968032
   target nu stat err =       0.000550144093
   target dn stat err =       0.003856234448
      target stat err =       0.001194208245
              std dev =       0.699708626646
             le_variance =       0.489592162203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489541521991
                                         uncertainty =       0.002756499760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489541521991
                                         uncertainty =       0.002756499760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494776211
  error estimate for blocks of size 2^( 2) =       0.000512652570
  error estimate for blocks of size 2^( 3) =       0.000529460438
  error estimate for blocks of size 2^( 4) =       0.000542200015
  error estimate for blocks of size 2^( 5) =       0.000549926163
  error estimate for blocks of size 2^( 6) =       0.000553126126
  error estimate for blocks of size 2^( 7) =       0.000555355056

      target function =      -0.609484548866
              le_mean =     -22.668016743265
             les_mean =     514.342546320631
             stat err =       0.000550151840
             autocorr =       1.236367325769
   target nu stat err =       0.000550151840
   target dn stat err =       0.003851539938
      target stat err =       0.001192798783
              std dev =       0.699719227340
             le_variance =       0.489606997110


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609482266473        initial
     9.7656e+00     9.7656e+01             4.8292e-05        -0.609493287909  <--
     3.9062e+01     3.9062e+02             1.2111e-05        -0.609492972366
     1.5625e+02     1.5625e+03             3.0300e-06        -0.609484548866

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 8.6530e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_001                -7.040780e-01 3 1  ON 0
ci_002                -7.023470e-01 3 1  ON 1
ci_003                -5.501648e-02 3 1  ON 2
ci_004                -5.546358e-02 3 1  ON 3
ci_005                 2.617324e-02 3 1  ON 4
ci_006                 2.618213e-02 3 1  ON 5
ci_007                 2.038924e-02 3 1  ON 6
ci_008                 2.082640e-02 3 1  ON 7
ci_009                -1.632757e-02 3 1  ON 8
ci_010                -1.604894e-02 3 1  ON 9
ci_011                -1.393841e-02 3 1  ON 10
ci_012                -1.367936e-02 3 1  ON 11
ci_013                 1.234886e-02 3 1  ON 12
ci_014                 1.223673e-02 3 1  ON 13
ci_015                 1.373513e-02 3 1  ON 14
ci_016                 1.351088e-02 3 1  ON 15
ci_017                 1.114033e-02 3 1  ON 16
ci_018                 1.125725e-02 3 1  ON 17
ci_019                 4.296840e-03 3 1  ON 18
ci_020                 4.584007e-03 3 1  ON 19
ci_021                -8.225063e-03 3 1  ON 20
ci_022                -8.437144e-03 3 1  ON 21
ci_023                 6.658076e-03 3 1  ON 22
ci_024                 6.649525e-03 3 1  ON 23
ci_025                 8.861055e-03 3 1  ON 24
ci_026                 8.744419e-03 3 1  ON 25
ci_027                 6.749379e-03 3 1  ON 26
ci_028                 6.854140e-03 3 1  ON 27
ci_029                -5.734485e-03 3 1  ON 28
ci_030                -5.724605e-03 3 1  ON 29
ci_031                -2.509435e-03 3 1  ON 30
ci_032                -2.834836e-03 3 1  ON 31
ci_033                 4.778885e-03 3 1  ON 32
ci_034                 4.668060e-03 3 1  ON 33
ci_035                 3.220100e-03 3 1  ON 34
ci_036                 3.370140e-03 3 1  ON 35
ci_037                 4.918118e-03 3 1  ON 36
ci_038                 4.784057e-03 3 1  ON 37
ci_039                 4.707014e-03 3 1  ON 38
ci_040                 4.761670e-03 3 1  ON 39
ci_041                 3.855021e-03 3 1  ON 40
ci_042                 3.803407e-03 3 1  ON 41
ci_043                 4.057588e-03 3 1  ON 42
ci_044                 4.071664e-03 3 1  ON 43
ci_045                 3.359662e-03 3 1  ON 44
ci_046                 3.473716e-03 3 1  ON 45
ci_047                -1.937922e-03 3 1  ON 46
ci_048                -2.043975e-03 3 1  ON 47
ci_049                 1.748509e-03 3 1  ON 48
ci_050                 1.722537e-03 3 1  ON 49
ci_051                -2.265912e-03 3 1  ON 50
ci_052                -2.103714e-03 3 1  ON 51
ci_053                -2.292943e-03 3 1  ON 52
ci_054                -2.445580e-03 3 1  ON 53
ci_055                -1.410823e-03 3 1  ON 54
ci_056                -1.579145e-03 3 1  ON 55
ci_057                -1.368911e-03 3 1  ON 56
ci_058                -1.462819e-03 3 1  ON 57
ci_059                -9.224581e-04 3 1  ON 58
ci_060                -8.828237e-04 3 1  ON 59
ci_061                -1.195549e-03 3 1  ON 60
ci_062                -7.903868e-04 3 1  ON 61
ci_063                -7.359135e-04 3 1  ON 62
ci_064                -8.614252e-04 3 1  ON 63
ci_065                -1.794765e-03 3 1  ON 64
ci_066                -2.044118e-03 3 1  ON 65
ci_067                -1.499887e-03 3 1  ON 66
ci_068                -1.077243e-03 3 1  ON 67
ci_069                 2.065094e-04 3 1  ON 68
ci_070                 2.164613e-04 3 1  ON 69
ci_071                -1.832379e-03 3 1  ON 70
ci_072                -1.763017e-03 3 1  ON 71
ci_073                 6.214677e-04 3 1  ON 72
ci_074                 5.144865e-04 3 1  ON 73
ci_075                -3.685526e-04 3 1  ON 74
ci_076                -3.494917e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4710e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.5548
    reference variance = 1.00654
====================================================
  Execution time = 5.1227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1016e-01
  Total weights = 1.955152012e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495207110037
                                         uncertainty =       0.003130141183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495207110037
                                         uncertainty =       0.003130141183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497735186
  error estimate for blocks of size 2^( 2) =       0.000516333992
  error estimate for blocks of size 2^( 3) =       0.000532798010
  error estimate for blocks of size 2^( 4) =       0.000544850534
  error estimate for blocks of size 2^( 5) =       0.000552046507
  error estimate for blocks of size 2^( 6) =       0.000554410875
  error estimate for blocks of size 2^( 7) =       0.000555418648

      target function =      -0.607521982255
              le_mean =     -22.668101324233
             les_mean =     514.352978517824
             stat err =       0.000551681641
             autocorr =       1.228514753312
   target nu stat err =       0.000551681641
   target dn stat err =       0.004216155438
      target stat err =       0.001292153114
              std dev =       0.703903851098
             le_variance =       0.495480631590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266810132423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607524422837       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607548271077       residual = 7.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607551008292       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607551215124       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607551219317       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607551250978       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607551254976       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607551258332       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607551258801       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607551258029       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 1.741058e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607524422837       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607530454125       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607531142372       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607531194084       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607531195043       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607531202908       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607531203876       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607531204697       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607531204807       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607531204617       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 4.405959e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607524422837       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607525935048       residual = 7.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607526107357       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607526120285       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607526120519       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607526122482       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607526122722       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607526122927       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607526122954       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607526122906       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 1.104873e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.676538 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0563e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_001                -7.040780e-01 3 1  ON 0
ci_002                -7.023592e-01 3 1  ON 1
ci_003                -5.500575e-02 3 1  ON 2
ci_004                -5.544280e-02 3 1  ON 3
ci_005                 2.613149e-02 3 1  ON 4
ci_006                 2.613807e-02 3 1  ON 5
ci_007                 2.035515e-02 3 1  ON 6
ci_008                 2.080106e-02 3 1  ON 7
ci_009                -1.630658e-02 3 1  ON 8
ci_010                -1.602802e-02 3 1  ON 9
ci_011                -1.391192e-02 3 1  ON 10
ci_012                -1.365946e-02 3 1  ON 11
ci_013                 1.233196e-02 3 1  ON 12
ci_014                 1.221851e-02 3 1  ON 13
ci_015                 1.371073e-02 3 1  ON 14
ci_016                 1.348558e-02 3 1  ON 15
ci_017                 1.112522e-02 3 1  ON 16
ci_018                 1.124392e-02 3 1  ON 17
ci_019                 4.265256e-03 3 1  ON 18
ci_020                 4.564025e-03 3 1  ON 19
ci_021                -8.229509e-03 3 1  ON 20
ci_022                -8.434391e-03 3 1  ON 21
ci_023                 6.643801e-03 3 1  ON 22
ci_024                 6.649459e-03 3 1  ON 23
ci_025                 8.868301e-03 3 1  ON 24
ci_026                 8.749030e-03 3 1  ON 25
ci_027                 6.751317e-03 3 1  ON 26
ci_028                 6.849169e-03 3 1  ON 27
ci_029                -5.732197e-03 3 1  ON 28
ci_030                -5.719947e-03 3 1  ON 29
ci_031                -2.492433e-03 3 1  ON 30
ci_032                -2.821707e-03 3 1  ON 31
ci_033                 4.772648e-03 3 1  ON 32
ci_034                 4.667077e-03 3 1  ON 33
ci_035                 3.214259e-03 3 1  ON 34
ci_036                 3.360477e-03 3 1  ON 35
ci_037                 4.914039e-03 3 1  ON 36
ci_038                 4.781197e-03 3 1  ON 37
ci_039                 4.707859e-03 3 1  ON 38
ci_040                 4.762590e-03 3 1  ON 39
ci_041                 3.849473e-03 3 1  ON 40
ci_042                 3.796906e-03 3 1  ON 41
ci_043                 4.056530e-03 3 1  ON 42
ci_044                 4.067577e-03 3 1  ON 43
ci_045                 3.358749e-03 3 1  ON 44
ci_046                 3.472681e-03 3 1  ON 45
ci_047                -1.934238e-03 3 1  ON 46
ci_048                -2.039904e-03 3 1  ON 47
ci_049                 1.751104e-03 3 1  ON 48
ci_050                 1.717526e-03 3 1  ON 49
ci_051                -2.264784e-03 3 1  ON 50
ci_052                -2.104374e-03 3 1  ON 51
ci_053                -2.297910e-03 3 1  ON 52
ci_054                -2.442746e-03 3 1  ON 53
ci_055                -1.406804e-03 3 1  ON 54
ci_056                -1.571729e-03 3 1  ON 55
ci_057                -1.368848e-03 3 1  ON 56
ci_058                -1.462738e-03 3 1  ON 57
ci_059                -9.257422e-04 3 1  ON 58
ci_060                -8.793755e-04 3 1  ON 59
ci_061                -1.194862e-03 3 1  ON 60
ci_062                -7.874517e-04 3 1  ON 61
ci_063                -7.392985e-04 3 1  ON 62
ci_064                -8.579213e-04 3 1  ON 63
ci_065                -1.798842e-03 3 1  ON 64
ci_066                -2.046177e-03 3 1  ON 65
ci_067                -1.500916e-03 3 1  ON 66
ci_068                -1.071778e-03 3 1  ON 67
ci_069                 2.039179e-04 3 1  ON 68
ci_070                 2.098983e-04 3 1  ON 69
ci_071                -1.833791e-03 3 1  ON 70
ci_072                -1.762056e-03 3 1  ON 71
ci_073                 6.188428e-04 3 1  ON 72
ci_074                 5.151554e-04 3 1  ON 73
ci_075                -3.645270e-04 3 1  ON 74
ci_076                -3.492037e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.7769
    reference variance = 0.395769
====================================================
  Execution time = 4.9832e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0828e-01
  Total weights = 1.9546e+06
  Execution time = 7.2208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491915551593
                                         uncertainty =       0.002739471892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491915551593
                                         uncertainty =       0.002739471892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495935360
  error estimate for blocks of size 2^( 2) =       0.000513937899
  error estimate for blocks of size 2^( 3) =       0.000531372296
  error estimate for blocks of size 2^( 4) =       0.000543337428
  error estimate for blocks of size 2^( 5) =       0.000550744913
  error estimate for blocks of size 2^( 6) =       0.000553202251
  error estimate for blocks of size 2^( 7) =       0.000558285005

      target function =      -0.607617131463
              le_mean =     -22.668857048854
             les_mean =     514.387538517418
             stat err =       0.000551392399
             autocorr =       1.236150651826
   target nu stat err =       0.000551392399
   target dn stat err =       0.004732556978
      target stat err =       0.001445074876
              std dev =       0.701358511693
             le_variance =       0.491903761925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491765634726
                                         uncertainty =       0.002738988440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491765634726
                                         uncertainty =       0.002738988440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495859836
  error estimate for blocks of size 2^( 2) =       0.000513861108
  error estimate for blocks of size 2^( 3) =       0.000531293685
  error estimate for blocks of size 2^( 4) =       0.000543256434
  error estimate for blocks of size 2^( 5) =       0.000550663691
  error estimate for blocks of size 2^( 6) =       0.000553118228
  error estimate for blocks of size 2^( 7) =       0.000558199189

      target function =      -0.608244370768
              le_mean =     -22.668856217256
             les_mean =     514.385412873927
             stat err =       0.000551309385
             autocorr =       1.236154933514
   target nu stat err =       0.000551309385
   target dn stat err =       0.004237052670
      target stat err =       0.001302055383
              std dev =       0.701251705347
             le_variance =       0.491753954252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491839044215
                                         uncertainty =       0.002739221401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491839044215
                                         uncertainty =       0.002739221401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495896819
  error estimate for blocks of size 2^( 2) =       0.000513898713
  error estimate for blocks of size 2^( 3) =       0.000531332200
  error estimate for blocks of size 2^( 4) =       0.000543296112
  error estimate for blocks of size 2^( 5) =       0.000550703547
  error estimate for blocks of size 2^( 6) =       0.000553159414
  error estimate for blocks of size 2^( 7) =       0.000558241428

      target function =      -0.608279848186
              le_mean =     -22.668856597952
             les_mean =     514.385312487629
             stat err =       0.000551350125
             autocorr =       1.236153236371
   target nu stat err =       0.000551350125
   target dn stat err =       0.004214032533
      target stat err =       0.001295443955
              std dev =       0.701304006974
             le_variance =       0.491827310198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491905879743
                                         uncertainty =       0.002739439622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491905879743
                                         uncertainty =       0.002739439622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495930488
  error estimate for blocks of size 2^( 2) =       0.000513932939
  error estimate for blocks of size 2^( 3) =       0.000531367271
  error estimate for blocks of size 2^( 4) =       0.000543332242
  error estimate for blocks of size 2^( 5) =       0.000550739882
  error estimate for blocks of size 2^( 6) =       0.000553196892
  error estimate for blocks of size 2^( 7) =       0.000558280053

      target function =      -0.607859754732
              le_mean =     -22.668857082481
             les_mean =     514.386732727162
             stat err =       0.000551387267
             autocorr =       1.236151927942
   target nu stat err =       0.000551387267
   target dn stat err =       0.004423941417
      target stat err =       0.001355352488
              std dev =       0.701351621582
             le_variance =       0.491894097096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607617131463        initial
     2.4414e+00     2.4414e+01             1.7411e-04        -0.608244370768
     9.7656e+00     9.7656e+01             4.4060e-05        -0.608279848186  <--
     3.9062e+01     3.9062e+02             1.1049e-05        -0.607859754732

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 8.6068e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_001                -7.040780e-01 3 1  ON 0
ci_002                -7.023592e-01 3 1  ON 1
ci_003                -5.500575e-02 3 1  ON 2
ci_004                -5.544280e-02 3 1  ON 3
ci_005                 2.613149e-02 3 1  ON 4
ci_006                 2.613807e-02 3 1  ON 5
ci_007                 2.035515e-02 3 1  ON 6
ci_008                 2.080106e-02 3 1  ON 7
ci_009                -1.630658e-02 3 1  ON 8
ci_010                -1.602802e-02 3 1  ON 9
ci_011                -1.391192e-02 3 1  ON 10
ci_012                -1.365946e-02 3 1  ON 11
ci_013                 1.233196e-02 3 1  ON 12
ci_014                 1.221851e-02 3 1  ON 13
ci_015                 1.371073e-02 3 1  ON 14
ci_016                 1.348558e-02 3 1  ON 15
ci_017                 1.112522e-02 3 1  ON 16
ci_018                 1.124392e-02 3 1  ON 17
ci_019                 4.265256e-03 3 1  ON 18
ci_020                 4.564025e-03 3 1  ON 19
ci_021                -8.229509e-03 3 1  ON 20
ci_022                -8.434391e-03 3 1  ON 21
ci_023                 6.643801e-03 3 1  ON 22
ci_024                 6.649459e-03 3 1  ON 23
ci_025                 8.868301e-03 3 1  ON 24
ci_026                 8.749030e-03 3 1  ON 25
ci_027                 6.751317e-03 3 1  ON 26
ci_028                 6.849169e-03 3 1  ON 27
ci_029                -5.732197e-03 3 1  ON 28
ci_030                -5.719947e-03 3 1  ON 29
ci_031                -2.492433e-03 3 1  ON 30
ci_032                -2.821707e-03 3 1  ON 31
ci_033                 4.772648e-03 3 1  ON 32
ci_034                 4.667077e-03 3 1  ON 33
ci_035                 3.214259e-03 3 1  ON 34
ci_036                 3.360477e-03 3 1  ON 35
ci_037                 4.914039e-03 3 1  ON 36
ci_038                 4.781197e-03 3 1  ON 37
ci_039                 4.707859e-03 3 1  ON 38
ci_040                 4.762590e-03 3 1  ON 39
ci_041                 3.849473e-03 3 1  ON 40
ci_042                 3.796906e-03 3 1  ON 41
ci_043                 4.056530e-03 3 1  ON 42
ci_044                 4.067577e-03 3 1  ON 43
ci_045                 3.358749e-03 3 1  ON 44
ci_046                 3.472681e-03 3 1  ON 45
ci_047                -1.934238e-03 3 1  ON 46
ci_048                -2.039904e-03 3 1  ON 47
ci_049                 1.751104e-03 3 1  ON 48
ci_050                 1.717526e-03 3 1  ON 49
ci_051                -2.264784e-03 3 1  ON 50
ci_052                -2.104374e-03 3 1  ON 51
ci_053                -2.297910e-03 3 1  ON 52
ci_054                -2.442746e-03 3 1  ON 53
ci_055                -1.406804e-03 3 1  ON 54
ci_056                -1.571729e-03 3 1  ON 55
ci_057                -1.368848e-03 3 1  ON 56
ci_058                -1.462738e-03 3 1  ON 57
ci_059                -9.257422e-04 3 1  ON 58
ci_060                -8.793755e-04 3 1  ON 59
ci_061                -1.194862e-03 3 1  ON 60
ci_062                -7.874517e-04 3 1  ON 61
ci_063                -7.392985e-04 3 1  ON 62
ci_064                -8.579213e-04 3 1  ON 63
ci_065                -1.798842e-03 3 1  ON 64
ci_066                -2.046177e-03 3 1  ON 65
ci_067                -1.500916e-03 3 1  ON 66
ci_068                -1.071778e-03 3 1  ON 67
ci_069                 2.039179e-04 3 1  ON 68
ci_070                 2.098983e-04 3 1  ON 69
ci_071                -1.833791e-03 3 1  ON 70
ci_072                -1.762056e-03 3 1  ON 71
ci_073                 6.188428e-04 3 1  ON 72
ci_074                 5.151554e-04 3 1  ON 73
ci_075                -3.645270e-04 3 1  ON 74
ci_076                -3.492037e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4664e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6409
    reference variance = 0.463948
====================================================
  Execution time = 5.1155e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0105e-01
  Total weights = 1.955143853e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489303981822
                                         uncertainty =       0.002784421375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489303981822
                                         uncertainty =       0.002784421375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494585419
  error estimate for blocks of size 2^( 2) =       0.000512975585
  error estimate for blocks of size 2^( 3) =       0.000529829473
  error estimate for blocks of size 2^( 4) =       0.000542260303
  error estimate for blocks of size 2^( 5) =       0.000549599171
  error estimate for blocks of size 2^( 6) =       0.000553339910
  error estimate for blocks of size 2^( 7) =       0.000558748020

      target function =      -0.610108453491
              le_mean =     -22.667478469009
             les_mean =     514.315632125907
             stat err =       0.000550986851
             autocorr =       1.241080212512
   target nu stat err =       0.000550986851
   target dn stat err =       0.003820230446
      target stat err =       0.001185546606
              std dev =       0.699449407990
             le_variance =       0.489229474338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266747846901e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610110450365       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610133474773       residual = 6.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610135818105       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610136095068       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610136176869       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610136191943       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610136198343       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610136199585       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610136201071       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610136200984       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 1.780907e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610110450365       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610116274598       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610116864094       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610116933432       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610116953729       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610116957402       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610116958973       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610116959279       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610116959643       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610116959619       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 4.506764e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610110450365       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610111910744       residual = 6.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610112058348       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610112075689       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610112080753       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610112081665       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610112082056       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610112082133       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610112082223       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610112082217       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 1.130149e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.681709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0486e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_001                -7.040807e-01 3 1  ON 0
ci_002                -7.023696e-01 3 1  ON 1
ci_003                -5.498687e-02 3 1  ON 2
ci_004                -5.541721e-02 3 1  ON 3
ci_005                 2.608642e-02 3 1  ON 4
ci_006                 2.609520e-02 3 1  ON 5
ci_007                 2.032339e-02 3 1  ON 6
ci_008                 2.077301e-02 3 1  ON 7
ci_009                -1.628094e-02 3 1  ON 8
ci_010                -1.600983e-02 3 1  ON 9
ci_011                -1.389123e-02 3 1  ON 10
ci_012                -1.364234e-02 3 1  ON 11
ci_013                 1.231258e-02 3 1  ON 12
ci_014                 1.220061e-02 3 1  ON 13
ci_015                 1.368864e-02 3 1  ON 14
ci_016                 1.346651e-02 3 1  ON 15
ci_017                 1.111600e-02 3 1  ON 16
ci_018                 1.123451e-02 3 1  ON 17
ci_019                 4.254701e-03 3 1  ON 18
ci_020                 4.548300e-03 3 1  ON 19
ci_021                -8.227212e-03 3 1  ON 20
ci_022                -8.428899e-03 3 1  ON 21
ci_023                 6.637350e-03 3 1  ON 22
ci_024                 6.642906e-03 3 1  ON 23
ci_025                 8.860329e-03 3 1  ON 24
ci_026                 8.751906e-03 3 1  ON 25
ci_027                 6.751184e-03 3 1  ON 26
ci_028                 6.847147e-03 3 1  ON 27
ci_029                -5.720580e-03 3 1  ON 28
ci_030                -5.716512e-03 3 1  ON 29
ci_031                -2.488767e-03 3 1  ON 30
ci_032                -2.813473e-03 3 1  ON 31
ci_033                 4.764499e-03 3 1  ON 32
ci_034                 4.654754e-03 3 1  ON 33
ci_035                 3.206748e-03 3 1  ON 34
ci_036                 3.353693e-03 3 1  ON 35
ci_037                 4.912275e-03 3 1  ON 36
ci_038                 4.779033e-03 3 1  ON 37
ci_039                 4.709530e-03 3 1  ON 38
ci_040                 4.763273e-03 3 1  ON 39
ci_041                 3.842948e-03 3 1  ON 40
ci_042                 3.794443e-03 3 1  ON 41
ci_043                 4.052057e-03 3 1  ON 42
ci_044                 4.064735e-03 3 1  ON 43
ci_045                 3.352004e-03 3 1  ON 44
ci_046                 3.472707e-03 3 1  ON 45
ci_047                -1.927747e-03 3 1  ON 46
ci_048                -2.028439e-03 3 1  ON 47
ci_049                 1.746337e-03 3 1  ON 48
ci_050                 1.714872e-03 3 1  ON 49
ci_051                -2.259791e-03 3 1  ON 50
ci_052                -2.103819e-03 3 1  ON 51
ci_053                -2.298916e-03 3 1  ON 52
ci_054                -2.439433e-03 3 1  ON 53
ci_055                -1.402306e-03 3 1  ON 54
ci_056                -1.574414e-03 3 1  ON 55
ci_057                -1.369031e-03 3 1  ON 56
ci_058                -1.457972e-03 3 1  ON 57
ci_059                -9.251202e-04 3 1  ON 58
ci_060                -8.802486e-04 3 1  ON 59
ci_061                -1.190784e-03 3 1  ON 60
ci_062                -7.862422e-04 3 1  ON 61
ci_063                -7.430471e-04 3 1  ON 62
ci_064                -8.614361e-04 3 1  ON 63
ci_065                -1.800666e-03 3 1  ON 64
ci_066                -2.042368e-03 3 1  ON 65
ci_067                -1.498164e-03 3 1  ON 66
ci_068                -1.079446e-03 3 1  ON 67
ci_069                 2.052191e-04 3 1  ON 68
ci_070                 2.072010e-04 3 1  ON 69
ci_071                -1.831330e-03 3 1  ON 70
ci_072                -1.763623e-03 3 1  ON 71
ci_073                 6.142344e-04 3 1  ON 72
ci_074                 5.098078e-04 3 1  ON 73
ci_075                -3.608111e-04 3 1  ON 74
ci_076                -3.506178e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.5747
    reference variance = 0.609579
====================================================
  Execution time = 5.0456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 4.9719e-01
  Total weights = 1.9550e+06
  Execution time = 7.2253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485865372184
                                         uncertainty =       0.002131112548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485865372184
                                         uncertainty =       0.002131112548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492939903
  error estimate for blocks of size 2^( 2) =       0.000512064281
  error estimate for blocks of size 2^( 3) =       0.000528461454
  error estimate for blocks of size 2^( 4) =       0.000539970915
  error estimate for blocks of size 2^( 5) =       0.000549276166
  error estimate for blocks of size 2^( 6) =       0.000553873028
  error estimate for blocks of size 2^( 7) =       0.000555514578

      target function =      -0.611194658078
              le_mean =     -22.667131797262
             les_mean =     514.296041259220
             stat err =       0.000549658672
             autocorr =       1.243363795254
   target nu stat err =       0.000549658672
   target dn stat err =       0.002892302691
      target stat err =       0.000917755472
              std dev =       0.697122296332
             le_variance =       0.485979496043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485742791516
                                         uncertainty =       0.002134871012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485742791516
                                         uncertainty =       0.002134871012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492877436
  error estimate for blocks of size 2^( 2) =       0.000512000450
  error estimate for blocks of size 2^( 3) =       0.000528395680
  error estimate for blocks of size 2^( 4) =       0.000539903967
  error estimate for blocks of size 2^( 5) =       0.000549208067
  error estimate for blocks of size 2^( 6) =       0.000553804046
  error estimate for blocks of size 2^( 7) =       0.000555442691

      target function =      -0.611152113066
              le_mean =     -22.667132263013
             les_mean =     514.296202874655
             stat err =       0.000549589693
             autocorr =       1.243366852376
   target nu stat err =       0.000549589693
   target dn stat err =       0.002997697051
      target stat err =       0.000948161408
              std dev =       0.697033954740
             le_variance =       0.485856334060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485802754221
                                         uncertainty =       0.002132969698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485802754221
                                         uncertainty =       0.002132969698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492907993
  error estimate for blocks of size 2^( 2) =       0.000512031672
  error estimate for blocks of size 2^( 3) =       0.000528427869
  error estimate for blocks of size 2^( 4) =       0.000539936740
  error estimate for blocks of size 2^( 5) =       0.000549241415
  error estimate for blocks of size 2^( 6) =       0.000553837859
  error estimate for blocks of size 2^( 7) =       0.000555477924

      target function =      -0.611181929351
              le_mean =     -22.667131949703
             les_mean =     514.296090175843
             stat err =       0.000549623485
             autocorr =       1.243365581306
   target nu stat err =       0.000549623485
   target dn stat err =       0.002937415804
      target stat err =       0.000930775145
              std dev =       0.697077168494
             le_variance =       0.485916578836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485857451985
                                         uncertainty =       0.002131340815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485857451985
                                         uncertainty =       0.002131340815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492935867
  error estimate for blocks of size 2^( 2) =       0.000512060156
  error estimate for blocks of size 2^( 3) =       0.000528457208
  error estimate for blocks of size 2^( 4) =       0.000539966596
  error estimate for blocks of size 2^( 5) =       0.000549271775
  error estimate for blocks of size 2^( 6) =       0.000553868585
  error estimate for blocks of size 2^( 7) =       0.000555509949

      target function =      -0.611193735122
              le_mean =     -22.667131806382
             les_mean =     514.296044712120
             stat err =       0.000549654226
             autocorr =       1.243364044567
   target nu stat err =       0.000549654226
   target dn stat err =       0.002897226106
      target stat err =       0.000919176808
              std dev =       0.697116588311
             le_variance =       0.485971537698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611194658078        initial  <--
     2.4414e+00     2.4414e+01             1.7809e-04        -0.611152113066
     9.7656e+00     9.7656e+01             4.5068e-05        -0.611181929351
     3.9062e+01     3.9062e+02             1.1301e-05        -0.611193735122

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 86.7008
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_001                -7.040780e-01 3 1  ON 0
ci_002                -7.023592e-01 3 1  ON 1
ci_003                -5.500575e-02 3 1  ON 2
ci_004                -5.544280e-02 3 1  ON 3
ci_005                 2.613149e-02 3 1  ON 4
ci_006                 2.613807e-02 3 1  ON 5
ci_007                 2.035515e-02 3 1  ON 6
ci_008                 2.080106e-02 3 1  ON 7
ci_009                -1.630658e-02 3 1  ON 8
ci_010                -1.602802e-02 3 1  ON 9
ci_011                -1.391192e-02 3 1  ON 10
ci_012                -1.365946e-02 3 1  ON 11
ci_013                 1.233196e-02 3 1  ON 12
ci_014                 1.221851e-02 3 1  ON 13
ci_015                 1.371073e-02 3 1  ON 14
ci_016                 1.348558e-02 3 1  ON 15
ci_017                 1.112522e-02 3 1  ON 16
ci_018                 1.124392e-02 3 1  ON 17
ci_019                 4.265256e-03 3 1  ON 18
ci_020                 4.564025e-03 3 1  ON 19
ci_021                -8.229509e-03 3 1  ON 20
ci_022                -8.434391e-03 3 1  ON 21
ci_023                 6.643801e-03 3 1  ON 22
ci_024                 6.649459e-03 3 1  ON 23
ci_025                 8.868301e-03 3 1  ON 24
ci_026                 8.749030e-03 3 1  ON 25
ci_027                 6.751317e-03 3 1  ON 26
ci_028                 6.849169e-03 3 1  ON 27
ci_029                -5.732197e-03 3 1  ON 28
ci_030                -5.719947e-03 3 1  ON 29
ci_031                -2.492433e-03 3 1  ON 30
ci_032                -2.821707e-03 3 1  ON 31
ci_033                 4.772648e-03 3 1  ON 32
ci_034                 4.667077e-03 3 1  ON 33
ci_035                 3.214259e-03 3 1  ON 34
ci_036                 3.360477e-03 3 1  ON 35
ci_037                 4.914039e-03 3 1  ON 36
ci_038                 4.781197e-03 3 1  ON 37
ci_039                 4.707859e-03 3 1  ON 38
ci_040                 4.762590e-03 3 1  ON 39
ci_041                 3.849473e-03 3 1  ON 40
ci_042                 3.796906e-03 3 1  ON 41
ci_043                 4.056530e-03 3 1  ON 42
ci_044                 4.067577e-03 3 1  ON 43
ci_045                 3.358749e-03 3 1  ON 44
ci_046                 3.472681e-03 3 1  ON 45
ci_047                -1.934238e-03 3 1  ON 46
ci_048                -2.039904e-03 3 1  ON 47
ci_049                 1.751104e-03 3 1  ON 48
ci_050                 1.717526e-03 3 1  ON 49
ci_051                -2.264784e-03 3 1  ON 50
ci_052                -2.104374e-03 3 1  ON 51
ci_053                -2.297910e-03 3 1  ON 52
ci_054                -2.442746e-03 3 1  ON 53
ci_055                -1.406804e-03 3 1  ON 54
ci_056                -1.571729e-03 3 1  ON 55
ci_057                -1.368848e-03 3 1  ON 56
ci_058                -1.462738e-03 3 1  ON 57
ci_059                -9.257422e-04 3 1  ON 58
ci_060                -8.793755e-04 3 1  ON 59
ci_061                -1.194862e-03 3 1  ON 60
ci_062                -7.874517e-04 3 1  ON 61
ci_063                -7.392985e-04 3 1  ON 62
ci_064                -8.579213e-04 3 1  ON 63
ci_065                -1.798842e-03 3 1  ON 64
ci_066                -2.046177e-03 3 1  ON 65
ci_067                -1.500916e-03 3 1  ON 66
ci_068                -1.071778e-03 3 1  ON 67
ci_069                 2.039179e-04 3 1  ON 68
ci_070                 2.098983e-04 3 1  ON 69
ci_071                -1.833791e-03 3 1  ON 70
ci_072                -1.762056e-03 3 1  ON 71
ci_073                 6.188428e-04 3 1  ON 72
ci_074                 5.151554e-04 3 1  ON 73
ci_075                -3.645270e-04 3 1  ON 74
ci_076                -3.492037e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4719e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2680e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.6413
    reference variance = 0.459246
====================================================
  Execution time = 5.1196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9704e-01
  Total weights = 1.954660392e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483654500697
                                         uncertainty =       0.001815787267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483654500697
                                         uncertainty =       0.001815787267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491711819
  error estimate for blocks of size 2^( 2) =       0.000510133817
  error estimate for blocks of size 2^( 3) =       0.000526826124
  error estimate for blocks of size 2^( 4) =       0.000538622575
  error estimate for blocks of size 2^( 5) =       0.000545620849
  error estimate for blocks of size 2^( 6) =       0.000548665175
  error estimate for blocks of size 2^( 7) =       0.000551168433

      target function =      -0.611332999075
              le_mean =     -22.667514774882
             les_mean =     514.313263164804
             stat err =       0.000546019258
             autocorr =       1.233089572895
   target nu stat err =       0.000546019258
   target dn stat err =       0.003384003291
      target stat err =       0.001061277917
              std dev =       0.695385523677
             le_variance =       0.483561026539


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266751477488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611334532788       residual = 8.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611336811587       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611337036046       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611337073134       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611337083470       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611337083676       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611337084276       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611337084264       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611337084210       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611337084107       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+01 is 1.830326e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611334532788       residual = 8.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611335103162       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611335159312       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611335168585       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611335171167       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611335171217       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611335171367       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611335171364       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611335171351       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611335171325       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+01 is 4.581434e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611334532788       residual = 8.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611334675424       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611334689463       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611334691782       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611334692427       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611334692440       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611334692477       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611334692477       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611334692472       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611334692467       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+02 is 1.145710e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.686925 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0531e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_001                -7.040781e-01 3 1  ON 0
ci_002                -7.023604e-01 3 1  ON 1
ci_003                -5.500341e-02 3 1  ON 2
ci_004                -5.543986e-02 3 1  ON 3
ci_005                 2.612691e-02 3 1  ON 4
ci_006                 2.613367e-02 3 1  ON 5
ci_007                 2.035227e-02 3 1  ON 6
ci_008                 2.079806e-02 3 1  ON 7
ci_009                -1.630433e-02 3 1  ON 8
ci_010                -1.602618e-02 3 1  ON 9
ci_011                -1.390951e-02 3 1  ON 10
ci_012                -1.365700e-02 3 1  ON 11
ci_013                 1.232978e-02 3 1  ON 12
ci_014                 1.221637e-02 3 1  ON 13
ci_015                 1.370939e-02 3 1  ON 14
ci_016                 1.348406e-02 3 1  ON 15
ci_017                 1.112445e-02 3 1  ON 16
ci_018                 1.124274e-02 3 1  ON 17
ci_019                 4.263580e-03 3 1  ON 18
ci_020                 4.562872e-03 3 1  ON 19
ci_021                -8.228596e-03 3 1  ON 20
ci_022                -8.433995e-03 3 1  ON 21
ci_023                 6.643200e-03 3 1  ON 22
ci_024                 6.648744e-03 3 1  ON 23
ci_025                 8.869044e-03 3 1  ON 24
ci_026                 8.748979e-03 3 1  ON 25
ci_027                 6.751006e-03 3 1  ON 26
ci_028                 6.849178e-03 3 1  ON 27
ci_029                -5.732144e-03 3 1  ON 28
ci_030                -5.719481e-03 3 1  ON 29
ci_031                -2.491199e-03 3 1  ON 30
ci_032                -2.819955e-03 3 1  ON 31
ci_033                 4.771689e-03 3 1  ON 32
ci_034                 4.666293e-03 3 1  ON 33
ci_035                 3.213385e-03 3 1  ON 34
ci_036                 3.359770e-03 3 1  ON 35
ci_037                 4.912987e-03 3 1  ON 36
ci_038                 4.780645e-03 3 1  ON 37
ci_039                 4.707910e-03 3 1  ON 38
ci_040                 4.762783e-03 3 1  ON 39
ci_041                 3.849132e-03 3 1  ON 40
ci_042                 3.796505e-03 3 1  ON 41
ci_043                 4.056428e-03 3 1  ON 42
ci_044                 4.067394e-03 3 1  ON 43
ci_045                 3.358528e-03 3 1  ON 44
ci_046                 3.472055e-03 3 1  ON 45
ci_047                -1.933948e-03 3 1  ON 46
ci_048                -2.039319e-03 3 1  ON 47
ci_049                 1.750741e-03 3 1  ON 48
ci_050                 1.716918e-03 3 1  ON 49
ci_051                -2.263989e-03 3 1  ON 50
ci_052                -2.103971e-03 3 1  ON 51
ci_053                -2.298025e-03 3 1  ON 52
ci_054                -2.442445e-03 3 1  ON 53
ci_055                -1.406397e-03 3 1  ON 54
ci_056                -1.571358e-03 3 1  ON 55
ci_057                -1.368783e-03 3 1  ON 56
ci_058                -1.462460e-03 3 1  ON 57
ci_059                -9.259218e-04 3 1  ON 58
ci_060                -8.796423e-04 3 1  ON 59
ci_061                -1.194041e-03 3 1  ON 60
ci_062                -7.872501e-04 3 1  ON 61
ci_063                -7.390270e-04 3 1  ON 62
ci_064                -8.578423e-04 3 1  ON 63
ci_065                -1.799129e-03 3 1  ON 64
ci_066                -2.046407e-03 3 1  ON 65
ci_067                -1.500966e-03 3 1  ON 66
ci_068                -1.071980e-03 3 1  ON 67
ci_069                 2.037988e-04 3 1  ON 68
ci_070                 2.100510e-04 3 1  ON 69
ci_071                -1.833762e-03 3 1  ON 70
ci_072                -1.762087e-03 3 1  ON 71
ci_073                 6.188244e-04 3 1  ON 72
ci_074                 5.148407e-04 3 1  ON 73
ci_075                -3.642124e-04 3 1  ON 74
ci_076                -3.490964e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7176
    reference variance = 0.367322
====================================================
  Execution time = 4.9487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0166e-01
  Total weights = 1.9551e+06
  Execution time = 7.2138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488443931117
                                         uncertainty =       0.002775027910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488443931117
                                         uncertainty =       0.002775027910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494132861
  error estimate for blocks of size 2^( 2) =       0.000512417292
  error estimate for blocks of size 2^( 3) =       0.000528911977
  error estimate for blocks of size 2^( 4) =       0.000541356664
  error estimate for blocks of size 2^( 5) =       0.000548249008
  error estimate for blocks of size 2^( 6) =       0.000552302029
  error estimate for blocks of size 2^( 7) =       0.000553516883

      target function =      -0.610149783313
              le_mean =     -22.668376028332
             les_mean =     514.356928269058
             stat err =       0.000548856146
             autocorr =       1.233756888640
   target nu stat err =       0.000548856146
   target dn stat err =       0.003624684792
      target stat err =       0.001128871362
              std dev =       0.698809393557
             le_variance =       0.488334568523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488428722327
                                         uncertainty =       0.002775007666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488428722327
                                         uncertainty =       0.002775007666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494125146
  error estimate for blocks of size 2^( 2) =       0.000512409433
  error estimate for blocks of size 2^( 3) =       0.000528903925
  error estimate for blocks of size 2^( 4) =       0.000541348370
  error estimate for blocks of size 2^( 5) =       0.000548240694
  error estimate for blocks of size 2^( 6) =       0.000552294119
  error estimate for blocks of size 2^( 7) =       0.000553509002

      target function =      -0.610151159621
              le_mean =     -22.668376096949
             les_mean =     514.356926881769
             stat err =       0.000548848046
             autocorr =       1.233758999700
   target nu stat err =       0.000548848046
   target dn stat err =       0.003625098113
      target stat err =       0.001128996662
              std dev =       0.698798483069
             le_variance =       0.488319319940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488436311200
                                         uncertainty =       0.002775017440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488436311200
                                         uncertainty =       0.002775017440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494128996
  error estimate for blocks of size 2^( 2) =       0.000512413354
  error estimate for blocks of size 2^( 3) =       0.000528907943
  error estimate for blocks of size 2^( 4) =       0.000541352509
  error estimate for blocks of size 2^( 5) =       0.000548244843
  error estimate for blocks of size 2^( 6) =       0.000552298066
  error estimate for blocks of size 2^( 7) =       0.000553512934

      target function =      -0.610150620014
              le_mean =     -22.668376061849
             les_mean =     514.356927047436
             stat err =       0.000548852088
             autocorr =       1.233757946205
   target nu stat err =       0.000548852088
   target dn stat err =       0.003624885579
      target stat err =       0.001128932820
              std dev =       0.698803927202
             le_variance =       0.488326928674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488442977596
                                         uncertainty =       0.002775026564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488442977596
                                         uncertainty =       0.002775026564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494132377
  error estimate for blocks of size 2^( 2) =       0.000512416799
  error estimate for blocks of size 2^( 3) =       0.000528911473
  error estimate for blocks of size 2^( 4) =       0.000541356144
  error estimate for blocks of size 2^( 5) =       0.000548248487
  error estimate for blocks of size 2^( 6) =       0.000552301533
  error estimate for blocks of size 2^( 7) =       0.000553516389

      target function =      -0.610149902494
              le_mean =     -22.668376032431
             les_mean =     514.356928063913
             stat err =       0.000548855638
             autocorr =       1.233757020939
   target nu stat err =       0.000548855638
   target dn stat err =       0.003624709317
      target stat err =       0.001128878928
              std dev =       0.698808709526
             le_variance =       0.488333612509


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610149783313        initial
     2.4414e+01     2.4414e+02             1.8303e-05        -0.610151159621  <--
     9.7656e+01     9.7656e+02             4.5814e-06        -0.610150620014
     3.9062e+02     3.9062e+03             1.1457e-06        -0.610149902494

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 8.5658e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_001                -7.040785e-01 3 1  ON 0
ci_002                -7.023642e-01 3 1  ON 1
ci_003                -5.499639e-02 3 1  ON 2
ci_004                -5.543107e-02 3 1  ON 3
ci_005                 2.611318e-02 3 1  ON 4
ci_006                 2.612052e-02 3 1  ON 5
ci_007                 2.034362e-02 3 1  ON 6
ci_008                 2.078907e-02 3 1  ON 7
ci_009                -1.629759e-02 3 1  ON 8
ci_010                -1.602065e-02 3 1  ON 9
ci_011                -1.390231e-02 3 1  ON 10
ci_012                -1.364961e-02 3 1  ON 11
ci_013                 1.232325e-02 3 1  ON 12
ci_014                 1.220998e-02 3 1  ON 13
ci_015                 1.370537e-02 3 1  ON 14
ci_016                 1.347948e-02 3 1  ON 15
ci_017                 1.112216e-02 3 1  ON 16
ci_018                 1.123921e-02 3 1  ON 17
ci_019                 4.258556e-03 3 1  ON 18
ci_020                 4.559417e-03 3 1  ON 19
ci_021                -8.225862e-03 3 1  ON 20
ci_022                -8.432810e-03 3 1  ON 21
ci_023                 6.641398e-03 3 1  ON 22
ci_024                 6.646601e-03 3 1  ON 23
ci_025                 8.871271e-03 3 1  ON 24
ci_026                 8.748827e-03 3 1  ON 25
ci_027                 6.750075e-03 3 1  ON 26
ci_028                 6.849204e-03 3 1  ON 27
ci_029                -5.731983e-03 3 1  ON 28
ci_030                -5.718083e-03 3 1  ON 29
ci_031                -2.487503e-03 3 1  ON 30
ci_032                -2.814705e-03 3 1  ON 31
ci_033                 4.768815e-03 3 1  ON 32
ci_034                 4.663945e-03 3 1  ON 33
ci_035                 3.210766e-03 3 1  ON 34
ci_036                 3.357654e-03 3 1  ON 35
ci_037                 4.909837e-03 3 1  ON 36
ci_038                 4.778988e-03 3 1  ON 37
ci_039                 4.708062e-03 3 1  ON 38
ci_040                 4.763361e-03 3 1  ON 39
ci_041                 3.848109e-03 3 1  ON 40
ci_042                 3.795305e-03 3 1  ON 41
ci_043                 4.056123e-03 3 1  ON 42
ci_044                 4.066846e-03 3 1  ON 43
ci_045                 3.357864e-03 3 1  ON 44
ci_046                 3.470180e-03 3 1  ON 45
ci_047                -1.933082e-03 3 1  ON 46
ci_048                -2.037567e-03 3 1  ON 47
ci_049                 1.749650e-03 3 1  ON 48
ci_050                 1.715098e-03 3 1  ON 49
ci_051                -2.261607e-03 3 1  ON 50
ci_052                -2.102765e-03 3 1  ON 51
ci_053                -2.298368e-03 3 1  ON 52
ci_054                -2.441546e-03 3 1  ON 53
ci_055                -1.405176e-03 3 1  ON 54
ci_056                -1.570248e-03 3 1  ON 55
ci_057                -1.368589e-03 3 1  ON 56
ci_058                -1.461628e-03 3 1  ON 57
ci_059                -9.264599e-04 3 1  ON 58
ci_060                -8.804411e-04 3 1  ON 59
ci_061                -1.191584e-03 3 1  ON 60
ci_062                -7.866462e-04 3 1  ON 61
ci_063                -7.382140e-04 3 1  ON 62
ci_064                -8.576057e-04 3 1  ON 63
ci_065                -1.799986e-03 3 1  ON 64
ci_066                -2.047094e-03 3 1  ON 65
ci_067                -1.501114e-03 3 1  ON 66
ci_068                -1.072586e-03 3 1  ON 67
ci_069                 2.034421e-04 3 1  ON 68
ci_070                 2.105088e-04 3 1  ON 69
ci_071                -1.833676e-03 3 1  ON 70
ci_072                -1.762179e-03 3 1  ON 71
ci_073                 6.187692e-04 3 1  ON 72
ci_074                 5.138980e-04 3 1  ON 73
ci_075                -3.632700e-04 3 1  ON 74
ci_076                -3.487751e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4620e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2680e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.6617
    reference variance = 0.381837
====================================================
  Execution time = 5.1151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9842e-01
  Total weights = 1.954680330e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486581105688
                                         uncertainty =       0.002388552263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486581105688
                                         uncertainty =       0.002388552263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493201126
  error estimate for blocks of size 2^( 2) =       0.000511560868
  error estimate for blocks of size 2^( 3) =       0.000528099499
  error estimate for blocks of size 2^( 4) =       0.000540599919
  error estimate for blocks of size 2^( 5) =       0.000548354734
  error estimate for blocks of size 2^( 6) =       0.000552782812
  error estimate for blocks of size 2^( 7) =       0.000554849845

      target function =      -0.610955626368
              le_mean =     -22.667679980846
             les_mean =     514.322134796615
             stat err =       0.000549146828
             autocorr =       1.239734932546
   target nu stat err =       0.000549146828
   target dn stat err =       0.003394088774
      target stat err =       0.001063502655
              std dev =       0.697491721914
             le_variance =       0.486494702138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266767998085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610957183104       residual = 9.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610967746710       residual = 8.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610968846257       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610968958343       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610968997020       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610969009736       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610969017458       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610969017916       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610969016524       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610969015872       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.610969015563       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 7.591907e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610957183104       residual = 9.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610959836725       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610960112295       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610960140314       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610960149968       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610960153128       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610960155043       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610960155154       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610960154806       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610960154644       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.610960154568       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+01 is 1.907301e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610957183104       residual = 9.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610957847309       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610957916245       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610957923249       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610957925662       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610957926450       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610957926928       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610957926956       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610957926869       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610957926828       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.610957926809       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+01 is 4.774116e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.693006 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0504e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_001                -7.040765e-01 3 1  ON 0
ci_002                -7.023712e-01 3 1  ON 1
ci_003                -5.499019e-02 3 1  ON 2
ci_004                -5.542120e-02 3 1  ON 3
ci_005                 2.609411e-02 3 1  ON 4
ci_006                 2.610246e-02 3 1  ON 5
ci_007                 2.033154e-02 3 1  ON 6
ci_008                 2.077675e-02 3 1  ON 7
ci_009                -1.628901e-02 3 1  ON 8
ci_010                -1.601060e-02 3 1  ON 9
ci_011                -1.389471e-02 3 1  ON 10
ci_012                -1.364089e-02 3 1  ON 11
ci_013                 1.231692e-02 3 1  ON 12
ci_014                 1.220307e-02 3 1  ON 13
ci_015                 1.369985e-02 3 1  ON 14
ci_016                 1.346972e-02 3 1  ON 15
ci_017                 1.112062e-02 3 1  ON 16
ci_018                 1.123459e-02 3 1  ON 17
ci_019                 4.255140e-03 3 1  ON 18
ci_020                 4.550211e-03 3 1  ON 19
ci_021                -8.228370e-03 3 1  ON 20
ci_022                -8.434134e-03 3 1  ON 21
ci_023                 6.639015e-03 3 1  ON 22
ci_024                 6.645302e-03 3 1  ON 23
ci_025                 8.872977e-03 3 1  ON 24
ci_026                 8.751328e-03 3 1  ON 25
ci_027                 6.751003e-03 3 1  ON 26
ci_028                 6.844349e-03 3 1  ON 27
ci_029                -5.729808e-03 3 1  ON 28
ci_030                -5.715603e-03 3 1  ON 29
ci_031                -2.479007e-03 3 1  ON 30
ci_032                -2.806785e-03 3 1  ON 31
ci_033                 4.765036e-03 3 1  ON 32
ci_034                 4.659701e-03 3 1  ON 33
ci_035                 3.207344e-03 3 1  ON 34
ci_036                 3.352264e-03 3 1  ON 35
ci_037                 4.908167e-03 3 1  ON 36
ci_038                 4.778054e-03 3 1  ON 37
ci_039                 4.706884e-03 3 1  ON 38
ci_040                 4.762237e-03 3 1  ON 39
ci_041                 3.848067e-03 3 1  ON 40
ci_042                 3.793168e-03 3 1  ON 41
ci_043                 4.056364e-03 3 1  ON 42
ci_044                 4.065683e-03 3 1  ON 43
ci_045                 3.357269e-03 3 1  ON 44
ci_046                 3.468429e-03 3 1  ON 45
ci_047                -1.931811e-03 3 1  ON 46
ci_048                -2.034855e-03 3 1  ON 47
ci_049                 1.743832e-03 3 1  ON 48
ci_050                 1.713634e-03 3 1  ON 49
ci_051                -2.259959e-03 3 1  ON 50
ci_052                -2.102273e-03 3 1  ON 51
ci_053                -2.298795e-03 3 1  ON 52
ci_054                -2.441475e-03 3 1  ON 53
ci_055                -1.405810e-03 3 1  ON 54
ci_056                -1.572048e-03 3 1  ON 55
ci_057                -1.368241e-03 3 1  ON 56
ci_058                -1.461257e-03 3 1  ON 57
ci_059                -9.244505e-04 3 1  ON 58
ci_060                -8.824000e-04 3 1  ON 59
ci_061                -1.189582e-03 3 1  ON 60
ci_062                -7.835903e-04 3 1  ON 61
ci_063                -7.373765e-04 3 1  ON 62
ci_064                -8.577420e-04 3 1  ON 63
ci_065                -1.800588e-03 3 1  ON 64
ci_066                -2.047052e-03 3 1  ON 65
ci_067                -1.501950e-03 3 1  ON 66
ci_068                -1.074450e-03 3 1  ON 67
ci_069                 2.029524e-04 3 1  ON 68
ci_070                 2.088302e-04 3 1  ON 69
ci_071                -1.832371e-03 3 1  ON 70
ci_072                -1.762183e-03 3 1  ON 71
ci_073                 6.181011e-04 3 1  ON 72
ci_074                 5.137516e-04 3 1  ON 73
ci_075                -3.631108e-04 3 1  ON 74
ci_076                -3.465433e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.619
    reference variance = 0.411787
====================================================
  Execution time = 5.0937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9525e-01
  Total weights = 1.9549e+06
  Execution time = 7.2248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484536524097
                                         uncertainty =       0.002481771392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484536524097
                                         uncertainty =       0.002481771392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492170006
  error estimate for blocks of size 2^( 2) =       0.000511091504
  error estimate for blocks of size 2^( 3) =       0.000527813239
  error estimate for blocks of size 2^( 4) =       0.000539357904
  error estimate for blocks of size 2^( 5) =       0.000547225580
  error estimate for blocks of size 2^( 6) =       0.000551850432
  error estimate for blocks of size 2^( 7) =       0.000556609321

      target function =      -0.612109777806
              le_mean =     -22.668477443535
             les_mean =     514.355147688238
             stat err =       0.000548760809
             autocorr =       1.243185367184
   target nu stat err =       0.000548760809
   target dn stat err =       0.003353748518
      target stat err =       0.001056173321
              std dev =       0.696033497190
             le_variance =       0.484462629211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484468566052
                                         uncertainty =       0.002480898915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484468566052
                                         uncertainty =       0.002480898915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492135520
  error estimate for blocks of size 2^( 2) =       0.000511056511
  error estimate for blocks of size 2^( 3) =       0.000527777727
  error estimate for blocks of size 2^( 4) =       0.000539321465
  error estimate for blocks of size 2^( 5) =       0.000547189602
  error estimate for blocks of size 2^( 6) =       0.000551813973
  error estimate for blocks of size 2^( 7) =       0.000556574013

      target function =      -0.612133264346
              le_mean =     -22.668476619780
             les_mean =     514.355032462894
             stat err =       0.000548724763
             autocorr =       1.243196267026
   target nu stat err =       0.000548724763
   target dn stat err =       0.003354117913
      target stat err =       0.001056354919
              std dev =       0.695984726486
             le_variance =       0.484394739502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484502289957
                                         uncertainty =       0.002481330189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484502289957
                                         uncertainty =       0.002481330189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492152634
  error estimate for blocks of size 2^( 2) =       0.000511073875
  error estimate for blocks of size 2^( 3) =       0.000527795349
  error estimate for blocks of size 2^( 4) =       0.000539339547
  error estimate for blocks of size 2^( 5) =       0.000547207463
  error estimate for blocks of size 2^( 6) =       0.000551832072
  error estimate for blocks of size 2^( 7) =       0.000556591534

      target function =      -0.612131204350
              le_mean =     -22.668477014708
             les_mean =     514.355057467155
             stat err =       0.000548742654
             autocorr =       1.243190869856
   target nu stat err =       0.000548742654
   target dn stat err =       0.003353680662
      target stat err =       0.001056222153
              std dev =       0.696008929124
             le_variance =       0.484428429420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484532228822
                                         uncertainty =       0.002481715892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484532228822
                                         uncertainty =       0.002481715892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492167826
  error estimate for blocks of size 2^( 2) =       0.000511089292
  error estimate for blocks of size 2^( 3) =       0.000527810995
  error estimate for blocks of size 2^( 4) =       0.000539355601
  error estimate for blocks of size 2^( 5) =       0.000547223298
  error estimate for blocks of size 2^( 6) =       0.000551848117
  error estimate for blocks of size 2^( 7) =       0.000556607081

      target function =      -0.612066274023
              le_mean =     -22.668477386352
             les_mean =     514.355288033483
             stat err =       0.000548758524
             autocorr =       1.243186024165
   target nu stat err =       0.000548758524
   target dn stat err =       0.003358707825
      target stat err =       0.001057485369
              std dev =       0.696030414737
             le_variance =       0.484458338240


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.612109777806        initial
     6.1035e+00     6.1035e+01             7.5919e-05        -0.612133264346  <--
     2.4414e+01     2.4414e+02             1.9073e-05        -0.612131204350
     9.7656e+01     9.7656e+02             4.7741e-06        -0.612066274023

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 8.7155e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_001                -7.040707e-01 3 1  ON 0
ci_002                -7.023923e-01 3 1  ON 1
ci_003                -5.497163e-02 3 1  ON 2
ci_004                -5.539167e-02 3 1  ON 3
ci_005                 2.603726e-02 3 1  ON 4
ci_006                 2.604865e-02 3 1  ON 5
ci_007                 2.029550e-02 3 1  ON 6
ci_008                 2.073999e-02 3 1  ON 7
ci_009                -1.626342e-02 3 1  ON 8
ci_010                -1.598062e-02 3 1  ON 9
ci_011                -1.387202e-02 3 1  ON 10
ci_012                -1.361486e-02 3 1  ON 11
ci_013                 1.229805e-02 3 1  ON 12
ci_014                 1.218245e-02 3 1  ON 13
ci_015                 1.368337e-02 3 1  ON 14
ci_016                 1.344057e-02 3 1  ON 15
ci_017                 1.111605e-02 3 1  ON 16
ci_018                 1.122079e-02 3 1  ON 17
ci_019                 4.244934e-03 3 1  ON 18
ci_020                 4.522724e-03 3 1  ON 19
ci_021                -8.235861e-03 3 1  ON 20
ci_022                -8.438094e-03 3 1  ON 21
ci_023                 6.631909e-03 3 1  ON 22
ci_024                 6.641430e-03 3 1  ON 23
ci_025                 8.878074e-03 3 1  ON 24
ci_026                 8.758804e-03 3 1  ON 25
ci_027                 6.753765e-03 3 1  ON 26
ci_028                 6.829885e-03 3 1  ON 27
ci_029                -5.723315e-03 3 1  ON 28
ci_030                -5.708198e-03 3 1  ON 29
ci_031                -2.453645e-03 3 1  ON 30
ci_032                -2.783142e-03 3 1  ON 31
ci_033                 4.753756e-03 3 1  ON 32
ci_034                 4.647039e-03 3 1  ON 33
ci_035                 3.197146e-03 3 1  ON 34
ci_036                 3.336202e-03 3 1  ON 35
ci_037                 4.903182e-03 3 1  ON 36
ci_038                 4.775266e-03 3 1  ON 37
ci_039                 4.703376e-03 3 1  ON 38
ci_040                 4.758892e-03 3 1  ON 39
ci_041                 3.847942e-03 3 1  ON 40
ci_042                 3.786797e-03 3 1  ON 41
ci_043                 4.057079e-03 3 1  ON 42
ci_044                 4.062208e-03 3 1  ON 43
ci_045                 3.355500e-03 3 1  ON 44
ci_046                 3.463208e-03 3 1  ON 45
ci_047                -1.928016e-03 3 1  ON 46
ci_048                -2.026767e-03 3 1  ON 47
ci_049                 1.726481e-03 3 1  ON 48
ci_050                 1.709267e-03 3 1  ON 49
ci_051                -2.255034e-03 3 1  ON 50
ci_052                -2.100794e-03 3 1  ON 51
ci_053                -2.300075e-03 3 1  ON 52
ci_054                -2.441272e-03 3 1  ON 53
ci_055                -1.407709e-03 3 1  ON 54
ci_056                -1.577404e-03 3 1  ON 55
ci_057                -1.367205e-03 3 1  ON 56
ci_058                -1.460149e-03 3 1  ON 57
ci_059                -9.184583e-04 3 1  ON 58
ci_060                -8.882380e-04 3 1  ON 59
ci_061                -1.183605e-03 3 1  ON 60
ci_062                -7.744711e-04 3 1  ON 61
ci_063                -7.348794e-04 3 1  ON 62
ci_064                -8.581536e-04 3 1  ON 63
ci_065                -1.802379e-03 3 1  ON 64
ci_066                -2.046924e-03 3 1  ON 65
ci_067                -1.504444e-03 3 1  ON 66
ci_068                -1.080013e-03 3 1  ON 67
ci_069                 2.014901e-04 3 1  ON 68
ci_070                 2.038225e-04 3 1  ON 69
ci_071                -1.828474e-03 3 1  ON 70
ci_072                -1.762191e-03 3 1  ON 71
ci_073                 6.161068e-04 3 1  ON 72
ci_074                 5.133145e-04 3 1  ON 73
ci_075                -3.626350e-04 3 1  ON 74
ci_076                -3.398849e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4767e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.6415
    reference variance = 0.4231
====================================================
  Execution time = 5.1309e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9742e-01
  Total weights = 1.955217248e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486334079535
                                         uncertainty =       0.002255754422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486334079535
                                         uncertainty =       0.002255754422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493130564
  error estimate for blocks of size 2^( 2) =       0.000511478928
  error estimate for blocks of size 2^( 3) =       0.000528318495
  error estimate for blocks of size 2^( 4) =       0.000540918996
  error estimate for blocks of size 2^( 5) =       0.000547392157
  error estimate for blocks of size 2^( 6) =       0.000552069850
  error estimate for blocks of size 2^( 7) =       0.000555767010

      target function =      -0.611356570995
              le_mean =     -22.668076373797
             les_mean =     514.339111304291
             stat err =       0.000549037003
             autocorr =       1.239593785377
   target nu stat err =       0.000549037003
   target dn stat err =       0.003350480521
      target stat err =       0.001052396983
              std dev =       0.697391931076
             le_variance =       0.486355505529


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266807637380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611358089165       residual = 7.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611391554403       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611394989328       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611395354208       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611395399071       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611395431601       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611395431640       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611395430732       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.874221e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611358089165       residual = 7.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611366614095       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611367481572       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611367572685       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611367583435       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611367591380       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611367591346       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611367591122       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 7.326524e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611358089165       residual = 7.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611360230547       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611360447967       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611360470736       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611360473394       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611360475369       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611360475358       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611360475301       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+01 is 1.840658e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.696888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0738e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_001                -7.040820e-01 3 1  ON 0
ci_002                -7.024013e-01 3 1  ON 1
ci_003                -5.492998e-02 3 1  ON 2
ci_004                -5.535266e-02 3 1  ON 3
ci_005                 2.596400e-02 3 1  ON 4
ci_006                 2.598200e-02 3 1  ON 5
ci_007                 2.025694e-02 3 1  ON 6
ci_008                 2.069075e-02 3 1  ON 7
ci_009                -1.622499e-02 3 1  ON 8
ci_010                -1.595806e-02 3 1  ON 9
ci_011                -1.384216e-02 3 1  ON 10
ci_012                -1.358159e-02 3 1  ON 11
ci_013                 1.227097e-02 3 1  ON 12
ci_014                 1.215106e-02 3 1  ON 13
ci_015                 1.365792e-02 3 1  ON 14
ci_016                 1.341468e-02 3 1  ON 15
ci_017                 1.110921e-02 3 1  ON 16
ci_018                 1.120520e-02 3 1  ON 17
ci_019                 4.224735e-03 3 1  ON 18
ci_020                 4.501230e-03 3 1  ON 19
ci_021                -8.237757e-03 3 1  ON 20
ci_022                -8.432103e-03 3 1  ON 21
ci_023                 6.627873e-03 3 1  ON 22
ci_024                 6.635915e-03 3 1  ON 23
ci_025                 8.867157e-03 3 1  ON 24
ci_026                 8.771368e-03 3 1  ON 25
ci_027                 6.750871e-03 3 1  ON 26
ci_028                 6.826474e-03 3 1  ON 27
ci_029                -5.713788e-03 3 1  ON 28
ci_030                -5.702072e-03 3 1  ON 29
ci_031                -2.428949e-03 3 1  ON 30
ci_032                -2.752316e-03 3 1  ON 31
ci_033                 4.751202e-03 3 1  ON 32
ci_034                 4.641518e-03 3 1  ON 33
ci_035                 3.188165e-03 3 1  ON 34
ci_036                 3.329172e-03 3 1  ON 35
ci_037                 4.888369e-03 3 1  ON 36
ci_038                 4.769222e-03 3 1  ON 37
ci_039                 4.707539e-03 3 1  ON 38
ci_040                 4.756630e-03 3 1  ON 39
ci_041                 3.849884e-03 3 1  ON 40
ci_042                 3.785640e-03 3 1  ON 41
ci_043                 4.056412e-03 3 1  ON 42
ci_044                 4.061607e-03 3 1  ON 43
ci_045                 3.350291e-03 3 1  ON 44
ci_046                 3.449877e-03 3 1  ON 45
ci_047                -1.921442e-03 3 1  ON 46
ci_048                -2.023747e-03 3 1  ON 47
ci_049                 1.722335e-03 3 1  ON 48
ci_050                 1.706824e-03 3 1  ON 49
ci_051                -2.258764e-03 3 1  ON 50
ci_052                -2.110663e-03 3 1  ON 51
ci_053                -2.290169e-03 3 1  ON 52
ci_054                -2.443276e-03 3 1  ON 53
ci_055                -1.402109e-03 3 1  ON 54
ci_056                -1.578491e-03 3 1  ON 55
ci_057                -1.364862e-03 3 1  ON 56
ci_058                -1.461031e-03 3 1  ON 57
ci_059                -9.180546e-04 3 1  ON 58
ci_060                -8.762420e-04 3 1  ON 59
ci_061                -1.179964e-03 3 1  ON 60
ci_062                -7.737309e-04 3 1  ON 61
ci_063                -7.335263e-04 3 1  ON 62
ci_064                -8.578824e-04 3 1  ON 63
ci_065                -1.797579e-03 3 1  ON 64
ci_066                -2.048724e-03 3 1  ON 65
ci_067                -1.499886e-03 3 1  ON 66
ci_068                -1.081960e-03 3 1  ON 67
ci_069                 2.006430e-04 3 1  ON 68
ci_070                 1.958324e-04 3 1  ON 69
ci_071                -1.834415e-03 3 1  ON 70
ci_072                -1.751761e-03 3 1  ON 71
ci_073                 6.153899e-04 3 1  ON 72
ci_074                 5.094022e-04 3 1  ON 73
ci_075                -3.581086e-04 3 1  ON 74
ci_076                -3.406214e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.6819
    reference variance = 0.463167
====================================================
  Execution time = 4.9750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9627e-01
  Total weights = 1.9550e+06
  Execution time = 7.2296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485463846634
                                         uncertainty =       0.002434478737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485463846634
                                         uncertainty =       0.002434478737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492642964
  error estimate for blocks of size 2^( 2) =       0.000511244869
  error estimate for blocks of size 2^( 3) =       0.000528511141
  error estimate for blocks of size 2^( 4) =       0.000540283568
  error estimate for blocks of size 2^( 5) =       0.000547426260
  error estimate for blocks of size 2^( 6) =       0.000551306310
  error estimate for blocks of size 2^( 7) =       0.000553239719

      target function =      -0.611746450601
              le_mean =     -22.668341900459
             les_mean =     514.350086542414
             stat err =       0.000548063964
             autocorr =       1.237650230077
   target nu stat err =       0.000548063964
   target dn stat err =       0.002914313753
      target stat err =       0.000926399502
              std dev =       0.696702360606
             le_variance =       0.485394179274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485270565006
                                         uncertainty =       0.002433211209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485270565006
                                         uncertainty =       0.002433211209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492544880
  error estimate for blocks of size 2^( 2) =       0.000511144338
  error estimate for blocks of size 2^( 3) =       0.000528409647
  error estimate for blocks of size 2^( 4) =       0.000540179059
  error estimate for blocks of size 2^( 5) =       0.000547319553
  error estimate for blocks of size 2^( 6) =       0.000551201294
  error estimate for blocks of size 2^( 7) =       0.000553133458

      target function =      -0.611814917358
              le_mean =     -22.668343760423
             les_mean =     514.349947096760
             stat err =       0.000547958341
             autocorr =       1.237666015054
   target nu stat err =       0.000547958341
   target dn stat err =       0.002915171647
      target stat err =       0.000926833139
              std dev =       0.696563649671
             le_variance =       0.485200918043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485364022418
                                         uncertainty =       0.002433762870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485364022418
                                         uncertainty =       0.002433762870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492592309
  error estimate for blocks of size 2^( 2) =       0.000511192934
  error estimate for blocks of size 2^( 3) =       0.000528458714
  error estimate for blocks of size 2^( 4) =       0.000540229600
  error estimate for blocks of size 2^( 5) =       0.000547371138
  error estimate for blocks of size 2^( 6) =       0.000551252088
  error estimate for blocks of size 2^( 7) =       0.000553184950

      target function =      -0.611792866230
              le_mean =     -22.668342653852
             les_mean =     514.349968576633
             stat err =       0.000548009444
             autocorr =       1.237658509152
   target nu stat err =       0.000548009444
   target dn stat err =       0.002913314438
      target stat err =       0.000926236349
              std dev =       0.696630724325
             le_variance =       0.485294366074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485451147923
                                         uncertainty =       0.002434380959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485451147923
                                         uncertainty =       0.002434380959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492636520
  error estimate for blocks of size 2^( 2) =       0.000511238262
  error estimate for blocks of size 2^( 3) =       0.000528504468
  error estimate for blocks of size 2^( 4) =       0.000540276703
  error estimate for blocks of size 2^( 5) =       0.000547419253
  error estimate for blocks of size 2^( 6) =       0.000551299419
  error estimate for blocks of size 2^( 7) =       0.000553232767

      target function =      -0.611754524722
              le_mean =     -22.668341975296
             les_mean =     514.350063425415
             stat err =       0.000548057035
             autocorr =       1.237651312127
   target nu stat err =       0.000548057035
   target dn stat err =       0.002913980068
      target stat err =       0.000926325030
              std dev =       0.696693248141
             le_variance =       0.485381482005


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611746450601        initial
     1.5259e+00     1.5259e+01             2.8742e-04        -0.611814917358  <--
     6.1035e+00     6.1035e+01             7.3265e-05        -0.611792866230
     2.4414e+01     2.4414e+02             1.8407e-05        -0.611754524722

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 8.6038e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_001                -7.041152e-01 3 1  ON 0
ci_002                -7.024278e-01 3 1  ON 1
ci_003                -5.480626e-02 3 1  ON 2
ci_004                -5.523691e-02 3 1  ON 3
ci_005                 2.574984e-02 3 1  ON 4
ci_006                 2.578720e-02 3 1  ON 5
ci_007                 2.014385e-02 3 1  ON 6
ci_008                 2.054628e-02 3 1  ON 7
ci_009                -1.611238e-02 3 1  ON 8
ci_010                -1.589205e-02 3 1  ON 9
ci_011                -1.375460e-02 3 1  ON 10
ci_012                -1.348395e-02 3 1  ON 11
ci_013                 1.219153e-02 3 1  ON 12
ci_014                 1.205901e-02 3 1  ON 13
ci_015                 1.358301e-02 3 1  ON 14
ci_016                 1.333843e-02 3 1  ON 15
ci_017                 1.108925e-02 3 1  ON 16
ci_018                 1.115951e-02 3 1  ON 17
ci_019                 4.165281e-03 3 1  ON 18
ci_020                 4.437873e-03 3 1  ON 19
ci_021                -8.243419e-03 3 1  ON 20
ci_022                -8.414590e-03 3 1  ON 21
ci_023                 6.616080e-03 3 1  ON 22
ci_024                 6.619772e-03 3 1  ON 23
ci_025                 8.835116e-03 3 1  ON 24
ci_026                 8.808427e-03 3 1  ON 25
ci_027                 6.742439e-03 3 1  ON 26
ci_028                 6.816535e-03 3 1  ON 27
ci_029                -5.685739e-03 3 1  ON 28
ci_030                -5.684065e-03 3 1  ON 29
ci_031                -2.356344e-03 3 1  ON 30
ci_032                -2.661691e-03 3 1  ON 31
ci_033                 4.743701e-03 3 1  ON 32
ci_034                 4.625300e-03 3 1  ON 33
ci_035                 3.161846e-03 3 1  ON 34
ci_036                 3.308599e-03 3 1  ON 35
ci_037                 4.844789e-03 3 1  ON 36
ci_038                 4.751373e-03 3 1  ON 37
ci_039                 4.719757e-03 3 1  ON 38
ci_040                 4.750050e-03 3 1  ON 39
ci_041                 3.855556e-03 3 1  ON 40
ci_042                 3.782267e-03 3 1  ON 41
ci_043                 4.054431e-03 3 1  ON 42
ci_044                 4.059769e-03 3 1  ON 43
ci_045                 3.335009e-03 3 1  ON 44
ci_046                 3.410774e-03 3 1  ON 45
ci_047                -1.902160e-03 3 1  ON 46
ci_048                -2.014846e-03 3 1  ON 47
ci_049                 1.710169e-03 3 1  ON 48
ci_050                 1.699639e-03 3 1  ON 49
ci_051                -2.269581e-03 3 1  ON 50
ci_052                -2.139529e-03 3 1  ON 51
ci_053                -2.261141e-03 3 1  ON 52
ci_054                -2.449271e-03 3 1  ON 53
ci_055                -1.385661e-03 3 1  ON 54
ci_056                -1.581698e-03 3 1  ON 55
ci_057                -1.357978e-03 3 1  ON 56
ci_058                -1.463621e-03 3 1  ON 57
ci_059                -9.168685e-04 3 1  ON 58
ci_060                -8.411871e-04 3 1  ON 59
ci_061                -1.169282e-03 3 1  ON 60
ci_062                -7.715633e-04 3 1  ON 61
ci_063                -7.296188e-04 3 1  ON 62
ci_064                -8.571201e-04 3 1  ON 63
ci_065                -1.783460e-03 3 1  ON 64
ci_066                -2.053968e-03 3 1  ON 65
ci_067                -1.486536e-03 3 1  ON 66
ci_068                -1.087674e-03 3 1  ON 67
ci_069                 1.981428e-04 3 1  ON 68
ci_070                 1.723737e-04 3 1  ON 69
ci_071                -1.851790e-03 3 1  ON 70
ci_072                -1.721051e-03 3 1  ON 71
ci_073                 6.132570e-04 3 1  ON 72
ci_074                 4.979352e-04 3 1  ON 73
ci_075                -3.448300e-04 3 1  ON 74
ci_076                -3.427624e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4679e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6975
    reference variance = 0.313187
====================================================
  Execution time = 5.1171e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9802e-01
  Total weights = 1.954823190e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486715714489
                                         uncertainty =       0.003165220523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486715714489
                                         uncertainty =       0.003165220523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493309001
  error estimate for blocks of size 2^( 2) =       0.000511491317
  error estimate for blocks of size 2^( 3) =       0.000528124397
  error estimate for blocks of size 2^( 4) =       0.000540150936
  error estimate for blocks of size 2^( 5) =       0.000545587571
  error estimate for blocks of size 2^( 6) =       0.000550571014
  error estimate for blocks of size 2^( 7) =       0.000553149312

      target function =      -0.611184175015
              le_mean =     -22.668109743750
             les_mean =     514.341217989326
             stat err =       0.000547364708
             autocorr =       1.231162859914
   target nu stat err =       0.000547364708
   target dn stat err =       0.003956245514
      target stat err =       0.001230010035
              std dev =       0.697644279233
             le_variance =       0.486707540347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266810974375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611186355480       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611329866091       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611345600481       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611346775757       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611347038972       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611347011072       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611347051425       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611347040485       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611347035581       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 1.088129e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611186355480       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611224894846       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611229002578       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611229296974       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611229360949       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611229353094       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611229362388       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611229359720       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611229358631       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.930412e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611186355480       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611196172335       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611197210587       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611197284156       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611197300013       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611197297996       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611197300267       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611197299605       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611197299342       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 7.470189e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.708327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0618e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_001                -7.041659e-01 3 1  ON 0
ci_002                -7.024502e-01 3 1  ON 1
ci_003                -5.467952e-02 3 1  ON 2
ci_004                -5.518366e-02 3 1  ON 3
ci_005                 2.548089e-02 3 1  ON 4
ci_006                 2.549416e-02 3 1  ON 5
ci_007                 1.993597e-02 3 1  ON 6
ci_008                 2.036173e-02 3 1  ON 7
ci_009                -1.599465e-02 3 1  ON 8
ci_010                -1.573978e-02 3 1  ON 9
ci_011                -1.365095e-02 3 1  ON 10
ci_012                -1.327860e-02 3 1  ON 11
ci_013                 1.208761e-02 3 1  ON 12
ci_014                 1.194911e-02 3 1  ON 13
ci_015                 1.347125e-02 3 1  ON 14
ci_016                 1.323466e-02 3 1  ON 15
ci_017                 1.101457e-02 3 1  ON 16
ci_018                 1.111431e-02 3 1  ON 17
ci_019                 4.077226e-03 3 1  ON 18
ci_020                 4.369088e-03 3 1  ON 19
ci_021                -8.235738e-03 3 1  ON 20
ci_022                -8.394508e-03 3 1  ON 21
ci_023                 6.589548e-03 3 1  ON 22
ci_024                 6.597001e-03 3 1  ON 23
ci_025                 8.851144e-03 3 1  ON 24
ci_026                 8.811729e-03 3 1  ON 25
ci_027                 6.727083e-03 3 1  ON 26
ci_028                 6.831116e-03 3 1  ON 27
ci_029                -5.665847e-03 3 1  ON 28
ci_030                -5.629848e-03 3 1  ON 29
ci_031                -2.261284e-03 3 1  ON 30
ci_032                -2.587209e-03 3 1  ON 31
ci_033                 4.718852e-03 3 1  ON 32
ci_034                 4.579632e-03 3 1  ON 33
ci_035                 3.102850e-03 3 1  ON 34
ci_036                 3.255543e-03 3 1  ON 35
ci_037                 4.825485e-03 3 1  ON 36
ci_038                 4.678216e-03 3 1  ON 37
ci_039                 4.724564e-03 3 1  ON 38
ci_040                 4.751410e-03 3 1  ON 39
ci_041                 3.820278e-03 3 1  ON 40
ci_042                 3.764164e-03 3 1  ON 41
ci_043                 4.075266e-03 3 1  ON 42
ci_044                 4.065758e-03 3 1  ON 43
ci_045                 3.275203e-03 3 1  ON 44
ci_046                 3.416089e-03 3 1  ON 45
ci_047                -1.866634e-03 3 1  ON 46
ci_048                -1.982370e-03 3 1  ON 47
ci_049                 1.675301e-03 3 1  ON 48
ci_050                 1.679166e-03 3 1  ON 49
ci_051                -2.221575e-03 3 1  ON 50
ci_052                -2.142570e-03 3 1  ON 51
ci_053                -2.228156e-03 3 1  ON 52
ci_054                -2.451140e-03 3 1  ON 53
ci_055                -1.361811e-03 3 1  ON 54
ci_056                -1.577893e-03 3 1  ON 55
ci_057                -1.349809e-03 3 1  ON 56
ci_058                -1.449456e-03 3 1  ON 57
ci_059                -9.218956e-04 3 1  ON 58
ci_060                -8.247573e-04 3 1  ON 59
ci_061                -1.129856e-03 3 1  ON 60
ci_062                -6.970855e-04 3 1  ON 61
ci_063                -6.959288e-04 3 1  ON 62
ci_064                -8.550263e-04 3 1  ON 63
ci_065                -1.806054e-03 3 1  ON 64
ci_066                -2.056679e-03 3 1  ON 65
ci_067                -1.525626e-03 3 1  ON 66
ci_068                -1.090153e-03 3 1  ON 67
ci_069                 1.924414e-04 3 1  ON 68
ci_070                 1.498954e-04 3 1  ON 69
ci_071                -1.861250e-03 3 1  ON 70
ci_072                -1.744610e-03 3 1  ON 71
ci_073                 6.012443e-04 3 1  ON 72
ci_074                 5.089966e-04 3 1  ON 73
ci_075                -3.415631e-04 3 1  ON 74
ci_076                -3.298501e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6098
    reference variance = 0.571101
====================================================
  Execution time = 4.9871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0036e-01
  Total weights = 1.9548e+06
  Execution time = 7.1996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488157488472
                                         uncertainty =       0.003588203560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488157488472
                                         uncertainty =       0.003588203560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494036039
  error estimate for blocks of size 2^( 2) =       0.000512457559
  error estimate for blocks of size 2^( 3) =       0.000529021096
  error estimate for blocks of size 2^( 4) =       0.000541299883
  error estimate for blocks of size 2^( 5) =       0.000549057722
  error estimate for blocks of size 2^( 6) =       0.000552981672
  error estimate for blocks of size 2^( 7) =       0.000555961389

      target function =      -0.610298996788
              le_mean =     -22.667817223537
             les_mean =     514.330637329987
             stat err =       0.000549825167
             autocorr =       1.238602540538
   target nu stat err =       0.000549825167
   target dn stat err =       0.004174127644
      target stat err =       0.001290816528
              std dev =       0.698672466897
             le_variance =       0.488143215999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487235443686
                                         uncertainty =       0.003480864024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487235443686
                                         uncertainty =       0.003480864024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493569333
  error estimate for blocks of size 2^( 2) =       0.000511991136
  error estimate for blocks of size 2^( 3) =       0.000528554968
  error estimate for blocks of size 2^( 4) =       0.000540823456
  error estimate for blocks of size 2^( 5) =       0.000548570701
  error estimate for blocks of size 2^( 6) =       0.000552504138
  error estimate for blocks of size 2^( 7) =       0.000555518646

      target function =      -0.609850597521
              le_mean =     -22.667821662345
             les_mean =     514.332324864354
             stat err =       0.000549354235
             autocorr =       1.238821169551
   target nu stat err =       0.000549354235
   target dn stat err =       0.004599760973
      target stat err =       0.001414760586
              std dev =       0.698012444982
             le_variance =       0.487221373349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487639945449
                                         uncertainty =       0.003529122538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487639945449
                                         uncertainty =       0.003529122538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493774139
  error estimate for blocks of size 2^( 2) =       0.000512195571
  error estimate for blocks of size 2^( 3) =       0.000528759237
  error estimate for blocks of size 2^( 4) =       0.000541032254
  error estimate for blocks of size 2^( 5) =       0.000548784461
  error estimate for blocks of size 2^( 6) =       0.000552714328
  error estimate for blocks of size 2^( 7) =       0.000555713827

      target function =      -0.609886076051
              le_mean =     -22.667816873204
             les_mean =     514.331986544283
             stat err =       0.000549561217
             autocorr =       1.238726629295
   target nu stat err =       0.000549561217
   target dn stat err =       0.004537451144
      target stat err =       0.001396482042
              std dev =       0.698302083567
             le_variance =       0.487625799914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488088601004
                                         uncertainty =       0.003580466185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488088601004
                                         uncertainty =       0.003580466185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494001188
  error estimate for blocks of size 2^( 2) =       0.000512422663
  error estimate for blocks of size 2^( 3) =       0.000528986189
  error estimate for blocks of size 2^( 4) =       0.000541264228
  error estimate for blocks of size 2^( 5) =       0.000549021318
  error estimate for blocks of size 2^( 6) =       0.000552945994
  error estimate for blocks of size 2^( 7) =       0.000555928333

      target function =      -0.610333287157
              le_mean =     -22.667816787463
             les_mean =     514.330503785946
             stat err =       0.000549789968
             autocorr =       1.238618711201
   target nu stat err =       0.000549789968
   target dn stat err =       0.004169632816
      target stat err =       0.001289625964
              std dev =       0.698623179406
             le_variance =       0.488074346803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610298996788        initial
     3.8147e-01     3.8147e+00             1.0881e-03        -0.609850597521
     1.5259e+00     1.5259e+01             2.9304e-04        -0.609886076051
     6.1035e+00     6.1035e+01             7.4702e-05        -0.610333287157  <--

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 8.5962e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_001                -7.041280e-01 3 1  ON 0
ci_002                -7.024335e-01 3 1  ON 1
ci_003                -5.477434e-02 3 1  ON 2
ci_004                -5.522348e-02 3 1  ON 3
ci_005                 2.568129e-02 3 1  ON 4
ci_006                 2.571249e-02 3 1  ON 5
ci_007                 2.009102e-02 3 1  ON 6
ci_008                 2.049936e-02 3 1  ON 7
ci_009                -1.608243e-02 3 1  ON 8
ci_010                -1.585333e-02 3 1  ON 9
ci_011                -1.372824e-02 3 1  ON 10
ci_012                -1.343174e-02 3 1  ON 11
ci_013                 1.216511e-02 3 1  ON 12
ci_014                 1.203107e-02 3 1  ON 13
ci_015                 1.355467e-02 3 1  ON 14
ci_016                 1.331211e-02 3 1  ON 15
ci_017                 1.107026e-02 3 1  ON 16
ci_018                 1.114802e-02 3 1  ON 17
ci_019                 4.142969e-03 3 1  ON 18
ci_020                 4.420440e-03 3 1  ON 19
ci_021                -8.241456e-03 3 1  ON 20
ci_022                -8.409485e-03 3 1  ON 21
ci_023                 6.609322e-03 3 1  ON 22
ci_024                 6.613973e-03 3 1  ON 23
ci_025                 8.839166e-03 3 1  ON 24
ci_026                 8.809242e-03 3 1  ON 25
ci_027                 6.738518e-03 3 1  ON 26
ci_028                 6.820243e-03 3 1  ON 27
ci_029                -5.680704e-03 3 1  ON 28
ci_030                -5.670312e-03 3 1  ON 29
ci_031                -2.332215e-03 3 1  ON 30
ci_032                -2.642781e-03 3 1  ON 31
ci_033                 4.737388e-03 3 1  ON 32
ci_034                 4.613709e-03 3 1  ON 33
ci_035                 3.146804e-03 3 1  ON 34
ci_036                 3.295085e-03 3 1  ON 35
ci_037                 4.839890e-03 3 1  ON 36
ci_038                 4.732806e-03 3 1  ON 37
ci_039                 4.720973e-03 3 1  ON 38
ci_040                 4.750394e-03 3 1  ON 39
ci_041                 3.846566e-03 3 1  ON 40
ci_042                 3.777659e-03 3 1  ON 41
ci_043                 4.059742e-03 3 1  ON 42
ci_044                 4.061333e-03 3 1  ON 43
ci_045                 3.319795e-03 3 1  ON 44
ci_046                 3.412104e-03 3 1  ON 45
ci_047                -1.893125e-03 3 1  ON 46
ci_048                -2.006586e-03 3 1  ON 47
ci_049                 1.701302e-03 3 1  ON 48
ci_050                 1.694434e-03 3 1  ON 49
ci_051                -2.257423e-03 3 1  ON 50
ci_052                -2.140342e-03 3 1  ON 51
ci_053                -2.252745e-03 3 1  ON 52
ci_054                -2.449708e-03 3 1  ON 53
ci_055                -1.379589e-03 3 1  ON 54
ci_056                -1.580730e-03 3 1  ON 55
ci_057                -1.355898e-03 3 1  ON 56
ci_058                -1.460015e-03 3 1  ON 57
ci_059                -9.181545e-04 3 1  ON 58
ci_060                -8.370072e-04 3 1  ON 59
ci_061                -1.159265e-03 3 1  ON 60
ci_062                -7.526421e-04 3 1  ON 61
ci_063                -7.210422e-04 3 1  ON 62
ci_064                -8.565700e-04 3 1  ON 63
ci_065                -1.789211e-03 3 1  ON 64
ci_066                -2.054675e-03 3 1  ON 65
ci_067                -1.496459e-03 3 1  ON 66
ci_068                -1.088300e-03 3 1  ON 67
ci_069                 1.966892e-04 3 1  ON 68
ci_070                 1.666691e-04 3 1  ON 69
ci_071                -1.854211e-03 3 1  ON 70
ci_072                -1.727054e-03 3 1  ON 71
ci_073                 6.102027e-04 3 1  ON 72
ci_074                 5.007622e-04 3 1  ON 73
ci_075                -3.440025e-04 3 1  ON 74
ci_076                -3.394766e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4660e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.6217
    reference variance = 0.307284
====================================================
  Execution time = 5.1198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9746e-01
  Total weights = 1.954703103e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485792659872
                                         uncertainty =       0.002161338021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485792659872
                                         uncertainty =       0.002161338021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492833990
  error estimate for blocks of size 2^( 2) =       0.000511296569
  error estimate for blocks of size 2^( 3) =       0.000528503797
  error estimate for blocks of size 2^( 4) =       0.000541266806
  error estimate for blocks of size 2^( 5) =       0.000549256883
  error estimate for blocks of size 2^( 6) =       0.000553417832
  error estimate for blocks of size 2^( 7) =       0.000556394233

      target function =      -0.611631501766
              le_mean =     -22.669213925004
             les_mean =     514.390721427330
             stat err =       0.000550083939
             autocorr =       1.245823800847
   target nu stat err =       0.000550083939
   target dn stat err =       0.003096265908
      target stat err =       0.000979998660
              std dev =       0.696972512566
             le_variance =       0.485770683272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266921392500e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611632773673       residual = 7.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611666074325       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611669263348       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611669470978       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611669577771       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611669581693       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611669592260       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611669588322       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611669588131       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.697826e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611632773673       residual = 7.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611641256746       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611642062429       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611642114233       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611642140780       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611642141651       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611642144212       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611642143231       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611642143187       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 6.877420e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611632773673       residual = 7.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611634904545       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611635106497       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611635119440       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611635126067       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611635126278       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611635126913       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611635126668       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611635126657       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+01 is 1.727863e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.712799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0596e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_001                -7.041340e-01 3 1  ON 0
ci_002                -7.024458e-01 3 1  ON 1
ci_003                -5.474633e-02 3 1  ON 2
ci_004                -5.519636e-02 3 1  ON 3
ci_005                 2.561252e-02 3 1  ON 4
ci_006                 2.564912e-02 3 1  ON 5
ci_007                 2.005946e-02 3 1  ON 6
ci_008                 2.045489e-02 3 1  ON 7
ci_009                -1.603731e-02 3 1  ON 8
ci_010                -1.582099e-02 3 1  ON 9
ci_011                -1.369996e-02 3 1  ON 10
ci_012                -1.340087e-02 3 1  ON 11
ci_013                 1.214097e-02 3 1  ON 12
ci_014                 1.200090e-02 3 1  ON 13
ci_015                 1.352304e-02 3 1  ON 14
ci_016                 1.328310e-02 3 1  ON 15
ci_017                 1.104960e-02 3 1  ON 16
ci_018                 1.112857e-02 3 1  ON 17
ci_019                 4.125429e-03 3 1  ON 18
ci_020                 4.398144e-03 3 1  ON 19
ci_021                -8.233639e-03 3 1  ON 20
ci_022                -8.398573e-03 3 1  ON 21
ci_023                 6.608152e-03 3 1  ON 22
ci_024                 6.609644e-03 3 1  ON 23
ci_025                 8.845967e-03 3 1  ON 24
ci_026                 8.814609e-03 3 1  ON 25
ci_027                 6.741000e-03 3 1  ON 26
ci_028                 6.808430e-03 3 1  ON 27
ci_029                -5.677037e-03 3 1  ON 28
ci_030                -5.664225e-03 3 1  ON 29
ci_031                -2.308597e-03 3 1  ON 30
ci_032                -2.618586e-03 3 1  ON 31
ci_033                 4.733010e-03 3 1  ON 32
ci_034                 4.599584e-03 3 1  ON 33
ci_035                 3.133851e-03 3 1  ON 34
ci_036                 3.285737e-03 3 1  ON 35
ci_037                 4.834202e-03 3 1  ON 36
ci_038                 4.725293e-03 3 1  ON 37
ci_039                 4.717915e-03 3 1  ON 38
ci_040                 4.748707e-03 3 1  ON 39
ci_041                 3.841469e-03 3 1  ON 40
ci_042                 3.771889e-03 3 1  ON 41
ci_043                 4.053970e-03 3 1  ON 42
ci_044                 4.061676e-03 3 1  ON 43
ci_045                 3.315684e-03 3 1  ON 44
ci_046                 3.419204e-03 3 1  ON 45
ci_047                -1.890854e-03 3 1  ON 46
ci_048                -1.999927e-03 3 1  ON 47
ci_049                 1.697766e-03 3 1  ON 48
ci_050                 1.682494e-03 3 1  ON 49
ci_051                -2.257358e-03 3 1  ON 50
ci_052                -2.136108e-03 3 1  ON 51
ci_053                -2.252566e-03 3 1  ON 52
ci_054                -2.445410e-03 3 1  ON 53
ci_055                -1.371929e-03 3 1  ON 54
ci_056                -1.575778e-03 3 1  ON 55
ci_057                -1.347720e-03 3 1  ON 56
ci_058                -1.454897e-03 3 1  ON 57
ci_059                -9.122374e-04 3 1  ON 58
ci_060                -8.331112e-04 3 1  ON 59
ci_061                -1.155432e-03 3 1  ON 60
ci_062                -7.437184e-04 3 1  ON 61
ci_063                -7.216040e-04 3 1  ON 62
ci_064                -8.564087e-04 3 1  ON 63
ci_065                -1.796354e-03 3 1  ON 64
ci_066                -2.054470e-03 3 1  ON 65
ci_067                -1.500922e-03 3 1  ON 66
ci_068                -1.087960e-03 3 1  ON 67
ci_069                 1.879442e-04 3 1  ON 68
ci_070                 1.776025e-04 3 1  ON 69
ci_071                -1.855629e-03 3 1  ON 70
ci_072                -1.728596e-03 3 1  ON 71
ci_073                 6.100872e-04 3 1  ON 72
ci_074                 4.987204e-04 3 1  ON 73
ci_075                -3.362475e-04 3 1  ON 74
ci_076                -3.382532e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.6055
    reference variance = 0.462827
====================================================
  Execution time = 4.9628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 4.9099e-01
  Total weights = 1.9549e+06
  Execution time = 7.2057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481040190322
                                         uncertainty =       0.001879832711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481040190322
                                         uncertainty =       0.001879832711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490408534
  error estimate for blocks of size 2^( 2) =       0.000509142997
  error estimate for blocks of size 2^( 3) =       0.000526056807
  error estimate for blocks of size 2^( 4) =       0.000537350161
  error estimate for blocks of size 2^( 5) =       0.000544465436
  error estimate for blocks of size 2^( 6) =       0.000549952123
  error estimate for blocks of size 2^( 7) =       0.000554523067

      target function =      -0.612899835897
              le_mean =     -22.667294373614
             les_mean =     514.297935504803
             stat err =       0.000546572697
             autocorr =       1.242166544578
   target nu stat err =       0.000546572697
   target dn stat err =       0.002766303064
      target stat err =       0.000885706187
              std dev =       0.693542400441
             le_variance =       0.481001061209

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0624788
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480829299987
                                         uncertainty =       0.001878293504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480829299987
                                         uncertainty =       0.001878293504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490300977
  error estimate for blocks of size 2^( 2) =       0.000509035653
  error estimate for blocks of size 2^( 3) =       0.000525946919
  error estimate for blocks of size 2^( 4) =       0.000537238606
  error estimate for blocks of size 2^( 5) =       0.000544355968
  error estimate for blocks of size 2^( 6) =       0.000549841961
  error estimate for blocks of size 2^( 7) =       0.000554412861

      target function =      -0.613028063221
              le_mean =     -22.667293273828
             les_mean =     514.297464231050
             stat err =       0.000546462349
             autocorr =       1.242209858078
   target nu stat err =       0.000546462349
   target dn stat err =       0.002695638103
      target stat err =       0.000865562224
              std dev =       0.693390291689
             le_variance =       0.480790096608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480931494455
                                         uncertainty =       0.001879029536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480931494455
                                         uncertainty =       0.001879029536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490353102
  error estimate for blocks of size 2^( 2) =       0.000509087646
  error estimate for blocks of size 2^( 3) =       0.000526000159
  error estimate for blocks of size 2^( 4) =       0.000537292774
  error estimate for blocks of size 2^( 5) =       0.000544409192
  error estimate for blocks of size 2^( 6) =       0.000549895619
  error estimate for blocks of size 2^( 7) =       0.000554466594

      target function =      -0.613157194049
              le_mean =     -22.667293626503
             les_mean =     514.297057139746
             stat err =       0.000546516045
             autocorr =       1.242189860383
   target nu stat err =       0.000546516045
   target dn stat err =       0.002651907602
      target stat err =       0.000853264738
              std dev =       0.693464006509
             le_variance =       0.480892328323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481026387039
                                         uncertainty =       0.001879729389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481026387039
                                         uncertainty =       0.001879729389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490401495
  error estimate for blocks of size 2^( 2) =       0.000509135963
  error estimate for blocks of size 2^( 3) =       0.000526049607
  error estimate for blocks of size 2^( 4) =       0.000537342869
  error estimate for blocks of size 2^( 5) =       0.000544458300
  error estimate for blocks of size 2^( 6) =       0.000549944969
  error estimate for blocks of size 2^( 7) =       0.000554515910

      target function =      -0.613006152378
              le_mean =     -22.667294255999
             les_mean =     514.297581448996
             stat err =       0.000546565512
             autocorr =       1.242169545140
   target nu stat err =       0.000546565512
   target dn stat err =       0.002693676838
      target stat err =       0.000864952594
              std dev =       0.693532445795
             le_variance =       0.480987253370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.612899835897        initial
     1.5259e+00     1.5259e+01             2.6978e-04        -0.613028063221
     6.1035e+00     6.1035e+01             6.8774e-05        -0.613157194049  <--
     2.4414e+01     2.4414e+02             1.7279e-05        -0.613006152378

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 8.5770e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_001                -7.041340e-01 3 1  ON 0
ci_002                -7.024458e-01 3 1  ON 1
ci_003                -5.474633e-02 3 1  ON 2
ci_004                -5.519636e-02 3 1  ON 3
ci_005                 2.561252e-02 3 1  ON 4
ci_006                 2.564912e-02 3 1  ON 5
ci_007                 2.005946e-02 3 1  ON 6
ci_008                 2.045489e-02 3 1  ON 7
ci_009                -1.603731e-02 3 1  ON 8
ci_010                -1.582099e-02 3 1  ON 9
ci_011                -1.369996e-02 3 1  ON 10
ci_012                -1.340087e-02 3 1  ON 11
ci_013                 1.214097e-02 3 1  ON 12
ci_014                 1.200090e-02 3 1  ON 13
ci_015                 1.352304e-02 3 1  ON 14
ci_016                 1.328310e-02 3 1  ON 15
ci_017                 1.104960e-02 3 1  ON 16
ci_018                 1.112857e-02 3 1  ON 17
ci_019                 4.125429e-03 3 1  ON 18
ci_020                 4.398144e-03 3 1  ON 19
ci_021                -8.233639e-03 3 1  ON 20
ci_022                -8.398573e-03 3 1  ON 21
ci_023                 6.608152e-03 3 1  ON 22
ci_024                 6.609644e-03 3 1  ON 23
ci_025                 8.845967e-03 3 1  ON 24
ci_026                 8.814609e-03 3 1  ON 25
ci_027                 6.741000e-03 3 1  ON 26
ci_028                 6.808430e-03 3 1  ON 27
ci_029                -5.677037e-03 3 1  ON 28
ci_030                -5.664225e-03 3 1  ON 29
ci_031                -2.308597e-03 3 1  ON 30
ci_032                -2.618586e-03 3 1  ON 31
ci_033                 4.733010e-03 3 1  ON 32
ci_034                 4.599584e-03 3 1  ON 33
ci_035                 3.133851e-03 3 1  ON 34
ci_036                 3.285737e-03 3 1  ON 35
ci_037                 4.834202e-03 3 1  ON 36
ci_038                 4.725293e-03 3 1  ON 37
ci_039                 4.717915e-03 3 1  ON 38
ci_040                 4.748707e-03 3 1  ON 39
ci_041                 3.841469e-03 3 1  ON 40
ci_042                 3.771889e-03 3 1  ON 41
ci_043                 4.053970e-03 3 1  ON 42
ci_044                 4.061676e-03 3 1  ON 43
ci_045                 3.315684e-03 3 1  ON 44
ci_046                 3.419204e-03 3 1  ON 45
ci_047                -1.890854e-03 3 1  ON 46
ci_048                -1.999927e-03 3 1  ON 47
ci_049                 1.697766e-03 3 1  ON 48
ci_050                 1.682494e-03 3 1  ON 49
ci_051                -2.257358e-03 3 1  ON 50
ci_052                -2.136108e-03 3 1  ON 51
ci_053                -2.252566e-03 3 1  ON 52
ci_054                -2.445410e-03 3 1  ON 53
ci_055                -1.371929e-03 3 1  ON 54
ci_056                -1.575778e-03 3 1  ON 55
ci_057                -1.347720e-03 3 1  ON 56
ci_058                -1.454897e-03 3 1  ON 57
ci_059                -9.122374e-04 3 1  ON 58
ci_060                -8.331112e-04 3 1  ON 59
ci_061                -1.155432e-03 3 1  ON 60
ci_062                -7.437184e-04 3 1  ON 61
ci_063                -7.216040e-04 3 1  ON 62
ci_064                -8.564087e-04 3 1  ON 63
ci_065                -1.796354e-03 3 1  ON 64
ci_066                -2.054470e-03 3 1  ON 65
ci_067                -1.500922e-03 3 1  ON 66
ci_068                -1.087960e-03 3 1  ON 67
ci_069                 1.879442e-04 3 1  ON 68
ci_070                 1.776025e-04 3 1  ON 69
ci_071                -1.855629e-03 3 1  ON 70
ci_072                -1.728596e-03 3 1  ON 71
ci_073                 6.100872e-04 3 1  ON 72
ci_074                 4.987204e-04 3 1  ON 73
ci_075                -3.362475e-04 3 1  ON 74
ci_076                -3.382532e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4637e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.6311
    reference variance = 0.434577
====================================================
  Execution time = 5.1278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 4.9880e-01
  Total weights = 1.955168038e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487338150211
                                         uncertainty =       0.002458493825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487338150211
                                         uncertainty =       0.002458493825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493590108
  error estimate for blocks of size 2^( 2) =       0.000511988148
  error estimate for blocks of size 2^( 3) =       0.000528383903
  error estimate for blocks of size 2^( 4) =       0.000540170760
  error estimate for blocks of size 2^( 5) =       0.000547409472
  error estimate for blocks of size 2^( 6) =       0.000551025369
  error estimate for blocks of size 2^( 7) =       0.000551740250

      target function =      -0.610710755323
              le_mean =     -22.667164103163
             les_mean =     514.299130251958
             stat err =       0.000547586463
             autocorr =       1.230757558174
   target nu stat err =       0.000547586463
   target dn stat err =       0.003103371335
      target stat err =       0.000977260381
              std dev =       0.698041824780
             le_variance =       0.487262389142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266716410316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610712026128       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610746628920       residual = 7.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610750734438       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610751152844       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610751247422       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610751240471       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610751242288       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610751242209       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610751241716       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.733139e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610712026128       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610720839590       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610721876495       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610721981116       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610722004396       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610722002547       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610722002964       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610722002934       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610722002815       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 6.966582e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610712026128       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610714239906       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610714499795       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610714525950       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610714531746       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610714531277       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610714531379       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610714531371       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610714531341       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+01 is 1.750208e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.717357 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0754e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_001                -7.041409e-01 3 1  ON 0
ci_002                -7.024591e-01 3 1  ON 1
ci_003                -5.470250e-02 3 1  ON 2
ci_004                -5.516909e-02 3 1  ON 3
ci_005                 2.554829e-02 3 1  ON 4
ci_006                 2.557945e-02 3 1  ON 5
ci_007                 2.000938e-02 3 1  ON 6
ci_008                 2.040745e-02 3 1  ON 7
ci_009                -1.599961e-02 3 1  ON 8
ci_010                -1.578607e-02 3 1  ON 9
ci_011                -1.366997e-02 3 1  ON 10
ci_012                -1.335443e-02 3 1  ON 11
ci_013                 1.211063e-02 3 1  ON 12
ci_014                 1.196779e-02 3 1  ON 13
ci_015                 1.350115e-02 3 1  ON 14
ci_016                 1.325094e-02 3 1  ON 15
ci_017                 1.104383e-02 3 1  ON 16
ci_018                 1.111081e-02 3 1  ON 17
ci_019                 4.098128e-03 3 1  ON 18
ci_020                 4.378489e-03 3 1  ON 19
ci_021                -8.223889e-03 3 1  ON 20
ci_022                -8.397851e-03 3 1  ON 21
ci_023                 6.595655e-03 3 1  ON 22
ci_024                 6.595662e-03 3 1  ON 23
ci_025                 8.851475e-03 3 1  ON 24
ci_026                 8.826116e-03 3 1  ON 25
ci_027                 6.736771e-03 3 1  ON 26
ci_028                 6.810539e-03 3 1  ON 27
ci_029                -5.664661e-03 3 1  ON 28
ci_030                -5.653341e-03 3 1  ON 29
ci_031                -2.289523e-03 3 1  ON 30
ci_032                -2.594562e-03 3 1  ON 31
ci_033                 4.718722e-03 3 1  ON 32
ci_034                 4.587460e-03 3 1  ON 33
ci_035                 3.121438e-03 3 1  ON 34
ci_036                 3.268906e-03 3 1  ON 35
ci_037                 4.834190e-03 3 1  ON 36
ci_038                 4.724209e-03 3 1  ON 37
ci_039                 4.718753e-03 3 1  ON 38
ci_040                 4.746736e-03 3 1  ON 39
ci_041                 3.841134e-03 3 1  ON 40
ci_042                 3.768942e-03 3 1  ON 41
ci_043                 4.052033e-03 3 1  ON 42
ci_044                 4.062093e-03 3 1  ON 43
ci_045                 3.321127e-03 3 1  ON 44
ci_046                 3.413401e-03 3 1  ON 45
ci_047                -1.889243e-03 3 1  ON 46
ci_048                -1.997628e-03 3 1  ON 47
ci_049                 1.695589e-03 3 1  ON 48
ci_050                 1.677474e-03 3 1  ON 49
ci_051                -2.247748e-03 3 1  ON 50
ci_052                -2.131190e-03 3 1  ON 51
ci_053                -2.248269e-03 3 1  ON 52
ci_054                -2.437551e-03 3 1  ON 53
ci_055                -1.371163e-03 3 1  ON 54
ci_056                -1.576895e-03 3 1  ON 55
ci_057                -1.346599e-03 3 1  ON 56
ci_058                -1.451524e-03 3 1  ON 57
ci_059                -9.055936e-04 3 1  ON 58
ci_060                -8.213581e-04 3 1  ON 59
ci_061                -1.145156e-03 3 1  ON 60
ci_062                -7.350270e-04 3 1  ON 61
ci_063                -7.140589e-04 3 1  ON 62
ci_064                -8.473569e-04 3 1  ON 63
ci_065                -1.797696e-03 3 1  ON 64
ci_066                -2.060814e-03 3 1  ON 65
ci_067                -1.500757e-03 3 1  ON 66
ci_068                -1.102545e-03 3 1  ON 67
ci_069                 1.807845e-04 3 1  ON 68
ci_070                 1.763093e-04 3 1  ON 69
ci_071                -1.853836e-03 3 1  ON 70
ci_072                -1.728398e-03 3 1  ON 71
ci_073                 6.074165e-04 3 1  ON 72
ci_074                 4.929840e-04 3 1  ON 73
ci_075                -3.317050e-04 3 1  ON 74
ci_076                -3.332064e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.6644
    reference variance = 0.321495
====================================================
  Execution time = 5.0246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1365e-01
  Total weights = 1.9550e+06
  Execution time = 7.2112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497524001905
                                         uncertainty =       0.004966802848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497524001905
                                         uncertainty =       0.004966802848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498725280
  error estimate for blocks of size 2^( 2) =       0.000516684260
  error estimate for blocks of size 2^( 3) =       0.000533317008
  error estimate for blocks of size 2^( 4) =       0.000545283773
  error estimate for blocks of size 2^( 5) =       0.000553853058
  error estimate for blocks of size 2^( 6) =       0.000557480911
  error estimate for blocks of size 2^( 7) =       0.000560891616

      target function =      -0.606335078668
              le_mean =     -22.667689478279
             les_mean =     514.337926609406
             stat err =       0.000554377340
             autocorr =       1.235629235848
   target nu stat err =       0.000554377340
   target dn stat err =       0.006824833808
      target stat err =       0.002054303844
              std dev =       0.705304054215
             le_variance =       0.497453808892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497221555015
                                         uncertainty =       0.004932061920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497221555015
                                         uncertainty =       0.004932061920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498573821
  error estimate for blocks of size 2^( 2) =       0.000516531972
  error estimate for blocks of size 2^( 3) =       0.000533165813
  error estimate for blocks of size 2^( 4) =       0.000545132446
  error estimate for blocks of size 2^( 5) =       0.000553695513
  error estimate for blocks of size 2^( 6) =       0.000557327513
  error estimate for blocks of size 2^( 7) =       0.000560751461

      target function =      -0.606450765627
              le_mean =     -22.667692346144
             les_mean =     514.337671498980
             stat err =       0.000554226733
             autocorr =       1.235708398300
   target nu stat err =       0.000554226733
   target dn stat err =       0.006789434660
      target stat err =       0.002044604577
              std dev =       0.705089859786
             le_variance =       0.497151710373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497368341644
                                         uncertainty =       0.004948921257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497368341644
                                         uncertainty =       0.004948921257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498647335
  error estimate for blocks of size 2^( 2) =       0.000516605858
  error estimate for blocks of size 2^( 3) =       0.000533239146
  error estimate for blocks of size 2^( 4) =       0.000545205837
  error estimate for blocks of size 2^( 5) =       0.000553771970
  error estimate for blocks of size 2^( 6) =       0.000557401936
  error estimate for blocks of size 2^( 7) =       0.000560819392

      target function =      -0.606395198908
              le_mean =     -22.667690731413
             les_mean =     514.337783071563
             stat err =       0.000554299784
             autocorr =       1.235669747822
   target nu stat err =       0.000554299784
   target dn stat err =       0.006805699670
      target stat err =       0.002049045629
              std dev =       0.705193823396
             le_variance =       0.497298328555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497504252311
                                         uncertainty =       0.004964532506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497504252311
                                         uncertainty =       0.004964532506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498715391
  error estimate for blocks of size 2^( 2) =       0.000516674313
  error estimate for blocks of size 2^( 3) =       0.000533307123
  error estimate for blocks of size 2^( 4) =       0.000545273880
  error estimate for blocks of size 2^( 5) =       0.000553842770
  error estimate for blocks of size 2^( 6) =       0.000557470886
  error estimate for blocks of size 2^( 7) =       0.000560882438

      target function =      -0.606345951123
              le_mean =     -22.667689611253
             les_mean =     514.337896320470
             stat err =       0.000554367494
             autocorr =       1.235634344114
   target nu stat err =       0.000554367494
   target dn stat err =       0.006822229660
      target stat err =       0.002053606365
              std dev =       0.705290069562
             le_variance =       0.497434082222


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.606335078668        initial
     1.5259e+00     1.5259e+01             2.7331e-04        -0.606450765627  <--
     6.1035e+00     6.1035e+01             6.9666e-05        -0.606395198908
     2.4414e+01     2.4414e+02             1.7502e-05        -0.606345951123

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 8.6407e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_001                -7.041611e-01 3 1  ON 0
ci_002                -7.024982e-01 3 1  ON 1
ci_003                -5.457231e-02 3 1  ON 2
ci_004                -5.508821e-02 3 1  ON 3
ci_005                 2.536054e-02 3 1  ON 4
ci_006                 2.537581e-02 3 1  ON 5
ci_007                 1.986241e-02 3 1  ON 6
ci_008                 2.026827e-02 3 1  ON 7
ci_009                -1.588908e-02 3 1  ON 8
ci_010                -1.568372e-02 3 1  ON 9
ci_011                -1.358201e-02 3 1  ON 10
ci_012                -1.321816e-02 3 1  ON 11
ci_013                 1.202164e-02 3 1  ON 12
ci_014                 1.187072e-02 3 1  ON 13
ci_015                 1.343671e-02 3 1  ON 14
ci_016                 1.315627e-02 3 1  ON 15
ci_017                 1.102697e-02 3 1  ON 16
ci_018                 1.105867e-02 3 1  ON 17
ci_019                 4.017650e-03 3 1  ON 18
ci_020                 4.320530e-03 3 1  ON 19
ci_021                -8.195261e-03 3 1  ON 20
ci_022                -8.395795e-03 3 1  ON 21
ci_023                 6.559061e-03 3 1  ON 22
ci_024                 6.554752e-03 3 1  ON 23
ci_025                 8.867806e-03 3 1  ON 24
ci_026                 8.860071e-03 3 1  ON 25
ci_027                 6.724450e-03 3 1  ON 26
ci_028                 6.816725e-03 3 1  ON 27
ci_029                -5.628251e-03 3 1  ON 28
ci_030                -5.621330e-03 3 1  ON 29
ci_031                -2.233481e-03 3 1  ON 30
ci_032                -2.523972e-03 3 1  ON 31
ci_033                 4.676704e-03 3 1  ON 32
ci_034                 4.551843e-03 3 1  ON 33
ci_035                 3.085063e-03 3 1  ON 34
ci_036                 3.219692e-03 3 1  ON 35
ci_037                 4.834081e-03 3 1  ON 36
ci_038                 4.720931e-03 3 1  ON 37
ci_039                 4.721239e-03 3 1  ON 38
ci_040                 4.741021e-03 3 1  ON 39
ci_041                 3.840153e-03 3 1  ON 40
ci_042                 3.760335e-03 3 1  ON 41
ci_043                 4.046302e-03 3 1  ON 42
ci_044                 4.063162e-03 3 1  ON 43
ci_045                 3.337175e-03 3 1  ON 44
ci_046                 3.396430e-03 3 1  ON 45
ci_047                -1.884451e-03 3 1  ON 46
ci_048                -1.990861e-03 3 1  ON 47
ci_049                 1.689189e-03 3 1  ON 48
ci_050                 1.662757e-03 3 1  ON 49
ci_051                -2.219421e-03 3 1  ON 50
ci_052                -2.116585e-03 3 1  ON 51
ci_053                -2.235728e-03 3 1  ON 52
ci_054                -2.414593e-03 3 1  ON 53
ci_055                -1.368854e-03 3 1  ON 54
ci_056                -1.580178e-03 3 1  ON 55
ci_057                -1.343306e-03 3 1  ON 56
ci_058                -1.441619e-03 3 1  ON 57
ci_059                -8.861795e-04 3 1  ON 58
ci_060                -7.869989e-04 3 1  ON 59
ci_061                -1.114957e-03 3 1  ON 60
ci_062                -7.095562e-04 3 1  ON 61
ci_063                -6.919859e-04 3 1  ON 62
ci_064                -8.208529e-04 3 1  ON 63
ci_065                -1.801580e-03 3 1  ON 64
ci_066                -2.079391e-03 3 1  ON 65
ci_067                -1.500338e-03 3 1  ON 66
ci_068                -1.145361e-03 3 1  ON 67
ci_069                 1.597428e-04 3 1  ON 68
ci_070                 1.725105e-04 3 1  ON 69
ci_071                -1.848508e-03 3 1  ON 70
ci_072                -1.727720e-03 3 1  ON 71
ci_073                 5.995818e-04 3 1  ON 72
ci_074                 4.761798e-04 3 1  ON 73
ci_075                -3.183697e-04 3 1  ON 74
ci_076                -3.184080e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4717e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.7046
    reference variance = 0.531745
====================================================
  Execution time = 5.1106e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0095e-01
  Total weights = 1.955231454e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489773819418
                                         uncertainty =       0.002509789308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489773819418
                                         uncertainty =       0.002509789308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494905885
  error estimate for blocks of size 2^( 2) =       0.000513368810
  error estimate for blocks of size 2^( 3) =       0.000530194527
  error estimate for blocks of size 2^( 4) =       0.000543261531
  error estimate for blocks of size 2^( 5) =       0.000549717464
  error estimate for blocks of size 2^( 6) =       0.000554811465
  error estimate for blocks of size 2^( 7) =       0.000556638960

      target function =      -0.610599589362
              le_mean =     -22.669316594703
             les_mean =     514.398860874276
             stat err =       0.000551107355
             autocorr =       1.240015679996
   target nu stat err =       0.000551107355
   target dn stat err =       0.003368083983
      target stat err =       0.001056354727
              std dev =       0.699902615358
             le_variance =       0.489863670984


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266931659470e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610601100454       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610715391318       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610727875316       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610729165840       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610729868269       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610729886357       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610729924161       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610729939466       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610729942424       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 1.030251e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610601100454       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610631802496       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610635051249       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610635375768       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610635548622       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610635550374       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610635558690       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610635562186       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610635562831       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.773870e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610601100454       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610608921640       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610609742058       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610609823243       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610609866234       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610609866495       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610609868503       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610609869355       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610609869510       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 7.070677e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.721891 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0491e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_001                -7.042120e-01 3 1  ON 0
ci_002                -7.025172e-01 3 1  ON 1
ci_003                -5.446448e-02 3 1  ON 2
ci_004                -5.495394e-02 3 1  ON 3
ci_005                 2.508316e-02 3 1  ON 4
ci_006                 2.512655e-02 3 1  ON 5
ci_007                 1.975714e-02 3 1  ON 6
ci_008                 2.011151e-02 3 1  ON 7
ci_009                -1.576307e-02 3 1  ON 8
ci_010                -1.558615e-02 3 1  ON 9
ci_011                -1.341959e-02 3 1  ON 10
ci_012                -1.309854e-02 3 1  ON 11
ci_013                 1.187516e-02 3 1  ON 12
ci_014                 1.175603e-02 3 1  ON 13
ci_015                 1.334072e-02 3 1  ON 14
ci_016                 1.307395e-02 3 1  ON 15
ci_017                 1.094713e-02 3 1  ON 16
ci_018                 1.101545e-02 3 1  ON 17
ci_019                 3.952564e-03 3 1  ON 18
ci_020                 4.237861e-03 3 1  ON 19
ci_021                -8.178793e-03 3 1  ON 20
ci_022                -8.403227e-03 3 1  ON 21
ci_023                 6.504304e-03 3 1  ON 22
ci_024                 6.541367e-03 3 1  ON 23
ci_025                 8.903970e-03 3 1  ON 24
ci_026                 8.923770e-03 3 1  ON 25
ci_027                 6.709389e-03 3 1  ON 26
ci_028                 6.777280e-03 3 1  ON 27
ci_029                -5.584460e-03 3 1  ON 28
ci_030                -5.568843e-03 3 1  ON 29
ci_031                -2.180950e-03 3 1  ON 30
ci_032                -2.399546e-03 3 1  ON 31
ci_033                 4.647821e-03 3 1  ON 32
ci_034                 4.533363e-03 3 1  ON 33
ci_035                 3.045472e-03 3 1  ON 34
ci_036                 3.165779e-03 3 1  ON 35
ci_037                 4.781574e-03 3 1  ON 36
ci_038                 4.708853e-03 3 1  ON 37
ci_039                 4.699059e-03 3 1  ON 38
ci_040                 4.739883e-03 3 1  ON 39
ci_041                 3.818466e-03 3 1  ON 40
ci_042                 3.733241e-03 3 1  ON 41
ci_043                 4.052005e-03 3 1  ON 42
ci_044                 4.066576e-03 3 1  ON 43
ci_045                 3.282532e-03 3 1  ON 44
ci_046                 3.357544e-03 3 1  ON 45
ci_047                -1.857083e-03 3 1  ON 46
ci_048                -1.943631e-03 3 1  ON 47
ci_049                 1.662042e-03 3 1  ON 48
ci_050                 1.639480e-03 3 1  ON 49
ci_051                -2.228033e-03 3 1  ON 50
ci_052                -2.084897e-03 3 1  ON 51
ci_053                -2.258625e-03 3 1  ON 52
ci_054                -2.410827e-03 3 1  ON 53
ci_055                -1.358068e-03 3 1  ON 54
ci_056                -1.590262e-03 3 1  ON 55
ci_057                -1.375469e-03 3 1  ON 56
ci_058                -1.426623e-03 3 1  ON 57
ci_059                -8.771296e-04 3 1  ON 58
ci_060                -7.791445e-04 3 1  ON 59
ci_061                -1.105228e-03 3 1  ON 60
ci_062                -6.891352e-04 3 1  ON 61
ci_063                -7.065303e-04 3 1  ON 62
ci_064                -8.032962e-04 3 1  ON 63
ci_065                -1.787400e-03 3 1  ON 64
ci_066                -2.082139e-03 3 1  ON 65
ci_067                -1.511468e-03 3 1  ON 66
ci_068                -1.167126e-03 3 1  ON 67
ci_069                 1.101660e-04 3 1  ON 68
ci_070                 2.059888e-04 3 1  ON 69
ci_071                -1.885052e-03 3 1  ON 70
ci_072                -1.734237e-03 3 1  ON 71
ci_073                 5.957603e-04 3 1  ON 72
ci_074                 4.694756e-04 3 1  ON 73
ci_075                -3.197563e-04 3 1  ON 74
ci_076                -3.132059e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6669
    reference variance = 0.416949
====================================================
  Execution time = 4.9755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9519e-01
  Total weights = 1.9553e+06
  Execution time = 7.2224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485194148997
                                         uncertainty =       0.002213135091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485194148997
                                         uncertainty =       0.002213135091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492518675
  error estimate for blocks of size 2^( 2) =       0.000510957097
  error estimate for blocks of size 2^( 3) =       0.000527708600
  error estimate for blocks of size 2^( 4) =       0.000539337732
  error estimate for blocks of size 2^( 5) =       0.000545447898
  error estimate for blocks of size 2^( 6) =       0.000551396557
  error estimate for blocks of size 2^( 7) =       0.000552030376

      target function =      -0.611908367042
              le_mean =     -22.667965241106
             les_mean =     514.332164869672
             stat err =       0.000547053141
             autocorr =       1.233711538849
   target nu stat err =       0.000547053141
   target dn stat err =       0.002970499207
      target stat err =       0.000942776126
              std dev =       0.696526589728
             le_variance =       0.485149290198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484630829349
                                         uncertainty =       0.002220718507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484630829349
                                         uncertainty =       0.002220718507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492232777
  error estimate for blocks of size 2^( 2) =       0.000510671893
  error estimate for blocks of size 2^( 3) =       0.000527413931
  error estimate for blocks of size 2^( 4) =       0.000539038437
  error estimate for blocks of size 2^( 5) =       0.000545143412
  error estimate for blocks of size 2^( 6) =       0.000551065802
  error estimate for blocks of size 2^( 7) =       0.000551702970

      target function =      -0.612032905535
              le_mean =     -22.667969208805
             les_mean =     514.331938251081
             stat err =       0.000546737655
             autocorr =       1.233720874018
   target nu stat err =       0.000546737655
   target dn stat err =       0.003001021841
      target stat err =       0.000951992569
              std dev =       0.696122269327
             le_variance =       0.484586213852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484876023387
                                         uncertainty =       0.002216643459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484876023387
                                         uncertainty =       0.002216643459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492357236
  error estimate for blocks of size 2^( 2) =       0.000510795814
  error estimate for blocks of size 2^( 3) =       0.000527542246
  error estimate for blocks of size 2^( 4) =       0.000539168743
  error estimate for blocks of size 2^( 5) =       0.000545275925
  error estimate for blocks of size 2^( 6) =       0.000551210217
  error estimate for blocks of size 2^( 7) =       0.000551845818

      target function =      -0.612049903418
              le_mean =     -22.667964889016
             les_mean =     514.331682975035
             stat err =       0.000546875176
             autocorr =       1.233717627938
   target nu stat err =       0.000546875176
   target dn stat err =       0.002981954399
      target stat err =       0.000946504385
              std dev =       0.696298280775
             le_variance =       0.484831295810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485151561724
                                         uncertainty =       0.002213515978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485151561724
                                         uncertainty =       0.002213515978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492497067
  error estimate for blocks of size 2^( 2) =       0.000510935500
  error estimate for blocks of size 2^( 3) =       0.000527686420
  error estimate for blocks of size 2^( 4) =       0.000539315008
  error estimate for blocks of size 2^( 5) =       0.000545424717
  error estimate for blocks of size 2^( 6) =       0.000551371489
  error estimate for blocks of size 2^( 7) =       0.000552006070

      target function =      -0.611916779325
              le_mean =     -22.667965040244
             les_mean =     514.332127910397
             stat err =       0.000547029321
             autocorr =       1.233712357264
   target nu stat err =       0.000547029321
   target dn stat err =       0.002972669441
      target stat err =       0.000943429031
              std dev =       0.696496030931
             le_variance =       0.485106721102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611908367042        initial
     3.8147e-01     3.8147e+00             1.0303e-03        -0.612032905535
     1.5259e+00     1.5259e+01             2.7739e-04        -0.612049903418  <--
     6.1035e+00     6.1035e+01             7.0707e-05        -0.611916779325

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 8.5973e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_001                -7.042120e-01 3 1  ON 0
ci_002                -7.025172e-01 3 1  ON 1
ci_003                -5.446448e-02 3 1  ON 2
ci_004                -5.495394e-02 3 1  ON 3
ci_005                 2.508316e-02 3 1  ON 4
ci_006                 2.512655e-02 3 1  ON 5
ci_007                 1.975714e-02 3 1  ON 6
ci_008                 2.011151e-02 3 1  ON 7
ci_009                -1.576307e-02 3 1  ON 8
ci_010                -1.558615e-02 3 1  ON 9
ci_011                -1.341959e-02 3 1  ON 10
ci_012                -1.309854e-02 3 1  ON 11
ci_013                 1.187516e-02 3 1  ON 12
ci_014                 1.175603e-02 3 1  ON 13
ci_015                 1.334072e-02 3 1  ON 14
ci_016                 1.307395e-02 3 1  ON 15
ci_017                 1.094713e-02 3 1  ON 16
ci_018                 1.101545e-02 3 1  ON 17
ci_019                 3.952564e-03 3 1  ON 18
ci_020                 4.237861e-03 3 1  ON 19
ci_021                -8.178793e-03 3 1  ON 20
ci_022                -8.403227e-03 3 1  ON 21
ci_023                 6.504304e-03 3 1  ON 22
ci_024                 6.541367e-03 3 1  ON 23
ci_025                 8.903970e-03 3 1  ON 24
ci_026                 8.923770e-03 3 1  ON 25
ci_027                 6.709389e-03 3 1  ON 26
ci_028                 6.777280e-03 3 1  ON 27
ci_029                -5.584460e-03 3 1  ON 28
ci_030                -5.568843e-03 3 1  ON 29
ci_031                -2.180950e-03 3 1  ON 30
ci_032                -2.399546e-03 3 1  ON 31
ci_033                 4.647821e-03 3 1  ON 32
ci_034                 4.533363e-03 3 1  ON 33
ci_035                 3.045472e-03 3 1  ON 34
ci_036                 3.165779e-03 3 1  ON 35
ci_037                 4.781574e-03 3 1  ON 36
ci_038                 4.708853e-03 3 1  ON 37
ci_039                 4.699059e-03 3 1  ON 38
ci_040                 4.739883e-03 3 1  ON 39
ci_041                 3.818466e-03 3 1  ON 40
ci_042                 3.733241e-03 3 1  ON 41
ci_043                 4.052005e-03 3 1  ON 42
ci_044                 4.066576e-03 3 1  ON 43
ci_045                 3.282532e-03 3 1  ON 44
ci_046                 3.357544e-03 3 1  ON 45
ci_047                -1.857083e-03 3 1  ON 46
ci_048                -1.943631e-03 3 1  ON 47
ci_049                 1.662042e-03 3 1  ON 48
ci_050                 1.639480e-03 3 1  ON 49
ci_051                -2.228033e-03 3 1  ON 50
ci_052                -2.084897e-03 3 1  ON 51
ci_053                -2.258625e-03 3 1  ON 52
ci_054                -2.410827e-03 3 1  ON 53
ci_055                -1.358068e-03 3 1  ON 54
ci_056                -1.590262e-03 3 1  ON 55
ci_057                -1.375469e-03 3 1  ON 56
ci_058                -1.426623e-03 3 1  ON 57
ci_059                -8.771296e-04 3 1  ON 58
ci_060                -7.791445e-04 3 1  ON 59
ci_061                -1.105228e-03 3 1  ON 60
ci_062                -6.891352e-04 3 1  ON 61
ci_063                -7.065303e-04 3 1  ON 62
ci_064                -8.032962e-04 3 1  ON 63
ci_065                -1.787400e-03 3 1  ON 64
ci_066                -2.082139e-03 3 1  ON 65
ci_067                -1.511468e-03 3 1  ON 66
ci_068                -1.167126e-03 3 1  ON 67
ci_069                 1.101660e-04 3 1  ON 68
ci_070                 2.059888e-04 3 1  ON 69
ci_071                -1.885052e-03 3 1  ON 70
ci_072                -1.734237e-03 3 1  ON 71
ci_073                 5.957603e-04 3 1  ON 72
ci_074                 4.694756e-04 3 1  ON 73
ci_075                -3.197563e-04 3 1  ON 74
ci_076                -3.132059e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4647e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7188
    reference variance = 0.416822
====================================================
  Execution time = 5.1088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0380e-01
  Total weights = 1.954961849e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489072840105
                                         uncertainty =       0.003223745611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489072840105
                                         uncertainty =       0.003223745611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494550111
  error estimate for blocks of size 2^( 2) =       0.000513012060
  error estimate for blocks of size 2^( 3) =       0.000529722535
  error estimate for blocks of size 2^( 4) =       0.000541517256
  error estimate for blocks of size 2^( 5) =       0.000550084274
  error estimate for blocks of size 2^( 6) =       0.000552485956
  error estimate for blocks of size 2^( 7) =       0.000551270277

      target function =      -0.609392035938
              le_mean =     -22.667934081150
             les_mean =     514.339033222598
             stat err =       0.000548839441
             autocorr =       1.231600961686
   target nu stat err =       0.000548839441
   target dn stat err =       0.004831001122
      target stat err =       0.001481214332
              std dev =       0.699399473876
             le_variance =       0.489159624058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266793408115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609395377778       residual = 7.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609515726770       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609528778826       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609529828302       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609530174087       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609530096294       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609530133583       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609530140363       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609530136060       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 9.197666e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609395377778       residual = 7.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609427698125       residual = 6.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609431086541       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609431348872       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609431434022       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609431413157       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609431421724       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609431423197       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609431422240       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.476294e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609395377778       residual = 7.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609403610583       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609404465699       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609404531218       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609404552402       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609404547100       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609404549192       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609404549546       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609404549315       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 6.312071e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.726327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0378e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_001                -7.042629e-01 3 1  ON 0
ci_002                -7.025380e-01 3 1  ON 1
ci_003                -5.434460e-02 3 1  ON 2
ci_004                -5.484621e-02 3 1  ON 3
ci_005                 2.483553e-02 3 1  ON 4
ci_006                 2.489086e-02 3 1  ON 5
ci_007                 1.959918e-02 3 1  ON 6
ci_008                 1.996292e-02 3 1  ON 7
ci_009                -1.561572e-02 3 1  ON 8
ci_010                -1.548436e-02 3 1  ON 9
ci_011                -1.331811e-02 3 1  ON 10
ci_012                -1.292112e-02 3 1  ON 11
ci_013                 1.174266e-02 3 1  ON 12
ci_014                 1.163379e-02 3 1  ON 13
ci_015                 1.324262e-02 3 1  ON 14
ci_016                 1.298919e-02 3 1  ON 15
ci_017                 1.089716e-02 3 1  ON 16
ci_018                 1.096303e-02 3 1  ON 17
ci_019                 3.898561e-03 3 1  ON 18
ci_020                 4.120230e-03 3 1  ON 19
ci_021                -8.176299e-03 3 1  ON 20
ci_022                -8.357843e-03 3 1  ON 21
ci_023                 6.471355e-03 3 1  ON 22
ci_024                 6.505953e-03 3 1  ON 23
ci_025                 8.871531e-03 3 1  ON 24
ci_026                 8.939361e-03 3 1  ON 25
ci_027                 6.694937e-03 3 1  ON 26
ci_028                 6.734167e-03 3 1  ON 27
ci_029                -5.532095e-03 3 1  ON 28
ci_030                -5.519709e-03 3 1  ON 29
ci_031                -2.066539e-03 3 1  ON 30
ci_032                -2.326918e-03 3 1  ON 31
ci_033                 4.614108e-03 3 1  ON 32
ci_034                 4.485181e-03 3 1  ON 33
ci_035                 2.982492e-03 3 1  ON 34
ci_036                 3.101714e-03 3 1  ON 35
ci_037                 4.758167e-03 3 1  ON 36
ci_038                 4.657669e-03 3 1  ON 37
ci_039                 4.647503e-03 3 1  ON 38
ci_040                 4.734728e-03 3 1  ON 39
ci_041                 3.769178e-03 3 1  ON 40
ci_042                 3.716212e-03 3 1  ON 41
ci_043                 3.997412e-03 3 1  ON 42
ci_044                 4.012866e-03 3 1  ON 43
ci_045                 3.279014e-03 3 1  ON 44
ci_046                 3.345064e-03 3 1  ON 45
ci_047                -1.809675e-03 3 1  ON 46
ci_048                -1.918997e-03 3 1  ON 47
ci_049                 1.658837e-03 3 1  ON 48
ci_050                 1.652446e-03 3 1  ON 49
ci_051                -2.229743e-03 3 1  ON 50
ci_052                -2.064297e-03 3 1  ON 51
ci_053                -2.292988e-03 3 1  ON 52
ci_054                -2.465787e-03 3 1  ON 53
ci_055                -1.340697e-03 3 1  ON 54
ci_056                -1.587824e-03 3 1  ON 55
ci_057                -1.243145e-03 3 1  ON 56
ci_058                -1.411041e-03 3 1  ON 57
ci_059                -8.496686e-04 3 1  ON 58
ci_060                -7.729138e-04 3 1  ON 59
ci_061                -1.060373e-03 3 1  ON 60
ci_062                -7.202667e-04 3 1  ON 61
ci_063                -6.227032e-04 3 1  ON 62
ci_064                -8.013077e-04 3 1  ON 63
ci_065                -1.759209e-03 3 1  ON 64
ci_066                -2.095668e-03 3 1  ON 65
ci_067                -1.498741e-03 3 1  ON 66
ci_068                -1.120304e-03 3 1  ON 67
ci_069                 9.534437e-05 3 1  ON 68
ci_070                 2.171439e-04 3 1  ON 69
ci_071                -1.885641e-03 3 1  ON 70
ci_072                -1.763562e-03 3 1  ON 71
ci_073                 5.902078e-04 3 1  ON 72
ci_074                 4.560816e-04 3 1  ON 73
ci_075                -3.183106e-04 3 1  ON 74
ci_076                -3.265340e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7045
    reference variance = 0.526045
====================================================
  Execution time = 5.0205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9616e-01
  Total weights = 1.9549e+06
  Execution time = 7.2537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483465056534
                                         uncertainty =       0.002384822671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483465056534
                                         uncertainty =       0.002384822671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491673000
  error estimate for blocks of size 2^( 2) =       0.000509607261
  error estimate for blocks of size 2^( 3) =       0.000526282382
  error estimate for blocks of size 2^( 4) =       0.000538693901
  error estimate for blocks of size 2^( 5) =       0.000545370567
  error estimate for blocks of size 2^( 6) =       0.000547049137
  error estimate for blocks of size 2^( 7) =       0.000548158387

      target function =      -0.611335728967
              le_mean =     -22.668228430702
             les_mean =     514.346199669401
             stat err =       0.000544817998
             autocorr =       1.227863730992
   target nu stat err =       0.000544817998
   target dn stat err =       0.003338268256
      target stat err =       0.001048336925
              std dev =       0.695330625276
             le_variance =       0.483484678446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482817363215
                                         uncertainty =       0.002370138750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482817363215
                                         uncertainty =       0.002370138750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491343904
  error estimate for blocks of size 2^( 2) =       0.000509278197
  error estimate for blocks of size 2^( 3) =       0.000525941048
  error estimate for blocks of size 2^( 4) =       0.000538351477
  error estimate for blocks of size 2^( 5) =       0.000545015140
  error estimate for blocks of size 2^( 6) =       0.000546683858
  error estimate for blocks of size 2^( 7) =       0.000547775549

      target function =      -0.610997339395
              le_mean =     -22.668246278402
             les_mean =     514.348138222121
             stat err =       0.000544456506
             autocorr =       1.227878058327
   target nu stat err =       0.000544456506
   target dn stat err =       0.003696587370
      target stat err =       0.001152450453
              std dev =       0.694865213080
             le_variance =       0.482837664348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483100290460
                                         uncertainty =       0.002376525492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483100290460
                                         uncertainty =       0.002376525492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491487686
  error estimate for blocks of size 2^( 2) =       0.000509421769
  error estimate for blocks of size 2^( 3) =       0.000526090021
  error estimate for blocks of size 2^( 4) =       0.000538499582
  error estimate for blocks of size 2^( 5) =       0.000545170184
  error estimate for blocks of size 2^( 6) =       0.000546843749
  error estimate for blocks of size 2^( 7) =       0.000547941138

      target function =      -0.611745241825
              le_mean =     -22.668234587402
             les_mean =     514.345135495098
             stat err =       0.000544613663
             autocorr =       1.227868286254
   target nu stat err =       0.000544613663
   target dn stat err =       0.003213438346
      target stat err =       0.001013076267
              std dev =       0.695068551622
             le_variance =       0.483120291454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483416491928
                                         uncertainty =       0.002383721431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483416491928
                                         uncertainty =       0.002383721431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491648331
  error estimate for blocks of size 2^( 2) =       0.000509582545
  error estimate for blocks of size 2^( 3) =       0.000526256409
  error estimate for blocks of size 2^( 4) =       0.000538667718
  error estimate for blocks of size 2^( 5) =       0.000545343091
  error estimate for blocks of size 2^( 6) =       0.000547019715
  error estimate for blocks of size 2^( 7) =       0.000548129241

      target function =      -0.611310467928
              le_mean =     -22.668228585476
             les_mean =     514.346289707217
             stat err =       0.000544789942
             autocorr =       1.227860483312
   target nu stat err =       0.000544789942
   target dn stat err =       0.003447861490
      target stat err =       0.001080407920
              std dev =       0.695295737832
             le_variance =       0.483436163047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611335728967        initial
     3.8147e-01     3.8147e+00             9.1977e-04        -0.610997339395
     1.5259e+00     1.5259e+01             2.4763e-04        -0.611745241825  <--
     6.1035e+00     6.1035e+01             6.3121e-05        -0.611310467928

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 8.6571e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_001                -7.042629e-01 3 1  ON 0
ci_002                -7.025380e-01 3 1  ON 1
ci_003                -5.434460e-02 3 1  ON 2
ci_004                -5.484621e-02 3 1  ON 3
ci_005                 2.483553e-02 3 1  ON 4
ci_006                 2.489086e-02 3 1  ON 5
ci_007                 1.959918e-02 3 1  ON 6
ci_008                 1.996292e-02 3 1  ON 7
ci_009                -1.561572e-02 3 1  ON 8
ci_010                -1.548436e-02 3 1  ON 9
ci_011                -1.331811e-02 3 1  ON 10
ci_012                -1.292112e-02 3 1  ON 11
ci_013                 1.174266e-02 3 1  ON 12
ci_014                 1.163379e-02 3 1  ON 13
ci_015                 1.324262e-02 3 1  ON 14
ci_016                 1.298919e-02 3 1  ON 15
ci_017                 1.089716e-02 3 1  ON 16
ci_018                 1.096303e-02 3 1  ON 17
ci_019                 3.898561e-03 3 1  ON 18
ci_020                 4.120230e-03 3 1  ON 19
ci_021                -8.176299e-03 3 1  ON 20
ci_022                -8.357843e-03 3 1  ON 21
ci_023                 6.471355e-03 3 1  ON 22
ci_024                 6.505953e-03 3 1  ON 23
ci_025                 8.871531e-03 3 1  ON 24
ci_026                 8.939361e-03 3 1  ON 25
ci_027                 6.694937e-03 3 1  ON 26
ci_028                 6.734167e-03 3 1  ON 27
ci_029                -5.532095e-03 3 1  ON 28
ci_030                -5.519709e-03 3 1  ON 29
ci_031                -2.066539e-03 3 1  ON 30
ci_032                -2.326918e-03 3 1  ON 31
ci_033                 4.614108e-03 3 1  ON 32
ci_034                 4.485181e-03 3 1  ON 33
ci_035                 2.982492e-03 3 1  ON 34
ci_036                 3.101714e-03 3 1  ON 35
ci_037                 4.758167e-03 3 1  ON 36
ci_038                 4.657669e-03 3 1  ON 37
ci_039                 4.647503e-03 3 1  ON 38
ci_040                 4.734728e-03 3 1  ON 39
ci_041                 3.769178e-03 3 1  ON 40
ci_042                 3.716212e-03 3 1  ON 41
ci_043                 3.997412e-03 3 1  ON 42
ci_044                 4.012866e-03 3 1  ON 43
ci_045                 3.279014e-03 3 1  ON 44
ci_046                 3.345064e-03 3 1  ON 45
ci_047                -1.809675e-03 3 1  ON 46
ci_048                -1.918997e-03 3 1  ON 47
ci_049                 1.658837e-03 3 1  ON 48
ci_050                 1.652446e-03 3 1  ON 49
ci_051                -2.229743e-03 3 1  ON 50
ci_052                -2.064297e-03 3 1  ON 51
ci_053                -2.292988e-03 3 1  ON 52
ci_054                -2.465787e-03 3 1  ON 53
ci_055                -1.340697e-03 3 1  ON 54
ci_056                -1.587824e-03 3 1  ON 55
ci_057                -1.243145e-03 3 1  ON 56
ci_058                -1.411041e-03 3 1  ON 57
ci_059                -8.496686e-04 3 1  ON 58
ci_060                -7.729138e-04 3 1  ON 59
ci_061                -1.060373e-03 3 1  ON 60
ci_062                -7.202667e-04 3 1  ON 61
ci_063                -6.227032e-04 3 1  ON 62
ci_064                -8.013077e-04 3 1  ON 63
ci_065                -1.759209e-03 3 1  ON 64
ci_066                -2.095668e-03 3 1  ON 65
ci_067                -1.498741e-03 3 1  ON 66
ci_068                -1.120304e-03 3 1  ON 67
ci_069                 9.534437e-05 3 1  ON 68
ci_070                 2.171439e-04 3 1  ON 69
ci_071                -1.885641e-03 3 1  ON 70
ci_072                -1.763562e-03 3 1  ON 71
ci_073                 5.902078e-04 3 1  ON 72
ci_074                 4.560816e-04 3 1  ON 73
ci_075                -3.183106e-04 3 1  ON 74
ci_076                -3.265340e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4696e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.705
    reference variance = 0.303557
====================================================
  Execution time = 5.1271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 4.9485e-01
  Total weights = 1.954955268e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483415167607
                                         uncertainty =       0.002235618909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483415167607
                                         uncertainty =       0.002235618909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491694087
  error estimate for blocks of size 2^( 2) =       0.000510380646
  error estimate for blocks of size 2^( 3) =       0.000527510167
  error estimate for blocks of size 2^( 4) =       0.000540388666
  error estimate for blocks of size 2^( 5) =       0.000549399628
  error estimate for blocks of size 2^( 6) =       0.000554464261
  error estimate for blocks of size 2^( 7) =       0.000558139955

      target function =      -0.611932332901
              le_mean =     -22.667259963336
             les_mean =     514.299526549473
             stat err =       0.000550598127
             autocorr =       1.253947887270
   target nu stat err =       0.000550598127
   target dn stat err =       0.002868842877
      target stat err =       0.000913306364
              std dev =       0.695360446858
             le_variance =       0.483526151055


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266725996334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611933405820       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612033211945       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612043783992       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612045034574       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612045381055       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612045533566       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612045552947       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612045564132       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612045563197       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612045575204       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 9.002703e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611933405820       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611960210422       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611962960368       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611963276980       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611963360502       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611963396065       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611963399766       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611963402114       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611963401880       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611963404480       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.423072e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611933405820       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611940233712       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611940928077       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611941007435       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611941028089       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611941036807       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611941037661       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611941038220       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611941038162       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611941038787       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 6.175944e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.731460 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0702e+01
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_001                -7.042580e-01 3 1  ON 0
ci_002                -7.026090e-01 3 1  ON 1
ci_003                -5.423747e-02 3 1  ON 2
ci_004                -5.472781e-02 3 1  ON 3
ci_005                 2.459322e-02 3 1  ON 4
ci_006                 2.465060e-02 3 1  ON 5
ci_007                 1.944206e-02 3 1  ON 6
ci_008                 1.980046e-02 3 1  ON 7
ci_009                -1.552996e-02 3 1  ON 8
ci_010                -1.536021e-02 3 1  ON 9
ci_011                -1.319735e-02 3 1  ON 10
ci_012                -1.279904e-02 3 1  ON 11
ci_013                 1.166029e-02 3 1  ON 12
ci_014                 1.152739e-02 3 1  ON 13
ci_015                 1.316155e-02 3 1  ON 14
ci_016                 1.289063e-02 3 1  ON 15
ci_017                 1.083979e-02 3 1  ON 16
ci_018                 1.088427e-02 3 1  ON 17
ci_019                 3.815787e-03 3 1  ON 18
ci_020                 4.013682e-03 3 1  ON 19
ci_021                -8.175862e-03 3 1  ON 20
ci_022                -8.348440e-03 3 1  ON 21
ci_023                 6.441442e-03 3 1  ON 22
ci_024                 6.499267e-03 3 1  ON 23
ci_025                 8.911886e-03 3 1  ON 24
ci_026                 8.919233e-03 3 1  ON 25
ci_027                 6.684214e-03 3 1  ON 26
ci_028                 6.743415e-03 3 1  ON 27
ci_029                -5.484756e-03 3 1  ON 28
ci_030                -5.464054e-03 3 1  ON 29
ci_031                -2.030467e-03 3 1  ON 30
ci_032                -2.232648e-03 3 1  ON 31
ci_033                 4.557076e-03 3 1  ON 32
ci_034                 4.448218e-03 3 1  ON 33
ci_035                 2.939254e-03 3 1  ON 34
ci_036                 3.041269e-03 3 1  ON 35
ci_037                 4.754380e-03 3 1  ON 36
ci_038                 4.645936e-03 3 1  ON 37
ci_039                 4.634843e-03 3 1  ON 38
ci_040                 4.737174e-03 3 1  ON 39
ci_041                 3.762607e-03 3 1  ON 40
ci_042                 3.687800e-03 3 1  ON 41
ci_043                 3.974184e-03 3 1  ON 42
ci_044                 4.027996e-03 3 1  ON 43
ci_045                 3.254951e-03 3 1  ON 44
ci_046                 3.326770e-03 3 1  ON 45
ci_047                -1.775615e-03 3 1  ON 46
ci_048                -1.879000e-03 3 1  ON 47
ci_049                 1.612896e-03 3 1  ON 48
ci_050                 1.616800e-03 3 1  ON 49
ci_051                -2.227259e-03 3 1  ON 50
ci_052                -2.061255e-03 3 1  ON 51
ci_053                -2.295239e-03 3 1  ON 52
ci_054                -2.466421e-03 3 1  ON 53
ci_055                -1.297705e-03 3 1  ON 54
ci_056                -1.601705e-03 3 1  ON 55
ci_057                -1.246184e-03 3 1  ON 56
ci_058                -1.411078e-03 3 1  ON 57
ci_059                -8.515407e-04 3 1  ON 58
ci_060                -7.411100e-04 3 1  ON 59
ci_061                -1.065511e-03 3 1  ON 60
ci_062                -7.232664e-04 3 1  ON 61
ci_063                -6.107270e-04 3 1  ON 62
ci_064                -8.112271e-04 3 1  ON 63
ci_065                -1.809210e-03 3 1  ON 64
ci_066                -2.097152e-03 3 1  ON 65
ci_067                -1.492218e-03 3 1  ON 66
ci_068                -1.112290e-03 3 1  ON 67
ci_069                 6.278913e-05 3 1  ON 68
ci_070                 2.174134e-04 3 1  ON 69
ci_071                -1.883984e-03 3 1  ON 70
ci_072                -1.744587e-03 3 1  ON 71
ci_073                 5.706551e-04 3 1  ON 72
ci_074                 4.540991e-04 3 1  ON 73
ci_075                -3.013767e-04 3 1  ON 74
ci_076                -2.756091e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.5924
    reference variance = 0.504416
====================================================
  Execution time = 4.9747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9945e-01
  Total weights = 1.9554e+06
  Execution time = 7.2257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486465577614
                                         uncertainty =       0.002441275310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486465577614
                                         uncertainty =       0.002441275310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493333617
  error estimate for blocks of size 2^( 2) =       0.000512114863
  error estimate for blocks of size 2^( 3) =       0.000529245897
  error estimate for blocks of size 2^( 4) =       0.000540855446
  error estimate for blocks of size 2^( 5) =       0.000546524076
  error estimate for blocks of size 2^( 6) =       0.000552390307
  error estimate for blocks of size 2^( 7) =       0.000556223713

      target function =      -0.610668624464
              le_mean =     -22.668002637123
             les_mean =     514.337977435989
             stat err =       0.000548998385
             autocorr =       1.238399343184
   target nu stat err =       0.000548998385
   target dn stat err =       0.003372822057
      target stat err =       0.001056574427
              std dev =       0.697679092365
             le_variance =       0.486756115924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485736758722
                                         uncertainty =       0.002430765057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485736758722
                                         uncertainty =       0.002430765057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492963981
  error estimate for blocks of size 2^( 2) =       0.000511748741
  error estimate for blocks of size 2^( 3) =       0.000528879914
  error estimate for blocks of size 2^( 4) =       0.000540483199
  error estimate for blocks of size 2^( 5) =       0.000546142379
  error estimate for blocks of size 2^( 6) =       0.000551995376
  error estimate for blocks of size 2^( 7) =       0.000555822823

      target function =      -0.610854874436
              le_mean =     -22.668000238551
             les_mean =     514.337251457013
             stat err =       0.000548610944
             autocorr =       1.238507266005
   target nu stat err =       0.000548610944
   target dn stat err =       0.003411147280
      target stat err =       0.001068367365
              std dev =       0.697156347016
             le_variance =       0.486026972184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486061291060
                                         uncertainty =       0.002435480759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486061291060
                                         uncertainty =       0.002435480759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493128616
  error estimate for blocks of size 2^( 2) =       0.000511911032
  error estimate for blocks of size 2^( 3) =       0.000529041426
  error estimate for blocks of size 2^( 4) =       0.000540647115
  error estimate for blocks of size 2^( 5) =       0.000546310123
  error estimate for blocks of size 2^( 6) =       0.000552168998
  error estimate for blocks of size 2^( 7) =       0.000555997398

      target function =      -0.610391043678
              le_mean =     -22.667998686264
             les_mean =     514.338711754452
             stat err =       0.000548780909
             autocorr =       1.238447438371
   target nu stat err =       0.000548780909
   target dn stat err =       0.003590195174
      target stat err =       0.001119262666
              std dev =       0.697389176164
             le_variance =       0.486351663031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486412262752
                                         uncertainty =       0.002440511689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486412262752
                                         uncertainty =       0.002440511689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493306589
  error estimate for blocks of size 2^( 2) =       0.000512088025
  error estimate for blocks of size 2^( 3) =       0.000529218918
  error estimate for blocks of size 2^( 4) =       0.000540827936
  error estimate for blocks of size 2^( 5) =       0.000546496027
  error estimate for blocks of size 2^( 6) =       0.000552361379
  error estimate for blocks of size 2^( 7) =       0.000556194092

      target function =      -0.610605434003
              le_mean =     -22.668001792450
             les_mean =     514.338147186312
             stat err =       0.000548969858
             autocorr =       1.238406343023
   target nu stat err =       0.000548969858
   target dn stat err =       0.003384698955
      target stat err =       0.001059832125
              std dev =       0.697640867972
             le_variance =       0.486702780665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610668624464        initial
     3.8147e-01     3.8147e+00             9.0027e-04        -0.610854874436  <--
     1.5259e+00     1.5259e+01             2.4231e-04        -0.610391043678
     6.1035e+00     6.1035e+01             6.1759e-05        -0.610605434003

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 8.6024e+01
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_001                -7.042368e-01 3 1  ON 0
ci_002                -7.028136e-01 3 1  ON 1
ci_003                -5.392857e-02 3 1  ON 2
ci_004                -5.438693e-02 3 1  ON 3
ci_005                 2.393526e-02 3 1  ON 4
ci_006                 2.399866e-02 3 1  ON 5
ci_007                 1.900908e-02 3 1  ON 6
ci_008                 1.935311e-02 3 1  ON 7
ci_009                -1.529520e-02 3 1  ON 8
ci_010                -1.501942e-02 3 1  ON 9
ci_011                -1.286441e-02 3 1  ON 10
ci_012                -1.246240e-02 3 1  ON 11
ci_013                 1.143409e-02 3 1  ON 12
ci_014                 1.123455e-02 3 1  ON 13
ci_015                 1.293633e-02 3 1  ON 14
ci_016                 1.261700e-02 3 1  ON 15
ci_017                 1.068230e-02 3 1  ON 16
ci_018                 1.066709e-02 3 1  ON 17
ci_019                 3.584324e-03 3 1  ON 18
ci_020                 3.716409e-03 3 1  ON 19
ci_021                -8.174554e-03 3 1  ON 20
ci_022                -8.323195e-03 3 1  ON 21
ci_023                 6.359579e-03 3 1  ON 22
ci_024                 6.481158e-03 3 1  ON 23
ci_025                 9.025236e-03 3 1  ON 24
ci_026                 8.865141e-03 3 1  ON 25
ci_027                 6.655628e-03 3 1  ON 26
ci_028                 6.768827e-03 3 1  ON 27
ci_029                -5.352917e-03 3 1  ON 28
ci_030                -5.309655e-03 3 1  ON 29
ci_031                -1.930842e-03 3 1  ON 30
ci_032                -1.971510e-03 3 1  ON 31
ci_033                 4.399423e-03 3 1  ON 32
ci_034                 4.346799e-03 3 1  ON 33
ci_035                 2.821446e-03 3 1  ON 34
ci_036                 2.876745e-03 3 1  ON 35
ci_037                 4.743294e-03 3 1  ON 36
ci_038                 4.612419e-03 3 1  ON 37
ci_039                 4.600850e-03 3 1  ON 38
ci_040                 4.744083e-03 3 1  ON 39
ci_041                 3.744730e-03 3 1  ON 40
ci_042                 3.610634e-03 3 1  ON 41
ci_043                 3.909015e-03 3 1  ON 42
ci_044                 4.068493e-03 3 1  ON 43
ci_045                 3.189629e-03 3 1  ON 44
ci_046                 3.276824e-03 3 1  ON 45
ci_047                -1.682528e-03 3 1  ON 46
ci_048                -1.769855e-03 3 1  ON 47
ci_049                 1.486637e-03 3 1  ON 48
ci_050                 1.518858e-03 3 1  ON 49
ci_051                -2.218822e-03 3 1  ON 50
ci_052                -2.051635e-03 3 1  ON 51
ci_053                -2.302692e-03 3 1  ON 52
ci_054                -2.469581e-03 3 1  ON 53
ci_055                -1.178923e-03 3 1  ON 54
ci_056                -1.640348e-03 3 1  ON 55
ci_057                -1.254518e-03 3 1  ON 56
ci_058                -1.410871e-03 3 1  ON 57
ci_059                -8.564424e-04 3 1  ON 58
ci_060                -6.548991e-04 3 1  ON 59
ci_061                -1.079160e-03 3 1  ON 60
ci_062                -7.317935e-04 3 1  ON 61
ci_063                -5.779669e-04 3 1  ON 62
ci_064                -8.396584e-04 3 1  ON 63
ci_065                -1.946463e-03 3 1  ON 64
ci_066                -2.100986e-03 3 1  ON 65
ci_067                -1.474984e-03 3 1  ON 66
ci_068                -1.090299e-03 3 1  ON 67
ci_069                -2.685889e-05 3 1  ON 68
ci_070                 2.180149e-04 3 1  ON 69
ci_071                -1.878264e-03 3 1  ON 70
ci_072                -1.691356e-03 3 1  ON 71
ci_073                 5.172801e-04 3 1  ON 72
ci_074                 4.487605e-04 3 1  ON 73
ci_075                -2.546306e-04 3 1  ON 74
ci_076                -1.358127e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4673e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.6221
    reference variance = 0.359274
====================================================
  Execution time = 5.1224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2142e-01
  Total weights = 1.954946811e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489345014524
                                         uncertainty =       0.005965675387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489345014524
                                         uncertainty =       0.005965675387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494717987
  error estimate for blocks of size 2^( 2) =       0.000512835220
  error estimate for blocks of size 2^( 3) =       0.000529872121
  error estimate for blocks of size 2^( 4) =       0.000543068562
  error estimate for blocks of size 2^( 5) =       0.000549185462
  error estimate for blocks of size 2^( 6) =       0.000553587520
  error estimate for blocks of size 2^( 7) =       0.000557450301

      target function =      -0.604295758535
              le_mean =     -22.668989549248
             les_mean =     514.404504516021
             stat err =       0.000550822961
             autocorr =       1.239677361827
   target nu stat err =       0.000550822961
   target dn stat err =       0.024600750589
      target stat err =       0.007303759681
              std dev =       0.699636886280
             le_variance =       0.489491772643


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266898954925e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.604383338395       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.604939436430       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.605021501995       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.605034084781       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.605038473563       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.605043469045       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.605046143711       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.605046894282       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.605047128990       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.605047375973       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.605047410440       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.605047395163       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 4.931199e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.604383338395       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.604560027273       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.604583877997       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.604587209653       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.604587984280       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.604589062830       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.604589573778       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.604589703455       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.604589724594       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.604589757472       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.604589761328       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 1.538326e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.604383338395       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.604430715564       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.604436915131       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.604437755043       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.604437921839       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.604438176588       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.604438293596       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.604438322226       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.604438325677       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.604438332506       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.604438333217       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 4.100052e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.737854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0630e+01
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_001                -7.052943e-01 3 1  ON 0
ci_002                -7.019320e-01 3 1  ON 1
ci_003                -5.354393e-02 3 1  ON 2
ci_004                -5.514551e-02 3 1  ON 3
ci_005                 2.314473e-02 3 1  ON 4
ci_006                 2.308978e-02 3 1  ON 5
ci_007                 1.837072e-02 3 1  ON 6
ci_008                 1.781478e-02 3 1  ON 7
ci_009                -1.484183e-02 3 1  ON 8
ci_010                -1.403948e-02 3 1  ON 9
ci_011                -1.240892e-02 3 1  ON 10
ci_012                -1.198772e-02 3 1  ON 11
ci_013                 1.094422e-02 3 1  ON 12
ci_014                 1.071957e-02 3 1  ON 13
ci_015                 1.291119e-02 3 1  ON 14
ci_016                 1.240718e-02 3 1  ON 15
ci_017                 1.058368e-02 3 1  ON 16
ci_018                 1.030823e-02 3 1  ON 17
ci_019                 3.482705e-03 3 1  ON 18
ci_020                 4.199396e-03 3 1  ON 19
ci_021                -8.008662e-03 3 1  ON 20
ci_022                -8.670624e-03 3 1  ON 21
ci_023                 6.261113e-03 3 1  ON 22
ci_024                 6.577648e-03 3 1  ON 23
ci_025                 9.026756e-03 3 1  ON 24
ci_026                 8.800406e-03 3 1  ON 25
ci_027                 6.616182e-03 3 1  ON 26
ci_028                 6.819722e-03 3 1  ON 27
ci_029                -5.164922e-03 3 1  ON 28
ci_030                -4.522129e-03 3 1  ON 29
ci_031                -1.639955e-03 3 1  ON 30
ci_032                -1.453001e-03 3 1  ON 31
ci_033                 4.348478e-03 3 1  ON 32
ci_034                 4.355435e-03 3 1  ON 33
ci_035                 2.625365e-03 3 1  ON 34
ci_036                 2.653327e-03 3 1  ON 35
ci_037                 4.525983e-03 3 1  ON 36
ci_038                 4.529855e-03 3 1  ON 37
ci_039                 4.541704e-03 3 1  ON 38
ci_040                 4.721491e-03 3 1  ON 39
ci_041                 3.665871e-03 3 1  ON 40
ci_042                 3.518072e-03 3 1  ON 41
ci_043                 3.686136e-03 3 1  ON 42
ci_044                 4.088089e-03 3 1  ON 43
ci_045                 3.062701e-03 3 1  ON 44
ci_046                 3.324313e-03 3 1  ON 45
ci_047                -1.385811e-03 3 1  ON 46
ci_048                -1.452703e-03 3 1  ON 47
ci_049                 1.468478e-03 3 1  ON 48
ci_050                 1.645695e-03 3 1  ON 49
ci_051                -2.111307e-03 3 1  ON 50
ci_052                -1.884543e-03 3 1  ON 51
ci_053                -2.365030e-03 3 1  ON 52
ci_054                -2.629739e-03 3 1  ON 53
ci_055                -1.229358e-03 3 1  ON 54
ci_056                -1.505880e-03 3 1  ON 55
ci_057                -1.276622e-03 3 1  ON 56
ci_058                -1.267464e-03 3 1  ON 57
ci_059                -7.756551e-04 3 1  ON 58
ci_060                -5.352568e-04 3 1  ON 59
ci_061                -9.101891e-04 3 1  ON 60
ci_062                -6.631506e-04 3 1  ON 61
ci_063                -6.719637e-04 3 1  ON 62
ci_064                -8.007547e-04 3 1  ON 63
ci_065                -1.976284e-03 3 1  ON 64
ci_066                -2.134733e-03 3 1  ON 65
ci_067                -1.657739e-03 3 1  ON 66
ci_068                -1.193753e-03 3 1  ON 67
ci_069                -1.367596e-04 3 1  ON 68
ci_070                 5.846229e-05 3 1  ON 69
ci_071                -1.801293e-03 3 1  ON 70
ci_072                -1.813531e-03 3 1  ON 71
ci_073                 5.141677e-04 3 1  ON 72
ci_074                 4.785826e-04 3 1  ON 73
ci_075                -1.863074e-04 3 1  ON 74
ci_076                 1.999790e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.728
    reference variance = 0.452182
====================================================
  Execution time = 4.9977e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0337e-01
  Total weights = 1.9551e+06
  Execution time = 7.2039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491119103575
                                         uncertainty =       0.002817460018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491119103575
                                         uncertainty =       0.002817460018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495555236
  error estimate for blocks of size 2^( 2) =       0.000513995099
  error estimate for blocks of size 2^( 3) =       0.000530620084
  error estimate for blocks of size 2^( 4) =       0.000542914203
  error estimate for blocks of size 2^( 5) =       0.000549212546
  error estimate for blocks of size 2^( 6) =       0.000552986830
  error estimate for blocks of size 2^( 7) =       0.000558025572

      target function =      -0.608411598310
              le_mean =     -22.669041329425
             les_mean =     514.393398661137
             stat err =       0.000550784788
             autocorr =       1.235320749554
   target nu stat err =       0.000550784788
   target dn stat err =       0.004680469078
      target stat err =       0.001433567894
              std dev =       0.700820934956
             le_variance =       0.491149982873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490095971147
                                         uncertainty =       0.002913195637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490095971147
                                         uncertainty =       0.002913195637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495051493
  error estimate for blocks of size 2^( 2) =       0.000513511627
  error estimate for blocks of size 2^( 3) =       0.000530182587
  error estimate for blocks of size 2^( 4) =       0.000542520041
  error estimate for blocks of size 2^( 5) =       0.000548833823
  error estimate for blocks of size 2^( 6) =       0.000552510182
  error estimate for blocks of size 2^( 7) =       0.000557556827

      target function =      -0.607466696127
              le_mean =     -22.669090895305
             les_mean =     514.398828985699
             stat err =       0.000550355218
             autocorr =       1.235905965711
   target nu stat err =       0.000550355218
   target dn stat err =       0.005558783914
      target stat err =       0.001688475214
              std dev =       0.700108535286
             le_variance =       0.490151961181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490037375587
                                         uncertainty =       0.002826832906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490037375587
                                         uncertainty =       0.002826832906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495015887
  error estimate for blocks of size 2^( 2) =       0.000513474553
  error estimate for blocks of size 2^( 3) =       0.000530125607
  error estimate for blocks of size 2^( 4) =       0.000542444684
  error estimate for blocks of size 2^( 5) =       0.000548761855
  error estimate for blocks of size 2^( 6) =       0.000552489763
  error estimate for blocks of size 2^( 7) =       0.000557536873

      target function =      -0.606227504701
              le_mean =     -22.669036033498
             les_mean =     514.400371431529
             stat err =       0.000550308294
             autocorr =       1.235872990453
   target nu stat err =       0.000550308294
   target dn stat err =       0.012981752442
      target stat err =       0.003885402003
              std dev =       0.700058181345
             le_variance =       0.490081457267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490913792907
                                         uncertainty =       0.002815930233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490913792907
                                         uncertainty =       0.002815930233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495452427
  error estimate for blocks of size 2^( 2) =       0.000513896973
  error estimate for blocks of size 2^( 3) =       0.000530521201
  error estimate for blocks of size 2^( 4) =       0.000542817249
  error estimate for blocks of size 2^( 5) =       0.000549120158
  error estimate for blocks of size 2^( 6) =       0.000552889966
  error estimate for blocks of size 2^( 7) =       0.000557933003

      target function =      -0.607983763905
              le_mean =     -22.669038481443
             les_mean =     514.394688161111
             stat err =       0.000550690094
             autocorr =       1.235408567405
   target nu stat err =       0.000550690094
   target dn stat err =       0.005250080322
      target stat err =       0.001599842089
              std dev =       0.700675541315
             le_variance =       0.490946214198


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.608411598310        initial  <--
     9.5367e-02     9.5367e-01             4.9312e-03        -0.607466696127
     3.8147e-01     3.8147e+00             1.5383e-03        -0.606227504701
     1.5259e+00     1.5259e+01             4.1001e-04        -0.607983763905

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 86.1249
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_001                -7.042368e-01 3 1  ON 0
ci_002                -7.028136e-01 3 1  ON 1
ci_003                -5.392857e-02 3 1  ON 2
ci_004                -5.438693e-02 3 1  ON 3
ci_005                 2.393526e-02 3 1  ON 4
ci_006                 2.399866e-02 3 1  ON 5
ci_007                 1.900908e-02 3 1  ON 6
ci_008                 1.935311e-02 3 1  ON 7
ci_009                -1.529520e-02 3 1  ON 8
ci_010                -1.501942e-02 3 1  ON 9
ci_011                -1.286441e-02 3 1  ON 10
ci_012                -1.246240e-02 3 1  ON 11
ci_013                 1.143409e-02 3 1  ON 12
ci_014                 1.123455e-02 3 1  ON 13
ci_015                 1.293633e-02 3 1  ON 14
ci_016                 1.261700e-02 3 1  ON 15
ci_017                 1.068230e-02 3 1  ON 16
ci_018                 1.066709e-02 3 1  ON 17
ci_019                 3.584324e-03 3 1  ON 18
ci_020                 3.716409e-03 3 1  ON 19
ci_021                -8.174554e-03 3 1  ON 20
ci_022                -8.323195e-03 3 1  ON 21
ci_023                 6.359579e-03 3 1  ON 22
ci_024                 6.481158e-03 3 1  ON 23
ci_025                 9.025236e-03 3 1  ON 24
ci_026                 8.865141e-03 3 1  ON 25
ci_027                 6.655628e-03 3 1  ON 26
ci_028                 6.768827e-03 3 1  ON 27
ci_029                -5.352917e-03 3 1  ON 28
ci_030                -5.309655e-03 3 1  ON 29
ci_031                -1.930842e-03 3 1  ON 30
ci_032                -1.971510e-03 3 1  ON 31
ci_033                 4.399423e-03 3 1  ON 32
ci_034                 4.346799e-03 3 1  ON 33
ci_035                 2.821446e-03 3 1  ON 34
ci_036                 2.876745e-03 3 1  ON 35
ci_037                 4.743294e-03 3 1  ON 36
ci_038                 4.612419e-03 3 1  ON 37
ci_039                 4.600850e-03 3 1  ON 38
ci_040                 4.744083e-03 3 1  ON 39
ci_041                 3.744730e-03 3 1  ON 40
ci_042                 3.610634e-03 3 1  ON 41
ci_043                 3.909015e-03 3 1  ON 42
ci_044                 4.068493e-03 3 1  ON 43
ci_045                 3.189629e-03 3 1  ON 44
ci_046                 3.276824e-03 3 1  ON 45
ci_047                -1.682528e-03 3 1  ON 46
ci_048                -1.769855e-03 3 1  ON 47
ci_049                 1.486637e-03 3 1  ON 48
ci_050                 1.518858e-03 3 1  ON 49
ci_051                -2.218822e-03 3 1  ON 50
ci_052                -2.051635e-03 3 1  ON 51
ci_053                -2.302692e-03 3 1  ON 52
ci_054                -2.469581e-03 3 1  ON 53
ci_055                -1.178923e-03 3 1  ON 54
ci_056                -1.640348e-03 3 1  ON 55
ci_057                -1.254518e-03 3 1  ON 56
ci_058                -1.410871e-03 3 1  ON 57
ci_059                -8.564424e-04 3 1  ON 58
ci_060                -6.548991e-04 3 1  ON 59
ci_061                -1.079160e-03 3 1  ON 60
ci_062                -7.317935e-04 3 1  ON 61
ci_063                -5.779669e-04 3 1  ON 62
ci_064                -8.396584e-04 3 1  ON 63
ci_065                -1.946463e-03 3 1  ON 64
ci_066                -2.100986e-03 3 1  ON 65
ci_067                -1.474984e-03 3 1  ON 66
ci_068                -1.090299e-03 3 1  ON 67
ci_069                -2.685889e-05 3 1  ON 68
ci_070                 2.180149e-04 3 1  ON 69
ci_071                -1.878264e-03 3 1  ON 70
ci_072                -1.691356e-03 3 1  ON 71
ci_073                 5.172801e-04 3 1  ON 72
ci_074                 4.487605e-04 3 1  ON 73
ci_075                -2.546306e-04 3 1  ON 74
ci_076                -1.358127e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4676e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.5471
    reference variance = 0.353139
====================================================
  Execution time = 5.1187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0578e-01
  Total weights = 1.954787927e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3754e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494093562056
                                         uncertainty =       0.003324380391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494093562056
                                         uncertainty =       0.003324380391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496993870
  error estimate for blocks of size 2^( 2) =       0.000515343190
  error estimate for blocks of size 2^( 3) =       0.000532013982
  error estimate for blocks of size 2^( 4) =       0.000544679941
  error estimate for blocks of size 2^( 5) =       0.000551056525
  error estimate for blocks of size 2^( 6) =       0.000556288749
  error estimate for blocks of size 2^( 7) =       0.000558359331

      target function =      -0.609060808358
              le_mean =     -22.669005028059
             les_mean =     514.389570667057
             stat err =       0.000552596136
             autocorr =       1.236270836601
   target nu stat err =       0.000552596136
   target dn stat err =       0.003653471587
      target stat err =       0.001134402115
              std dev =       0.702855470820
             le_variance =       0.494005812862


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266900502806e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609062636982       residual = 6.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609108575996       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609113523023       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609113963676       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609114151296       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609114241029       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609114260869       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609114279653       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609114277829       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609114279776       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 3.684831e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609062636982       residual = 6.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609074469165       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609075725251       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609075835432       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609075881697       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609075903353       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609075907914       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609075912344       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609075911876       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609075912309       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 9.498903e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609062636982       residual = 6.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609065617567       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609065932809       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609065960351       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609065971875       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609065977239       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609065978354       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609065979445       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609065979328       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609065979433       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 2.393360e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.743011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0575e+01
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_001                -7.042875e-01 3 1  ON 0
ci_002                -7.027891e-01 3 1  ON 1
ci_003                -5.389757e-02 3 1  ON 2
ci_004                -5.433346e-02 3 1  ON 3
ci_005                 2.384343e-02 3 1  ON 4
ci_006                 2.390367e-02 3 1  ON 5
ci_007                 1.894392e-02 3 1  ON 6
ci_008                 1.929933e-02 3 1  ON 7
ci_009                -1.523769e-02 3 1  ON 8
ci_010                -1.497176e-02 3 1  ON 9
ci_011                -1.282549e-02 3 1  ON 10
ci_012                -1.241194e-02 3 1  ON 11
ci_013                 1.140710e-02 3 1  ON 12
ci_014                 1.120014e-02 3 1  ON 13
ci_015                 1.289192e-02 3 1  ON 14
ci_016                 1.257702e-02 3 1  ON 15
ci_017                 1.065192e-02 3 1  ON 16
ci_018                 1.064398e-02 3 1  ON 17
ci_019                 3.526879e-03 3 1  ON 18
ci_020                 3.672936e-03 3 1  ON 19
ci_021                -8.160655e-03 3 1  ON 20
ci_022                -8.316276e-03 3 1  ON 21
ci_023                 6.349445e-03 3 1  ON 22
ci_024                 6.442814e-03 3 1  ON 23
ci_025                 9.028724e-03 3 1  ON 24
ci_026                 8.876050e-03 3 1  ON 25
ci_027                 6.640983e-03 3 1  ON 26
ci_028                 6.742639e-03 3 1  ON 27
ci_029                -5.328517e-03 3 1  ON 28
ci_030                -5.281242e-03 3 1  ON 29
ci_031                -1.901655e-03 3 1  ON 30
ci_032                -1.930661e-03 3 1  ON 31
ci_033                 4.387039e-03 3 1  ON 32
ci_034                 4.328684e-03 3 1  ON 33
ci_035                 2.812853e-03 3 1  ON 34
ci_036                 2.861587e-03 3 1  ON 35
ci_037                 4.745405e-03 3 1  ON 36
ci_038                 4.604145e-03 3 1  ON 37
ci_039                 4.593341e-03 3 1  ON 38
ci_040                 4.724162e-03 3 1  ON 39
ci_041                 3.741654e-03 3 1  ON 40
ci_042                 3.604982e-03 3 1  ON 41
ci_043                 3.908337e-03 3 1  ON 42
ci_044                 4.071123e-03 3 1  ON 43
ci_045                 3.194150e-03 3 1  ON 44
ci_046                 3.264311e-03 3 1  ON 45
ci_047                -1.672691e-03 3 1  ON 46
ci_048                -1.761779e-03 3 1  ON 47
ci_049                 1.472369e-03 3 1  ON 48
ci_050                 1.517246e-03 3 1  ON 49
ci_051                -2.205841e-03 3 1  ON 50
ci_052                -2.054507e-03 3 1  ON 51
ci_053                -2.292503e-03 3 1  ON 52
ci_054                -2.451919e-03 3 1  ON 53
ci_055                -1.170473e-03 3 1  ON 54
ci_056                -1.636857e-03 3 1  ON 55
ci_057                -1.248212e-03 3 1  ON 56
ci_058                -1.423739e-03 3 1  ON 57
ci_059                -8.501993e-04 3 1  ON 58
ci_060                -6.582322e-04 3 1  ON 59
ci_061                -1.061958e-03 3 1  ON 60
ci_062                -7.326260e-04 3 1  ON 61
ci_063                -5.894040e-04 3 1  ON 62
ci_064                -8.176935e-04 3 1  ON 63
ci_065                -1.930406e-03 3 1  ON 64
ci_066                -2.099510e-03 3 1  ON 65
ci_067                -1.467875e-03 3 1  ON 66
ci_068                -1.085338e-03 3 1  ON 67
ci_069                -2.556529e-05 3 1  ON 68
ci_070                 2.087044e-04 3 1  ON 69
ci_071                -1.876726e-03 3 1  ON 70
ci_072                -1.698695e-03 3 1  ON 71
ci_073                 5.206454e-04 3 1  ON 72
ci_074                 4.602772e-04 3 1  ON 73
ci_075                -2.495516e-04 3 1  ON 74
ci_076                -1.326432e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.7901
    reference variance = 0.414272
====================================================
  Execution time = 4.9654e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1029e-01
  Total weights = 1.9551e+06
  Execution time = 7.2357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495317403190
                                         uncertainty =       0.005317318802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495317403190
                                         uncertainty =       0.005317318802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497723630
  error estimate for blocks of size 2^( 2) =       0.000515723986
  error estimate for blocks of size 2^( 3) =       0.000532018739
  error estimate for blocks of size 2^( 4) =       0.000544131049
  error estimate for blocks of size 2^( 5) =       0.000550629948
  error estimate for blocks of size 2^( 6) =       0.000552373340
  error estimate for blocks of size 2^( 7) =       0.000555422175

      target function =      -0.607357892815
              le_mean =     -22.667790913120
             les_mean =     514.339183027771
             stat err =       0.000550639128
             autocorr =       1.223932925204
   target nu stat err =       0.000550639128
   target dn stat err =       0.007151584888
      target stat err =       0.002158114614
              std dev =       0.703887507664
             le_variance =       0.495457623445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494935093157
                                         uncertainty =       0.005249130681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494935093157
                                         uncertainty =       0.005249130681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497531685
  error estimate for blocks of size 2^( 2) =       0.000515535799
  error estimate for blocks of size 2^( 3) =       0.000531832748
  error estimate for blocks of size 2^( 4) =       0.000543943089
  error estimate for blocks of size 2^( 5) =       0.000550441275
  error estimate for blocks of size 2^( 6) =       0.000552194552
  error estimate for blocks of size 2^( 7) =       0.000555255969

      target function =      -0.607459997393
              le_mean =     -22.667792711300
             les_mean =     514.338925381309
             stat err =       0.000550458721
             autocorr =       1.224074993301
   target nu stat err =       0.000550458721
   target dn stat err =       0.007098476491
      target stat err =       0.002143048719
              std dev =       0.703616056641
             le_variance =       0.495075555164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495117787257
                                         uncertainty =       0.005282250831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495117787257
                                         uncertainty =       0.005282250831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497623421
  error estimate for blocks of size 2^( 2) =       0.000515625668
  error estimate for blocks of size 2^( 3) =       0.000531921638
  error estimate for blocks of size 2^( 4) =       0.000544033000
  error estimate for blocks of size 2^( 5) =       0.000550531437
  error estimate for blocks of size 2^( 6) =       0.000552279965
  error estimate for blocks of size 2^( 7) =       0.000555335363

      target function =      -0.607324990150
              le_mean =     -22.667791447654
             les_mean =     514.339317745660
             stat err =       0.000550544941
             autocorr =       1.224007072815
   target nu stat err =       0.000550544941
   target dn stat err =       0.007132939584
      target stat err =       0.002152340751
              std dev =       0.703745791422
             le_variance =       0.495258138944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495291883860
                                         uncertainty =       0.005312879664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495291883860
                                         uncertainty =       0.005312879664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497710820
  error estimate for blocks of size 2^( 2) =       0.000515711412
  error estimate for blocks of size 2^( 3) =       0.000532006304
  error estimate for blocks of size 2^( 4) =       0.000544118484
  error estimate for blocks of size 2^( 5) =       0.000550617340
  error estimate for blocks of size 2^( 6) =       0.000552361399
  error estimate for blocks of size 2^( 7) =       0.000555411066

      target function =      -0.607370553746
              le_mean =     -22.667790941729
             les_mean =     514.339142083168
             stat err =       0.000550627072
             autocorr =       1.223942331416
   target nu stat err =       0.000550627072
   target dn stat err =       0.007147797534
      target stat err =       0.002157078289
              std dev =       0.703869392113
             le_variance =       0.495432121154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607357892815        initial
     9.5367e-01     9.5367e+00             3.6848e-04        -0.607459997393  <--
     3.8147e+00     3.8147e+01             9.4989e-05        -0.607324990150
     1.5259e+01     1.5259e+02             2.3934e-05        -0.607370553746

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 8.5950e+01
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_001                -7.044382e-01 3 1  ON 0
ci_002                -7.027144e-01 3 1  ON 1
ci_003                -5.380629e-02 3 1  ON 2
ci_004                -5.417560e-02 3 1  ON 3
ci_005                 2.357924e-02 3 1  ON 4
ci_006                 2.363017e-02 3 1  ON 5
ci_007                 1.875525e-02 3 1  ON 6
ci_008                 1.914365e-02 3 1  ON 7
ci_009                -1.507135e-02 3 1  ON 8
ci_010                -1.483370e-02 3 1  ON 9
ci_011                -1.271292e-02 3 1  ON 10
ci_012                -1.226590e-02 3 1  ON 11
ci_013                 1.132903e-02 3 1  ON 12
ci_014                 1.110067e-02 3 1  ON 13
ci_015                 1.276275e-02 3 1  ON 14
ci_016                 1.246068e-02 3 1  ON 15
ci_017                 1.056407e-02 3 1  ON 16
ci_018                 1.057715e-02 3 1  ON 17
ci_019                 3.359547e-03 3 1  ON 18
ci_020                 3.546323e-03 3 1  ON 19
ci_021                -8.120406e-03 3 1  ON 20
ci_022                -8.296246e-03 3 1  ON 21
ci_023                 6.320262e-03 3 1  ON 22
ci_024                 6.332202e-03 3 1  ON 23
ci_025                 9.039282e-03 3 1  ON 24
ci_026                 8.907928e-03 3 1  ON 25
ci_027                 6.598949e-03 3 1  ON 26
ci_028                 6.667457e-03 3 1  ON 27
ci_029                -5.257686e-03 3 1  ON 28
ci_030                -5.198681e-03 3 1  ON 29
ci_031                -1.817039e-03 3 1  ON 30
ci_032                -1.812171e-03 3 1  ON 31
ci_033                 4.351043e-03 3 1  ON 32
ci_034                 4.276114e-03 3 1  ON 33
ci_035                 2.787969e-03 3 1  ON 34
ci_036                 2.817821e-03 3 1  ON 35
ci_037                 4.751451e-03 3 1  ON 36
ci_038                 4.580022e-03 3 1  ON 37
ci_039                 4.571865e-03 3 1  ON 38
ci_040                 4.666968e-03 3 1  ON 39
ci_041                 3.732851e-03 3 1  ON 40
ci_042                 3.588893e-03 3 1  ON 41
ci_043                 3.906209e-03 3 1  ON 42
ci_044                 4.078583e-03 3 1  ON 43
ci_045                 3.207494e-03 3 1  ON 44
ci_046                 3.228197e-03 3 1  ON 45
ci_047                -1.644183e-03 3 1  ON 46
ci_048                -1.738456e-03 3 1  ON 47
ci_049                 1.431190e-03 3 1  ON 48
ci_050                 1.512504e-03 3 1  ON 49
ci_051                -2.167893e-03 3 1  ON 50
ci_052                -2.062615e-03 3 1  ON 51
ci_053                -2.263169e-03 3 1  ON 52
ci_054                -2.400990e-03 3 1  ON 53
ci_055                -1.145972e-03 3 1  ON 54
ci_056                -1.626667e-03 3 1  ON 55
ci_057                -1.229993e-03 3 1  ON 56
ci_058                -1.460759e-03 3 1  ON 57
ci_059                -8.322320e-04 3 1  ON 58
ci_060                -6.678079e-04 3 1  ON 59
ci_061                -1.012138e-03 3 1  ON 60
ci_062                -7.350327e-04 3 1  ON 61
ci_063                -6.227940e-04 3 1  ON 62
ci_064                -7.540654e-04 3 1  ON 63
ci_065                -1.883857e-03 3 1  ON 64
ci_066                -2.095208e-03 3 1  ON 65
ci_067                -1.447337e-03 3 1  ON 66
ci_068                -1.071139e-03 3 1  ON 67
ci_069                -2.197207e-05 3 1  ON 68
ci_070                 1.817380e-04 3 1  ON 69
ci_071                -1.872224e-03 3 1  ON 70
ci_072                -1.719738e-03 3 1  ON 71
ci_073                 5.301783e-04 3 1  ON 72
ci_074                 4.933362e-04 3 1  ON 73
ci_075                -2.348665e-04 3 1  ON 74
ci_076                -1.234732e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4654e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.7286
    reference variance = 0.331928
====================================================
  Execution time = 5.1201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9789e-01
  Total weights = 1.954865154e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484487792898
                                         uncertainty =       0.002667537509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484487792898
                                         uncertainty =       0.002667537509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492136590
  error estimate for blocks of size 2^( 2) =       0.000510857679
  error estimate for blocks of size 2^( 3) =       0.000527705856
  error estimate for blocks of size 2^( 4) =       0.000540108961
  error estimate for blocks of size 2^( 5) =       0.000545489968
  error estimate for blocks of size 2^( 6) =       0.000548756411
  error estimate for blocks of size 2^( 7) =       0.000550810553

      target function =      -0.611250967340
              le_mean =     -22.668220506354
             les_mean =     514.346110159984
             stat err =       0.000546291473
             autocorr =       1.232189580481
   target nu stat err =       0.000546291473
   target dn stat err =       0.004197069062
      target stat err =       0.001301617818
              std dev =       0.695986240294
             le_variance =       0.484396846678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266822050635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611253399885       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611407289364       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611423472093       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611425355468       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611425923952       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611426121972       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611426109738       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611426122673       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611426133561       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611426140267       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.611426138484       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 1.291436e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611253399885       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611296387161       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611300706378       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611301190749       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611301326186       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611301368650       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611301364636       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611301367334       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611301369745       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611301370971       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 3.625107e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611253399885       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611264471413       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611265569324       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611265691139       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611265724447       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611265734586       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611265733531       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611265734172       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611265734754       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611265735034       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 9.347858e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.748480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0634e+01
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_001                -7.044267e-01 3 1  ON 0
ci_002                -7.028195e-01 3 1  ON 1
ci_003                -5.364357e-02 3 1  ON 2
ci_004                -5.400137e-02 3 1  ON 3
ci_005                 2.321673e-02 3 1  ON 4
ci_006                 2.332334e-02 3 1  ON 5
ci_007                 1.855369e-02 3 1  ON 6
ci_008                 1.896981e-02 3 1  ON 7
ci_009                -1.484936e-02 3 1  ON 8
ci_010                -1.465334e-02 3 1  ON 9
ci_011                -1.251624e-02 3 1  ON 10
ci_012                -1.207472e-02 3 1  ON 11
ci_013                 1.120023e-02 3 1  ON 12
ci_014                 1.101145e-02 3 1  ON 13
ci_015                 1.258388e-02 3 1  ON 14
ci_016                 1.240193e-02 3 1  ON 15
ci_017                 1.046921e-02 3 1  ON 16
ci_018                 1.038816e-02 3 1  ON 17
ci_019                 3.305245e-03 3 1  ON 18
ci_020                 3.453139e-03 3 1  ON 19
ci_021                -8.099411e-03 3 1  ON 20
ci_022                -8.285558e-03 3 1  ON 21
ci_023                 6.190280e-03 3 1  ON 22
ci_024                 6.401231e-03 3 1  ON 23
ci_025                 9.060956e-03 3 1  ON 24
ci_026                 8.997995e-03 3 1  ON 25
ci_027                 6.516370e-03 3 1  ON 26
ci_028                 6.682308e-03 3 1  ON 27
ci_029                -5.123382e-03 3 1  ON 28
ci_030                -5.129087e-03 3 1  ON 29
ci_031                -1.667709e-03 3 1  ON 30
ci_032                -1.655084e-03 3 1  ON 31
ci_033                 4.325424e-03 3 1  ON 32
ci_034                 4.189897e-03 3 1  ON 33
ci_035                 2.696813e-03 3 1  ON 34
ci_036                 2.738479e-03 3 1  ON 35
ci_037                 4.682415e-03 3 1  ON 36
ci_038                 4.484794e-03 3 1  ON 37
ci_039                 4.527936e-03 3 1  ON 38
ci_040                 4.630788e-03 3 1  ON 39
ci_041                 3.709545e-03 3 1  ON 40
ci_042                 3.541992e-03 3 1  ON 41
ci_043                 3.879914e-03 3 1  ON 42
ci_044                 4.039949e-03 3 1  ON 43
ci_045                 3.197134e-03 3 1  ON 44
ci_046                 3.152470e-03 3 1  ON 45
ci_047                -1.581011e-03 3 1  ON 46
ci_048                -1.714885e-03 3 1  ON 47
ci_049                 1.336989e-03 3 1  ON 48
ci_050                 1.508529e-03 3 1  ON 49
ci_051                -2.208768e-03 3 1  ON 50
ci_052                -2.074896e-03 3 1  ON 51
ci_053                -2.178074e-03 3 1  ON 52
ci_054                -2.390208e-03 3 1  ON 53
ci_055                -1.041874e-03 3 1  ON 54
ci_056                -1.647972e-03 3 1  ON 55
ci_057                -1.240627e-03 3 1  ON 56
ci_058                -1.490992e-03 3 1  ON 57
ci_059                -8.204005e-04 3 1  ON 58
ci_060                -6.740313e-04 3 1  ON 59
ci_061                -9.708815e-04 3 1  ON 60
ci_062                -7.624052e-04 3 1  ON 61
ci_063                -5.493790e-04 3 1  ON 62
ci_064                -7.315790e-04 3 1  ON 63
ci_065                -1.937105e-03 3 1  ON 64
ci_066                -2.106764e-03 3 1  ON 65
ci_067                -1.492956e-03 3 1  ON 66
ci_068                -1.136846e-03 3 1  ON 67
ci_069                -2.103962e-05 3 1  ON 68
ci_070                 3.866774e-05 3 1  ON 69
ci_071                -1.851310e-03 3 1  ON 70
ci_072                -1.800922e-03 3 1  ON 71
ci_073                 4.925733e-04 3 1  ON 72
ci_074                 5.057093e-04 3 1  ON 73
ci_075                -1.483035e-04 3 1  ON 74
ci_076                -9.869437e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.6502
    reference variance = 0.415693
====================================================
  Execution time = 4.9733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9534e-01
  Total weights = 1.9549e+06
  Execution time = 7.2161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484124733410
                                         uncertainty =       0.002448536968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484124733410
                                         uncertainty =       0.002448536968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492032324
  error estimate for blocks of size 2^( 2) =       0.000510607735
  error estimate for blocks of size 2^( 3) =       0.000527000248
  error estimate for blocks of size 2^( 4) =       0.000537911849
  error estimate for blocks of size 2^( 5) =       0.000543996750
  error estimate for blocks of size 2^( 6) =       0.000546458642
  error estimate for blocks of size 2^( 7) =       0.000546683096

      target function =      -0.222951851648
              le_mean =     -22.669216231275
             les_mean =     516.682655180139
             stat err =       0.000543762584
             autocorr =       1.221325352065
   target nu stat err =       0.000543762584
   target dn stat err =       2.289029433838
      target stat err =       0.118570952218
              std dev =       0.695838785796
             le_variance =       0.484191615818

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0160555
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482837474049
                                         uncertainty =       0.002288704906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482837474049
                                         uncertainty =       0.002288704906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491379083
  error estimate for blocks of size 2^( 2) =       0.000509966612
  error estimate for blocks of size 2^( 3) =       0.000526375936
  error estimate for blocks of size 2^( 4) =       0.000537271051
  error estimate for blocks of size 2^( 5) =       0.000543400175
  error estimate for blocks of size 2^( 6) =       0.000545878332
  error estimate for blocks of size 2^( 7) =       0.000546215492

      target function =      -0.609257300222
              le_mean =     -22.669197050052
             les_mean =     514.397740601928
             stat err =       0.000543191262
             autocorr =       1.222002853350
   target nu stat err =       0.000543191262
   target dn stat err =       0.009881721286
      target stat err =       0.002992376438
              std dev =       0.694914963317
             le_variance =       0.482906806242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483059575484
                                         uncertainty =       0.002287042951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483059575484
                                         uncertainty =       0.002287042951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491491937
  error estimate for blocks of size 2^( 2) =       0.000510078676
  error estimate for blocks of size 2^( 3) =       0.000526491461
  error estimate for blocks of size 2^( 4) =       0.000537386870
  error estimate for blocks of size 2^( 5) =       0.000543534598
  error estimate for blocks of size 2^( 6) =       0.000546008658
  error estimate for blocks of size 2^( 7) =       0.000546323845

      target function =      -0.607440603279
              le_mean =     -22.669190489173
             les_mean =     514.403452943320
             stat err =       0.000543313493
             autocorr =       1.221991500472
   target nu stat err =       0.000543313493
   target dn stat err =       0.012326030497
      target stat err =       0.003705069078
              std dev =       0.695074563720
             le_variance =       0.483128649130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483378862158
                                         uncertainty =       0.002289278057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483378862158
                                         uncertainty =       0.002289278057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491654154
  error estimate for blocks of size 2^( 2) =       0.000510240711
  error estimate for blocks of size 2^( 3) =       0.000526660496
  error estimate for blocks of size 2^( 4) =       0.000537558192
  error estimate for blocks of size 2^( 5) =       0.000543721637
  error estimate for blocks of size 2^( 6) =       0.000546193177
  error estimate for blocks of size 2^( 7) =       0.000546490622

      target function =      -0.611542744762
              le_mean =     -22.669196124746
             les_mean =     514.390190319911
             stat err =       0.000543490907
             autocorr =       1.221982931220
   target nu stat err =       0.000543490907
   target dn stat err =       0.003518020498
      target stat err =       0.001102548450
              std dev =       0.695303972115
             le_variance =       0.483447613639


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.222951851648        initial
     2.3842e-01     2.3842e+00             1.2914e-03        -0.609257300222
     9.5367e-01     9.5367e+00             3.6251e-04        -0.607440603279
     3.8147e+00     3.8147e+01             9.3479e-05        -0.611542744762  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 8.5951e+01
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_001                -7.044356e-01 3 1  ON 0
ci_002                -7.027409e-01 3 1  ON 1
ci_003                -5.376510e-02 3 1  ON 2
ci_004                -5.413150e-02 3 1  ON 3
ci_005                 2.348576e-02 3 1  ON 4
ci_006                 2.355105e-02 3 1  ON 5
ci_007                 1.870350e-02 3 1  ON 6
ci_008                 1.909898e-02 3 1  ON 7
ci_009                -1.501433e-02 3 1  ON 8
ci_010                -1.478736e-02 3 1  ON 9
ci_011                -1.266240e-02 3 1  ON 10
ci_012                -1.221684e-02 3 1  ON 11
ci_013                 1.129592e-02 3 1  ON 12
ci_014                 1.107773e-02 3 1  ON 13
ci_015                 1.271696e-02 3 1  ON 14
ci_016                 1.244573e-02 3 1  ON 15
ci_017                 1.053971e-02 3 1  ON 16
ci_018                 1.052864e-02 3 1  ON 17
ci_019                 3.345750e-03 3 1  ON 18
ci_020                 3.522549e-03 3 1  ON 19
ci_021                -8.114983e-03 3 1  ON 20
ci_022                -8.293459e-03 3 1  ON 21
ci_023                 6.286764e-03 3 1  ON 22
ci_024                 6.349975e-03 3 1  ON 23
ci_025                 9.044736e-03 3 1  ON 24
ci_026                 8.930941e-03 3 1  ON 25
ci_027                 6.577608e-03 3 1  ON 26
ci_028                 6.671275e-03 3 1  ON 27
ci_029                -5.223285e-03 3 1  ON 28
ci_030                -5.180881e-03 3 1  ON 29
ci_031                -1.778767e-03 3 1  ON 30
ci_032                -1.771902e-03 3 1  ON 31
ci_033                 4.344543e-03 3 1  ON 32
ci_034                 4.253987e-03 3 1  ON 33
ci_035                 2.764502e-03 3 1  ON 34
ci_036                 2.797393e-03 3 1  ON 35
ci_037                 4.733752e-03 3 1  ON 36
ci_038                 4.555607e-03 3 1  ON 37
ci_039                 4.560524e-03 3 1  ON 38
ci_040                 4.657608e-03 3 1  ON 39
ci_041                 3.726823e-03 3 1  ON 40
ci_042                 3.576820e-03 3 1  ON 41
ci_043                 3.899530e-03 3 1  ON 42
ci_044                 4.068665e-03 3 1  ON 43
ci_045                 3.204776e-03 3 1  ON 44
ci_046                 3.208718e-03 3 1  ON 45
ci_047                -1.627934e-03 3 1  ON 46
ci_048                -1.732422e-03 3 1  ON 47
ci_049                 1.406928e-03 3 1  ON 48
ci_050                 1.511477e-03 3 1  ON 49
ci_051                -2.178461e-03 3 1  ON 50
ci_052                -2.065843e-03 3 1  ON 51
ci_053                -2.241273e-03 3 1  ON 52
ci_054                -2.398230e-03 3 1  ON 53
ci_055                -1.119298e-03 3 1  ON 54
ci_056                -1.632186e-03 3 1  ON 55
ci_057                -1.232735e-03 3 1  ON 56
ci_058                -1.468554e-03 3 1  ON 57
ci_059                -8.292088e-04 3 1  ON 58
ci_060                -6.694329e-04 3 1  ON 59
ci_061                -1.001517e-03 3 1  ON 60
ci_062                -7.420502e-04 3 1  ON 61
ci_063                -6.038929e-04 3 1  ON 62
ci_064                -7.482737e-04 3 1  ON 63
ci_065                -1.897538e-03 3 1  ON 64
ci_066                -2.098179e-03 3 1  ON 65
ci_067                -1.459007e-03 3 1  ON 66
ci_068                -1.088027e-03 3 1  ON 67
ci_069                -2.170986e-05 3 1  ON 68
ci_070                 1.449816e-04 3 1  ON 69
ci_071                -1.866884e-03 3 1  ON 70
ci_072                -1.740633e-03 3 1  ON 71
ci_073                 5.204808e-04 3 1  ON 72
ci_074                 4.965219e-04 3 1  ON 73
ci_075                -2.126398e-04 3 1  ON 74
ci_076                -1.171376e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4660e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.6678
    reference variance = 0.352926
====================================================
  Execution time = 5.1036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0290e-01
  Total weights = 1.954685794e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490231794080
                                         uncertainty =       0.003005542941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490231794080
                                         uncertainty =       0.003005542941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495061359
  error estimate for blocks of size 2^( 2) =       0.000513549742
  error estimate for blocks of size 2^( 3) =       0.000530283114
  error estimate for blocks of size 2^( 4) =       0.000542053913
  error estimate for blocks of size 2^( 5) =       0.000549501838
  error estimate for blocks of size 2^( 6) =       0.000551337654
  error estimate for blocks of size 2^( 7) =       0.000553282432

      target function =      -0.609708632622
              le_mean =     -22.668114670888
             les_mean =     514.346325183163
             stat err =       0.000549043959
             autocorr =       1.229974695901
   target nu stat err =       0.000549043959
   target dn stat err =       0.003438745168
      target stat err =       0.001072699528
              std dev =       0.700122487426
             le_variance =       0.490171497399


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266811467089e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609710229428       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609743250092       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609746322417       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609746575829       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609746634221       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609746632152       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609746632870       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609746634529       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609746638402       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609746640412       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 3.423308e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609710229428       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609718732402       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609719511989       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609719574950       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609719589077       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609719588397       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609719588548       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609719588970       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609719589906       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609719590372       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 8.825497e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609710229428       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609712371244       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609712566866       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609712582578       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609712586079       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609712585899       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609712585935       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609712586041       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609712586273       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609712586387       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 2.223729e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.760815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0443e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_001                -7.044568e-01 3 1  ON 0
ci_002                -7.027428e-01 3 1  ON 1
ci_003                -5.371692e-02 3 1  ON 2
ci_004                -5.408829e-02 3 1  ON 3
ci_005                 2.339751e-02 3 1  ON 4
ci_006                 2.348602e-02 3 1  ON 5
ci_007                 1.865013e-02 3 1  ON 6
ci_008                 1.905290e-02 3 1  ON 7
ci_009                -1.496888e-02 3 1  ON 8
ci_010                -1.474028e-02 3 1  ON 9
ci_011                -1.261859e-02 3 1  ON 10
ci_012                -1.217079e-02 3 1  ON 11
ci_013                 1.125231e-02 3 1  ON 12
ci_014                 1.103895e-02 3 1  ON 13
ci_015                 1.267630e-02 3 1  ON 14
ci_016                 1.241110e-02 3 1  ON 15
ci_017                 1.051053e-02 3 1  ON 16
ci_018                 1.050338e-02 3 1  ON 17
ci_019                 3.305531e-03 3 1  ON 18
ci_020                 3.503256e-03 3 1  ON 19
ci_021                -8.098731e-03 3 1  ON 20
ci_022                -8.273251e-03 3 1  ON 21
ci_023                 6.278441e-03 3 1  ON 22
ci_024                 6.342548e-03 3 1  ON 23
ci_025                 9.048212e-03 3 1  ON 24
ci_026                 8.948361e-03 3 1  ON 25
ci_027                 6.581047e-03 3 1  ON 26
ci_028                 6.659493e-03 3 1  ON 27
ci_029                -5.210692e-03 3 1  ON 28
ci_030                -5.184382e-03 3 1  ON 29
ci_031                -1.760171e-03 3 1  ON 30
ci_032                -1.775719e-03 3 1  ON 31
ci_033                 4.332402e-03 3 1  ON 32
ci_034                 4.237113e-03 3 1  ON 33
ci_035                 2.752852e-03 3 1  ON 34
ci_036                 2.786987e-03 3 1  ON 35
ci_037                 4.728327e-03 3 1  ON 36
ci_038                 4.543490e-03 3 1  ON 37
ci_039                 4.561946e-03 3 1  ON 38
ci_040                 4.657870e-03 3 1  ON 39
ci_041                 3.725881e-03 3 1  ON 40
ci_042                 3.577347e-03 3 1  ON 41
ci_043                 3.898147e-03 3 1  ON 42
ci_044                 4.051854e-03 3 1  ON 43
ci_045                 3.204785e-03 3 1  ON 44
ci_046                 3.208394e-03 3 1  ON 45
ci_047                -1.610710e-03 3 1  ON 46
ci_048                -1.735974e-03 3 1  ON 47
ci_049                 1.399762e-03 3 1  ON 48
ci_050                 1.499046e-03 3 1  ON 49
ci_051                -2.175059e-03 3 1  ON 50
ci_052                -2.072653e-03 3 1  ON 51
ci_053                -2.241854e-03 3 1  ON 52
ci_054                -2.390083e-03 3 1  ON 53
ci_055                -1.130900e-03 3 1  ON 54
ci_056                -1.646035e-03 3 1  ON 55
ci_057                -1.238662e-03 3 1  ON 56
ci_058                -1.463247e-03 3 1  ON 57
ci_059                -8.410376e-04 3 1  ON 58
ci_060                -6.590504e-04 3 1  ON 59
ci_061                -9.800537e-04 3 1  ON 60
ci_062                -7.336755e-04 3 1  ON 61
ci_063                -5.994654e-04 3 1  ON 62
ci_064                -7.476507e-04 3 1  ON 63
ci_065                -1.901365e-03 3 1  ON 64
ci_066                -2.092992e-03 3 1  ON 65
ci_067                -1.458823e-03 3 1  ON 66
ci_068                -1.090529e-03 3 1  ON 67
ci_069                -6.079504e-06 3 1  ON 68
ci_070                 1.450111e-04 3 1  ON 69
ci_071                -1.883568e-03 3 1  ON 70
ci_072                -1.753110e-03 3 1  ON 71
ci_073                 5.076217e-04 3 1  ON 72
ci_074                 4.829469e-04 3 1  ON 73
ci_075                -2.154667e-04 3 1  ON 74
ci_076                -1.262873e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.6907
    reference variance = 0.356138
====================================================
  Execution time = 4.9717e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9832e-01
  Total weights = 1.9548e+06
  Execution time = 7.2774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483717291524
                                         uncertainty =       0.002402405183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483717291524
                                         uncertainty =       0.002402405183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491809123
  error estimate for blocks of size 2^( 2) =       0.000510784807
  error estimate for blocks of size 2^( 3) =       0.000527356740
  error estimate for blocks of size 2^( 4) =       0.000538645102
  error estimate for blocks of size 2^( 5) =       0.000546741661
  error estimate for blocks of size 2^( 6) =       0.000549745861
  error estimate for blocks of size 2^( 7) =       0.000552701024

      target function =      -0.611268490537
              le_mean =     -22.668783175274
             les_mean =     514.372026489648
             stat err =       0.000546958412
             autocorr =       1.236845493458
   target nu stat err =       0.000546958412
   target dn stat err =       0.004413434648
      target stat err =       0.001366643505
              std dev =       0.695523131792
             le_variance =       0.483752426857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483785987486
                                         uncertainty =       0.002522066719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483785987486
                                         uncertainty =       0.002522066719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491843947
  error estimate for blocks of size 2^( 2) =       0.000510815382
  error estimate for blocks of size 2^( 3) =       0.000527383373
  error estimate for blocks of size 2^( 4) =       0.000538664810
  error estimate for blocks of size 2^( 5) =       0.000546768978
  error estimate for blocks of size 2^( 6) =       0.000549766382
  error estimate for blocks of size 2^( 7) =       0.000552698293

      target function =      -0.610938587843
              le_mean =     -22.668777265859
             les_mean =     514.372839780749
             stat err =       0.000546974616
             autocorr =       1.236743631168
   target nu stat err =       0.000546974616
   target dn stat err =       0.004761223154
      target stat err =       0.001468671762
              std dev =       0.695572379811
             le_variance =       0.483820935555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483734088533
                                         uncertainty =       0.002453465283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483734088533
                                         uncertainty =       0.002453465283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491817621
  error estimate for blocks of size 2^( 2) =       0.000510791471
  error estimate for blocks of size 2^( 3) =       0.000527361494
  error estimate for blocks of size 2^( 4) =       0.000538646573
  error estimate for blocks of size 2^( 5) =       0.000546746804
  error estimate for blocks of size 2^( 6) =       0.000549747909
  error estimate for blocks of size 2^( 7) =       0.000552691995

      target function =      -0.611147712887
              le_mean =     -22.668779910142
             les_mean =     514.372273219681
             stat err =       0.000546958320
             autocorr =       1.236802338200
   target nu stat err =       0.000546958320
   target dn stat err =       0.004548529848
      target stat err =       0.001406299539
              std dev =       0.695535149262
             le_variance =       0.483769143859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483717562816
                                         uncertainty =       0.002407878584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483717562816
                                         uncertainty =       0.002407878584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491809257
  error estimate for blocks of size 2^( 2) =       0.000510784740
  error estimate for blocks of size 2^( 3) =       0.000527356462
  error estimate for blocks of size 2^( 4) =       0.000538644426
  error estimate for blocks of size 2^( 5) =       0.000546741416
  error estimate for blocks of size 2^( 6) =       0.000549745272
  error estimate for blocks of size 2^( 7) =       0.000552699098

      target function =      -0.611273761383
              le_mean =     -22.668782732280
             les_mean =     514.371988616446
             stat err =       0.000546957553
             autocorr =       1.236840935441
   target nu stat err =       0.000546957553
   target dn stat err =       0.004426055136
      target stat err =       0.001370420052
              std dev =       0.695523320746
             le_variance =       0.483752689702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611268490537        initial
     9.5367e-01     9.5367e+00             3.4233e-04        -0.610938587843
     3.8147e+00     3.8147e+01             8.8255e-05        -0.611147712887
     1.5259e+01     1.5259e+02             2.2237e-05        -0.611273761383  <--

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 8.6196e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_001                -7.044409e-01 3 1  ON 0
ci_002                -7.027414e-01 3 1  ON 1
ci_003                -5.375302e-02 3 1  ON 2
ci_004                -5.412066e-02 3 1  ON 3
ci_005                 2.346353e-02 3 1  ON 4
ci_006                 2.353466e-02 3 1  ON 5
ci_007                 1.869007e-02 3 1  ON 6
ci_008                 1.908738e-02 3 1  ON 7
ci_009                -1.500289e-02 3 1  ON 8
ci_010                -1.477550e-02 3 1  ON 9
ci_011                -1.265137e-02 3 1  ON 10
ci_012                -1.220525e-02 3 1  ON 11
ci_013                 1.128494e-02 3 1  ON 12
ci_014                 1.106797e-02 3 1  ON 13
ci_015                 1.270674e-02 3 1  ON 14
ci_016                 1.243701e-02 3 1  ON 15
ci_017                 1.053237e-02 3 1  ON 16
ci_018                 1.052228e-02 3 1  ON 17
ci_019                 3.335641e-03 3 1  ON 18
ci_020                 3.517701e-03 3 1  ON 19
ci_021                -8.110897e-03 3 1  ON 20
ci_022                -8.288373e-03 3 1  ON 21
ci_023                 6.284668e-03 3 1  ON 22
ci_024                 6.348106e-03 3 1  ON 23
ci_025                 9.045606e-03 3 1  ON 24
ci_026                 8.935320e-03 3 1  ON 25
ci_027                 6.578473e-03 3 1  ON 26
ci_028                 6.668304e-03 3 1  ON 27
ci_029                -5.220118e-03 3 1  ON 28
ci_030                -5.181766e-03 3 1  ON 29
ci_031                -1.774089e-03 3 1  ON 30
ci_032                -1.772862e-03 3 1  ON 31
ci_033                 4.341488e-03 3 1  ON 32
ci_034                 4.249742e-03 3 1  ON 33
ci_035                 2.761568e-03 3 1  ON 34
ci_036                 2.794773e-03 3 1  ON 35
ci_037                 4.732390e-03 3 1  ON 36
ci_038                 4.552558e-03 3 1  ON 37
ci_039                 4.560881e-03 3 1  ON 38
ci_040                 4.657672e-03 3 1  ON 39
ci_041                 3.726586e-03 3 1  ON 40
ci_042                 3.576952e-03 3 1  ON 41
ci_043                 3.899186e-03 3 1  ON 42
ci_044                 4.064438e-03 3 1  ON 43
ci_045                 3.204776e-03 3 1  ON 44
ci_046                 3.208634e-03 3 1  ON 45
ci_047                -1.623594e-03 3 1  ON 46
ci_048                -1.733321e-03 3 1  ON 47
ci_049                 1.405125e-03 3 1  ON 48
ci_050                 1.508348e-03 3 1  ON 49
ci_051                -2.177611e-03 3 1  ON 50
ci_052                -2.067560e-03 3 1  ON 51
ci_053                -2.241415e-03 3 1  ON 52
ci_054                -2.396177e-03 3 1  ON 53
ci_055                -1.122215e-03 3 1  ON 54
ci_056                -1.635676e-03 3 1  ON 55
ci_057                -1.234227e-03 3 1  ON 56
ci_058                -1.467217e-03 3 1  ON 57
ci_059                -8.321910e-04 3 1  ON 58
ci_060                -6.668168e-04 3 1  ON 59
ci_061                -9.961189e-04 3 1  ON 60
ci_062                -7.399434e-04 3 1  ON 61
ci_063                -6.027757e-04 3 1  ON 62
ci_064                -7.481130e-04 3 1  ON 63
ci_065                -1.898502e-03 3 1  ON 64
ci_066                -2.096873e-03 3 1  ON 65
ci_067                -1.458961e-03 3 1  ON 66
ci_068                -1.088653e-03 3 1  ON 67
ci_069                -1.777611e-05 3 1  ON 68
ci_070                 1.449893e-04 3 1  ON 69
ci_071                -1.871084e-03 3 1  ON 70
ci_072                -1.743776e-03 3 1  ON 71
ci_073                 5.172402e-04 3 1  ON 72
ci_074                 4.931023e-04 3 1  ON 73
ci_075                -2.133521e-04 3 1  ON 74
ci_076                -1.194417e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4666e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.7006
    reference variance = 0.543734
====================================================
  Execution time = 5.1219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0489e-01
  Total weights = 1.955157538e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491300759045
                                         uncertainty =       0.005785613283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491300759045
                                         uncertainty =       0.005785613283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495725581
  error estimate for blocks of size 2^( 2) =       0.000514422318
  error estimate for blocks of size 2^( 3) =       0.000530322573
  error estimate for blocks of size 2^( 4) =       0.000542202155
  error estimate for blocks of size 2^( 5) =       0.000549879056
  error estimate for blocks of size 2^( 6) =       0.000554405267
  error estimate for blocks of size 2^( 7) =       0.000555682925

      target function =      -0.609139065206
              le_mean =     -22.668264556801
             les_mean =     514.355106396837
             stat err =       0.000550542351
             autocorr =       1.233385405813
   target nu stat err =       0.000550542351
   target dn stat err =       0.008041669202
      target stat err =       0.002437777884
              std dev =       0.701061839718
             le_variance =       0.491487703109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266826455680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609148631764       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609159579455       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609160715295       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609160850033       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609160899115       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609160911845       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609160917107       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609160917522       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609160916447       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609160916712       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 9.230610e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609148631764       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609151389231       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609151674276       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609151708005       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609151720237       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609151723379       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609151724679       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609151724779       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609151724512       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609151724579       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 2.325730e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609148631764       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609149322426       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609149393756       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609149402191       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609149405246       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609149406029       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609149406353       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609149406378       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609149406311       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609149406328       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+01 is 5.825735e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.772494 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0586e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_001                -7.044416e-01 3 1  ON 0
ci_002                -7.027474e-01 3 1  ON 1
ci_003                -5.373846e-02 3 1  ON 2
ci_004                -5.410913e-02 3 1  ON 3
ci_005                 2.344027e-02 3 1  ON 4
ci_006                 2.351214e-02 3 1  ON 5
ci_007                 1.867524e-02 3 1  ON 6
ci_008                 1.907155e-02 3 1  ON 7
ci_009                -1.499751e-02 3 1  ON 8
ci_010                -1.476615e-02 3 1  ON 9
ci_011                -1.263245e-02 3 1  ON 10
ci_012                -1.219312e-02 3 1  ON 11
ci_013                 1.127484e-02 3 1  ON 12
ci_014                 1.105880e-02 3 1  ON 13
ci_015                 1.269096e-02 3 1  ON 14
ci_016                 1.243381e-02 3 1  ON 15
ci_017                 1.052606e-02 3 1  ON 16
ci_018                 1.051482e-02 3 1  ON 17
ci_019                 3.324729e-03 3 1  ON 18
ci_020                 3.512627e-03 3 1  ON 19
ci_021                -8.101086e-03 3 1  ON 20
ci_022                -8.286684e-03 3 1  ON 21
ci_023                 6.274211e-03 3 1  ON 22
ci_024                 6.347910e-03 3 1  ON 23
ci_025                 9.042386e-03 3 1  ON 24
ci_026                 8.937198e-03 3 1  ON 25
ci_027                 6.580309e-03 3 1  ON 26
ci_028                 6.665678e-03 3 1  ON 27
ci_029                -5.213604e-03 3 1  ON 28
ci_030                -5.178023e-03 3 1  ON 29
ci_031                -1.777107e-03 3 1  ON 30
ci_032                -1.767138e-03 3 1  ON 31
ci_033                 4.338883e-03 3 1  ON 32
ci_034                 4.245287e-03 3 1  ON 33
ci_035                 2.759230e-03 3 1  ON 34
ci_036                 2.791330e-03 3 1  ON 35
ci_037                 4.727031e-03 3 1  ON 36
ci_038                 4.554732e-03 3 1  ON 37
ci_039                 4.564287e-03 3 1  ON 38
ci_040                 4.656226e-03 3 1  ON 39
ci_041                 3.724172e-03 3 1  ON 40
ci_042                 3.576946e-03 3 1  ON 41
ci_043                 3.892799e-03 3 1  ON 42
ci_044                 4.062956e-03 3 1  ON 43
ci_045                 3.208594e-03 3 1  ON 44
ci_046                 3.207377e-03 3 1  ON 45
ci_047                -1.621713e-03 3 1  ON 46
ci_048                -1.731221e-03 3 1  ON 47
ci_049                 1.406843e-03 3 1  ON 48
ci_050                 1.504225e-03 3 1  ON 49
ci_051                -2.179093e-03 3 1  ON 50
ci_052                -2.069472e-03 3 1  ON 51
ci_053                -2.239917e-03 3 1  ON 52
ci_054                -2.393630e-03 3 1  ON 53
ci_055                -1.124245e-03 3 1  ON 54
ci_056                -1.636583e-03 3 1  ON 55
ci_057                -1.231571e-03 3 1  ON 56
ci_058                -1.466340e-03 3 1  ON 57
ci_059                -8.312368e-04 3 1  ON 58
ci_060                -6.657781e-04 3 1  ON 59
ci_061                -9.947328e-04 3 1  ON 60
ci_062                -7.377532e-04 3 1  ON 61
ci_063                -6.026532e-04 3 1  ON 62
ci_064                -7.478143e-04 3 1  ON 63
ci_065                -1.900890e-03 3 1  ON 64
ci_066                -2.100407e-03 3 1  ON 65
ci_067                -1.460221e-03 3 1  ON 66
ci_068                -1.090717e-03 3 1  ON 67
ci_069                -1.870661e-05 3 1  ON 68
ci_070                 1.417465e-04 3 1  ON 69
ci_071                -1.871532e-03 3 1  ON 70
ci_072                -1.744696e-03 3 1  ON 71
ci_073                 5.151492e-04 3 1  ON 72
ci_074                 4.923197e-04 3 1  ON 73
ci_075                -2.087313e-04 3 1  ON 74
ci_076                -1.189885e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.7906
    reference variance = 0.717423
====================================================
  Execution time = 4.9672e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0152e-01
  Total weights = 1.9552e+06
  Execution time = 7.2245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486797307543
                                         uncertainty =       0.002732101913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486797307543
                                         uncertainty =       0.002732101913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493314506
  error estimate for blocks of size 2^( 2) =       0.000511589935
  error estimate for blocks of size 2^( 3) =       0.000528190308
  error estimate for blocks of size 2^( 4) =       0.000540292664
  error estimate for blocks of size 2^( 5) =       0.000547126911
  error estimate for blocks of size 2^( 6) =       0.000548735976
  error estimate for blocks of size 2^( 7) =       0.000550873638

      target function =      -0.610454085965
              le_mean =     -22.669545607218
             les_mean =     514.409902082087
             stat err =       0.000546757297
             autocorr =       1.228404515356
   target nu stat err =       0.000546757297
   target dn stat err =       0.005751705803
      target stat err =       0.001762963062
              std dev =       0.697652064566
             le_variance =       0.486718403194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486722980185
                                         uncertainty =       0.002731090993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486722980185
                                         uncertainty =       0.002731090993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493276826
  error estimate for blocks of size 2^( 2) =       0.000511552911
  error estimate for blocks of size 2^( 3) =       0.000528153604
  error estimate for blocks of size 2^( 4) =       0.000540255496
  error estimate for blocks of size 2^( 5) =       0.000547088881
  error estimate for blocks of size 2^( 6) =       0.000548698232
  error estimate for blocks of size 2^( 7) =       0.000550836529

      target function =      -0.610528156042
              le_mean =     -22.669544963014
             les_mean =     514.409627808039
             stat err =       0.000546719784
             autocorr =       1.228423608848
   target nu stat err =       0.000546719784
   target dn stat err =       0.005750689956
      target stat err =       0.001763077986
              std dev =       0.697598777502
             le_variance =       0.486644054372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486759684736
                                         uncertainty =       0.002731582488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486759684736
                                         uncertainty =       0.002731582488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493295434
  error estimate for blocks of size 2^( 2) =       0.000511571194
  error estimate for blocks of size 2^( 3) =       0.000528171724
  error estimate for blocks of size 2^( 4) =       0.000540273848
  error estimate for blocks of size 2^( 5) =       0.000547107661
  error estimate for blocks of size 2^( 6) =       0.000548716842
  error estimate for blocks of size 2^( 7) =       0.000550854820

      target function =      -0.610499486127
              le_mean =     -22.669545252577
             les_mean =     514.409735824676
             stat err =       0.000546738293
             autocorr =       1.228414105073
   target nu stat err =       0.000546738293
   target dn stat err =       0.005750137923
      target stat err =       0.001762750965
              std dev =       0.697625092523
             le_variance =       0.486680769717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486792575013
                                         uncertainty =       0.002732035807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486792575013
                                         uncertainty =       0.002732035807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493312107
  error estimate for blocks of size 2^( 2) =       0.000511587577
  error estimate for blocks of size 2^( 3) =       0.000528187970
  error estimate for blocks of size 2^( 4) =       0.000540290297
  error estimate for blocks of size 2^( 5) =       0.000547124490
  error estimate for blocks of size 2^( 6) =       0.000548733564
  error estimate for blocks of size 2^( 7) =       0.000550871265

      target function =      -0.610461229999
              le_mean =     -22.669545559188
             les_mean =     514.409876278938
             stat err =       0.000546754904
             autocorr =       1.228405708263
   target nu stat err =       0.000546754904
   target dn stat err =       0.005751254390
      target stat err =       0.001762868493
              std dev =       0.697648671856
             le_variance =       0.486713669343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610454085965        initial
     3.8147e+00     3.8147e+01             9.2306e-05        -0.610528156042  <--
     1.5259e+01     1.5259e+02             2.3257e-05        -0.610499486127
     6.1035e+01     6.1035e+02             5.8257e-06        -0.610461229999

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 8.6772e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_001                -7.044436e-01 3 1  ON 0
ci_002                -7.027651e-01 3 1  ON 1
ci_003                -5.369497e-02 3 1  ON 2
ci_004                -5.407468e-02 3 1  ON 3
ci_005                 2.337122e-02 3 1  ON 4
ci_006                 2.344528e-02 3 1  ON 5
ci_007                 1.863114e-02 3 1  ON 6
ci_008                 1.902450e-02 3 1  ON 7
ci_009                -1.498151e-02 3 1  ON 8
ci_010                -1.473834e-02 3 1  ON 9
ci_011                -1.257617e-02 3 1  ON 10
ci_012                -1.215703e-02 3 1  ON 11
ci_013                 1.124483e-02 3 1  ON 12
ci_014                 1.103156e-02 3 1  ON 13
ci_015                 1.264400e-02 3 1  ON 14
ci_016                 1.242430e-02 3 1  ON 15
ci_017                 1.050732e-02 3 1  ON 16
ci_018                 1.049263e-02 3 1  ON 17
ci_019                 3.292233e-03 3 1  ON 18
ci_020                 3.497509e-03 3 1  ON 19
ci_021                -8.071880e-03 3 1  ON 20
ci_022                -8.281663e-03 3 1  ON 21
ci_023                 6.243152e-03 3 1  ON 22
ci_024                 6.347331e-03 3 1  ON 23
ci_025                 9.032827e-03 3 1  ON 24
ci_026                 8.942788e-03 3 1  ON 25
ci_027                 6.585763e-03 3 1  ON 26
ci_028                 6.657884e-03 3 1  ON 27
ci_029                -5.194231e-03 3 1  ON 28
ci_030                -5.166871e-03 3 1  ON 29
ci_031                -1.786103e-03 3 1  ON 30
ci_032                -1.750107e-03 3 1  ON 31
ci_033                 4.331130e-03 3 1  ON 32
ci_034                 4.232038e-03 3 1  ON 33
ci_035                 2.752279e-03 3 1  ON 34
ci_036                 2.781099e-03 3 1  ON 35
ci_037                 4.711085e-03 3 1  ON 36
ci_038                 4.561191e-03 3 1  ON 37
ci_039                 4.574400e-03 3 1  ON 38
ci_040                 4.651938e-03 3 1  ON 39
ci_041                 3.717004e-03 3 1  ON 40
ci_042                 3.576931e-03 3 1  ON 41
ci_043                 3.873784e-03 3 1  ON 42
ci_044                 4.058541e-03 3 1  ON 43
ci_045                 3.219957e-03 3 1  ON 44
ci_046                 3.203651e-03 3 1  ON 45
ci_047                -1.616118e-03 3 1  ON 46
ci_048                -1.724976e-03 3 1  ON 47
ci_049                 1.411944e-03 3 1  ON 48
ci_050                 1.491975e-03 3 1  ON 49
ci_051                -2.183481e-03 3 1  ON 50
ci_052                -2.075134e-03 3 1  ON 51
ci_053                -2.235475e-03 3 1  ON 52
ci_054                -2.386065e-03 3 1  ON 53
ci_055                -1.130293e-03 3 1  ON 54
ci_056                -1.639286e-03 3 1  ON 55
ci_057                -1.223680e-03 3 1  ON 56
ci_058                -1.463731e-03 3 1  ON 57
ci_059                -8.283973e-04 3 1  ON 58
ci_060                -6.626951e-04 3 1  ON 59
ci_061                -9.906049e-04 3 1  ON 60
ci_062                -7.312376e-04 3 1  ON 61
ci_063                -6.022932e-04 3 1  ON 62
ci_064                -7.469397e-04 3 1  ON 63
ci_065                -1.907991e-03 3 1  ON 64
ci_066                -2.110908e-03 3 1  ON 65
ci_067                -1.463963e-03 3 1  ON 66
ci_068                -1.096858e-03 3 1  ON 67
ci_069                -2.147725e-05 3 1  ON 68
ci_070                 1.321031e-04 3 1  ON 69
ci_071                -1.872845e-03 3 1  ON 70
ci_072                -1.747416e-03 3 1  ON 71
ci_073                 5.089380e-04 3 1  ON 72
ci_074                 4.899954e-04 3 1  ON 73
ci_075                -1.949932e-04 3 1  ON 74
ci_076                -1.176387e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4737e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.6991
    reference variance = 0.307612
====================================================
  Execution time = 5.1143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0414e-01
  Total weights = 1.954929022e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488536136438
                                         uncertainty =       0.002763456621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488536136438
                                         uncertainty =       0.002763456621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494300694
  error estimate for blocks of size 2^( 2) =       0.000513568050
  error estimate for blocks of size 2^( 3) =       0.000530804369
  error estimate for blocks of size 2^( 4) =       0.000543783004
  error estimate for blocks of size 2^( 5) =       0.000550935771
  error estimate for blocks of size 2^( 6) =       0.000555609406
  error estimate for blocks of size 2^( 7) =       0.000556766366

      target function =      -0.609566211821
              le_mean =     -22.669051505630
             les_mean =     514.390035851001
             stat err =       0.000551773637
             autocorr =       1.246061425906
   target nu stat err =       0.000551773637
   target dn stat err =       0.004728290958
      target stat err =       0.001453196359
              std dev =       0.699046746007
             le_variance =       0.488666353103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266905150563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609569381029       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609611522866       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609616632974       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609616743815       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609616826408       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609616851065       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609616841279       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609616845063       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609616844874       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609616851796       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 3.392968e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609569381029       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609580231917       residual = 5.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609581528192       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609581554510       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609581575135       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609581581107       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609581578566       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609581579500       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609581579451       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609581581078       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 8.745330e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609569381029       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609572114206       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609572439453       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609572445940       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609572451095       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609572452576       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609572451934       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609572452167       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609572452155       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609572452555       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 2.203405e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.777698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0568e+01
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_001                -7.044394e-01 3 1  ON 0
ci_002                -7.027923e-01 3 1  ON 1
ci_003                -5.365812e-02 3 1  ON 2
ci_004                -5.403528e-02 3 1  ON 3
ci_005                 2.328377e-02 3 1  ON 4
ci_006                 2.335808e-02 3 1  ON 5
ci_007                 1.856232e-02 3 1  ON 6
ci_008                 1.895669e-02 3 1  ON 7
ci_009                -1.493551e-02 3 1  ON 8
ci_010                -1.470944e-02 3 1  ON 9
ci_011                -1.253794e-02 3 1  ON 10
ci_012                -1.210489e-02 3 1  ON 11
ci_013                 1.120713e-02 3 1  ON 12
ci_014                 1.098444e-02 3 1  ON 13
ci_015                 1.262303e-02 3 1  ON 14
ci_016                 1.238649e-02 3 1  ON 15
ci_017                 1.047759e-02 3 1  ON 16
ci_018                 1.047078e-02 3 1  ON 17
ci_019                 3.240542e-03 3 1  ON 18
ci_020                 3.473092e-03 3 1  ON 19
ci_021                -8.062963e-03 3 1  ON 20
ci_022                -8.283199e-03 3 1  ON 21
ci_023                 6.249868e-03 3 1  ON 22
ci_024                 6.336050e-03 3 1  ON 23
ci_025                 9.026885e-03 3 1  ON 24
ci_026                 8.965018e-03 3 1  ON 25
ci_027                 6.596986e-03 3 1  ON 26
ci_028                 6.650035e-03 3 1  ON 27
ci_029                -5.182636e-03 3 1  ON 28
ci_030                -5.146292e-03 3 1  ON 29
ci_031                -1.751132e-03 3 1  ON 30
ci_032                -1.702773e-03 3 1  ON 31
ci_033                 4.322722e-03 3 1  ON 32
ci_034                 4.225358e-03 3 1  ON 33
ci_035                 2.741506e-03 3 1  ON 34
ci_036                 2.764228e-03 3 1  ON 35
ci_037                 4.687440e-03 3 1  ON 36
ci_038                 4.533177e-03 3 1  ON 37
ci_039                 4.558800e-03 3 1  ON 38
ci_040                 4.647205e-03 3 1  ON 39
ci_041                 3.721861e-03 3 1  ON 40
ci_042                 3.574476e-03 3 1  ON 41
ci_043                 3.861177e-03 3 1  ON 42
ci_044                 4.055645e-03 3 1  ON 43
ci_045                 3.219422e-03 3 1  ON 44
ci_046                 3.195865e-03 3 1  ON 45
ci_047                -1.591313e-03 3 1  ON 46
ci_048                -1.708742e-03 3 1  ON 47
ci_049                 1.424476e-03 3 1  ON 48
ci_050                 1.481155e-03 3 1  ON 49
ci_051                -2.180026e-03 3 1  ON 50
ci_052                -2.075236e-03 3 1  ON 51
ci_053                -2.253512e-03 3 1  ON 52
ci_054                -2.393025e-03 3 1  ON 53
ci_055                -1.136927e-03 3 1  ON 54
ci_056                -1.624968e-03 3 1  ON 55
ci_057                -1.232571e-03 3 1  ON 56
ci_058                -1.456213e-03 3 1  ON 57
ci_059                -8.148903e-04 3 1  ON 58
ci_060                -6.571316e-04 3 1  ON 59
ci_061                -9.836759e-04 3 1  ON 60
ci_062                -7.178802e-04 3 1  ON 61
ci_063                -6.022367e-04 3 1  ON 62
ci_064                -7.471788e-04 3 1  ON 63
ci_065                -1.910248e-03 3 1  ON 64
ci_066                -2.117477e-03 3 1  ON 65
ci_067                -1.471131e-03 3 1  ON 66
ci_068                -1.111186e-03 3 1  ON 67
ci_069                -3.440603e-05 3 1  ON 68
ci_070                 1.286236e-04 3 1  ON 69
ci_071                -1.890994e-03 3 1  ON 70
ci_072                -1.761829e-03 3 1  ON 71
ci_073                 5.050916e-04 3 1  ON 72
ci_074                 4.793684e-04 3 1  ON 73
ci_075                -1.906967e-04 3 1  ON 74
ci_076                -1.265236e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.6601
    reference variance = 0.359904
====================================================
  Execution time = 4.9547e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9807e-01
  Total weights = 1.9553e+06
  Execution time = 7.2318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487004712988
                                         uncertainty =       0.003032302954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487004712988
                                         uncertainty =       0.003032302954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493445322
  error estimate for blocks of size 2^( 2) =       0.000511800863
  error estimate for blocks of size 2^( 3) =       0.000527809663
  error estimate for blocks of size 2^( 4) =       0.000540309493
  error estimate for blocks of size 2^( 5) =       0.000547931802
  error estimate for blocks of size 2^( 6) =       0.000552071470
  error estimate for blocks of size 2^( 7) =       0.000554326810

      target function =      -0.611199674716
              le_mean =     -22.668175716945
             les_mean =     514.344214317799
             stat err =       0.000548659894
             autocorr =       1.236312776013
   target nu stat err =       0.000548659894
   target dn stat err =       0.003431023910
      target stat err =       0.001075523755
              std dev =       0.697837067011
             le_variance =       0.486976572094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486729916964
                                         uncertainty =       0.003012059664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486729916964
                                         uncertainty =       0.003012059664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493306182
  error estimate for blocks of size 2^( 2) =       0.000511664842
  error estimate for blocks of size 2^( 3) =       0.000527672038
  error estimate for blocks of size 2^( 4) =       0.000540172562
  error estimate for blocks of size 2^( 5) =       0.000547783058
  error estimate for blocks of size 2^( 6) =       0.000551921284
  error estimate for blocks of size 2^( 7) =       0.000554163187

      target function =      -0.610945385632
              le_mean =     -22.668177004067
             les_mean =     514.345112378993
             stat err =       0.000548510023
             autocorr =       1.236334588507
   target nu stat err =       0.000548510023
   target dn stat err =       0.003496326440
      target stat err =       0.001093794370
              std dev =       0.697640293004
             le_variance =       0.486701978422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486861078171
                                         uncertainty =       0.003021800418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486861078171
                                         uncertainty =       0.003021800418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493372599
  error estimate for blocks of size 2^( 2) =       0.000511729719
  error estimate for blocks of size 2^( 3) =       0.000527737625
  error estimate for blocks of size 2^( 4) =       0.000540237831
  error estimate for blocks of size 2^( 5) =       0.000547854242
  error estimate for blocks of size 2^( 6) =       0.000551993935
  error estimate for blocks of size 2^( 7) =       0.000554241588

      target function =      -0.611104511221
              le_mean =     -22.668176066825
             les_mean =     514.344544261758
             stat err =       0.000548581899
             autocorr =       1.236325693781
   target nu stat err =       0.000548581899
   target dn stat err =       0.003448266143
      target stat err =       0.001080248011
              std dev =       0.697734221045
             le_variance =       0.486833043217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986355414
                                         uncertainty =       0.003030969996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986355414
                                         uncertainty =       0.003030969996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493436028
  error estimate for blocks of size 2^( 2) =       0.000511791758
  error estimate for blocks of size 2^( 3) =       0.000527800446
  error estimate for blocks of size 2^( 4) =       0.000540300318
  error estimate for blocks of size 2^( 5) =       0.000547921885
  error estimate for blocks of size 2^( 6) =       0.000552061532
  error estimate for blocks of size 2^( 7) =       0.000554315944

      target function =      -0.611197754183
              le_mean =     -22.668175719573
             les_mean =     514.344220769471
             stat err =       0.000548649920
             autocorr =       1.236314399095
   target nu stat err =       0.000548649920
   target dn stat err =       0.003431826191
      target stat err =       0.001075751343
              std dev =       0.697823923401
             le_variance =       0.486958228071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611199674716        initial  <--
     9.5367e-01     9.5367e+00             3.3930e-04        -0.610945385632
     3.8147e+00     3.8147e+01             8.7453e-05        -0.611104511221
     1.5259e+01     1.5259e+02             2.2034e-05        -0.611197754183

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 85.7963
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_001                -7.044436e-01 3 1  ON 0
ci_002                -7.027651e-01 3 1  ON 1
ci_003                -5.369497e-02 3 1  ON 2
ci_004                -5.407468e-02 3 1  ON 3
ci_005                 2.337122e-02 3 1  ON 4
ci_006                 2.344528e-02 3 1  ON 5
ci_007                 1.863114e-02 3 1  ON 6
ci_008                 1.902450e-02 3 1  ON 7
ci_009                -1.498151e-02 3 1  ON 8
ci_010                -1.473834e-02 3 1  ON 9
ci_011                -1.257617e-02 3 1  ON 10
ci_012                -1.215703e-02 3 1  ON 11
ci_013                 1.124483e-02 3 1  ON 12
ci_014                 1.103156e-02 3 1  ON 13
ci_015                 1.264400e-02 3 1  ON 14
ci_016                 1.242430e-02 3 1  ON 15
ci_017                 1.050732e-02 3 1  ON 16
ci_018                 1.049263e-02 3 1  ON 17
ci_019                 3.292233e-03 3 1  ON 18
ci_020                 3.497509e-03 3 1  ON 19
ci_021                -8.071880e-03 3 1  ON 20
ci_022                -8.281663e-03 3 1  ON 21
ci_023                 6.243152e-03 3 1  ON 22
ci_024                 6.347331e-03 3 1  ON 23
ci_025                 9.032827e-03 3 1  ON 24
ci_026                 8.942788e-03 3 1  ON 25
ci_027                 6.585763e-03 3 1  ON 26
ci_028                 6.657884e-03 3 1  ON 27
ci_029                -5.194231e-03 3 1  ON 28
ci_030                -5.166871e-03 3 1  ON 29
ci_031                -1.786103e-03 3 1  ON 30
ci_032                -1.750107e-03 3 1  ON 31
ci_033                 4.331130e-03 3 1  ON 32
ci_034                 4.232038e-03 3 1  ON 33
ci_035                 2.752279e-03 3 1  ON 34
ci_036                 2.781099e-03 3 1  ON 35
ci_037                 4.711085e-03 3 1  ON 36
ci_038                 4.561191e-03 3 1  ON 37
ci_039                 4.574400e-03 3 1  ON 38
ci_040                 4.651938e-03 3 1  ON 39
ci_041                 3.717004e-03 3 1  ON 40
ci_042                 3.576931e-03 3 1  ON 41
ci_043                 3.873784e-03 3 1  ON 42
ci_044                 4.058541e-03 3 1  ON 43
ci_045                 3.219957e-03 3 1  ON 44
ci_046                 3.203651e-03 3 1  ON 45
ci_047                -1.616118e-03 3 1  ON 46
ci_048                -1.724976e-03 3 1  ON 47
ci_049                 1.411944e-03 3 1  ON 48
ci_050                 1.491975e-03 3 1  ON 49
ci_051                -2.183481e-03 3 1  ON 50
ci_052                -2.075134e-03 3 1  ON 51
ci_053                -2.235475e-03 3 1  ON 52
ci_054                -2.386065e-03 3 1  ON 53
ci_055                -1.130293e-03 3 1  ON 54
ci_056                -1.639286e-03 3 1  ON 55
ci_057                -1.223680e-03 3 1  ON 56
ci_058                -1.463731e-03 3 1  ON 57
ci_059                -8.283973e-04 3 1  ON 58
ci_060                -6.626951e-04 3 1  ON 59
ci_061                -9.906049e-04 3 1  ON 60
ci_062                -7.312376e-04 3 1  ON 61
ci_063                -6.022932e-04 3 1  ON 62
ci_064                -7.469397e-04 3 1  ON 63
ci_065                -1.907991e-03 3 1  ON 64
ci_066                -2.110908e-03 3 1  ON 65
ci_067                -1.463963e-03 3 1  ON 66
ci_068                -1.096858e-03 3 1  ON 67
ci_069                -2.147725e-05 3 1  ON 68
ci_070                 1.321031e-04 3 1  ON 69
ci_071                -1.872845e-03 3 1  ON 70
ci_072                -1.747416e-03 3 1  ON 71
ci_073                 5.089380e-04 3 1  ON 72
ci_074                 4.899954e-04 3 1  ON 73
ci_075                -1.949932e-04 3 1  ON 74
ci_076                -1.176387e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4637e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.6237
    reference variance = 0.385271
====================================================
  Execution time = 5.1112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1206e-01
  Total weights = 1.955118101e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493238702287
                                         uncertainty =       0.008633483641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493238702287
                                         uncertainty =       0.008633483641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496593359
  error estimate for blocks of size 2^( 2) =       0.000514323739
  error estimate for blocks of size 2^( 3) =       0.000531564660
  error estimate for blocks of size 2^( 4) =       0.000543669482
  error estimate for blocks of size 2^( 5) =       0.000550566437
  error estimate for blocks of size 2^( 6) =       0.000553901332
  error estimate for blocks of size 2^( 7) =       0.000555861282

      target function =      -0.607084430518
              le_mean =     -22.668721353529
             les_mean =     514.382988393641
             stat err =       0.000550999633
             autocorr =       1.231121185912
   target nu stat err =       0.000550999633
   target dn stat err =       0.012431547454
      target stat err =       0.003731105941
              std dev =       0.702289063041
             le_variance =       0.493209928066


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266872135353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607107128178       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607111322813       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607111831220       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607111861838       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607111868338       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607111871903       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607111873052       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607111872977       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607111873297       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607111873244       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 3.659264e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607107128178       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607108179994       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607108307284       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607108314937       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607108316560       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607108317448       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607108317734       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607108317714       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607108317794       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607108317781       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 9.176931e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607107128178       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607107391330       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607107423165       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607107425078       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607107425483       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607107425705       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607107425777       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607107425772       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607107425792       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607107425788       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+02 is 2.296038e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.782972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0552e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_001                -7.044429e-01 3 1  ON 0
ci_002                -7.027676e-01 3 1  ON 1
ci_003                -5.369217e-02 3 1  ON 2
ci_004                -5.407563e-02 3 1  ON 3
ci_005                 2.336204e-02 3 1  ON 4
ci_006                 2.343613e-02 3 1  ON 5
ci_007                 1.862408e-02 3 1  ON 6
ci_008                 1.901972e-02 3 1  ON 7
ci_009                -1.497802e-02 3 1  ON 8
ci_010                -1.473509e-02 3 1  ON 9
ci_011                -1.257069e-02 3 1  ON 10
ci_012                -1.215041e-02 3 1  ON 11
ci_013                 1.123868e-02 3 1  ON 12
ci_014                 1.102808e-02 3 1  ON 13
ci_015                 1.263679e-02 3 1  ON 14
ci_016                 1.241978e-02 3 1  ON 15
ci_017                 1.050537e-02 3 1  ON 16
ci_018                 1.049143e-02 3 1  ON 17
ci_019                 3.292463e-03 3 1  ON 18
ci_020                 3.495874e-03 3 1  ON 19
ci_021                -8.069942e-03 3 1  ON 20
ci_022                -8.284481e-03 3 1  ON 21
ci_023                 6.242176e-03 3 1  ON 22
ci_024                 6.344314e-03 3 1  ON 23
ci_025                 9.032650e-03 3 1  ON 24
ci_026                 8.941509e-03 3 1  ON 25
ci_027                 6.587242e-03 3 1  ON 26
ci_028                 6.657573e-03 3 1  ON 27
ci_029                -5.193444e-03 3 1  ON 28
ci_030                -5.166082e-03 3 1  ON 29
ci_031                -1.784828e-03 3 1  ON 30
ci_032                -1.746170e-03 3 1  ON 31
ci_033                 4.331272e-03 3 1  ON 32
ci_034                 4.233475e-03 3 1  ON 33
ci_035                 2.751419e-03 3 1  ON 34
ci_036                 2.780088e-03 3 1  ON 35
ci_037                 4.710118e-03 3 1  ON 36
ci_038                 4.561724e-03 3 1  ON 37
ci_039                 4.575621e-03 3 1  ON 38
ci_040                 4.651294e-03 3 1  ON 39
ci_041                 3.716402e-03 3 1  ON 40
ci_042                 3.575410e-03 3 1  ON 41
ci_043                 3.872815e-03 3 1  ON 42
ci_044                 4.056774e-03 3 1  ON 43
ci_045                 3.219108e-03 3 1  ON 44
ci_046                 3.202324e-03 3 1  ON 45
ci_047                -1.614526e-03 3 1  ON 46
ci_048                -1.724610e-03 3 1  ON 47
ci_049                 1.410660e-03 3 1  ON 48
ci_050                 1.492417e-03 3 1  ON 49
ci_051                -2.181460e-03 3 1  ON 50
ci_052                -2.077282e-03 3 1  ON 51
ci_053                -2.235249e-03 3 1  ON 52
ci_054                -2.387446e-03 3 1  ON 53
ci_055                -1.132337e-03 3 1  ON 54
ci_056                -1.640706e-03 3 1  ON 55
ci_057                -1.222775e-03 3 1  ON 56
ci_058                -1.464774e-03 3 1  ON 57
ci_059                -8.277272e-04 3 1  ON 58
ci_060                -6.631954e-04 3 1  ON 59
ci_061                -9.900542e-04 3 1  ON 60
ci_062                -7.299703e-04 3 1  ON 61
ci_063                -6.048827e-04 3 1  ON 62
ci_064                -7.482552e-04 3 1  ON 63
ci_065                -1.909760e-03 3 1  ON 64
ci_066                -2.109866e-03 3 1  ON 65
ci_067                -1.464811e-03 3 1  ON 66
ci_068                -1.097785e-03 3 1  ON 67
ci_069                -2.156053e-05 3 1  ON 68
ci_070                 1.326053e-04 3 1  ON 69
ci_071                -1.873606e-03 3 1  ON 70
ci_072                -1.746346e-03 3 1  ON 71
ci_073                 5.090685e-04 3 1  ON 72
ci_074                 4.904379e-04 3 1  ON 73
ci_075                -1.938042e-04 3 1  ON 74
ci_076                -1.164946e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7809
    reference variance = 1.15292
====================================================
  Execution time = 4.9740e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0134e-01
  Total weights = 1.9551e+06
  Execution time = 7.2197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488241173219
                                         uncertainty =       0.003433773573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488241173219
                                         uncertainty =       0.003433773573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494117511
  error estimate for blocks of size 2^( 2) =       0.000512019501
  error estimate for blocks of size 2^( 3) =       0.000529069154
  error estimate for blocks of size 2^( 4) =       0.000540474471
  error estimate for blocks of size 2^( 5) =       0.000547923195
  error estimate for blocks of size 2^( 6) =       0.000552732321
  error estimate for blocks of size 2^( 7) =       0.000551679610

      target function =      -0.610156501970
              le_mean =     -22.668041210422
             les_mean =     514.341448161402
             stat err =       0.000548202399
             autocorr =       1.230896036865
   target nu stat err =       0.000548202399
   target dn stat err =       0.004195020900
      target stat err =       0.001296465719
              std dev =       0.698787685561
             le_variance =       0.488304229492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488225303912
                                         uncertainty =       0.003434492652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488225303912
                                         uncertainty =       0.003434492652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494109496
  error estimate for blocks of size 2^( 2) =       0.000512011554
  error estimate for blocks of size 2^( 3) =       0.000529061140
  error estimate for blocks of size 2^( 4) =       0.000540465858
  error estimate for blocks of size 2^( 5) =       0.000547914583
  error estimate for blocks of size 2^( 6) =       0.000552723565
  error estimate for blocks of size 2^( 7) =       0.000551670845

      target function =      -0.610159400630
              le_mean =     -22.668041525150
             les_mean =     514.341453079976
             stat err =       0.000548193712
             autocorr =       1.230896961163
   target nu stat err =       0.000548193712
   target dn stat err =       0.004199156797
      target stat err =       0.001297699382
              std dev =       0.698776350420
             le_variance =       0.488288387906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488233180268
                                         uncertainty =       0.003434131863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488233180268
                                         uncertainty =       0.003434131863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494113474
  error estimate for blocks of size 2^( 2) =       0.000512015498
  error estimate for blocks of size 2^( 3) =       0.000529065117
  error estimate for blocks of size 2^( 4) =       0.000540470133
  error estimate for blocks of size 2^( 5) =       0.000547918859
  error estimate for blocks of size 2^( 6) =       0.000552727911
  error estimate for blocks of size 2^( 7) =       0.000551675190

      target function =      -0.610161174739
              le_mean =     -22.668041365755
             les_mean =     514.341439860950
             stat err =       0.000548198023
             autocorr =       1.230896500013
   target nu stat err =       0.000548198023
   target dn stat err =       0.004196905488
      target stat err =       0.001297041755
              std dev =       0.698781976321
             le_variance =       0.488296250431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488240169347
                                         uncertainty =       0.003433818123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488240169347
                                         uncertainty =       0.003433818123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494117004
  error estimate for blocks of size 2^( 2) =       0.000512018999
  error estimate for blocks of size 2^( 3) =       0.000529068648
  error estimate for blocks of size 2^( 4) =       0.000540473926
  error estimate for blocks of size 2^( 5) =       0.000547922651
  error estimate for blocks of size 2^( 6) =       0.000552731767
  error estimate for blocks of size 2^( 7) =       0.000551679052

      target function =      -0.610158604598
              le_mean =     -22.668041229923
             les_mean =     514.341442102832
             stat err =       0.000548201849
             autocorr =       1.230896092967
   target nu stat err =       0.000548201849
   target dn stat err =       0.004195222839
      target stat err =       0.001296534095
              std dev =       0.698786968509
             le_variance =       0.488303227357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610156501970        initial
     9.5367e+00     9.5367e+01             3.6593e-05        -0.610159400630
     3.8147e+01     3.8147e+02             9.1769e-06        -0.610161174739  <--
     1.5259e+02     1.5259e+03             2.2960e-06        -0.610158604598

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 8.6670e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_001                -7.044429e-01 3 1  ON 0
ci_002                -7.027676e-01 3 1  ON 1
ci_003                -5.369217e-02 3 1  ON 2
ci_004                -5.407563e-02 3 1  ON 3
ci_005                 2.336204e-02 3 1  ON 4
ci_006                 2.343613e-02 3 1  ON 5
ci_007                 1.862408e-02 3 1  ON 6
ci_008                 1.901972e-02 3 1  ON 7
ci_009                -1.497802e-02 3 1  ON 8
ci_010                -1.473509e-02 3 1  ON 9
ci_011                -1.257069e-02 3 1  ON 10
ci_012                -1.215041e-02 3 1  ON 11
ci_013                 1.123868e-02 3 1  ON 12
ci_014                 1.102808e-02 3 1  ON 13
ci_015                 1.263679e-02 3 1  ON 14
ci_016                 1.241978e-02 3 1  ON 15
ci_017                 1.050537e-02 3 1  ON 16
ci_018                 1.049143e-02 3 1  ON 17
ci_019                 3.292463e-03 3 1  ON 18
ci_020                 3.495874e-03 3 1  ON 19
ci_021                -8.069942e-03 3 1  ON 20
ci_022                -8.284481e-03 3 1  ON 21
ci_023                 6.242176e-03 3 1  ON 22
ci_024                 6.344314e-03 3 1  ON 23
ci_025                 9.032650e-03 3 1  ON 24
ci_026                 8.941509e-03 3 1  ON 25
ci_027                 6.587242e-03 3 1  ON 26
ci_028                 6.657573e-03 3 1  ON 27
ci_029                -5.193444e-03 3 1  ON 28
ci_030                -5.166082e-03 3 1  ON 29
ci_031                -1.784828e-03 3 1  ON 30
ci_032                -1.746170e-03 3 1  ON 31
ci_033                 4.331272e-03 3 1  ON 32
ci_034                 4.233475e-03 3 1  ON 33
ci_035                 2.751419e-03 3 1  ON 34
ci_036                 2.780088e-03 3 1  ON 35
ci_037                 4.710118e-03 3 1  ON 36
ci_038                 4.561724e-03 3 1  ON 37
ci_039                 4.575621e-03 3 1  ON 38
ci_040                 4.651294e-03 3 1  ON 39
ci_041                 3.716402e-03 3 1  ON 40
ci_042                 3.575410e-03 3 1  ON 41
ci_043                 3.872815e-03 3 1  ON 42
ci_044                 4.056774e-03 3 1  ON 43
ci_045                 3.219108e-03 3 1  ON 44
ci_046                 3.202324e-03 3 1  ON 45
ci_047                -1.614526e-03 3 1  ON 46
ci_048                -1.724610e-03 3 1  ON 47
ci_049                 1.410660e-03 3 1  ON 48
ci_050                 1.492417e-03 3 1  ON 49
ci_051                -2.181460e-03 3 1  ON 50
ci_052                -2.077282e-03 3 1  ON 51
ci_053                -2.235249e-03 3 1  ON 52
ci_054                -2.387446e-03 3 1  ON 53
ci_055                -1.132337e-03 3 1  ON 54
ci_056                -1.640706e-03 3 1  ON 55
ci_057                -1.222775e-03 3 1  ON 56
ci_058                -1.464774e-03 3 1  ON 57
ci_059                -8.277272e-04 3 1  ON 58
ci_060                -6.631954e-04 3 1  ON 59
ci_061                -9.900542e-04 3 1  ON 60
ci_062                -7.299703e-04 3 1  ON 61
ci_063                -6.048827e-04 3 1  ON 62
ci_064                -7.482552e-04 3 1  ON 63
ci_065                -1.909760e-03 3 1  ON 64
ci_066                -2.109866e-03 3 1  ON 65
ci_067                -1.464811e-03 3 1  ON 66
ci_068                -1.097785e-03 3 1  ON 67
ci_069                -2.156053e-05 3 1  ON 68
ci_070                 1.326053e-04 3 1  ON 69
ci_071                -1.873606e-03 3 1  ON 70
ci_072                -1.746346e-03 3 1  ON 71
ci_073                 5.090685e-04 3 1  ON 72
ci_074                 4.904379e-04 3 1  ON 73
ci_075                -1.938042e-04 3 1  ON 74
ci_076                -1.164946e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4723e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.6232
    reference variance = 0.386497
====================================================
  Execution time = 5.1246e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0864e-01
  Total weights = 1.954843528e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491651806864
                                         uncertainty =       0.003041264682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491651806864
                                         uncertainty =       0.003041264682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495757174
  error estimate for blocks of size 2^( 2) =       0.000514107027
  error estimate for blocks of size 2^( 3) =       0.000531105321
  error estimate for blocks of size 2^( 4) =       0.000542075290
  error estimate for blocks of size 2^( 5) =       0.000548915176
  error estimate for blocks of size 2^( 6) =       0.000551115830
  error estimate for blocks of size 2^( 7) =       0.000549151851

      target function =      -0.607969294748
              le_mean =     -22.668065816687
             les_mean =     514.349843773138
             stat err =       0.000547814537
             autocorr =       1.221037745103
   target nu stat err =       0.000547814537
   target dn stat err =       0.005081054985
      target stat err =       0.001548302863
              std dev =       0.701106519453
             le_variance =       0.491550351619


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266806581669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607972932175       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607977166900       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607977736722       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607977828816       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607977852798       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607977864069       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607977864410       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607977865702       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607977866380       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607977866130       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 3.808306e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607972932175       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607973994027       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607974136700       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607974159724       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607974165696       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607974168501       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607974168585       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607974168906       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607974169074       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607974169012       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 9.531958e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607972932175       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607973197837       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607973233519       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607973239275       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607973240767       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607973241467       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607973241488       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607973241568       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607973241610       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607973241595       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+02 is 2.383690e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.788228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0708e+01
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_001                -7.044481e-01 3 1  ON 0
ci_002                -7.027653e-01 3 1  ON 1
ci_003                -5.368264e-02 3 1  ON 2
ci_004                -5.407057e-02 3 1  ON 3
ci_005                 2.335385e-02 3 1  ON 4
ci_006                 2.342737e-02 3 1  ON 5
ci_007                 1.861823e-02 3 1  ON 6
ci_008                 1.901344e-02 3 1  ON 7
ci_009                -1.497501e-02 3 1  ON 8
ci_010                -1.473090e-02 3 1  ON 9
ci_011                -1.256392e-02 3 1  ON 10
ci_012                -1.214561e-02 3 1  ON 11
ci_013                 1.123453e-02 3 1  ON 12
ci_014                 1.102277e-02 3 1  ON 13
ci_015                 1.263165e-02 3 1  ON 14
ci_016                 1.241600e-02 3 1  ON 15
ci_017                 1.050517e-02 3 1  ON 16
ci_018                 1.048949e-02 3 1  ON 17
ci_019                 3.288193e-03 3 1  ON 18
ci_020                 3.494922e-03 3 1  ON 19
ci_021                -8.070150e-03 3 1  ON 20
ci_022                -8.283056e-03 3 1  ON 21
ci_023                 6.241048e-03 3 1  ON 22
ci_024                 6.343106e-03 3 1  ON 23
ci_025                 9.034174e-03 3 1  ON 24
ci_026                 8.943614e-03 3 1  ON 25
ci_027                 6.587063e-03 3 1  ON 26
ci_028                 6.656134e-03 3 1  ON 27
ci_029                -5.193254e-03 3 1  ON 28
ci_030                -5.164098e-03 3 1  ON 29
ci_031                -1.780635e-03 3 1  ON 30
ci_032                -1.741779e-03 3 1  ON 31
ci_033                 4.331215e-03 3 1  ON 32
ci_034                 4.232246e-03 3 1  ON 33
ci_035                 2.748916e-03 3 1  ON 34
ci_036                 2.778688e-03 3 1  ON 35
ci_037                 4.708853e-03 3 1  ON 36
ci_038                 4.559163e-03 3 1  ON 37
ci_039                 4.575447e-03 3 1  ON 38
ci_040                 4.650843e-03 3 1  ON 39
ci_041                 3.715919e-03 3 1  ON 40
ci_042                 3.573035e-03 3 1  ON 41
ci_043                 3.872965e-03 3 1  ON 42
ci_044                 4.056506e-03 3 1  ON 43
ci_045                 3.218661e-03 3 1  ON 44
ci_046                 3.201496e-03 3 1  ON 45
ci_047                -1.613205e-03 3 1  ON 46
ci_048                -1.723833e-03 3 1  ON 47
ci_049                 1.408417e-03 3 1  ON 48
ci_050                 1.491887e-03 3 1  ON 49
ci_051                -2.179870e-03 3 1  ON 50
ci_052                -2.077162e-03 3 1  ON 51
ci_053                -2.235419e-03 3 1  ON 52
ci_054                -2.387250e-03 3 1  ON 53
ci_055                -1.131121e-03 3 1  ON 54
ci_056                -1.639609e-03 3 1  ON 55
ci_057                -1.222346e-03 3 1  ON 56
ci_058                -1.464944e-03 3 1  ON 57
ci_059                -8.273311e-04 3 1  ON 58
ci_060                -6.630575e-04 3 1  ON 59
ci_061                -9.872710e-04 3 1  ON 60
ci_062                -7.281363e-04 3 1  ON 61
ci_063                -6.046779e-04 3 1  ON 62
ci_064                -7.493257e-04 3 1  ON 63
ci_065                -1.911024e-03 3 1  ON 64
ci_066                -2.109635e-03 3 1  ON 65
ci_067                -1.465117e-03 3 1  ON 66
ci_068                -1.099724e-03 3 1  ON 67
ci_069                -2.047813e-05 3 1  ON 68
ci_070                 1.329962e-04 3 1  ON 69
ci_071                -1.875245e-03 3 1  ON 70
ci_072                -1.747279e-03 3 1  ON 71
ci_073                 5.078169e-04 3 1  ON 72
ci_074                 4.904665e-04 3 1  ON 73
ci_075                -1.919123e-04 3 1  ON 74
ci_076                -1.173967e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.6204
    reference variance = 0.657181
====================================================
  Execution time = 4.9723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0552e-01
  Total weights = 1.9551e+06
  Execution time = 7.2271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488104516420
                                         uncertainty =       0.003286990902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488104516420
                                         uncertainty =       0.003286990902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494016601
  error estimate for blocks of size 2^( 2) =       0.000512949660
  error estimate for blocks of size 2^( 3) =       0.000529675666
  error estimate for blocks of size 2^( 4) =       0.000542187602
  error estimate for blocks of size 2^( 5) =       0.000549786726
  error estimate for blocks of size 2^( 6) =       0.000551001989
  error estimate for blocks of size 2^( 7) =       0.000552001427

      target function =      -0.608868338497
              le_mean =     -22.667949116505
             les_mean =     514.341463771373
             stat err =       0.000548744436
             autocorr =       1.233835246603
   target nu stat err =       0.000548744436
   target dn stat err =       0.005375157798
      target stat err =       0.001639957741
              std dev =       0.698644977669
             le_variance =       0.488104804822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488077724617
                                         uncertainty =       0.003286815281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488077724617
                                         uncertainty =       0.003286815281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494003078
  error estimate for blocks of size 2^( 2) =       0.000512936163
  error estimate for blocks of size 2^( 3) =       0.000529661937
  error estimate for blocks of size 2^( 4) =       0.000542173461
  error estimate for blocks of size 2^( 5) =       0.000549772264
  error estimate for blocks of size 2^( 6) =       0.000550986540
  error estimate for blocks of size 2^( 7) =       0.000551987459

      target function =      -0.608899896265
              le_mean =     -22.667949011555
             les_mean =     514.341354214701
             stat err =       0.000548729931
             autocorr =       1.233837569654
   target nu stat err =       0.000548729931
   target dn stat err =       0.005344618523
      target stat err =       0.001631060982
              std dev =       0.698625852338
             le_variance =       0.488078081555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488091045080
                                         uncertainty =       0.003286901642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488091045080
                                         uncertainty =       0.003286901642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494009801
  error estimate for blocks of size 2^( 2) =       0.000512942873
  error estimate for blocks of size 2^( 3) =       0.000529668765
  error estimate for blocks of size 2^( 4) =       0.000542180495
  error estimate for blocks of size 2^( 5) =       0.000549779457
  error estimate for blocks of size 2^( 6) =       0.000550994224
  error estimate for blocks of size 2^( 7) =       0.000551994410

      target function =      -0.608880944275
              le_mean =     -22.667949060765
             les_mean =     514.341419390807
             stat err =       0.000548737147
             autocorr =       1.233836432492
   target nu stat err =       0.000548737147
   target dn stat err =       0.005359003295
      target stat err =       0.001635230019
              std dev =       0.698635361134
             le_variance =       0.488091367826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488102827055
                                         uncertainty =       0.003286979595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488102827055
                                         uncertainty =       0.003286979595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494015749
  error estimate for blocks of size 2^( 2) =       0.000512948809
  error estimate for blocks of size 2^( 3) =       0.000529674801
  error estimate for blocks of size 2^( 4) =       0.000542186711
  error estimate for blocks of size 2^( 5) =       0.000549785815
  error estimate for blocks of size 2^( 6) =       0.000551001015
  error estimate for blocks of size 2^( 7) =       0.000552000548

      target function =      -0.608870564536
              le_mean =     -22.667949109144
             les_mean =     514.341456044843
             stat err =       0.000548743522
             autocorr =       1.233835396319
   target nu stat err =       0.000548743522
   target dn stat err =       0.005373037138
      target stat err =       0.001639340154
              std dev =       0.698643771713
             le_variance =       0.488103119753


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.608868338497        initial
     9.5367e+00     9.5367e+01             3.8083e-05        -0.608899896265  <--
     3.8147e+01     3.8147e+02             9.5320e-06        -0.608880944275
     1.5259e+02     1.5259e+03             2.3837e-06        -0.608870564536

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 8.5964e+01
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_001                -7.044634e-01 3 1  ON 0
ci_002                -7.027585e-01 3 1  ON 1
ci_003                -5.365409e-02 3 1  ON 2
ci_004                -5.405544e-02 3 1  ON 3
ci_005                 2.332939e-02 3 1  ON 4
ci_006                 2.340118e-02 3 1  ON 5
ci_007                 1.860076e-02 3 1  ON 6
ci_008                 1.899466e-02 3 1  ON 7
ci_009                -1.496603e-02 3 1  ON 8
ci_010                -1.471837e-02 3 1  ON 9
ci_011                -1.254367e-02 3 1  ON 10
ci_012                -1.213126e-02 3 1  ON 11
ci_013                 1.122211e-02 3 1  ON 12
ci_014                 1.100689e-02 3 1  ON 13
ci_015                 1.261626e-02 3 1  ON 14
ci_016                 1.240469e-02 3 1  ON 15
ci_017                 1.050458e-02 3 1  ON 16
ci_018                 1.048369e-02 3 1  ON 17
ci_019                 3.275421e-03 3 1  ON 18
ci_020                 3.492070e-03 3 1  ON 19
ci_021                -8.070774e-03 3 1  ON 20
ci_022                -8.278798e-03 3 1  ON 21
ci_023                 6.237680e-03 3 1  ON 22
ci_024                 6.339495e-03 3 1  ON 23
ci_025                 9.038732e-03 3 1  ON 24
ci_026                 8.949907e-03 3 1  ON 25
ci_027                 6.586529e-03 3 1  ON 26
ci_028                 6.651835e-03 3 1  ON 27
ci_029                -5.192687e-03 3 1  ON 28
ci_030                -5.158165e-03 3 1  ON 29
ci_031                -1.768098e-03 3 1  ON 30
ci_032                -1.728649e-03 3 1  ON 31
ci_033                 4.331045e-03 3 1  ON 32
ci_034                 4.228573e-03 3 1  ON 33
ci_035                 2.741437e-03 3 1  ON 34
ci_036                 2.774502e-03 3 1  ON 35
ci_037                 4.705070e-03 3 1  ON 36
ci_038                 4.551506e-03 3 1  ON 37
ci_039                 4.574925e-03 3 1  ON 38
ci_040                 4.649495e-03 3 1  ON 39
ci_041                 3.714474e-03 3 1  ON 40
ci_042                 3.565938e-03 3 1  ON 41
ci_043                 3.873409e-03 3 1  ON 42
ci_044                 4.055705e-03 3 1  ON 43
ci_045                 3.217324e-03 3 1  ON 44
ci_046                 3.199022e-03 3 1  ON 45
ci_047                -1.609255e-03 3 1  ON 46
ci_048                -1.721508e-03 3 1  ON 47
ci_049                 1.401710e-03 3 1  ON 48
ci_050                 1.490303e-03 3 1  ON 49
ci_051                -2.175116e-03 3 1  ON 50
ci_052                -2.076799e-03 3 1  ON 51
ci_053                -2.235932e-03 3 1  ON 52
ci_054                -2.386669e-03 3 1  ON 53
ci_055                -1.127486e-03 3 1  ON 54
ci_056                -1.636327e-03 3 1  ON 55
ci_057                -1.221064e-03 3 1  ON 56
ci_058                -1.465454e-03 3 1  ON 57
ci_059                -8.261476e-04 3 1  ON 58
ci_060                -6.626458e-04 3 1  ON 59
ci_061                -9.789498e-04 3 1  ON 60
ci_062                -7.226533e-04 3 1  ON 61
ci_063                -6.040686e-04 3 1  ON 62
ci_064                -7.525292e-04 3 1  ON 63
ci_065                -1.914805e-03 3 1  ON 64
ci_066                -2.108943e-03 3 1  ON 65
ci_067                -1.466033e-03 3 1  ON 66
ci_068                -1.105521e-03 3 1  ON 67
ci_069                -1.724258e-05 3 1  ON 68
ci_070                 1.341645e-04 3 1  ON 69
ci_071                -1.880146e-03 3 1  ON 70
ci_072                -1.750066e-03 3 1  ON 71
ci_073                 5.040780e-04 3 1  ON 72
ci_074                 4.905511e-04 3 1  ON 73
ci_075                -1.862580e-04 3 1  ON 74
ci_076                -1.200930e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4668e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.6238
    reference variance = 0.414762
====================================================
  Execution time = 5.1225e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 4.9265e-01
  Total weights = 1.954928286e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483741034534
                                         uncertainty =       0.002789317295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483741034534
                                         uncertainty =       0.002789317295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491839559
  error estimate for blocks of size 2^( 2) =       0.000509992507
  error estimate for blocks of size 2^( 3) =       0.000527001027
  error estimate for blocks of size 2^( 4) =       0.000539113158
  error estimate for blocks of size 2^( 5) =       0.000546515601
  error estimate for blocks of size 2^( 6) =       0.000551271655
  error estimate for blocks of size 2^( 7) =       0.000551677596

      target function =      -0.612659979444
              le_mean =     -22.667484531107
             les_mean =     514.307501144603
             stat err =       0.000547144503
             autocorr =       1.237534078965
   target nu stat err =       0.000547144503
   target dn stat err =       0.003080613313
      target stat err =       0.000976804142
              std dev =       0.695566174968
             le_variance =       0.483812303760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266748453111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612661239593       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612675857256       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612677830409       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612678015549       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612678080761       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612678099936       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612678100376       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612678104392       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612678103908       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612678104673       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.349835e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612661239593       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612664938761       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612665435385       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612665481646       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612665497808       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612665502512       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612665502606       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612665503597       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612665503474       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612665503661       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 3.417392e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612661239593       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612662167225       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612662291591       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612662303154       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612662307186       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612662308356       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612662308378       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612662308625       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612662308595       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612662308641       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 8.570658e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.793366 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0692e+01
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_001                -7.044631e-01 3 1  ON 0
ci_002                -7.027690e-01 3 1  ON 1
ci_003                -5.363046e-02 3 1  ON 2
ci_004                -5.403549e-02 3 1  ON 3
ci_005                 2.329522e-02 3 1  ON 4
ci_006                 2.336787e-02 3 1  ON 5
ci_007                 1.857977e-02 3 1  ON 6
ci_008                 1.897045e-02 3 1  ON 7
ci_009                -1.494597e-02 3 1  ON 8
ci_010                -1.470299e-02 3 1  ON 9
ci_011                -1.252398e-02 3 1  ON 10
ci_012                -1.211309e-02 3 1  ON 11
ci_013                 1.120079e-02 3 1  ON 12
ci_014                 1.099132e-02 3 1  ON 13
ci_015                 1.259982e-02 3 1  ON 14
ci_016                 1.239091e-02 3 1  ON 15
ci_017                 1.049181e-02 3 1  ON 16
ci_018                 1.047871e-02 3 1  ON 17
ci_019                 3.265305e-03 3 1  ON 18
ci_020                 3.480930e-03 3 1  ON 19
ci_021                -8.068192e-03 3 1  ON 20
ci_022                -8.280743e-03 3 1  ON 21
ci_023                 6.236977e-03 3 1  ON 22
ci_024                 6.334990e-03 3 1  ON 23
ci_025                 9.042006e-03 3 1  ON 24
ci_026                 8.958485e-03 3 1  ON 25
ci_027                 6.584261e-03 3 1  ON 26
ci_028                 6.650677e-03 3 1  ON 27
ci_029                -5.188685e-03 3 1  ON 28
ci_030                -5.153551e-03 3 1  ON 29
ci_031                -1.759230e-03 3 1  ON 30
ci_032                -1.715680e-03 3 1  ON 31
ci_033                 4.322646e-03 3 1  ON 32
ci_034                 4.221740e-03 3 1  ON 33
ci_035                 2.732045e-03 3 1  ON 34
ci_036                 2.765894e-03 3 1  ON 35
ci_037                 4.700299e-03 3 1  ON 36
ci_038                 4.547908e-03 3 1  ON 37
ci_039                 4.570104e-03 3 1  ON 38
ci_040                 4.649389e-03 3 1  ON 39
ci_041                 3.712547e-03 3 1  ON 40
ci_042                 3.561325e-03 3 1  ON 41
ci_043                 3.872043e-03 3 1  ON 42
ci_044                 4.055187e-03 3 1  ON 43
ci_045                 3.209900e-03 3 1  ON 44
ci_046                 3.194746e-03 3 1  ON 45
ci_047                -1.604500e-03 3 1  ON 46
ci_048                -1.713484e-03 3 1  ON 47
ci_049                 1.399133e-03 3 1  ON 48
ci_050                 1.487139e-03 3 1  ON 49
ci_051                -2.172436e-03 3 1  ON 50
ci_052                -2.079863e-03 3 1  ON 51
ci_053                -2.237190e-03 3 1  ON 52
ci_054                -2.386428e-03 3 1  ON 53
ci_055                -1.132642e-03 3 1  ON 54
ci_056                -1.638362e-03 3 1  ON 55
ci_057                -1.222132e-03 3 1  ON 56
ci_058                -1.460485e-03 3 1  ON 57
ci_059                -8.290932e-04 3 1  ON 58
ci_060                -6.601124e-04 3 1  ON 59
ci_061                -9.729561e-04 3 1  ON 60
ci_062                -7.205462e-04 3 1  ON 61
ci_063                -6.104943e-04 3 1  ON 62
ci_064                -7.532972e-04 3 1  ON 63
ci_065                -1.916502e-03 3 1  ON 64
ci_066                -2.111398e-03 3 1  ON 65
ci_067                -1.458955e-03 3 1  ON 66
ci_068                -1.103672e-03 3 1  ON 67
ci_069                -2.048581e-05 3 1  ON 68
ci_070                 1.298546e-04 3 1  ON 69
ci_071                -1.880463e-03 3 1  ON 70
ci_072                -1.752751e-03 3 1  ON 71
ci_073                 5.032766e-04 3 1  ON 72
ci_074                 4.903568e-04 3 1  ON 73
ci_075                -1.876627e-04 3 1  ON 74
ci_076                -1.186873e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.6685
    reference variance = 0.324156
====================================================
  Execution time = 4.9776e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9822e-01
  Total weights = 1.9550e+06
  Execution time = 7.2009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488674464065
                                         uncertainty =       0.005799571156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488674464065
                                         uncertainty =       0.005799571156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494263771
  error estimate for blocks of size 2^( 2) =       0.000512119708
  error estimate for blocks of size 2^( 3) =       0.000528787425
  error estimate for blocks of size 2^( 4) =       0.000541235964
  error estimate for blocks of size 2^( 5) =       0.000548993463
  error estimate for blocks of size 2^( 6) =       0.000551537170
  error estimate for blocks of size 2^( 7) =       0.000553764665

      target function =      -0.611243967150
              le_mean =     -22.668626785975
             les_mean =     514.364878921191
             stat err =       0.000548882815
             autocorr =       1.233223271972
   target nu stat err =       0.000548882815
   target dn stat err =       0.006062715007
      target stat err =       0.001859613313
              std dev =       0.698994527953
             le_variance =       0.488593350109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488577348158
                                         uncertainty =       0.005801973735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488577348158
                                         uncertainty =       0.005801973735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494214739
  error estimate for blocks of size 2^( 2) =       0.000512070788
  error estimate for blocks of size 2^( 3) =       0.000528737932
  error estimate for blocks of size 2^( 4) =       0.000541186712
  error estimate for blocks of size 2^( 5) =       0.000548942500
  error estimate for blocks of size 2^( 6) =       0.000551485221
  error estimate for blocks of size 2^( 7) =       0.000553712085

      target function =      -0.607147200526
              le_mean =     -22.668626946080
             les_mean =     514.378390438351
             stat err =       0.000548831630
             autocorr =       1.233237941778
   target nu stat err =       0.000548831630
   target dn stat err =       0.014753202531
      target stat err =       0.004425080268
              std dev =       0.698925186631
             le_variance =       0.488496416507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488624990547
                                         uncertainty =       0.005800790486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488624990547
                                         uncertainty =       0.005800790486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494238793
  error estimate for blocks of size 2^( 2) =       0.000512094783
  error estimate for blocks of size 2^( 3) =       0.000528762225
  error estimate for blocks of size 2^( 4) =       0.000541210886
  error estimate for blocks of size 2^( 5) =       0.000548967734
  error estimate for blocks of size 2^( 6) =       0.000551511072
  error estimate for blocks of size 2^( 7) =       0.000553737886

      target function =      -0.611242368521
              le_mean =     -22.668626892493
             les_mean =     514.364889098056
             stat err =       0.000548856894
             autocorr =       1.233231437118
   target nu stat err =       0.000548856894
   target dn stat err =       0.006064191407
      target stat err =       0.001860045107
              std dev =       0.698959204246
             le_variance =       0.488543969201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488668223635
                                         uncertainty =       0.005799723958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488668223635
                                         uncertainty =       0.005799723958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494260620
  error estimate for blocks of size 2^( 2) =       0.000512116563
  error estimate for blocks of size 2^( 3) =       0.000528784245
  error estimate for blocks of size 2^( 4) =       0.000541232799
  error estimate for blocks of size 2^( 5) =       0.000548990215
  error estimate for blocks of size 2^( 6) =       0.000551533875
  error estimate for blocks of size 2^( 7) =       0.000553761285

      target function =      -0.611246103692
              le_mean =     -22.668626792441
             les_mean =     514.364872177117
             stat err =       0.000548879544
             autocorr =       1.233224291676
   target nu stat err =       0.000548879544
   target dn stat err =       0.006062863411
      target stat err =       0.001859670489
              std dev =       0.698990072400
             le_variance =       0.488587121314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611243967150        initial
     2.3842e+00     2.3842e+01             1.3498e-04        -0.607147200526
     9.5367e+00     9.5367e+01             3.4174e-05        -0.611242368521
     3.8147e+01     3.8147e+02             8.5707e-06        -0.611246103692  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 8.9257e+01
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_001                -7.044634e-01 3 1  ON 0
ci_002                -7.027611e-01 3 1  ON 1
ci_003                -5.364817e-02 3 1  ON 2
ci_004                -5.405045e-02 3 1  ON 3
ci_005                 2.332082e-02 3 1  ON 4
ci_006                 2.339282e-02 3 1  ON 5
ci_007                 1.859550e-02 3 1  ON 6
ci_008                 1.898859e-02 3 1  ON 7
ci_009                -1.496100e-02 3 1  ON 8
ci_010                -1.471451e-02 3 1  ON 9
ci_011                -1.253874e-02 3 1  ON 10
ci_012                -1.212671e-02 3 1  ON 11
ci_013                 1.121676e-02 3 1  ON 12
ci_014                 1.100299e-02 3 1  ON 13
ci_015                 1.261214e-02 3 1  ON 14
ci_016                 1.240124e-02 3 1  ON 15
ci_017                 1.050138e-02 3 1  ON 16
ci_018                 1.048244e-02 3 1  ON 17
ci_019                 3.272887e-03 3 1  ON 18
ci_020                 3.489278e-03 3 1  ON 19
ci_021                -8.070126e-03 3 1  ON 20
ci_022                -8.279285e-03 3 1  ON 21
ci_023                 6.237504e-03 3 1  ON 22
ci_024                 6.338366e-03 3 1  ON 23
ci_025                 9.039552e-03 3 1  ON 24
ci_026                 8.952056e-03 3 1  ON 25
ci_027                 6.585960e-03 3 1  ON 26
ci_028                 6.651545e-03 3 1  ON 27
ci_029                -5.191684e-03 3 1  ON 28
ci_030                -5.157009e-03 3 1  ON 29
ci_031                -1.765875e-03 3 1  ON 30
ci_032                -1.725399e-03 3 1  ON 31
ci_033                 4.328940e-03 3 1  ON 32
ci_034                 4.226860e-03 3 1  ON 33
ci_035                 2.739082e-03 3 1  ON 34
ci_036                 2.772343e-03 3 1  ON 35
ci_037                 4.703875e-03 3 1  ON 36
ci_038                 4.550605e-03 3 1  ON 37
ci_039                 4.573716e-03 3 1  ON 38
ci_040                 4.649468e-03 3 1  ON 39
ci_041                 3.713991e-03 3 1  ON 40
ci_042                 3.564781e-03 3 1  ON 41
ci_043                 3.873067e-03 3 1  ON 42
ci_044                 4.055576e-03 3 1  ON 43
ci_045                 3.215463e-03 3 1  ON 44
ci_046                 3.197950e-03 3 1  ON 45
ci_047                -1.608063e-03 3 1  ON 46
ci_048                -1.719496e-03 3 1  ON 47
ci_049                 1.401064e-03 3 1  ON 48
ci_050                 1.489510e-03 3 1  ON 49
ci_051                -2.174445e-03 3 1  ON 50
ci_052                -2.077568e-03 3 1  ON 51
ci_053                -2.236247e-03 3 1  ON 52
ci_054                -2.386608e-03 3 1  ON 53
ci_055                -1.128778e-03 3 1  ON 54
ci_056                -1.636837e-03 3 1  ON 55
ci_057                -1.221332e-03 3 1  ON 56
ci_058                -1.464209e-03 3 1  ON 57
ci_059                -8.268864e-04 3 1  ON 58
ci_060                -6.620105e-04 3 1  ON 59
ci_061                -9.774475e-04 3 1  ON 60
ci_062                -7.221255e-04 3 1  ON 61
ci_063                -6.056786e-04 3 1  ON 62
ci_064                -7.527215e-04 3 1  ON 63
ci_065                -1.915230e-03 3 1  ON 64
ci_066                -2.109559e-03 3 1  ON 65
ci_067                -1.464259e-03 3 1  ON 66
ci_068                -1.105057e-03 3 1  ON 67
ci_069                -1.805571e-05 3 1  ON 68
ci_070                 1.330843e-04 3 1  ON 69
ci_071                -1.880226e-03 3 1  ON 70
ci_072                -1.750739e-03 3 1  ON 71
ci_073                 5.038773e-04 3 1  ON 72
ci_074                 4.905025e-04 3 1  ON 73
ci_075                -1.866102e-04 3 1  ON 74
ci_076                -1.197409e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4996e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.7097
    reference variance = 0.55033
====================================================
  Execution time = 5.1296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9559e-01
  Total weights = 1.955291914e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485435752539
                                         uncertainty =       0.003147330810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485435752539
                                         uncertainty =       0.003147330810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492650372
  error estimate for blocks of size 2^( 2) =       0.000510852244
  error estimate for blocks of size 2^( 3) =       0.000526995967
  error estimate for blocks of size 2^( 4) =       0.000539004716
  error estimate for blocks of size 2^( 5) =       0.000545319496
  error estimate for blocks of size 2^( 6) =       0.000548827628
  error estimate for blocks of size 2^( 7) =       0.000550660129

      target function =      -0.611913499639
              le_mean =     -22.668078964367
             les_mean =     514.337395442199
             stat err =       0.000545952993
             autocorr =       1.228097570365
   target nu stat err =       0.000545952993
   target dn stat err =       0.003794690853
      target stat err =       0.001184838143
              std dev =       0.696712837205
             le_variance =       0.485408777526


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266807896437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611915464577       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611919101997       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611919499837       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611919538459       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611919551986       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611919556466       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611919557110       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611919557291       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611919557794       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611919557558       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 3.296001e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611915464577       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611916376675       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611916476264       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611916485920       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611916489294       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611916490408       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611916490568       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611916490612       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611916490737       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611916490678       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 8.265988e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611915464577       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611915692773       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611915717679       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611915720093       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611915720936       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611915721214       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611915721253       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611915721265       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611915721296       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611915721281       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+02 is 2.068127e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.798392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1110e+01
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_001                -7.044623e-01 3 1  ON 0
ci_002                -7.027647e-01 3 1  ON 1
ci_003                -5.364445e-02 3 1  ON 2
ci_004                -5.404425e-02 3 1  ON 3
ci_005                 2.331255e-02 3 1  ON 4
ci_006                 2.338484e-02 3 1  ON 5
ci_007                 1.858952e-02 3 1  ON 6
ci_008                 1.898313e-02 3 1  ON 7
ci_009                -1.495576e-02 3 1  ON 8
ci_010                -1.471095e-02 3 1  ON 9
ci_011                -1.253562e-02 3 1  ON 10
ci_012                -1.212299e-02 3 1  ON 11
ci_013                 1.121253e-02 3 1  ON 12
ci_014                 1.099942e-02 3 1  ON 13
ci_015                 1.260718e-02 3 1  ON 14
ci_016                 1.239646e-02 3 1  ON 15
ci_017                 1.049977e-02 3 1  ON 16
ci_018                 1.048033e-02 3 1  ON 17
ci_019                 3.265838e-03 3 1  ON 18
ci_020                 3.484862e-03 3 1  ON 19
ci_021                -8.068731e-03 3 1  ON 20
ci_022                -8.278537e-03 3 1  ON 21
ci_023                 6.235847e-03 3 1  ON 22
ci_024                 6.336956e-03 3 1  ON 23
ci_025                 9.040293e-03 3 1  ON 24
ci_026                 8.952376e-03 3 1  ON 25
ci_027                 6.585516e-03 3 1  ON 26
ci_028                 6.650998e-03 3 1  ON 27
ci_029                -5.191530e-03 3 1  ON 28
ci_030                -5.155055e-03 3 1  ON 29
ci_031                -1.762847e-03 3 1  ON 30
ci_032                -1.723616e-03 3 1  ON 31
ci_033                 4.326781e-03 3 1  ON 32
ci_034                 4.225610e-03 3 1  ON 33
ci_035                 2.737813e-03 3 1  ON 34
ci_036                 2.770551e-03 3 1  ON 35
ci_037                 4.702202e-03 3 1  ON 36
ci_038                 4.548895e-03 3 1  ON 37
ci_039                 4.573777e-03 3 1  ON 38
ci_040                 4.649140e-03 3 1  ON 39
ci_041                 3.712997e-03 3 1  ON 40
ci_042                 3.564476e-03 3 1  ON 41
ci_043                 3.873531e-03 3 1  ON 42
ci_044                 4.056281e-03 3 1  ON 43
ci_045                 3.214909e-03 3 1  ON 44
ci_046                 3.196792e-03 3 1  ON 45
ci_047                -1.608665e-03 3 1  ON 46
ci_048                -1.719091e-03 3 1  ON 47
ci_049                 1.400597e-03 3 1  ON 48
ci_050                 1.489115e-03 3 1  ON 49
ci_051                -2.173898e-03 3 1  ON 50
ci_052                -2.077182e-03 3 1  ON 51
ci_053                -2.236916e-03 3 1  ON 52
ci_054                -2.386174e-03 3 1  ON 53
ci_055                -1.128850e-03 3 1  ON 54
ci_056                -1.636022e-03 3 1  ON 55
ci_057                -1.221237e-03 3 1  ON 56
ci_058                -1.463998e-03 3 1  ON 57
ci_059                -8.260916e-04 3 1  ON 58
ci_060                -6.612809e-04 3 1  ON 59
ci_061                -9.764640e-04 3 1  ON 60
ci_062                -7.216519e-04 3 1  ON 61
ci_063                -6.057372e-04 3 1  ON 62
ci_064                -7.530224e-04 3 1  ON 63
ci_065                -1.915289e-03 3 1  ON 64
ci_066                -2.109778e-03 3 1  ON 65
ci_067                -1.465364e-03 3 1  ON 66
ci_068                -1.105963e-03 3 1  ON 67
ci_069                -1.837799e-05 3 1  ON 68
ci_070                 1.326885e-04 3 1  ON 69
ci_071                -1.880415e-03 3 1  ON 70
ci_072                -1.751506e-03 3 1  ON 71
ci_073                 5.034707e-04 3 1  ON 72
ci_074                 4.904061e-04 3 1  ON 73
ci_075                -1.855296e-04 3 1  ON 74
ci_076                -1.198920e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.5983
    reference variance = 0.490796
====================================================
  Execution time = 4.9712e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9608e-01
  Total weights = 1.9549e+06
  Execution time = 7.2320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483505024249
                                         uncertainty =       0.002409587781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483505024249
                                         uncertainty =       0.002409587781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491731927
  error estimate for blocks of size 2^( 2) =       0.000510242400
  error estimate for blocks of size 2^( 3) =       0.000526927802
  error estimate for blocks of size 2^( 4) =       0.000538895707
  error estimate for blocks of size 2^( 5) =       0.000546153504
  error estimate for blocks of size 2^( 6) =       0.000550978027
  error estimate for blocks of size 2^( 7) =       0.000554153313

      target function =      -0.611941913449
              le_mean =     -22.668759105283
             les_mean =     514.368701612747
             stat err =       0.000547545138
             autocorr =       1.239889663770
   target nu stat err =       0.000547545138
   target dn stat err =       0.003618421186
      target stat err =       0.001133667456
              std dev =       0.695413960352
             le_variance =       0.483600576252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483481761520
                                         uncertainty =       0.002409643779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483481761520
                                         uncertainty =       0.002409643779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491720086
  error estimate for blocks of size 2^( 2) =       0.000510230882
  error estimate for blocks of size 2^( 3) =       0.000526916528
  error estimate for blocks of size 2^( 4) =       0.000538884043
  error estimate for blocks of size 2^( 5) =       0.000546142163
  error estimate for blocks of size 2^( 6) =       0.000550966754
  error estimate for blocks of size 2^( 7) =       0.000554143424

      target function =      -0.611840760442
              le_mean =     -22.668759064537
             les_mean =     514.369032290973
             stat err =       0.000547534096
             autocorr =       1.239899369760
   target nu stat err =       0.000547534096
   target dn stat err =       0.003641568590
      target stat err =       0.001140135406
              std dev =       0.695397214850
             le_variance =       0.483577286422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483493337447
                                         uncertainty =       0.002409615239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483493337447
                                         uncertainty =       0.002409615239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491725978
  error estimate for blocks of size 2^( 2) =       0.000510236612
  error estimate for blocks of size 2^( 3) =       0.000526922137
  error estimate for blocks of size 2^( 4) =       0.000538889846
  error estimate for blocks of size 2^( 5) =       0.000546147804
  error estimate for blocks of size 2^( 6) =       0.000550972359
  error estimate for blocks of size 2^( 7) =       0.000554148341

      target function =      -0.611924654934
              le_mean =     -22.668759082603
             les_mean =     514.368757311087
             stat err =       0.000547539588
             autocorr =       1.239894525623
   target nu stat err =       0.000547539588
   target dn stat err =       0.003618962055
      target stat err =       0.001133764355
              std dev =       0.695405547757
             le_variance =       0.483588875851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483503559883
                                         uncertainty =       0.002409591153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483503559883
                                         uncertainty =       0.002409591153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491731182
  error estimate for blocks of size 2^( 2) =       0.000510241675
  error estimate for blocks of size 2^( 3) =       0.000526927092
  error estimate for blocks of size 2^( 4) =       0.000538894972
  error estimate for blocks of size 2^( 5) =       0.000546152790
  error estimate for blocks of size 2^( 6) =       0.000550977317
  error estimate for blocks of size 2^( 7) =       0.000554152690

      target function =      -0.611940941171
              le_mean =     -22.668759102161
             les_mean =     514.368704665886
             stat err =       0.000547544442
             autocorr =       1.239890271881
   target nu stat err =       0.000547544442
   target dn stat err =       0.003618306327
      target stat err =       0.001133629959
              std dev =       0.695412906254
             le_variance =       0.483599110185


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611941913449        initial  <--
     9.5367e+00     9.5367e+01             3.2960e-05        -0.611840760442
     3.8147e+01     3.8147e+02             8.2660e-06        -0.611924654934
     1.5259e+02     1.5259e+03             2.0681e-06        -0.611940941171

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 85.9829
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_001                -7.044634e-01 3 1  ON 0
ci_002                -7.027611e-01 3 1  ON 1
ci_003                -5.364817e-02 3 1  ON 2
ci_004                -5.405045e-02 3 1  ON 3
ci_005                 2.332082e-02 3 1  ON 4
ci_006                 2.339282e-02 3 1  ON 5
ci_007                 1.859550e-02 3 1  ON 6
ci_008                 1.898859e-02 3 1  ON 7
ci_009                -1.496100e-02 3 1  ON 8
ci_010                -1.471451e-02 3 1  ON 9
ci_011                -1.253874e-02 3 1  ON 10
ci_012                -1.212671e-02 3 1  ON 11
ci_013                 1.121676e-02 3 1  ON 12
ci_014                 1.100299e-02 3 1  ON 13
ci_015                 1.261214e-02 3 1  ON 14
ci_016                 1.240124e-02 3 1  ON 15
ci_017                 1.050138e-02 3 1  ON 16
ci_018                 1.048244e-02 3 1  ON 17
ci_019                 3.272887e-03 3 1  ON 18
ci_020                 3.489278e-03 3 1  ON 19
ci_021                -8.070126e-03 3 1  ON 20
ci_022                -8.279285e-03 3 1  ON 21
ci_023                 6.237504e-03 3 1  ON 22
ci_024                 6.338366e-03 3 1  ON 23
ci_025                 9.039552e-03 3 1  ON 24
ci_026                 8.952056e-03 3 1  ON 25
ci_027                 6.585960e-03 3 1  ON 26
ci_028                 6.651545e-03 3 1  ON 27
ci_029                -5.191684e-03 3 1  ON 28
ci_030                -5.157009e-03 3 1  ON 29
ci_031                -1.765875e-03 3 1  ON 30
ci_032                -1.725399e-03 3 1  ON 31
ci_033                 4.328940e-03 3 1  ON 32
ci_034                 4.226860e-03 3 1  ON 33
ci_035                 2.739082e-03 3 1  ON 34
ci_036                 2.772343e-03 3 1  ON 35
ci_037                 4.703875e-03 3 1  ON 36
ci_038                 4.550605e-03 3 1  ON 37
ci_039                 4.573716e-03 3 1  ON 38
ci_040                 4.649468e-03 3 1  ON 39
ci_041                 3.713991e-03 3 1  ON 40
ci_042                 3.564781e-03 3 1  ON 41
ci_043                 3.873067e-03 3 1  ON 42
ci_044                 4.055576e-03 3 1  ON 43
ci_045                 3.215463e-03 3 1  ON 44
ci_046                 3.197950e-03 3 1  ON 45
ci_047                -1.608063e-03 3 1  ON 46
ci_048                -1.719496e-03 3 1  ON 47
ci_049                 1.401064e-03 3 1  ON 48
ci_050                 1.489510e-03 3 1  ON 49
ci_051                -2.174445e-03 3 1  ON 50
ci_052                -2.077568e-03 3 1  ON 51
ci_053                -2.236247e-03 3 1  ON 52
ci_054                -2.386608e-03 3 1  ON 53
ci_055                -1.128778e-03 3 1  ON 54
ci_056                -1.636837e-03 3 1  ON 55
ci_057                -1.221332e-03 3 1  ON 56
ci_058                -1.464209e-03 3 1  ON 57
ci_059                -8.268864e-04 3 1  ON 58
ci_060                -6.620105e-04 3 1  ON 59
ci_061                -9.774475e-04 3 1  ON 60
ci_062                -7.221255e-04 3 1  ON 61
ci_063                -6.056786e-04 3 1  ON 62
ci_064                -7.527215e-04 3 1  ON 63
ci_065                -1.915230e-03 3 1  ON 64
ci_066                -2.109559e-03 3 1  ON 65
ci_067                -1.464259e-03 3 1  ON 66
ci_068                -1.105057e-03 3 1  ON 67
ci_069                -1.805571e-05 3 1  ON 68
ci_070                 1.330843e-04 3 1  ON 69
ci_071                -1.880226e-03 3 1  ON 70
ci_072                -1.750739e-03 3 1  ON 71
ci_073                 5.038773e-04 3 1  ON 72
ci_074                 4.905025e-04 3 1  ON 73
ci_075                -1.866102e-04 3 1  ON 74
ci_076                -1.197409e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4710e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.5205
    reference variance = 0.403745
====================================================
  Execution time = 5.1415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9919e-01
  Total weights = 1.954745472e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487931837765
                                         uncertainty =       0.002885319697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487931837765
                                         uncertainty =       0.002885319697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493904731
  error estimate for blocks of size 2^( 2) =       0.000512467374
  error estimate for blocks of size 2^( 3) =       0.000529511346
  error estimate for blocks of size 2^( 4) =       0.000541626924
  error estimate for blocks of size 2^( 5) =       0.000548928748
  error estimate for blocks of size 2^( 6) =       0.000551294978
  error estimate for blocks of size 2^( 7) =       0.000552364718

      target function =      -0.610900487563
              le_mean =     -22.668387243048
             les_mean =     514.354966432085
             stat err =       0.000548553842
             autocorr =       1.233536909353
   target nu stat err =       0.000548553842
   target dn stat err =       0.003332187957
      target stat err =       0.001045730079
              std dev =       0.698486769757
             le_variance =       0.487883767525


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266838724305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610901988894       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610902390682       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610902436286       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610902440769       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610902441616       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610902441812       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610902441769       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610902441798       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610902441790       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610902441811       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+01 is 3.597946e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610901988894       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610902089372       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610902100775       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610902101895       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610902102107       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610902102156       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610902102145       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610902102152       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610902102150       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610902102156       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+02 is 8.997708e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610901988894       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610902014015       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610902016866       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610902017146       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610902017199       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610902017212       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610902017210       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610902017211       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610902017209       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610902017215       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+03 is 2.249605e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.803479 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0762e+01
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_001                -7.044636e-01 3 1  ON 0
ci_002                -7.027611e-01 3 1  ON 1
ci_003                -5.364769e-02 3 1  ON 2
ci_004                -5.404998e-02 3 1  ON 3
ci_005                 2.331998e-02 3 1  ON 4
ci_006                 2.339192e-02 3 1  ON 5
ci_007                 1.859492e-02 3 1  ON 6
ci_008                 1.898792e-02 3 1  ON 7
ci_009                -1.496057e-02 3 1  ON 8
ci_010                -1.471402e-02 3 1  ON 9
ci_011                -1.253843e-02 3 1  ON 10
ci_012                -1.212624e-02 3 1  ON 11
ci_013                 1.121629e-02 3 1  ON 12
ci_014                 1.100260e-02 3 1  ON 13
ci_015                 1.261189e-02 3 1  ON 14
ci_016                 1.240088e-02 3 1  ON 15
ci_017                 1.050119e-02 3 1  ON 16
ci_018                 1.048212e-02 3 1  ON 17
ci_019                 3.272409e-03 3 1  ON 18
ci_020                 3.488913e-03 3 1  ON 19
ci_021                -8.070009e-03 3 1  ON 20
ci_022                -8.279364e-03 3 1  ON 21
ci_023                 6.237395e-03 3 1  ON 22
ci_024                 6.338225e-03 3 1  ON 23
ci_025                 9.039655e-03 3 1  ON 24
ci_026                 8.952128e-03 3 1  ON 25
ci_027                 6.585838e-03 3 1  ON 26
ci_028                 6.651500e-03 3 1  ON 27
ci_029                -5.191643e-03 3 1  ON 28
ci_030                -5.156769e-03 3 1  ON 29
ci_031                -1.765453e-03 3 1  ON 30
ci_032                -1.725203e-03 3 1  ON 31
ci_033                 4.328833e-03 3 1  ON 32
ci_034                 4.226787e-03 3 1  ON 33
ci_035                 2.738866e-03 3 1  ON 34
ci_036                 2.772177e-03 3 1  ON 35
ci_037                 4.703786e-03 3 1  ON 36
ci_038                 4.550643e-03 3 1  ON 37
ci_039                 4.573799e-03 3 1  ON 38
ci_040                 4.649460e-03 3 1  ON 39
ci_041                 3.713943e-03 3 1  ON 40
ci_042                 3.564741e-03 3 1  ON 41
ci_043                 3.873106e-03 3 1  ON 42
ci_044                 4.055558e-03 3 1  ON 43
ci_045                 3.215396e-03 3 1  ON 44
ci_046                 3.197878e-03 3 1  ON 45
ci_047                -1.608087e-03 3 1  ON 46
ci_048                -1.719325e-03 3 1  ON 47
ci_049                 1.401014e-03 3 1  ON 48
ci_050                 1.489422e-03 3 1  ON 49
ci_051                -2.174446e-03 3 1  ON 50
ci_052                -2.077501e-03 3 1  ON 51
ci_053                -2.236185e-03 3 1  ON 52
ci_054                -2.386561e-03 3 1  ON 53
ci_055                -1.128795e-03 3 1  ON 54
ci_056                -1.636855e-03 3 1  ON 55
ci_057                -1.221265e-03 3 1  ON 56
ci_058                -1.464237e-03 3 1  ON 57
ci_059                -8.268040e-04 3 1  ON 58
ci_060                -6.619129e-04 3 1  ON 59
ci_061                -9.773155e-04 3 1  ON 60
ci_062                -7.221211e-04 3 1  ON 61
ci_063                -6.057473e-04 3 1  ON 62
ci_064                -7.526774e-04 3 1  ON 63
ci_065                -1.915314e-03 3 1  ON 64
ci_066                -2.109607e-03 3 1  ON 65
ci_067                -1.464262e-03 3 1  ON 66
ci_068                -1.105149e-03 3 1  ON 67
ci_069                -1.810876e-05 3 1  ON 68
ci_070                 1.330185e-04 3 1  ON 69
ci_071                -1.880277e-03 3 1  ON 70
ci_072                -1.750622e-03 3 1  ON 71
ci_073                 5.039321e-04 3 1  ON 72
ci_074                 4.904758e-04 3 1  ON 73
ci_075                -1.866609e-04 3 1  ON 74
ci_076                -1.197166e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.5398
    reference variance = 0.608085
====================================================
  Execution time = 4.9769e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1008e-01
  Total weights = 1.9550e+06
  Execution time = 7.2251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495588814925
                                         uncertainty =       0.004213493493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495588814925
                                         uncertainty =       0.004213493493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497832901
  error estimate for blocks of size 2^( 2) =       0.000515893385
  error estimate for blocks of size 2^( 3) =       0.000532207075
  error estimate for blocks of size 2^( 4) =       0.000544291340
  error estimate for blocks of size 2^( 5) =       0.000552179612
  error estimate for blocks of size 2^( 6) =       0.000555076115
  error estimate for blocks of size 2^( 7) =       0.000559158338

      target function =      -0.607654067953
              le_mean =     -22.668547343170
             les_mean =     514.373116344892
             stat err =       0.000552676351
             autocorr =       1.232464936180
   target nu stat err =       0.000552676351
   target dn stat err =       0.005673785365
      target stat err =       0.001722982009
              std dev =       0.704042040841
             le_variance =       0.495675195271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495584988831
                                         uncertainty =       0.004213005566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495584988831
                                         uncertainty =       0.004213005566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497830980
  error estimate for blocks of size 2^( 2) =       0.000515891515
  error estimate for blocks of size 2^( 3) =       0.000532205223
  error estimate for blocks of size 2^( 4) =       0.000544289508
  error estimate for blocks of size 2^( 5) =       0.000552177753
  error estimate for blocks of size 2^( 6) =       0.000555074300
  error estimate for blocks of size 2^( 7) =       0.000559156557

      target function =      -0.607654815124
              le_mean =     -22.668547323837
             les_mean =     514.373112963800
             stat err =       0.000552674530
             autocorr =       1.232466326488
   target nu stat err =       0.000552674530
   target dn stat err =       0.005673245211
      target stat err =       0.001722826099
              std dev =       0.704039323453
             le_variance =       0.495671368969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495586900938
                                         uncertainty =       0.004213249393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495586900938
                                         uncertainty =       0.004213249393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497831940
  error estimate for blocks of size 2^( 2) =       0.000515892449
  error estimate for blocks of size 2^( 3) =       0.000532206149
  error estimate for blocks of size 2^( 4) =       0.000544290423
  error estimate for blocks of size 2^( 5) =       0.000552178682
  error estimate for blocks of size 2^( 6) =       0.000555075207
  error estimate for blocks of size 2^( 7) =       0.000559157447

      target function =      -0.607654464478
              le_mean =     -22.668547333478
             les_mean =     514.373114576679
             stat err =       0.000552675440
             autocorr =       1.232465631438
   target nu stat err =       0.000552675440
   target dn stat err =       0.005673514885
      target stat err =       0.001722904063
              std dev =       0.704040681481
             le_variance =       0.495673281180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495588575615
                                         uncertainty =       0.004213462971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495588575615
                                         uncertainty =       0.004213462971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497832781
  error estimate for blocks of size 2^( 2) =       0.000515893268
  error estimate for blocks of size 2^( 3) =       0.000532206959
  error estimate for blocks of size 2^( 4) =       0.000544291225
  error estimate for blocks of size 2^( 5) =       0.000552179495
  error estimate for blocks of size 2^( 6) =       0.000555076001
  error estimate for blocks of size 2^( 7) =       0.000559158227

      target function =      -0.607654119712
              le_mean =     -22.668547341956
             les_mean =     514.373116116431
             stat err =       0.000552676237
             autocorr =       1.232465023091
   target nu stat err =       0.000552676237
   target dn stat err =       0.005673751519
      target stat err =       0.001722972267
              std dev =       0.704041870877
             le_variance =       0.495674955948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607654067953        initial
     9.5367e+01     9.5367e+02             3.5979e-06        -0.607654815124  <--
     3.8147e+02     3.8147e+03             8.9977e-07        -0.607654464478
     1.5259e+03     1.5259e+04             2.2496e-07        -0.607654119712

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 8.6130e+01
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027612e-01 3 1  ON 1
ci_003                -5.364625e-02 3 1  ON 2
ci_004                -5.404858e-02 3 1  ON 3
ci_005                 2.331748e-02 3 1  ON 4
ci_006                 2.338923e-02 3 1  ON 5
ci_007                 1.859319e-02 3 1  ON 6
ci_008                 1.898593e-02 3 1  ON 7
ci_009                -1.495927e-02 3 1  ON 8
ci_010                -1.471254e-02 3 1  ON 9
ci_011                -1.253753e-02 3 1  ON 10
ci_012                -1.212485e-02 3 1  ON 11
ci_013                 1.121487e-02 3 1  ON 12
ci_014                 1.100146e-02 3 1  ON 13
ci_015                 1.261116e-02 3 1  ON 14
ci_016                 1.239980e-02 3 1  ON 15
ci_017                 1.050062e-02 3 1  ON 16
ci_018                 1.048115e-02 3 1  ON 17
ci_019                 3.270976e-03 3 1  ON 18
ci_020                 3.487815e-03 3 1  ON 19
ci_021                -8.069659e-03 3 1  ON 20
ci_022                -8.279601e-03 3 1  ON 21
ci_023                 6.237069e-03 3 1  ON 22
ci_024                 6.337804e-03 3 1  ON 23
ci_025                 9.039962e-03 3 1  ON 24
ci_026                 8.952345e-03 3 1  ON 25
ci_027                 6.585471e-03 3 1  ON 26
ci_028                 6.651366e-03 3 1  ON 27
ci_029                -5.191519e-03 3 1  ON 28
ci_030                -5.156049e-03 3 1  ON 29
ci_031                -1.764186e-03 3 1  ON 30
ci_032                -1.724616e-03 3 1  ON 31
ci_033                 4.328511e-03 3 1  ON 32
ci_034                 4.226565e-03 3 1  ON 33
ci_035                 2.738219e-03 3 1  ON 34
ci_036                 2.771678e-03 3 1  ON 35
ci_037                 4.703519e-03 3 1  ON 36
ci_038                 4.550758e-03 3 1  ON 37
ci_039                 4.574046e-03 3 1  ON 38
ci_040                 4.649433e-03 3 1  ON 39
ci_041                 3.713800e-03 3 1  ON 40
ci_042                 3.564621e-03 3 1  ON 41
ci_043                 3.873225e-03 3 1  ON 42
ci_044                 4.055506e-03 3 1  ON 43
ci_045                 3.215195e-03 3 1  ON 44
ci_046                 3.197663e-03 3 1  ON 45
ci_047                -1.608158e-03 3 1  ON 46
ci_048                -1.718813e-03 3 1  ON 47
ci_049                 1.400862e-03 3 1  ON 48
ci_050                 1.489158e-03 3 1  ON 49
ci_051                -2.174448e-03 3 1  ON 50
ci_052                -2.077303e-03 3 1  ON 51
ci_053                -2.235998e-03 3 1  ON 52
ci_054                -2.386420e-03 3 1  ON 53
ci_055                -1.128843e-03 3 1  ON 54
ci_056                -1.636908e-03 3 1  ON 55
ci_057                -1.221062e-03 3 1  ON 56
ci_058                -1.464321e-03 3 1  ON 57
ci_059                -8.265570e-04 3 1  ON 58
ci_060                -6.616202e-04 3 1  ON 59
ci_061                -9.769195e-04 3 1  ON 60
ci_062                -7.221077e-04 3 1  ON 61
ci_063                -6.059536e-04 3 1  ON 62
ci_064                -7.525454e-04 3 1  ON 63
ci_065                -1.915567e-03 3 1  ON 64
ci_066                -2.109753e-03 3 1  ON 65
ci_067                -1.464274e-03 3 1  ON 66
ci_068                -1.105423e-03 3 1  ON 67
ci_069                -1.826787e-05 3 1  ON 68
ci_070                 1.328213e-04 3 1  ON 69
ci_071                -1.880432e-03 3 1  ON 70
ci_072                -1.750270e-03 3 1  ON 71
ci_073                 5.040965e-04 3 1  ON 72
ci_074                 4.903957e-04 3 1  ON 73
ci_075                -1.868128e-04 3 1  ON 74
ci_076                -1.196436e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4726e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7372
    reference variance = 0.5052
====================================================
  Execution time = 5.2614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0889e-01
  Total weights = 1.955086985e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494189256697
                                         uncertainty =       0.006866805507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494189256697
                                         uncertainty =       0.006866805507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497039167
  error estimate for blocks of size 2^( 2) =       0.000515435189
  error estimate for blocks of size 2^( 3) =       0.000532063492
  error estimate for blocks of size 2^( 4) =       0.000544983702
  error estimate for blocks of size 2^( 5) =       0.000552875433
  error estimate for blocks of size 2^( 6) =       0.000556981912
  error estimate for blocks of size 2^( 7) =       0.000561725432

      target function =      -0.607824811909
              le_mean =     -22.667814983221
             les_mean =     514.338727887080
             stat err =       0.000554141620
             autocorr =       1.242969047224
   target nu stat err =       0.000554141620
   target dn stat err =       0.008166019652
      target stat err =       0.002463701350
              std dev =       0.702919531386
             le_variance =       0.494095867603


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266781498322e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607834559087       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607836484873       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607836664701       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607836677338       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607836681076       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607836681550       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607836681209       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607836680858       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607836681306       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607836681348       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+01 is 1.782698e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607834559087       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607835041122       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607835086108       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607835089266       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607835090199       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607835090318       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607835090232       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607835090144       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607835090256       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607835090267       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+01 is 4.462338e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607834559087       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607834679633       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607834690881       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607834691670       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607834691904       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607834691933       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607834691912       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607834691890       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607834691918       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607834691920       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+02 is 1.115934e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.808721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2067e+01
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_001                -7.044657e-01 3 1  ON 0
ci_002                -7.027606e-01 3 1  ON 1
ci_003                -5.364478e-02 3 1  ON 2
ci_004                -5.404679e-02 3 1  ON 3
ci_005                 2.331451e-02 3 1  ON 4
ci_006                 2.338476e-02 3 1  ON 5
ci_007                 1.859113e-02 3 1  ON 6
ci_008                 1.898372e-02 3 1  ON 7
ci_009                -1.495809e-02 3 1  ON 8
ci_010                -1.471164e-02 3 1  ON 9
ci_011                -1.253571e-02 3 1  ON 10
ci_012                -1.212275e-02 3 1  ON 11
ci_013                 1.121292e-02 3 1  ON 12
ci_014                 1.099995e-02 3 1  ON 13
ci_015                 1.260981e-02 3 1  ON 14
ci_016                 1.239938e-02 3 1  ON 15
ci_017                 1.050001e-02 3 1  ON 16
ci_018                 1.047975e-02 3 1  ON 17
ci_019                 3.270181e-03 3 1  ON 18
ci_020                 3.486475e-03 3 1  ON 19
ci_021                -8.069693e-03 3 1  ON 20
ci_022                -8.276947e-03 3 1  ON 21
ci_023                 6.237334e-03 3 1  ON 22
ci_024                 6.336136e-03 3 1  ON 23
ci_025                 9.040081e-03 3 1  ON 24
ci_026                 8.952759e-03 3 1  ON 25
ci_027                 6.585480e-03 3 1  ON 26
ci_028                 6.651210e-03 3 1  ON 27
ci_029                -5.190657e-03 3 1  ON 28
ci_030                -5.156278e-03 3 1  ON 29
ci_031                -1.763554e-03 3 1  ON 30
ci_032                -1.723669e-03 3 1  ON 31
ci_033                 4.328574e-03 3 1  ON 32
ci_034                 4.225610e-03 3 1  ON 33
ci_035                 2.737505e-03 3 1  ON 34
ci_036                 2.770573e-03 3 1  ON 35
ci_037                 4.703338e-03 3 1  ON 36
ci_038                 4.550337e-03 3 1  ON 37
ci_039                 4.573967e-03 3 1  ON 38
ci_040                 4.648551e-03 3 1  ON 39
ci_041                 3.713942e-03 3 1  ON 40
ci_042                 3.564452e-03 3 1  ON 41
ci_043                 3.872440e-03 3 1  ON 42
ci_044                 4.055190e-03 3 1  ON 43
ci_045                 3.214101e-03 3 1  ON 44
ci_046                 3.196602e-03 3 1  ON 45
ci_047                -1.607701e-03 3 1  ON 46
ci_048                -1.718457e-03 3 1  ON 47
ci_049                 1.400294e-03 3 1  ON 48
ci_050                 1.488500e-03 3 1  ON 49
ci_051                -2.173888e-03 3 1  ON 50
ci_052                -2.076909e-03 3 1  ON 51
ci_053                -2.235370e-03 3 1  ON 52
ci_054                -2.386706e-03 3 1  ON 53
ci_055                -1.129585e-03 3 1  ON 54
ci_056                -1.637097e-03 3 1  ON 55
ci_057                -1.221050e-03 3 1  ON 56
ci_058                -1.464538e-03 3 1  ON 57
ci_059                -8.264370e-04 3 1  ON 58
ci_060                -6.611578e-04 3 1  ON 59
ci_061                -9.767006e-04 3 1  ON 60
ci_062                -7.228738e-04 3 1  ON 61
ci_063                -6.068035e-04 3 1  ON 62
ci_064                -7.528120e-04 3 1  ON 63
ci_065                -1.915933e-03 3 1  ON 64
ci_066                -2.110182e-03 3 1  ON 65
ci_067                -1.465564e-03 3 1  ON 66
ci_068                -1.105131e-03 3 1  ON 67
ci_069                -1.813138e-05 3 1  ON 68
ci_070                 1.337342e-04 3 1  ON 69
ci_071                -1.880553e-03 3 1  ON 70
ci_072                -1.750769e-03 3 1  ON 71
ci_073                 5.044820e-04 3 1  ON 72
ci_074                 4.897734e-04 3 1  ON 73
ci_075                -1.865920e-04 3 1  ON 74
ci_076                -1.192972e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7497
    reference variance = 0.660881
====================================================
  Execution time = 5.0014e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0114e-01
  Total weights = 1.9549e+06
  Execution time = 7.2113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487464475433
                                         uncertainty =       0.002794570253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487464475433
                                         uncertainty =       0.002794570253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493645315
  error estimate for blocks of size 2^( 2) =       0.000512293904
  error estimate for blocks of size 2^( 3) =       0.000528521346
  error estimate for blocks of size 2^( 4) =       0.000540128106
  error estimate for blocks of size 2^( 5) =       0.000546172232
  error estimate for blocks of size 2^( 6) =       0.000548970211
  error estimate for blocks of size 2^( 7) =       0.000551102999

      target function =      -0.610228781729
              le_mean =     -22.668066069643
             les_mean =     514.342357873197
             stat err =       0.000546593387
             autocorr =       1.226023252828
   target nu stat err =       0.000546593387
   target dn stat err =       0.003904410384
      target stat err =       0.001210856507
              std dev =       0.698119899481
             le_variance =       0.487371394051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487458056225
                                         uncertainty =       0.002795229128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487458056225
                                         uncertainty =       0.002795229128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493642057
  error estimate for blocks of size 2^( 2) =       0.000512290701
  error estimate for blocks of size 2^( 3) =       0.000528518007
  error estimate for blocks of size 2^( 4) =       0.000540124735
  error estimate for blocks of size 2^( 5) =       0.000546168694
  error estimate for blocks of size 2^( 6) =       0.000548966996
  error estimate for blocks of size 2^( 7) =       0.000551099888

      target function =      -0.610224149869
              le_mean =     -22.668066004582
             les_mean =     514.342370177280
             stat err =       0.000546590078
             autocorr =       1.226024591309
   target nu stat err =       0.000546590078
   target dn stat err =       0.003908637373
      target stat err =       0.001212083532
              std dev =       0.698115292023
             le_variance =       0.487364960957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487461256718
                                         uncertainty =       0.002794899574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487461256718
                                         uncertainty =       0.002794899574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493643681
  error estimate for blocks of size 2^( 2) =       0.000512292298
  error estimate for blocks of size 2^( 3) =       0.000528519672
  error estimate for blocks of size 2^( 4) =       0.000540126416
  error estimate for blocks of size 2^( 5) =       0.000546170458
  error estimate for blocks of size 2^( 6) =       0.000548968599
  error estimate for blocks of size 2^( 7) =       0.000551101439

      target function =      -0.610226960155
              le_mean =     -22.668066036544
             les_mean =     514.342362363574
             stat err =       0.000546591728
             autocorr =       1.226023923766
   target nu stat err =       0.000546591728
   target dn stat err =       0.003906501566
      target stat err =       0.001211465354
              std dev =       0.698117589225
             le_variance =       0.487368168386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487464072381
                                         uncertainty =       0.002794611375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487464072381
                                         uncertainty =       0.002794611375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493645110
  error estimate for blocks of size 2^( 2) =       0.000512293703
  error estimate for blocks of size 2^( 3) =       0.000528521136
  error estimate for blocks of size 2^( 4) =       0.000540127895
  error estimate for blocks of size 2^( 5) =       0.000546172010
  error estimate for blocks of size 2^( 6) =       0.000548970009
  error estimate for blocks of size 2^( 7) =       0.000551102803

      target function =      -0.610228580997
              le_mean =     -22.668066065443
             les_mean =     514.342358342382
             stat err =       0.000546593179
             autocorr =       1.226023336803
   target nu stat err =       0.000546593179
   target dn stat err =       0.003904669381
      target stat err =       0.001210932009
              std dev =       0.698119610189
             le_variance =       0.487370990130


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610228781729        initial  <--
     2.3842e+01     2.3842e+02             1.7827e-05        -0.610224149869
     9.5367e+01     9.5367e+02             4.4623e-06        -0.610226960155
     3.8147e+02     3.8147e+03             1.1159e-06        -0.610228580997

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 86.1871
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027612e-01 3 1  ON 1
ci_003                -5.364625e-02 3 1  ON 2
ci_004                -5.404858e-02 3 1  ON 3
ci_005                 2.331748e-02 3 1  ON 4
ci_006                 2.338923e-02 3 1  ON 5
ci_007                 1.859319e-02 3 1  ON 6
ci_008                 1.898593e-02 3 1  ON 7
ci_009                -1.495927e-02 3 1  ON 8
ci_010                -1.471254e-02 3 1  ON 9
ci_011                -1.253753e-02 3 1  ON 10
ci_012                -1.212485e-02 3 1  ON 11
ci_013                 1.121487e-02 3 1  ON 12
ci_014                 1.100146e-02 3 1  ON 13
ci_015                 1.261116e-02 3 1  ON 14
ci_016                 1.239980e-02 3 1  ON 15
ci_017                 1.050062e-02 3 1  ON 16
ci_018                 1.048115e-02 3 1  ON 17
ci_019                 3.270976e-03 3 1  ON 18
ci_020                 3.487815e-03 3 1  ON 19
ci_021                -8.069659e-03 3 1  ON 20
ci_022                -8.279601e-03 3 1  ON 21
ci_023                 6.237069e-03 3 1  ON 22
ci_024                 6.337804e-03 3 1  ON 23
ci_025                 9.039962e-03 3 1  ON 24
ci_026                 8.952345e-03 3 1  ON 25
ci_027                 6.585471e-03 3 1  ON 26
ci_028                 6.651366e-03 3 1  ON 27
ci_029                -5.191519e-03 3 1  ON 28
ci_030                -5.156049e-03 3 1  ON 29
ci_031                -1.764186e-03 3 1  ON 30
ci_032                -1.724616e-03 3 1  ON 31
ci_033                 4.328511e-03 3 1  ON 32
ci_034                 4.226565e-03 3 1  ON 33
ci_035                 2.738219e-03 3 1  ON 34
ci_036                 2.771678e-03 3 1  ON 35
ci_037                 4.703519e-03 3 1  ON 36
ci_038                 4.550758e-03 3 1  ON 37
ci_039                 4.574046e-03 3 1  ON 38
ci_040                 4.649433e-03 3 1  ON 39
ci_041                 3.713800e-03 3 1  ON 40
ci_042                 3.564621e-03 3 1  ON 41
ci_043                 3.873225e-03 3 1  ON 42
ci_044                 4.055506e-03 3 1  ON 43
ci_045                 3.215195e-03 3 1  ON 44
ci_046                 3.197663e-03 3 1  ON 45
ci_047                -1.608158e-03 3 1  ON 46
ci_048                -1.718813e-03 3 1  ON 47
ci_049                 1.400862e-03 3 1  ON 48
ci_050                 1.489158e-03 3 1  ON 49
ci_051                -2.174448e-03 3 1  ON 50
ci_052                -2.077303e-03 3 1  ON 51
ci_053                -2.235998e-03 3 1  ON 52
ci_054                -2.386420e-03 3 1  ON 53
ci_055                -1.128843e-03 3 1  ON 54
ci_056                -1.636908e-03 3 1  ON 55
ci_057                -1.221062e-03 3 1  ON 56
ci_058                -1.464321e-03 3 1  ON 57
ci_059                -8.265570e-04 3 1  ON 58
ci_060                -6.616202e-04 3 1  ON 59
ci_061                -9.769195e-04 3 1  ON 60
ci_062                -7.221077e-04 3 1  ON 61
ci_063                -6.059536e-04 3 1  ON 62
ci_064                -7.525454e-04 3 1  ON 63
ci_065                -1.915567e-03 3 1  ON 64
ci_066                -2.109753e-03 3 1  ON 65
ci_067                -1.464274e-03 3 1  ON 66
ci_068                -1.105423e-03 3 1  ON 67
ci_069                -1.826787e-05 3 1  ON 68
ci_070                 1.328213e-04 3 1  ON 69
ci_071                -1.880432e-03 3 1  ON 70
ci_072                -1.750270e-03 3 1  ON 71
ci_073                 5.040965e-04 3 1  ON 72
ci_074                 4.903957e-04 3 1  ON 73
ci_075                -1.868128e-04 3 1  ON 74
ci_076                -1.196436e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4826e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.5815
    reference variance = 0.292732
====================================================
  Execution time = 5.1380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0218e-01
  Total weights = 1.955310247e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488231569468
                                         uncertainty =       0.003575674833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488231569468
                                         uncertainty =       0.003575674833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494098733
  error estimate for blocks of size 2^( 2) =       0.000512671343
  error estimate for blocks of size 2^( 3) =       0.000529706998
  error estimate for blocks of size 2^( 4) =       0.000541244492
  error estimate for blocks of size 2^( 5) =       0.000548362929
  error estimate for blocks of size 2^( 6) =       0.000553793314
  error estimate for blocks of size 2^( 7) =       0.000554956077

      target function =      -0.610055005271
              le_mean =     -22.668629910215
             les_mean =     514.368958300302
             stat err =       0.000549589203
             autocorr =       1.237225615284
   target nu stat err =       0.000549589203
   target dn stat err =       0.004342475687
      target stat err =       0.001340413897
              std dev =       0.698761129924
             le_variance =       0.488267116693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266862991022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610057688874       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610057852313       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610057867485       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610057869172       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610057869502       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610057869943       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610057869941       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610057869920       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610057869896       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610057869907       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+02 is 1.539417e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610057688874       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610057729739       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610057733532       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610057733954       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610057734037       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610057734148       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610057734148       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610057734144       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610057734135       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610057734137       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+02 is 3.849037e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610057688874       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610057699091       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610057700039       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610057700145       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610057700165       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610057700198       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610057700193       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610057700191       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610057700190       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610057700190       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+03 is 9.622902e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.813759 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0784e+01
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_001                -7.044643e-01 3 1  ON 0
ci_002                -7.027612e-01 3 1  ON 1
ci_003                -5.364615e-02 3 1  ON 2
ci_004                -5.404833e-02 3 1  ON 3
ci_005                 2.331709e-02 3 1  ON 4
ci_006                 2.338891e-02 3 1  ON 5
ci_007                 1.859296e-02 3 1  ON 6
ci_008                 1.898566e-02 3 1  ON 7
ci_009                -1.495910e-02 3 1  ON 8
ci_010                -1.471232e-02 3 1  ON 9
ci_011                -1.253732e-02 3 1  ON 10
ci_012                -1.212475e-02 3 1  ON 11
ci_013                 1.121476e-02 3 1  ON 12
ci_014                 1.100127e-02 3 1  ON 13
ci_015                 1.261103e-02 3 1  ON 14
ci_016                 1.239967e-02 3 1  ON 15
ci_017                 1.050045e-02 3 1  ON 16
ci_018                 1.048101e-02 3 1  ON 17
ci_019                 3.270916e-03 3 1  ON 18
ci_020                 3.487705e-03 3 1  ON 19
ci_021                -8.069582e-03 3 1  ON 20
ci_022                -8.279568e-03 3 1  ON 21
ci_023                 6.236965e-03 3 1  ON 22
ci_024                 6.337733e-03 3 1  ON 23
ci_025                 9.039968e-03 3 1  ON 24
ci_026                 8.952374e-03 3 1  ON 25
ci_027                 6.585468e-03 3 1  ON 26
ci_028                 6.651346e-03 3 1  ON 27
ci_029                -5.191420e-03 3 1  ON 28
ci_030                -5.155990e-03 3 1  ON 29
ci_031                -1.764141e-03 3 1  ON 30
ci_032                -1.724451e-03 3 1  ON 31
ci_033                 4.328483e-03 3 1  ON 32
ci_034                 4.226554e-03 3 1  ON 33
ci_035                 2.738173e-03 3 1  ON 34
ci_036                 2.771697e-03 3 1  ON 35
ci_037                 4.703527e-03 3 1  ON 36
ci_038                 4.550680e-03 3 1  ON 37
ci_039                 4.574055e-03 3 1  ON 38
ci_040                 4.649385e-03 3 1  ON 39
ci_041                 3.713775e-03 3 1  ON 40
ci_042                 3.564655e-03 3 1  ON 41
ci_043                 3.873236e-03 3 1  ON 42
ci_044                 4.055537e-03 3 1  ON 43
ci_045                 3.215166e-03 3 1  ON 44
ci_046                 3.197630e-03 3 1  ON 45
ci_047                -1.608092e-03 3 1  ON 46
ci_048                -1.718785e-03 3 1  ON 47
ci_049                 1.400816e-03 3 1  ON 48
ci_050                 1.489104e-03 3 1  ON 49
ci_051                -2.174438e-03 3 1  ON 50
ci_052                -2.077232e-03 3 1  ON 51
ci_053                -2.236013e-03 3 1  ON 52
ci_054                -2.386376e-03 3 1  ON 53
ci_055                -1.128836e-03 3 1  ON 54
ci_056                -1.636910e-03 3 1  ON 55
ci_057                -1.221111e-03 3 1  ON 56
ci_058                -1.464391e-03 3 1  ON 57
ci_059                -8.265144e-04 3 1  ON 58
ci_060                -6.616004e-04 3 1  ON 59
ci_061                -9.769637e-04 3 1  ON 60
ci_062                -7.221107e-04 3 1  ON 61
ci_063                -6.060050e-04 3 1  ON 62
ci_064                -7.525680e-04 3 1  ON 63
ci_065                -1.915613e-03 3 1  ON 64
ci_066                -2.109771e-03 3 1  ON 65
ci_067                -1.464284e-03 3 1  ON 66
ci_068                -1.105463e-03 3 1  ON 67
ci_069                -1.825360e-05 3 1  ON 68
ci_070                 1.327745e-04 3 1  ON 69
ci_071                -1.880432e-03 3 1  ON 70
ci_072                -1.750264e-03 3 1  ON 71
ci_073                 5.040547e-04 3 1  ON 72
ci_074                 4.903690e-04 3 1  ON 73
ci_075                -1.867997e-04 3 1  ON 74
ci_076                -1.196648e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.6625
    reference variance = 0.375007
====================================================
  Execution time = 4.9805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9479e-01
  Total weights = 1.9552e+06
  Execution time = 7.2206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483730334420
                                         uncertainty =       0.002128634190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483730334420
                                         uncertainty =       0.002128634190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491723663
  error estimate for blocks of size 2^( 2) =       0.000509956088
  error estimate for blocks of size 2^( 3) =       0.000527264440
  error estimate for blocks of size 2^( 4) =       0.000539275743
  error estimate for blocks of size 2^( 5) =       0.000546080862
  error estimate for blocks of size 2^( 6) =       0.000548831975
  error estimate for blocks of size 2^( 7) =       0.000550257287

      target function =      -0.612149487008
              le_mean =     -22.668041619164
             les_mean =     514.334897978489
             stat err =       0.000546111467
             autocorr =       1.233446663374
   target nu stat err =       0.000546111467
   target dn stat err =       0.002937577707
      target stat err =       0.000933825985
              std dev =       0.695402273575
             le_variance =       0.483584322094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483729241313
                                         uncertainty =       0.002128605239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483729241313
                                         uncertainty =       0.002128605239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491723108
  error estimate for blocks of size 2^( 2) =       0.000509955540
  error estimate for blocks of size 2^( 3) =       0.000527263896
  error estimate for blocks of size 2^( 4) =       0.000539275205
  error estimate for blocks of size 2^( 5) =       0.000546080348
  error estimate for blocks of size 2^( 6) =       0.000548831409
  error estimate for blocks of size 2^( 7) =       0.000550256695

      target function =      -0.612122955044
              le_mean =     -22.668041600290
             les_mean =     514.334984332076
             stat err =       0.000546110914
             autocorr =       1.233446953427
   target nu stat err =       0.000546110914
   target dn stat err =       0.002939686134
      target stat err =       0.000934361978
              std dev =       0.695401488094
             le_variance =       0.483583229644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483729787754
                                         uncertainty =       0.002128619712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483729787754
                                         uncertainty =       0.002128619712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491723386
  error estimate for blocks of size 2^( 2) =       0.000509955814
  error estimate for blocks of size 2^( 3) =       0.000527264168
  error estimate for blocks of size 2^( 4) =       0.000539275474
  error estimate for blocks of size 2^( 5) =       0.000546080605
  error estimate for blocks of size 2^( 6) =       0.000548831692
  error estimate for blocks of size 2^( 7) =       0.000550256991

      target function =      -0.612143542059
              le_mean =     -22.668041609677
             les_mean =     514.334917084737
             stat err =       0.000546111190
             autocorr =       1.233446807999
   target nu stat err =       0.000546111190
   target dn stat err =       0.002937836984
      target stat err =       0.000933884027
              std dev =       0.695401880754
             le_variance =       0.483583775756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483730266079
                                         uncertainty =       0.002128632380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483730266079
                                         uncertainty =       0.002128632380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491723629
  error estimate for blocks of size 2^( 2) =       0.000509956054
  error estimate for blocks of size 2^( 3) =       0.000527264406
  error estimate for blocks of size 2^( 4) =       0.000539275710
  error estimate for blocks of size 2^( 5) =       0.000546080829
  error estimate for blocks of size 2^( 6) =       0.000548831940
  error estimate for blocks of size 2^( 7) =       0.000550257250

      target function =      -0.612149017493
              le_mean =     -22.668041617976
             les_mean =     514.334899467157
             stat err =       0.000546111432
             autocorr =       1.233446681438
   target nu stat err =       0.000546111432
   target dn stat err =       0.002937594477
      target stat err =       0.000933829488
              std dev =       0.695402224467
             le_variance =       0.483584253794


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.612149487008        initial  <--
     2.3842e+02     2.3842e+03             1.5394e-06        -0.612122955044
     9.5367e+02     9.5367e+03             3.8490e-07        -0.612143542059
     3.8147e+03     3.8147e+04             9.6229e-08        -0.612149017493

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 89.8260
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027612e-01 3 1  ON 1
ci_003                -5.364625e-02 3 1  ON 2
ci_004                -5.404858e-02 3 1  ON 3
ci_005                 2.331748e-02 3 1  ON 4
ci_006                 2.338923e-02 3 1  ON 5
ci_007                 1.859319e-02 3 1  ON 6
ci_008                 1.898593e-02 3 1  ON 7
ci_009                -1.495927e-02 3 1  ON 8
ci_010                -1.471254e-02 3 1  ON 9
ci_011                -1.253753e-02 3 1  ON 10
ci_012                -1.212485e-02 3 1  ON 11
ci_013                 1.121487e-02 3 1  ON 12
ci_014                 1.100146e-02 3 1  ON 13
ci_015                 1.261116e-02 3 1  ON 14
ci_016                 1.239980e-02 3 1  ON 15
ci_017                 1.050062e-02 3 1  ON 16
ci_018                 1.048115e-02 3 1  ON 17
ci_019                 3.270976e-03 3 1  ON 18
ci_020                 3.487815e-03 3 1  ON 19
ci_021                -8.069659e-03 3 1  ON 20
ci_022                -8.279601e-03 3 1  ON 21
ci_023                 6.237069e-03 3 1  ON 22
ci_024                 6.337804e-03 3 1  ON 23
ci_025                 9.039962e-03 3 1  ON 24
ci_026                 8.952345e-03 3 1  ON 25
ci_027                 6.585471e-03 3 1  ON 26
ci_028                 6.651366e-03 3 1  ON 27
ci_029                -5.191519e-03 3 1  ON 28
ci_030                -5.156049e-03 3 1  ON 29
ci_031                -1.764186e-03 3 1  ON 30
ci_032                -1.724616e-03 3 1  ON 31
ci_033                 4.328511e-03 3 1  ON 32
ci_034                 4.226565e-03 3 1  ON 33
ci_035                 2.738219e-03 3 1  ON 34
ci_036                 2.771678e-03 3 1  ON 35
ci_037                 4.703519e-03 3 1  ON 36
ci_038                 4.550758e-03 3 1  ON 37
ci_039                 4.574046e-03 3 1  ON 38
ci_040                 4.649433e-03 3 1  ON 39
ci_041                 3.713800e-03 3 1  ON 40
ci_042                 3.564621e-03 3 1  ON 41
ci_043                 3.873225e-03 3 1  ON 42
ci_044                 4.055506e-03 3 1  ON 43
ci_045                 3.215195e-03 3 1  ON 44
ci_046                 3.197663e-03 3 1  ON 45
ci_047                -1.608158e-03 3 1  ON 46
ci_048                -1.718813e-03 3 1  ON 47
ci_049                 1.400862e-03 3 1  ON 48
ci_050                 1.489158e-03 3 1  ON 49
ci_051                -2.174448e-03 3 1  ON 50
ci_052                -2.077303e-03 3 1  ON 51
ci_053                -2.235998e-03 3 1  ON 52
ci_054                -2.386420e-03 3 1  ON 53
ci_055                -1.128843e-03 3 1  ON 54
ci_056                -1.636908e-03 3 1  ON 55
ci_057                -1.221062e-03 3 1  ON 56
ci_058                -1.464321e-03 3 1  ON 57
ci_059                -8.265570e-04 3 1  ON 58
ci_060                -6.616202e-04 3 1  ON 59
ci_061                -9.769195e-04 3 1  ON 60
ci_062                -7.221077e-04 3 1  ON 61
ci_063                -6.059536e-04 3 1  ON 62
ci_064                -7.525454e-04 3 1  ON 63
ci_065                -1.915567e-03 3 1  ON 64
ci_066                -2.109753e-03 3 1  ON 65
ci_067                -1.464274e-03 3 1  ON 66
ci_068                -1.105423e-03 3 1  ON 67
ci_069                -1.826787e-05 3 1  ON 68
ci_070                 1.328213e-04 3 1  ON 69
ci_071                -1.880432e-03 3 1  ON 70
ci_072                -1.750270e-03 3 1  ON 71
ci_073                 5.040965e-04 3 1  ON 72
ci_074                 4.903957e-04 3 1  ON 73
ci_075                -1.868128e-04 3 1  ON 74
ci_076                -1.196436e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.5062e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.5726
    reference variance = 0.416859
====================================================
  Execution time = 5.1205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9038e-01
  Total weights = 1.954704394e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479578062025
                                         uncertainty =       0.002331079235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479578062025
                                         uncertainty =       0.002331079235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489686412
  error estimate for blocks of size 2^( 2) =       0.000508365502
  error estimate for blocks of size 2^( 3) =       0.000526044087
  error estimate for blocks of size 2^( 4) =       0.000538675671
  error estimate for blocks of size 2^( 5) =       0.000546350061
  error estimate for blocks of size 2^( 6) =       0.000549982691
  error estimate for blocks of size 2^( 7) =       0.000549749972

      target function =      -0.613662616137
              le_mean =     -22.668710101942
             les_mean =     514.360799966958
             stat err =       0.000546189599
             autocorr =       1.244086980498
   target nu stat err =       0.000546189599
   target dn stat err =       0.002881511361
      target stat err =       0.000922376230
              std dev =       0.692521164753
             le_variance =       0.479585563630


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266871010194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.613663704037       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.613663718421       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.613663719889       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.613663720056       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.613663720106       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.613663720127       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.613663720140       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.613663720141       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+03 is 1.386034e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.613663704037       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.613663707633       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.613663708000       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.613663708042       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.613663708054       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.613663708060       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.613663708063       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.613663708063       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+03 is 3.465128e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.613663704037       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.613663704936       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.613663705028       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.613663705038       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.613663705041       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.613663705043       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.613663705043       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.613663705043       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 8.662848e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.817619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0611e+01
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027612e-01 3 1  ON 1
ci_003                -5.364624e-02 3 1  ON 2
ci_004                -5.404855e-02 3 1  ON 3
ci_005                 2.331745e-02 3 1  ON 4
ci_006                 2.338919e-02 3 1  ON 5
ci_007                 1.859316e-02 3 1  ON 6
ci_008                 1.898591e-02 3 1  ON 7
ci_009                -1.495926e-02 3 1  ON 8
ci_010                -1.471252e-02 3 1  ON 9
ci_011                -1.253751e-02 3 1  ON 10
ci_012                -1.212484e-02 3 1  ON 11
ci_013                 1.121486e-02 3 1  ON 12
ci_014                 1.100144e-02 3 1  ON 13
ci_015                 1.261114e-02 3 1  ON 14
ci_016                 1.239978e-02 3 1  ON 15
ci_017                 1.050062e-02 3 1  ON 16
ci_018                 1.048114e-02 3 1  ON 17
ci_019                 3.270965e-03 3 1  ON 18
ci_020                 3.487802e-03 3 1  ON 19
ci_021                -8.069654e-03 3 1  ON 20
ci_022                -8.279592e-03 3 1  ON 21
ci_023                 6.237065e-03 3 1  ON 22
ci_024                 6.337802e-03 3 1  ON 23
ci_025                 9.039964e-03 3 1  ON 24
ci_026                 8.952343e-03 3 1  ON 25
ci_027                 6.585471e-03 3 1  ON 26
ci_028                 6.651366e-03 3 1  ON 27
ci_029                -5.191518e-03 3 1  ON 28
ci_030                -5.156046e-03 3 1  ON 29
ci_031                -1.764172e-03 3 1  ON 30
ci_032                -1.724612e-03 3 1  ON 31
ci_033                 4.328508e-03 3 1  ON 32
ci_034                 4.226554e-03 3 1  ON 33
ci_035                 2.738212e-03 3 1  ON 34
ci_036                 2.771673e-03 3 1  ON 35
ci_037                 4.703516e-03 3 1  ON 36
ci_038                 4.550748e-03 3 1  ON 37
ci_039                 4.574046e-03 3 1  ON 38
ci_040                 4.649431e-03 3 1  ON 39
ci_041                 3.713798e-03 3 1  ON 40
ci_042                 3.564621e-03 3 1  ON 41
ci_043                 3.873218e-03 3 1  ON 42
ci_044                 4.055502e-03 3 1  ON 43
ci_045                 3.215191e-03 3 1  ON 44
ci_046                 3.197668e-03 3 1  ON 45
ci_047                -1.608156e-03 3 1  ON 46
ci_048                -1.718811e-03 3 1  ON 47
ci_049                 1.400858e-03 3 1  ON 48
ci_050                 1.489150e-03 3 1  ON 49
ci_051                -2.174447e-03 3 1  ON 50
ci_052                -2.077304e-03 3 1  ON 51
ci_053                -2.236000e-03 3 1  ON 52
ci_054                -2.386414e-03 3 1  ON 53
ci_055                -1.128840e-03 3 1  ON 54
ci_056                -1.636911e-03 3 1  ON 55
ci_057                -1.221058e-03 3 1  ON 56
ci_058                -1.464317e-03 3 1  ON 57
ci_059                -8.265598e-04 3 1  ON 58
ci_060                -6.616200e-04 3 1  ON 59
ci_061                -9.769127e-04 3 1  ON 60
ci_062                -7.221070e-04 3 1  ON 61
ci_063                -6.059504e-04 3 1  ON 62
ci_064                -7.525466e-04 3 1  ON 63
ci_065                -1.915564e-03 3 1  ON 64
ci_066                -2.109751e-03 3 1  ON 65
ci_067                -1.464275e-03 3 1  ON 66
ci_068                -1.105422e-03 3 1  ON 67
ci_069                -1.826815e-05 3 1  ON 68
ci_070                 1.328186e-04 3 1  ON 69
ci_071                -1.880433e-03 3 1  ON 70
ci_072                -1.750271e-03 3 1  ON 71
ci_073                 5.040938e-04 3 1  ON 72
ci_074                 4.903940e-04 3 1  ON 73
ci_075                -1.868127e-04 3 1  ON 74
ci_076                -1.196425e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.6977
    reference variance = 0.219925
====================================================
  Execution time = 5.0713e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9805e-01
  Total weights = 1.9551e+06
  Execution time = 7.2097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485031278319
                                         uncertainty =       0.002564075642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485031278319
                                         uncertainty =       0.002564075642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492398698
  error estimate for blocks of size 2^( 2) =       0.000511126558
  error estimate for blocks of size 2^( 3) =       0.000527804248
  error estimate for blocks of size 2^( 4) =       0.000540427264
  error estimate for blocks of size 2^( 5) =       0.000547588428
  error estimate for blocks of size 2^( 6) =       0.000552273640
  error estimate for blocks of size 2^( 7) =       0.000553450949

      target function =      -0.611281215800
              le_mean =     -22.668538841327
             les_mean =     514.360706464579
             stat err =       0.000548435070
             autocorr =       1.240556774605
   target nu stat err =       0.000548435070
   target dn stat err =       0.004095780242
      target stat err =       0.001272263000
              std dev =       0.696356917084
             le_variance =       0.484912955970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485031198790
                                         uncertainty =       0.002564081191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485031198790
                                         uncertainty =       0.002564081191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492398658
  error estimate for blocks of size 2^( 2) =       0.000511126519
  error estimate for blocks of size 2^( 3) =       0.000527804208
  error estimate for blocks of size 2^( 4) =       0.000540427223
  error estimate for blocks of size 2^( 5) =       0.000547588385
  error estimate for blocks of size 2^( 6) =       0.000552273599
  error estimate for blocks of size 2^( 7) =       0.000553450907

      target function =      -0.611281221529
              le_mean =     -22.668538842828
             les_mean =     514.360706514845
             stat err =       0.000548435028
             autocorr =       1.240556788392
   target nu stat err =       0.000548435028
   target dn stat err =       0.004095810760
      target stat err =       0.001272272066
              std dev =       0.696356860071
             le_variance =       0.484912876568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485031238553
                                         uncertainty =       0.002564078417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485031238553
                                         uncertainty =       0.002564078417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492398678
  error estimate for blocks of size 2^( 2) =       0.000511126539
  error estimate for blocks of size 2^( 3) =       0.000527804228
  error estimate for blocks of size 2^( 4) =       0.000540427244
  error estimate for blocks of size 2^( 5) =       0.000547588406
  error estimate for blocks of size 2^( 6) =       0.000552273620
  error estimate for blocks of size 2^( 7) =       0.000553450928

      target function =      -0.611281218677
              le_mean =     -22.668538842078
             les_mean =     514.360706489669
             stat err =       0.000548435049
             autocorr =       1.240556781500
   target nu stat err =       0.000548435049
   target dn stat err =       0.004095795501
      target stat err =       0.001272267533
              std dev =       0.696356888577
             le_variance =       0.484912916268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485031273348
                                         uncertainty =       0.002564075989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485031273348
                                         uncertainty =       0.002564075989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492398696
  error estimate for blocks of size 2^( 2) =       0.000511126556
  error estimate for blocks of size 2^( 3) =       0.000527804246
  error estimate for blocks of size 2^( 4) =       0.000540427262
  error estimate for blocks of size 2^( 5) =       0.000547588425
  error estimate for blocks of size 2^( 6) =       0.000552273637
  error estimate for blocks of size 2^( 7) =       0.000553450946

      target function =      -0.611281216161
              le_mean =     -22.668538841421
             les_mean =     514.360706467711
             stat err =       0.000548435068
             autocorr =       1.240556775470
   target nu stat err =       0.000548435068
   target dn stat err =       0.004095782149
      target stat err =       0.001272263567
              std dev =       0.696356913520
             le_variance =       0.484912951008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611281215800        initial
     2.3842e+03     2.3842e+04             1.3860e-07        -0.611281221529  <--
     9.5367e+03     9.5367e+04             3.4651e-08        -0.611281218677
     3.8147e+04     3.8147e+05             8.6628e-09        -0.611281216161

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 8.6877e+01
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027612e-01 3 1  ON 1
ci_003                -5.364619e-02 3 1  ON 2
ci_004                -5.404848e-02 3 1  ON 3
ci_005                 2.331735e-02 3 1  ON 4
ci_006                 2.338909e-02 3 1  ON 5
ci_007                 1.859309e-02 3 1  ON 6
ci_008                 1.898584e-02 3 1  ON 7
ci_009                -1.495921e-02 3 1  ON 8
ci_010                -1.471246e-02 3 1  ON 9
ci_011                -1.253745e-02 3 1  ON 10
ci_012                -1.212480e-02 3 1  ON 11
ci_013                 1.121482e-02 3 1  ON 12
ci_014                 1.100139e-02 3 1  ON 13
ci_015                 1.261108e-02 3 1  ON 14
ci_016                 1.239975e-02 3 1  ON 15
ci_017                 1.050060e-02 3 1  ON 16
ci_018                 1.048112e-02 3 1  ON 17
ci_019                 3.270930e-03 3 1  ON 18
ci_020                 3.487763e-03 3 1  ON 19
ci_021                -8.069642e-03 3 1  ON 20
ci_022                -8.279567e-03 3 1  ON 21
ci_023                 6.237052e-03 3 1  ON 22
ci_024                 6.337798e-03 3 1  ON 23
ci_025                 9.039970e-03 3 1  ON 24
ci_026                 8.952335e-03 3 1  ON 25
ci_027                 6.585470e-03 3 1  ON 26
ci_028                 6.651366e-03 3 1  ON 27
ci_029                -5.191516e-03 3 1  ON 28
ci_030                -5.156039e-03 3 1  ON 29
ci_031                -1.764131e-03 3 1  ON 30
ci_032                -1.724599e-03 3 1  ON 31
ci_033                 4.328498e-03 3 1  ON 32
ci_034                 4.226522e-03 3 1  ON 33
ci_035                 2.738192e-03 3 1  ON 34
ci_036                 2.771659e-03 3 1  ON 35
ci_037                 4.703508e-03 3 1  ON 36
ci_038                 4.550720e-03 3 1  ON 37
ci_039                 4.574045e-03 3 1  ON 38
ci_040                 4.649426e-03 3 1  ON 39
ci_041                 3.713794e-03 3 1  ON 40
ci_042                 3.564623e-03 3 1  ON 41
ci_043                 3.873200e-03 3 1  ON 42
ci_044                 4.055490e-03 3 1  ON 43
ci_045                 3.215178e-03 3 1  ON 44
ci_046                 3.197684e-03 3 1  ON 45
ci_047                -1.608150e-03 3 1  ON 46
ci_048                -1.718802e-03 3 1  ON 47
ci_049                 1.400845e-03 3 1  ON 48
ci_050                 1.489127e-03 3 1  ON 49
ci_051                -2.174446e-03 3 1  ON 50
ci_052                -2.077306e-03 3 1  ON 51
ci_053                -2.236005e-03 3 1  ON 52
ci_054                -2.386396e-03 3 1  ON 53
ci_055                -1.128831e-03 3 1  ON 54
ci_056                -1.636921e-03 3 1  ON 55
ci_057                -1.221045e-03 3 1  ON 56
ci_058                -1.464304e-03 3 1  ON 57
ci_059                -8.265680e-04 3 1  ON 58
ci_060                -6.616194e-04 3 1  ON 59
ci_061                -9.768923e-04 3 1  ON 60
ci_062                -7.221048e-04 3 1  ON 61
ci_063                -6.059410e-04 3 1  ON 62
ci_064                -7.525500e-04 3 1  ON 63
ci_065                -1.915555e-03 3 1  ON 64
ci_066                -2.109747e-03 3 1  ON 65
ci_067                -1.464279e-03 3 1  ON 66
ci_068                -1.105420e-03 3 1  ON 67
ci_069                -1.826897e-05 3 1  ON 68
ci_070                 1.328106e-04 3 1  ON 69
ci_071                -1.880435e-03 3 1  ON 70
ci_072                -1.750271e-03 3 1  ON 71
ci_073                 5.040856e-04 3 1  ON 72
ci_074                 4.903888e-04 3 1  ON 73
ci_075                -1.868125e-04 3 1  ON 74
ci_076                -1.196389e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4750e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.6562
    reference variance = 0.450666
====================================================
  Execution time = 5.1265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0548e-01
  Total weights = 1.955496810e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491317183222
                                         uncertainty =       0.003371477416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491317183222
                                         uncertainty =       0.003371477416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495592752
  error estimate for blocks of size 2^( 2) =       0.000514172754
  error estimate for blocks of size 2^( 3) =       0.000531648356
  error estimate for blocks of size 2^( 4) =       0.000543442493
  error estimate for blocks of size 2^( 5) =       0.000549825201
  error estimate for blocks of size 2^( 6) =       0.000552900153
  error estimate for blocks of size 2^( 7) =       0.000552115860

      target function =      -0.608902280240
              le_mean =     -22.668005996284
             les_mean =     514.343980408623
             stat err =       0.000549570927
             autocorr =       1.229695564082
   target nu stat err =       0.000549570927
   target dn stat err =       0.004495639265
      target stat err =       0.001379941179
              std dev =       0.700873991651
             le_variance =       0.491224352173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266800599628e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608905145355       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608905212326       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608905219481       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608905220067       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608905220245       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608905220295       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608905220296       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608905220300       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+02 is 6.136271e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608905145355       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608905162098       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608905163887       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608905164033       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608905164077       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608905164084       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608905164086       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608905164090       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+03 is 1.534145e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608905145355       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608905149541       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608905149988       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608905150025       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608905150034       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608905150039       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608905150038       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608905150036       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+03 is 3.835411e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.821404 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0717e+01
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027613e-01 3 1  ON 1
ci_003                -5.364610e-02 3 1  ON 2
ci_004                -5.404839e-02 3 1  ON 3
ci_005                 2.331719e-02 3 1  ON 4
ci_006                 2.338894e-02 3 1  ON 5
ci_007                 1.859301e-02 3 1  ON 6
ci_008                 1.898573e-02 3 1  ON 7
ci_009                -1.495913e-02 3 1  ON 8
ci_010                -1.471241e-02 3 1  ON 9
ci_011                -1.253739e-02 3 1  ON 10
ci_012                -1.212474e-02 3 1  ON 11
ci_013                 1.121475e-02 3 1  ON 12
ci_014                 1.100134e-02 3 1  ON 13
ci_015                 1.261099e-02 3 1  ON 14
ci_016                 1.239969e-02 3 1  ON 15
ci_017                 1.050058e-02 3 1  ON 16
ci_018                 1.048107e-02 3 1  ON 17
ci_019                 3.270883e-03 3 1  ON 18
ci_020                 3.487694e-03 3 1  ON 19
ci_021                -8.069650e-03 3 1  ON 20
ci_022                -8.279557e-03 3 1  ON 21
ci_023                 6.237055e-03 3 1  ON 22
ci_024                 6.337763e-03 3 1  ON 23
ci_025                 9.039976e-03 3 1  ON 24
ci_026                 8.952355e-03 3 1  ON 25
ci_027                 6.585474e-03 3 1  ON 26
ci_028                 6.651364e-03 3 1  ON 27
ci_029                -5.191501e-03 3 1  ON 28
ci_030                -5.156027e-03 3 1  ON 29
ci_031                -1.764069e-03 3 1  ON 30
ci_032                -1.724561e-03 3 1  ON 31
ci_033                 4.328487e-03 3 1  ON 32
ci_034                 4.226487e-03 3 1  ON 33
ci_035                 2.738169e-03 3 1  ON 34
ci_036                 2.771632e-03 3 1  ON 35
ci_037                 4.703498e-03 3 1  ON 36
ci_038                 4.550722e-03 3 1  ON 37
ci_039                 4.574046e-03 3 1  ON 38
ci_040                 4.649410e-03 3 1  ON 39
ci_041                 3.713783e-03 3 1  ON 40
ci_042                 3.564614e-03 3 1  ON 41
ci_043                 3.873183e-03 3 1  ON 42
ci_044                 4.055494e-03 3 1  ON 43
ci_045                 3.215170e-03 3 1  ON 44
ci_046                 3.197663e-03 3 1  ON 45
ci_047                -1.608154e-03 3 1  ON 46
ci_048                -1.718769e-03 3 1  ON 47
ci_049                 1.400819e-03 3 1  ON 48
ci_050                 1.489128e-03 3 1  ON 49
ci_051                -2.174458e-03 3 1  ON 50
ci_052                -2.077272e-03 3 1  ON 51
ci_053                -2.235981e-03 3 1  ON 52
ci_054                -2.386401e-03 3 1  ON 53
ci_055                -1.128815e-03 3 1  ON 54
ci_056                -1.636931e-03 3 1  ON 55
ci_057                -1.221041e-03 3 1  ON 56
ci_058                -1.464294e-03 3 1  ON 57
ci_059                -8.265527e-04 3 1  ON 58
ci_060                -6.616072e-04 3 1  ON 59
ci_061                -9.768647e-04 3 1  ON 60
ci_062                -7.220865e-04 3 1  ON 61
ci_063                -6.059419e-04 3 1  ON 62
ci_064                -7.525433e-04 3 1  ON 63
ci_065                -1.915559e-03 3 1  ON 64
ci_066                -2.109725e-03 3 1  ON 65
ci_067                -1.464293e-03 3 1  ON 66
ci_068                -1.105430e-03 3 1  ON 67
ci_069                -1.828768e-05 3 1  ON 68
ci_070                 1.328010e-04 3 1  ON 69
ci_071                -1.880445e-03 3 1  ON 70
ci_072                -1.750275e-03 3 1  ON 71
ci_073                 5.040654e-04 3 1  ON 72
ci_074                 4.903770e-04 3 1  ON 73
ci_075                -1.867926e-04 3 1  ON 74
ci_076                -1.196381e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.7786
    reference variance = 0.333232
====================================================
  Execution time = 4.9669e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9724e-01
  Total weights = 1.9552e+06
  Execution time = 7.2613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486445969738
                                         uncertainty =       0.002603848258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486445969738
                                         uncertainty =       0.002603848258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493167748
  error estimate for blocks of size 2^( 2) =       0.000511590598
  error estimate for blocks of size 2^( 3) =       0.000528207909
  error estimate for blocks of size 2^( 4) =       0.000540307349
  error estimate for blocks of size 2^( 5) =       0.000547221586
  error estimate for blocks of size 2^( 6) =       0.000551856246
  error estimate for blocks of size 2^( 7) =       0.000552267581

      target function =      -0.611409438092
              le_mean =     -22.668065008706
             les_mean =     514.338412166533
             stat err =       0.000547913191
             autocorr =       1.234338222626
   target nu stat err =       0.000547913191
   target dn stat err =       0.003387406728
      target stat err =       0.001063247510
              std dev =       0.697444517798
             le_variance =       0.486428855406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486445675720
                                         uncertainty =       0.002603866743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486445675720
                                         uncertainty =       0.002603866743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493167599
  error estimate for blocks of size 2^( 2) =       0.000511590449
  error estimate for blocks of size 2^( 3) =       0.000528207759
  error estimate for blocks of size 2^( 4) =       0.000540307195
  error estimate for blocks of size 2^( 5) =       0.000547221432
  error estimate for blocks of size 2^( 6) =       0.000551856077
  error estimate for blocks of size 2^( 7) =       0.000552267414

      target function =      -0.611409417902
              le_mean =     -22.668065009240
             les_mean =     514.338412257450
             stat err =       0.000547913030
             autocorr =       1.234338243113
   target nu stat err =       0.000547913030
   target dn stat err =       0.003387494094
      target stat err =       0.001063273051
              std dev =       0.697444307252
             le_variance =       0.486428561718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486445822716
                                         uncertainty =       0.002603857501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486445822716
                                         uncertainty =       0.002603857501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493167674
  error estimate for blocks of size 2^( 2) =       0.000511590524
  error estimate for blocks of size 2^( 3) =       0.000528207834
  error estimate for blocks of size 2^( 4) =       0.000540307272
  error estimate for blocks of size 2^( 5) =       0.000547221509
  error estimate for blocks of size 2^( 6) =       0.000551856162
  error estimate for blocks of size 2^( 7) =       0.000552267498

      target function =      -0.611409428287
              le_mean =     -22.668065008972
             les_mean =     514.338412210985
             stat err =       0.000547913110
             autocorr =       1.234338232881
   target nu stat err =       0.000547913110
   target dn stat err =       0.003387450385
      target stat err =       0.001063260274
              std dev =       0.697444412515
             le_variance =       0.486428708549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486445951360
                                         uncertainty =       0.002603849413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486445951360
                                         uncertainty =       0.002603849413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493167739
  error estimate for blocks of size 2^( 2) =       0.000511590589
  error estimate for blocks of size 2^( 3) =       0.000528207900
  error estimate for blocks of size 2^( 4) =       0.000540307339
  error estimate for blocks of size 2^( 5) =       0.000547221577
  error estimate for blocks of size 2^( 6) =       0.000551856236
  error estimate for blocks of size 2^( 7) =       0.000552267571

      target function =      -0.611409436898
              le_mean =     -22.668065008739
             les_mean =     514.338412171978
             stat err =       0.000547913181
             autocorr =       1.234338223911
   target nu stat err =       0.000547913181
   target dn stat err =       0.003387412182
      target stat err =       0.001063249105
              std dev =       0.697444504637
             le_variance =       0.486428837049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611409438092        initial  <--
     5.9605e+02     5.9605e+03             6.1363e-07        -0.611409417902
     2.3842e+03     2.3842e+04             1.5341e-07        -0.611409428287
     9.5367e+03     9.5367e+04             3.8354e-08        -0.611409436898

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 86.4689
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027612e-01 3 1  ON 1
ci_003                -5.364619e-02 3 1  ON 2
ci_004                -5.404848e-02 3 1  ON 3
ci_005                 2.331735e-02 3 1  ON 4
ci_006                 2.338909e-02 3 1  ON 5
ci_007                 1.859309e-02 3 1  ON 6
ci_008                 1.898584e-02 3 1  ON 7
ci_009                -1.495921e-02 3 1  ON 8
ci_010                -1.471246e-02 3 1  ON 9
ci_011                -1.253745e-02 3 1  ON 10
ci_012                -1.212480e-02 3 1  ON 11
ci_013                 1.121482e-02 3 1  ON 12
ci_014                 1.100139e-02 3 1  ON 13
ci_015                 1.261108e-02 3 1  ON 14
ci_016                 1.239975e-02 3 1  ON 15
ci_017                 1.050060e-02 3 1  ON 16
ci_018                 1.048112e-02 3 1  ON 17
ci_019                 3.270930e-03 3 1  ON 18
ci_020                 3.487763e-03 3 1  ON 19
ci_021                -8.069642e-03 3 1  ON 20
ci_022                -8.279567e-03 3 1  ON 21
ci_023                 6.237052e-03 3 1  ON 22
ci_024                 6.337798e-03 3 1  ON 23
ci_025                 9.039970e-03 3 1  ON 24
ci_026                 8.952335e-03 3 1  ON 25
ci_027                 6.585470e-03 3 1  ON 26
ci_028                 6.651366e-03 3 1  ON 27
ci_029                -5.191516e-03 3 1  ON 28
ci_030                -5.156039e-03 3 1  ON 29
ci_031                -1.764131e-03 3 1  ON 30
ci_032                -1.724599e-03 3 1  ON 31
ci_033                 4.328498e-03 3 1  ON 32
ci_034                 4.226522e-03 3 1  ON 33
ci_035                 2.738192e-03 3 1  ON 34
ci_036                 2.771659e-03 3 1  ON 35
ci_037                 4.703508e-03 3 1  ON 36
ci_038                 4.550720e-03 3 1  ON 37
ci_039                 4.574045e-03 3 1  ON 38
ci_040                 4.649426e-03 3 1  ON 39
ci_041                 3.713794e-03 3 1  ON 40
ci_042                 3.564623e-03 3 1  ON 41
ci_043                 3.873200e-03 3 1  ON 42
ci_044                 4.055490e-03 3 1  ON 43
ci_045                 3.215178e-03 3 1  ON 44
ci_046                 3.197684e-03 3 1  ON 45
ci_047                -1.608150e-03 3 1  ON 46
ci_048                -1.718802e-03 3 1  ON 47
ci_049                 1.400845e-03 3 1  ON 48
ci_050                 1.489127e-03 3 1  ON 49
ci_051                -2.174446e-03 3 1  ON 50
ci_052                -2.077306e-03 3 1  ON 51
ci_053                -2.236005e-03 3 1  ON 52
ci_054                -2.386396e-03 3 1  ON 53
ci_055                -1.128831e-03 3 1  ON 54
ci_056                -1.636921e-03 3 1  ON 55
ci_057                -1.221045e-03 3 1  ON 56
ci_058                -1.464304e-03 3 1  ON 57
ci_059                -8.265680e-04 3 1  ON 58
ci_060                -6.616194e-04 3 1  ON 59
ci_061                -9.768923e-04 3 1  ON 60
ci_062                -7.221048e-04 3 1  ON 61
ci_063                -6.059410e-04 3 1  ON 62
ci_064                -7.525500e-04 3 1  ON 63
ci_065                -1.915555e-03 3 1  ON 64
ci_066                -2.109747e-03 3 1  ON 65
ci_067                -1.464279e-03 3 1  ON 66
ci_068                -1.105420e-03 3 1  ON 67
ci_069                -1.826897e-05 3 1  ON 68
ci_070                 1.328106e-04 3 1  ON 69
ci_071                -1.880435e-03 3 1  ON 70
ci_072                -1.750271e-03 3 1  ON 71
ci_073                 5.040856e-04 3 1  ON 72
ci_074                 4.903888e-04 3 1  ON 73
ci_075                -1.868125e-04 3 1  ON 74
ci_076                -1.196389e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4719e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.6991
    reference variance = 0.403611
====================================================
  Execution time = 5.1281e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0262e-01
  Total weights = 1.955019131e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488320122712
                                         uncertainty =       0.002383237227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488320122712
                                         uncertainty =       0.002383237227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494183333
  error estimate for blocks of size 2^( 2) =       0.000512782216
  error estimate for blocks of size 2^( 3) =       0.000529313125
  error estimate for blocks of size 2^( 4) =       0.000540875677
  error estimate for blocks of size 2^( 5) =       0.000548336275
  error estimate for blocks of size 2^( 6) =       0.000553339277
  error estimate for blocks of size 2^( 7) =       0.000556052747

      target function =      -0.609724673190
              le_mean =     -22.667840680575
             les_mean =     514.333620967252
             stat err =       0.000549650994
             autocorr =       1.237080172486
   target nu stat err =       0.000549650994
   target dn stat err =       0.004433941158
      target stat err =       0.001365173534
              std dev =       0.698880772446
             le_variance =       0.488434334095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266784068058e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609727383616       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609727389142       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609727389978       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609727390165       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609727390222       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609727390221       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609727390225       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609727390224       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609727390227       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+03 is 5.373150e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609727383616       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609727384997       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609727385206       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609727385253       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609727385275       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609727385272       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609727385273       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609727385279       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609727385240       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+04 is 1.343294e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609727383616       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609727383961       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609727384013       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609727384025       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609727384042       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609727384005       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609727384052       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609727384045       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609727383849       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+04 is 3.358240e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.825816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0714e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027612e-01 3 1  ON 1
ci_003                -5.364618e-02 3 1  ON 2
ci_004                -5.404847e-02 3 1  ON 3
ci_005                 2.331733e-02 3 1  ON 4
ci_006                 2.338907e-02 3 1  ON 5
ci_007                 1.859308e-02 3 1  ON 6
ci_008                 1.898583e-02 3 1  ON 7
ci_009                -1.495920e-02 3 1  ON 8
ci_010                -1.471246e-02 3 1  ON 9
ci_011                -1.253744e-02 3 1  ON 10
ci_012                -1.212479e-02 3 1  ON 11
ci_013                 1.121481e-02 3 1  ON 12
ci_014                 1.100138e-02 3 1  ON 13
ci_015                 1.261107e-02 3 1  ON 14
ci_016                 1.239974e-02 3 1  ON 15
ci_017                 1.050060e-02 3 1  ON 16
ci_018                 1.048112e-02 3 1  ON 17
ci_019                 3.270921e-03 3 1  ON 18
ci_020                 3.487760e-03 3 1  ON 19
ci_021                -8.069637e-03 3 1  ON 20
ci_022                -8.279570e-03 3 1  ON 21
ci_023                 6.237050e-03 3 1  ON 22
ci_024                 6.337798e-03 3 1  ON 23
ci_025                 9.039971e-03 3 1  ON 24
ci_026                 8.952336e-03 3 1  ON 25
ci_027                 6.585469e-03 3 1  ON 26
ci_028                 6.651364e-03 3 1  ON 27
ci_029                -5.191517e-03 3 1  ON 28
ci_030                -5.156039e-03 3 1  ON 29
ci_031                -1.764132e-03 3 1  ON 30
ci_032                -1.724594e-03 3 1  ON 31
ci_033                 4.328497e-03 3 1  ON 32
ci_034                 4.226521e-03 3 1  ON 33
ci_035                 2.738189e-03 3 1  ON 34
ci_036                 2.771657e-03 3 1  ON 35
ci_037                 4.703507e-03 3 1  ON 36
ci_038                 4.550715e-03 3 1  ON 37
ci_039                 4.574045e-03 3 1  ON 38
ci_040                 4.649426e-03 3 1  ON 39
ci_041                 3.713792e-03 3 1  ON 40
ci_042                 3.564623e-03 3 1  ON 41
ci_043                 3.873198e-03 3 1  ON 42
ci_044                 4.055491e-03 3 1  ON 43
ci_045                 3.215180e-03 3 1  ON 44
ci_046                 3.197684e-03 3 1  ON 45
ci_047                -1.608148e-03 3 1  ON 46
ci_048                -1.718802e-03 3 1  ON 47
ci_049                 1.400844e-03 3 1  ON 48
ci_050                 1.489126e-03 3 1  ON 49
ci_051                -2.174446e-03 3 1  ON 50
ci_052                -2.077306e-03 3 1  ON 51
ci_053                -2.236002e-03 3 1  ON 52
ci_054                -2.386396e-03 3 1  ON 53
ci_055                -1.128829e-03 3 1  ON 54
ci_056                -1.636922e-03 3 1  ON 55
ci_057                -1.221045e-03 3 1  ON 56
ci_058                -1.464304e-03 3 1  ON 57
ci_059                -8.265674e-04 3 1  ON 58
ci_060                -6.616207e-04 3 1  ON 59
ci_061                -9.768916e-04 3 1  ON 60
ci_062                -7.221048e-04 3 1  ON 61
ci_063                -6.059392e-04 3 1  ON 62
ci_064                -7.525500e-04 3 1  ON 63
ci_065                -1.915555e-03 3 1  ON 64
ci_066                -2.109747e-03 3 1  ON 65
ci_067                -1.464280e-03 3 1  ON 66
ci_068                -1.105420e-03 3 1  ON 67
ci_069                -1.827029e-05 3 1  ON 68
ci_070                 1.328102e-04 3 1  ON 69
ci_071                -1.880434e-03 3 1  ON 70
ci_072                -1.750273e-03 3 1  ON 71
ci_073                 5.040853e-04 3 1  ON 72
ci_074                 4.903880e-04 3 1  ON 73
ci_075                -1.868127e-04 3 1  ON 74
ci_076                -1.196388e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.5514
    reference variance = 0.60217
====================================================
  Execution time = 4.9884e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9763e-01
  Total weights = 1.9549e+06
  Execution time = 7.2326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484555283377
                                         uncertainty =       0.002526894003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484555283377
                                         uncertainty =       0.002526894003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492254569
  error estimate for blocks of size 2^( 2) =       0.000510961058
  error estimate for blocks of size 2^( 3) =       0.000527845170
  error estimate for blocks of size 2^( 4) =       0.000540077580
  error estimate for blocks of size 2^( 5) =       0.000547051212
  error estimate for blocks of size 2^( 6) =       0.000551278332
  error estimate for blocks of size 2^( 7) =       0.000550645831

      target function =      -0.611545359330
              le_mean =     -22.669070639465
             les_mean =     514.384389760673
             stat err =       0.000547263239
             autocorr =       1.235984547639
   target nu stat err =       0.000547263239
   target dn stat err =       0.003212163135
      target stat err =       0.001013104717
              std dev =       0.696153087509
             le_variance =       0.484629121249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484555248704
                                         uncertainty =       0.002526894142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484555248704
                                         uncertainty =       0.002526894142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492254551
  error estimate for blocks of size 2^( 2) =       0.000510961040
  error estimate for blocks of size 2^( 3) =       0.000527845152
  error estimate for blocks of size 2^( 4) =       0.000540077562
  error estimate for blocks of size 2^( 5) =       0.000547051194
  error estimate for blocks of size 2^( 6) =       0.000551278315
  error estimate for blocks of size 2^( 7) =       0.000550645814

      target function =      -0.611545374487
              le_mean =     -22.669070639580
             les_mean =     514.384389716125
             stat err =       0.000547263221
             autocorr =       1.235984556420
   target nu stat err =       0.000547263221
   target dn stat err =       0.003212164508
      target stat err =       0.001013105165
              std dev =       0.696153062598
             le_variance =       0.484629086565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484555266040
                                         uncertainty =       0.002526894073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484555266040
                                         uncertainty =       0.002526894073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492254560
  error estimate for blocks of size 2^( 2) =       0.000510961049
  error estimate for blocks of size 2^( 3) =       0.000527845161
  error estimate for blocks of size 2^( 4) =       0.000540077571
  error estimate for blocks of size 2^( 5) =       0.000547051203
  error estimate for blocks of size 2^( 6) =       0.000551278323
  error estimate for blocks of size 2^( 7) =       0.000550645822

      target function =      -0.611545366910
              le_mean =     -22.669070639523
             les_mean =     514.384389738396
             stat err =       0.000547263230
             autocorr =       1.235984552030
   target nu stat err =       0.000547263230
   target dn stat err =       0.003212163821
      target stat err =       0.001013104941
              std dev =       0.696153075054
             le_variance =       0.484629103906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484555281210
                                         uncertainty =       0.002526894012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484555281210
                                         uncertainty =       0.002526894012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492254568
  error estimate for blocks of size 2^( 2) =       0.000510961057
  error estimate for blocks of size 2^( 3) =       0.000527845169
  error estimate for blocks of size 2^( 4) =       0.000540077579
  error estimate for blocks of size 2^( 5) =       0.000547051211
  error estimate for blocks of size 2^( 6) =       0.000551278331
  error estimate for blocks of size 2^( 7) =       0.000550645830

      target function =      -0.611545360278
              le_mean =     -22.669070639472
             les_mean =     514.384389757888
             stat err =       0.000547263238
             autocorr =       1.235984548186
   target nu stat err =       0.000547263238
   target dn stat err =       0.003212163220
      target stat err =       0.001013104745
              std dev =       0.696153085952
             le_variance =       0.484629119081


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611545359330        initial
     5.9605e+03     5.9605e+04             5.3731e-08        -0.611545374487  <--
     2.3842e+04     2.3842e+05             1.3433e-08        -0.611545366910
     9.5367e+04     9.5367e+05             3.3582e-09        -0.611545360278

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 8.6161e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027613e-01 3 1  ON 1
ci_003                -5.364616e-02 3 1  ON 2
ci_004                -5.404843e-02 3 1  ON 3
ci_005                 2.331729e-02 3 1  ON 4
ci_006                 2.338903e-02 3 1  ON 5
ci_007                 1.859306e-02 3 1  ON 6
ci_008                 1.898581e-02 3 1  ON 7
ci_009                -1.495919e-02 3 1  ON 8
ci_010                -1.471244e-02 3 1  ON 9
ci_011                -1.253742e-02 3 1  ON 10
ci_012                -1.212476e-02 3 1  ON 11
ci_013                 1.121479e-02 3 1  ON 12
ci_014                 1.100136e-02 3 1  ON 13
ci_015                 1.261105e-02 3 1  ON 14
ci_016                 1.239973e-02 3 1  ON 15
ci_017                 1.050059e-02 3 1  ON 16
ci_018                 1.048110e-02 3 1  ON 17
ci_019                 3.270896e-03 3 1  ON 18
ci_020                 3.487749e-03 3 1  ON 19
ci_021                -8.069621e-03 3 1  ON 20
ci_022                -8.279576e-03 3 1  ON 21
ci_023                 6.237045e-03 3 1  ON 22
ci_024                 6.337798e-03 3 1  ON 23
ci_025                 9.039973e-03 3 1  ON 24
ci_026                 8.952338e-03 3 1  ON 25
ci_027                 6.585465e-03 3 1  ON 26
ci_028                 6.651358e-03 3 1  ON 27
ci_029                -5.191519e-03 3 1  ON 28
ci_030                -5.156040e-03 3 1  ON 29
ci_031                -1.764136e-03 3 1  ON 30
ci_032                -1.724578e-03 3 1  ON 31
ci_033                 4.328492e-03 3 1  ON 32
ci_034                 4.226518e-03 3 1  ON 33
ci_035                 2.738181e-03 3 1  ON 34
ci_036                 2.771654e-03 3 1  ON 35
ci_037                 4.703504e-03 3 1  ON 36
ci_038                 4.550703e-03 3 1  ON 37
ci_039                 4.574045e-03 3 1  ON 38
ci_040                 4.649425e-03 3 1  ON 39
ci_041                 3.713789e-03 3 1  ON 40
ci_042                 3.564622e-03 3 1  ON 41
ci_043                 3.873192e-03 3 1  ON 42
ci_044                 4.055492e-03 3 1  ON 43
ci_045                 3.215184e-03 3 1  ON 44
ci_046                 3.197685e-03 3 1  ON 45
ci_047                -1.608143e-03 3 1  ON 46
ci_048                -1.718800e-03 3 1  ON 47
ci_049                 1.400843e-03 3 1  ON 48
ci_050                 1.489125e-03 3 1  ON 49
ci_051                -2.174447e-03 3 1  ON 50
ci_052                -2.077305e-03 3 1  ON 51
ci_053                -2.235995e-03 3 1  ON 52
ci_054                -2.386396e-03 3 1  ON 53
ci_055                -1.128824e-03 3 1  ON 54
ci_056                -1.636923e-03 3 1  ON 55
ci_057                -1.221045e-03 3 1  ON 56
ci_058                -1.464305e-03 3 1  ON 57
ci_059                -8.265654e-04 3 1  ON 58
ci_060                -6.616247e-04 3 1  ON 59
ci_061                -9.768894e-04 3 1  ON 60
ci_062                -7.221048e-04 3 1  ON 61
ci_063                -6.059339e-04 3 1  ON 62
ci_064                -7.525499e-04 3 1  ON 63
ci_065                -1.915557e-03 3 1  ON 64
ci_066                -2.109747e-03 3 1  ON 65
ci_067                -1.464281e-03 3 1  ON 66
ci_068                -1.105422e-03 3 1  ON 67
ci_069                -1.827425e-05 3 1  ON 68
ci_070                 1.328092e-04 3 1  ON 69
ci_071                -1.880432e-03 3 1  ON 70
ci_072                -1.750278e-03 3 1  ON 71
ci_073                 5.040843e-04 3 1  ON 72
ci_074                 4.903857e-04 3 1  ON 73
ci_075                -1.868132e-04 3 1  ON 74
ci_076                -1.196382e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4688e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7086
    reference variance = 0.503979
====================================================
  Execution time = 5.1053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0025e-01
  Total weights = 1.955097518e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489743487188
                                         uncertainty =       0.003515963178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489743487188
                                         uncertainty =       0.003515963178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494859870
  error estimate for blocks of size 2^( 2) =       0.000513548388
  error estimate for blocks of size 2^( 3) =       0.000529815663
  error estimate for blocks of size 2^( 4) =       0.000541441372
  error estimate for blocks of size 2^( 5) =       0.000547759627
  error estimate for blocks of size 2^( 6) =       0.000550004755
  error estimate for blocks of size 2^( 7) =       0.000551258254

      target function =      -0.610626661443
              le_mean =     -22.668586093203
             les_mean =     514.365047846657
             stat err =       0.000547616002
             autocorr =       1.224581761826
   target nu stat err =       0.000547616002
   target dn stat err =       0.003907923552
      target stat err =       0.001214058795
              std dev =       0.699837539964
             le_variance =       0.489772582342


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266858609320e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610628781057       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610628803390       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610628805582       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610628805842       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610628805917       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610628805932       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610628805940       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610628805942       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610628805940       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+03 is 2.388939e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610628781057       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610628786640       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610628787188       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610628787253       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610628787263       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610628787284       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610628787267       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610628787283       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610628787277       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+03 is 5.972466e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610628781057       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610628782452       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610628782589       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610628782608       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610628782635       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610628782646       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610628782624       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610628782629       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610628782631       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+04 is 1.493124e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.830296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0474e+01
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027613e-01 3 1  ON 1
ci_003                -5.364614e-02 3 1  ON 2
ci_004                -5.404840e-02 3 1  ON 3
ci_005                 2.331724e-02 3 1  ON 4
ci_006                 2.338897e-02 3 1  ON 5
ci_007                 1.859303e-02 3 1  ON 6
ci_008                 1.898577e-02 3 1  ON 7
ci_009                -1.495916e-02 3 1  ON 8
ci_010                -1.471241e-02 3 1  ON 9
ci_011                -1.253738e-02 3 1  ON 10
ci_012                -1.212473e-02 3 1  ON 11
ci_013                 1.121478e-02 3 1  ON 12
ci_014                 1.100133e-02 3 1  ON 13
ci_015                 1.261103e-02 3 1  ON 14
ci_016                 1.239971e-02 3 1  ON 15
ci_017                 1.050057e-02 3 1  ON 16
ci_018                 1.048109e-02 3 1  ON 17
ci_019                 3.270877e-03 3 1  ON 18
ci_020                 3.487727e-03 3 1  ON 19
ci_021                -8.069619e-03 3 1  ON 20
ci_022                -8.279561e-03 3 1  ON 21
ci_023                 6.237038e-03 3 1  ON 22
ci_024                 6.337799e-03 3 1  ON 23
ci_025                 9.039983e-03 3 1  ON 24
ci_026                 8.952348e-03 3 1  ON 25
ci_027                 6.585469e-03 3 1  ON 26
ci_028                 6.651356e-03 3 1  ON 27
ci_029                -5.191502e-03 3 1  ON 28
ci_030                -5.156035e-03 3 1  ON 29
ci_031                -1.764121e-03 3 1  ON 30
ci_032                -1.724554e-03 3 1  ON 31
ci_033                 4.328486e-03 3 1  ON 32
ci_034                 4.226513e-03 3 1  ON 33
ci_035                 2.738173e-03 3 1  ON 34
ci_036                 2.771650e-03 3 1  ON 35
ci_037                 4.703504e-03 3 1  ON 36
ci_038                 4.550696e-03 3 1  ON 37
ci_039                 4.574052e-03 3 1  ON 38
ci_040                 4.649428e-03 3 1  ON 39
ci_041                 3.713785e-03 3 1  ON 40
ci_042                 3.564623e-03 3 1  ON 41
ci_043                 3.873187e-03 3 1  ON 42
ci_044                 4.055491e-03 3 1  ON 43
ci_045                 3.215177e-03 3 1  ON 44
ci_046                 3.197680e-03 3 1  ON 45
ci_047                -1.608144e-03 3 1  ON 46
ci_048                -1.718791e-03 3 1  ON 47
ci_049                 1.400837e-03 3 1  ON 48
ci_050                 1.489110e-03 3 1  ON 49
ci_051                -2.174442e-03 3 1  ON 50
ci_052                -2.077302e-03 3 1  ON 51
ci_053                -2.235991e-03 3 1  ON 52
ci_054                -2.386396e-03 3 1  ON 53
ci_055                -1.128821e-03 3 1  ON 54
ci_056                -1.636923e-03 3 1  ON 55
ci_057                -1.221047e-03 3 1  ON 56
ci_058                -1.464301e-03 3 1  ON 57
ci_059                -8.265653e-04 3 1  ON 58
ci_060                -6.616197e-04 3 1  ON 59
ci_061                -9.768878e-04 3 1  ON 60
ci_062                -7.221053e-04 3 1  ON 61
ci_063                -6.059298e-04 3 1  ON 62
ci_064                -7.525558e-04 3 1  ON 63
ci_065                -1.915553e-03 3 1  ON 64
ci_066                -2.109749e-03 3 1  ON 65
ci_067                -1.464277e-03 3 1  ON 66
ci_068                -1.105423e-03 3 1  ON 67
ci_069                -1.827617e-05 3 1  ON 68
ci_070                 1.328133e-04 3 1  ON 69
ci_071                -1.880437e-03 3 1  ON 70
ci_072                -1.750283e-03 3 1  ON 71
ci_073                 5.040842e-04 3 1  ON 72
ci_074                 4.903804e-04 3 1  ON 73
ci_075                -1.868098e-04 3 1  ON 74
ci_076                -1.196404e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7455
    reference variance = 0.507001
====================================================
  Execution time = 4.9924e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9838e-01
  Total weights = 1.9551e+06
  Execution time = 7.2203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487231696428
                                         uncertainty =       0.002495237726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487231696428
                                         uncertainty =       0.002495237726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493601443
  error estimate for blocks of size 2^( 2) =       0.000512334761
  error estimate for blocks of size 2^( 3) =       0.000528902286
  error estimate for blocks of size 2^( 4) =       0.000540971952
  error estimate for blocks of size 2^( 5) =       0.000547637164
  error estimate for blocks of size 2^( 6) =       0.000549756437
  error estimate for blocks of size 2^( 7) =       0.000552822343

      target function =      -0.611157426014
              le_mean =     -22.668437240773
             les_mean =     514.356427439563
             stat err =       0.000547796974
             autocorr =       1.231647461774
   target nu stat err =       0.000547796974
   target dn stat err =       0.003163505597
      target stat err =       0.000997210576
              std dev =       0.698057855359
             le_variance =       0.487284769429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487231544432
                                         uncertainty =       0.002495239655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487231544432
                                         uncertainty =       0.002495239655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493601366
  error estimate for blocks of size 2^( 2) =       0.000512334685
  error estimate for blocks of size 2^( 3) =       0.000528902209
  error estimate for blocks of size 2^( 4) =       0.000540971871
  error estimate for blocks of size 2^( 5) =       0.000547637082
  error estimate for blocks of size 2^( 6) =       0.000549756353
  error estimate for blocks of size 2^( 7) =       0.000552822259

      target function =      -0.611157458778
              le_mean =     -22.668437242354
             les_mean =     514.356427404532
             stat err =       0.000547796891
             autocorr =       1.231647473605
   target nu stat err =       0.000547796891
   target dn stat err =       0.003163508051
      target stat err =       0.000997211385
              std dev =       0.698057746438
             le_variance =       0.487284617362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487231620428
                                         uncertainty =       0.002495238691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487231620428
                                         uncertainty =       0.002495238691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493601405
  error estimate for blocks of size 2^( 2) =       0.000512334723
  error estimate for blocks of size 2^( 3) =       0.000528902247
  error estimate for blocks of size 2^( 4) =       0.000540971911
  error estimate for blocks of size 2^( 5) =       0.000547637123
  error estimate for blocks of size 2^( 6) =       0.000549756395
  error estimate for blocks of size 2^( 7) =       0.000552822301

      target function =      -0.611157442404
              le_mean =     -22.668437241563
             les_mean =     514.356427422016
             stat err =       0.000547796933
             autocorr =       1.231647467688
   target nu stat err =       0.000547796933
   target dn stat err =       0.003163506824
      target stat err =       0.000997210981
              std dev =       0.698057800897
             le_variance =       0.487284693393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487231686928
                                         uncertainty =       0.002495237847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487231686928
                                         uncertainty =       0.002495237847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493601438
  error estimate for blocks of size 2^( 2) =       0.000512334756
  error estimate for blocks of size 2^( 3) =       0.000528902281
  error estimate for blocks of size 2^( 4) =       0.000540971947
  error estimate for blocks of size 2^( 5) =       0.000547637159
  error estimate for blocks of size 2^( 6) =       0.000549756432
  error estimate for blocks of size 2^( 7) =       0.000552822337

      target function =      -0.611157428063
              le_mean =     -22.668437240872
             les_mean =     514.356427437366
             stat err =       0.000547796969
             autocorr =       1.231647462509
   target nu stat err =       0.000547796969
   target dn stat err =       0.003163505750
      target stat err =       0.000997210627
              std dev =       0.698057848552
             le_variance =       0.487284759924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611157426014        initial
     1.4901e+03     1.4901e+04             2.3889e-07        -0.611157458778  <--
     5.9605e+03     5.9605e+04             5.9725e-08        -0.611157442404
     2.3842e+04     2.3842e+05             1.4931e-08        -0.611157428063

*****************************************************************************
Applying the update for shift_i =   1.4901e+03     and shift_s =   1.4901e+04
*****************************************************************************

  Execution time = 8.6123e+01
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_001                -7.044643e-01 3 1  ON 0
ci_002                -7.027613e-01 3 1  ON 1
ci_003                -5.364607e-02 3 1  ON 2
ci_004                -5.404830e-02 3 1  ON 3
ci_005                 2.331708e-02 3 1  ON 4
ci_006                 2.338880e-02 3 1  ON 5
ci_007                 1.859293e-02 3 1  ON 6
ci_008                 1.898565e-02 3 1  ON 7
ci_009                -1.495909e-02 3 1  ON 8
ci_010                -1.471233e-02 3 1  ON 9
ci_011                -1.253728e-02 3 1  ON 10
ci_012                -1.212464e-02 3 1  ON 11
ci_013                 1.121472e-02 3 1  ON 12
ci_014                 1.100127e-02 3 1  ON 13
ci_015                 1.261098e-02 3 1  ON 14
ci_016                 1.239964e-02 3 1  ON 15
ci_017                 1.050054e-02 3 1  ON 16
ci_018                 1.048107e-02 3 1  ON 17
ci_019                 3.270821e-03 3 1  ON 18
ci_020                 3.487661e-03 3 1  ON 19
ci_021                -8.069614e-03 3 1  ON 20
ci_022                -8.279517e-03 3 1  ON 21
ci_023                 6.237017e-03 3 1  ON 22
ci_024                 6.337802e-03 3 1  ON 23
ci_025                 9.040013e-03 3 1  ON 24
ci_026                 8.952381e-03 3 1  ON 25
ci_027                 6.585482e-03 3 1  ON 26
ci_028                 6.651348e-03 3 1  ON 27
ci_029                -5.191454e-03 3 1  ON 28
ci_030                -5.156017e-03 3 1  ON 29
ci_031                -1.764076e-03 3 1  ON 30
ci_032                -1.724485e-03 3 1  ON 31
ci_033                 4.328468e-03 3 1  ON 32
ci_034                 4.226499e-03 3 1  ON 33
ci_035                 2.738149e-03 3 1  ON 34
ci_036                 2.771639e-03 3 1  ON 35
ci_037                 4.703504e-03 3 1  ON 36
ci_038                 4.550675e-03 3 1  ON 37
ci_039                 4.574073e-03 3 1  ON 38
ci_040                 4.649437e-03 3 1  ON 39
ci_041                 3.713776e-03 3 1  ON 40
ci_042                 3.564626e-03 3 1  ON 41
ci_043                 3.873173e-03 3 1  ON 42
ci_044                 4.055490e-03 3 1  ON 43
ci_045                 3.215157e-03 3 1  ON 44
ci_046                 3.197667e-03 3 1  ON 45
ci_047                -1.608147e-03 3 1  ON 46
ci_048                -1.718765e-03 3 1  ON 47
ci_049                 1.400818e-03 3 1  ON 48
ci_050                 1.489065e-03 3 1  ON 49
ci_051                -2.174425e-03 3 1  ON 50
ci_052                -2.077293e-03 3 1  ON 51
ci_053                -2.235981e-03 3 1  ON 52
ci_054                -2.386398e-03 3 1  ON 53
ci_055                -1.128813e-03 3 1  ON 54
ci_056                -1.636924e-03 3 1  ON 55
ci_057                -1.221054e-03 3 1  ON 56
ci_058                -1.464287e-03 3 1  ON 57
ci_059                -8.265649e-04 3 1  ON 58
ci_060                -6.616044e-04 3 1  ON 59
ci_061                -9.768829e-04 3 1  ON 60
ci_062                -7.221068e-04 3 1  ON 61
ci_063                -6.059175e-04 3 1  ON 62
ci_064                -7.525735e-04 3 1  ON 63
ci_065                -1.915543e-03 3 1  ON 64
ci_066                -2.109756e-03 3 1  ON 65
ci_067                -1.464265e-03 3 1  ON 66
ci_068                -1.105424e-03 3 1  ON 67
ci_069                -1.828192e-05 3 1  ON 68
ci_070                 1.328258e-04 3 1  ON 69
ci_071                -1.880453e-03 3 1  ON 70
ci_072                -1.750298e-03 3 1  ON 71
ci_073                 5.040838e-04 3 1  ON 72
ci_074                 4.903644e-04 3 1  ON 73
ci_075                -1.867993e-04 3 1  ON 74
ci_076                -1.196470e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4660e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.6929
    reference variance = 0.394088
====================================================
  Execution time = 5.2141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0070e-01
  Total weights = 1.954999101e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487315180322
                                         uncertainty =       0.002668724553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487315180322
                                         uncertainty =       0.002668724553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493596974
  error estimate for blocks of size 2^( 2) =       0.000511969337
  error estimate for blocks of size 2^( 3) =       0.000528664788
  error estimate for blocks of size 2^( 4) =       0.000541116806
  error estimate for blocks of size 2^( 5) =       0.000548686144
  error estimate for blocks of size 2^( 6) =       0.000551775141
  error estimate for blocks of size 2^( 7) =       0.000553049909

      target function =      -0.610274339672
              le_mean =     -22.667718176468
             les_mean =     514.326149270182
             stat err =       0.000548657000
             autocorr =       1.235540176720
   target nu stat err =       0.000548657000
   target dn stat err =       0.003523560937
      target stat err =       0.001099052652
              std dev =       0.698051534569
             le_variance =       0.487275944914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266771817647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610276023206       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610276112797       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610276123429       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610276124362       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610276124934       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610276125106       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610276125226       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610276125230       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610276125231       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610276125212       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+02 is 8.220716e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610276023206       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610276045606       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610276048264       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610276048497       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610276048638       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610276048683       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610276048716       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610276048714       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610276048716       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610276048710       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+03 is 2.055347e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610276023206       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610276028806       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610276029471       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610276029529       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610276029565       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610276029574       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610276029596       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610276029581       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610276029572       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610276029571       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+03 is 5.138472e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.835296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1568e+01
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027614e-01 3 1  ON 1
ci_003                -5.364591e-02 3 1  ON 2
ci_004                -5.404820e-02 3 1  ON 3
ci_005                 2.331689e-02 3 1  ON 4
ci_006                 2.338859e-02 3 1  ON 5
ci_007                 1.859278e-02 3 1  ON 6
ci_008                 1.898549e-02 3 1  ON 7
ci_009                -1.495898e-02 3 1  ON 8
ci_010                -1.471217e-02 3 1  ON 9
ci_011                -1.253717e-02 3 1  ON 10
ci_012                -1.212453e-02 3 1  ON 11
ci_013                 1.121461e-02 3 1  ON 12
ci_014                 1.100118e-02 3 1  ON 13
ci_015                 1.261089e-02 3 1  ON 14
ci_016                 1.239955e-02 3 1  ON 15
ci_017                 1.050051e-02 3 1  ON 16
ci_018                 1.048101e-02 3 1  ON 17
ci_019                 3.270732e-03 3 1  ON 18
ci_020                 3.487573e-03 3 1  ON 19
ci_021                -8.069626e-03 3 1  ON 20
ci_022                -8.279483e-03 3 1  ON 21
ci_023                 6.237005e-03 3 1  ON 22
ci_024                 6.337738e-03 3 1  ON 23
ci_025                 9.039992e-03 3 1  ON 24
ci_026                 8.952383e-03 3 1  ON 25
ci_027                 6.585474e-03 3 1  ON 26
ci_028                 6.651339e-03 3 1  ON 27
ci_029                -5.191433e-03 3 1  ON 28
ci_030                -5.155965e-03 3 1  ON 29
ci_031                -1.763967e-03 3 1  ON 30
ci_032                -1.724373e-03 3 1  ON 31
ci_033                 4.328429e-03 3 1  ON 32
ci_034                 4.226485e-03 3 1  ON 33
ci_035                 2.738134e-03 3 1  ON 34
ci_036                 2.771649e-03 3 1  ON 35
ci_037                 4.703521e-03 3 1  ON 36
ci_038                 4.550612e-03 3 1  ON 37
ci_039                 4.574107e-03 3 1  ON 38
ci_040                 4.649424e-03 3 1  ON 39
ci_041                 3.713779e-03 3 1  ON 40
ci_042                 3.564607e-03 3 1  ON 41
ci_043                 3.873143e-03 3 1  ON 42
ci_044                 4.055511e-03 3 1  ON 43
ci_045                 3.215133e-03 3 1  ON 44
ci_046                 3.197667e-03 3 1  ON 45
ci_047                -1.608082e-03 3 1  ON 46
ci_048                -1.718761e-03 3 1  ON 47
ci_049                 1.400782e-03 3 1  ON 48
ci_050                 1.489062e-03 3 1  ON 49
ci_051                -2.174429e-03 3 1  ON 50
ci_052                -2.077288e-03 3 1  ON 51
ci_053                -2.235968e-03 3 1  ON 52
ci_054                -2.386382e-03 3 1  ON 53
ci_055                -1.128837e-03 3 1  ON 54
ci_056                -1.636929e-03 3 1  ON 55
ci_057                -1.221058e-03 3 1  ON 56
ci_058                -1.464260e-03 3 1  ON 57
ci_059                -8.265610e-04 3 1  ON 58
ci_060                -6.615610e-04 3 1  ON 59
ci_061                -9.768567e-04 3 1  ON 60
ci_062                -7.220634e-04 3 1  ON 61
ci_063                -6.059381e-04 3 1  ON 62
ci_064                -7.525434e-04 3 1  ON 63
ci_065                -1.915539e-03 3 1  ON 64
ci_066                -2.109761e-03 3 1  ON 65
ci_067                -1.464264e-03 3 1  ON 66
ci_068                -1.105430e-03 3 1  ON 67
ci_069                -1.827869e-05 3 1  ON 68
ci_070                 1.328374e-04 3 1  ON 69
ci_071                -1.880472e-03 3 1  ON 70
ci_072                -1.750307e-03 3 1  ON 71
ci_073                 5.040714e-04 3 1  ON 72
ci_074                 4.903793e-04 3 1  ON 73
ci_075                -1.867784e-04 3 1  ON 74
ci_076                -1.196552e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.7069
    reference variance = 0.591285
====================================================
  Execution time = 4.9887e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9972e-01
  Total weights = 1.9552e+06
  Execution time = 7.2224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487327898627
                                         uncertainty =       0.002945482146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487327898627
                                         uncertainty =       0.002945482146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493648278
  error estimate for blocks of size 2^( 2) =       0.000511783307
  error estimate for blocks of size 2^( 3) =       0.000528589677
  error estimate for blocks of size 2^( 4) =       0.000540423721
  error estimate for blocks of size 2^( 5) =       0.000548187120
  error estimate for blocks of size 2^( 6) =       0.000551081747
  error estimate for blocks of size 2^( 7) =       0.000554413368

      target function =      -0.610953065884
              le_mean =     -22.669244784107
             les_mean =     514.394376216654
             stat err =       0.000548526489
             autocorr =       1.234695760719
   target nu stat err =       0.000548526489
   target dn stat err =       0.004301807684
      target stat err =       0.001332770162
              std dev =       0.698124089856
             le_variance =       0.487377244838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487327195484
                                         uncertainty =       0.002945434763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487327195484
                                         uncertainty =       0.002945434763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493647922
  error estimate for blocks of size 2^( 2) =       0.000511782956
  error estimate for blocks of size 2^( 3) =       0.000528589327
  error estimate for blocks of size 2^( 4) =       0.000540423361
  error estimate for blocks of size 2^( 5) =       0.000548186744
  error estimate for blocks of size 2^( 6) =       0.000551081384
  error estimate for blocks of size 2^( 7) =       0.000554413011

      target function =      -0.610954195865
              le_mean =     -22.669244768883
             les_mean =     514.394371788401
             stat err =       0.000548526125
             autocorr =       1.234695906071
   target nu stat err =       0.000548526125
   target dn stat err =       0.004301709158
      target stat err =       0.001332745685
              std dev =       0.698123585846
             le_variance =       0.487376541114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487327547014
                                         uncertainty =       0.002945458453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487327547014
                                         uncertainty =       0.002945458453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493648100
  error estimate for blocks of size 2^( 2) =       0.000511783132
  error estimate for blocks of size 2^( 3) =       0.000528589502
  error estimate for blocks of size 2^( 4) =       0.000540423541
  error estimate for blocks of size 2^( 5) =       0.000548186932
  error estimate for blocks of size 2^( 6) =       0.000551081566
  error estimate for blocks of size 2^( 7) =       0.000554413189

      target function =      -0.610953640614
              le_mean =     -22.669244776494
             les_mean =     514.394373970359
             stat err =       0.000548526307
             autocorr =       1.234695833412
   target nu stat err =       0.000548526307
   target dn stat err =       0.004301758002
      target stat err =       0.001332757841
              std dev =       0.698123837822
             le_variance =       0.487376892935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487327854673
                                         uncertainty =       0.002945479184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487327854673
                                         uncertainty =       0.002945479184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493648256
  error estimate for blocks of size 2^( 2) =       0.000511783285
  error estimate for blocks of size 2^( 3) =       0.000528589656
  error estimate for blocks of size 2^( 4) =       0.000540423698
  error estimate for blocks of size 2^( 5) =       0.000548187097
  error estimate for blocks of size 2^( 6) =       0.000551081724
  error estimate for blocks of size 2^( 7) =       0.000554413345

      target function =      -0.610953138800
              le_mean =     -22.669244783156
             les_mean =     514.394375932321
             stat err =       0.000548526466
             autocorr =       1.234695769813
   target nu stat err =       0.000548526466
   target dn stat err =       0.004301801426
      target stat err =       0.001332768612
              std dev =       0.698124058350
             le_variance =       0.487377200848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610953065884        initial
     3.7253e+02     3.7253e+03             8.2207e-07        -0.610954195865  <--
     1.4901e+03     1.4901e+04             2.0553e-07        -0.610953640614
     5.9605e+03     5.9605e+04             5.1385e-08        -0.610953138800

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 8.6183e+01
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_001                -7.044641e-01 3 1  ON 0
ci_002                -7.027617e-01 3 1  ON 1
ci_003                -5.364546e-02 3 1  ON 2
ci_004                -5.404790e-02 3 1  ON 3
ci_005                 2.331633e-02 3 1  ON 4
ci_006                 2.338797e-02 3 1  ON 5
ci_007                 1.859231e-02 3 1  ON 6
ci_008                 1.898501e-02 3 1  ON 7
ci_009                -1.495866e-02 3 1  ON 8
ci_010                -1.471172e-02 3 1  ON 9
ci_011                -1.253683e-02 3 1  ON 10
ci_012                -1.212418e-02 3 1  ON 11
ci_013                 1.121428e-02 3 1  ON 12
ci_014                 1.100091e-02 3 1  ON 13
ci_015                 1.261060e-02 3 1  ON 14
ci_016                 1.239927e-02 3 1  ON 15
ci_017                 1.050041e-02 3 1  ON 16
ci_018                 1.048083e-02 3 1  ON 17
ci_019                 3.270465e-03 3 1  ON 18
ci_020                 3.487311e-03 3 1  ON 19
ci_021                -8.069664e-03 3 1  ON 20
ci_022                -8.279381e-03 3 1  ON 21
ci_023                 6.236968e-03 3 1  ON 22
ci_024                 6.337545e-03 3 1  ON 23
ci_025                 9.039930e-03 3 1  ON 24
ci_026                 8.952389e-03 3 1  ON 25
ci_027                 6.585453e-03 3 1  ON 26
ci_028                 6.651310e-03 3 1  ON 27
ci_029                -5.191371e-03 3 1  ON 28
ci_030                -5.155810e-03 3 1  ON 29
ci_031                -1.763640e-03 3 1  ON 30
ci_032                -1.724038e-03 3 1  ON 31
ci_033                 4.328313e-03 3 1  ON 32
ci_034                 4.226444e-03 3 1  ON 33
ci_035                 2.738089e-03 3 1  ON 34
ci_036                 2.771678e-03 3 1  ON 35
ci_037                 4.703570e-03 3 1  ON 36
ci_038                 4.550423e-03 3 1  ON 37
ci_039                 4.574208e-03 3 1  ON 38
ci_040                 4.649383e-03 3 1  ON 39
ci_041                 3.713787e-03 3 1  ON 40
ci_042                 3.564549e-03 3 1  ON 41
ci_043                 3.873054e-03 3 1  ON 42
ci_044                 4.055575e-03 3 1  ON 43
ci_045                 3.215059e-03 3 1  ON 44
ci_046                 3.197668e-03 3 1  ON 45
ci_047                -1.607888e-03 3 1  ON 46
ci_048                -1.718750e-03 3 1  ON 47
ci_049                 1.400675e-03 3 1  ON 48
ci_050                 1.489055e-03 3 1  ON 49
ci_051                -2.174442e-03 3 1  ON 50
ci_052                -2.077273e-03 3 1  ON 51
ci_053                -2.235930e-03 3 1  ON 52
ci_054                -2.386332e-03 3 1  ON 53
ci_055                -1.128908e-03 3 1  ON 54
ci_056                -1.636947e-03 3 1  ON 55
ci_057                -1.221069e-03 3 1  ON 56
ci_058                -1.464178e-03 3 1  ON 57
ci_059                -8.265493e-04 3 1  ON 58
ci_060                -6.614310e-04 3 1  ON 59
ci_061                -9.767782e-04 3 1  ON 60
ci_062                -7.219333e-04 3 1  ON 61
ci_063                -6.059999e-04 3 1  ON 62
ci_064                -7.524532e-04 3 1  ON 63
ci_065                -1.915529e-03 3 1  ON 64
ci_066                -2.109776e-03 3 1  ON 65
ci_067                -1.464261e-03 3 1  ON 66
ci_068                -1.105451e-03 3 1  ON 67
ci_069                -1.826900e-05 3 1  ON 68
ci_070                 1.328723e-04 3 1  ON 69
ci_071                -1.880529e-03 3 1  ON 70
ci_072                -1.750334e-03 3 1  ON 71
ci_073                 5.040343e-04 3 1  ON 72
ci_074                 4.904240e-04 3 1  ON 73
ci_075                -1.867159e-04 3 1  ON 74
ci_076                -1.196801e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4776e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.7234
    reference variance = 0.505105
====================================================
  Execution time = 5.1214e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0487e-01
  Total weights = 1.955166588e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487797854521
                                         uncertainty =       0.002422272080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487797854521
                                         uncertainty =       0.002422272080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493888903
  error estimate for blocks of size 2^( 2) =       0.000512591724
  error estimate for blocks of size 2^( 3) =       0.000529080906
  error estimate for blocks of size 2^( 4) =       0.000540863432
  error estimate for blocks of size 2^( 5) =       0.000547082503
  error estimate for blocks of size 2^( 6) =       0.000550838726
  error estimate for blocks of size 2^( 7) =       0.000554135063

      target function =      -0.609044468732
              le_mean =     -22.667841990039
             les_mean =     514.335930004108
             stat err =       0.000548229931
             autocorr =       1.232159554548
   target nu stat err =       0.000548229931
   target dn stat err =       0.006028859510
      target stat err =       0.001835092585
              std dev =       0.698464384460
             le_variance =       0.487852496360


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266784199004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609049690648       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609050060494       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609050102490       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609050107588       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609050110467       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609050111642       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609050112017       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609050111918       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609050111891       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609050111858       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+01 is 3.655514e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609049690648       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609049783138       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609049793639       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609049794913       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609049795633       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609049795927       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609049796020       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609049795996       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609049795989       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609049795980       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+02 is 9.141702e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609049690648       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609049713773       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609049716398       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609049716717       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609049716896       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609049716969       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609049716992       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609049716986       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609049716987       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609049716982       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+03 is 2.285608e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.840369 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0594e+01
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_001                -7.044639e-01 3 1  ON 0
ci_002                -7.027621e-01 3 1  ON 1
ci_003                -5.364496e-02 3 1  ON 2
ci_004                -5.404699e-02 3 1  ON 3
ci_005                 2.331541e-02 3 1  ON 4
ci_006                 2.338719e-02 3 1  ON 5
ci_007                 1.859180e-02 3 1  ON 6
ci_008                 1.898448e-02 3 1  ON 7
ci_009                -1.495834e-02 3 1  ON 8
ci_010                -1.471126e-02 3 1  ON 9
ci_011                -1.253633e-02 3 1  ON 10
ci_012                -1.212363e-02 3 1  ON 11
ci_013                 1.121385e-02 3 1  ON 12
ci_014                 1.100046e-02 3 1  ON 13
ci_015                 1.261030e-02 3 1  ON 14
ci_016                 1.239898e-02 3 1  ON 15
ci_017                 1.050006e-02 3 1  ON 16
ci_018                 1.048057e-02 3 1  ON 17
ci_019                 3.270073e-03 3 1  ON 18
ci_020                 3.486992e-03 3 1  ON 19
ci_021                -8.069421e-03 3 1  ON 20
ci_022                -8.279564e-03 3 1  ON 21
ci_023                 6.236781e-03 3 1  ON 22
ci_024                 6.337490e-03 3 1  ON 23
ci_025                 9.039804e-03 3 1  ON 24
ci_026                 8.952477e-03 3 1  ON 25
ci_027                 6.585489e-03 3 1  ON 26
ci_028                 6.651371e-03 3 1  ON 27
ci_029                -5.191186e-03 3 1  ON 28
ci_030                -5.155613e-03 3 1  ON 29
ci_031                -1.763388e-03 3 1  ON 30
ci_032                -1.723640e-03 3 1  ON 31
ci_033                 4.328160e-03 3 1  ON 32
ci_034                 4.226357e-03 3 1  ON 33
ci_035                 2.737961e-03 3 1  ON 34
ci_036                 2.771569e-03 3 1  ON 35
ci_037                 4.703291e-03 3 1  ON 36
ci_038                 4.550275e-03 3 1  ON 37
ci_039                 4.574257e-03 3 1  ON 38
ci_040                 4.649374e-03 3 1  ON 39
ci_041                 3.713650e-03 3 1  ON 40
ci_042                 3.564643e-03 3 1  ON 41
ci_043                 3.872944e-03 3 1  ON 42
ci_044                 4.055598e-03 3 1  ON 43
ci_045                 3.214897e-03 3 1  ON 44
ci_046                 3.197587e-03 3 1  ON 45
ci_047                -1.607819e-03 3 1  ON 46
ci_048                -1.718651e-03 3 1  ON 47
ci_049                 1.400579e-03 3 1  ON 48
ci_050                 1.488958e-03 3 1  ON 49
ci_051                -2.174497e-03 3 1  ON 50
ci_052                -2.077253e-03 3 1  ON 51
ci_053                -2.236015e-03 3 1  ON 52
ci_054                -2.386258e-03 3 1  ON 53
ci_055                -1.128959e-03 3 1  ON 54
ci_056                -1.636701e-03 3 1  ON 55
ci_057                -1.221130e-03 3 1  ON 56
ci_058                -1.464216e-03 3 1  ON 57
ci_059                -8.264866e-04 3 1  ON 58
ci_060                -6.614858e-04 3 1  ON 59
ci_061                -9.768376e-04 3 1  ON 60
ci_062                -7.219308e-04 3 1  ON 61
ci_063                -6.059478e-04 3 1  ON 62
ci_064                -7.525147e-04 3 1  ON 63
ci_065                -1.915495e-03 3 1  ON 64
ci_066                -2.109896e-03 3 1  ON 65
ci_067                -1.464229e-03 3 1  ON 66
ci_068                -1.105534e-03 3 1  ON 67
ci_069                -1.827900e-05 3 1  ON 68
ci_070                 1.327907e-04 3 1  ON 69
ci_071                -1.880599e-03 3 1  ON 70
ci_072                -1.750348e-03 3 1  ON 71
ci_073                 5.039384e-04 3 1  ON 72
ci_074                 4.904456e-04 3 1  ON 73
ci_075                -1.866605e-04 3 1  ON 74
ci_076                -1.195295e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.6559
    reference variance = 0.312122
====================================================
  Execution time = 4.9792e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9484e-01
  Total weights = 1.9550e+06
  Execution time = 7.2215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484637578749
                                         uncertainty =       0.002543520714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484637578749
                                         uncertainty =       0.002543520714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492186606
  error estimate for blocks of size 2^( 2) =       0.000510699690
  error estimate for blocks of size 2^( 3) =       0.000526745947
  error estimate for blocks of size 2^( 4) =       0.000538786433
  error estimate for blocks of size 2^( 5) =       0.000547030451
  error estimate for blocks of size 2^( 6) =       0.000548878160
  error estimate for blocks of size 2^( 7) =       0.000552139029

      target function =      -0.612219059157
              le_mean =     -22.668386833913
             les_mean =     514.350606833273
             stat err =       0.000546708518
             autocorr =       1.233820831188
   target nu stat err =       0.000546708518
   target dn stat err =       0.002884937823
      target stat err =       0.000919061938
              std dev =       0.696056974098
             le_variance =       0.484495311191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484635174871
                                         uncertainty =       0.002543476321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484635174871
                                         uncertainty =       0.002543476321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492185385
  error estimate for blocks of size 2^( 2) =       0.000510698479
  error estimate for blocks of size 2^( 3) =       0.000526744713
  error estimate for blocks of size 2^( 4) =       0.000538785165
  error estimate for blocks of size 2^( 5) =       0.000547029195
  error estimate for blocks of size 2^( 6) =       0.000548876834
  error estimate for blocks of size 2^( 7) =       0.000552137686

      target function =      -0.612220026198
              le_mean =     -22.668386826244
             les_mean =     514.350603301333
             stat err =       0.000546707220
             autocorr =       1.233821096354
   target nu stat err =       0.000546707220
   target dn stat err =       0.002885029289
      target stat err =       0.000919091109
              std dev =       0.696055246768
             le_variance =       0.484492906553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484636376234
                                         uncertainty =       0.002543498510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484636376234
                                         uncertainty =       0.002543498510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492185995
  error estimate for blocks of size 2^( 2) =       0.000510699085
  error estimate for blocks of size 2^( 3) =       0.000526745330
  error estimate for blocks of size 2^( 4) =       0.000538785799
  error estimate for blocks of size 2^( 5) =       0.000547029823
  error estimate for blocks of size 2^( 6) =       0.000548877496
  error estimate for blocks of size 2^( 7) =       0.000552138357

      target function =      -0.612219555780
              le_mean =     -22.668386830047
             les_mean =     514.350605022784
             stat err =       0.000546707869
             autocorr =       1.233820963784
   target nu stat err =       0.000546707869
   target dn stat err =       0.002884983240
      target stat err =       0.000919076469
              std dev =       0.696056110019
             le_variance =       0.484494108295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484637428399
                                         uncertainty =       0.002543517938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484637428399
                                         uncertainty =       0.002543517938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492186530
  error estimate for blocks of size 2^( 2) =       0.000510699615
  error estimate for blocks of size 2^( 3) =       0.000526745870
  error estimate for blocks of size 2^( 4) =       0.000538786354
  error estimate for blocks of size 2^( 5) =       0.000547030372
  error estimate for blocks of size 2^( 6) =       0.000548878077
  error estimate for blocks of size 2^( 7) =       0.000552138945

      target function =      -0.612219122758
              le_mean =     -22.668386833426
             les_mean =     514.350606601802
             stat err =       0.000546708437
             autocorr =       1.233820847759
   target nu stat err =       0.000546708437
   target dn stat err =       0.002884943462
      target stat err =       0.000919063748
              std dev =       0.696056866062
             le_variance =       0.484495160792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.612219059157        initial
     9.3132e+01     9.3132e+02             3.6555e-06        -0.612220026198  <--
     3.7253e+02     3.7253e+03             9.1417e-07        -0.612219555780
     1.4901e+03     1.4901e+04             2.2856e-07        -0.612219122758

*****************************************************************************
Applying the update for shift_i =   9.3132e+01     and shift_s =   9.3132e+02
*****************************************************************************

  Execution time = 8.6015e+01
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_001                -7.044634e-01 3 1  ON 0
ci_002                -7.027635e-01 3 1  ON 1
ci_003                -5.364345e-02 3 1  ON 2
ci_004                -5.404426e-02 3 1  ON 3
ci_005                 2.331267e-02 3 1  ON 4
ci_006                 2.338484e-02 3 1  ON 5
ci_007                 1.859025e-02 3 1  ON 6
ci_008                 1.898289e-02 3 1  ON 7
ci_009                -1.495736e-02 3 1  ON 8
ci_010                -1.470988e-02 3 1  ON 9
ci_011                -1.253484e-02 3 1  ON 10
ci_012                -1.212197e-02 3 1  ON 11
ci_013                 1.121254e-02 3 1  ON 12
ci_014                 1.099909e-02 3 1  ON 13
ci_015                 1.260939e-02 3 1  ON 14
ci_016                 1.239812e-02 3 1  ON 15
ci_017                 1.049902e-02 3 1  ON 16
ci_018                 1.047980e-02 3 1  ON 17
ci_019                 3.268897e-03 3 1  ON 18
ci_020                 3.486037e-03 3 1  ON 19
ci_021                -8.068695e-03 3 1  ON 20
ci_022                -8.280114e-03 3 1  ON 21
ci_023                 6.236222e-03 3 1  ON 22
ci_024                 6.337325e-03 3 1  ON 23
ci_025                 9.039426e-03 3 1  ON 24
ci_026                 8.952740e-03 3 1  ON 25
ci_027                 6.585599e-03 3 1  ON 26
ci_028                 6.651553e-03 3 1  ON 27
ci_029                -5.190631e-03 3 1  ON 28
ci_030                -5.155024e-03 3 1  ON 29
ci_031                -1.762629e-03 3 1  ON 30
ci_032                -1.722443e-03 3 1  ON 31
ci_033                 4.327700e-03 3 1  ON 32
ci_034                 4.226097e-03 3 1  ON 33
ci_035                 2.737577e-03 3 1  ON 34
ci_036                 2.771240e-03 3 1  ON 35
ci_037                 4.702455e-03 3 1  ON 36
ci_038                 4.549834e-03 3 1  ON 37
ci_039                 4.574402e-03 3 1  ON 38
ci_040                 4.649346e-03 3 1  ON 39
ci_041                 3.713237e-03 3 1  ON 40
ci_042                 3.564925e-03 3 1  ON 41
ci_043                 3.872614e-03 3 1  ON 42
ci_044                 4.055668e-03 3 1  ON 43
ci_045                 3.214413e-03 3 1  ON 44
ci_046                 3.197341e-03 3 1  ON 45
ci_047                -1.607613e-03 3 1  ON 46
ci_048                -1.718356e-03 3 1  ON 47
ci_049                 1.400288e-03 3 1  ON 48
ci_050                 1.488668e-03 3 1  ON 49
ci_051                -2.174662e-03 3 1  ON 50
ci_052                -2.077194e-03 3 1  ON 51
ci_053                -2.236271e-03 3 1  ON 52
ci_054                -2.386034e-03 3 1  ON 53
ci_055                -1.129112e-03 3 1  ON 54
ci_056                -1.635963e-03 3 1  ON 55
ci_057                -1.221315e-03 3 1  ON 56
ci_058                -1.464329e-03 3 1  ON 57
ci_059                -8.262985e-04 3 1  ON 58
ci_060                -6.616500e-04 3 1  ON 59
ci_061                -9.770156e-04 3 1  ON 60
ci_062                -7.219233e-04 3 1  ON 61
ci_063                -6.057914e-04 3 1  ON 62
ci_064                -7.526992e-04 3 1  ON 63
ci_065                -1.915393e-03 3 1  ON 64
ci_066                -2.110257e-03 3 1  ON 65
ci_067                -1.464132e-03 3 1  ON 66
ci_068                -1.105782e-03 3 1  ON 67
ci_069                -1.830897e-05 3 1  ON 68
ci_070                 1.325458e-04 3 1  ON 69
ci_071                -1.880808e-03 3 1  ON 70
ci_072                -1.750389e-03 3 1  ON 71
ci_073                 5.036506e-04 3 1  ON 72
ci_074                 4.905102e-04 3 1  ON 73
ci_075                -1.864945e-04 3 1  ON 74
ci_076                -1.190778e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4662e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6636
    reference variance = 0.380861
====================================================
  Execution time = 5.1503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0139e-01
  Total weights = 1.954833122e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487906724286
                                         uncertainty =       0.003150093981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487906724286
                                         uncertainty =       0.003150093981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493897308
  error estimate for blocks of size 2^( 2) =       0.000512353644
  error estimate for blocks of size 2^( 3) =       0.000528776216
  error estimate for blocks of size 2^( 4) =       0.000540853265
  error estimate for blocks of size 2^( 5) =       0.000547713298
  error estimate for blocks of size 2^( 6) =       0.000550641707
  error estimate for blocks of size 2^( 7) =       0.000550177280

      target function =      -0.610003554769
              le_mean =     -22.667464330560
             les_mean =     514.315325950228
             stat err =       0.000547346388
             autocorr =       1.228149384216
   target nu stat err =       0.000547346388
   target dn stat err =       0.004069591593
      target stat err =       0.001258129547
              std dev =       0.698476270817
             le_variance =       0.487869100894


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266746433056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610005832000       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610007277235       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610007464870       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610007479572       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610007484982       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610007486258       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610007486511       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610007486367       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610007486429       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610007486448       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+01 is 1.399887e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610005832000       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610006193760       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610006240700       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610006244376       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610006245727       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610006246045       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610006246109       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610006246073       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610006246088       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610006246093       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+01 is 3.504239e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610005832000       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610005922468       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610005934205       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610005935124       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610005935462       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610005935541       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610005935557       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610005935548       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610005935552       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610005935552       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+02 is 8.763428e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.845617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0933e+01
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_001                -7.044644e-01 3 1  ON 0
ci_002                -7.027635e-01 3 1  ON 1
ci_003                -5.364172e-02 3 1  ON 2
ci_004                -5.404197e-02 3 1  ON 3
ci_005                 2.330917e-02 3 1  ON 4
ci_006                 2.338180e-02 3 1  ON 5
ci_007                 1.858801e-02 3 1  ON 6
ci_008                 1.898071e-02 3 1  ON 7
ci_009                -1.495571e-02 3 1  ON 8
ci_010                -1.470816e-02 3 1  ON 9
ci_011                -1.253280e-02 3 1  ON 10
ci_012                -1.212018e-02 3 1  ON 11
ci_013                 1.121145e-02 3 1  ON 12
ci_014                 1.099732e-02 3 1  ON 13
ci_015                 1.260782e-02 3 1  ON 14
ci_016                 1.239682e-02 3 1  ON 15
ci_017                 1.049745e-02 3 1  ON 16
ci_018                 1.047842e-02 3 1  ON 17
ci_019                 3.267462e-03 3 1  ON 18
ci_020                 3.485254e-03 3 1  ON 19
ci_021                -8.067625e-03 3 1  ON 20
ci_022                -8.279886e-03 3 1  ON 21
ci_023                 6.236072e-03 3 1  ON 22
ci_024                 6.336706e-03 3 1  ON 23
ci_025                 9.039463e-03 3 1  ON 24
ci_026                 8.952913e-03 3 1  ON 25
ci_027                 6.585403e-03 3 1  ON 26
ci_028                 6.651495e-03 3 1  ON 27
ci_029                -5.190262e-03 3 1  ON 28
ci_030                -5.154548e-03 3 1  ON 29
ci_031                -1.761595e-03 3 1  ON 30
ci_032                -1.720968e-03 3 1  ON 31
ci_033                 4.327003e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.737015e-03 3 1  ON 34
ci_036                 2.770325e-03 3 1  ON 35
ci_037                 4.702481e-03 3 1  ON 36
ci_038                 4.550047e-03 3 1  ON 37
ci_039                 4.574054e-03 3 1  ON 38
ci_040                 4.649306e-03 3 1  ON 39
ci_041                 3.712732e-03 3 1  ON 40
ci_042                 3.564691e-03 3 1  ON 41
ci_043                 3.872175e-03 3 1  ON 42
ci_044                 4.055020e-03 3 1  ON 43
ci_045                 3.214216e-03 3 1  ON 44
ci_046                 3.196573e-03 3 1  ON 45
ci_047                -1.606964e-03 3 1  ON 46
ci_048                -1.717451e-03 3 1  ON 47
ci_049                 1.399933e-03 3 1  ON 48
ci_050                 1.489058e-03 3 1  ON 49
ci_051                -2.174367e-03 3 1  ON 50
ci_052                -2.076490e-03 3 1  ON 51
ci_053                -2.236155e-03 3 1  ON 52
ci_054                -2.386428e-03 3 1  ON 53
ci_055                -1.129333e-03 3 1  ON 54
ci_056                -1.635571e-03 3 1  ON 55
ci_057                -1.221142e-03 3 1  ON 56
ci_058                -1.464344e-03 3 1  ON 57
ci_059                -8.260655e-04 3 1  ON 58
ci_060                -6.610719e-04 3 1  ON 59
ci_061                -9.773865e-04 3 1  ON 60
ci_062                -7.215028e-04 3 1  ON 61
ci_063                -6.057528e-04 3 1  ON 62
ci_064                -7.525852e-04 3 1  ON 63
ci_065                -1.915142e-03 3 1  ON 64
ci_066                -2.110048e-03 3 1  ON 65
ci_067                -1.464253e-03 3 1  ON 66
ci_068                -1.105919e-03 3 1  ON 67
ci_069                -1.797695e-05 3 1  ON 68
ci_070                 1.325670e-04 3 1  ON 69
ci_071                -1.881200e-03 3 1  ON 70
ci_072                -1.750054e-03 3 1  ON 71
ci_073                 5.033608e-04 3 1  ON 72
ci_074                 4.901312e-04 3 1  ON 73
ci_075                -1.860578e-04 3 1  ON 74
ci_076                -1.191684e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6308
    reference variance = 0.510008
====================================================
  Execution time = 4.9742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0050e-01
  Total weights = 1.9549e+06
  Execution time = 7.2135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487153464519
                                         uncertainty =       0.002460541790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487153464519
                                         uncertainty =       0.002460541790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493494008
  error estimate for blocks of size 2^( 2) =       0.000511728634
  error estimate for blocks of size 2^( 3) =       0.000528961592
  error estimate for blocks of size 2^( 4) =       0.000540635507
  error estimate for blocks of size 2^( 5) =       0.000547012844
  error estimate for blocks of size 2^( 6) =       0.000552426765
  error estimate for blocks of size 2^( 7) =       0.000553532141

      target function =      -0.610638999458
              le_mean =     -22.668936163317
             les_mean =     514.381166029143
             stat err =       0.000548401814
             autocorr =       1.234906279067
   target nu stat err =       0.000548401814
   target dn stat err =       0.004213192908
      target stat err =       0.001304819321
              std dev =       0.697905918449
             le_variance =       0.487072671006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487145167183
                                         uncertainty =       0.002460551743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487145167183
                                         uncertainty =       0.002460551743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493489802
  error estimate for blocks of size 2^( 2) =       0.000511724539
  error estimate for blocks of size 2^( 3) =       0.000528957523
  error estimate for blocks of size 2^( 4) =       0.000540631624
  error estimate for blocks of size 2^( 5) =       0.000547009063
  error estimate for blocks of size 2^( 6) =       0.000552422949
  error estimate for blocks of size 2^( 7) =       0.000553528653

      target function =      -0.610633176612
              le_mean =     -22.668936014998
             les_mean =     514.381178356889
             stat err =       0.000548398072
             autocorr =       1.234910473677
   target nu stat err =       0.000548398072
   target dn stat err =       0.004225268729
      target stat err =       0.001308371940
              std dev =       0.697899971162
             le_variance =       0.487064369748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487149306397
                                         uncertainty =       0.002460546449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487149306397
                                         uncertainty =       0.002460546449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493491900
  error estimate for blocks of size 2^( 2) =       0.000511726582
  error estimate for blocks of size 2^( 3) =       0.000528959552
  error estimate for blocks of size 2^( 4) =       0.000540633560
  error estimate for blocks of size 2^( 5) =       0.000547010949
  error estimate for blocks of size 2^( 6) =       0.000552424853
  error estimate for blocks of size 2^( 7) =       0.000553530393

      target function =      -0.610636222051
              le_mean =     -22.668936088620
             les_mean =     514.381171725766
             stat err =       0.000548399939
             autocorr =       1.234908379657
   target nu stat err =       0.000548399939
   target dn stat err =       0.004219216373
      target stat err =       0.001306591873
              std dev =       0.697902938039
             le_variance =       0.487068510924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487152944071
                                         uncertainty =       0.002460542335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487152944071
                                         uncertainty =       0.002460542335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493493744
  error estimate for blocks of size 2^( 2) =       0.000511728377
  error estimate for blocks of size 2^( 3) =       0.000528961337
  error estimate for blocks of size 2^( 4) =       0.000540635263
  error estimate for blocks of size 2^( 5) =       0.000547012607
  error estimate for blocks of size 2^( 6) =       0.000552426526
  error estimate for blocks of size 2^( 7) =       0.000553531922

      target function =      -0.610638665497
              le_mean =     -22.668936153927
             les_mean =     514.381166695152
             stat err =       0.000548401579
             autocorr =       1.234906541756
   target nu stat err =       0.000548401579
   target dn stat err =       0.004213943545
      target stat err =       0.001305040261
              std dev =       0.697905545409
             le_variance =       0.487072150313


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610638999458        initial  <--
     2.3283e+01     2.3283e+02             1.3999e-05        -0.610633176612
     9.3132e+01     9.3132e+02             3.5042e-06        -0.610636222051
     3.7253e+02     3.7253e+03             8.7634e-07        -0.610638665497

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 85.8951
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_001                -7.044634e-01 3 1  ON 0
ci_002                -7.027635e-01 3 1  ON 1
ci_003                -5.364345e-02 3 1  ON 2
ci_004                -5.404426e-02 3 1  ON 3
ci_005                 2.331267e-02 3 1  ON 4
ci_006                 2.338484e-02 3 1  ON 5
ci_007                 1.859025e-02 3 1  ON 6
ci_008                 1.898289e-02 3 1  ON 7
ci_009                -1.495736e-02 3 1  ON 8
ci_010                -1.470988e-02 3 1  ON 9
ci_011                -1.253484e-02 3 1  ON 10
ci_012                -1.212197e-02 3 1  ON 11
ci_013                 1.121254e-02 3 1  ON 12
ci_014                 1.099909e-02 3 1  ON 13
ci_015                 1.260939e-02 3 1  ON 14
ci_016                 1.239812e-02 3 1  ON 15
ci_017                 1.049902e-02 3 1  ON 16
ci_018                 1.047980e-02 3 1  ON 17
ci_019                 3.268897e-03 3 1  ON 18
ci_020                 3.486037e-03 3 1  ON 19
ci_021                -8.068695e-03 3 1  ON 20
ci_022                -8.280114e-03 3 1  ON 21
ci_023                 6.236222e-03 3 1  ON 22
ci_024                 6.337325e-03 3 1  ON 23
ci_025                 9.039426e-03 3 1  ON 24
ci_026                 8.952740e-03 3 1  ON 25
ci_027                 6.585599e-03 3 1  ON 26
ci_028                 6.651553e-03 3 1  ON 27
ci_029                -5.190631e-03 3 1  ON 28
ci_030                -5.155024e-03 3 1  ON 29
ci_031                -1.762629e-03 3 1  ON 30
ci_032                -1.722443e-03 3 1  ON 31
ci_033                 4.327700e-03 3 1  ON 32
ci_034                 4.226097e-03 3 1  ON 33
ci_035                 2.737577e-03 3 1  ON 34
ci_036                 2.771240e-03 3 1  ON 35
ci_037                 4.702455e-03 3 1  ON 36
ci_038                 4.549834e-03 3 1  ON 37
ci_039                 4.574402e-03 3 1  ON 38
ci_040                 4.649346e-03 3 1  ON 39
ci_041                 3.713237e-03 3 1  ON 40
ci_042                 3.564925e-03 3 1  ON 41
ci_043                 3.872614e-03 3 1  ON 42
ci_044                 4.055668e-03 3 1  ON 43
ci_045                 3.214413e-03 3 1  ON 44
ci_046                 3.197341e-03 3 1  ON 45
ci_047                -1.607613e-03 3 1  ON 46
ci_048                -1.718356e-03 3 1  ON 47
ci_049                 1.400288e-03 3 1  ON 48
ci_050                 1.488668e-03 3 1  ON 49
ci_051                -2.174662e-03 3 1  ON 50
ci_052                -2.077194e-03 3 1  ON 51
ci_053                -2.236271e-03 3 1  ON 52
ci_054                -2.386034e-03 3 1  ON 53
ci_055                -1.129112e-03 3 1  ON 54
ci_056                -1.635963e-03 3 1  ON 55
ci_057                -1.221315e-03 3 1  ON 56
ci_058                -1.464329e-03 3 1  ON 57
ci_059                -8.262985e-04 3 1  ON 58
ci_060                -6.616500e-04 3 1  ON 59
ci_061                -9.770156e-04 3 1  ON 60
ci_062                -7.219233e-04 3 1  ON 61
ci_063                -6.057914e-04 3 1  ON 62
ci_064                -7.526992e-04 3 1  ON 63
ci_065                -1.915393e-03 3 1  ON 64
ci_066                -2.110257e-03 3 1  ON 65
ci_067                -1.464132e-03 3 1  ON 66
ci_068                -1.105782e-03 3 1  ON 67
ci_069                -1.830897e-05 3 1  ON 68
ci_070                 1.325458e-04 3 1  ON 69
ci_071                -1.880808e-03 3 1  ON 70
ci_072                -1.750389e-03 3 1  ON 71
ci_073                 5.036506e-04 3 1  ON 72
ci_074                 4.905102e-04 3 1  ON 73
ci_075                -1.864945e-04 3 1  ON 74
ci_076                -1.190778e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4684e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.7823
    reference variance = 0.430123
====================================================
  Execution time = 5.1331e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1155e-01
  Total weights = 1.954792619e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484984392576
                                         uncertainty =       0.002217233679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484984392576
                                         uncertainty =       0.002217233679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492457604
  error estimate for blocks of size 2^( 2) =       0.000511545881
  error estimate for blocks of size 2^( 3) =       0.000528139431
  error estimate for blocks of size 2^( 4) =       0.000540164251
  error estimate for blocks of size 2^( 5) =       0.000547282851
  error estimate for blocks of size 2^( 6) =       0.000551068976
  error estimate for blocks of size 2^( 7) =       0.000551343088

      target function =      -0.607145260523
              le_mean =     -22.668317536319
             les_mean =     514.364170936848
             stat err =       0.000547464792
             autocorr =       1.235875415281
   target nu stat err =       0.000547464792
   target dn stat err =       0.010407675439
      target stat err =       0.003126621205
              std dev =       0.696440222561
             le_variance =       0.485028983601


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266831753632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607161039617       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607161184323       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607161205652       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607161207923       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607161208737       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607161208939       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607161209117       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607161209290       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607161209359       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607161209354       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+02 is 1.426869e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607161039617       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607161075798       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607161081131       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607161081698       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607161081902       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607161081952       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607161081997       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607161082040       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607161082057       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607161082055       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+02 is 3.567623e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.607161039617       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.607161048663       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.607161049996       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.607161050138       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.607161050187       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.607161050209       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.607161050213       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.607161050228       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.607161050224       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.607161050227       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+03 is 8.919339e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.850766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0669e+01
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_001                -7.044633e-01 3 1  ON 0
ci_002                -7.027637e-01 3 1  ON 1
ci_003                -5.364313e-02 3 1  ON 2
ci_004                -5.404410e-02 3 1  ON 3
ci_005                 2.331231e-02 3 1  ON 4
ci_006                 2.338456e-02 3 1  ON 5
ci_007                 1.859012e-02 3 1  ON 6
ci_008                 1.898267e-02 3 1  ON 7
ci_009                -1.495713e-02 3 1  ON 8
ci_010                -1.470974e-02 3 1  ON 9
ci_011                -1.253467e-02 3 1  ON 10
ci_012                -1.212178e-02 3 1  ON 11
ci_013                 1.121237e-02 3 1  ON 12
ci_014                 1.099908e-02 3 1  ON 13
ci_015                 1.260926e-02 3 1  ON 14
ci_016                 1.239802e-02 3 1  ON 15
ci_017                 1.049893e-02 3 1  ON 16
ci_018                 1.047977e-02 3 1  ON 17
ci_019                 3.268945e-03 3 1  ON 18
ci_020                 3.485805e-03 3 1  ON 19
ci_021                -8.068780e-03 3 1  ON 20
ci_022                -8.280183e-03 3 1  ON 21
ci_023                 6.236284e-03 3 1  ON 22
ci_024                 6.337293e-03 3 1  ON 23
ci_025                 9.039460e-03 3 1  ON 24
ci_026                 8.952814e-03 3 1  ON 25
ci_027                 6.585602e-03 3 1  ON 26
ci_028                 6.651549e-03 3 1  ON 27
ci_029                -5.190637e-03 3 1  ON 28
ci_030                -5.154984e-03 3 1  ON 29
ci_031                -1.762366e-03 3 1  ON 30
ci_032                -1.722342e-03 3 1  ON 31
ci_033                 4.327616e-03 3 1  ON 32
ci_034                 4.226041e-03 3 1  ON 33
ci_035                 2.737508e-03 3 1  ON 34
ci_036                 2.771225e-03 3 1  ON 35
ci_037                 4.702381e-03 3 1  ON 36
ci_038                 4.549830e-03 3 1  ON 37
ci_039                 4.574426e-03 3 1  ON 38
ci_040                 4.649361e-03 3 1  ON 39
ci_041                 3.713242e-03 3 1  ON 40
ci_042                 3.564875e-03 3 1  ON 41
ci_043                 3.872578e-03 3 1  ON 42
ci_044                 4.055589e-03 3 1  ON 43
ci_045                 3.214374e-03 3 1  ON 44
ci_046                 3.197171e-03 3 1  ON 45
ci_047                -1.607640e-03 3 1  ON 46
ci_048                -1.718303e-03 3 1  ON 47
ci_049                 1.400266e-03 3 1  ON 48
ci_050                 1.488625e-03 3 1  ON 49
ci_051                -2.174588e-03 3 1  ON 50
ci_052                -2.077098e-03 3 1  ON 51
ci_053                -2.236256e-03 3 1  ON 52
ci_054                -2.386021e-03 3 1  ON 53
ci_055                -1.129143e-03 3 1  ON 54
ci_056                -1.635961e-03 3 1  ON 55
ci_057                -1.221284e-03 3 1  ON 56
ci_058                -1.464337e-03 3 1  ON 57
ci_059                -8.262728e-04 3 1  ON 58
ci_060                -6.616668e-04 3 1  ON 59
ci_061                -9.770536e-04 3 1  ON 60
ci_062                -7.219708e-04 3 1  ON 61
ci_063                -6.058382e-04 3 1  ON 62
ci_064                -7.525556e-04 3 1  ON 63
ci_065                -1.915447e-03 3 1  ON 64
ci_066                -2.110239e-03 3 1  ON 65
ci_067                -1.464076e-03 3 1  ON 66
ci_068                -1.105772e-03 3 1  ON 67
ci_069                -1.829256e-05 3 1  ON 68
ci_070                 1.325670e-04 3 1  ON 69
ci_071                -1.880824e-03 3 1  ON 70
ci_072                -1.750419e-03 3 1  ON 71
ci_073                 5.035961e-04 3 1  ON 72
ci_074                 4.904901e-04 3 1  ON 73
ci_075                -1.864453e-04 3 1  ON 74
ci_076                -1.191099e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.6453
    reference variance = 0.672177
====================================================
  Execution time = 5.1171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9147e-01
  Total weights = 1.9548e+06
  Execution time = 7.2046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480960970506
                                         uncertainty =       0.002021045669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480960970506
                                         uncertainty =       0.002021045669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490348261
  error estimate for blocks of size 2^( 2) =       0.000508809213
  error estimate for blocks of size 2^( 3) =       0.000525896884
  error estimate for blocks of size 2^( 4) =       0.000537900903
  error estimate for blocks of size 2^( 5) =       0.000544146115
  error estimate for blocks of size 2^( 6) =       0.000548776350
  error estimate for blocks of size 2^( 7) =       0.000551959291

      target function =      -0.613131813321
              le_mean =     -22.667925453138
             les_mean =     514.326310525313
             stat err =       0.000545695665
             autocorr =       1.238487787296
   target nu stat err =       0.000545695665
   target dn stat err =       0.002888369951
      target stat err =       0.000922191399
              std dev =       0.693457160661
             le_variance =       0.480882833671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480960073146
                                         uncertainty =       0.002021048270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480960073146
                                         uncertainty =       0.002021048270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490347800
  error estimate for blocks of size 2^( 2) =       0.000508808763
  error estimate for blocks of size 2^( 3) =       0.000525896436
  error estimate for blocks of size 2^( 4) =       0.000537900452
  error estimate for blocks of size 2^( 5) =       0.000544145654
  error estimate for blocks of size 2^( 6) =       0.000548775912
  error estimate for blocks of size 2^( 7) =       0.000551958835

      target function =      -0.613132491371
              le_mean =     -22.667925459506
             les_mean =     514.326308597176
             stat err =       0.000545695213
             autocorr =       1.238488066691
   target nu stat err =       0.000545695213
   target dn stat err =       0.002888326588
      target stat err =       0.000922180644
              std dev =       0.693456509037
             le_variance =       0.480881929926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480960521735
                                         uncertainty =       0.002021046968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480960521735
                                         uncertainty =       0.002021046968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490348030
  error estimate for blocks of size 2^( 2) =       0.000508808988
  error estimate for blocks of size 2^( 3) =       0.000525896660
  error estimate for blocks of size 2^( 4) =       0.000537900678
  error estimate for blocks of size 2^( 5) =       0.000544145884
  error estimate for blocks of size 2^( 6) =       0.000548776131
  error estimate for blocks of size 2^( 7) =       0.000551959063

      target function =      -0.613132153154
              le_mean =     -22.667925456317
             les_mean =     514.326309558363
             stat err =       0.000545695439
             autocorr =       1.238487927024
   target nu stat err =       0.000545695439
   target dn stat err =       0.002888348231
      target stat err =       0.000922186012
              std dev =       0.693456834783
             le_variance =       0.480882381707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480960914403
                                         uncertainty =       0.002021045831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480960914403
                                         uncertainty =       0.002021045831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490348232
  error estimate for blocks of size 2^( 2) =       0.000508809185
  error estimate for blocks of size 2^( 3) =       0.000525896856
  error estimate for blocks of size 2^( 4) =       0.000537900875
  error estimate for blocks of size 2^( 5) =       0.000544146086
  error estimate for blocks of size 2^( 6) =       0.000548776322
  error estimate for blocks of size 2^( 7) =       0.000551959262

      target function =      -0.613131855886
              le_mean =     -22.667925453535
             les_mean =     514.326310404134
             stat err =       0.000545695636
             autocorr =       1.238487804758
   target nu stat err =       0.000545695636
   target dn stat err =       0.002888367232
      target stat err =       0.000922190724
              std dev =       0.693457119922
             le_variance =       0.480882777170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.613131813321        initial
     2.3283e+02     2.3283e+03             1.4269e-06        -0.613132491371  <--
     9.3132e+02     9.3132e+03             3.5676e-07        -0.613132153154
     3.7253e+03     3.7253e+04             8.9193e-08        -0.613131855886

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 8.7330e+01
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_001                -7.044629e-01 3 1  ON 0
ci_002                -7.027644e-01 3 1  ON 1
ci_003                -5.364216e-02 3 1  ON 2
ci_004                -5.404364e-02 3 1  ON 3
ci_005                 2.331124e-02 3 1  ON 4
ci_006                 2.338372e-02 3 1  ON 5
ci_007                 1.858971e-02 3 1  ON 6
ci_008                 1.898202e-02 3 1  ON 7
ci_009                -1.495641e-02 3 1  ON 8
ci_010                -1.470932e-02 3 1  ON 9
ci_011                -1.253417e-02 3 1  ON 10
ci_012                -1.212121e-02 3 1  ON 11
ci_013                 1.121185e-02 3 1  ON 12
ci_014                 1.099903e-02 3 1  ON 13
ci_015                 1.260887e-02 3 1  ON 14
ci_016                 1.239771e-02 3 1  ON 15
ci_017                 1.049867e-02 3 1  ON 16
ci_018                 1.047968e-02 3 1  ON 17
ci_019                 3.269090e-03 3 1  ON 18
ci_020                 3.485110e-03 3 1  ON 19
ci_021                -8.069037e-03 3 1  ON 20
ci_022                -8.280390e-03 3 1  ON 21
ci_023                 6.236470e-03 3 1  ON 22
ci_024                 6.337196e-03 3 1  ON 23
ci_025                 9.039561e-03 3 1  ON 24
ci_026                 8.953035e-03 3 1  ON 25
ci_027                 6.585613e-03 3 1  ON 26
ci_028                 6.651540e-03 3 1  ON 27
ci_029                -5.190654e-03 3 1  ON 28
ci_030                -5.154866e-03 3 1  ON 29
ci_031                -1.761576e-03 3 1  ON 30
ci_032                -1.722037e-03 3 1  ON 31
ci_033                 4.327365e-03 3 1  ON 32
ci_034                 4.225873e-03 3 1  ON 33
ci_035                 2.737301e-03 3 1  ON 34
ci_036                 2.771179e-03 3 1  ON 35
ci_037                 4.702160e-03 3 1  ON 36
ci_038                 4.549817e-03 3 1  ON 37
ci_039                 4.574499e-03 3 1  ON 38
ci_040                 4.649405e-03 3 1  ON 39
ci_041                 3.713256e-03 3 1  ON 40
ci_042                 3.564726e-03 3 1  ON 41
ci_043                 3.872468e-03 3 1  ON 42
ci_044                 4.055352e-03 3 1  ON 43
ci_045                 3.214256e-03 3 1  ON 44
ci_046                 3.196663e-03 3 1  ON 45
ci_047                -1.607723e-03 3 1  ON 46
ci_048                -1.718145e-03 3 1  ON 47
ci_049                 1.400200e-03 3 1  ON 48
ci_050                 1.488498e-03 3 1  ON 49
ci_051                -2.174368e-03 3 1  ON 50
ci_052                -2.076810e-03 3 1  ON 51
ci_053                -2.236214e-03 3 1  ON 52
ci_054                -2.385984e-03 3 1  ON 53
ci_055                -1.129237e-03 3 1  ON 54
ci_056                -1.635954e-03 3 1  ON 55
ci_057                -1.221193e-03 3 1  ON 56
ci_058                -1.464360e-03 3 1  ON 57
ci_059                -8.261956e-04 3 1  ON 58
ci_060                -6.617169e-04 3 1  ON 59
ci_061                -9.771679e-04 3 1  ON 60
ci_062                -7.221132e-04 3 1  ON 61
ci_063                -6.059785e-04 3 1  ON 62
ci_064                -7.521250e-04 3 1  ON 63
ci_065                -1.915609e-03 3 1  ON 64
ci_066                -2.110187e-03 3 1  ON 65
ci_067                -1.463906e-03 3 1  ON 66
ci_068                -1.105740e-03 3 1  ON 67
ci_069                -1.824334e-05 3 1  ON 68
ci_070                 1.326304e-04 3 1  ON 69
ci_071                -1.880874e-03 3 1  ON 70
ci_072                -1.750508e-03 3 1  ON 71
ci_073                 5.034327e-04 3 1  ON 72
ci_074                 4.904299e-04 3 1  ON 73
ci_075                -1.862977e-04 3 1  ON 74
ci_076                -1.192061e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4801e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.743
    reference variance = 0.659779
====================================================
  Execution time = 5.1924e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9707e-01
  Total weights = 1.955078821e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486199451930
                                         uncertainty =       0.002385959306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486199451930
                                         uncertainty =       0.002385959306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493030867
  error estimate for blocks of size 2^( 2) =       0.000511430319
  error estimate for blocks of size 2^( 3) =       0.000528081968
  error estimate for blocks of size 2^( 4) =       0.000540282141
  error estimate for blocks of size 2^( 5) =       0.000546918709
  error estimate for blocks of size 2^( 6) =       0.000550533185
  error estimate for blocks of size 2^( 7) =       0.000554326088

      target function =      -0.611633245292
              le_mean =     -22.668746735511
             les_mean =     514.369147123857
             stat err =       0.000548015031
             autocorr =       1.235482851205
   target nu stat err =       0.000548015031
   target dn stat err =       0.003311919758
      target stat err =       0.001042446049
              std dev =       0.697250938179
             le_variance =       0.486158870791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266874673551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611634744339       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611635309210       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611635364733       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611635370282       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611635370644       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611635370931       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611635371187       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611635371121       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611635371111       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+01 is 6.258605e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611634744339       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611634885628       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611634899512       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611634900899       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611634900990       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611634901061       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611634901125       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611634901109       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611634901106       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+02 is 1.565468e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611634744339       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611634779665       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611634783137       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611634783483       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611634783506       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611634783524       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611634783540       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611634783535       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611634783536       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+02 is 3.914181e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.855282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1302e+01
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_001                -7.044629e-01 3 1  ON 0
ci_002                -7.027647e-01 3 1  ON 1
ci_003                -5.364159e-02 3 1  ON 2
ci_004                -5.404285e-02 3 1  ON 3
ci_005                 2.330968e-02 3 1  ON 4
ci_006                 2.338248e-02 3 1  ON 5
ci_007                 1.858884e-02 3 1  ON 6
ci_008                 1.898104e-02 3 1  ON 7
ci_009                -1.495575e-02 3 1  ON 8
ci_010                -1.470882e-02 3 1  ON 9
ci_011                -1.253361e-02 3 1  ON 10
ci_012                -1.212041e-02 3 1  ON 11
ci_013                 1.121125e-02 3 1  ON 12
ci_014                 1.099855e-02 3 1  ON 13
ci_015                 1.260871e-02 3 1  ON 14
ci_016                 1.239731e-02 3 1  ON 15
ci_017                 1.049838e-02 3 1  ON 16
ci_018                 1.047924e-02 3 1  ON 17
ci_019                 3.268733e-03 3 1  ON 18
ci_020                 3.484438e-03 3 1  ON 19
ci_021                -8.068926e-03 3 1  ON 20
ci_022                -8.280225e-03 3 1  ON 21
ci_023                 6.236186e-03 3 1  ON 22
ci_024                 6.336983e-03 3 1  ON 23
ci_025                 9.039814e-03 3 1  ON 24
ci_026                 8.952780e-03 3 1  ON 25
ci_027                 6.585626e-03 3 1  ON 26
ci_028                 6.651510e-03 3 1  ON 27
ci_029                -5.190249e-03 3 1  ON 28
ci_030                -5.154847e-03 3 1  ON 29
ci_031                -1.760911e-03 3 1  ON 30
ci_032                -1.721640e-03 3 1  ON 31
ci_033                 4.327297e-03 3 1  ON 32
ci_034                 4.225829e-03 3 1  ON 33
ci_035                 2.737255e-03 3 1  ON 34
ci_036                 2.770751e-03 3 1  ON 35
ci_037                 4.701990e-03 3 1  ON 36
ci_038                 4.549904e-03 3 1  ON 37
ci_039                 4.574550e-03 3 1  ON 38
ci_040                 4.649494e-03 3 1  ON 39
ci_041                 3.713079e-03 3 1  ON 40
ci_042                 3.564692e-03 3 1  ON 41
ci_043                 3.872149e-03 3 1  ON 42
ci_044                 4.055249e-03 3 1  ON 43
ci_045                 3.214117e-03 3 1  ON 44
ci_046                 3.196584e-03 3 1  ON 45
ci_047                -1.607479e-03 3 1  ON 46
ci_048                -1.717942e-03 3 1  ON 47
ci_049                 1.400011e-03 3 1  ON 48
ci_050                 1.488362e-03 3 1  ON 49
ci_051                -2.174447e-03 3 1  ON 50
ci_052                -2.076461e-03 3 1  ON 51
ci_053                -2.236173e-03 3 1  ON 52
ci_054                -2.385889e-03 3 1  ON 53
ci_055                -1.129336e-03 3 1  ON 54
ci_056                -1.636051e-03 3 1  ON 55
ci_057                -1.221093e-03 3 1  ON 56
ci_058                -1.464161e-03 3 1  ON 57
ci_059                -8.260191e-04 3 1  ON 58
ci_060                -6.616634e-04 3 1  ON 59
ci_061                -9.770336e-04 3 1  ON 60
ci_062                -7.220460e-04 3 1  ON 61
ci_063                -6.056658e-04 3 1  ON 62
ci_064                -7.523145e-04 3 1  ON 63
ci_065                -1.915752e-03 3 1  ON 64
ci_066                -2.110317e-03 3 1  ON 65
ci_067                -1.463814e-03 3 1  ON 66
ci_068                -1.105746e-03 3 1  ON 67
ci_069                -1.831884e-05 3 1  ON 68
ci_070                 1.326992e-04 3 1  ON 69
ci_071                -1.880660e-03 3 1  ON 70
ci_072                -1.750569e-03 3 1  ON 71
ci_073                 5.032397e-04 3 1  ON 72
ci_074                 4.903564e-04 3 1  ON 73
ci_075                -1.863355e-04 3 1  ON 74
ci_076                -1.190729e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.6713
    reference variance = 0.484468
====================================================
  Execution time = 4.9720e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2057e-01
  Total weights = 1.9548e+06
  Execution time = 7.2380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493263616551
                                         uncertainty =       0.008818260681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493263616551
                                         uncertainty =       0.008818260681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496630539
  error estimate for blocks of size 2^( 2) =       0.000514914282
  error estimate for blocks of size 2^( 3) =       0.000531615691
  error estimate for blocks of size 2^( 4) =       0.000542850909
  error estimate for blocks of size 2^( 5) =       0.000551529312
  error estimate for blocks of size 2^( 6) =       0.000555958963
  error estimate for blocks of size 2^( 7) =       0.000558039731

      target function =      -0.604532301437
              le_mean =     -22.668730981986
             les_mean =     514.391910237788
             stat err =       0.000552094729
             autocorr =       1.235834621279
   target nu stat err =       0.000552094729
   target dn stat err =       0.018102973047
      target stat err =       0.005380493051
              std dev =       0.702341643549
             le_variance =       0.493283784263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493263195597
                                         uncertainty =       0.008818771929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493263195597
                                         uncertainty =       0.008818771929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496630314
  error estimate for blocks of size 2^( 2) =       0.000514914012
  error estimate for blocks of size 2^( 3) =       0.000531615474
  error estimate for blocks of size 2^( 4) =       0.000542850577
  error estimate for blocks of size 2^( 5) =       0.000551529013
  error estimate for blocks of size 2^( 6) =       0.000555958478
  error estimate for blocks of size 2^( 7) =       0.000558038973

      target function =      -0.604501220987
              le_mean =     -22.668730967203
             les_mean =     514.392012827566
             stat err =       0.000552094260
             autocorr =       1.235833646469
   target nu stat err =       0.000552094260
   target dn stat err =       0.018184786610
      target stat err =       0.005404196472
              std dev =       0.702341324854
             le_variance =       0.493283336598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493263400504
                                         uncertainty =       0.008818515810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493263400504
                                         uncertainty =       0.008818515810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496630423
  error estimate for blocks of size 2^( 2) =       0.000514914144
  error estimate for blocks of size 2^( 3) =       0.000531615580
  error estimate for blocks of size 2^( 4) =       0.000542850740
  error estimate for blocks of size 2^( 5) =       0.000551529160
  error estimate for blocks of size 2^( 6) =       0.000555958718
  error estimate for blocks of size 2^( 7) =       0.000558039350

      target function =      -0.604516829339
              le_mean =     -22.668730974558
             les_mean =     514.391961303313
             stat err =       0.000552094492
             autocorr =       1.235834136212
   target nu stat err =       0.000552094492
   target dn stat err =       0.018143743676
      target stat err =       0.005392306187
              std dev =       0.702341480254
             le_variance =       0.493283554885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493263588947
                                         uncertainty =       0.008818292512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493263588947
                                         uncertainty =       0.008818292512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496630524
  error estimate for blocks of size 2^( 2) =       0.000514914264
  error estimate for blocks of size 2^( 3) =       0.000531615677
  error estimate for blocks of size 2^( 4) =       0.000542850888
  error estimate for blocks of size 2^( 5) =       0.000551529293
  error estimate for blocks of size 2^( 6) =       0.000555958932
  error estimate for blocks of size 2^( 7) =       0.000558039683

      target function =      -0.604530374448
              le_mean =     -22.668730981054
             les_mean =     514.391916597378
             stat err =       0.000552094699
             autocorr =       1.235834560916
   target nu stat err =       0.000552094699
   target dn stat err =       0.018108052999
      target stat err =       0.005381965026
              std dev =       0.702341622713
             le_variance =       0.493283754996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.604532301437        initial  <--
     5.8208e+01     5.8208e+02             6.2586e-06        -0.604501220987
     2.3283e+02     2.3283e+03             1.5655e-06        -0.604516829339
     9.3132e+02     9.3132e+03             3.9142e-07        -0.604530374448

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 86.0191
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_001                -7.044629e-01 3 1  ON 0
ci_002                -7.027644e-01 3 1  ON 1
ci_003                -5.364216e-02 3 1  ON 2
ci_004                -5.404364e-02 3 1  ON 3
ci_005                 2.331124e-02 3 1  ON 4
ci_006                 2.338372e-02 3 1  ON 5
ci_007                 1.858971e-02 3 1  ON 6
ci_008                 1.898202e-02 3 1  ON 7
ci_009                -1.495641e-02 3 1  ON 8
ci_010                -1.470932e-02 3 1  ON 9
ci_011                -1.253417e-02 3 1  ON 10
ci_012                -1.212121e-02 3 1  ON 11
ci_013                 1.121185e-02 3 1  ON 12
ci_014                 1.099903e-02 3 1  ON 13
ci_015                 1.260887e-02 3 1  ON 14
ci_016                 1.239771e-02 3 1  ON 15
ci_017                 1.049867e-02 3 1  ON 16
ci_018                 1.047968e-02 3 1  ON 17
ci_019                 3.269090e-03 3 1  ON 18
ci_020                 3.485110e-03 3 1  ON 19
ci_021                -8.069037e-03 3 1  ON 20
ci_022                -8.280390e-03 3 1  ON 21
ci_023                 6.236470e-03 3 1  ON 22
ci_024                 6.337196e-03 3 1  ON 23
ci_025                 9.039561e-03 3 1  ON 24
ci_026                 8.953035e-03 3 1  ON 25
ci_027                 6.585613e-03 3 1  ON 26
ci_028                 6.651540e-03 3 1  ON 27
ci_029                -5.190654e-03 3 1  ON 28
ci_030                -5.154866e-03 3 1  ON 29
ci_031                -1.761576e-03 3 1  ON 30
ci_032                -1.722037e-03 3 1  ON 31
ci_033                 4.327365e-03 3 1  ON 32
ci_034                 4.225873e-03 3 1  ON 33
ci_035                 2.737301e-03 3 1  ON 34
ci_036                 2.771179e-03 3 1  ON 35
ci_037                 4.702160e-03 3 1  ON 36
ci_038                 4.549817e-03 3 1  ON 37
ci_039                 4.574499e-03 3 1  ON 38
ci_040                 4.649405e-03 3 1  ON 39
ci_041                 3.713256e-03 3 1  ON 40
ci_042                 3.564726e-03 3 1  ON 41
ci_043                 3.872468e-03 3 1  ON 42
ci_044                 4.055352e-03 3 1  ON 43
ci_045                 3.214256e-03 3 1  ON 44
ci_046                 3.196663e-03 3 1  ON 45
ci_047                -1.607723e-03 3 1  ON 46
ci_048                -1.718145e-03 3 1  ON 47
ci_049                 1.400200e-03 3 1  ON 48
ci_050                 1.488498e-03 3 1  ON 49
ci_051                -2.174368e-03 3 1  ON 50
ci_052                -2.076810e-03 3 1  ON 51
ci_053                -2.236214e-03 3 1  ON 52
ci_054                -2.385984e-03 3 1  ON 53
ci_055                -1.129237e-03 3 1  ON 54
ci_056                -1.635954e-03 3 1  ON 55
ci_057                -1.221193e-03 3 1  ON 56
ci_058                -1.464360e-03 3 1  ON 57
ci_059                -8.261956e-04 3 1  ON 58
ci_060                -6.617169e-04 3 1  ON 59
ci_061                -9.771679e-04 3 1  ON 60
ci_062                -7.221132e-04 3 1  ON 61
ci_063                -6.059785e-04 3 1  ON 62
ci_064                -7.521250e-04 3 1  ON 63
ci_065                -1.915609e-03 3 1  ON 64
ci_066                -2.110187e-03 3 1  ON 65
ci_067                -1.463906e-03 3 1  ON 66
ci_068                -1.105740e-03 3 1  ON 67
ci_069                -1.824334e-05 3 1  ON 68
ci_070                 1.326304e-04 3 1  ON 69
ci_071                -1.880874e-03 3 1  ON 70
ci_072                -1.750508e-03 3 1  ON 71
ci_073                 5.034327e-04 3 1  ON 72
ci_074                 4.904299e-04 3 1  ON 73
ci_075                -1.862977e-04 3 1  ON 74
ci_076                -1.192061e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4733e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7474
    reference variance = 0.25109
====================================================
  Execution time = 5.1229e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9978e-01
  Total weights = 1.954714148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3026e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486101084634
                                         uncertainty =       0.002261640784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486101084634
                                         uncertainty =       0.002261640784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492988920
  error estimate for blocks of size 2^( 2) =       0.000511017025
  error estimate for blocks of size 2^( 3) =       0.000528014144
  error estimate for blocks of size 2^( 4) =       0.000539830230
  error estimate for blocks of size 2^( 5) =       0.000546735981
  error estimate for blocks of size 2^( 6) =       0.000549467118
  error estimate for blocks of size 2^( 7) =       0.000552763116

      target function =      -0.610590347441
              le_mean =     -22.667865848760
             les_mean =     514.331921115188
             stat err =       0.000547199111
             autocorr =       1.232016286765
   target nu stat err =       0.000547199111
   target dn stat err =       0.003519521222
      target stat err =       0.001098925323
              std dev =       0.697191617356
             le_variance =       0.486076151312


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266786584876e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610592032651       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610592094540       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610592102420       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610592103395       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610592103625       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610592103657       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610592103647       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610592103643       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+02 is 5.829646e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610592032651       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610592048124       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610592050094       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610592050338       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610592050395       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610592050403       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610592050401       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610592050400       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+03 is 1.457487e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610592032651       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610592036519       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610592037012       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610592037073       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610592037087       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610592037089       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610592037088       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610592037087       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+03 is 3.643765e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.859137 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0543e+01
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_001                -7.044629e-01 3 1  ON 0
ci_002                -7.027644e-01 3 1  ON 1
ci_003                -5.364208e-02 3 1  ON 2
ci_004                -5.404359e-02 3 1  ON 3
ci_005                 2.331110e-02 3 1  ON 4
ci_006                 2.338358e-02 3 1  ON 5
ci_007                 1.858961e-02 3 1  ON 6
ci_008                 1.898193e-02 3 1  ON 7
ci_009                -1.495636e-02 3 1  ON 8
ci_010                -1.470923e-02 3 1  ON 9
ci_011                -1.253407e-02 3 1  ON 10
ci_012                -1.212114e-02 3 1  ON 11
ci_013                 1.121179e-02 3 1  ON 12
ci_014                 1.099898e-02 3 1  ON 13
ci_015                 1.260881e-02 3 1  ON 14
ci_016                 1.239766e-02 3 1  ON 15
ci_017                 1.049865e-02 3 1  ON 16
ci_018                 1.047965e-02 3 1  ON 17
ci_019                 3.269053e-03 3 1  ON 18
ci_020                 3.485045e-03 3 1  ON 19
ci_021                -8.069071e-03 3 1  ON 20
ci_022                -8.280394e-03 3 1  ON 21
ci_023                 6.236428e-03 3 1  ON 22
ci_024                 6.337173e-03 3 1  ON 23
ci_025                 9.039606e-03 3 1  ON 24
ci_026                 8.953021e-03 3 1  ON 25
ci_027                 6.585624e-03 3 1  ON 26
ci_028                 6.651544e-03 3 1  ON 27
ci_029                -5.190641e-03 3 1  ON 28
ci_030                -5.154838e-03 3 1  ON 29
ci_031                -1.761521e-03 3 1  ON 30
ci_032                -1.722004e-03 3 1  ON 31
ci_033                 4.327366e-03 3 1  ON 32
ci_034                 4.225857e-03 3 1  ON 33
ci_035                 2.737260e-03 3 1  ON 34
ci_036                 2.771162e-03 3 1  ON 35
ci_037                 4.702127e-03 3 1  ON 36
ci_038                 4.549820e-03 3 1  ON 37
ci_039                 4.574504e-03 3 1  ON 38
ci_040                 4.649399e-03 3 1  ON 39
ci_041                 3.713244e-03 3 1  ON 40
ci_042                 3.564718e-03 3 1  ON 41
ci_043                 3.872435e-03 3 1  ON 42
ci_044                 4.055333e-03 3 1  ON 43
ci_045                 3.214232e-03 3 1  ON 44
ci_046                 3.196683e-03 3 1  ON 45
ci_047                -1.607723e-03 3 1  ON 46
ci_048                -1.718108e-03 3 1  ON 47
ci_049                 1.400179e-03 3 1  ON 48
ci_050                 1.488497e-03 3 1  ON 49
ci_051                -2.174349e-03 3 1  ON 50
ci_052                -2.076814e-03 3 1  ON 51
ci_053                -2.236183e-03 3 1  ON 52
ci_054                -2.385994e-03 3 1  ON 53
ci_055                -1.129213e-03 3 1  ON 54
ci_056                -1.635976e-03 3 1  ON 55
ci_057                -1.221185e-03 3 1  ON 56
ci_058                -1.464372e-03 3 1  ON 57
ci_059                -8.261748e-04 3 1  ON 58
ci_060                -6.617168e-04 3 1  ON 59
ci_061                -9.771590e-04 3 1  ON 60
ci_062                -7.221396e-04 3 1  ON 61
ci_063                -6.059932e-04 3 1  ON 62
ci_064                -7.521235e-04 3 1  ON 63
ci_065                -1.915595e-03 3 1  ON 64
ci_066                -2.110193e-03 3 1  ON 65
ci_067                -1.463909e-03 3 1  ON 66
ci_068                -1.105730e-03 3 1  ON 67
ci_069                -1.825760e-05 3 1  ON 68
ci_070                 1.326278e-04 3 1  ON 69
ci_071                -1.880868e-03 3 1  ON 70
ci_072                -1.750516e-03 3 1  ON 71
ci_073                 5.034205e-04 3 1  ON 72
ci_074                 4.904156e-04 3 1  ON 73
ci_075                -1.862952e-04 3 1  ON 74
ci_076                -1.192063e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7132
    reference variance = 0.324531
====================================================
  Execution time = 4.9617e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0343e-01
  Total weights = 1.9547e+06
  Execution time = 7.2065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490518684113
                                         uncertainty =       0.002387031299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490518684113
                                         uncertainty =       0.002387031299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495262785
  error estimate for blocks of size 2^( 2) =       0.000513946598
  error estimate for blocks of size 2^( 3) =       0.000531235515
  error estimate for blocks of size 2^( 4) =       0.000542664159
  error estimate for blocks of size 2^( 5) =       0.000549204836
  error estimate for blocks of size 2^( 6) =       0.000552181241
  error estimate for blocks of size 2^( 7) =       0.000553857971

      target function =      -0.609403059376
              le_mean =     -22.667524089696
             les_mean =     514.320075921394
             stat err =       0.000549477052
             autocorr =       1.230914046306
   target nu stat err =       0.000549477052
   target dn stat err =       0.003919982710
      target stat err =       0.001212025119
              std dev =       0.700407347658
             le_variance =       0.490570452654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490518299199
                                         uncertainty =       0.002387028586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490518299199
                                         uncertainty =       0.002387028586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495262591
  error estimate for blocks of size 2^( 2) =       0.000513946406
  error estimate for blocks of size 2^( 3) =       0.000531235322
  error estimate for blocks of size 2^( 4) =       0.000542663966
  error estimate for blocks of size 2^( 5) =       0.000549204649
  error estimate for blocks of size 2^( 6) =       0.000552181051
  error estimate for blocks of size 2^( 7) =       0.000553857773

      target function =      -0.609403073291
              le_mean =     -22.667524093542
             les_mean =     514.320076052276
             stat err =       0.000549476860
             autocorr =       1.230914153590
   target nu stat err =       0.000549476860
   target dn stat err =       0.003920098065
      target stat err =       0.001212059030
              std dev =       0.700407072448
             le_variance =       0.490570067135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490518491641
                                         uncertainty =       0.002387029942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490518491641
                                         uncertainty =       0.002387029942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495262688
  error estimate for blocks of size 2^( 2) =       0.000513946502
  error estimate for blocks of size 2^( 3) =       0.000531235419
  error estimate for blocks of size 2^( 4) =       0.000542664063
  error estimate for blocks of size 2^( 5) =       0.000549204742
  error estimate for blocks of size 2^( 6) =       0.000552181146
  error estimate for blocks of size 2^( 7) =       0.000553857872

      target function =      -0.609403066379
              le_mean =     -22.667524091618
             les_mean =     514.320075986647
             stat err =       0.000549476956
             autocorr =       1.230914099945
   target nu stat err =       0.000549476956
   target dn stat err =       0.003920040385
      target stat err =       0.001212042074
              std dev =       0.700407210042
             le_variance =       0.490570259879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490518660053
                                         uncertainty =       0.002387031129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490518660053
                                         uncertainty =       0.002387031129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495262773
  error estimate for blocks of size 2^( 2) =       0.000513946586
  error estimate for blocks of size 2^( 3) =       0.000531235503
  error estimate for blocks of size 2^( 4) =       0.000542664147
  error estimate for blocks of size 2^( 5) =       0.000549204824
  error estimate for blocks of size 2^( 6) =       0.000552181229
  error estimate for blocks of size 2^( 7) =       0.000553857959

      target function =      -0.609403060256
              le_mean =     -22.667524089936
             les_mean =     514.320075929530
             stat err =       0.000549477040
             autocorr =       1.230914053009
   target nu stat err =       0.000549477040
   target dn stat err =       0.003919989919
      target stat err =       0.001212027238
              std dev =       0.700407330455
             le_variance =       0.490570428556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609403059376        initial
     5.8208e+02     5.8208e+03             5.8296e-07        -0.609403073291  <--
     2.3283e+03     2.3283e+04             1.4575e-07        -0.609403066379
     9.3132e+03     9.3132e+04             3.6438e-08        -0.609403060256

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 8.5768e+01
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_001                -7.044630e-01 3 1  ON 0
ci_002                -7.027644e-01 3 1  ON 1
ci_003                -5.364184e-02 3 1  ON 2
ci_004                -5.404343e-02 3 1  ON 3
ci_005                 2.331066e-02 3 1  ON 4
ci_006                 2.338316e-02 3 1  ON 5
ci_007                 1.858931e-02 3 1  ON 6
ci_008                 1.898164e-02 3 1  ON 7
ci_009                -1.495620e-02 3 1  ON 8
ci_010                -1.470898e-02 3 1  ON 9
ci_011                -1.253375e-02 3 1  ON 10
ci_012                -1.212093e-02 3 1  ON 11
ci_013                 1.121158e-02 3 1  ON 12
ci_014                 1.099884e-02 3 1  ON 13
ci_015                 1.260860e-02 3 1  ON 14
ci_016                 1.239750e-02 3 1  ON 15
ci_017                 1.049859e-02 3 1  ON 16
ci_018                 1.047955e-02 3 1  ON 17
ci_019                 3.268943e-03 3 1  ON 18
ci_020                 3.484849e-03 3 1  ON 19
ci_021                -8.069171e-03 3 1  ON 20
ci_022                -8.280407e-03 3 1  ON 21
ci_023                 6.236301e-03 3 1  ON 22
ci_024                 6.337105e-03 3 1  ON 23
ci_025                 9.039740e-03 3 1  ON 24
ci_026                 8.952979e-03 3 1  ON 25
ci_027                 6.585658e-03 3 1  ON 26
ci_028                 6.651557e-03 3 1  ON 27
ci_029                -5.190601e-03 3 1  ON 28
ci_030                -5.154757e-03 3 1  ON 29
ci_031                -1.761355e-03 3 1  ON 30
ci_032                -1.721907e-03 3 1  ON 31
ci_033                 4.327367e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.737134e-03 3 1  ON 34
ci_036                 2.771112e-03 3 1  ON 35
ci_037                 4.702029e-03 3 1  ON 36
ci_038                 4.549827e-03 3 1  ON 37
ci_039                 4.574517e-03 3 1  ON 38
ci_040                 4.649382e-03 3 1  ON 39
ci_041                 3.713209e-03 3 1  ON 40
ci_042                 3.564694e-03 3 1  ON 41
ci_043                 3.872334e-03 3 1  ON 42
ci_044                 4.055276e-03 3 1  ON 43
ci_045                 3.214160e-03 3 1  ON 44
ci_046                 3.196744e-03 3 1  ON 45
ci_047                -1.607721e-03 3 1  ON 46
ci_048                -1.717997e-03 3 1  ON 47
ci_049                 1.400115e-03 3 1  ON 48
ci_050                 1.488494e-03 3 1  ON 49
ci_051                -2.174293e-03 3 1  ON 50
ci_052                -2.076824e-03 3 1  ON 51
ci_053                -2.236092e-03 3 1  ON 52
ci_054                -2.386025e-03 3 1  ON 53
ci_055                -1.129141e-03 3 1  ON 54
ci_056                -1.636040e-03 3 1  ON 55
ci_057                -1.221161e-03 3 1  ON 56
ci_058                -1.464408e-03 3 1  ON 57
ci_059                -8.261124e-04 3 1  ON 58
ci_060                -6.617165e-04 3 1  ON 59
ci_061                -9.771325e-04 3 1  ON 60
ci_062                -7.222187e-04 3 1  ON 61
ci_063                -6.060373e-04 3 1  ON 62
ci_064                -7.521190e-04 3 1  ON 63
ci_065                -1.915554e-03 3 1  ON 64
ci_066                -2.110212e-03 3 1  ON 65
ci_067                -1.463917e-03 3 1  ON 66
ci_068                -1.105700e-03 3 1  ON 67
ci_069                -1.830039e-05 3 1  ON 68
ci_070                 1.326200e-04 3 1  ON 69
ci_071                -1.880851e-03 3 1  ON 70
ci_072                -1.750539e-03 3 1  ON 71
ci_073                 5.033840e-04 3 1  ON 72
ci_074                 4.903729e-04 3 1  ON 73
ci_075                -1.862877e-04 3 1  ON 74
ci_076                -1.192069e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4632e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6226
    reference variance = 0.678549
====================================================
  Execution time = 5.1813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9602e-01
  Total weights = 1.955388211e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485409873015
                                         uncertainty =       0.002340134576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485409873015
                                         uncertainty =       0.002340134576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492663888
  error estimate for blocks of size 2^( 2) =       0.000510873597
  error estimate for blocks of size 2^( 3) =       0.000527289456
  error estimate for blocks of size 2^( 4) =       0.000539139412
  error estimate for blocks of size 2^( 5) =       0.000546264075
  error estimate for blocks of size 2^( 6) =       0.000549490779
  error estimate for blocks of size 2^( 7) =       0.000550983984

      target function =      -0.611811683843
              le_mean =     -22.668191732905
             les_mean =     514.342938687226
             stat err =       0.000546469562
             autocorr =       1.230355160513
   target nu stat err =       0.000546469562
   target dn stat err =       0.003141042250
      target stat err =       0.000992321359
              std dev =       0.696731951830
             le_variance =       0.485435412700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266819173291e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611812981895       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611813210295       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611813231225       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611813232272       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611813232364       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611813232617       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611813232621       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611813232668       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611813232660       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+02 is 2.187026e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611812981895       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611813039006       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611813044239       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611813044501       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611813044524       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611813044587       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611813044588       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611813044601       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611813044599       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+02 is 5.468683e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611812981895       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611812996174       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611812997482       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611812997547       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611812997554       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611812997567       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611812997567       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611812997573       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611812997578       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+03 is 1.367241e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.863676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1224e+01
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_001                -7.044631e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364157e-02 3 1  ON 2
ci_004                -5.404315e-02 3 1  ON 3
ci_005                 2.331011e-02 3 1  ON 4
ci_006                 2.338261e-02 3 1  ON 5
ci_007                 1.858895e-02 3 1  ON 6
ci_008                 1.898120e-02 3 1  ON 7
ci_009                -1.495592e-02 3 1  ON 8
ci_010                -1.470878e-02 3 1  ON 9
ci_011                -1.253339e-02 3 1  ON 10
ci_012                -1.212062e-02 3 1  ON 11
ci_013                 1.121137e-02 3 1  ON 12
ci_014                 1.099858e-02 3 1  ON 13
ci_015                 1.260838e-02 3 1  ON 14
ci_016                 1.239726e-02 3 1  ON 15
ci_017                 1.049847e-02 3 1  ON 16
ci_018                 1.047936e-02 3 1  ON 17
ci_019                 3.268780e-03 3 1  ON 18
ci_020                 3.484561e-03 3 1  ON 19
ci_021                -8.069130e-03 3 1  ON 20
ci_022                -8.280452e-03 3 1  ON 21
ci_023                 6.236413e-03 3 1  ON 22
ci_024                 6.337064e-03 3 1  ON 23
ci_025                 9.039874e-03 3 1  ON 24
ci_026                 8.953005e-03 3 1  ON 25
ci_027                 6.585594e-03 3 1  ON 26
ci_028                 6.651501e-03 3 1  ON 27
ci_029                -5.190533e-03 3 1  ON 28
ci_030                -5.154795e-03 3 1  ON 29
ci_031                -1.761207e-03 3 1  ON 30
ci_032                -1.721677e-03 3 1  ON 31
ci_033                 4.327294e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.737060e-03 3 1  ON 34
ci_036                 2.771039e-03 3 1  ON 35
ci_037                 4.702056e-03 3 1  ON 36
ci_038                 4.549763e-03 3 1  ON 37
ci_039                 4.574533e-03 3 1  ON 38
ci_040                 4.649390e-03 3 1  ON 39
ci_041                 3.713202e-03 3 1  ON 40
ci_042                 3.564730e-03 3 1  ON 41
ci_043                 3.872293e-03 3 1  ON 42
ci_044                 4.055261e-03 3 1  ON 43
ci_045                 3.214074e-03 3 1  ON 44
ci_046                 3.196764e-03 3 1  ON 45
ci_047                -1.607691e-03 3 1  ON 46
ci_048                -1.717927e-03 3 1  ON 47
ci_049                 1.399992e-03 3 1  ON 48
ci_050                 1.488466e-03 3 1  ON 49
ci_051                -2.174186e-03 3 1  ON 50
ci_052                -2.076790e-03 3 1  ON 51
ci_053                -2.236105e-03 3 1  ON 52
ci_054                -2.386041e-03 3 1  ON 53
ci_055                -1.129113e-03 3 1  ON 54
ci_056                -1.636020e-03 3 1  ON 55
ci_057                -1.221266e-03 3 1  ON 56
ci_058                -1.464354e-03 3 1  ON 57
ci_059                -8.260812e-04 3 1  ON 58
ci_060                -6.616402e-04 3 1  ON 59
ci_061                -9.770877e-04 3 1  ON 60
ci_062                -7.222019e-04 3 1  ON 61
ci_063                -6.060915e-04 3 1  ON 62
ci_064                -7.521047e-04 3 1  ON 63
ci_065                -1.915586e-03 3 1  ON 64
ci_066                -2.110225e-03 3 1  ON 65
ci_067                -1.463976e-03 3 1  ON 66
ci_068                -1.105670e-03 3 1  ON 67
ci_069                -1.830955e-05 3 1  ON 68
ci_070                 1.325674e-04 3 1  ON 69
ci_071                -1.880849e-03 3 1  ON 70
ci_072                -1.750554e-03 3 1  ON 71
ci_073                 5.033409e-04 3 1  ON 72
ci_074                 4.904013e-04 3 1  ON 73
ci_075                -1.862224e-04 3 1  ON 74
ci_076                -1.192136e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6213
    reference variance = 0.345143
====================================================
  Execution time = 4.9819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9979e-01
  Total weights = 1.9550e+06
  Execution time = 7.2272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487616591282
                                         uncertainty =       0.003023002149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487616591282
                                         uncertainty =       0.003023002149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493713210
  error estimate for blocks of size 2^( 2) =       0.000511900589
  error estimate for blocks of size 2^( 3) =       0.000527651244
  error estimate for blocks of size 2^( 4) =       0.000539866360
  error estimate for blocks of size 2^( 5) =       0.000547367692
  error estimate for blocks of size 2^( 6) =       0.000549572729
  error estimate for blocks of size 2^( 7) =       0.000552401861

      target function =      -0.610849835266
              le_mean =     -22.668923010321
             les_mean =     514.379863624138
             stat err =       0.000547302160
             autocorr =       1.228866852769
   target nu stat err =       0.000547302160
   target dn stat err =       0.004042364929
      target stat err =       0.001254973826
              std dev =       0.698215917590
             le_variance =       0.487505467576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487615065257
                                         uncertainty =       0.003023031246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487615065257
                                         uncertainty =       0.003023031246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493712438
  error estimate for blocks of size 2^( 2) =       0.000511899802
  error estimate for blocks of size 2^( 3) =       0.000527650431
  error estimate for blocks of size 2^( 4) =       0.000539865506
  error estimate for blocks of size 2^( 5) =       0.000547366826
  error estimate for blocks of size 2^( 6) =       0.000549571871
  error estimate for blocks of size 2^( 7) =       0.000552401006

      target function =      -0.610850614297
              le_mean =     -22.668923022628
             les_mean =     514.379861621867
             stat err =       0.000547301302
             autocorr =       1.228866843779
   target nu stat err =       0.000547301302
   target dn stat err =       0.004042396598
      target stat err =       0.001254986244
              std dev =       0.698214825040
             le_variance =       0.487503941905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487615828044
                                         uncertainty =       0.003023016697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487615828044
                                         uncertainty =       0.003023016697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493712824
  error estimate for blocks of size 2^( 2) =       0.000511900196
  error estimate for blocks of size 2^( 3) =       0.000527650837
  error estimate for blocks of size 2^( 4) =       0.000539865933
  error estimate for blocks of size 2^( 5) =       0.000547367259
  error estimate for blocks of size 2^( 6) =       0.000549572300
  error estimate for blocks of size 2^( 7) =       0.000552401433

      target function =      -0.610850225834
              le_mean =     -22.668923016460
             les_mean =     514.379862618854
             stat err =       0.000547301731
             autocorr =       1.228866848277
   target nu stat err =       0.000547301731
   target dn stat err =       0.004042380719
      target stat err =       0.001254980026
              std dev =       0.698215371153
             le_variance =       0.487504704515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487616495864
                                         uncertainty =       0.003023003968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487616495864
                                         uncertainty =       0.003023003968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493713162
  error estimate for blocks of size 2^( 2) =       0.000511900540
  error estimate for blocks of size 2^( 3) =       0.000527651194
  error estimate for blocks of size 2^( 4) =       0.000539866306
  error estimate for blocks of size 2^( 5) =       0.000547367638
  error estimate for blocks of size 2^( 6) =       0.000549572675
  error estimate for blocks of size 2^( 7) =       0.000552401807

      target function =      -0.610849884197
              le_mean =     -22.668923011087
             les_mean =     514.379863498036
             stat err =       0.000547302107
             autocorr =       1.228866852216
   target nu stat err =       0.000547302107
   target dn stat err =       0.004042366897
      target stat err =       0.001254974600
              std dev =       0.698215849275
             le_variance =       0.487505372179


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610849835266        initial
     1.4552e+02     1.4552e+03             2.1870e-06        -0.610850614297  <--
     5.8208e+02     5.8208e+03             5.4687e-07        -0.610850225834
     2.3283e+03     2.3283e+04             1.3672e-07        -0.610849884197

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 8.6079e+01
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364077e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330848e-02 3 1  ON 4
ci_006                 2.338097e-02 3 1  ON 5
ci_007                 1.858785e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470819e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211971e-02 3 1  ON 11
ci_013                 1.121074e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260774e-02 3 1  ON 14
ci_016                 1.239654e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268290e-03 3 1  ON 18
ci_020                 3.483698e-03 3 1  ON 19
ci_021                -8.069006e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236750e-03 3 1  ON 22
ci_024                 6.336941e-03 3 1  ON 23
ci_025                 9.040274e-03 3 1  ON 24
ci_026                 8.953080e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190330e-03 3 1  ON 28
ci_030                -5.154909e-03 3 1  ON 29
ci_031                -1.760765e-03 3 1  ON 30
ci_032                -1.720987e-03 3 1  ON 31
ci_033                 4.327072e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736838e-03 3 1  ON 34
ci_036                 2.770822e-03 3 1  ON 35
ci_037                 4.702137e-03 3 1  ON 36
ci_038                 4.549573e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649414e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564837e-03 3 1  ON 41
ci_043                 3.872169e-03 3 1  ON 42
ci_044                 4.055215e-03 3 1  ON 43
ci_045                 3.213814e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607600e-03 3 1  ON 46
ci_048                -1.717717e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488382e-03 3 1  ON 49
ci_051                -2.173866e-03 3 1  ON 50
ci_052                -2.076687e-03 3 1  ON 51
ci_053                -2.236145e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129031e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464193e-03 3 1  ON 57
ci_059                -8.259875e-04 3 1  ON 58
ci_060                -6.614111e-04 3 1  ON 59
ci_061                -9.769536e-04 3 1  ON 60
ci_062                -7.221514e-04 3 1  ON 61
ci_063                -6.062539e-04 3 1  ON 62
ci_064                -7.520616e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105581e-03 3 1  ON 67
ci_069                -1.833704e-05 3 1  ON 68
ci_070                 1.324099e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032116e-04 3 1  ON 72
ci_074                 4.904868e-04 3 1  ON 73
ci_075                -1.860265e-04 3 1  ON 74
ci_076                -1.192335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4731e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.5966
    reference variance = 0.468689
====================================================
  Execution time = 5.1296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9315e-01
  Total weights = 1.955345474e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481869877772
                                         uncertainty =       0.002384604654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481869877772
                                         uncertainty =       0.002384604654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490871443
  error estimate for blocks of size 2^( 2) =       0.000509823762
  error estimate for blocks of size 2^( 3) =       0.000526589259
  error estimate for blocks of size 2^( 4) =       0.000538993056
  error estimate for blocks of size 2^( 5) =       0.000545723835
  error estimate for blocks of size 2^( 6) =       0.000548415583
  error estimate for blocks of size 2^( 7) =       0.000550321579

      target function =      -0.612837643477
              le_mean =     -22.668790314783
             les_mean =     514.367202497370
             stat err =       0.000545863513
             autocorr =       1.236609551944
   target nu stat err =       0.000545863513
   target dn stat err =       0.003424693739
      target stat err =       0.001079431374
              std dev =       0.694197052668
             le_variance =       0.481909547933


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266879031478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612839264424       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612840050041       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612840140468       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612840161606       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612840167963       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612840170980       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612840171413       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612840171453       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612840171327       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612840171312       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+01 is 7.955862e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612839264424       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612839460985       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612839483599       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612839488885       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612839490473       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612839491226       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612839491334       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612839491344       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612839491313       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612839491309       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+02 is 1.990641e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612839264424       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612839313574       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612839319228       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612839320550       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612839320946       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612839321135       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612839321162       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612839321164       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612839321157       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612839321155       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+02 is 4.977652e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.868852 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0669e+01
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_001                -7.044647e-01 3 1  ON 0
ci_002                -7.027639e-01 3 1  ON 1
ci_003                -5.363921e-02 3 1  ON 2
ci_004                -5.404115e-02 3 1  ON 3
ci_005                 2.330649e-02 3 1  ON 4
ci_006                 2.337909e-02 3 1  ON 5
ci_007                 1.858656e-02 3 1  ON 6
ci_008                 1.897849e-02 3 1  ON 7
ci_009                -1.495408e-02 3 1  ON 8
ci_010                -1.470722e-02 3 1  ON 9
ci_011                -1.253157e-02 3 1  ON 10
ci_012                -1.211873e-02 3 1  ON 11
ci_013                 1.120991e-02 3 1  ON 12
ci_014                 1.099696e-02 3 1  ON 13
ci_015                 1.260659e-02 3 1  ON 14
ci_016                 1.239553e-02 3 1  ON 15
ci_017                 1.049744e-02 3 1  ON 16
ci_018                 1.047825e-02 3 1  ON 17
ci_019                 3.267229e-03 3 1  ON 18
ci_020                 3.483177e-03 3 1  ON 19
ci_021                -8.069125e-03 3 1  ON 20
ci_022                -8.280131e-03 3 1  ON 21
ci_023                 6.236679e-03 3 1  ON 22
ci_024                 6.336791e-03 3 1  ON 23
ci_025                 9.040073e-03 3 1  ON 24
ci_026                 8.953066e-03 3 1  ON 25
ci_027                 6.585371e-03 3 1  ON 26
ci_028                 6.651104e-03 3 1  ON 27
ci_029                -5.190083e-03 3 1  ON 28
ci_030                -5.154664e-03 3 1  ON 29
ci_031                -1.759878e-03 3 1  ON 30
ci_032                -1.720469e-03 3 1  ON 31
ci_033                 4.326599e-03 3 1  ON 32
ci_034                 4.225366e-03 3 1  ON 33
ci_035                 2.736663e-03 3 1  ON 34
ci_036                 2.770391e-03 3 1  ON 35
ci_037                 4.701861e-03 3 1  ON 36
ci_038                 4.549773e-03 3 1  ON 37
ci_039                 4.574514e-03 3 1  ON 38
ci_040                 4.649584e-03 3 1  ON 39
ci_041                 3.712814e-03 3 1  ON 40
ci_042                 3.564790e-03 3 1  ON 41
ci_043                 3.871845e-03 3 1  ON 42
ci_044                 4.054894e-03 3 1  ON 43
ci_045                 3.213744e-03 3 1  ON 44
ci_046                 3.196660e-03 3 1  ON 45
ci_047                -1.607450e-03 3 1  ON 46
ci_048                -1.717408e-03 3 1  ON 47
ci_049                 1.399456e-03 3 1  ON 48
ci_050                 1.488363e-03 3 1  ON 49
ci_051                -2.173503e-03 3 1  ON 50
ci_052                -2.076424e-03 3 1  ON 51
ci_053                -2.236349e-03 3 1  ON 52
ci_054                -2.385926e-03 3 1  ON 53
ci_055                -1.129616e-03 3 1  ON 54
ci_056                -1.635722e-03 3 1  ON 55
ci_057                -1.221281e-03 3 1  ON 56
ci_058                -1.464055e-03 3 1  ON 57
ci_059                -8.256061e-04 3 1  ON 58
ci_060                -6.613905e-04 3 1  ON 59
ci_061                -9.768442e-04 3 1  ON 60
ci_062                -7.222255e-04 3 1  ON 61
ci_063                -6.059935e-04 3 1  ON 62
ci_064                -7.512725e-04 3 1  ON 63
ci_065                -1.915748e-03 3 1  ON 64
ci_066                -2.110175e-03 3 1  ON 65
ci_067                -1.464043e-03 3 1  ON 66
ci_068                -1.105814e-03 3 1  ON 67
ci_069                -1.842345e-05 3 1  ON 68
ci_070                 1.322762e-04 3 1  ON 69
ci_071                -1.881030e-03 3 1  ON 70
ci_072                -1.750516e-03 3 1  ON 71
ci_073                 5.029295e-04 3 1  ON 72
ci_074                 4.905666e-04 3 1  ON 73
ci_075                -1.858557e-04 3 1  ON 74
ci_076                -1.190071e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8249
    reference variance = 0.442854
====================================================
  Execution time = 4.9719e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9446e-01
  Total weights = 1.9550e+06
  Execution time = 7.2175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482750505448
                                         uncertainty =       0.002179850139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482750505448
                                         uncertainty =       0.002179850139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491324581
  error estimate for blocks of size 2^( 2) =       0.000509481269
  error estimate for blocks of size 2^( 3) =       0.000525840212
  error estimate for blocks of size 2^( 4) =       0.000537459878
  error estimate for blocks of size 2^( 5) =       0.000544072141
  error estimate for blocks of size 2^( 6) =       0.000546152079
  error estimate for blocks of size 2^( 7) =       0.000548043411

      target function =      -0.612171288669
              le_mean =     -22.667709570947
             les_mean =     514.319495830646
             stat err =       0.000543931877
             autocorr =       1.225609275849
   target nu stat err =       0.000543931877
   target dn stat err =       0.003270110245
      target stat err =       0.001030536660
              std dev =       0.694837885333
             le_variance =       0.482799686894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482745068419
                                         uncertainty =       0.002179885838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482745068419
                                         uncertainty =       0.002179885838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491321809
  error estimate for blocks of size 2^( 2) =       0.000509478512
  error estimate for blocks of size 2^( 3) =       0.000525837523
  error estimate for blocks of size 2^( 4) =       0.000537457098
  error estimate for blocks of size 2^( 5) =       0.000544069221
  error estimate for blocks of size 2^( 6) =       0.000546149110
  error estimate for blocks of size 2^( 7) =       0.000548040207

      target function =      -0.612099052447
              le_mean =     -22.667709591374
             les_mean =     514.319734284940
             stat err =       0.000543928909
             autocorr =       1.225609725249
   target nu stat err =       0.000543928909
   target dn stat err =       0.003286293483
      target stat err =       0.001035050455
              std dev =       0.694833966146
             le_variance =       0.482794240511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482747783714
                                         uncertainty =       0.002179867971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482747783714
                                         uncertainty =       0.002179867971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491323193
  error estimate for blocks of size 2^( 2) =       0.000509479889
  error estimate for blocks of size 2^( 3) =       0.000525838867
  error estimate for blocks of size 2^( 4) =       0.000537458487
  error estimate for blocks of size 2^( 5) =       0.000544070681
  error estimate for blocks of size 2^( 6) =       0.000546150594
  error estimate for blocks of size 2^( 7) =       0.000548041812

      target function =      -0.612152073635
              le_mean =     -22.667709581513
             les_mean =     514.319559496420
             stat err =       0.000543930394
             autocorr =       1.225609510342
   target nu stat err =       0.000543930394
   target dn stat err =       0.003272964325
      target stat err =       0.001031311574
              std dev =       0.694835923422
             le_variance =       0.482796960477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482750165034
                                         uncertainty =       0.002179852366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482750165034
                                         uncertainty =       0.002179852366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491324407
  error estimate for blocks of size 2^( 2) =       0.000509481097
  error estimate for blocks of size 2^( 3) =       0.000525840043
  error estimate for blocks of size 2^( 4) =       0.000537459704
  error estimate for blocks of size 2^( 5) =       0.000544071959
  error estimate for blocks of size 2^( 6) =       0.000546151894
  error estimate for blocks of size 2^( 7) =       0.000548043211

      target function =      -0.612169655156
              le_mean =     -22.667709572284
             les_mean =     514.319501263264
             stat err =       0.000543931692
             autocorr =       1.225609305734
   target nu stat err =       0.000543931692
   target dn stat err =       0.003270302888
      target stat err =       0.001030587862
              std dev =       0.694837639953
             le_variance =       0.482799345895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.612171288669        initial  <--
     3.6380e+01     3.6380e+02             7.9559e-06        -0.612099052447
     1.4552e+02     1.4552e+03             1.9906e-06        -0.612152073635
     5.8208e+02     5.8208e+03             4.9777e-07        -0.612169655156

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 85.9592
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364077e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330848e-02 3 1  ON 4
ci_006                 2.338097e-02 3 1  ON 5
ci_007                 1.858785e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470819e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211971e-02 3 1  ON 11
ci_013                 1.121074e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260774e-02 3 1  ON 14
ci_016                 1.239654e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268290e-03 3 1  ON 18
ci_020                 3.483698e-03 3 1  ON 19
ci_021                -8.069006e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236750e-03 3 1  ON 22
ci_024                 6.336941e-03 3 1  ON 23
ci_025                 9.040274e-03 3 1  ON 24
ci_026                 8.953080e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190330e-03 3 1  ON 28
ci_030                -5.154909e-03 3 1  ON 29
ci_031                -1.760765e-03 3 1  ON 30
ci_032                -1.720987e-03 3 1  ON 31
ci_033                 4.327072e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736838e-03 3 1  ON 34
ci_036                 2.770822e-03 3 1  ON 35
ci_037                 4.702137e-03 3 1  ON 36
ci_038                 4.549573e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649414e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564837e-03 3 1  ON 41
ci_043                 3.872169e-03 3 1  ON 42
ci_044                 4.055215e-03 3 1  ON 43
ci_045                 3.213814e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607600e-03 3 1  ON 46
ci_048                -1.717717e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488382e-03 3 1  ON 49
ci_051                -2.173866e-03 3 1  ON 50
ci_052                -2.076687e-03 3 1  ON 51
ci_053                -2.236145e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129031e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464193e-03 3 1  ON 57
ci_059                -8.259875e-04 3 1  ON 58
ci_060                -6.614111e-04 3 1  ON 59
ci_061                -9.769536e-04 3 1  ON 60
ci_062                -7.221514e-04 3 1  ON 61
ci_063                -6.062539e-04 3 1  ON 62
ci_064                -7.520616e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105581e-03 3 1  ON 67
ci_069                -1.833704e-05 3 1  ON 68
ci_070                 1.324099e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032116e-04 3 1  ON 72
ci_074                 4.904868e-04 3 1  ON 73
ci_075                -1.860265e-04 3 1  ON 74
ci_076                -1.192335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4664e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.7527
    reference variance = 0.82818
====================================================
  Execution time = 5.2195e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1199e-01
  Total weights = 1.954926291e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491540604508
                                         uncertainty =       0.005188710230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491540604508
                                         uncertainty =       0.005188710230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495768493
  error estimate for blocks of size 2^( 2) =       0.000514423746
  error estimate for blocks of size 2^( 3) =       0.000531157463
  error estimate for blocks of size 2^( 4) =       0.000542877460
  error estimate for blocks of size 2^( 5) =       0.000550131982
  error estimate for blocks of size 2^( 6) =       0.000553190668
  error estimate for blocks of size 2^( 7) =       0.000554154682

      target function =      -0.606921863680
              le_mean =     -22.667985937570
             les_mean =     514.349577603959
             stat err =       0.000550088698
             autocorr =       1.231140442816
   target nu stat err =       0.000550088698
   target dn stat err =       0.013434846426
      target stat err =       0.004026127835
              std dev =       0.701122526618
             le_variance =       0.491572797332


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266798593757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.606948386537       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.606948483168       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.606948494329       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.606948495831       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.606948496266       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.606948496522       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.606948496531       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.606948496588       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.606948496597       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.606948496606       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+02 is 9.425488e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.606948386537       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.606948410697       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.606948413487       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.606948413863       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.606948413972       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.606948414034       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.606948414038       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.606948414051       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.606948414052       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.606948414056       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+03 is 2.356567e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.606948386537       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.606948392577       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.606948393275       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.606948393369       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.606948393399       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.606948393421       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.606948393415       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.606948393414       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.606948393415       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.606948393419       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+03 is 5.891538e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.874078 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1604e+01
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_001                -7.044633e-01 3 1  ON 0
ci_002                -7.027647e-01 3 1  ON 1
ci_003                -5.364062e-02 3 1  ON 2
ci_004                -5.404221e-02 3 1  ON 3
ci_005                 2.330825e-02 3 1  ON 4
ci_006                 2.338073e-02 3 1  ON 5
ci_007                 1.858769e-02 3 1  ON 6
ci_008                 1.897970e-02 3 1  ON 7
ci_009                -1.495497e-02 3 1  ON 8
ci_010                -1.470807e-02 3 1  ON 9
ci_011                -1.253221e-02 3 1  ON 10
ci_012                -1.211960e-02 3 1  ON 11
ci_013                 1.121066e-02 3 1  ON 12
ci_014                 1.099774e-02 3 1  ON 13
ci_015                 1.260769e-02 3 1  ON 14
ci_016                 1.239648e-02 3 1  ON 15
ci_017                 1.049804e-02 3 1  ON 16
ci_018                 1.047874e-02 3 1  ON 17
ci_019                 3.268142e-03 3 1  ON 18
ci_020                 3.483602e-03 3 1  ON 19
ci_021                -8.068941e-03 3 1  ON 20
ci_022                -8.280556e-03 3 1  ON 21
ci_023                 6.236711e-03 3 1  ON 22
ci_024                 6.336880e-03 3 1  ON 23
ci_025                 9.040210e-03 3 1  ON 24
ci_026                 8.953106e-03 3 1  ON 25
ci_027                 6.585400e-03 3 1  ON 26
ci_028                 6.651310e-03 3 1  ON 27
ci_029                -5.190304e-03 3 1  ON 28
ci_030                -5.154899e-03 3 1  ON 29
ci_031                -1.760729e-03 3 1  ON 30
ci_032                -1.720925e-03 3 1  ON 31
ci_033                 4.327065e-03 3 1  ON 32
ci_034                 4.225732e-03 3 1  ON 33
ci_035                 2.736789e-03 3 1  ON 34
ci_036                 2.770793e-03 3 1  ON 35
ci_037                 4.702072e-03 3 1  ON 36
ci_038                 4.549555e-03 3 1  ON 37
ci_039                 4.574578e-03 3 1  ON 38
ci_040                 4.649410e-03 3 1  ON 39
ci_041                 3.713175e-03 3 1  ON 40
ci_042                 3.564824e-03 3 1  ON 41
ci_043                 3.872145e-03 3 1  ON 42
ci_044                 4.055203e-03 3 1  ON 43
ci_045                 3.213794e-03 3 1  ON 44
ci_046                 3.196821e-03 3 1  ON 45
ci_047                -1.607596e-03 3 1  ON 46
ci_048                -1.717684e-03 3 1  ON 47
ci_049                 1.399654e-03 3 1  ON 48
ci_050                 1.488428e-03 3 1  ON 49
ci_051                -2.173888e-03 3 1  ON 50
ci_052                -2.076698e-03 3 1  ON 51
ci_053                -2.236126e-03 3 1  ON 52
ci_054                -2.386090e-03 3 1  ON 53
ci_055                -1.129064e-03 3 1  ON 54
ci_056                -1.635944e-03 3 1  ON 55
ci_057                -1.221570e-03 3 1  ON 56
ci_058                -1.464195e-03 3 1  ON 57
ci_059                -8.259810e-04 3 1  ON 58
ci_060                -6.614248e-04 3 1  ON 59
ci_061                -9.769117e-04 3 1  ON 60
ci_062                -7.221250e-04 3 1  ON 61
ci_063                -6.062377e-04 3 1  ON 62
ci_064                -7.520716e-04 3 1  ON 63
ci_065                -1.915708e-03 3 1  ON 64
ci_066                -2.110282e-03 3 1  ON 65
ci_067                -1.464135e-03 3 1  ON 66
ci_068                -1.105616e-03 3 1  ON 67
ci_069                -1.831306e-05 3 1  ON 68
ci_070                 1.323962e-04 3 1  ON 69
ci_071                -1.880865e-03 3 1  ON 70
ci_072                -1.750578e-03 3 1  ON 71
ci_073                 5.031813e-04 3 1  ON 72
ci_074                 4.904870e-04 3 1  ON 73
ci_075                -1.860241e-04 3 1  ON 74
ci_076                -1.192366e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.679
    reference variance = 0.354901
====================================================
  Execution time = 4.9879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9857e-01
  Total weights = 1.9553e+06
  Execution time = 7.2383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486557885210
                                         uncertainty =       0.002545560727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486557885210
                                         uncertainty =       0.002545560727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493194817
  error estimate for blocks of size 2^( 2) =       0.000511466361
  error estimate for blocks of size 2^( 3) =       0.000528152272
  error estimate for blocks of size 2^( 4) =       0.000540031520
  error estimate for blocks of size 2^( 5) =       0.000545581449
  error estimate for blocks of size 2^( 6) =       0.000549705508
  error estimate for blocks of size 2^( 7) =       0.000551265908

      target function =      -0.610889786015
              le_mean =     -22.667594536353
             les_mean =     514.318408484622
             stat err =       0.000546646096
             autocorr =       1.228500945813
   target nu stat err =       0.000546646096
   target dn stat err =       0.003204869350
      target stat err =       0.001007591401
              std dev =       0.697482798453
             le_variance =       0.486482254137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486557289077
                                         uncertainty =       0.002545557963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486557289077
                                         uncertainty =       0.002545557963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493194515
  error estimate for blocks of size 2^( 2) =       0.000511466059
  error estimate for blocks of size 2^( 3) =       0.000528151965
  error estimate for blocks of size 2^( 4) =       0.000540031208
  error estimate for blocks of size 2^( 5) =       0.000545581136
  error estimate for blocks of size 2^( 6) =       0.000549705181
  error estimate for blocks of size 2^( 7) =       0.000551265631

      target function =      -0.610889771625
              le_mean =     -22.667594531982
             les_mean =     514.318408329747
             stat err =       0.000546645789
             autocorr =       1.228501068653
   target nu stat err =       0.000546645789
   target dn stat err =       0.003205064271
      target stat err =       0.001007648161
              std dev =       0.697482371577
             le_variance =       0.486481658661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486557587107
                                         uncertainty =       0.002545559345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486557587107
                                         uncertainty =       0.002545559345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493194666
  error estimate for blocks of size 2^( 2) =       0.000511466210
  error estimate for blocks of size 2^( 3) =       0.000528152118
  error estimate for blocks of size 2^( 4) =       0.000540031364
  error estimate for blocks of size 2^( 5) =       0.000545581292
  error estimate for blocks of size 2^( 6) =       0.000549705345
  error estimate for blocks of size 2^( 7) =       0.000551265770

      target function =      -0.610889779158
              le_mean =     -22.667594534164
             les_mean =     514.318408405940
             stat err =       0.000546645943
             autocorr =       1.228501007232
   target nu stat err =       0.000546645943
   target dn stat err =       0.003204966752
      target stat err =       0.001007619765
              std dev =       0.697482584988
             le_variance =       0.486481956362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486557847945
                                         uncertainty =       0.002545560554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486557847945
                                         uncertainty =       0.002545560554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493194798
  error estimate for blocks of size 2^( 2) =       0.000511466342
  error estimate for blocks of size 2^( 3) =       0.000528152253
  error estimate for blocks of size 2^( 4) =       0.000540031501
  error estimate for blocks of size 2^( 5) =       0.000545581430
  error estimate for blocks of size 2^( 6) =       0.000549705487
  error estimate for blocks of size 2^( 7) =       0.000551265891

      target function =      -0.610889785196
              le_mean =     -22.667594536079
             les_mean =     514.318408474651
             stat err =       0.000546646077
             autocorr =       1.228500953489
   target nu stat err =       0.000546646077
   target dn stat err =       0.003204881518
      target stat err =       0.001007594944
              std dev =       0.697482771768
             le_variance =       0.486482216913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610889786015        initial  <--
     3.6380e+02     3.6380e+03             9.4255e-07        -0.610889771625
     1.4552e+03     1.4552e+04             2.3566e-07        -0.610889779158
     5.8208e+03     5.8208e+04             5.8915e-08        -0.610889785196

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 86.1902
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364077e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330848e-02 3 1  ON 4
ci_006                 2.338097e-02 3 1  ON 5
ci_007                 1.858785e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470819e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211971e-02 3 1  ON 11
ci_013                 1.121074e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260774e-02 3 1  ON 14
ci_016                 1.239654e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268290e-03 3 1  ON 18
ci_020                 3.483698e-03 3 1  ON 19
ci_021                -8.069006e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236750e-03 3 1  ON 22
ci_024                 6.336941e-03 3 1  ON 23
ci_025                 9.040274e-03 3 1  ON 24
ci_026                 8.953080e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190330e-03 3 1  ON 28
ci_030                -5.154909e-03 3 1  ON 29
ci_031                -1.760765e-03 3 1  ON 30
ci_032                -1.720987e-03 3 1  ON 31
ci_033                 4.327072e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736838e-03 3 1  ON 34
ci_036                 2.770822e-03 3 1  ON 35
ci_037                 4.702137e-03 3 1  ON 36
ci_038                 4.549573e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649414e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564837e-03 3 1  ON 41
ci_043                 3.872169e-03 3 1  ON 42
ci_044                 4.055215e-03 3 1  ON 43
ci_045                 3.213814e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607600e-03 3 1  ON 46
ci_048                -1.717717e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488382e-03 3 1  ON 49
ci_051                -2.173866e-03 3 1  ON 50
ci_052                -2.076687e-03 3 1  ON 51
ci_053                -2.236145e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129031e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464193e-03 3 1  ON 57
ci_059                -8.259875e-04 3 1  ON 58
ci_060                -6.614111e-04 3 1  ON 59
ci_061                -9.769536e-04 3 1  ON 60
ci_062                -7.221514e-04 3 1  ON 61
ci_063                -6.062539e-04 3 1  ON 62
ci_064                -7.520616e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105581e-03 3 1  ON 67
ci_069                -1.833704e-05 3 1  ON 68
ci_070                 1.324099e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032116e-04 3 1  ON 72
ci_074                 4.904868e-04 3 1  ON 73
ci_075                -1.860265e-04 3 1  ON 74
ci_076                -1.192335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4780e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.6577
    reference variance = 0.311258
====================================================
  Execution time = 5.1304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0669e-01
  Total weights = 1.955154357e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490829330033
                                         uncertainty =       0.003317890753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490829330033
                                         uncertainty =       0.003317890753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495384547
  error estimate for blocks of size 2^( 2) =       0.000513645923
  error estimate for blocks of size 2^( 3) =       0.000530433241
  error estimate for blocks of size 2^( 4) =       0.000542551524
  error estimate for blocks of size 2^( 5) =       0.000549077597
  error estimate for blocks of size 2^( 6) =       0.000552774902
  error estimate for blocks of size 2^( 7) =       0.000555056370

      target function =      -0.608705143801
              le_mean =     -22.668688873584
             les_mean =     514.376147870615
             stat err =       0.000549865098
             autocorr =       1.232047347663
   target nu stat err =       0.000549865098
   target dn stat err =       0.005954879910
      target stat err =       0.001812437591
              std dev =       0.700579545465
             le_variance =       0.490811699524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266868887358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608710262747       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608710271775       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608710272879       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608710272987       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608710273013       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608710273009       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608710273027       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608710273023       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608710273018       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608710273022       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+03 is 7.938537e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608710262747       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608710265004       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608710265280       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608710265300       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608710265299       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608710265314       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608710265315       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608710265286       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608710265284       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608710265312       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+04 is 1.984651e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.608710262747       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.608710263311       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.608710263380       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.608710263408       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.608710263391       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.608710263418       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.608710263426       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.608710263368       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.608710263224       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.608710263217       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+04 is 4.961637e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.879143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0688e+01
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364075e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330846e-02 3 1  ON 4
ci_006                 2.338095e-02 3 1  ON 5
ci_007                 1.858783e-02 3 1  ON 6
ci_008                 1.897985e-02 3 1  ON 7
ci_009                -1.495507e-02 3 1  ON 8
ci_010                -1.470818e-02 3 1  ON 9
ci_011                -1.253230e-02 3 1  ON 10
ci_012                -1.211970e-02 3 1  ON 11
ci_013                 1.121073e-02 3 1  ON 12
ci_014                 1.099781e-02 3 1  ON 13
ci_015                 1.260773e-02 3 1  ON 14
ci_016                 1.239653e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268283e-03 3 1  ON 18
ci_020                 3.483688e-03 3 1  ON 19
ci_021                -8.069007e-03 3 1  ON 20
ci_022                -8.280588e-03 3 1  ON 21
ci_023                 6.236751e-03 3 1  ON 22
ci_024                 6.336941e-03 3 1  ON 23
ci_025                 9.040272e-03 3 1  ON 24
ci_026                 8.953091e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651337e-03 3 1  ON 27
ci_029                -5.190330e-03 3 1  ON 28
ci_030                -5.154907e-03 3 1  ON 29
ci_031                -1.760755e-03 3 1  ON 30
ci_032                -1.720976e-03 3 1  ON 31
ci_033                 4.327069e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736835e-03 3 1  ON 34
ci_036                 2.770817e-03 3 1  ON 35
ci_037                 4.702136e-03 3 1  ON 36
ci_038                 4.549564e-03 3 1  ON 37
ci_039                 4.574579e-03 3 1  ON 38
ci_040                 4.649413e-03 3 1  ON 39
ci_041                 3.713183e-03 3 1  ON 40
ci_042                 3.564835e-03 3 1  ON 41
ci_043                 3.872164e-03 3 1  ON 42
ci_044                 4.055210e-03 3 1  ON 43
ci_045                 3.213815e-03 3 1  ON 44
ci_046                 3.196822e-03 3 1  ON 45
ci_047                -1.607598e-03 3 1  ON 46
ci_048                -1.717713e-03 3 1  ON 47
ci_049                 1.399630e-03 3 1  ON 48
ci_050                 1.488379e-03 3 1  ON 49
ci_051                -2.173865e-03 3 1  ON 50
ci_052                -2.076677e-03 3 1  ON 51
ci_053                -2.236144e-03 3 1  ON 52
ci_054                -2.386086e-03 3 1  ON 53
ci_055                -1.129029e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221583e-03 3 1  ON 56
ci_058                -1.464187e-03 3 1  ON 57
ci_059                -8.259888e-04 3 1  ON 58
ci_060                -6.614095e-04 3 1  ON 59
ci_061                -9.769519e-04 3 1  ON 60
ci_062                -7.221544e-04 3 1  ON 61
ci_063                -6.062543e-04 3 1  ON 62
ci_064                -7.520763e-04 3 1  ON 63
ci_065                -1.915681e-03 3 1  ON 64
ci_066                -2.110264e-03 3 1  ON 65
ci_067                -1.464148e-03 3 1  ON 66
ci_068                -1.105584e-03 3 1  ON 67
ci_069                -1.833758e-05 3 1  ON 68
ci_070                 1.324083e-04 3 1  ON 69
ci_071                -1.880848e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032079e-04 3 1  ON 72
ci_074                 4.904842e-04 3 1  ON 73
ci_075                -1.860222e-04 3 1  ON 74
ci_076                -1.192290e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.6893
    reference variance = 0.376682
====================================================
  Execution time = 4.9802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0128e-01
  Total weights = 1.9552e+06
  Execution time = 7.2266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488053377806
                                         uncertainty =       0.002779766413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488053377806
                                         uncertainty =       0.002779766413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493943854
  error estimate for blocks of size 2^( 2) =       0.000512497857
  error estimate for blocks of size 2^( 3) =       0.000528893327
  error estimate for blocks of size 2^( 4) =       0.000540598518
  error estimate for blocks of size 2^( 5) =       0.000546614680
  error estimate for blocks of size 2^( 6) =       0.000550939866
  error estimate for blocks of size 2^( 7) =       0.000553000310

      target function =      -0.610260101230
              le_mean =     -22.668366313682
             les_mean =     514.356114166255
             stat err =       0.000547788344
             autocorr =       1.229901700724
   target nu stat err =       0.000547788344
   target dn stat err =       0.003804090493
      target stat err =       0.001181861554
              std dev =       0.698542096913
             le_variance =       0.487961061159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488053326549
                                         uncertainty =       0.002779766115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488053326549
                                         uncertainty =       0.002779766115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493943828
  error estimate for blocks of size 2^( 2) =       0.000512497831
  error estimate for blocks of size 2^( 3) =       0.000528893302
  error estimate for blocks of size 2^( 4) =       0.000540598492
  error estimate for blocks of size 2^( 5) =       0.000546614654
  error estimate for blocks of size 2^( 6) =       0.000550939839
  error estimate for blocks of size 2^( 7) =       0.000553000282

      target function =      -0.610260098490
              le_mean =     -22.668366314222
             les_mean =     514.356114200254
             stat err =       0.000547788317
             autocorr =       1.229901710097
   target nu stat err =       0.000547788317
   target dn stat err =       0.003804088693
      target stat err =       0.001181861011
              std dev =       0.698542060224
             le_variance =       0.487961009902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488053352177
                                         uncertainty =       0.002779766264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488053352177
                                         uncertainty =       0.002779766264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493943841
  error estimate for blocks of size 2^( 2) =       0.000512497844
  error estimate for blocks of size 2^( 3) =       0.000528893315
  error estimate for blocks of size 2^( 4) =       0.000540598505
  error estimate for blocks of size 2^( 5) =       0.000546614667
  error estimate for blocks of size 2^( 6) =       0.000550939853
  error estimate for blocks of size 2^( 7) =       0.000553000296

      target function =      -0.610260099866
              le_mean =     -22.668366313952
             les_mean =     514.356114183232
             stat err =       0.000547788330
             autocorr =       1.229901705410
   target nu stat err =       0.000547788330
   target dn stat err =       0.003804089592
      target stat err =       0.001181861282
              std dev =       0.698542078568
             le_variance =       0.487961035530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488053374602
                                         uncertainty =       0.002779766394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488053374602
                                         uncertainty =       0.002779766394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493943852
  error estimate for blocks of size 2^( 2) =       0.000512497855
  error estimate for blocks of size 2^( 3) =       0.000528893326
  error estimate for blocks of size 2^( 4) =       0.000540598516
  error estimate for blocks of size 2^( 5) =       0.000546614678
  error estimate for blocks of size 2^( 6) =       0.000550939865
  error estimate for blocks of size 2^( 7) =       0.000553000309

      target function =      -0.610260101060
              le_mean =     -22.668366313716
             les_mean =     514.356114168374
             stat err =       0.000547788342
             autocorr =       1.229901701307
   target nu stat err =       0.000547788342
   target dn stat err =       0.003804090380
      target stat err =       0.001181861520
              std dev =       0.698542094620
             le_variance =       0.487961057956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610260101230        initial  <--
     3.6380e+03     3.6380e+04             7.9385e-08        -0.610260098490
     1.4552e+04     1.4552e+05             1.9847e-08        -0.610260099866
     5.8208e+04     5.8208e+05             4.9616e-09        -0.610260101060

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 86.0755
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364077e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330848e-02 3 1  ON 4
ci_006                 2.338097e-02 3 1  ON 5
ci_007                 1.858785e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470819e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211971e-02 3 1  ON 11
ci_013                 1.121074e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260774e-02 3 1  ON 14
ci_016                 1.239654e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268290e-03 3 1  ON 18
ci_020                 3.483698e-03 3 1  ON 19
ci_021                -8.069006e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236750e-03 3 1  ON 22
ci_024                 6.336941e-03 3 1  ON 23
ci_025                 9.040274e-03 3 1  ON 24
ci_026                 8.953080e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190330e-03 3 1  ON 28
ci_030                -5.154909e-03 3 1  ON 29
ci_031                -1.760765e-03 3 1  ON 30
ci_032                -1.720987e-03 3 1  ON 31
ci_033                 4.327072e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736838e-03 3 1  ON 34
ci_036                 2.770822e-03 3 1  ON 35
ci_037                 4.702137e-03 3 1  ON 36
ci_038                 4.549573e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649414e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564837e-03 3 1  ON 41
ci_043                 3.872169e-03 3 1  ON 42
ci_044                 4.055215e-03 3 1  ON 43
ci_045                 3.213814e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607600e-03 3 1  ON 46
ci_048                -1.717717e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488382e-03 3 1  ON 49
ci_051                -2.173866e-03 3 1  ON 50
ci_052                -2.076687e-03 3 1  ON 51
ci_053                -2.236145e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129031e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464193e-03 3 1  ON 57
ci_059                -8.259875e-04 3 1  ON 58
ci_060                -6.614111e-04 3 1  ON 59
ci_061                -9.769536e-04 3 1  ON 60
ci_062                -7.221514e-04 3 1  ON 61
ci_063                -6.062539e-04 3 1  ON 62
ci_064                -7.520616e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105581e-03 3 1  ON 67
ci_069                -1.833704e-05 3 1  ON 68
ci_070                 1.324099e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032116e-04 3 1  ON 72
ci_074                 4.904868e-04 3 1  ON 73
ci_075                -1.860265e-04 3 1  ON 74
ci_076                -1.192335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4677e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.6746
    reference variance = 0.409198
====================================================
  Execution time = 5.2236e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0109e-01
  Total weights = 1.954557078e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485000966335
                                         uncertainty =       0.002416015484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485000966335
                                         uncertainty =       0.002416015484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492417860
  error estimate for blocks of size 2^( 2) =       0.000511147106
  error estimate for blocks of size 2^( 3) =       0.000527434961
  error estimate for blocks of size 2^( 4) =       0.000540236854
  error estimate for blocks of size 2^( 5) =       0.000547972596
  error estimate for blocks of size 2^( 6) =       0.000553013407
  error estimate for blocks of size 2^( 7) =       0.000555624444

      target function =      -0.610536332290
              le_mean =     -22.669237110399
             les_mean =     514.395397778130
             stat err =       0.000549211825
             autocorr =       1.243976469977
   target nu stat err =       0.000549211825
   target dn stat err =       0.004093036018
      target stat err =       0.001269226156
              std dev =       0.696384016509
             le_variance =       0.484950698450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266923711040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610538678541       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610538679673       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610538679804       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610538679817       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610538679821       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610538679853       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610538679824       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610538679824       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610538679824       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610538679824       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+04 is 1.007188e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610538678541       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610538678824       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610538678857       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610538678879       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610538678711       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610538678862       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610538678862       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610538679087       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610538678862       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610538679104       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+05 is 2.517971e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610538678541       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610538678612       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610538678620       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610538678741       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610538678983       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610538678352       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610538677934       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610538677854       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610538677268       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610538678243       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+05 is 6.294929e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.884206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1593e+01
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364077e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330848e-02 3 1  ON 4
ci_006                 2.338097e-02 3 1  ON 5
ci_007                 1.858784e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470819e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211971e-02 3 1  ON 11
ci_013                 1.121073e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260773e-02 3 1  ON 14
ci_016                 1.239654e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268289e-03 3 1  ON 18
ci_020                 3.483697e-03 3 1  ON 19
ci_021                -8.069005e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236749e-03 3 1  ON 22
ci_024                 6.336941e-03 3 1  ON 23
ci_025                 9.040274e-03 3 1  ON 24
ci_026                 8.953080e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190330e-03 3 1  ON 28
ci_030                -5.154909e-03 3 1  ON 29
ci_031                -1.760764e-03 3 1  ON 30
ci_032                -1.720987e-03 3 1  ON 31
ci_033                 4.327072e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736838e-03 3 1  ON 34
ci_036                 2.770822e-03 3 1  ON 35
ci_037                 4.702136e-03 3 1  ON 36
ci_038                 4.549574e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649414e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564837e-03 3 1  ON 41
ci_043                 3.872169e-03 3 1  ON 42
ci_044                 4.055215e-03 3 1  ON 43
ci_045                 3.213814e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607600e-03 3 1  ON 46
ci_048                -1.717716e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488381e-03 3 1  ON 49
ci_051                -2.173866e-03 3 1  ON 50
ci_052                -2.076687e-03 3 1  ON 51
ci_053                -2.236145e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129031e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221580e-03 3 1  ON 56
ci_058                -1.464193e-03 3 1  ON 57
ci_059                -8.259871e-04 3 1  ON 58
ci_060                -6.614105e-04 3 1  ON 59
ci_061                -9.769532e-04 3 1  ON 60
ci_062                -7.221515e-04 3 1  ON 61
ci_063                -6.062540e-04 3 1  ON 62
ci_064                -7.520613e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105582e-03 3 1  ON 67
ci_069                -1.833691e-05 3 1  ON 68
ci_070                 1.324102e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032116e-04 3 1  ON 72
ci_074                 4.904868e-04 3 1  ON 73
ci_075                -1.860264e-04 3 1  ON 74
ci_076                -1.192335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.7073
    reference variance = 0.407119
====================================================
  Execution time = 4.9785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0175e-01
  Total weights = 1.9551e+06
  Execution time = 7.2093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986771327
                                         uncertainty =       0.003027738629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986771327
                                         uncertainty =       0.003027738629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493382179
  error estimate for blocks of size 2^( 2) =       0.000511360856
  error estimate for blocks of size 2^( 3) =       0.000527918918
  error estimate for blocks of size 2^( 4) =       0.000540389608
  error estimate for blocks of size 2^( 5) =       0.000548186332
  error estimate for blocks of size 2^( 6) =       0.000551695798
  error estimate for blocks of size 2^( 7) =       0.000552756173

      target function =      -0.610411368069
              le_mean =     -22.669536440907
             les_mean =     514.409628081003
             stat err =       0.000548256978
             autocorr =       1.234813640753
   target nu stat err =       0.000548256978
   target dn stat err =       0.004169778153
      target stat err =       0.001291633869
              std dev =       0.697747768547
             le_variance =       0.486851948512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986765803
                                         uncertainty =       0.003027738538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986765803
                                         uncertainty =       0.003027738538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493382176
  error estimate for blocks of size 2^( 2) =       0.000511360853
  error estimate for blocks of size 2^( 3) =       0.000527918915
  error estimate for blocks of size 2^( 4) =       0.000540389605
  error estimate for blocks of size 2^( 5) =       0.000548186329
  error estimate for blocks of size 2^( 6) =       0.000551695796
  error estimate for blocks of size 2^( 7) =       0.000552756170

      target function =      -0.610411365677
              le_mean =     -22.669536440927
             les_mean =     514.409628089814
             stat err =       0.000548256975
             autocorr =       1.234813642085
   target nu stat err =       0.000548256975
   target dn stat err =       0.004169779956
      target stat err =       0.001291634393
              std dev =       0.697747764594
             le_variance =       0.486851942996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986768565
                                         uncertainty =       0.003027738584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986768565
                                         uncertainty =       0.003027738584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493382177
  error estimate for blocks of size 2^( 2) =       0.000511360854
  error estimate for blocks of size 2^( 3) =       0.000527918916
  error estimate for blocks of size 2^( 4) =       0.000540389606
  error estimate for blocks of size 2^( 5) =       0.000548186330
  error estimate for blocks of size 2^( 6) =       0.000551695797
  error estimate for blocks of size 2^( 7) =       0.000552756171

      target function =      -0.610411366873
              le_mean =     -22.669536440917
             les_mean =     514.409628085408
             stat err =       0.000548256976
             autocorr =       1.234813641426
   target nu stat err =       0.000548256976
   target dn stat err =       0.004169779055
      target stat err =       0.001291634131
              std dev =       0.697747766570
             le_variance =       0.486851945754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986770982
                                         uncertainty =       0.003027738624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986770982
                                         uncertainty =       0.003027738624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493382179
  error estimate for blocks of size 2^( 2) =       0.000511360856
  error estimate for blocks of size 2^( 3) =       0.000527918917
  error estimate for blocks of size 2^( 4) =       0.000540389607
  error estimate for blocks of size 2^( 5) =       0.000548186332
  error estimate for blocks of size 2^( 6) =       0.000551695798
  error estimate for blocks of size 2^( 7) =       0.000552756172

      target function =      -0.610411367920
              le_mean =     -22.669536440908
             les_mean =     514.409628081554
             stat err =       0.000548256977
             autocorr =       1.234813640829
   target nu stat err =       0.000548256977
   target dn stat err =       0.004169778266
      target stat err =       0.001291633902
              std dev =       0.697747768300
             le_variance =       0.486851948167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610411368069        initial  <--
     3.6380e+04     3.6380e+05             1.0072e-08        -0.610411365677
     1.4552e+05     1.4552e+06             2.5180e-09        -0.610411366873
     5.8208e+05     5.8208e+06             6.2949e-10        -0.610411367920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 86.0020
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364077e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330848e-02 3 1  ON 4
ci_006                 2.338097e-02 3 1  ON 5
ci_007                 1.858785e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470819e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211971e-02 3 1  ON 11
ci_013                 1.121074e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260774e-02 3 1  ON 14
ci_016                 1.239654e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268290e-03 3 1  ON 18
ci_020                 3.483698e-03 3 1  ON 19
ci_021                -8.069006e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236750e-03 3 1  ON 22
ci_024                 6.336941e-03 3 1  ON 23
ci_025                 9.040274e-03 3 1  ON 24
ci_026                 8.953080e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190330e-03 3 1  ON 28
ci_030                -5.154909e-03 3 1  ON 29
ci_031                -1.760765e-03 3 1  ON 30
ci_032                -1.720987e-03 3 1  ON 31
ci_033                 4.327072e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736838e-03 3 1  ON 34
ci_036                 2.770822e-03 3 1  ON 35
ci_037                 4.702137e-03 3 1  ON 36
ci_038                 4.549573e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649414e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564837e-03 3 1  ON 41
ci_043                 3.872169e-03 3 1  ON 42
ci_044                 4.055215e-03 3 1  ON 43
ci_045                 3.213814e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607600e-03 3 1  ON 46
ci_048                -1.717717e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488382e-03 3 1  ON 49
ci_051                -2.173866e-03 3 1  ON 50
ci_052                -2.076687e-03 3 1  ON 51
ci_053                -2.236145e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129031e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464193e-03 3 1  ON 57
ci_059                -8.259875e-04 3 1  ON 58
ci_060                -6.614111e-04 3 1  ON 59
ci_061                -9.769536e-04 3 1  ON 60
ci_062                -7.221514e-04 3 1  ON 61
ci_063                -6.062539e-04 3 1  ON 62
ci_064                -7.520616e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105581e-03 3 1  ON 67
ci_069                -1.833704e-05 3 1  ON 68
ci_070                 1.324099e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032116e-04 3 1  ON 72
ci_074                 4.904868e-04 3 1  ON 73
ci_075                -1.860265e-04 3 1  ON 74
ci_076                -1.192335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4760e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7465
    reference variance = 0.302893
====================================================
  Execution time = 5.1231e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9623e-01
  Total weights = 1.954801071e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485043398257
                                         uncertainty =       0.002357178039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485043398257
                                         uncertainty =       0.002357178039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492443995
  error estimate for blocks of size 2^( 2) =       0.000510577432
  error estimate for blocks of size 2^( 3) =       0.000526850050
  error estimate for blocks of size 2^( 4) =       0.000538653570
  error estimate for blocks of size 2^( 5) =       0.000546491574
  error estimate for blocks of size 2^( 6) =       0.000550361984
  error estimate for blocks of size 2^( 7) =       0.000551256294

      target function =      -0.611775457491
              le_mean =     -22.668298719264
             les_mean =     514.347997503709
             stat err =       0.000546690856
             autocorr =       1.232451756180
   target nu stat err =       0.000546690856
   target dn stat err =       0.002941452299
      target stat err =       0.000934138209
              std dev =       0.696420975980
             le_variance =       0.485002175785


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266829871926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611776595986       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611776596089       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611776596101       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611776596103       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611776596111       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611776596146       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611776596211       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611776596057       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611776597326       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611776596781       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+05 is 9.462035e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611776595986       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611776596012       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611776596015       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611776596015       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611776594832       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611776597481       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611776595893       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611776595062       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611776596383       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611776597380       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+06 is 2.365509e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611776595986       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611776595993       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611776595993       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611776596227       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611776596332       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611776596016       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611776596195       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611776609848       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611776602490       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611776598381       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+06 is 5.913769e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.889346 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0679e+01
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364077e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330848e-02 3 1  ON 4
ci_006                 2.338097e-02 3 1  ON 5
ci_007                 1.858785e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470819e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211971e-02 3 1  ON 11
ci_013                 1.121074e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260774e-02 3 1  ON 14
ci_016                 1.239654e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268290e-03 3 1  ON 18
ci_020                 3.483698e-03 3 1  ON 19
ci_021                -8.069006e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236750e-03 3 1  ON 22
ci_024                 6.336941e-03 3 1  ON 23
ci_025                 9.040274e-03 3 1  ON 24
ci_026                 8.953080e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190330e-03 3 1  ON 28
ci_030                -5.154909e-03 3 1  ON 29
ci_031                -1.760764e-03 3 1  ON 30
ci_032                -1.720987e-03 3 1  ON 31
ci_033                 4.327072e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736838e-03 3 1  ON 34
ci_036                 2.770822e-03 3 1  ON 35
ci_037                 4.702137e-03 3 1  ON 36
ci_038                 4.549573e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649414e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564837e-03 3 1  ON 41
ci_043                 3.872169e-03 3 1  ON 42
ci_044                 4.055215e-03 3 1  ON 43
ci_045                 3.213814e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607600e-03 3 1  ON 46
ci_048                -1.717717e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488382e-03 3 1  ON 49
ci_051                -2.173866e-03 3 1  ON 50
ci_052                -2.076687e-03 3 1  ON 51
ci_053                -2.236145e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129031e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464193e-03 3 1  ON 57
ci_059                -8.259875e-04 3 1  ON 58
ci_060                -6.614110e-04 3 1  ON 59
ci_061                -9.769536e-04 3 1  ON 60
ci_062                -7.221514e-04 3 1  ON 61
ci_063                -6.062540e-04 3 1  ON 62
ci_064                -7.520616e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105582e-03 3 1  ON 67
ci_069                -1.833705e-05 3 1  ON 68
ci_070                 1.324099e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032116e-04 3 1  ON 72
ci_074                 4.904868e-04 3 1  ON 73
ci_075                -1.860265e-04 3 1  ON 74
ci_076                -1.192335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.6668
    reference variance = 0.335116
====================================================
  Execution time = 4.9790e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9544e-01
  Total weights = 1.9548e+06
  Execution time = 7.2254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484606078074
                                         uncertainty =       0.002207205408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484606078074
                                         uncertainty =       0.002207205408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492215668
  error estimate for blocks of size 2^( 2) =       0.000510646192
  error estimate for blocks of size 2^( 3) =       0.000527404857
  error estimate for blocks of size 2^( 4) =       0.000539298542
  error estimate for blocks of size 2^( 5) =       0.000546622781
  error estimate for blocks of size 2^( 6) =       0.000549652938
  error estimate for blocks of size 2^( 7) =       0.000550388281

      target function =      -0.612088631447
              le_mean =     -22.668585907347
             les_mean =     514.360225494865
             stat err =       0.000546490636
             autocorr =       1.232692012384
   target nu stat err =       0.000546490636
   target dn stat err =       0.003043246847
      target stat err =       0.000964921145
              std dev =       0.696098072973
             le_variance =       0.484552527197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484606077458
                                         uncertainty =       0.002207205414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484606077458
                                         uncertainty =       0.002207205414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492215667
  error estimate for blocks of size 2^( 2) =       0.000510646191
  error estimate for blocks of size 2^( 3) =       0.000527404857
  error estimate for blocks of size 2^( 4) =       0.000539298542
  error estimate for blocks of size 2^( 5) =       0.000546622781
  error estimate for blocks of size 2^( 6) =       0.000549652938
  error estimate for blocks of size 2^( 7) =       0.000550388281

      target function =      -0.612088631603
              le_mean =     -22.668585907359
             les_mean =     514.360225494901
             stat err =       0.000546490635
             autocorr =       1.232692012504
   target nu stat err =       0.000546490635
   target dn stat err =       0.003043246869
      target stat err =       0.000964921152
              std dev =       0.696098072531
             le_variance =       0.484552526582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484606077766
                                         uncertainty =       0.002207205411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484606077766
                                         uncertainty =       0.002207205411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492215668
  error estimate for blocks of size 2^( 2) =       0.000510646192
  error estimate for blocks of size 2^( 3) =       0.000527404857
  error estimate for blocks of size 2^( 4) =       0.000539298542
  error estimate for blocks of size 2^( 5) =       0.000546622781
  error estimate for blocks of size 2^( 6) =       0.000549652938
  error estimate for blocks of size 2^( 7) =       0.000550388281

      target function =      -0.612088631525
              le_mean =     -22.668585907353
             les_mean =     514.360225494883
             stat err =       0.000546490636
             autocorr =       1.232692012442
   target nu stat err =       0.000546490636
   target dn stat err =       0.003043246858
      target stat err =       0.000964921149
              std dev =       0.696098072752
             le_variance =       0.484552526889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484606078036
                                         uncertainty =       0.002207205409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484606078036
                                         uncertainty =       0.002207205409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492215668
  error estimate for blocks of size 2^( 2) =       0.000510646192
  error estimate for blocks of size 2^( 3) =       0.000527404857
  error estimate for blocks of size 2^( 4) =       0.000539298542
  error estimate for blocks of size 2^( 5) =       0.000546622781
  error estimate for blocks of size 2^( 6) =       0.000549652938
  error estimate for blocks of size 2^( 7) =       0.000550388281

      target function =      -0.612088631457
              le_mean =     -22.668585907348
             les_mean =     514.360225494867
             stat err =       0.000546490636
             autocorr =       1.232692012383
   target nu stat err =       0.000546490636
   target dn stat err =       0.003043246848
      target stat err =       0.000964921146
              std dev =       0.696098072946
             le_variance =       0.484552527159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.612088631447        initial
     3.6380e+05     3.6380e+06             9.4620e-10        -0.612088631603  <--
     1.4552e+06     1.4552e+07             2.3655e-10        -0.612088631525
     5.8208e+06     5.8208e+07             5.9138e-11        -0.612088631457

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 8.6059e+01
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364077e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330848e-02 3 1  ON 4
ci_006                 2.338097e-02 3 1  ON 5
ci_007                 1.858785e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470819e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211971e-02 3 1  ON 11
ci_013                 1.121074e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260773e-02 3 1  ON 14
ci_016                 1.239654e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268290e-03 3 1  ON 18
ci_020                 3.483698e-03 3 1  ON 19
ci_021                -8.069006e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236750e-03 3 1  ON 22
ci_024                 6.336941e-03 3 1  ON 23
ci_025                 9.040274e-03 3 1  ON 24
ci_026                 8.953080e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190330e-03 3 1  ON 28
ci_030                -5.154909e-03 3 1  ON 29
ci_031                -1.760764e-03 3 1  ON 30
ci_032                -1.720987e-03 3 1  ON 31
ci_033                 4.327072e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736838e-03 3 1  ON 34
ci_036                 2.770822e-03 3 1  ON 35
ci_037                 4.702137e-03 3 1  ON 36
ci_038                 4.549573e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649414e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564837e-03 3 1  ON 41
ci_043                 3.872169e-03 3 1  ON 42
ci_044                 4.055215e-03 3 1  ON 43
ci_045                 3.213814e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607600e-03 3 1  ON 46
ci_048                -1.717716e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488382e-03 3 1  ON 49
ci_051                -2.173866e-03 3 1  ON 50
ci_052                -2.076687e-03 3 1  ON 51
ci_053                -2.236145e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129031e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221580e-03 3 1  ON 56
ci_058                -1.464193e-03 3 1  ON 57
ci_059                -8.259874e-04 3 1  ON 58
ci_060                -6.614110e-04 3 1  ON 59
ci_061                -9.769535e-04 3 1  ON 60
ci_062                -7.221514e-04 3 1  ON 61
ci_063                -6.062540e-04 3 1  ON 62
ci_064                -7.520616e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105582e-03 3 1  ON 67
ci_069                -1.833708e-05 3 1  ON 68
ci_070                 1.324099e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032115e-04 3 1  ON 72
ci_074                 4.904868e-04 3 1  ON 73
ci_075                -1.860265e-04 3 1  ON 74
ci_076                -1.192335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4675e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.5711
    reference variance = 0.60914
====================================================
  Execution time = 5.1752e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 4.9704e-01
  Total weights = 1.955151417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485436289576
                                         uncertainty =       0.002529822222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485436289576
                                         uncertainty =       0.002529822222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492635266
  error estimate for blocks of size 2^( 2) =       0.000511712548
  error estimate for blocks of size 2^( 3) =       0.000528875247
  error estimate for blocks of size 2^( 4) =       0.000541045099
  error estimate for blocks of size 2^( 5) =       0.000548217115
  error estimate for blocks of size 2^( 6) =       0.000550049868
  error estimate for blocks of size 2^( 7) =       0.000550174441

      target function =      -0.611327053167
              le_mean =     -22.667498173798
             les_mean =     514.312516549367
             stat err =       0.000547371631
             autocorr =       1.234563900973
   target nu stat err =       0.000547371631
   target dn stat err =       0.003336406861
      target stat err =       0.001047469304
              std dev =       0.696691474175
             le_variance =       0.485379010188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266749817380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611328541062       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611328541416       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611328541454       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611328541452       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611328541344       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611328541491       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611328541520       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611328541503       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611328541568       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611328541325       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+04 is 3.767066e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611328541062       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611328541150       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611328541160       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611328541161       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611328541174       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611328541427       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611328541815       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611328541108       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611328541107       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611328540260       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+05 is 9.417669e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611328541062       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611328541084       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611328541086       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611328540653       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611328541085       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611328542659       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611328540139       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611328541517       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611328539681       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611328540643       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+06 is 2.354417e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.901117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1197e+01
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364077e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330848e-02 3 1  ON 4
ci_006                 2.338097e-02 3 1  ON 5
ci_007                 1.858785e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470819e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211971e-02 3 1  ON 11
ci_013                 1.121073e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260773e-02 3 1  ON 14
ci_016                 1.239654e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268290e-03 3 1  ON 18
ci_020                 3.483698e-03 3 1  ON 19
ci_021                -8.069005e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236750e-03 3 1  ON 22
ci_024                 6.336941e-03 3 1  ON 23
ci_025                 9.040274e-03 3 1  ON 24
ci_026                 8.953081e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190330e-03 3 1  ON 28
ci_030                -5.154909e-03 3 1  ON 29
ci_031                -1.760764e-03 3 1  ON 30
ci_032                -1.720987e-03 3 1  ON 31
ci_033                 4.327072e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736838e-03 3 1  ON 34
ci_036                 2.770822e-03 3 1  ON 35
ci_037                 4.702137e-03 3 1  ON 36
ci_038                 4.549573e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649414e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564837e-03 3 1  ON 41
ci_043                 3.872169e-03 3 1  ON 42
ci_044                 4.055215e-03 3 1  ON 43
ci_045                 3.213814e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607600e-03 3 1  ON 46
ci_048                -1.717716e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488381e-03 3 1  ON 49
ci_051                -2.173866e-03 3 1  ON 50
ci_052                -2.076687e-03 3 1  ON 51
ci_053                -2.236144e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129031e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221580e-03 3 1  ON 56
ci_058                -1.464193e-03 3 1  ON 57
ci_059                -8.259874e-04 3 1  ON 58
ci_060                -6.614110e-04 3 1  ON 59
ci_061                -9.769534e-04 3 1  ON 60
ci_062                -7.221513e-04 3 1  ON 61
ci_063                -6.062541e-04 3 1  ON 62
ci_064                -7.520617e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105582e-03 3 1  ON 67
ci_069                -1.833693e-05 3 1  ON 68
ci_070                 1.324099e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032115e-04 3 1  ON 72
ci_074                 4.904868e-04 3 1  ON 73
ci_075                -1.860265e-04 3 1  ON 74
ci_076                -1.192334e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6214
    reference variance = 0.561285
====================================================
  Execution time = 4.9775e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9939e-01
  Total weights = 1.9549e+06
  Execution time = 7.2368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485632669078
                                         uncertainty =       0.003189960687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485632669078
                                         uncertainty =       0.003189960687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492752296
  error estimate for blocks of size 2^( 2) =       0.000511249315
  error estimate for blocks of size 2^( 3) =       0.000528152789
  error estimate for blocks of size 2^( 4) =       0.000539640184
  error estimate for blocks of size 2^( 5) =       0.000547056389
  error estimate for blocks of size 2^( 6) =       0.000550801328
  error estimate for blocks of size 2^( 7) =       0.000554735682

      target function =      -0.610862938983
              le_mean =     -22.668495113212
             les_mean =     514.360064070110
             stat err =       0.000548058396
             autocorr =       1.237075932613
   target nu stat err =       0.000548058396
   target dn stat err =       0.004784953865
      target stat err =       0.001475144351
              std dev =       0.696856979187
             le_variance =       0.485609649442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485632666712
                                         uncertainty =       0.003189960671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485632666712
                                         uncertainty =       0.003189960671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492752294
  error estimate for blocks of size 2^( 2) =       0.000511249314
  error estimate for blocks of size 2^( 3) =       0.000528152788
  error estimate for blocks of size 2^( 4) =       0.000539640183
  error estimate for blocks of size 2^( 5) =       0.000547056388
  error estimate for blocks of size 2^( 6) =       0.000550801326
  error estimate for blocks of size 2^( 7) =       0.000554735681

      target function =      -0.610862939241
              le_mean =     -22.668495113230
             les_mean =     514.360064070061
             stat err =       0.000548058394
             autocorr =       1.237075932917
   target nu stat err =       0.000548058394
   target dn stat err =       0.004784953862
      target stat err =       0.001475144351
              std dev =       0.696856977490
             le_variance =       0.485609647077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485632667895
                                         uncertainty =       0.003189960679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485632667895
                                         uncertainty =       0.003189960679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492752295
  error estimate for blocks of size 2^( 2) =       0.000511249315
  error estimate for blocks of size 2^( 3) =       0.000528152788
  error estimate for blocks of size 2^( 4) =       0.000539640183
  error estimate for blocks of size 2^( 5) =       0.000547056388
  error estimate for blocks of size 2^( 6) =       0.000550801327
  error estimate for blocks of size 2^( 7) =       0.000554735681

      target function =      -0.610862939112
              le_mean =     -22.668495113221
             les_mean =     514.360064070085
             stat err =       0.000548058395
             autocorr =       1.237075932772
   target nu stat err =       0.000548058395
   target dn stat err =       0.004784953864
      target stat err =       0.001475144351
              std dev =       0.696856978339
             le_variance =       0.485609648259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485632668930
                                         uncertainty =       0.003189960686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485632668930
                                         uncertainty =       0.003189960686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492752295
  error estimate for blocks of size 2^( 2) =       0.000511249315
  error estimate for blocks of size 2^( 3) =       0.000528152789
  error estimate for blocks of size 2^( 4) =       0.000539640184
  error estimate for blocks of size 2^( 5) =       0.000547056389
  error estimate for blocks of size 2^( 6) =       0.000550801328
  error estimate for blocks of size 2^( 7) =       0.000554735682

      target function =      -0.610862939000
              le_mean =     -22.668495113214
             les_mean =     514.360064070107
             stat err =       0.000548058396
             autocorr =       1.237075932636
   target nu stat err =       0.000548058396
   target dn stat err =       0.004784953865
      target stat err =       0.001475144351
              std dev =       0.696856979081
             le_variance =       0.485609649294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610862938983        initial
     9.0949e+04     9.0949e+05             3.7671e-09        -0.610862939241  <--
     3.6380e+05     3.6380e+06             9.4177e-10        -0.610862939112
     1.4552e+06     1.4552e+07             2.3544e-10        -0.610862939000

*****************************************************************************
Applying the update for shift_i =   9.0949e+04     and shift_s =   9.0949e+05
*****************************************************************************

  Execution time = 8.6007e+01
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364076e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330847e-02 3 1  ON 4
ci_006                 2.338096e-02 3 1  ON 5
ci_007                 1.858784e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470818e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211971e-02 3 1  ON 11
ci_013                 1.121073e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260773e-02 3 1  ON 14
ci_016                 1.239654e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268289e-03 3 1  ON 18
ci_020                 3.483697e-03 3 1  ON 19
ci_021                -8.069005e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236750e-03 3 1  ON 22
ci_024                 6.336940e-03 3 1  ON 23
ci_025                 9.040275e-03 3 1  ON 24
ci_026                 8.953081e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190329e-03 3 1  ON 28
ci_030                -5.154909e-03 3 1  ON 29
ci_031                -1.760763e-03 3 1  ON 30
ci_032                -1.720986e-03 3 1  ON 31
ci_033                 4.327071e-03 3 1  ON 32
ci_034                 4.225810e-03 3 1  ON 33
ci_035                 2.736838e-03 3 1  ON 34
ci_036                 2.770822e-03 3 1  ON 35
ci_037                 4.702137e-03 3 1  ON 36
ci_038                 4.549572e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649413e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564836e-03 3 1  ON 41
ci_043                 3.872169e-03 3 1  ON 42
ci_044                 4.055214e-03 3 1  ON 43
ci_045                 3.213814e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607600e-03 3 1  ON 46
ci_048                -1.717716e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488381e-03 3 1  ON 49
ci_051                -2.173865e-03 3 1  ON 50
ci_052                -2.076687e-03 3 1  ON 51
ci_053                -2.236144e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129031e-03 3 1  ON 54
ci_056                -1.635959e-03 3 1  ON 55
ci_057                -1.221580e-03 3 1  ON 56
ci_058                -1.464194e-03 3 1  ON 57
ci_059                -8.259875e-04 3 1  ON 58
ci_060                -6.614110e-04 3 1  ON 59
ci_061                -9.769530e-04 3 1  ON 60
ci_062                -7.221510e-04 3 1  ON 61
ci_063                -6.062541e-04 3 1  ON 62
ci_064                -7.520620e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105582e-03 3 1  ON 67
ci_069                -1.833649e-05 3 1  ON 68
ci_070                 1.324101e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032112e-04 3 1  ON 72
ci_074                 4.904866e-04 3 1  ON 73
ci_075                -1.860266e-04 3 1  ON 74
ci_076                -1.192332e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4722e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.7137
    reference variance = 0.394698
====================================================
  Execution time = 5.1285e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0097e-01
  Total weights = 1.955150186e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488862539688
                                         uncertainty =       0.004455080602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488862539688
                                         uncertainty =       0.004455080602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494342676
  error estimate for blocks of size 2^( 2) =       0.000512696913
  error estimate for blocks of size 2^( 3) =       0.000528826281
  error estimate for blocks of size 2^( 4) =       0.000542068233
  error estimate for blocks of size 2^( 5) =       0.000549682793
  error estimate for blocks of size 2^( 6) =       0.000553856652
  error estimate for blocks of size 2^( 7) =       0.000555095554

      target function =      -0.610782666265
              le_mean =     -22.670105548518
             les_mean =     514.434660284228
             stat err =       0.000550175808
             autocorr =       1.238644764929
   target nu stat err =       0.000550175808
   target dn stat err =       0.006723618923
      target stat err =       0.002057671873
              std dev =       0.699106116955
             le_variance =       0.488749362764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267010554852e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610789254961       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610789256443       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610789256625       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610789256641       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610789256672       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610789256645       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610789256649       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610789256650       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610789256605       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610789256650       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+04 is 1.524174e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610789254961       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610789255331       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610789255377       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610789255381       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610789255382       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610789255382       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610789255383       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610789255252       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610789255344       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610789255381       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+04 is 3.810440e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610789254961       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610789255053       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610789255065       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610789255066       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610789255066       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610789255066       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610789254522       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610789255066       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610789255223       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610789255066       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+05 is 9.526104e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.906236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0748e+01
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364076e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330847e-02 3 1  ON 4
ci_006                 2.338096e-02 3 1  ON 5
ci_007                 1.858784e-02 3 1  ON 6
ci_008                 1.897986e-02 3 1  ON 7
ci_009                -1.495508e-02 3 1  ON 8
ci_010                -1.470818e-02 3 1  ON 9
ci_011                -1.253231e-02 3 1  ON 10
ci_012                -1.211970e-02 3 1  ON 11
ci_013                 1.121073e-02 3 1  ON 12
ci_014                 1.099782e-02 3 1  ON 13
ci_015                 1.260773e-02 3 1  ON 14
ci_016                 1.239653e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268290e-03 3 1  ON 18
ci_020                 3.483695e-03 3 1  ON 19
ci_021                -8.069003e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236749e-03 3 1  ON 22
ci_024                 6.336940e-03 3 1  ON 23
ci_025                 9.040275e-03 3 1  ON 24
ci_026                 8.953082e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651333e-03 3 1  ON 27
ci_029                -5.190329e-03 3 1  ON 28
ci_030                -5.154908e-03 3 1  ON 29
ci_031                -1.760762e-03 3 1  ON 30
ci_032                -1.720984e-03 3 1  ON 31
ci_033                 4.327071e-03 3 1  ON 32
ci_034                 4.225809e-03 3 1  ON 33
ci_035                 2.736837e-03 3 1  ON 34
ci_036                 2.770821e-03 3 1  ON 35
ci_037                 4.702137e-03 3 1  ON 36
ci_038                 4.549572e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649413e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564836e-03 3 1  ON 41
ci_043                 3.872168e-03 3 1  ON 42
ci_044                 4.055214e-03 3 1  ON 43
ci_045                 3.213815e-03 3 1  ON 44
ci_046                 3.196823e-03 3 1  ON 45
ci_047                -1.607599e-03 3 1  ON 46
ci_048                -1.717715e-03 3 1  ON 47
ci_049                 1.399624e-03 3 1  ON 48
ci_050                 1.488380e-03 3 1  ON 49
ci_051                -2.173865e-03 3 1  ON 50
ci_052                -2.076686e-03 3 1  ON 51
ci_053                -2.236145e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129030e-03 3 1  ON 54
ci_056                -1.635959e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464193e-03 3 1  ON 57
ci_059                -8.259869e-04 3 1  ON 58
ci_060                -6.614109e-04 3 1  ON 59
ci_061                -9.769526e-04 3 1  ON 60
ci_062                -7.221504e-04 3 1  ON 61
ci_063                -6.062549e-04 3 1  ON 62
ci_064                -7.520619e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105582e-03 3 1  ON 67
ci_069                -1.833666e-05 3 1  ON 68
ci_070                 1.324098e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750601e-03 3 1  ON 71
ci_073                 5.032111e-04 3 1  ON 72
ci_074                 4.904865e-04 3 1  ON 73
ci_075                -1.860265e-04 3 1  ON 74
ci_076                -1.192331e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.7619
    reference variance = 0.448133
====================================================
  Execution time = 4.9758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0709e-01
  Total weights = 1.9550e+06
  Execution time = 7.2262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490760983224
                                         uncertainty =       0.002440716003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490760983224
                                         uncertainty =       0.002440716003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495324870
  error estimate for blocks of size 2^( 2) =       0.000513864496
  error estimate for blocks of size 2^( 3) =       0.000530713266
  error estimate for blocks of size 2^( 4) =       0.000542069912
  error estimate for blocks of size 2^( 5) =       0.000549853713
  error estimate for blocks of size 2^( 6) =       0.000553015635
  error estimate for blocks of size 2^( 7) =       0.000557050025

      target function =      -0.608517823317
              le_mean =     -22.668400596489
             les_mean =     514.363474562885
             stat err =       0.000550497321
             autocorr =       1.235179717425
   target nu stat err =       0.000550497321
   target dn stat err =       0.003939814059
      target stat err =       0.001215378850
              std dev =       0.700495149187
             le_variance =       0.490693454035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490760974183
                                         uncertainty =       0.002440715747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490760974183
                                         uncertainty =       0.002440715747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495324866
  error estimate for blocks of size 2^( 2) =       0.000513864491
  error estimate for blocks of size 2^( 3) =       0.000530713262
  error estimate for blocks of size 2^( 4) =       0.000542069908
  error estimate for blocks of size 2^( 5) =       0.000549853709
  error estimate for blocks of size 2^( 6) =       0.000553015631
  error estimate for blocks of size 2^( 7) =       0.000557050021

      target function =      -0.608517868843
              le_mean =     -22.668400596352
             les_mean =     514.363474405127
             stat err =       0.000550497317
             autocorr =       1.235179721040
   target nu stat err =       0.000550497317
   target dn stat err =       0.003939809926
      target stat err =       0.001215377815
              std dev =       0.700495142740
             le_variance =       0.490693445003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490760978704
                                         uncertainty =       0.002440715875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490760978704
                                         uncertainty =       0.002440715875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495324868
  error estimate for blocks of size 2^( 2) =       0.000513864494
  error estimate for blocks of size 2^( 3) =       0.000530713264
  error estimate for blocks of size 2^( 4) =       0.000542069910
  error estimate for blocks of size 2^( 5) =       0.000549853711
  error estimate for blocks of size 2^( 6) =       0.000553015633
  error estimate for blocks of size 2^( 7) =       0.000557050023

      target function =      -0.608517846090
              le_mean =     -22.668400596420
             les_mean =     514.363474483973
             stat err =       0.000550497319
             autocorr =       1.235179719230
   target nu stat err =       0.000550497319
   target dn stat err =       0.003939811991
      target stat err =       0.001215378332
              std dev =       0.700495145964
             le_variance =       0.490693449519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490760982659
                                         uncertainty =       0.002440715987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490760982659
                                         uncertainty =       0.002440715987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495324870
  error estimate for blocks of size 2^( 2) =       0.000513864496
  error estimate for blocks of size 2^( 3) =       0.000530713266
  error estimate for blocks of size 2^( 4) =       0.000542069912
  error estimate for blocks of size 2^( 5) =       0.000549853713
  error estimate for blocks of size 2^( 6) =       0.000553015635
  error estimate for blocks of size 2^( 7) =       0.000557050025

      target function =      -0.608517826165
              le_mean =     -22.668400596481
             les_mean =     514.363474553018
             stat err =       0.000550497321
             autocorr =       1.235179717653
   target nu stat err =       0.000550497321
   target dn stat err =       0.003939813800
      target stat err =       0.001215378785
              std dev =       0.700495148784
             le_variance =       0.490693453470


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.608517823317        initial
     2.2737e+04     2.2737e+05             1.5242e-08        -0.608517868843  <--
     9.0949e+04     9.0949e+05             3.8104e-09        -0.608517846090
     3.6380e+05     3.6380e+06             9.5261e-10        -0.608517826165

*****************************************************************************
Applying the update for shift_i =   2.2737e+04     and shift_s =   2.2737e+05
*****************************************************************************

  Execution time = 8.5976e+01
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364075e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330846e-02 3 1  ON 4
ci_006                 2.338095e-02 3 1  ON 5
ci_007                 1.858784e-02 3 1  ON 6
ci_008                 1.897985e-02 3 1  ON 7
ci_009                -1.495507e-02 3 1  ON 8
ci_010                -1.470818e-02 3 1  ON 9
ci_011                -1.253230e-02 3 1  ON 10
ci_012                -1.211970e-02 3 1  ON 11
ci_013                 1.121073e-02 3 1  ON 12
ci_014                 1.099781e-02 3 1  ON 13
ci_015                 1.260773e-02 3 1  ON 14
ci_016                 1.239653e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268293e-03 3 1  ON 18
ci_020                 3.483691e-03 3 1  ON 19
ci_021                -8.068999e-03 3 1  ON 20
ci_022                -8.280586e-03 3 1  ON 21
ci_023                 6.236746e-03 3 1  ON 22
ci_024                 6.336940e-03 3 1  ON 23
ci_025                 9.040276e-03 3 1  ON 24
ci_026                 8.953082e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651331e-03 3 1  ON 27
ci_029                -5.190329e-03 3 1  ON 28
ci_030                -5.154907e-03 3 1  ON 29
ci_031                -1.760761e-03 3 1  ON 30
ci_032                -1.720981e-03 3 1  ON 31
ci_033                 4.327070e-03 3 1  ON 32
ci_034                 4.225807e-03 3 1  ON 33
ci_035                 2.736835e-03 3 1  ON 34
ci_036                 2.770818e-03 3 1  ON 35
ci_037                 4.702135e-03 3 1  ON 36
ci_038                 4.549571e-03 3 1  ON 37
ci_039                 4.574579e-03 3 1  ON 38
ci_040                 4.649413e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564834e-03 3 1  ON 41
ci_043                 3.872166e-03 3 1  ON 42
ci_044                 4.055214e-03 3 1  ON 43
ci_045                 3.213817e-03 3 1  ON 44
ci_046                 3.196822e-03 3 1  ON 45
ci_047                -1.607598e-03 3 1  ON 46
ci_048                -1.717714e-03 3 1  ON 47
ci_049                 1.399622e-03 3 1  ON 48
ci_050                 1.488379e-03 3 1  ON 49
ci_051                -2.173864e-03 3 1  ON 50
ci_052                -2.076685e-03 3 1  ON 51
ci_053                -2.236148e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129025e-03 3 1  ON 54
ci_056                -1.635959e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464192e-03 3 1  ON 57
ci_059                -8.259852e-04 3 1  ON 58
ci_060                -6.614105e-04 3 1  ON 59
ci_061                -9.769512e-04 3 1  ON 60
ci_062                -7.221485e-04 3 1  ON 61
ci_063                -6.062572e-04 3 1  ON 62
ci_064                -7.520617e-04 3 1  ON 63
ci_065                -1.915683e-03 3 1  ON 64
ci_066                -2.110265e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105584e-03 3 1  ON 67
ci_069                -1.833720e-05 3 1  ON 68
ci_070                 1.324088e-04 3 1  ON 69
ci_071                -1.880844e-03 3 1  ON 70
ci_072                -1.750602e-03 3 1  ON 71
ci_073                 5.032107e-04 3 1  ON 72
ci_074                 4.904860e-04 3 1  ON 73
ci_075                -1.860262e-04 3 1  ON 74
ci_076                -1.192327e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4673e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.6889
    reference variance = 0.391607
====================================================
  Execution time = 5.1502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9365e-01
  Total weights = 1.954970884e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482384361262
                                         uncertainty =       0.003155829386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482384361262
                                         uncertainty =       0.003155829386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491113234
  error estimate for blocks of size 2^( 2) =       0.000509572108
  error estimate for blocks of size 2^( 3) =       0.000526895367
  error estimate for blocks of size 2^( 4) =       0.000539137213
  error estimate for blocks of size 2^( 5) =       0.000545652808
  error estimate for blocks of size 2^( 6) =       0.000549817400
  error estimate for blocks of size 2^( 7) =       0.000555754516

      target function =      -0.612563556094
              le_mean =     -22.668316255094
             les_mean =     514.346214071999
             stat err =       0.000547590484
             autocorr =       1.243221493473
   target nu stat err =       0.000547590484
   target dn stat err =       0.003804149394
      target stat err =       0.001190511108
              std dev =       0.694538996748
             le_variance =       0.482384418004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266831625509e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612565538698       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612565545154       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612565545866       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612565545929       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612565545962       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612565545959       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612565545970       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612565545972       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612565545962       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612565545963       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+03 is 5.856385e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612565538698       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612565540312       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612565540490       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612565540506       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612565540513       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612565540473       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612565540525       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612565540489       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612565540529       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612565540488       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+04 is 1.464104e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612565538698       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612565539102       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612565539146       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612565539150       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612565539121       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612565539162       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612565539261       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612565539152       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612565539138       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612565539152       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+04 is 3.660265e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.911385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0877e+01
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364075e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330845e-02 3 1  ON 4
ci_006                 2.338093e-02 3 1  ON 5
ci_007                 1.858783e-02 3 1  ON 6
ci_008                 1.897984e-02 3 1  ON 7
ci_009                -1.495506e-02 3 1  ON 8
ci_010                -1.470817e-02 3 1  ON 9
ci_011                -1.253229e-02 3 1  ON 10
ci_012                -1.211969e-02 3 1  ON 11
ci_013                 1.121073e-02 3 1  ON 12
ci_014                 1.099781e-02 3 1  ON 13
ci_015                 1.260772e-02 3 1  ON 14
ci_016                 1.239652e-02 3 1  ON 15
ci_017                 1.049808e-02 3 1  ON 16
ci_018                 1.047877e-02 3 1  ON 17
ci_019                 3.268288e-03 3 1  ON 18
ci_020                 3.483689e-03 3 1  ON 19
ci_021                -8.068999e-03 3 1  ON 20
ci_022                -8.280588e-03 3 1  ON 21
ci_023                 6.236746e-03 3 1  ON 22
ci_024                 6.336931e-03 3 1  ON 23
ci_025                 9.040278e-03 3 1  ON 24
ci_026                 8.953084e-03 3 1  ON 25
ci_027                 6.585400e-03 3 1  ON 26
ci_028                 6.651329e-03 3 1  ON 27
ci_029                -5.190326e-03 3 1  ON 28
ci_030                -5.154902e-03 3 1  ON 29
ci_031                -1.760757e-03 3 1  ON 30
ci_032                -1.720975e-03 3 1  ON 31
ci_033                 4.327067e-03 3 1  ON 32
ci_034                 4.225804e-03 3 1  ON 33
ci_035                 2.736833e-03 3 1  ON 34
ci_036                 2.770814e-03 3 1  ON 35
ci_037                 4.702132e-03 3 1  ON 36
ci_038                 4.549568e-03 3 1  ON 37
ci_039                 4.574578e-03 3 1  ON 38
ci_040                 4.649412e-03 3 1  ON 39
ci_041                 3.713181e-03 3 1  ON 40
ci_042                 3.564832e-03 3 1  ON 41
ci_043                 3.872166e-03 3 1  ON 42
ci_044                 4.055210e-03 3 1  ON 43
ci_045                 3.213815e-03 3 1  ON 44
ci_046                 3.196820e-03 3 1  ON 45
ci_047                -1.607597e-03 3 1  ON 46
ci_048                -1.717711e-03 3 1  ON 47
ci_049                 1.399620e-03 3 1  ON 48
ci_050                 1.488379e-03 3 1  ON 49
ci_051                -2.173861e-03 3 1  ON 50
ci_052                -2.076683e-03 3 1  ON 51
ci_053                -2.236150e-03 3 1  ON 52
ci_054                -2.386085e-03 3 1  ON 53
ci_055                -1.129026e-03 3 1  ON 54
ci_056                -1.635958e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464192e-03 3 1  ON 57
ci_059                -8.259844e-04 3 1  ON 58
ci_060                -6.614112e-04 3 1  ON 59
ci_061                -9.769546e-04 3 1  ON 60
ci_062                -7.221487e-04 3 1  ON 61
ci_063                -6.062570e-04 3 1  ON 62
ci_064                -7.520626e-04 3 1  ON 63
ci_065                -1.915684e-03 3 1  ON 64
ci_066                -2.110266e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105582e-03 3 1  ON 67
ci_069                -1.833488e-05 3 1  ON 68
ci_070                 1.324091e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750603e-03 3 1  ON 71
ci_073                 5.032093e-04 3 1  ON 72
ci_074                 4.904867e-04 3 1  ON 73
ci_075                -1.860261e-04 3 1  ON 74
ci_076                -1.192309e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.7188
    reference variance = 0.70203
====================================================
  Execution time = 4.9589e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0145e-01
  Total weights = 1.9550e+06
  Execution time = 7.2172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485559498399
                                         uncertainty =       0.002658126752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485559498399
                                         uncertainty =       0.002658126752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492679989
  error estimate for blocks of size 2^( 2) =       0.000511397643
  error estimate for blocks of size 2^( 3) =       0.000529236175
  error estimate for blocks of size 2^( 4) =       0.000541413189
  error estimate for blocks of size 2^( 5) =       0.000550822737
  error estimate for blocks of size 2^( 6) =       0.000553433713
  error estimate for blocks of size 2^( 7) =       0.000552377649

      target function =      -0.609960980797
              le_mean =     -22.667382977813
             les_mean =     514.311704797509
             stat err =       0.000549511822
             autocorr =       1.244011036891
   target nu stat err =       0.000549511822
   target dn stat err =       0.005508423120
      target stat err =       0.001684760802
              std dev =       0.696754722554
             le_variance =       0.485467143401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485559457002
                                         uncertainty =       0.002658127512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485559457002
                                         uncertainty =       0.002658127512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492679968
  error estimate for blocks of size 2^( 2) =       0.000511397623
  error estimate for blocks of size 2^( 3) =       0.000529236156
  error estimate for blocks of size 2^( 4) =       0.000541413169
  error estimate for blocks of size 2^( 5) =       0.000550822716
  error estimate for blocks of size 2^( 6) =       0.000553433691
  error estimate for blocks of size 2^( 7) =       0.000552377628

      target function =      -0.609960933606
              le_mean =     -22.667382977505
             les_mean =     514.311704939568
             stat err =       0.000549511801
             autocorr =       1.244011049788
   target nu stat err =       0.000549511801
   target dn stat err =       0.005508435779
      target stat err =       0.001684764314
              std dev =       0.696754692852
             le_variance =       0.485467102011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485559477700
                                         uncertainty =       0.002658127132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485559477700
                                         uncertainty =       0.002658127132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492679979
  error estimate for blocks of size 2^( 2) =       0.000511397633
  error estimate for blocks of size 2^( 3) =       0.000529236166
  error estimate for blocks of size 2^( 4) =       0.000541413179
  error estimate for blocks of size 2^( 5) =       0.000550822726
  error estimate for blocks of size 2^( 6) =       0.000553433702
  error estimate for blocks of size 2^( 7) =       0.000552377638

      target function =      -0.609960957237
              le_mean =     -22.667382977659
             les_mean =     514.311704868421
             stat err =       0.000549511811
             autocorr =       1.244011043342
   target nu stat err =       0.000549511811
   target dn stat err =       0.005508429447
      target stat err =       0.001684762558
              std dev =       0.696754707703
             le_variance =       0.485467122706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485559495811
                                         uncertainty =       0.002658126800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485559495811
                                         uncertainty =       0.002658126800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492679988
  error estimate for blocks of size 2^( 2) =       0.000511397642
  error estimate for blocks of size 2^( 3) =       0.000529236174
  error estimate for blocks of size 2^( 4) =       0.000541413187
  error estimate for blocks of size 2^( 5) =       0.000550822735
  error estimate for blocks of size 2^( 6) =       0.000553433712
  error estimate for blocks of size 2^( 7) =       0.000552377648

      target function =      -0.609960977856
              le_mean =     -22.667382977794
             les_mean =     514.311704806360
             stat err =       0.000549511820
             autocorr =       1.244011037694
   target nu stat err =       0.000549511820
   target dn stat err =       0.005508423911
      target stat err =       0.001684761022
              std dev =       0.696754720698
             le_variance =       0.485467140815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609960980797        initial  <--
     5.6843e+03     5.6843e+04             5.8564e-08        -0.609960933606
     2.2737e+04     2.2737e+05             1.4641e-08        -0.609960957237
     9.0949e+04     9.0949e+05             3.6603e-09        -0.609960977856

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 85.8139
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364075e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330846e-02 3 1  ON 4
ci_006                 2.338095e-02 3 1  ON 5
ci_007                 1.858784e-02 3 1  ON 6
ci_008                 1.897985e-02 3 1  ON 7
ci_009                -1.495507e-02 3 1  ON 8
ci_010                -1.470818e-02 3 1  ON 9
ci_011                -1.253230e-02 3 1  ON 10
ci_012                -1.211970e-02 3 1  ON 11
ci_013                 1.121073e-02 3 1  ON 12
ci_014                 1.099781e-02 3 1  ON 13
ci_015                 1.260773e-02 3 1  ON 14
ci_016                 1.239653e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268293e-03 3 1  ON 18
ci_020                 3.483691e-03 3 1  ON 19
ci_021                -8.068999e-03 3 1  ON 20
ci_022                -8.280586e-03 3 1  ON 21
ci_023                 6.236746e-03 3 1  ON 22
ci_024                 6.336940e-03 3 1  ON 23
ci_025                 9.040276e-03 3 1  ON 24
ci_026                 8.953082e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651331e-03 3 1  ON 27
ci_029                -5.190329e-03 3 1  ON 28
ci_030                -5.154907e-03 3 1  ON 29
ci_031                -1.760761e-03 3 1  ON 30
ci_032                -1.720981e-03 3 1  ON 31
ci_033                 4.327070e-03 3 1  ON 32
ci_034                 4.225807e-03 3 1  ON 33
ci_035                 2.736835e-03 3 1  ON 34
ci_036                 2.770818e-03 3 1  ON 35
ci_037                 4.702135e-03 3 1  ON 36
ci_038                 4.549571e-03 3 1  ON 37
ci_039                 4.574579e-03 3 1  ON 38
ci_040                 4.649413e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564834e-03 3 1  ON 41
ci_043                 3.872166e-03 3 1  ON 42
ci_044                 4.055214e-03 3 1  ON 43
ci_045                 3.213817e-03 3 1  ON 44
ci_046                 3.196822e-03 3 1  ON 45
ci_047                -1.607598e-03 3 1  ON 46
ci_048                -1.717714e-03 3 1  ON 47
ci_049                 1.399622e-03 3 1  ON 48
ci_050                 1.488379e-03 3 1  ON 49
ci_051                -2.173864e-03 3 1  ON 50
ci_052                -2.076685e-03 3 1  ON 51
ci_053                -2.236148e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129025e-03 3 1  ON 54
ci_056                -1.635959e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464192e-03 3 1  ON 57
ci_059                -8.259852e-04 3 1  ON 58
ci_060                -6.614105e-04 3 1  ON 59
ci_061                -9.769512e-04 3 1  ON 60
ci_062                -7.221485e-04 3 1  ON 61
ci_063                -6.062572e-04 3 1  ON 62
ci_064                -7.520617e-04 3 1  ON 63
ci_065                -1.915683e-03 3 1  ON 64
ci_066                -2.110265e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105584e-03 3 1  ON 67
ci_069                -1.833720e-05 3 1  ON 68
ci_070                 1.324088e-04 3 1  ON 69
ci_071                -1.880844e-03 3 1  ON 70
ci_072                -1.750602e-03 3 1  ON 71
ci_073                 5.032107e-04 3 1  ON 72
ci_074                 4.904860e-04 3 1  ON 73
ci_075                -1.860262e-04 3 1  ON 74
ci_076                -1.192327e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4671e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.717
    reference variance = 0.337247
====================================================
  Execution time = 5.1222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 4.9459e-01
  Total weights = 1.954810512e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482470578989
                                         uncertainty =       0.002638866642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482470578989
                                         uncertainty =       0.002638866642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491163782
  error estimate for blocks of size 2^( 2) =       0.000510111523
  error estimate for blocks of size 2^( 3) =       0.000527441671
  error estimate for blocks of size 2^( 4) =       0.000540201430
  error estimate for blocks of size 2^( 5) =       0.000547834161
  error estimate for blocks of size 2^( 6) =       0.000550322188
  error estimate for blocks of size 2^( 7) =       0.000550698744

      target function =      -0.612038731159
              le_mean =     -22.667367526963
             les_mean =     514.304139667613
             stat err =       0.000547264131
             autocorr =       1.241484491965
   target nu stat err =       0.000547264131
   target dn stat err =       0.003624780176
      target stat err =       0.001134578226
              std dev =       0.694610481885
             le_variance =       0.482483721544


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266736752696e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612040555248       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612040556085       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612040556188       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612040556209       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612040556204       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612040556252       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612040556214       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612040556343       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612040556215       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612040556223       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+04 is 6.657799e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612040555248       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612040555457       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612040555483       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612040555488       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612040555429       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612040555330       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612040555595       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612040555407       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612040555325       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612040555703       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+05 is 1.664451e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612040555248       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612040555300       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612040555306       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612040555339       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612040555308       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612040555505       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612040556816       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612040556129       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612040555339       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.612040553439       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+05 is 4.161127e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.916390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0650e+01
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364075e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330846e-02 3 1  ON 4
ci_006                 2.338095e-02 3 1  ON 5
ci_007                 1.858784e-02 3 1  ON 6
ci_008                 1.897985e-02 3 1  ON 7
ci_009                -1.495507e-02 3 1  ON 8
ci_010                -1.470818e-02 3 1  ON 9
ci_011                -1.253230e-02 3 1  ON 10
ci_012                -1.211970e-02 3 1  ON 11
ci_013                 1.121073e-02 3 1  ON 12
ci_014                 1.099781e-02 3 1  ON 13
ci_015                 1.260773e-02 3 1  ON 14
ci_016                 1.239653e-02 3 1  ON 15
ci_017                 1.049809e-02 3 1  ON 16
ci_018                 1.047878e-02 3 1  ON 17
ci_019                 3.268292e-03 3 1  ON 18
ci_020                 3.483690e-03 3 1  ON 19
ci_021                -8.068999e-03 3 1  ON 20
ci_022                -8.280586e-03 3 1  ON 21
ci_023                 6.236746e-03 3 1  ON 22
ci_024                 6.336939e-03 3 1  ON 23
ci_025                 9.040276e-03 3 1  ON 24
ci_026                 8.953082e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651331e-03 3 1  ON 27
ci_029                -5.190328e-03 3 1  ON 28
ci_030                -5.154906e-03 3 1  ON 29
ci_031                -1.760760e-03 3 1  ON 30
ci_032                -1.720981e-03 3 1  ON 31
ci_033                 4.327069e-03 3 1  ON 32
ci_034                 4.225807e-03 3 1  ON 33
ci_035                 2.736834e-03 3 1  ON 34
ci_036                 2.770818e-03 3 1  ON 35
ci_037                 4.702135e-03 3 1  ON 36
ci_038                 4.549571e-03 3 1  ON 37
ci_039                 4.574579e-03 3 1  ON 38
ci_040                 4.649413e-03 3 1  ON 39
ci_041                 3.713182e-03 3 1  ON 40
ci_042                 3.564834e-03 3 1  ON 41
ci_043                 3.872166e-03 3 1  ON 42
ci_044                 4.055214e-03 3 1  ON 43
ci_045                 3.213817e-03 3 1  ON 44
ci_046                 3.196822e-03 3 1  ON 45
ci_047                -1.607598e-03 3 1  ON 46
ci_048                -1.717714e-03 3 1  ON 47
ci_049                 1.399622e-03 3 1  ON 48
ci_050                 1.488379e-03 3 1  ON 49
ci_051                -2.173864e-03 3 1  ON 50
ci_052                -2.076685e-03 3 1  ON 51
ci_053                -2.236148e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129025e-03 3 1  ON 54
ci_056                -1.635959e-03 3 1  ON 55
ci_057                -1.221581e-03 3 1  ON 56
ci_058                -1.464191e-03 3 1  ON 57
ci_059                -8.259851e-04 3 1  ON 58
ci_060                -6.614104e-04 3 1  ON 59
ci_061                -9.769510e-04 3 1  ON 60
ci_062                -7.221486e-04 3 1  ON 61
ci_063                -6.062573e-04 3 1  ON 62
ci_064                -7.520617e-04 3 1  ON 63
ci_065                -1.915683e-03 3 1  ON 64
ci_066                -2.110265e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105584e-03 3 1  ON 67
ci_069                -1.833710e-05 3 1  ON 68
ci_070                 1.324088e-04 3 1  ON 69
ci_071                -1.880844e-03 3 1  ON 70
ci_072                -1.750602e-03 3 1  ON 71
ci_073                 5.032107e-04 3 1  ON 72
ci_074                 4.904867e-04 3 1  ON 73
ci_075                -1.860264e-04 3 1  ON 74
ci_076                -1.192327e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.6599
    reference variance = 0.27153
====================================================
  Execution time = 4.9725e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0430e-01
  Total weights = 1.9554e+06
  Execution time = 7.2143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489361698723
                                         uncertainty =       0.003424245549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489361698723
                                         uncertainty =       0.003424245549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494755130
  error estimate for blocks of size 2^( 2) =       0.000513060278
  error estimate for blocks of size 2^( 3) =       0.000530075441
  error estimate for blocks of size 2^( 4) =       0.000541992740
  error estimate for blocks of size 2^( 5) =       0.000548692026
  error estimate for blocks of size 2^( 6) =       0.000551324411
  error estimate for blocks of size 2^( 7) =       0.000552518891

      target function =      -0.609172352046
              le_mean =     -22.667654211092
             les_mean =     514.326844556109
             stat err =       0.000548632017
             autocorr =       1.229650487065
   target nu stat err =       0.000548632017
   target dn stat err =       0.004761031560
      target stat err =       0.001459101370
              std dev =       0.699689414307
             le_variance =       0.489565276493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489361695040
                                         uncertainty =       0.003424245693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489361695040
                                         uncertainty =       0.003424245693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494755128
  error estimate for blocks of size 2^( 2) =       0.000513060277
  error estimate for blocks of size 2^( 3) =       0.000530075439
  error estimate for blocks of size 2^( 4) =       0.000541992739
  error estimate for blocks of size 2^( 5) =       0.000548692024
  error estimate for blocks of size 2^( 6) =       0.000551324409
  error estimate for blocks of size 2^( 7) =       0.000552518889

      target function =      -0.609172352116
              le_mean =     -22.667654211129
             les_mean =     514.326844557575
             stat err =       0.000548632015
             autocorr =       1.229650487926
   target nu stat err =       0.000548632015
   target dn stat err =       0.004761031064
      target stat err =       0.001459101224
              std dev =       0.699689411670
             le_variance =       0.489565272803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489361696882
                                         uncertainty =       0.003424245621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489361696882
                                         uncertainty =       0.003424245621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494755129
  error estimate for blocks of size 2^( 2) =       0.000513060277
  error estimate for blocks of size 2^( 3) =       0.000530075440
  error estimate for blocks of size 2^( 4) =       0.000541992740
  error estimate for blocks of size 2^( 5) =       0.000548692025
  error estimate for blocks of size 2^( 6) =       0.000551324410
  error estimate for blocks of size 2^( 7) =       0.000552518890

      target function =      -0.609172352081
              le_mean =     -22.667654211110
             les_mean =     514.326844556842
             stat err =       0.000548632016
             autocorr =       1.229650487500
   target nu stat err =       0.000548632016
   target dn stat err =       0.004761031312
      target stat err =       0.001459101297
              std dev =       0.699689412988
             le_variance =       0.489565274648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489361698493
                                         uncertainty =       0.003424245558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489361698493
                                         uncertainty =       0.003424245558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494755129
  error estimate for blocks of size 2^( 2) =       0.000513060278
  error estimate for blocks of size 2^( 3) =       0.000530075440
  error estimate for blocks of size 2^( 4) =       0.000541992740
  error estimate for blocks of size 2^( 5) =       0.000548692026
  error estimate for blocks of size 2^( 6) =       0.000551324411
  error estimate for blocks of size 2^( 7) =       0.000552518891

      target function =      -0.609172352051
              le_mean =     -22.667654211094
             les_mean =     514.326844556201
             stat err =       0.000548632017
             autocorr =       1.229650487115
   target nu stat err =       0.000548632017
   target dn stat err =       0.004761031529
      target stat err =       0.001459101361
              std dev =       0.699689414142
             le_variance =       0.489565276263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.609172352046        initial
     5.6843e+04     5.6843e+05             6.6578e-09        -0.609172352116  <--
     2.2737e+05     2.2737e+06             1.6645e-09        -0.609172352081
     9.0949e+05     9.0949e+06             4.1611e-10        -0.609172352051

*****************************************************************************
Applying the update for shift_i =   5.6843e+04     and shift_s =   5.6843e+05
*****************************************************************************

  Execution time = 8.5904e+01
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364075e-02 3 1  ON 2
ci_004                -5.404232e-02 3 1  ON 3
ci_005                 2.330846e-02 3 1  ON 4
ci_006                 2.338094e-02 3 1  ON 5
ci_007                 1.858783e-02 3 1  ON 6
ci_008                 1.897985e-02 3 1  ON 7
ci_009                -1.495507e-02 3 1  ON 8
ci_010                -1.470818e-02 3 1  ON 9
ci_011                -1.253230e-02 3 1  ON 10
ci_012                -1.211970e-02 3 1  ON 11
ci_013                 1.121073e-02 3 1  ON 12
ci_014                 1.099781e-02 3 1  ON 13
ci_015                 1.260772e-02 3 1  ON 14
ci_016                 1.239653e-02 3 1  ON 15
ci_017                 1.049808e-02 3 1  ON 16
ci_018                 1.047877e-02 3 1  ON 17
ci_019                 3.268290e-03 3 1  ON 18
ci_020                 3.483687e-03 3 1  ON 19
ci_021                -8.068998e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236746e-03 3 1  ON 22
ci_024                 6.336939e-03 3 1  ON 23
ci_025                 9.040276e-03 3 1  ON 24
ci_026                 8.953083e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651331e-03 3 1  ON 27
ci_029                -5.190328e-03 3 1  ON 28
ci_030                -5.154906e-03 3 1  ON 29
ci_031                -1.760758e-03 3 1  ON 30
ci_032                -1.720979e-03 3 1  ON 31
ci_033                 4.327068e-03 3 1  ON 32
ci_034                 4.225806e-03 3 1  ON 33
ci_035                 2.736834e-03 3 1  ON 34
ci_036                 2.770816e-03 3 1  ON 35
ci_037                 4.702134e-03 3 1  ON 36
ci_038                 4.549571e-03 3 1  ON 37
ci_039                 4.574579e-03 3 1  ON 38
ci_040                 4.649412e-03 3 1  ON 39
ci_041                 3.713181e-03 3 1  ON 40
ci_042                 3.564834e-03 3 1  ON 41
ci_043                 3.872166e-03 3 1  ON 42
ci_044                 4.055213e-03 3 1  ON 43
ci_045                 3.213817e-03 3 1  ON 44
ci_046                 3.196821e-03 3 1  ON 45
ci_047                -1.607599e-03 3 1  ON 46
ci_048                -1.717714e-03 3 1  ON 47
ci_049                 1.399621e-03 3 1  ON 48
ci_050                 1.488378e-03 3 1  ON 49
ci_051                -2.173863e-03 3 1  ON 50
ci_052                -2.076684e-03 3 1  ON 51
ci_053                -2.236148e-03 3 1  ON 52
ci_054                -2.386088e-03 3 1  ON 53
ci_055                -1.129026e-03 3 1  ON 54
ci_056                -1.635959e-03 3 1  ON 55
ci_057                -1.221582e-03 3 1  ON 56
ci_058                -1.464189e-03 3 1  ON 57
ci_059                -8.259849e-04 3 1  ON 58
ci_060                -6.614101e-04 3 1  ON 59
ci_061                -9.769506e-04 3 1  ON 60
ci_062                -7.221489e-04 3 1  ON 61
ci_063                -6.062577e-04 3 1  ON 62
ci_064                -7.520619e-04 3 1  ON 63
ci_065                -1.915682e-03 3 1  ON 64
ci_066                -2.110265e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105583e-03 3 1  ON 67
ci_069                -1.833681e-05 3 1  ON 68
ci_070                 1.324085e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750602e-03 3 1  ON 71
ci_073                 5.032107e-04 3 1  ON 72
ci_074                 4.904888e-04 3 1  ON 73
ci_075                -1.860270e-04 3 1  ON 74
ci_076                -1.192328e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4656e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.772
    reference variance = 0.85025
====================================================
  Execution time = 5.1404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0297e-01
  Total weights = 1.954807748e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491852477518
                                         uncertainty =       0.006141386379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491852477518
                                         uncertainty =       0.006141386379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495926475
  error estimate for blocks of size 2^( 2) =       0.000514171515
  error estimate for blocks of size 2^( 3) =       0.000530517645
  error estimate for blocks of size 2^( 4) =       0.000542247287
  error estimate for blocks of size 2^( 5) =       0.000549040229
  error estimate for blocks of size 2^( 6) =       0.000553146816
  error estimate for blocks of size 2^( 7) =       0.000554479411

      target function =      -0.609809711192
              le_mean =     -22.668617286171
             les_mean =     514.369177429682
             stat err =       0.000549728436
             autocorr =       1.228745151259
   target nu stat err =       0.000549728436
   target dn stat err =       0.006242365873
      target stat err =       0.001904718732
              std dev =       0.701345946820
             le_variance =       0.491886137121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266861728617e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609815431473       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609815434040       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609815434341       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609815434354       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609815434372       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609815434354       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609815434348       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609815434362       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+04 is 2.305951e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609815431473       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609815432115       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609815432190       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609815432193       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609815432097       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609815432195       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609815432313       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609815432222       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+04 is 5.764891e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609815431473       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609815431633       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609815431652       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609815431653       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609815432021       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609815431639       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609815431241       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609815431444       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+05 is 1.441223e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.920368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0734e+01
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027645e-01 3 1  ON 1
ci_003                -5.364075e-02 3 1  ON 2
ci_004                -5.404231e-02 3 1  ON 3
ci_005                 2.330845e-02 3 1  ON 4
ci_006                 2.338094e-02 3 1  ON 5
ci_007                 1.858783e-02 3 1  ON 6
ci_008                 1.897984e-02 3 1  ON 7
ci_009                -1.495507e-02 3 1  ON 8
ci_010                -1.470817e-02 3 1  ON 9
ci_011                -1.253229e-02 3 1  ON 10
ci_012                -1.211969e-02 3 1  ON 11
ci_013                 1.121072e-02 3 1  ON 12
ci_014                 1.099780e-02 3 1  ON 13
ci_015                 1.260772e-02 3 1  ON 14
ci_016                 1.239653e-02 3 1  ON 15
ci_017                 1.049808e-02 3 1  ON 16
ci_018                 1.047877e-02 3 1  ON 17
ci_019                 3.268287e-03 3 1  ON 18
ci_020                 3.483685e-03 3 1  ON 19
ci_021                -8.068998e-03 3 1  ON 20
ci_022                -8.280587e-03 3 1  ON 21
ci_023                 6.236745e-03 3 1  ON 22
ci_024                 6.336938e-03 3 1  ON 23
ci_025                 9.040277e-03 3 1  ON 24
ci_026                 8.953085e-03 3 1  ON 25
ci_027                 6.585402e-03 3 1  ON 26
ci_028                 6.651331e-03 3 1  ON 27
ci_029                -5.190327e-03 3 1  ON 28
ci_030                -5.154905e-03 3 1  ON 29
ci_031                -1.760756e-03 3 1  ON 30
ci_032                -1.720978e-03 3 1  ON 31
ci_033                 4.327068e-03 3 1  ON 32
ci_034                 4.225805e-03 3 1  ON 33
ci_035                 2.736833e-03 3 1  ON 34
ci_036                 2.770816e-03 3 1  ON 35
ci_037                 4.702134e-03 3 1  ON 36
ci_038                 4.549570e-03 3 1  ON 37
ci_039                 4.574580e-03 3 1  ON 38
ci_040                 4.649412e-03 3 1  ON 39
ci_041                 3.713180e-03 3 1  ON 40
ci_042                 3.564833e-03 3 1  ON 41
ci_043                 3.872167e-03 3 1  ON 42
ci_044                 4.055213e-03 3 1  ON 43
ci_045                 3.213816e-03 3 1  ON 44
ci_046                 3.196821e-03 3 1  ON 45
ci_047                -1.607598e-03 3 1  ON 46
ci_048                -1.717713e-03 3 1  ON 47
ci_049                 1.399621e-03 3 1  ON 48
ci_050                 1.488378e-03 3 1  ON 49
ci_051                -2.173863e-03 3 1  ON 50
ci_052                -2.076684e-03 3 1  ON 51
ci_053                -2.236148e-03 3 1  ON 52
ci_054                -2.386087e-03 3 1  ON 53
ci_055                -1.129025e-03 3 1  ON 54
ci_056                -1.635959e-03 3 1  ON 55
ci_057                -1.221582e-03 3 1  ON 56
ci_058                -1.464188e-03 3 1  ON 57
ci_059                -8.259847e-04 3 1  ON 58
ci_060                -6.614087e-04 3 1  ON 59
ci_061                -9.769499e-04 3 1  ON 60
ci_062                -7.221489e-04 3 1  ON 61
ci_063                -6.062582e-04 3 1  ON 62
ci_064                -7.520623e-04 3 1  ON 63
ci_065                -1.915684e-03 3 1  ON 64
ci_066                -2.110264e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105583e-03 3 1  ON 67
ci_069                -1.833687e-05 3 1  ON 68
ci_070                 1.324081e-04 3 1  ON 69
ci_071                -1.880845e-03 3 1  ON 70
ci_072                -1.750602e-03 3 1  ON 71
ci_073                 5.032104e-04 3 1  ON 72
ci_074                 4.904899e-04 3 1  ON 73
ci_075                -1.860271e-04 3 1  ON 74
ci_076                -1.192322e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.6348
    reference variance = 0.458926
====================================================
  Execution time = 4.9785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9912e-01
  Total weights = 1.9550e+06
  Execution time = 7.2512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486491801274
                                         uncertainty =       0.003354207953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486491801274
                                         uncertainty =       0.003354207953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493228258
  error estimate for blocks of size 2^( 2) =       0.000511431383
  error estimate for blocks of size 2^( 3) =       0.000528245454
  error estimate for blocks of size 2^( 4) =       0.000540151313
  error estimate for blocks of size 2^( 5) =       0.000547492633
  error estimate for blocks of size 2^( 6) =       0.000550412652
  error estimate for blocks of size 2^( 7) =       0.000552123524

      target function =      -0.610898488203
              le_mean =     -22.668296800957
             les_mean =     514.350795752790
             stat err =       0.000547545031
             autocorr =       1.232377565848
   target nu stat err =       0.000547545031
   target dn stat err =       0.003960286132
      target stat err =       0.001230288846
              std dev =       0.697530091202
             le_variance =       0.486548228132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486491783907
                                         uncertainty =       0.003354207028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486491783907
                                         uncertainty =       0.003354207028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493228249
  error estimate for blocks of size 2^( 2) =       0.000511431374
  error estimate for blocks of size 2^( 3) =       0.000528245445
  error estimate for blocks of size 2^( 4) =       0.000540151304
  error estimate for blocks of size 2^( 5) =       0.000547492624
  error estimate for blocks of size 2^( 6) =       0.000550412643
  error estimate for blocks of size 2^( 7) =       0.000552123515

      target function =      -0.610898488464
              le_mean =     -22.668296801175
             les_mean =     514.350795761988
             stat err =       0.000547545022
             autocorr =       1.232377569121
   target nu stat err =       0.000547545022
   target dn stat err =       0.003960288961
      target stat err =       0.001230289683
              std dev =       0.697530078727
             le_variance =       0.486548210729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486491792590
                                         uncertainty =       0.003354207491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486491792590
                                         uncertainty =       0.003354207491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493228253
  error estimate for blocks of size 2^( 2) =       0.000511431378
  error estimate for blocks of size 2^( 3) =       0.000528245450
  error estimate for blocks of size 2^( 4) =       0.000540151309
  error estimate for blocks of size 2^( 5) =       0.000547492629
  error estimate for blocks of size 2^( 6) =       0.000550412648
  error estimate for blocks of size 2^( 7) =       0.000552123519

      target function =      -0.610898488334
              le_mean =     -22.668296801066
             les_mean =     514.350795757387
             stat err =       0.000547545026
             autocorr =       1.232377567482
   target nu stat err =       0.000547545026
   target dn stat err =       0.003960287546
      target stat err =       0.001230289264
              std dev =       0.697530084964
             le_variance =       0.486548219430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486491800189
                                         uncertainty =       0.003354207895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486491800189
                                         uncertainty =       0.003354207895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493228257
  error estimate for blocks of size 2^( 2) =       0.000511431382
  error estimate for blocks of size 2^( 3) =       0.000528245454
  error estimate for blocks of size 2^( 4) =       0.000540151313
  error estimate for blocks of size 2^( 5) =       0.000547492633
  error estimate for blocks of size 2^( 6) =       0.000550412652
  error estimate for blocks of size 2^( 7) =       0.000552123523

      target function =      -0.610898488220
              le_mean =     -22.668296800970
             les_mean =     514.350795753364
             stat err =       0.000547545030
             autocorr =       1.232377566047
   target nu stat err =       0.000547545030
   target dn stat err =       0.003960286309
      target stat err =       0.001230288898
              std dev =       0.697530090422
             le_variance =       0.486548227044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610898488203        initial
     1.4211e+04     1.4211e+05             2.3060e-08        -0.610898488464  <--
     5.6843e+04     5.6843e+05             5.7649e-09        -0.610898488334
     2.2737e+05     2.2737e+06             1.4412e-09        -0.610898488220

*****************************************************************************
Applying the update for shift_i =   1.4211e+04     and shift_s =   1.4211e+05
*****************************************************************************

  Execution time = 8.6162e+01
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027646e-01 3 1  ON 1
ci_003                -5.364074e-02 3 1  ON 2
ci_004                -5.404231e-02 3 1  ON 3
ci_005                 2.330844e-02 3 1  ON 4
ci_006                 2.338092e-02 3 1  ON 5
ci_007                 1.858782e-02 3 1  ON 6
ci_008                 1.897983e-02 3 1  ON 7
ci_009                -1.495506e-02 3 1  ON 8
ci_010                -1.470816e-02 3 1  ON 9
ci_011                -1.253229e-02 3 1  ON 10
ci_012                -1.211969e-02 3 1  ON 11
ci_013                 1.121071e-02 3 1  ON 12
ci_014                 1.099779e-02 3 1  ON 13
ci_015                 1.260771e-02 3 1  ON 14
ci_016                 1.239652e-02 3 1  ON 15
ci_017                 1.049808e-02 3 1  ON 16
ci_018                 1.047877e-02 3 1  ON 17
ci_019                 3.268278e-03 3 1  ON 18
ci_020                 3.483680e-03 3 1  ON 19
ci_021                -8.068998e-03 3 1  ON 20
ci_022                -8.280588e-03 3 1  ON 21
ci_023                 6.236745e-03 3 1  ON 22
ci_024                 6.336935e-03 3 1  ON 23
ci_025                 9.040280e-03 3 1  ON 24
ci_026                 8.953091e-03 3 1  ON 25
ci_027                 6.585403e-03 3 1  ON 26
ci_028                 6.651332e-03 3 1  ON 27
ci_029                -5.190324e-03 3 1  ON 28
ci_030                -5.154903e-03 3 1  ON 29
ci_031                -1.760749e-03 3 1  ON 30
ci_032                -1.720973e-03 3 1  ON 31
ci_033                 4.327066e-03 3 1  ON 32
ci_034                 4.225802e-03 3 1  ON 33
ci_035                 2.736830e-03 3 1  ON 34
ci_036                 2.770814e-03 3 1  ON 35
ci_037                 4.702132e-03 3 1  ON 36
ci_038                 4.549569e-03 3 1  ON 37
ci_039                 4.574581e-03 3 1  ON 38
ci_040                 4.649412e-03 3 1  ON 39
ci_041                 3.713179e-03 3 1  ON 40
ci_042                 3.564833e-03 3 1  ON 41
ci_043                 3.872170e-03 3 1  ON 42
ci_044                 4.055212e-03 3 1  ON 43
ci_045                 3.213813e-03 3 1  ON 44
ci_046                 3.196819e-03 3 1  ON 45
ci_047                -1.607598e-03 3 1  ON 46
ci_048                -1.717710e-03 3 1  ON 47
ci_049                 1.399621e-03 3 1  ON 48
ci_050                 1.488376e-03 3 1  ON 49
ci_051                -2.173864e-03 3 1  ON 50
ci_052                -2.076682e-03 3 1  ON 51
ci_053                -2.236148e-03 3 1  ON 52
ci_054                -2.386087e-03 3 1  ON 53
ci_055                -1.129024e-03 3 1  ON 54
ci_056                -1.635961e-03 3 1  ON 55
ci_057                -1.221583e-03 3 1  ON 56
ci_058                -1.464186e-03 3 1  ON 57
ci_059                -8.259842e-04 3 1  ON 58
ci_060                -6.614042e-04 3 1  ON 59
ci_061                -9.769479e-04 3 1  ON 60
ci_062                -7.221490e-04 3 1  ON 61
ci_063                -6.062598e-04 3 1  ON 62
ci_064                -7.520635e-04 3 1  ON 63
ci_065                -1.915687e-03 3 1  ON 64
ci_066                -2.110261e-03 3 1  ON 65
ci_067                -1.464152e-03 3 1  ON 66
ci_068                -1.105584e-03 3 1  ON 67
ci_069                -1.833706e-05 3 1  ON 68
ci_070                 1.324071e-04 3 1  ON 69
ci_071                -1.880846e-03 3 1  ON 70
ci_072                -1.750603e-03 3 1  ON 71
ci_073                 5.032095e-04 3 1  ON 72
ci_074                 4.904933e-04 3 1  ON 73
ci_075                -1.860273e-04 3 1  ON 74
ci_076                -1.192305e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4690e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.8719
    reference variance = 1.40241
====================================================
  Execution time = 5.1324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0464e-01
  Total weights = 1.954948757e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491023474185
                                         uncertainty =       0.005329022472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491023474185
                                         uncertainty =       0.005329022472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495499902
  error estimate for blocks of size 2^( 2) =       0.000513466783
  error estimate for blocks of size 2^( 3) =       0.000530018892
  error estimate for blocks of size 2^( 4) =       0.000541712335
  error estimate for blocks of size 2^( 5) =       0.000549921998
  error estimate for blocks of size 2^( 6) =       0.000554336783
  error estimate for blocks of size 2^( 7) =       0.000557467827

      target function =      -0.609379640412
              le_mean =     -22.668917806462
             les_mean =     514.384474981913
             stat err =       0.000550859736
             autocorr =       1.235932958777
   target nu stat err =       0.000550859736
   target dn stat err =       0.006134807970
      target stat err =       0.001870500950
              std dev =       0.700742681035
             le_variance =       0.491040305025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266891780646e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609385135724       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609385146052       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609385147042       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609385147157       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609385147203       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609385147244       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609385147244       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609385147250       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609385147244       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609385147252       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+03 is 9.711378e-08

solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609385135724       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609385138306       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609385138554       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609385138585       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609385138605       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609385138639       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609385138606       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609385138610       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609385138601       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609385138609       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+04 is 2.427865e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609385135724       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609385136370       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609385136432       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609385136447       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609385136243       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609385136561       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609385136464       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609385136444       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609385136397       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609385136444       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+04 is 6.069676e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.925454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0677e+01
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_001                -7.044635e-01 3 1  ON 0
ci_002                -7.027646e-01 3 1  ON 1
ci_003                -5.364072e-02 3 1  ON 2
ci_004                -5.404230e-02 3 1  ON 3
ci_005                 2.330841e-02 3 1  ON 4
ci_006                 2.338090e-02 3 1  ON 5
ci_007                 1.858780e-02 3 1  ON 6
ci_008                 1.897981e-02 3 1  ON 7
ci_009                -1.495505e-02 3 1  ON 8
ci_010                -1.470815e-02 3 1  ON 9
ci_011                -1.253227e-02 3 1  ON 10
ci_012                -1.211968e-02 3 1  ON 11
ci_013                 1.121071e-02 3 1  ON 12
ci_014                 1.099778e-02 3 1  ON 13
ci_015                 1.260770e-02 3 1  ON 14
ci_016                 1.239651e-02 3 1  ON 15
ci_017                 1.049807e-02 3 1  ON 16
ci_018                 1.047876e-02 3 1  ON 17
ci_019                 3.268273e-03 3 1  ON 18
ci_020                 3.483674e-03 3 1  ON 19
ci_021                -8.068991e-03 3 1  ON 20
ci_022                -8.280586e-03 3 1  ON 21
ci_023                 6.236742e-03 3 1  ON 22
ci_024                 6.336934e-03 3 1  ON 23
ci_025                 9.040279e-03 3 1  ON 24
ci_026                 8.953092e-03 3 1  ON 25
ci_027                 6.585403e-03 3 1  ON 26
ci_028                 6.651334e-03 3 1  ON 27
ci_029                -5.190325e-03 3 1  ON 28
ci_030                -5.154904e-03 3 1  ON 29
ci_031                -1.760743e-03 3 1  ON 30
ci_032                -1.720964e-03 3 1  ON 31
ci_033                 4.327064e-03 3 1  ON 32
ci_034                 4.225799e-03 3 1  ON 33
ci_035                 2.736826e-03 3 1  ON 34
ci_036                 2.770811e-03 3 1  ON 35
ci_037                 4.702126e-03 3 1  ON 36
ci_038                 4.549568e-03 3 1  ON 37
ci_039                 4.574575e-03 3 1  ON 38
ci_040                 4.649413e-03 3 1  ON 39
ci_041                 3.713180e-03 3 1  ON 40
ci_042                 3.564835e-03 3 1  ON 41
ci_043                 3.872166e-03 3 1  ON 42
ci_044                 4.055210e-03 3 1  ON 43
ci_045                 3.213808e-03 3 1  ON 44
ci_046                 3.196812e-03 3 1  ON 45
ci_047                -1.607597e-03 3 1  ON 46
ci_048                -1.717708e-03 3 1  ON 47
ci_049                 1.399618e-03 3 1  ON 48
ci_050                 1.488375e-03 3 1  ON 49
ci_051                -2.173857e-03 3 1  ON 50
ci_052                -2.076682e-03 3 1  ON 51
ci_053                -2.236145e-03 3 1  ON 52
ci_054                -2.386086e-03 3 1  ON 53
ci_055                -1.129024e-03 3 1  ON 54
ci_056                -1.635957e-03 3 1  ON 55
ci_057                -1.221580e-03 3 1  ON 56
ci_058                -1.464187e-03 3 1  ON 57
ci_059                -8.259829e-04 3 1  ON 58
ci_060                -6.614040e-04 3 1  ON 59
ci_061                -9.769455e-04 3 1  ON 60
ci_062                -7.221435e-04 3 1  ON 61
ci_063                -6.062600e-04 3 1  ON 62
ci_064                -7.520641e-04 3 1  ON 63
ci_065                -1.915686e-03 3 1  ON 64
ci_066                -2.110258e-03 3 1  ON 65
ci_067                -1.464155e-03 3 1  ON 66
ci_068                -1.105584e-03 3 1  ON 67
ci_069                -1.834099e-05 3 1  ON 68
ci_070                 1.324072e-04 3 1  ON 69
ci_071                -1.880852e-03 3 1  ON 70
ci_072                -1.750604e-03 3 1  ON 71
ci_073                 5.032066e-04 3 1  ON 72
ci_074                 4.904895e-04 3 1  ON 73
ci_075                -1.860189e-04 3 1  ON 74
ci_076                -1.192335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.6788
    reference variance = 0.279416
====================================================
  Execution time = 4.9738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9486e-01
  Total weights = 1.9550e+06
  Execution time = 7.2236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481678075482
                                         uncertainty =       0.003448636371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481678075482
                                         uncertainty =       0.003448636371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490798742
  error estimate for blocks of size 2^( 2) =       0.000509553747
  error estimate for blocks of size 2^( 3) =       0.000526579374
  error estimate for blocks of size 2^( 4) =       0.000539562517
  error estimate for blocks of size 2^( 5) =       0.000546192443
  error estimate for blocks of size 2^( 6) =       0.000550968113
  error estimate for blocks of size 2^( 7) =       0.000552791504

      target function =      -0.612277097261
              le_mean =     -22.668644654567
             les_mean =     514.362314027540
             stat err =       0.000547378645
             autocorr =       1.243852314191
   target nu stat err =       0.000547378645
   target dn stat err =       0.004218099866
      target stat err =       0.001312722357
              std dev =       0.694094236766
             le_variance =       0.481766809512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481678019489
                                         uncertainty =       0.003448633959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481678019489
                                         uncertainty =       0.003448633959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490798713
  error estimate for blocks of size 2^( 2) =       0.000509553720
  error estimate for blocks of size 2^( 3) =       0.000526579348
  error estimate for blocks of size 2^( 4) =       0.000539562491
  error estimate for blocks of size 2^( 5) =       0.000546192417
  error estimate for blocks of size 2^( 6) =       0.000550968085
  error estimate for blocks of size 2^( 7) =       0.000552791477

      target function =      -0.612277171121
              le_mean =     -22.668644654399
             les_mean =     514.362313777119
             stat err =       0.000547378618
             autocorr =       1.243852336084
   target nu stat err =       0.000547378618
   target dn stat err =       0.004218107859
      target stat err =       0.001312725045
              std dev =       0.694094196479
             le_variance =       0.481766753586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481678047485
                                         uncertainty =       0.003448635165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481678047485
                                         uncertainty =       0.003448635165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490798727
  error estimate for blocks of size 2^( 2) =       0.000509553733
  error estimate for blocks of size 2^( 3) =       0.000526579361
  error estimate for blocks of size 2^( 4) =       0.000539562504
  error estimate for blocks of size 2^( 5) =       0.000546192430
  error estimate for blocks of size 2^( 6) =       0.000550968099
  error estimate for blocks of size 2^( 7) =       0.000552791491

      target function =      -0.612277134294
              le_mean =     -22.668644654483
             les_mean =     514.362313901990
             stat err =       0.000547378631
             autocorr =       1.243852325143
   target nu stat err =       0.000547378631
   target dn stat err =       0.004218103861
      target stat err =       0.001312723701
              std dev =       0.694094216622
             le_variance =       0.481766781548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481678071982
                                         uncertainty =       0.003448636221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481678071982
                                         uncertainty =       0.003448636221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490798740
  error estimate for blocks of size 2^( 2) =       0.000509553746
  error estimate for blocks of size 2^( 3) =       0.000526579372
  error estimate for blocks of size 2^( 4) =       0.000539562515
  error estimate for blocks of size 2^( 5) =       0.000546192441
  error estimate for blocks of size 2^( 6) =       0.000550968112
  error estimate for blocks of size 2^( 7) =       0.000552791503

      target function =      -0.612277101901
              le_mean =     -22.668644654557
             les_mean =     514.362314011809
             stat err =       0.000547378643
             autocorr =       1.243852315563
   target nu stat err =       0.000547378643
   target dn stat err =       0.004218100365
      target stat err =       0.001312722525
              std dev =       0.694094234248
             le_variance =       0.481766806016


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.612277097261        initial
     3.5527e+03     3.5527e+04             9.7114e-08        -0.612277171121  <--
     1.4211e+04     1.4211e+05             2.4279e-08        -0.612277134294
     5.6843e+04     5.6843e+05             6.0697e-09        -0.612277101901

*****************************************************************************
Applying the update for shift_i =   3.5527e+03     and shift_s =   3.5527e+04
*****************************************************************************

  Execution time = 8.5956e+01
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_001                -7.044634e-01 3 1  ON 0
ci_002                -7.027646e-01 3 1  ON 1
ci_003                -5.364067e-02 3 1  ON 2
ci_004                -5.404226e-02 3 1  ON 3
ci_005                 2.330835e-02 3 1  ON 4
ci_006                 2.338082e-02 3 1  ON 5
ci_007                 1.858777e-02 3 1  ON 6
ci_008                 1.897977e-02 3 1  ON 7
ci_009                -1.495502e-02 3 1  ON 8
ci_010                -1.470812e-02 3 1  ON 9
ci_011                -1.253222e-02 3 1  ON 10
ci_012                -1.211965e-02 3 1  ON 11
ci_013                 1.121068e-02 3 1  ON 12
ci_014                 1.099775e-02 3 1  ON 13
ci_015                 1.260768e-02 3 1  ON 14
ci_016                 1.239648e-02 3 1  ON 15
ci_017                 1.049805e-02 3 1  ON 16
ci_018                 1.047874e-02 3 1  ON 17
ci_019                 3.268258e-03 3 1  ON 18
ci_020                 3.483656e-03 3 1  ON 19
ci_021                -8.068967e-03 3 1  ON 20
ci_022                -8.280580e-03 3 1  ON 21
ci_023                 6.236733e-03 3 1  ON 22
ci_024                 6.336931e-03 3 1  ON 23
ci_025                 9.040277e-03 3 1  ON 24
ci_026                 8.953095e-03 3 1  ON 25
ci_027                 6.585405e-03 3 1  ON 26
ci_028                 6.651338e-03 3 1  ON 27
ci_029                -5.190329e-03 3 1  ON 28
ci_030                -5.154906e-03 3 1  ON 29
ci_031                -1.760723e-03 3 1  ON 30
ci_032                -1.720937e-03 3 1  ON 31
ci_033                 4.327058e-03 3 1  ON 32
ci_034                 4.225788e-03 3 1  ON 33
ci_035                 2.736815e-03 3 1  ON 34
ci_036                 2.770802e-03 3 1  ON 35
ci_037                 4.702111e-03 3 1  ON 36
ci_038                 4.549564e-03 3 1  ON 37
ci_039                 4.574559e-03 3 1  ON 38
ci_040                 4.649416e-03 3 1  ON 39
ci_041                 3.713181e-03 3 1  ON 40
ci_042                 3.564843e-03 3 1  ON 41
ci_043                 3.872155e-03 3 1  ON 42
ci_044                 4.055205e-03 3 1  ON 43
ci_045                 3.213796e-03 3 1  ON 44
ci_046                 3.196792e-03 3 1  ON 45
ci_047                -1.607594e-03 3 1  ON 46
ci_048                -1.717701e-03 3 1  ON 47
ci_049                 1.399606e-03 3 1  ON 48
ci_050                 1.488373e-03 3 1  ON 49
ci_051                -2.173838e-03 3 1  ON 50
ci_052                -2.076682e-03 3 1  ON 51
ci_053                -2.236136e-03 3 1  ON 52
ci_054                -2.386085e-03 3 1  ON 53
ci_055                -1.129022e-03 3 1  ON 54
ci_056                -1.635947e-03 3 1  ON 55
ci_057                -1.221573e-03 3 1  ON 56
ci_058                -1.464190e-03 3 1  ON 57
ci_059                -8.259790e-04 3 1  ON 58
ci_060                -6.614034e-04 3 1  ON 59
ci_061                -9.769382e-04 3 1  ON 60
ci_062                -7.221270e-04 3 1  ON 61
ci_063                -6.062606e-04 3 1  ON 62
ci_064                -7.520661e-04 3 1  ON 63
ci_065                -1.915680e-03 3 1  ON 64
ci_066                -2.110247e-03 3 1  ON 65
ci_067                -1.464164e-03 3 1  ON 66
ci_068                -1.105584e-03 3 1  ON 67
ci_069                -1.835278e-05 3 1  ON 68
ci_070                 1.324075e-04 3 1  ON 69
ci_071                -1.880873e-03 3 1  ON 70
ci_072                -1.750608e-03 3 1  ON 71
ci_073                 5.031977e-04 3 1  ON 72
ci_074                 4.904781e-04 3 1  ON 73
ci_075                -1.859937e-04 3 1  ON 74
ci_076                -1.192425e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4664e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.6523
    reference variance = 0.534052
====================================================
  Execution time = 5.1338e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0315e-01
  Total weights = 1.955267089e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489625653645
                                         uncertainty =       0.003686570600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489625653645
                                         uncertainty =       0.003686570600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494767812
  error estimate for blocks of size 2^( 2) =       0.000512958908
  error estimate for blocks of size 2^( 3) =       0.000529079106
  error estimate for blocks of size 2^( 4) =       0.000540490962
  error estimate for blocks of size 2^( 5) =       0.000548607103
  error estimate for blocks of size 2^( 6) =       0.000553266690
  error estimate for blocks of size 2^( 7) =       0.000553468408

      target function =      -0.609745303443
              le_mean =     -22.668573174923
             les_mean =     514.367359893607
             stat err =       0.000548958291
             autocorr =       1.231050361682
   target nu stat err =       0.000548958291
   target dn stat err =       0.005365696688
      target stat err =       0.001642654486
              std dev =       0.699707350316
             le_variance =       0.489590376087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266857317492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609749409960       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609749456251       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609749461715       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609749462159       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609749462314       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609749462338       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609749462367       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609749462365       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609749462357       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609749462356       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609749462359       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+02 is 4.036399e-07

solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609749409960       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609749421534       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609749422899       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609749423011       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609749423051       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609749423057       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609749423064       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609749423055       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609749423063       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609749423064       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609749423060       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+03 is 1.009134e-07

solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.609749409960       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.609749412854       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.609749413195       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.609749413225       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.609749413233       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.609749413221       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.609749413235       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.609749413266       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609749413226       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.609749413237       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.609749413234       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+04 is 2.522855e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.931508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0759e+01
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_001                -7.044634e-01 3 1  ON 0
ci_002                -7.027646e-01 3 1  ON 1
ci_003                -5.364061e-02 3 1  ON 2
ci_004                -5.404221e-02 3 1  ON 3
ci_005                 2.330825e-02 3 1  ON 4
ci_006                 2.338074e-02 3 1  ON 5
ci_007                 1.858770e-02 3 1  ON 6
ci_008                 1.897971e-02 3 1  ON 7
ci_009                -1.495497e-02 3 1  ON 8
ci_010                -1.470807e-02 3 1  ON 9
ci_011                -1.253215e-02 3 1  ON 10
ci_012                -1.211960e-02 3 1  ON 11
ci_013                 1.121064e-02 3 1  ON 12
ci_014                 1.099769e-02 3 1  ON 13
ci_015                 1.260764e-02 3 1  ON 14
ci_016                 1.239643e-02 3 1  ON 15
ci_017                 1.049805e-02 3 1  ON 16
ci_018                 1.047871e-02 3 1  ON 17
ci_019                 3.268201e-03 3 1  ON 18
ci_020                 3.483635e-03 3 1  ON 19
ci_021                -8.068946e-03 3 1  ON 20
ci_022                -8.280568e-03 3 1  ON 21
ci_023                 6.236729e-03 3 1  ON 22
ci_024                 6.336895e-03 3 1  ON 23
ci_025                 9.040292e-03 3 1  ON 24
ci_026                 8.953118e-03 3 1  ON 25
ci_027                 6.585410e-03 3 1  ON 26
ci_028                 6.651339e-03 3 1  ON 27
ci_029                -5.190316e-03 3 1  ON 28
ci_030                -5.154922e-03 3 1  ON 29
ci_031                -1.760683e-03 3 1  ON 30
ci_032                -1.720913e-03 3 1  ON 31
ci_033                 4.327049e-03 3 1  ON 32
ci_034                 4.225783e-03 3 1  ON 33
ci_035                 2.736789e-03 3 1  ON 34
ci_036                 2.770785e-03 3 1  ON 35
ci_037                 4.702105e-03 3 1  ON 36
ci_038                 4.549537e-03 3 1  ON 37
ci_039                 4.574557e-03 3 1  ON 38
ci_040                 4.649416e-03 3 1  ON 39
ci_041                 3.713176e-03 3 1  ON 40
ci_042                 3.564841e-03 3 1  ON 41
ci_043                 3.872149e-03 3 1  ON 42
ci_044                 4.055190e-03 3 1  ON 43
ci_045                 3.213806e-03 3 1  ON 44
ci_046                 3.196762e-03 3 1  ON 45
ci_047                -1.607573e-03 3 1  ON 46
ci_048                -1.717699e-03 3 1  ON 47
ci_049                 1.399611e-03 3 1  ON 48
ci_050                 1.488359e-03 3 1  ON 49
ci_051                -2.173839e-03 3 1  ON 50
ci_052                -2.076671e-03 3 1  ON 51
ci_053                -2.236148e-03 3 1  ON 52
ci_054                -2.386102e-03 3 1  ON 53
ci_055                -1.129032e-03 3 1  ON 54
ci_056                -1.635950e-03 3 1  ON 55
ci_057                -1.221580e-03 3 1  ON 56
ci_058                -1.464167e-03 3 1  ON 57
ci_059                -8.259730e-04 3 1  ON 58
ci_060                -6.613999e-04 3 1  ON 59
ci_061                -9.769335e-04 3 1  ON 60
ci_062                -7.221053e-04 3 1  ON 61
ci_063                -6.062455e-04 3 1  ON 62
ci_064                -7.520958e-04 3 1  ON 63
ci_065                -1.915675e-03 3 1  ON 64
ci_066                -2.110233e-03 3 1  ON 65
ci_067                -1.464170e-03 3 1  ON 66
ci_068                -1.105596e-03 3 1  ON 67
ci_069                -1.835229e-05 3 1  ON 68
ci_070                 1.324070e-04 3 1  ON 69
ci_071                -1.880859e-03 3 1  ON 70
ci_072                -1.750605e-03 3 1  ON 71
ci_073                 5.031919e-04 3 1  ON 72
ci_074                 4.904664e-04 3 1  ON 73
ci_075                -1.860007e-04 3 1  ON 74
ci_076                -1.192512e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.6821
    reference variance = 0.402909
====================================================
  Execution time = 4.9716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9344e-01
  Total weights = 1.9549e+06
  Execution time = 7.2402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484125811663
                                         uncertainty =       0.002460318862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484125811663
                                         uncertainty =       0.002460318862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491939672
  error estimate for blocks of size 2^( 2) =       0.000510667568
  error estimate for blocks of size 2^( 3) =       0.000527235777
  error estimate for blocks of size 2^( 4) =       0.000538715151
  error estimate for blocks of size 2^( 5) =       0.000545826287
  error estimate for blocks of size 2^( 6) =       0.000549379396
  error estimate for blocks of size 2^( 7) =       0.000551198071

      target function =      -0.612807423942
              le_mean =     -22.669023034863
             les_mean =     514.378047464732
             stat err =       0.000546279726
             autocorr =       1.233123207112
   target nu stat err =       0.000546279726
   target dn stat err =       0.002920066455
      target stat err =       0.000931409289
              std dev =       0.695707756240
             le_variance =       0.484009282092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484125539133
                                         uncertainty =       0.002460316876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484125539133
                                         uncertainty =       0.002460316876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491939534
  error estimate for blocks of size 2^( 2) =       0.000510667431
  error estimate for blocks of size 2^( 3) =       0.000527235638
  error estimate for blocks of size 2^( 4) =       0.000538715011
  error estimate for blocks of size 2^( 5) =       0.000545826144
  error estimate for blocks of size 2^( 6) =       0.000549379258
  error estimate for blocks of size 2^( 7) =       0.000551197913

      target function =      -0.612807511741
              le_mean =     -22.669023035178
             les_mean =     514.378047191463
             stat err =       0.000546279582
             autocorr =       1.233123248638
   target nu stat err =       0.000546279582
   target dn stat err =       0.002920070649
      target stat err =       0.000931410748
              std dev =       0.695707560577
             le_variance =       0.484009009845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484125675391
                                         uncertainty =       0.002460317869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484125675391
                                         uncertainty =       0.002460317869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491939603
  error estimate for blocks of size 2^( 2) =       0.000510667500
  error estimate for blocks of size 2^( 3) =       0.000527235707
  error estimate for blocks of size 2^( 4) =       0.000538715081
  error estimate for blocks of size 2^( 5) =       0.000545826215
  error estimate for blocks of size 2^( 6) =       0.000549379327
  error estimate for blocks of size 2^( 7) =       0.000551197992

      target function =      -0.612807467906
              le_mean =     -22.669023035020
             les_mean =     514.378047327866
             stat err =       0.000546279654
             autocorr =       1.233123227872
   target nu stat err =       0.000546279654
   target dn stat err =       0.002920068551
      target stat err =       0.000931410019
              std dev =       0.695707658403
             le_variance =       0.484009145961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484125794629
                                         uncertainty =       0.002460318738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484125794629
                                         uncertainty =       0.002460318738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491939664
  error estimate for blocks of size 2^( 2) =       0.000510667560
  error estimate for blocks of size 2^( 3) =       0.000527235769
  error estimate for blocks of size 2^( 4) =       0.000538715142
  error estimate for blocks of size 2^( 5) =       0.000545826278
  error estimate for blocks of size 2^( 6) =       0.000549379387
  error estimate for blocks of size 2^( 7) =       0.000551198061

      target function =      -0.612807429445
              le_mean =     -22.669023034883
             les_mean =     514.378047447599
             stat err =       0.000546279717
             autocorr =       1.233123209699
   target nu stat err =       0.000546279717
   target dn stat err =       0.002920066717
      target stat err =       0.000931409381
              std dev =       0.695707744010
             le_variance =       0.484009265075


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.612807423942        initial
     8.8818e+02     8.8818e+03             4.0364e-07        -0.612807511741  <--
     3.5527e+03     3.5527e+04             1.0091e-07        -0.612807467906
     1.4211e+04     1.4211e+05             2.5229e-08        -0.612807429445

*****************************************************************************
Applying the update for shift_i =   8.8818e+02     and shift_s =   8.8818e+03
*****************************************************************************

  Execution time = 8.6051e+01
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_001                -7.044634e-01 3 1  ON 0
ci_002                -7.027647e-01 3 1  ON 1
ci_003                -5.364045e-02 3 1  ON 2
ci_004                -5.404207e-02 3 1  ON 3
ci_005                 2.330795e-02 3 1  ON 4
ci_006                 2.338047e-02 3 1  ON 5
ci_007                 1.858751e-02 3 1  ON 6
ci_008                 1.897953e-02 3 1  ON 7
ci_009                -1.495484e-02 3 1  ON 8
ci_010                -1.470793e-02 3 1  ON 9
ci_011                -1.253193e-02 3 1  ON 10
ci_012                -1.211946e-02 3 1  ON 11
ci_013                 1.121054e-02 3 1  ON 12
ci_014                 1.099752e-02 3 1  ON 13
ci_015                 1.260751e-02 3 1  ON 14
ci_016                 1.239628e-02 3 1  ON 15
ci_017                 1.049805e-02 3 1  ON 16
ci_018                 1.047863e-02 3 1  ON 17
ci_019                 3.268030e-03 3 1  ON 18
ci_020                 3.483569e-03 3 1  ON 19
ci_021                -8.068880e-03 3 1  ON 20
ci_022                -8.280533e-03 3 1  ON 21
ci_023                 6.236715e-03 3 1  ON 22
ci_024                 6.336786e-03 3 1  ON 23
ci_025                 9.040338e-03 3 1  ON 24
ci_026                 8.953186e-03 3 1  ON 25
ci_027                 6.585427e-03 3 1  ON 26
ci_028                 6.651344e-03 3 1  ON 27
ci_029                -5.190278e-03 3 1  ON 28
ci_030                -5.154969e-03 3 1  ON 29
ci_031                -1.760561e-03 3 1  ON 30
ci_032                -1.720841e-03 3 1  ON 31
ci_033                 4.327021e-03 3 1  ON 32
ci_034                 4.225766e-03 3 1  ON 33
ci_035                 2.736713e-03 3 1  ON 34
ci_036                 2.770735e-03 3 1  ON 35
ci_037                 4.702089e-03 3 1  ON 36
ci_038                 4.549455e-03 3 1  ON 37
ci_039                 4.574550e-03 3 1  ON 38
ci_040                 4.649416e-03 3 1  ON 39
ci_041                 3.713161e-03 3 1  ON 40
ci_042                 3.564834e-03 3 1  ON 41
ci_043                 3.872132e-03 3 1  ON 42
ci_044                 4.055145e-03 3 1  ON 43
ci_045                 3.213837e-03 3 1  ON 44
ci_046                 3.196675e-03 3 1  ON 45
ci_047                -1.607510e-03 3 1  ON 46
ci_048                -1.717693e-03 3 1  ON 47
ci_049                 1.399623e-03 3 1  ON 48
ci_050                 1.488319e-03 3 1  ON 49
ci_051                -2.173844e-03 3 1  ON 50
ci_052                -2.076638e-03 3 1  ON 51
ci_053                -2.236185e-03 3 1  ON 52
ci_054                -2.386153e-03 3 1  ON 53
ci_055                -1.129060e-03 3 1  ON 54
ci_056                -1.635960e-03 3 1  ON 55
ci_057                -1.221603e-03 3 1  ON 56
ci_058                -1.464098e-03 3 1  ON 57
ci_059                -8.259551e-04 3 1  ON 58
ci_060                -6.613895e-04 3 1  ON 59
ci_061                -9.769193e-04 3 1  ON 60
ci_062                -7.220403e-04 3 1  ON 61
ci_063                -6.062002e-04 3 1  ON 62
ci_064                -7.521848e-04 3 1  ON 63
ci_065                -1.915659e-03 3 1  ON 64
ci_066                -2.110188e-03 3 1  ON 65
ci_067                -1.464187e-03 3 1  ON 66
ci_068                -1.105632e-03 3 1  ON 67
ci_069                -1.835084e-05 3 1  ON 68
ci_070                 1.324054e-04 3 1  ON 69
ci_071                -1.880818e-03 3 1  ON 70
ci_072                -1.750596e-03 3 1  ON 71
ci_073                 5.031743e-04 3 1  ON 72
ci_074                 4.904315e-04 3 1  ON 73
ci_075                -1.860218e-04 3 1  ON 74
ci_076                -1.192773e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4682e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.594
    reference variance = 0.332717
====================================================
  Execution time = 5.1306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9840e-01
  Total weights = 1.954891497e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486904053334
                                         uncertainty =       0.005353071088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486904053334
                                         uncertainty =       0.005353071088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493431709
  error estimate for blocks of size 2^( 2) =       0.000512030831
  error estimate for blocks of size 2^( 3) =       0.000528476976
  error estimate for blocks of size 2^( 4) =       0.000540063759
  error estimate for blocks of size 2^( 5) =       0.000546906952
  error estimate for blocks of size 2^( 6) =       0.000551447208
  error estimate for blocks of size 2^( 7) =       0.000553637281

      target function =      -0.611121429595
              le_mean =     -22.668338562723
             les_mean =     514.351971900278
             stat err =       0.000548013800
             autocorr =       1.233470821652
   target nu stat err =       0.000548013800
   target dn stat err =       0.006985500872
      target stat err =       0.002135577842
              std dev =       0.697817814808
             le_variance =       0.486949702664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266833856272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611128508962       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611128690524       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611128708628       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611128710203       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611128711001       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611128711576       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611128711666       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611128711736       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611128711727       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611128711723       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+02 is 1.838792e-06

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611128508962       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611128554358       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611128558884       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611128559278       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611128559477       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611128559619       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611128559643       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611128559662       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611128559659       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611128559656       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+02 is 4.597600e-07

solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.611128508962       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.611128520311       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.611128521443       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.611128521541       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.611128521588       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.611128521623       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.611128521635       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.611128521638       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.611128521639       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.611128521632       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+03 is 1.149439e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.936622 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0746e+01
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_001                -7.044636e-01 3 1  ON 0
ci_002                -7.027647e-01 3 1  ON 1
ci_003                -5.364019e-02 3 1  ON 2
ci_004                -5.404176e-02 3 1  ON 3
ci_005                 2.330759e-02 3 1  ON 4
ci_006                 2.338001e-02 3 1  ON 5
ci_007                 1.858733e-02 3 1  ON 6
ci_008                 1.897928e-02 3 1  ON 7
ci_009                -1.495470e-02 3 1  ON 8
ci_010                -1.470774e-02 3 1  ON 9
ci_011                -1.253175e-02 3 1  ON 10
ci_012                -1.211932e-02 3 1  ON 11
ci_013                 1.121041e-02 3 1  ON 12
ci_014                 1.099731e-02 3 1  ON 13
ci_015                 1.260741e-02 3 1  ON 14
ci_016                 1.239606e-02 3 1  ON 15
ci_017                 1.049790e-02 3 1  ON 16
ci_018                 1.047845e-02 3 1  ON 17
ci_019                 3.267857e-03 3 1  ON 18
ci_020                 3.483497e-03 3 1  ON 19
ci_021                -8.068805e-03 3 1  ON 20
ci_022                -8.280573e-03 3 1  ON 21
ci_023                 6.236712e-03 3 1  ON 22
ci_024                 6.336674e-03 3 1  ON 23
ci_025                 9.040336e-03 3 1  ON 24
ci_026                 8.953184e-03 3 1  ON 25
ci_027                 6.585434e-03 3 1  ON 26
ci_028                 6.651288e-03 3 1  ON 27
ci_029                -5.190227e-03 3 1  ON 28
ci_030                -5.154891e-03 3 1  ON 29
ci_031                -1.760386e-03 3 1  ON 30
ci_032                -1.720789e-03 3 1  ON 31
ci_033                 4.326905e-03 3 1  ON 32
ci_034                 4.225715e-03 3 1  ON 33
ci_035                 2.736674e-03 3 1  ON 34
ci_036                 2.770674e-03 3 1  ON 35
ci_037                 4.702057e-03 3 1  ON 36
ci_038                 4.549369e-03 3 1  ON 37
ci_039                 4.574529e-03 3 1  ON 38
ci_040                 4.649459e-03 3 1  ON 39
ci_041                 3.713169e-03 3 1  ON 40
ci_042                 3.564809e-03 3 1  ON 41
ci_043                 3.872125e-03 3 1  ON 42
ci_044                 4.055098e-03 3 1  ON 43
ci_045                 3.213849e-03 3 1  ON 44
ci_046                 3.196647e-03 3 1  ON 45
ci_047                -1.607479e-03 3 1  ON 46
ci_048                -1.717644e-03 3 1  ON 47
ci_049                 1.399600e-03 3 1  ON 48
ci_050                 1.488240e-03 3 1  ON 49
ci_051                -2.173839e-03 3 1  ON 50
ci_052                -2.076610e-03 3 1  ON 51
ci_053                -2.236188e-03 3 1  ON 52
ci_054                -2.386172e-03 3 1  ON 53
ci_055                -1.129039e-03 3 1  ON 54
ci_056                -1.635934e-03 3 1  ON 55
ci_057                -1.221600e-03 3 1  ON 56
ci_058                -1.464097e-03 3 1  ON 57
ci_059                -8.259388e-04 3 1  ON 58
ci_060                -6.613389e-04 3 1  ON 59
ci_061                -9.768759e-04 3 1  ON 60
ci_062                -7.220403e-04 3 1  ON 61
ci_063                -6.061853e-04 3 1  ON 62
ci_064                -7.521070e-04 3 1  ON 63
ci_065                -1.915650e-03 3 1  ON 64
ci_066                -2.110195e-03 3 1  ON 65
ci_067                -1.464208e-03 3 1  ON 66
ci_068                -1.105684e-03 3 1  ON 67
ci_069                -1.830896e-05 3 1  ON 68
ci_070                 1.323471e-04 3 1  ON 69
ci_071                -1.880821e-03 3 1  ON 70
ci_072                -1.750609e-03 3 1  ON 71
ci_073                 5.031547e-04 3 1  ON 72
ci_074                 4.904063e-04 3 1  ON 73
ci_075                -1.860135e-04 3 1  ON 74
ci_076                -1.192567e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.7092
    reference variance = 0.338191
====================================================
  Execution time = 4.9733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9610e-01
  Total weights = 1.9549e+06
  Execution time = 7.2591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484865358544
                                         uncertainty =       0.002600708138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484865358544
                                         uncertainty =       0.002600708138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492358868
  error estimate for blocks of size 2^( 2) =       0.000510660756
  error estimate for blocks of size 2^( 3) =       0.000527876646
  error estimate for blocks of size 2^( 4) =       0.000539278739
  error estimate for blocks of size 2^( 5) =       0.000548003097
  error estimate for blocks of size 2^( 6) =       0.000552368732
  error estimate for blocks of size 2^( 7) =       0.000553919091

      target function =      -0.611936045147
              le_mean =     -22.668783347014
             les_mean =     514.369840798968
             stat err =       0.000548392415
             autocorr =       1.240564499811
   target nu stat err =       0.000548392415
   target dn stat err =       0.003453677620
      target stat err =       0.001085199999
              std dev =       0.696300588782
             le_variance =       0.484834509939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484864404154
                                         uncertainty =       0.002600754119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484864404154
                                         uncertainty =       0.002600754119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492358384
  error estimate for blocks of size 2^( 2) =       0.000510660285
  error estimate for blocks of size 2^( 3) =       0.000527876171
  error estimate for blocks of size 2^( 4) =       0.000539278263
  error estimate for blocks of size 2^( 5) =       0.000548002598
  error estimate for blocks of size 2^( 6) =       0.000552368248
  error estimate for blocks of size 2^( 7) =       0.000553918622

      target function =      -0.611936540236
              le_mean =     -22.668783340567
             les_mean =     514.369838873343
             stat err =       0.000548391933
             autocorr =       1.240564756866
   target nu stat err =       0.000548391933
   target dn stat err =       0.003453726954
      target stat err =       0.001085216158
              std dev =       0.696299904497
             le_variance =       0.484833557002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484864881239
                                         uncertainty =       0.002600731128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484864881239
                                         uncertainty =       0.002600731128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492358626
  error estimate for blocks of size 2^( 2) =       0.000510660521
  error estimate for blocks of size 2^( 3) =       0.000527876409
  error estimate for blocks of size 2^( 4) =       0.000539278501
  error estimate for blocks of size 2^( 5) =       0.000548002847
  error estimate for blocks of size 2^( 6) =       0.000552368490
  error estimate for blocks of size 2^( 7) =       0.000553918857

      target function =      -0.611936293881
              le_mean =     -22.668783343783
             les_mean =     514.369839831913
             stat err =       0.000548392174
             autocorr =       1.240564628362
   target nu stat err =       0.000548392174
   target dn stat err =       0.003453702208
      target stat err =       0.001085208059
              std dev =       0.696300246561
             le_variance =       0.484834033361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484865298873
                                         uncertainty =       0.002600711011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484865298873
                                         uncertainty =       0.002600711011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492358838
  error estimate for blocks of size 2^( 2) =       0.000510660726
  error estimate for blocks of size 2^( 3) =       0.000527876616
  error estimate for blocks of size 2^( 4) =       0.000539278710
  error estimate for blocks of size 2^( 5) =       0.000548003066
  error estimate for blocks of size 2^( 6) =       0.000552368702
  error estimate for blocks of size 2^( 7) =       0.000553919062

      target function =      -0.611936076367
              le_mean =     -22.668783346609
             les_mean =     514.369840677630
             stat err =       0.000548392385
             autocorr =       1.240564515890
   target nu stat err =       0.000548392385
   target dn stat err =       0.003453680685
      target stat err =       0.001085201004
              std dev =       0.696300545999
             le_variance =       0.484834450359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611936045147        initial
     2.2204e+02     2.2204e+03             1.8388e-06        -0.611936540236  <--
     8.8818e+02     8.8818e+03             4.5976e-07        -0.611936293881
     3.5527e+03     3.5527e+04             1.1494e-07        -0.611936076367

*****************************************************************************
Applying the update for shift_i =   2.2204e+02     and shift_s =   2.2204e+03
*****************************************************************************

  Execution time = 8.6144e+01
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027644e-01 3 1  ON 1
ci_003                -5.363943e-02 3 1  ON 2
ci_004                -5.404083e-02 3 1  ON 3
ci_005                 2.330653e-02 3 1  ON 4
ci_006                 2.337864e-02 3 1  ON 5
ci_007                 1.858676e-02 3 1  ON 6
ci_008                 1.897853e-02 3 1  ON 7
ci_009                -1.495428e-02 3 1  ON 8
ci_010                -1.470718e-02 3 1  ON 9
ci_011                -1.253123e-02 3 1  ON 10
ci_012                -1.211890e-02 3 1  ON 11
ci_013                 1.121003e-02 3 1  ON 12
ci_014                 1.099669e-02 3 1  ON 13
ci_015                 1.260712e-02 3 1  ON 14
ci_016                 1.239540e-02 3 1  ON 15
ci_017                 1.049745e-02 3 1  ON 16
ci_018                 1.047790e-02 3 1  ON 17
ci_019                 3.267340e-03 3 1  ON 18
ci_020                 3.483281e-03 3 1  ON 19
ci_021                -8.068580e-03 3 1  ON 20
ci_022                -8.280692e-03 3 1  ON 21
ci_023                 6.236703e-03 3 1  ON 22
ci_024                 6.336337e-03 3 1  ON 23
ci_025                 9.040332e-03 3 1  ON 24
ci_026                 8.953180e-03 3 1  ON 25
ci_027                 6.585455e-03 3 1  ON 26
ci_028                 6.651120e-03 3 1  ON 27
ci_029                -5.190074e-03 3 1  ON 28
ci_030                -5.154660e-03 3 1  ON 29
ci_031                -1.759860e-03 3 1  ON 30
ci_032                -1.720634e-03 3 1  ON 31
ci_033                 4.326555e-03 3 1  ON 32
ci_034                 4.225561e-03 3 1  ON 33
ci_035                 2.736558e-03 3 1  ON 34
ci_036                 2.770494e-03 3 1  ON 35
ci_037                 4.701961e-03 3 1  ON 36
ci_038                 4.549109e-03 3 1  ON 37
ci_039                 4.574469e-03 3 1  ON 38
ci_040                 4.649590e-03 3 1  ON 39
ci_041                 3.713191e-03 3 1  ON 40
ci_042                 3.564735e-03 3 1  ON 41
ci_043                 3.872102e-03 3 1  ON 42
ci_044                 4.054957e-03 3 1  ON 43
ci_045                 3.213885e-03 3 1  ON 44
ci_046                 3.196564e-03 3 1  ON 45
ci_047                -1.607386e-03 3 1  ON 46
ci_048                -1.717499e-03 3 1  ON 47
ci_049                 1.399531e-03 3 1  ON 48
ci_050                 1.488004e-03 3 1  ON 49
ci_051                -2.173824e-03 3 1  ON 50
ci_052                -2.076527e-03 3 1  ON 51
ci_053                -2.236198e-03 3 1  ON 52
ci_054                -2.386228e-03 3 1  ON 53
ci_055                -1.128974e-03 3 1  ON 54
ci_056                -1.635853e-03 3 1  ON 55
ci_057                -1.221593e-03 3 1  ON 56
ci_058                -1.464094e-03 3 1  ON 57
ci_059                -8.258898e-04 3 1  ON 58
ci_060                -6.611870e-04 3 1  ON 59
ci_061                -9.767458e-04 3 1  ON 60
ci_062                -7.220403e-04 3 1  ON 61
ci_063                -6.061405e-04 3 1  ON 62
ci_064                -7.518736e-04 3 1  ON 63
ci_065                -1.915620e-03 3 1  ON 64
ci_066                -2.110215e-03 3 1  ON 65
ci_067                -1.464270e-03 3 1  ON 66
ci_068                -1.105840e-03 3 1  ON 67
ci_069                -1.818334e-05 3 1  ON 68
ci_070                 1.321722e-04 3 1  ON 69
ci_071                -1.880832e-03 3 1  ON 70
ci_072                -1.750646e-03 3 1  ON 71
ci_073                 5.030957e-04 3 1  ON 72
ci_074                 4.903308e-04 3 1  ON 73
ci_075                -1.859886e-04 3 1  ON 74
ci_076                -1.191949e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4690e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.7176
    reference variance = 0.367204
====================================================
  Execution time = 5.1268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9911e-01
  Total weights = 1.954924065e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485659043177
                                         uncertainty =       0.002733505994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485659043177
                                         uncertainty =       0.002733505994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492744311
  error estimate for blocks of size 2^( 2) =       0.000511453182
  error estimate for blocks of size 2^( 3) =       0.000528634206
  error estimate for blocks of size 2^( 4) =       0.000540340888
  error estimate for blocks of size 2^( 5) =       0.000545750871
  error estimate for blocks of size 2^( 6) =       0.000551342731
  error estimate for blocks of size 2^( 7) =       0.000553221688

      target function =      -0.610826529567
              le_mean =     -22.668002712687
             les_mean =     514.337457270581
             stat err =       0.000547664044
             autocorr =       1.235336351679
   target nu stat err =       0.000547664044
   target dn stat err =       0.003952534254
      target stat err =       0.001227435927
              std dev =       0.696845687069
             le_variance =       0.485593911587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266800271269e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610828707128       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610829430741       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610829523772       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610829534563       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610829538964       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610829539259       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610829539499       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610829539437       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610829539442       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610829539420       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+01 is 7.004620e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610828707128       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610828888127       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610828911391       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610828914089       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610828915189       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610828915263       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610828915322       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610828915307       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610828915308       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610828915302       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+02 is 1.752113e-06

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.610828707128       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.610828752384       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.610828758200       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.610828758875       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.610828759150       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.610828759168       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.610828759183       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.610828759180       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.610828759180       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.610828759178       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+02 is 4.380883e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.941482 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4562e+01
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_001                -7.044641e-01 3 1  ON 0
ci_002                -7.027650e-01 3 1  ON 1
ci_003                -5.363856e-02 3 1  ON 2
ci_004                -5.403972e-02 3 1  ON 3
ci_005                 2.330504e-02 3 1  ON 4
ci_006                 2.337688e-02 3 1  ON 5
ci_007                 1.858572e-02 3 1  ON 6
ci_008                 1.897755e-02 3 1  ON 7
ci_009                -1.495376e-02 3 1  ON 8
ci_010                -1.470650e-02 3 1  ON 9
ci_011                -1.253031e-02 3 1  ON 10
ci_012                -1.211819e-02 3 1  ON 11
ci_013                 1.120918e-02 3 1  ON 12
ci_014                 1.099608e-02 3 1  ON 13
ci_015                 1.260645e-02 3 1  ON 14
ci_016                 1.239470e-02 3 1  ON 15
ci_017                 1.049707e-02 3 1  ON 16
ci_018                 1.047774e-02 3 1  ON 17
ci_019                 3.266560e-03 3 1  ON 18
ci_020                 3.482861e-03 3 1  ON 19
ci_021                -8.068281e-03 3 1  ON 20
ci_022                -8.280817e-03 3 1  ON 21
ci_023                 6.236593e-03 3 1  ON 22
ci_024                 6.336304e-03 3 1  ON 23
ci_025                 9.040814e-03 3 1  ON 24
ci_026                 8.953510e-03 3 1  ON 25
ci_027                 6.585380e-03 3 1  ON 26
ci_028                 6.651019e-03 3 1  ON 27
ci_029                -5.189753e-03 3 1  ON 28
ci_030                -5.154298e-03 3 1  ON 29
ci_031                -1.759473e-03 3 1  ON 30
ci_032                -1.720371e-03 3 1  ON 31
ci_033                 4.326268e-03 3 1  ON 32
ci_034                 4.225131e-03 3 1  ON 33
ci_035                 2.736353e-03 3 1  ON 34
ci_036                 2.770247e-03 3 1  ON 35
ci_037                 4.701989e-03 3 1  ON 36
ci_038                 4.548830e-03 3 1  ON 37
ci_039                 4.574288e-03 3 1  ON 38
ci_040                 4.649681e-03 3 1  ON 39
ci_041                 3.713005e-03 3 1  ON 40
ci_042                 3.564622e-03 3 1  ON 41
ci_043                 3.871953e-03 3 1  ON 42
ci_044                 4.054791e-03 3 1  ON 43
ci_045                 3.214284e-03 3 1  ON 44
ci_046                 3.196282e-03 3 1  ON 45
ci_047                -1.607161e-03 3 1  ON 46
ci_048                -1.717102e-03 3 1  ON 47
ci_049                 1.399378e-03 3 1  ON 48
ci_050                 1.487933e-03 3 1  ON 49
ci_051                -2.173430e-03 3 1  ON 50
ci_052                -2.076427e-03 3 1  ON 51
ci_053                -2.236071e-03 3 1  ON 52
ci_054                -2.386371e-03 3 1  ON 53
ci_055                -1.129123e-03 3 1  ON 54
ci_056                -1.635798e-03 3 1  ON 55
ci_057                -1.221667e-03 3 1  ON 56
ci_058                -1.464099e-03 3 1  ON 57
ci_059                -8.258902e-04 3 1  ON 58
ci_060                -6.611503e-04 3 1  ON 59
ci_061                -9.764123e-04 3 1  ON 60
ci_062                -7.218998e-04 3 1  ON 61
ci_063                -6.060429e-04 3 1  ON 62
ci_064                -7.514368e-04 3 1  ON 63
ci_065                -1.915865e-03 3 1  ON 64
ci_066                -2.110413e-03 3 1  ON 65
ci_067                -1.464273e-03 3 1  ON 66
ci_068                -1.106070e-03 3 1  ON 67
ci_069                -1.823389e-05 3 1  ON 68
ci_070                 1.324754e-04 3 1  ON 69
ci_071                -1.880616e-03 3 1  ON 70
ci_072                -1.750463e-03 3 1  ON 71
ci_073                 5.030684e-04 3 1  ON 72
ci_074                 4.904075e-04 3 1  ON 73
ci_075                -1.860210e-04 3 1  ON 74
ci_076                -1.190527e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.6809
    reference variance = 0.36242
====================================================
  Execution time = 4.9841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9938e-01
  Total weights = 1.9552e+06
  Execution time = 7.2232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485995908528
                                         uncertainty =       0.002322921305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485995908528
                                         uncertainty =       0.002322921305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492923972
  error estimate for blocks of size 2^( 2) =       0.000511759902
  error estimate for blocks of size 2^( 3) =       0.000528189168
  error estimate for blocks of size 2^( 4) =       0.000540470405
  error estimate for blocks of size 2^( 5) =       0.000548097573
  error estimate for blocks of size 2^( 6) =       0.000551309392
  error estimate for blocks of size 2^( 7) =       0.000553688452

      target function =      -0.611284292573
              le_mean =     -22.670151347201
             les_mean =     514.435139103282
             stat err =       0.000548391455
             autocorr =       1.237717355556
   target nu stat err =       0.000548391455
   target dn stat err =       0.003271098359
      target stat err =       0.001030569134
              std dev =       0.697099765810
             le_variance =       0.485948083493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485992120413
                                         uncertainty =       0.002322935679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485992120413
                                         uncertainty =       0.002322935679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492922049
  error estimate for blocks of size 2^( 2) =       0.000511757961
  error estimate for blocks of size 2^( 3) =       0.000528187177
  error estimate for blocks of size 2^( 4) =       0.000540468329
  error estimate for blocks of size 2^( 5) =       0.000548095529
  error estimate for blocks of size 2^( 6) =       0.000551307292
  error estimate for blocks of size 2^( 7) =       0.000553686148

      target function =      -0.611284971678
              le_mean =     -22.670151340375
             les_mean =     514.435136551241
             stat err =       0.000548389324
             autocorr =       1.237717389693
   target nu stat err =       0.000548389324
   target dn stat err =       0.003272314817
      target stat err =       0.001030927503
              std dev =       0.697097047380
             le_variance =       0.485944293466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485994012770
                                         uncertainty =       0.002322928485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485994012770
                                         uncertainty =       0.002322928485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492923010
  error estimate for blocks of size 2^( 2) =       0.000511758930
  error estimate for blocks of size 2^( 3) =       0.000528188171
  error estimate for blocks of size 2^( 4) =       0.000540469366
  error estimate for blocks of size 2^( 5) =       0.000548096550
  error estimate for blocks of size 2^( 6) =       0.000551308341
  error estimate for blocks of size 2^( 7) =       0.000553687299

      target function =      -0.611284658429
              le_mean =     -22.670151343684
             les_mean =     514.435137735884
             stat err =       0.000548390389
             autocorr =       1.237717373004
   target nu stat err =       0.000548390389
   target dn stat err =       0.003271700493
      target stat err =       0.001030746616
              std dev =       0.697098405377
             le_variance =       0.485946186779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485995671443
                                         uncertainty =       0.002322922201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485995671443
                                         uncertainty =       0.002322922201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492923851
  error estimate for blocks of size 2^( 2) =       0.000511759780
  error estimate for blocks of size 2^( 3) =       0.000528189044
  error estimate for blocks of size 2^( 4) =       0.000540470275
  error estimate for blocks of size 2^( 5) =       0.000548097445
  error estimate for blocks of size 2^( 6) =       0.000551309260
  error estimate for blocks of size 2^( 7) =       0.000553688308

      target function =      -0.611284341302
              le_mean =     -22.670151346750
             les_mean =     514.435138921975
             stat err =       0.000548391322
             autocorr =       1.237717357767
   target nu stat err =       0.000548391322
   target dn stat err =       0.003271172937
      target stat err =       0.001030591127
              std dev =       0.697099595674
             le_variance =       0.485947846289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.611284292573        initial
     5.5511e+01     5.5511e+02             7.0046e-06        -0.611284971678  <--
     2.2204e+02     2.2204e+03             1.7521e-06        -0.611284658429
     8.8818e+02     8.8818e+03             4.3809e-07        -0.611284341302

*****************************************************************************
Applying the update for shift_i =   5.5511e+01     and shift_s =   5.5511e+02
*****************************************************************************

  Execution time = 8.6054e+01
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_001                -7.044637e-01 3 1  ON 0
ci_002                -7.027667e-01 3 1  ON 1
ci_003                -5.363596e-02 3 1  ON 2
ci_004                -5.403639e-02 3 1  ON 3
ci_005                 2.330055e-02 3 1  ON 4
ci_006                 2.337163e-02 3 1  ON 5
ci_007                 1.858260e-02 3 1  ON 6
ci_008                 1.897460e-02 3 1  ON 7
ci_009                -1.495220e-02 3 1  ON 8
ci_010                -1.470446e-02 3 1  ON 9
ci_011                -1.252757e-02 3 1  ON 10
ci_012                -1.211605e-02 3 1  ON 11
ci_013                 1.120663e-02 3 1  ON 12
ci_014                 1.099426e-02 3 1  ON 13
ci_015                 1.260443e-02 3 1  ON 14
ci_016                 1.239261e-02 3 1  ON 15
ci_017                 1.049591e-02 3 1  ON 16
ci_018                 1.047725e-02 3 1  ON 17
ci_019                 3.264221e-03 3 1  ON 18
ci_020                 3.481604e-03 3 1  ON 19
ci_021                -8.067383e-03 3 1  ON 20
ci_022                -8.281193e-03 3 1  ON 21
ci_023                 6.236262e-03 3 1  ON 22
ci_024                 6.336206e-03 3 1  ON 23
ci_025                 9.042259e-03 3 1  ON 24
ci_026                 8.954502e-03 3 1  ON 25
ci_027                 6.585155e-03 3 1  ON 26
ci_028                 6.650715e-03 3 1  ON 27
ci_029                -5.188790e-03 3 1  ON 28
ci_030                -5.153214e-03 3 1  ON 29
ci_031                -1.758314e-03 3 1  ON 30
ci_032                -1.719581e-03 3 1  ON 31
ci_033                 4.325408e-03 3 1  ON 32
ci_034                 4.223842e-03 3 1  ON 33
ci_035                 2.735740e-03 3 1  ON 34
ci_036                 2.769510e-03 3 1  ON 35
ci_037                 4.702074e-03 3 1  ON 36
ci_038                 4.547995e-03 3 1  ON 37
ci_039                 4.573745e-03 3 1  ON 38
ci_040                 4.649953e-03 3 1  ON 39
ci_041                 3.712446e-03 3 1  ON 40
ci_042                 3.564282e-03 3 1  ON 41
ci_043                 3.871507e-03 3 1  ON 42
ci_044                 4.054294e-03 3 1  ON 43
ci_045                 3.215479e-03 3 1  ON 44
ci_046                 3.195435e-03 3 1  ON 45
ci_047                -1.606487e-03 3 1  ON 46
ci_048                -1.715912e-03 3 1  ON 47
ci_049                 1.398921e-03 3 1  ON 48
ci_050                 1.487719e-03 3 1  ON 49
ci_051                -2.172246e-03 3 1  ON 50
ci_052                -2.076124e-03 3 1  ON 51
ci_053                -2.235691e-03 3 1  ON 52
ci_054                -2.386799e-03 3 1  ON 53
ci_055                -1.129569e-03 3 1  ON 54
ci_056                -1.635634e-03 3 1  ON 55
ci_057                -1.221889e-03 3 1  ON 56
ci_058                -1.464113e-03 3 1  ON 57
ci_059                -8.258912e-04 3 1  ON 58
ci_060                -6.610401e-04 3 1  ON 59
ci_061                -9.754125e-04 3 1  ON 60
ci_062                -7.214786e-04 3 1  ON 61
ci_063                -6.057502e-04 3 1  ON 62
ci_064                -7.501271e-04 3 1  ON 63
ci_065                -1.916600e-03 3 1  ON 64
ci_066                -2.111007e-03 3 1  ON 65
ci_067                -1.464283e-03 3 1  ON 66
ci_068                -1.106759e-03 3 1  ON 67
ci_069                -1.838542e-05 3 1  ON 68
ci_070                 1.333847e-04 3 1  ON 69
ci_071                -1.879971e-03 3 1  ON 70
ci_072                -1.749913e-03 3 1  ON 71
ci_073                 5.029866e-04 3 1  ON 72
ci_074                 4.906375e-04 3 1  ON 73
ci_075                -1.861183e-04 3 1  ON 74
ci_076                -1.186264e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.5062e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.6293
    reference variance = 0.352385
====================================================
  Execution time = 5.1264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9513e-01
  Total weights = 1.955039186e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482229071642
                                         uncertainty =       0.002326750121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482229071642
                                         uncertainty =       0.002326750121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491023928
  error estimate for blocks of size 2^( 2) =       0.000509588927
  error estimate for blocks of size 2^( 3) =       0.000526586893
  error estimate for blocks of size 2^( 4) =       0.000538217949
  error estimate for blocks of size 2^( 5) =       0.000546600051
  error estimate for blocks of size 2^( 6) =       0.000550128668
  error estimate for blocks of size 2^( 7) =       0.000552501110

      target function =      -0.612330300689
              le_mean =     -22.669166262342
             les_mean =     514.386224247523
             stat err =       0.000546861945
             autocorr =       1.240366685019
   target nu stat err =       0.000546861945
   target dn stat err =       0.003174092721
      target stat err =       0.001004469978
              std dev =       0.694412698228
             le_variance =       0.482208995460


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266916626234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612331660905       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612333913824       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612334143158       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612334167632       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612334172202       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612334171782       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612334172442       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612334172465       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612334172415       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+01 is 2.268040e-05

solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612331660905       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612332225314       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612332282707       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612332288827       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612332289968       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612332289862       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612332290026       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612332290032       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612332290019       residual = 1.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+01 is 5.682394e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.612331660905       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.612331802081       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.612331816433       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.612331817963       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.612331818248       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.612331818222       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.612331818263       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.612331818264       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.612331818261       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+02 is 1.421369e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.945924 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0688e+01
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_001                -7.044642e-01 3 1  ON 0
ci_002                -7.027677e-01 3 1  ON 1
ci_003                -5.363297e-02 3 1  ON 2
ci_004                -5.403383e-02 3 1  ON 3
ci_005                 2.329486e-02 3 1  ON 4
ci_006                 2.336600e-02 3 1  ON 5
ci_007                 1.857868e-02 3 1  ON 6
ci_008                 1.897126e-02 3 1  ON 7
ci_009                -1.495040e-02 3 1  ON 8
ci_010                -1.470081e-02 3 1  ON 9
ci_011                -1.252392e-02 3 1  ON 10
ci_012                -1.211343e-02 3 1  ON 11
ci_013                 1.120483e-02 3 1  ON 12
ci_014                 1.099232e-02 3 1  ON 13
ci_015                 1.260173e-02 3 1  ON 14
ci_016                 1.239062e-02 3 1  ON 15
ci_017                 1.049440e-02 3 1  ON 16
ci_018                 1.047604e-02 3 1  ON 17
ci_019                 3.261054e-03 3 1  ON 18
ci_020                 3.479896e-03 3 1  ON 19
ci_021                -8.066533e-03 3 1  ON 20
ci_022                -8.280795e-03 3 1  ON 21
ci_023                 6.236502e-03 3 1  ON 22
ci_024                 6.336122e-03 3 1  ON 23
ci_025                 9.042965e-03 3 1  ON 24
ci_026                 8.953879e-03 3 1  ON 25
ci_027                 6.585180e-03 3 1  ON 26
ci_028                 6.650476e-03 3 1  ON 27
ci_029                -5.187390e-03 3 1  ON 28
ci_030                -5.152351e-03 3 1  ON 29
ci_031                -1.756876e-03 3 1  ON 30
ci_032                -1.717769e-03 3 1  ON 31
ci_033                 4.324827e-03 3 1  ON 32
ci_034                 4.222485e-03 3 1  ON 33
ci_035                 2.734683e-03 3 1  ON 34
ci_036                 2.768833e-03 3 1  ON 35
ci_037                 4.701231e-03 3 1  ON 36
ci_038                 4.546989e-03 3 1  ON 37
ci_039                 4.574275e-03 3 1  ON 38
ci_040                 4.649783e-03 3 1  ON 39
ci_041                 3.711775e-03 3 1  ON 40
ci_042                 3.564446e-03 3 1  ON 41
ci_043                 3.871394e-03 3 1  ON 42
ci_044                 4.053634e-03 3 1  ON 43
ci_045                 3.214829e-03 3 1  ON 44
ci_046                 3.195055e-03 3 1  ON 45
ci_047                -1.605461e-03 3 1  ON 46
ci_048                -1.714759e-03 3 1  ON 47
ci_049                 1.397956e-03 3 1  ON 48
ci_050                 1.487046e-03 3 1  ON 49
ci_051                -2.171359e-03 3 1  ON 50
ci_052                -2.076029e-03 3 1  ON 51
ci_053                -2.236103e-03 3 1  ON 52
ci_054                -2.386751e-03 3 1  ON 53
ci_055                -1.129020e-03 3 1  ON 54
ci_056                -1.635010e-03 3 1  ON 55
ci_057                -1.221539e-03 3 1  ON 56
ci_058                -1.464102e-03 3 1  ON 57
ci_059                -8.255786e-04 3 1  ON 58
ci_060                -6.606760e-04 3 1  ON 59
ci_061                -9.753355e-04 3 1  ON 60
ci_062                -7.209114e-04 3 1  ON 61
ci_063                -6.042970e-04 3 1  ON 62
ci_064                -7.500900e-04 3 1  ON 63
ci_065                -1.917503e-03 3 1  ON 64
ci_066                -2.110541e-03 3 1  ON 65
ci_067                -1.465259e-03 3 1  ON 66
ci_068                -1.106524e-03 3 1  ON 67
ci_069                -1.820553e-05 3 1  ON 68
ci_070                 1.337092e-04 3 1  ON 69
ci_071                -1.879188e-03 3 1  ON 70
ci_072                -1.750599e-03 3 1  ON 71
ci_073                 5.023073e-04 3 1  ON 72
ci_074                 4.902032e-04 3 1  ON 73
ci_075                -1.861517e-04 3 1  ON 74
ci_076                -1.178599e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.7232
    reference variance = 0.270531
====================================================
  Execution time = 4.9707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0851e-01
  Total weights = 1.9550e+06
  Execution time = 7.2280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491338702988
                                         uncertainty =       0.004063703921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491338702988
                                         uncertainty =       0.004063703921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495600621
  error estimate for blocks of size 2^( 2) =       0.000514009005
  error estimate for blocks of size 2^( 3) =       0.000530599588
  error estimate for blocks of size 2^( 4) =       0.000541547288
  error estimate for blocks of size 2^( 5) =       0.000546955500
  error estimate for blocks of size 2^( 6) =       0.000551310257
  error estimate for blocks of size 2^( 7) =       0.000555823174

      target function =      -0.608189357081
              le_mean =     -22.668835472316
             les_mean =     514.384630379250
             stat err =       0.000548909055
             autocorr =       1.226696442680
   target nu stat err =       0.000548909055
   target dn stat err =       0.005855743123
      target stat err =       0.001780102691
              std dev =       0.700885119667
             le_variance =       0.491239950971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491322223261
                                         uncertainty =       0.004065473993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491322223261
                                         uncertainty =       0.004065473993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495592304
  error estimate for blocks of size 2^( 2) =       0.000514000755
  error estimate for blocks of size 2^( 3) =       0.000530591226
  error estimate for blocks of size 2^( 4) =       0.000541538742
  error estimate for blocks of size 2^( 5) =       0.000546946712
  error estimate for blocks of size 2^( 6) =       0.000551301412
  error estimate for blocks of size 2^( 7) =       0.000555813670

      target function =      -0.608205690130
              le_mean =     -22.668835455236
             les_mean =     514.384575237933
             stat err =       0.000548900134
             autocorr =       1.226697741547
   target nu stat err =       0.000548900134
   target dn stat err =       0.005854201109
      target stat err =       0.001779738582
              std dev =       0.700873357851
             le_variance =       0.491223463746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491330433430
                                         uncertainty =       0.004064588503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491330433430
                                         uncertainty =       0.004064588503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495596448
  error estimate for blocks of size 2^( 2) =       0.000514004865
  error estimate for blocks of size 2^( 3) =       0.000530595392
  error estimate for blocks of size 2^( 4) =       0.000541543000
  error estimate for blocks of size 2^( 5) =       0.000546951090
  error estimate for blocks of size 2^( 6) =       0.000551305821
  error estimate for blocks of size 2^( 7) =       0.000555818412

      target function =      -0.608198821659
              le_mean =     -22.668835461525
             les_mean =     514.384598384357
             stat err =       0.000548904580
             autocorr =       1.226697104923
   target nu stat err =       0.000548904580
   target dn stat err =       0.005854901578
      target stat err =       0.001779907201
              std dev =       0.700879217598
             le_variance =       0.491231677661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491337667273
                                         uncertainty =       0.004063814318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491337667273
                                         uncertainty =       0.004063814318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495600098
  error estimate for blocks of size 2^( 2) =       0.000514008487
  error estimate for blocks of size 2^( 3) =       0.000530599062
  error estimate for blocks of size 2^( 4) =       0.000541546751
  error estimate for blocks of size 2^( 5) =       0.000546954947
  error estimate for blocks of size 2^( 6) =       0.000551309701
  error estimate for blocks of size 2^( 7) =       0.000555822579

      target function =      -0.608190762228
              le_mean =     -22.668835470699
             les_mean =     514.384625628393
             stat err =       0.000548908495
             autocorr =       1.226696527117
   target nu stat err =       0.000548908495
   target dn stat err =       0.005855625374
      target stat err =       0.001780075812
              std dev =       0.700884380471
             le_variance =       0.491238914788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.608189357081        initial
     1.3878e+01     1.3878e+02             2.2680e-05        -0.608205690130  <--
     5.5511e+01     5.5511e+02             5.6824e-06        -0.608198821659
     2.2204e+02     2.2204e+03             1.4214e-06        -0.608190762228

*****************************************************************************
Applying the update for shift_i =   1.3878e+01     and shift_s =   1.3878e+02
*****************************************************************************

  Execution time = 8.5958e+01
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_001                -7.044659e-01 3 1  ON 0
ci_002                -7.027705e-01 3 1  ON 1
ci_003                -5.362402e-02 3 1  ON 2
ci_004                -5.402617e-02 3 1  ON 3
ci_005                 2.327786e-02 3 1  ON 4
ci_006                 2.334916e-02 3 1  ON 5
ci_007                 1.856695e-02 3 1  ON 6
ci_008                 1.896125e-02 3 1  ON 7
ci_009                -1.494501e-02 3 1  ON 8
ci_010                -1.468986e-02 3 1  ON 9
ci_011                -1.251299e-02 3 1  ON 10
ci_012                -1.210561e-02 3 1  ON 11
ci_013                 1.119945e-02 3 1  ON 12
ci_014                 1.098649e-02 3 1  ON 13
ci_015                 1.259365e-02 3 1  ON 14
ci_016                 1.238467e-02 3 1  ON 15
ci_017                 1.048989e-02 3 1  ON 16
ci_018                 1.047243e-02 3 1  ON 17
ci_019                 3.251573e-03 3 1  ON 18
ci_020                 3.474783e-03 3 1  ON 19
ci_021                -8.063990e-03 3 1  ON 20
ci_022                -8.279604e-03 3 1  ON 21
ci_023                 6.237222e-03 3 1  ON 22
ci_024                 6.335869e-03 3 1  ON 23
ci_025                 9.045079e-03 3 1  ON 24
ci_026                 8.952015e-03 3 1  ON 25
ci_027                 6.585257e-03 3 1  ON 26
ci_028                 6.649763e-03 3 1  ON 27
ci_029                -5.183200e-03 3 1  ON 28
ci_030                -5.149768e-03 3 1  ON 29
ci_031                -1.752572e-03 3 1  ON 30
ci_032                -1.712345e-03 3 1  ON 31
ci_033                 4.323087e-03 3 1  ON 32
ci_034                 4.218423e-03 3 1  ON 33
ci_035                 2.731521e-03 3 1  ON 34
ci_036                 2.766807e-03 3 1  ON 35
ci_037                 4.698709e-03 3 1  ON 36
ci_038                 4.543980e-03 3 1  ON 37
ci_039                 4.575862e-03 3 1  ON 38
ci_040                 4.649276e-03 3 1  ON 39
ci_041                 3.709765e-03 3 1  ON 40
ci_042                 3.564935e-03 3 1  ON 41
ci_043                 3.871054e-03 3 1  ON 42
ci_044                 4.051658e-03 3 1  ON 43
ci_045                 3.212883e-03 3 1  ON 44
ci_046                 3.193921e-03 3 1  ON 45
ci_047                -1.602392e-03 3 1  ON 46
ci_048                -1.711307e-03 3 1  ON 47
ci_049                 1.395067e-03 3 1  ON 48
ci_050                 1.485030e-03 3 1  ON 49
ci_051                -2.168702e-03 3 1  ON 50
ci_052                -2.075745e-03 3 1  ON 51
ci_053                -2.237335e-03 3 1  ON 52
ci_054                -2.386609e-03 3 1  ON 53
ci_055                -1.127378e-03 3 1  ON 54
ci_056                -1.633141e-03 3 1  ON 55
ci_057                -1.220494e-03 3 1  ON 56
ci_058                -1.464070e-03 3 1  ON 57
ci_059                -8.246432e-04 3 1  ON 58
ci_060                -6.595868e-04 3 1  ON 59
ci_061                -9.751049e-04 3 1  ON 60
ci_062                -7.192143e-04 3 1  ON 61
ci_063                -5.999475e-04 3 1  ON 62
ci_064                -7.499795e-04 3 1  ON 63
ci_065                -1.920205e-03 3 1  ON 64
ci_066                -2.109149e-03 3 1  ON 65
ci_067                -1.468178e-03 3 1  ON 66
ci_068                -1.105821e-03 3 1  ON 67
ci_069                -1.766734e-05 3 1  ON 68
ci_070                 1.346803e-04 3 1  ON 69
ci_071                -1.876843e-03 3 1  ON 70
ci_072                -1.752652e-03 3 1  ON 71
ci_073                 5.002751e-04 3 1  ON 72
ci_074                 4.889039e-04 3 1  ON 73
ci_075                -1.862512e-04 3 1  ON 74
ci_076                -1.155662e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4665e+02 secs
  Total Execution time = 1.4718e+04 secs

=========================================================
  A new xml input file : FORM2.s099.cont.xml
