Rank =    0  Free Memory = 70867 MB
Rank =    1  Free Memory = 70867 MB
Rank =    2  Free Memory = 70867 MB
Rank =    3  Free Memory = 70867 MB
Rank =    4  Free Memory = 70867 MB
Rank =    5  Free Memory = 70867 MB
Rank =    6  Free Memory = 70867 MB
Rank =    7  Free Memory = 70867 MB
Rank =    8  Free Memory = 70867 MB
Rank =    9  Free Memory = 70867 MB
Rank =   10  Free Memory = 70867 MB
Rank =   11  Free Memory = 70867 MB
Rank =   12  Free Memory = 70867 MB
Rank =   13  Free Memory = 70867 MB
Rank =   14  Free Memory = 70866 MB
Rank =   15  Free Memory = 70852 MB
Rank =   16  Free Memory = 70852 MB
Rank =   17  Free Memory = 70852 MB
Rank =   18  Free Memory = 70852 MB
Rank =   19  Free Memory = 70852 MB
Rank =   20  Free Memory = 70852 MB
Rank =   21  Free Memory = 70852 MB
Rank =   22  Free Memory = 70852 MB
Rank =   23  Free Memory = 70852 MB
Rank =   24  Free Memory = 70852 MB
Rank =   25  Free Memory = 70852 MB
Rank =   26  Free Memory = 70852 MB
Rank =   27  Free Memory = 70852 MB
Rank =   28  Free Memory = 70852 MB
Rank =   29  Free Memory = 70852 MB
Rank =   30  Free Memory = 70852 MB
Rank =   31  Free Memory = 70852 MB
Rank =   32  Free Memory = 66433 MB
Rank =   33  Free Memory = 66433 MB
Rank =   34  Free Memory = 66433 MB
Rank =   35  Free Memory = 66433 MB
Rank =   36  Free Memory = 66433 MB
Rank =   37  Free Memory = 66433 MB
Rank =   38  Free Memory = 66433 MB
Rank =   39  Free Memory = 66433 MB
Rank =   40  Free Memory = 66433 MB
Rank =   41  Free Memory = 66433 MB
Rank =   42  Free Memory = 66433 MB
Rank =   43  Free Memory = 66433 MB
Rank =   44  Free Memory = 66433 MB
Rank =   45  Free Memory = 66433 MB
Rank =   46  Free Memory = 66433 MB
Rank =   47  Free Memory = 66433 MB
Rank =   48  Free Memory = 66433 MB
Rank =   49  Free Memory = 66433 MB
Rank =   50  Free Memory = 66433 MB
Rank =   51  Free Memory = 66433 MB
Rank =   52  Free Memory = 66433 MB
Rank =   53  Free Memory = 66433 MB
Rank =   54  Free Memory = 66433 MB
Rank =   55  Free Memory = 66433 MB
Rank =   56  Free Memory = 66433 MB
Rank =   57  Free Memory = 66432 MB
Rank =   58  Free Memory = 66432 MB
Rank =   59  Free Memory = 66432 MB
Rank =   60  Free Memory = 66432 MB
Rank =   61  Free Memory = 66432 MB
Rank =   62  Free Memory = 66432 MB
Rank =   63  Free Memory = 66432 MB
Rank =   64  Free Memory = 89972 MB
Rank =   65  Free Memory = 89972 MB
Rank =   66  Free Memory = 89972 MB
Rank =   67  Free Memory = 89972 MB
Rank =   68  Free Memory = 89972 MB
Rank =   69  Free Memory = 89972 MB
Rank =   70  Free Memory = 89972 MB
Rank =   71  Free Memory = 89972 MB
Rank =   72  Free Memory = 89972 MB
Rank =   73  Free Memory = 89972 MB
Rank =   74  Free Memory = 89972 MB
Rank =   75  Free Memory = 89972 MB
Rank =   76  Free Memory = 89972 MB
Rank =   77  Free Memory = 89972 MB
Rank =   78  Free Memory = 89972 MB
Rank =   79  Free Memory = 89972 MB
Rank =   80  Free Memory = 89972 MB
Rank =   81  Free Memory = 89972 MB
Rank =   82  Free Memory = 89972 MB
Rank =   83  Free Memory = 89972 MB
Rank =   84  Free Memory = 89972 MB
Rank =   85  Free Memory = 89972 MB
Rank =   86  Free Memory = 89972 MB
Rank =   87  Free Memory = 89972 MB
Rank =   88  Free Memory = 89972 MB
Rank =   89  Free Memory = 89972 MB
Rank =   90  Free Memory = 89972 MB
Rank =   91  Free Memory = 89972 MB
Rank =   92  Free Memory = 89972 MB
Rank =   93  Free Memory = 89972 MB
Rank =   94  Free Memory = 89972 MB
Rank =   95  Free Memory = 89972 MB
Rank =   96  Free Memory = 56385 MB
Rank =   97  Free Memory = 56385 MB
Rank =   98  Free Memory = 56385 MB
Rank =   99  Free Memory = 56385 MB
Rank =  100  Free Memory = 56385 MB
Rank =  101  Free Memory = 56385 MB
Rank =  102  Free Memory = 56385 MB
Rank =  103  Free Memory = 56385 MB
Rank =  104  Free Memory = 56385 MB
Rank =  105  Free Memory = 56385 MB
Rank =  106  Free Memory = 56385 MB
Rank =  107  Free Memory = 56385 MB
Rank =  108  Free Memory = 56385 MB
Rank =  109  Free Memory = 56385 MB
Rank =  110  Free Memory = 56385 MB
Rank =  111  Free Memory = 56385 MB
Rank =  112  Free Memory = 56385 MB
Rank =  113  Free Memory = 56385 MB
Rank =  114  Free Memory = 56385 MB
Rank =  115  Free Memory = 56385 MB
Rank =  116  Free Memory = 56385 MB
Rank =  117  Free Memory = 56385 MB
Rank =  118  Free Memory = 56385 MB
Rank =  119  Free Memory = 56385 MB
Rank =  120  Free Memory = 56385 MB
Rank =  121  Free Memory = 56385 MB
Rank =  122  Free Memory = 56385 MB
Rank =  123  Free Memory = 56385 MB
Rank =  124  Free Memory = 56385 MB
Rank =  125  Free Memory = 56385 MB
Rank =  126  Free Memory = 56385 MB
Rank =  127  Free Memory = 56385 MB
  Input file(s): opt_form_n2pistar_lmtt_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_lmtt_run001c.xml

  Project = FORM
  date    = 2023-02-17 10:17:45 PST
  host    = n0064.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 201

  Range of prime numbers to use as seeds over processors and threads = 1237-2221


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.969878e-01    1         1 OFF
     uu_1                 1.214598e-01    1         1 OFF
     uu_2                 7.692261e-03    1         1 OFF
     uu_3                -5.988518e-02    1         1 OFF
     uu_4                -1.008186e-01    1         1 OFF
     uu_5                -1.267693e-01    1         1 OFF
     uu_6                -1.424572e-01    1         1 OFF
     uu_7                -1.471938e-01    1         1 OFF
     uu_8                -1.395512e-01    1         1 OFF
     uu_9                -1.170827e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.098493e-01    1         1 OFF
     ud_1                 1.280868e-01    1         1 OFF
     ud_2                -1.741848e-02    1         1 OFF
     ud_3                -9.455707e-02    1         1 OFF
     ud_4                -1.368506e-01    1         1 OFF
     ud_5                -1.613527e-01    1         1 OFF
     ud_6                -1.739996e-01    1         1 OFF
     ud_7                -1.751521e-01    1         1 OFF
     ud_8                -1.631144e-01    1         1 OFF
     ud_9                -1.336224e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.810574e-01    1         1 OFF
     eC_1                -4.296394e-01    1         1 OFF
     eC_2                -1.793900e-01    1         1 OFF
     eC_3                -2.513542e-02    1         1 OFF
     eC_4                 5.576471e-02    1         1 OFF
     eC_5                 1.582299e-01    1         1 OFF
     eC_6                 2.553617e-01    1         1 OFF
     eC_7                 3.740835e-01    1         1 OFF
     eC_8                 2.827417e-01    1         1 OFF
     eC_9                 8.197673e-02    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.183058e+00    1         1 OFF
     eO_1                -8.065315e-01    1         1 OFF
     eO_2                -3.412496e-01    1         1 OFF
     eO_3                -7.608637e-04    1         1 OFF
     eO_4                 2.238678e-01    1         1 OFF
     eO_5                 3.875698e-01    1         1 OFF
     eO_6                 4.319831e-01    1         1 OFF
     eO_7                 4.299413e-01    1         1 OFF
     eO_8                 4.063458e-01    1         1 OFF
     eO_9                 3.120286e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.086297e-01    1         1 OFF
     eH1_1                -1.161154e-01    1         1 OFF
     eH1_2                -7.867980e-02    1         1 OFF
     eH1_3                -5.952234e-02    1         1 OFF
     eH1_4                 1.067786e-02    1         1 OFF
     eH1_5                 5.587847e-02    1         1 OFF
     eH1_6                 9.050690e-02    1         1 OFF
     eH1_7                 6.415771e-02    1         1 OFF
     eH1_8                 6.534814e-03    1         1 OFF
     eH1_9                 6.249708e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.043774e-01    1         1 OFF
     eH2_1                -1.120154e-01    1         1 OFF
     eH2_2                -7.472353e-02    1         1 OFF
     eH2_3                -5.568105e-02    1         1 OFF
     eH2_4                 1.425377e-02    1         1 OFF
     eH2_5                 5.879339e-02    1         1 OFF
     eH2_6                 9.301498e-02    1         1 OFF
     eH2_7                 6.632804e-02    1         1 OFF
     eH2_8                 1.611107e-02    1         1 OFF
     eH2_9                 6.620031e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.001167e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.0814e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.657
    reference variance = 0.398309
====================================================
  Execution time = 2.6797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1412e-01
  Total weights = 1.955025292e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500665146250
                                         uncertainty =       0.003001887557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500665146250
                                         uncertainty =       0.003001887557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500440388
  error estimate for blocks of size 2^( 2) =       0.000518627129
  error estimate for blocks of size 2^( 3) =       0.000534746255
  error estimate for blocks of size 2^( 4) =       0.000545609380
  error estimate for blocks of size 2^( 5) =       0.000552808639
  error estimate for blocks of size 2^( 6) =       0.000558332899
  error estimate for blocks of size 2^( 7) =       0.000562152174

      target function =                  N/A
              le_mean =     -22.668780889321
             les_mean =     514.387744530652
             stat err =       0.000554725773
             autocorr =       1.228717329811
              std dev =       0.707729584130
             le_variance =       0.500881164252


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266878088932e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668780889433       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668848662889       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668856037619       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668856106041       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668856128862       residual = 9.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.773648e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668780889433       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668804520049       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668805615583       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668805630177       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 5.133675e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668780889433       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668787443790       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668787603379       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668787636634       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.448116e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.003837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1650e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001 -7.056112e-01                3 1 ON  0
ci_002 -7.036566e-01                3 1 ON  1
ci_003 -4.903421e-02                3 1 ON  2
ci_004 -4.886755e-02                3 1 ON  3
ci_005 1.792024e-02                 3 1 ON  4
ci_006 1.782332e-02                 3 1 ON  5
ci_007 1.497733e-02                 3 1 ON  6
ci_008 1.489073e-02                 3 1 ON  7
ci_009 -1.247203e-02                3 1 ON  8
ci_010 -1.257445e-02                3 1 ON  9
ci_011 -9.707429e-03                3 1 ON  10
ci_012 -9.961928e-03                3 1 ON  11
ci_013 1.046820e-02                 3 1 ON  12
ci_014 1.080092e-02                 3 1 ON  13
ci_015 1.349325e-02                 3 1 ON  14
ci_016 1.349381e-02                 3 1 ON  15
ci_017 1.110360e-02                 3 1 ON  16
ci_018 1.123460e-02                 3 1 ON  17
ci_019 1.263880e-03                 3 1 ON  18
ci_020 1.754272e-03                 3 1 ON  19
ci_021 -7.855184e-03                3 1 ON  20
ci_022 -8.655867e-03                3 1 ON  21
ci_023 8.094319e-03                 3 1 ON  22
ci_024 7.752923e-03                 3 1 ON  23
ci_025 4.178243e-03                 3 1 ON  24
ci_026 3.652315e-03                 3 1 ON  25
ci_027 6.205733e-03                 3 1 ON  26
ci_028 6.644949e-03                 3 1 ON  27
ci_029 -5.483667e-03                3 1 ON  28
ci_030 -5.321802e-03                3 1 ON  29
ci_031 -7.437015e-03                3 1 ON  30
ci_032 -7.941214e-03                3 1 ON  31
ci_033 5.062472e-03                 3 1 ON  32
ci_034 4.592131e-03                 3 1 ON  33
ci_035 1.545107e-03                 3 1 ON  34
ci_036 1.694600e-03                 3 1 ON  35
ci_037 5.278028e-03                 3 1 ON  36
ci_038 5.510740e-03                 3 1 ON  37
ci_039 5.324975e-03                 3 1 ON  38
ci_040 5.045724e-03                 3 1 ON  39
ci_041 5.249086e-03                 3 1 ON  40
ci_042 4.684463e-03                 3 1 ON  41
ci_043 5.675607e-03                 3 1 ON  42
ci_044 5.228259e-03                 3 1 ON  43
ci_045 3.392865e-03                 3 1 ON  44
ci_046 3.191177e-03                 3 1 ON  45
ci_047 -8.578918e-04                3 1 ON  46
ci_048 -1.000337e-03                3 1 ON  47
ci_049 1.553528e-03                 3 1 ON  48
ci_050 1.876028e-03                 3 1 ON  49
ci_051 -1.944518e-03                3 1 ON  50
ci_052 -2.026320e-03                3 1 ON  51
ci_053 -2.604032e-03                3 1 ON  52
ci_054 -2.068676e-03                3 1 ON  53
ci_055 -1.798443e-03                3 1 ON  54
ci_056 -1.553675e-03                3 1 ON  55
ci_057 -1.171969e-03                3 1 ON  56
ci_058 -1.806972e-03                3 1 ON  57
ci_059 1.148583e-04                 3 1 ON  58
ci_060 3.415459e-04                 3 1 ON  59
ci_061 -5.130538e-04                3 1 ON  60
ci_062 -2.999742e-04                3 1 ON  61
ci_063 -5.899724e-04                3 1 ON  62
ci_064 6.507151e-05                 3 1 ON  63
ci_065 -2.442781e-03                3 1 ON  64
ci_066 -2.306611e-03                3 1 ON  65
ci_067 -2.669510e-03                3 1 ON  66
ci_068 -2.867061e-03                3 1 ON  67
ci_069 2.669520e-04                 3 1 ON  68
ci_070 4.951701e-04                 3 1 ON  69
ci_071 -2.224396e-03                3 1 ON  70
ci_072 -2.041534e-03                3 1 ON  71
ci_073 1.908454e-04                 3 1 ON  72
ci_074 2.564383e-04                 3 1 ON  73
ci_075 -4.778264e-04                3 1 ON  74
ci_076 -1.784190e-04                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7293
    reference variance = 0.431219
====================================================
  Execution time = 2.5827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0800e-01
  Total weights = 1.9554e+06
  Execution time = 3.6593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494885967458
                                         uncertainty =       0.003252963912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494885967458
                                         uncertainty =       0.003252963912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497395881
  error estimate for blocks of size 2^( 2) =       0.000514884472
  error estimate for blocks of size 2^( 3) =       0.000531197437
  error estimate for blocks of size 2^( 4) =       0.000543245205
  error estimate for blocks of size 2^( 5) =       0.000550386509
  error estimate for blocks of size 2^( 6) =       0.000553242127
  error estimate for blocks of size 2^( 7) =       0.000555439136

      target function =                  N/A
              le_mean =     -22.668833916582
             les_mean =     514.385230554391
             stat err =       0.000550578244
             autocorr =       1.225275426260
              std dev =       0.703424001064
             le_variance =       0.494805325272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494416659694
                                         uncertainty =       0.003204372283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494416659694
                                         uncertainty =       0.003204372283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497159971
  error estimate for blocks of size 2^( 2) =       0.000514672524
  error estimate for blocks of size 2^( 3) =       0.000530996347
  error estimate for blocks of size 2^( 4) =       0.000543033237
  error estimate for blocks of size 2^( 5) =       0.000550162475
  error estimate for blocks of size 2^( 6) =       0.000553062675
  error estimate for blocks of size 2^( 7) =       0.000555251201

      target function =                  N/A
              le_mean =     -22.668836107996
             les_mean =     514.454544111993
             stat err =       0.000550377397
             autocorr =       1.225543896558
              std dev =       0.703090373782
             le_variance =       0.494336073706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494293104250
                                         uncertainty =       0.003222144171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494293104250
                                         uncertainty =       0.003222144171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497097728
  error estimate for blocks of size 2^( 2) =       0.000514600396
  error estimate for blocks of size 2^( 3) =       0.000530915615
  error estimate for blocks of size 2^( 4) =       0.000542957563
  error estimate for blocks of size 2^( 5) =       0.000550104276
  error estimate for blocks of size 2^( 6) =       0.000552977190
  error estimate for blocks of size 2^( 7) =       0.000555179955

      target function =                  N/A
              le_mean =     -22.668829939195
             les_mean =     514.386513687718
             stat err =       0.000550304746
             autocorr =       1.225527216326
              std dev =       0.703002348748
             le_variance =       0.494212302345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494899731442
                                         uncertainty =       0.003240579084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494899731442
                                         uncertainty =       0.003240579084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497402760
  error estimate for blocks of size 2^( 2) =       0.000514892888
  error estimate for blocks of size 2^( 3) =       0.000531198778
  error estimate for blocks of size 2^( 4) =       0.000543251255
  error estimate for blocks of size 2^( 5) =       0.000550368426
  error estimate for blocks of size 2^( 6) =       0.000553235347
  error estimate for blocks of size 2^( 7) =       0.000555435340

      target function =                  N/A
              le_mean =     -22.668839383457
             les_mean =     514.574463254419
             stat err =       0.000550572592
             autocorr =       1.225216379992
              std dev =       0.703433729236
             le_variance =       0.494819011428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668833916582        initial
     2.5000e-01     2.5000e+00             1.7736e-03       -22.668836107996
     1.0000e+00     1.0000e+01             5.1337e-04       -22.668829939195
     4.0000e+00     4.0000e+01             1.4481e-04       -22.668839383457  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.4168e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001                -7.055685e-01 3 1  ON 0
ci_002                -7.035942e-01 3 1  ON 1
ci_003                -4.937261e-02 3 1  ON 2
ci_004                -4.924739e-02 3 1  ON 3
ci_005                 1.822054e-02 3 1  ON 4
ci_006                 1.817405e-02 3 1  ON 5
ci_007                 1.530579e-02 3 1  ON 6
ci_008                 1.523680e-02 3 1  ON 7
ci_009                -1.256533e-02 3 1  ON 8
ci_010                -1.278952e-02 3 1  ON 9
ci_011                -9.854219e-03 3 1  ON 10
ci_012                -1.017164e-02 3 1  ON 11
ci_013                 1.052783e-02 3 1  ON 12
ci_014                 1.105858e-02 3 1  ON 13
ci_015                 1.361418e-02 3 1  ON 14
ci_016                 1.372026e-02 3 1  ON 15
ci_017                 1.107915e-02 3 1  ON 16
ci_018                 1.130938e-02 3 1  ON 17
ci_019                 1.593030e-03 3 1  ON 18
ci_020                 2.062334e-03 3 1  ON 19
ci_021                -7.776026e-03 3 1  ON 20
ci_022                -8.668004e-03 3 1  ON 21
ci_023                 8.023319e-03 3 1  ON 22
ci_024                 7.762190e-03 3 1  ON 23
ci_025                 4.177260e-03 3 1  ON 24
ci_026                 3.585238e-03 3 1  ON 25
ci_027                 6.160455e-03 3 1  ON 26
ci_028                 6.664298e-03 3 1  ON 27
ci_029                -5.525142e-03 3 1  ON 28
ci_030                -5.315965e-03 3 1  ON 29
ci_031                -7.455169e-03 3 1  ON 30
ci_032                -7.902253e-03 3 1  ON 31
ci_033                 5.058041e-03 3 1  ON 32
ci_034                 4.525650e-03 3 1  ON 33
ci_035                 1.614910e-03 3 1  ON 34
ci_036                 1.820226e-03 3 1  ON 35
ci_037                 5.302515e-03 3 1  ON 36
ci_038                 5.576122e-03 3 1  ON 37
ci_039                 5.264898e-03 3 1  ON 38
ci_040                 5.118897e-03 3 1  ON 39
ci_041                 5.186050e-03 3 1  ON 40
ci_042                 4.667806e-03 3 1  ON 41
ci_043                 5.561910e-03 3 1  ON 42
ci_044                 5.136449e-03 3 1  ON 43
ci_045                 3.279360e-03 3 1  ON 44
ci_046                 3.205028e-03 3 1  ON 45
ci_047                -9.422757e-04 3 1  ON 46
ci_048                -1.063784e-03 3 1  ON 47
ci_049                 1.439911e-03 3 1  ON 48
ci_050                 1.947947e-03 3 1  ON 49
ci_051                -2.092885e-03 3 1  ON 50
ci_052                -2.151537e-03 3 1  ON 51
ci_053                -2.526362e-03 3 1  ON 52
ci_054                -1.923508e-03 3 1  ON 53
ci_055                -1.634864e-03 3 1  ON 54
ci_056                -1.531581e-03 3 1  ON 55
ci_057                -1.148788e-03 3 1  ON 56
ci_058                -1.650677e-03 3 1  ON 57
ci_059                 1.933186e-04 3 1  ON 58
ci_060                 3.991693e-04 3 1  ON 59
ci_061                -6.117635e-04 3 1  ON 60
ci_062                -4.029664e-04 3 1  ON 61
ci_063                -7.347294e-04 3 1  ON 62
ci_064                -1.750421e-05 3 1  ON 63
ci_065                -2.692902e-03 3 1  ON 64
ci_066                -2.473136e-03 3 1  ON 65
ci_067                -2.599266e-03 3 1  ON 66
ci_068                -2.722539e-03 3 1  ON 67
ci_069                 2.743196e-04 3 1  ON 68
ci_070                 3.671707e-04 3 1  ON 69
ci_071                -2.291887e-03 3 1  ON 70
ci_072                -2.238678e-03 3 1  ON 71
ci_073                 2.647323e-04 3 1  ON 72
ci_074                 2.993025e-04 3 1  ON 73
ci_075                -4.487941e-04 3 1  ON 74
ci_076                -2.576656e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5826e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2693e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.69
    reference variance = 0.34519
====================================================
  Execution time = 2.6383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0923e-01
  Total weights = 1.954967584e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497551091175
                                         uncertainty =       0.002821785418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497551091175
                                         uncertainty =       0.002821785418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498783867
  error estimate for blocks of size 2^( 2) =       0.000516711144
  error estimate for blocks of size 2^( 3) =       0.000532888202
  error estimate for blocks of size 2^( 4) =       0.000543669338
  error estimate for blocks of size 2^( 5) =       0.000550490575
  error estimate for blocks of size 2^( 6) =       0.000552796059
  error estimate for blocks of size 2^( 7) =       0.000556069843

      target function =                  N/A
              le_mean =     -22.669449587846
             les_mean =     514.413173774111
             stat err =       0.000550756454
             autocorr =       1.219254573653
              std dev =       0.705386909702
             le_variance =       0.497570692379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266944958785e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669449587927       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669473054421       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669472547219       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669472688801       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 6.996626e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669449587927       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669456053324       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669455917595       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669455956855       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.811695e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669449587927       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669451246598       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669451214107       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669451223609       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 4.569883e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005196 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1178e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -7.056098e-01 3 1  ON 0
ci_002                -7.035964e-01 3 1  ON 1
ci_003                -4.919144e-02 3 1  ON 2
ci_004                -4.908311e-02 3 1  ON 3
ci_005                 1.809485e-02 3 1  ON 4
ci_006                 1.804008e-02 3 1  ON 5
ci_007                 1.520683e-02 3 1  ON 6
ci_008                 1.518531e-02 3 1  ON 7
ci_009                -1.254111e-02 3 1  ON 8
ci_010                -1.272242e-02 3 1  ON 9
ci_011                -9.788367e-03 3 1  ON 10
ci_012                -1.010727e-02 3 1  ON 11
ci_013                 1.047925e-02 3 1  ON 12
ci_014                 1.098733e-02 3 1  ON 13
ci_015                 1.359105e-02 3 1  ON 14
ci_016                 1.368537e-02 3 1  ON 15
ci_017                 1.103188e-02 3 1  ON 16
ci_018                 1.127787e-02 3 1  ON 17
ci_019                 1.489446e-03 3 1  ON 18
ci_020                 1.964577e-03 3 1  ON 19
ci_021                -7.781713e-03 3 1  ON 20
ci_022                -8.679182e-03 3 1  ON 21
ci_023                 7.950712e-03 3 1  ON 22
ci_024                 7.783726e-03 3 1  ON 23
ci_025                 4.219285e-03 3 1  ON 24
ci_026                 3.623319e-03 3 1  ON 25
ci_027                 6.145293e-03 3 1  ON 26
ci_028                 6.653378e-03 3 1  ON 27
ci_029                -5.495266e-03 3 1  ON 28
ci_030                -5.287570e-03 3 1  ON 29
ci_031                -7.415485e-03 3 1  ON 30
ci_032                -7.941834e-03 3 1  ON 31
ci_033                 5.044193e-03 3 1  ON 32
ci_034                 4.555519e-03 3 1  ON 33
ci_035                 1.559363e-03 3 1  ON 34
ci_036                 1.789216e-03 3 1  ON 35
ci_037                 5.298260e-03 3 1  ON 36
ci_038                 5.578844e-03 3 1  ON 37
ci_039                 5.336895e-03 3 1  ON 38
ci_040                 5.131604e-03 3 1  ON 39
ci_041                 5.177165e-03 3 1  ON 40
ci_042                 4.736960e-03 3 1  ON 41
ci_043                 5.551547e-03 3 1  ON 42
ci_044                 5.097952e-03 3 1  ON 43
ci_045                 3.236853e-03 3 1  ON 44
ci_046                 3.197153e-03 3 1  ON 45
ci_047                -9.402615e-04 3 1  ON 46
ci_048                -1.015201e-03 3 1  ON 47
ci_049                 1.484393e-03 3 1  ON 48
ci_050                 1.886418e-03 3 1  ON 49
ci_051                -2.043357e-03 3 1  ON 50
ci_052                -2.130891e-03 3 1  ON 51
ci_053                -2.525087e-03 3 1  ON 52
ci_054                -1.992160e-03 3 1  ON 53
ci_055                -1.634750e-03 3 1  ON 54
ci_056                -1.507343e-03 3 1  ON 55
ci_057                -1.187779e-03 3 1  ON 56
ci_058                -1.632449e-03 3 1  ON 57
ci_059                 2.053283e-04 3 1  ON 58
ci_060                 4.347915e-04 3 1  ON 59
ci_061                -6.392621e-04 3 1  ON 60
ci_062                -3.912732e-04 3 1  ON 61
ci_063                -7.002969e-04 3 1  ON 62
ci_064                -5.021179e-05 3 1  ON 63
ci_065                -2.648508e-03 3 1  ON 64
ci_066                -2.491869e-03 3 1  ON 65
ci_067                -2.567874e-03 3 1  ON 66
ci_068                -2.688889e-03 3 1  ON 67
ci_069                 2.603288e-04 3 1  ON 68
ci_070                 3.865952e-04 3 1  ON 69
ci_071                -2.259161e-03 3 1  ON 70
ci_072                -2.178065e-03 3 1  ON 71
ci_073                 2.927437e-04 3 1  ON 72
ci_074                 2.867059e-04 3 1  ON 73
ci_075                -4.385386e-04 3 1  ON 74
ci_076                -3.023404e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6143
    reference variance = 0.451422
====================================================
  Execution time = 2.5621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0601e-01
  Total weights = 1.9547e+06
  Execution time = 3.6417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495186531356
                                         uncertainty =       0.002499253357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495186531356
                                         uncertainty =       0.002499253357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497607177
  error estimate for blocks of size 2^( 2) =       0.000515821572
  error estimate for blocks of size 2^( 3) =       0.000532239835
  error estimate for blocks of size 2^( 4) =       0.000544393198
  error estimate for blocks of size 2^( 5) =       0.000552042091
  error estimate for blocks of size 2^( 6) =       0.000555847957
  error estimate for blocks of size 2^( 7) =       0.000561215206

      target function =                  N/A
              le_mean =     -22.669368109539
             les_mean =     514.406257854054
             stat err =       0.000553374613
             autocorr =       1.236702363175
              std dev =       0.703722818988
             le_variance =       0.495225805964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495071394426
                                         uncertainty =       0.002508310770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495071394426
                                         uncertainty =       0.002508310770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497549597
  error estimate for blocks of size 2^( 2) =       0.000515766451
  error estimate for blocks of size 2^( 3) =       0.000532191650
  error estimate for blocks of size 2^( 4) =       0.000544339282
  error estimate for blocks of size 2^( 5) =       0.000551969745
  error estimate for blocks of size 2^( 6) =       0.000555772508
  error estimate for blocks of size 2^( 7) =       0.000561144646

      target function =                  N/A
              le_mean =     -22.669369824638
             les_mean =     514.412830020251
             stat err =       0.000553306545
             autocorr =       1.236684328242
              std dev =       0.703641388041
             le_variance =       0.495111202964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495108856495
                                         uncertainty =       0.002503366769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495108856495
                                         uncertainty =       0.002503366769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497568318
  error estimate for blocks of size 2^( 2) =       0.000515784910
  error estimate for blocks of size 2^( 3) =       0.000532207815
  error estimate for blocks of size 2^( 4) =       0.000544357776
  error estimate for blocks of size 2^( 5) =       0.000551998441
  error estimate for blocks of size 2^( 6) =       0.000555800122
  error estimate for blocks of size 2^( 7) =       0.000561174303

      target function =                  N/A
              le_mean =     -22.669368922052
             les_mean =     514.406538400905
             stat err =       0.000553332661
             autocorr =       1.236708003641
              std dev =       0.703667863942
             le_variance =       0.495148462744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495175375373
                                         uncertainty =       0.002499726154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495175375373
                                         uncertainty =       0.002499726154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497601595
  error estimate for blocks of size 2^( 2) =       0.000515816329
  error estimate for blocks of size 2^( 3) =       0.000532235204
  error estimate for blocks of size 2^( 4) =       0.000544388124
  error estimate for blocks of size 2^( 5) =       0.000552035992
  error estimate for blocks of size 2^( 6) =       0.000555841211
  error estimate for blocks of size 2^( 7) =       0.000561209391

      target function =                  N/A
              le_mean =     -22.669368113697
             les_mean =     514.406207373032
             stat err =       0.000553368680
             autocorr =       1.236703592183
              std dev =       0.703714923904
             le_variance =       0.495214694125


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669368109539        initial
     1.0000e+00     1.0000e+01             6.9966e-04       -22.669369824638  <--
     4.0000e+00     4.0000e+01             1.8117e-04       -22.669368922052
     1.6000e+01     1.6000e+02             4.5699e-05       -22.669368113697

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3895e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -7.057272e-01 3 1  ON 0
ci_002                -7.035969e-01 3 1  ON 1
ci_003                -4.867295e-02 3 1  ON 2
ci_004                -4.861448e-02 3 1  ON 3
ci_005                 1.779138e-02 3 1  ON 4
ci_006                 1.771608e-02 3 1  ON 5
ci_007                 1.494864e-02 3 1  ON 6
ci_008                 1.505088e-02 3 1  ON 7
ci_009                -1.248093e-02 3 1  ON 8
ci_010                -1.255091e-02 3 1  ON 9
ci_011                -9.617664e-03 3 1  ON 10
ci_012                -9.936034e-03 3 1  ON 11
ci_013                 1.035643e-02 3 1  ON 12
ci_014                 1.080022e-02 3 1  ON 13
ci_015                 1.352937e-02 3 1  ON 14
ci_016                 1.359292e-02 3 1  ON 15
ci_017                 1.090992e-02 3 1  ON 16
ci_018                 1.119717e-02 3 1  ON 17
ci_019                 1.206704e-03 3 1  ON 18
ci_020                 1.698175e-03 3 1  ON 19
ci_021                -7.799389e-03 3 1  ON 20
ci_022                -8.706209e-03 3 1  ON 21
ci_023                 7.769215e-03 3 1  ON 22
ci_024                 7.838476e-03 3 1  ON 23
ci_025                 4.337303e-03 3 1  ON 24
ci_026                 3.732641e-03 3 1  ON 25
ci_027                 6.111052e-03 3 1  ON 26
ci_028                 6.627377e-03 3 1  ON 27
ci_029                -5.420247e-03 3 1  ON 28
ci_030                -5.210990e-03 3 1  ON 29
ci_031                -7.311126e-03 3 1  ON 30
ci_032                -8.047459e-03 3 1  ON 31
ci_033                 5.008277e-03 3 1  ON 32
ci_034                 4.633153e-03 3 1  ON 33
ci_035                 1.426307e-03 3 1  ON 34
ci_036                 1.714144e-03 3 1  ON 35
ci_037                 5.284817e-03 3 1  ON 36
ci_038                 5.582091e-03 3 1  ON 37
ci_039                 5.509133e-03 3 1  ON 38
ci_040                 5.162026e-03 3 1  ON 39
ci_041                 5.154729e-03 3 1  ON 40
ci_042                 4.909191e-03 3 1  ON 41
ci_043                 5.522933e-03 3 1  ON 42
ci_044                 4.997189e-03 3 1  ON 43
ci_045                 3.128496e-03 3 1  ON 44
ci_046                 3.175912e-03 3 1  ON 45
ci_047                -9.349986e-04 3 1  ON 46
ci_048                -8.998315e-04 3 1  ON 47
ci_049                 1.599704e-03 3 1  ON 48
ci_050                 1.726508e-03 3 1  ON 49
ci_051                -1.911287e-03 3 1  ON 50
ci_052                -2.076671e-03 3 1  ON 51
ci_053                -2.525653e-03 3 1  ON 52
ci_054                -2.173687e-03 3 1  ON 53
ci_055                -1.636141e-03 3 1  ON 54
ci_056                -1.442864e-03 3 1  ON 55
ci_057                -1.286024e-03 3 1  ON 56
ci_058                -1.585561e-03 3 1  ON 57
ci_059                 2.308018e-04 3 1  ON 58
ci_060                 5.186339e-04 3 1  ON 59
ci_061                -7.121575e-04 3 1  ON 60
ci_062                -3.599946e-04 3 1  ON 61
ci_063                -6.134032e-04 3 1  ON 62
ci_064                -1.378607e-04 3 1  ON 63
ci_065                -2.536041e-03 3 1  ON 64
ci_066                -2.538799e-03 3 1  ON 65
ci_067                -2.486354e-03 3 1  ON 66
ci_068                -2.601270e-03 3 1  ON 67
ci_069                 2.242086e-04 3 1  ON 68
ci_070                 4.379826e-04 3 1  ON 69
ci_071                -2.174038e-03 3 1  ON 70
ci_072                -2.020699e-03 3 1  ON 71
ci_073                 3.579020e-04 3 1  ON 72
ci_074                 2.537494e-04 3 1  ON 73
ci_075                -4.121189e-04 3 1  ON 74
ci_076                -4.154963e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8211
    reference variance = 0.551274
====================================================
  Execution time = 2.6436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5322e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0477e-01
  Total weights = 1.955212686e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493123008136
                                         uncertainty =       0.002894255656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493123008136
                                         uncertainty =       0.002894255656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496525046
  error estimate for blocks of size 2^( 2) =       0.000514409322
  error estimate for blocks of size 2^( 3) =       0.000530520384
  error estimate for blocks of size 2^( 4) =       0.000542313822
  error estimate for blocks of size 2^( 5) =       0.000549089452
  error estimate for blocks of size 2^( 6) =       0.000554761069
  error estimate for blocks of size 2^( 7) =       0.000556555583

      target function =                  N/A
              le_mean =     -22.669855699049
             les_mean =     514.427128569893
             stat err =       0.000550679981
             autocorr =       1.230031567193
              std dev =       0.702192454466
             le_variance =       0.493074243109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266985569905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669855699147       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669913560030       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669914085958       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669914558375       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 2.045760e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669855699147       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669875579808       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669875272460       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669875387048       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 5.884753e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669855699147       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669861182508       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669861079779       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669861108913       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.528640e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1261e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.057838e-01 3 1  ON 0
ci_002                -7.036616e-01 3 1  ON 1
ci_003                -4.828979e-02 3 1  ON 2
ci_004                -4.802601e-02 3 1  ON 3
ci_005                 1.749127e-02 3 1  ON 4
ci_006                 1.731806e-02 3 1  ON 5
ci_007                 1.455686e-02 3 1  ON 6
ci_008                 1.480304e-02 3 1  ON 7
ci_009                -1.233765e-02 3 1  ON 8
ci_010                -1.237956e-02 3 1  ON 9
ci_011                -9.444312e-03 3 1  ON 10
ci_012                -9.712661e-03 3 1  ON 11
ci_013                 1.031167e-02 3 1  ON 12
ci_014                 1.077629e-02 3 1  ON 13
ci_015                 1.335069e-02 3 1  ON 14
ci_016                 1.370918e-02 3 1  ON 15
ci_017                 1.073605e-02 3 1  ON 16
ci_018                 1.110726e-02 3 1  ON 17
ci_019                 8.837223e-04 3 1  ON 18
ci_020                 1.271671e-03 3 1  ON 19
ci_021                -7.879986e-03 3 1  ON 20
ci_022                -8.536663e-03 3 1  ON 21
ci_023                 7.768229e-03 3 1  ON 22
ci_024                 7.725111e-03 3 1  ON 23
ci_025                 4.195660e-03 3 1  ON 24
ci_026                 3.841728e-03 3 1  ON 25
ci_027                 6.313337e-03 3 1  ON 26
ci_028                 6.864657e-03 3 1  ON 27
ci_029                -5.146995e-03 3 1  ON 28
ci_030                -5.273682e-03 3 1  ON 29
ci_031                -7.488080e-03 3 1  ON 30
ci_032                -8.025433e-03 3 1  ON 31
ci_033                 4.673970e-03 3 1  ON 32
ci_034                 4.548171e-03 3 1  ON 33
ci_035                 1.465495e-03 3 1  ON 34
ci_036                 1.690845e-03 3 1  ON 35
ci_037                 5.325794e-03 3 1  ON 36
ci_038                 5.475765e-03 3 1  ON 37
ci_039                 5.497850e-03 3 1  ON 38
ci_040                 5.049575e-03 3 1  ON 39
ci_041                 5.155970e-03 3 1  ON 40
ci_042                 4.683939e-03 3 1  ON 41
ci_043                 5.552022e-03 3 1  ON 42
ci_044                 4.951652e-03 3 1  ON 43
ci_045                 3.287945e-03 3 1  ON 44
ci_046                 3.315653e-03 3 1  ON 45
ci_047                -9.812075e-04 3 1  ON 46
ci_048                -8.079418e-04 3 1  ON 47
ci_049                 1.639488e-03 3 1  ON 48
ci_050                 1.682209e-03 3 1  ON 49
ci_051                -1.926191e-03 3 1  ON 50
ci_052                -1.955119e-03 3 1  ON 51
ci_053                -2.539599e-03 3 1  ON 52
ci_054                -2.213946e-03 3 1  ON 53
ci_055                -1.746501e-03 3 1  ON 54
ci_056                -1.375882e-03 3 1  ON 55
ci_057                -1.383423e-03 3 1  ON 56
ci_058                -1.727766e-03 3 1  ON 57
ci_059                 2.262464e-04 3 1  ON 58
ci_060                 4.204226e-04 3 1  ON 59
ci_061                -6.230226e-04 3 1  ON 60
ci_062                -4.498832e-04 3 1  ON 61
ci_063                -7.023034e-04 3 1  ON 62
ci_064                 6.511635e-05 3 1  ON 63
ci_065                -2.400915e-03 3 1  ON 64
ci_066                -2.671438e-03 3 1  ON 65
ci_067                -2.543438e-03 3 1  ON 66
ci_068                -2.344253e-03 3 1  ON 67
ci_069                 1.352174e-04 3 1  ON 68
ci_070                 3.192090e-04 3 1  ON 69
ci_071                -2.163844e-03 3 1  ON 70
ci_072                -2.032581e-03 3 1  ON 71
ci_073                 4.653769e-04 3 1  ON 72
ci_074                 4.057050e-04 3 1  ON 73
ci_075                -3.886489e-04 3 1  ON 74
ci_076                -3.001157e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6042
    reference variance = 0.3936
====================================================
  Execution time = 2.5709e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0994e-01
  Total weights = 1.9551e+06
  Execution time = 3.6438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496833840442
                                         uncertainty =       0.002359490855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496833840442
                                         uncertainty =       0.002359490855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498435475
  error estimate for blocks of size 2^( 2) =       0.000516531847
  error estimate for blocks of size 2^( 3) =       0.000532837180
  error estimate for blocks of size 2^( 4) =       0.000544041258
  error estimate for blocks of size 2^( 5) =       0.000551610192
  error estimate for blocks of size 2^( 6) =       0.000553902052
  error estimate for blocks of size 2^( 7) =       0.000553236422

      target function =                  N/A
              le_mean =     -22.669699106403
             les_mean =     514.430435028702
             stat err =       0.000550697481
             autocorr =       1.220698159290
              std dev =       0.704894209282
             le_variance =       0.496875846279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496563818515
                                         uncertainty =       0.002377929726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496563818515
                                         uncertainty =       0.002377929726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498298491
  error estimate for blocks of size 2^( 2) =       0.000516396789
  error estimate for blocks of size 2^( 3) =       0.000532686924
  error estimate for blocks of size 2^( 4) =       0.000543882756
  error estimate for blocks of size 2^( 5) =       0.000551435419
  error estimate for blocks of size 2^( 6) =       0.000553755590
  error estimate for blocks of size 2^( 7) =       0.000553140538

      target function =                  N/A
              le_mean =     -22.669707920941
             les_mean =     514.531998759150
             stat err =       0.000550553576
             autocorr =       1.220731163999
              std dev =       0.704700483554
             le_variance =       0.496602771521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496511396677
                                         uncertainty =       0.002359913341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496511396677
                                         uncertainty =       0.002359913341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498272739
  error estimate for blocks of size 2^( 2) =       0.000516378798
  error estimate for blocks of size 2^( 3) =       0.000532676439
  error estimate for blocks of size 2^( 4) =       0.000543883988
  error estimate for blocks of size 2^( 5) =       0.000551444145
  error estimate for blocks of size 2^( 6) =       0.000553720644
  error estimate for blocks of size 2^( 7) =       0.000553082143

      target function =                  N/A
              le_mean =     -22.669698320484
             les_mean =     514.429576635249
             stat err =       0.000550532730
             autocorr =       1.220764897806
              std dev =       0.704664064974
             le_variance =       0.496551444466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496846673847
                                         uncertainty =       0.002363943152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496846673847
                                         uncertainty =       0.002363943152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498441699
  error estimate for blocks of size 2^( 2) =       0.000516538675
  error estimate for blocks of size 2^( 3) =       0.000532841103
  error estimate for blocks of size 2^( 4) =       0.000544047057
  error estimate for blocks of size 2^( 5) =       0.000551626358
  error estimate for blocks of size 2^( 6) =       0.000553891264
  error estimate for blocks of size 2^( 7) =       0.000553240993

      target function =                  N/A
              le_mean =     -22.669703640559
             les_mean =     514.643841089790
             stat err =       0.000550701418
             autocorr =       1.220685130728
              std dev =       0.704903010473
             le_variance =       0.496888254174


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669699106403        initial
     2.5000e-01     2.5000e+00             2.0458e-03       -22.669707920941  <--
     1.0000e+00     1.0000e+01             5.8848e-04       -22.669698320484
     4.0000e+00     4.0000e+01             1.5286e-04       -22.669703640559

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.3983e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.059120e-01 3 1  ON 0
ci_002                -7.037928e-01 3 1  ON 1
ci_003                -4.734711e-02 3 1  ON 2
ci_004                -4.656872e-02 3 1  ON 3
ci_005                 1.703196e-02 3 1  ON 4
ci_006                 1.671143e-02 3 1  ON 5
ci_007                 1.385923e-02 3 1  ON 6
ci_008                 1.435490e-02 3 1  ON 7
ci_009                -1.206691e-02 3 1  ON 8
ci_010                -1.210125e-02 3 1  ON 9
ci_011                -9.128097e-03 3 1  ON 10
ci_012                -9.293700e-03 3 1  ON 11
ci_013                 1.024480e-02 3 1  ON 12
ci_014                 1.077412e-02 3 1  ON 13
ci_015                 1.298749e-02 3 1  ON 14
ci_016                 1.398236e-02 3 1  ON 15
ci_017                 1.038200e-02 3 1  ON 16
ci_018                 1.094430e-02 3 1  ON 17
ci_019                 2.315034e-04 3 1  ON 18
ci_020                 3.693015e-04 3 1  ON 19
ci_021                -8.012086e-03 3 1  ON 20
ci_022                -8.172473e-03 3 1  ON 21
ci_023                 7.766708e-03 3 1  ON 22
ci_024                 7.530422e-03 3 1  ON 23
ci_025                 3.967973e-03 3 1  ON 24
ci_026                 4.111508e-03 3 1  ON 25
ci_027                 6.605182e-03 3 1  ON 26
ci_028                 7.217510e-03 3 1  ON 27
ci_029                -4.631235e-03 3 1  ON 28
ci_030                -5.366519e-03 3 1  ON 29
ci_031                -7.843481e-03 3 1  ON 30
ci_032                -8.016219e-03 3 1  ON 31
ci_033                 4.018893e-03 3 1  ON 32
ci_034                 4.376110e-03 3 1  ON 33
ci_035                 1.504783e-03 3 1  ON 34
ci_036                 1.637822e-03 3 1  ON 35
ci_037                 5.399975e-03 3 1  ON 36
ci_038                 5.283861e-03 3 1  ON 37
ci_039                 5.483977e-03 3 1  ON 38
ci_040                 4.892779e-03 3 1  ON 39
ci_041                 5.160655e-03 3 1  ON 40
ci_042                 4.313529e-03 3 1  ON 41
ci_043                 5.602299e-03 3 1  ON 42
ci_044                 4.855127e-03 3 1  ON 43
ci_045                 3.629681e-03 3 1  ON 44
ci_046                 3.594587e-03 3 1  ON 45
ci_047                -1.035142e-03 3 1  ON 46
ci_048                -6.685490e-04 3 1  ON 47
ci_049                 1.719246e-03 3 1  ON 48
ci_050                 1.600571e-03 3 1  ON 49
ci_051                -1.916053e-03 3 1  ON 50
ci_052                -1.709408e-03 3 1  ON 51
ci_053                -2.580983e-03 3 1  ON 52
ci_054                -2.311981e-03 3 1  ON 53
ci_055                -1.946513e-03 3 1  ON 54
ci_056                -1.270365e-03 3 1  ON 55
ci_057                -1.551526e-03 3 1  ON 56
ci_058                -1.972655e-03 3 1  ON 57
ci_059                 2.077208e-04 3 1  ON 58
ci_060                 2.564157e-04 3 1  ON 59
ci_061                -4.674540e-04 3 1  ON 60
ci_062                -6.063510e-04 3 1  ON 61
ci_063                -8.642724e-04 3 1  ON 62
ci_064                 4.526008e-04 3 1  ON 63
ci_065                -2.169430e-03 3 1  ON 64
ci_066                -2.892077e-03 3 1  ON 65
ci_067                -2.635131e-03 3 1  ON 66
ci_068                -1.866586e-03 3 1  ON 67
ci_069                -2.998524e-05 3 1  ON 68
ci_070                 1.191040e-04 3 1  ON 69
ci_071                -2.124214e-03 3 1  ON 70
ci_072                -2.041895e-03 3 1  ON 71
ci_073                 6.261142e-04 3 1  ON 72
ci_074                 6.279822e-04 3 1  ON 73
ci_075                -3.513540e-04 3 1  ON 74
ci_076                -8.712332e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7192
    reference variance = 0.661936
====================================================
  Execution time = 2.6436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0934e-01
  Total weights = 1.955005514e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3452e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495182453363
                                         uncertainty =       0.002856865707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495182453363
                                         uncertainty =       0.002856865707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497622433
  error estimate for blocks of size 2^( 2) =       0.000514995811
  error estimate for blocks of size 2^( 3) =       0.000531291454
  error estimate for blocks of size 2^( 4) =       0.000542865329
  error estimate for blocks of size 2^( 5) =       0.000550485975
  error estimate for blocks of size 2^( 6) =       0.000552521280
  error estimate for blocks of size 2^( 7) =       0.000553150904

      target function =                  N/A
              le_mean =     -22.669207023577
             les_mean =     514.402290583200
             stat err =       0.000549755872
             autocorr =       1.220505814175
              std dev =       0.703744394208
             le_variance =       0.495256172379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266920702358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669207023708       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669278295007       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669290443352       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669294469225       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669294409625       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669294496717       residual = 6.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 4.265325e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669207023708       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669244190192       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669246602656       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669247085842       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.565821e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669207023708       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669219777683       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669220030963       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669220078275       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.676372e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4844e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -7.060218e-01 3 1  ON 0
ci_002                -7.039595e-01 3 1  ON 1
ci_003                -4.578129e-02 3 1  ON 2
ci_004                -4.506153e-02 3 1  ON 3
ci_005                 1.655601e-02 3 1  ON 4
ci_006                 1.641260e-02 3 1  ON 5
ci_007                 1.360696e-02 3 1  ON 6
ci_008                 1.306460e-02 3 1  ON 7
ci_009                -1.236648e-02 3 1  ON 8
ci_010                -1.227642e-02 3 1  ON 9
ci_011                -8.868695e-03 3 1  ON 10
ci_012                -9.213214e-03 3 1  ON 11
ci_013                 1.058120e-02 3 1  ON 12
ci_014                 1.006270e-02 3 1  ON 13
ci_015                 1.253494e-02 3 1  ON 14
ci_016                 1.387543e-02 3 1  ON 15
ci_017                 1.067306e-02 3 1  ON 16
ci_018                 1.097193e-02 3 1  ON 17
ci_019                -6.431317e-04 3 1  ON 18
ci_020                 6.524965e-05 3 1  ON 19
ci_021                -7.757207e-03 3 1  ON 20
ci_022                -8.129475e-03 3 1  ON 21
ci_023                 8.258647e-03 3 1  ON 22
ci_024                 7.652924e-03 3 1  ON 23
ci_025                 4.210476e-03 3 1  ON 24
ci_026                 3.101052e-03 3 1  ON 25
ci_027                 6.766107e-03 3 1  ON 26
ci_028                 6.662643e-03 3 1  ON 27
ci_029                -5.114329e-03 3 1  ON 28
ci_030                -5.302960e-03 3 1  ON 29
ci_031                -7.937054e-03 3 1  ON 30
ci_032                -7.811149e-03 3 1  ON 31
ci_033                 4.177143e-03 3 1  ON 32
ci_034                 4.389166e-03 3 1  ON 33
ci_035                 1.001004e-03 3 1  ON 34
ci_036                 1.704035e-03 3 1  ON 35
ci_037                 5.018123e-03 3 1  ON 36
ci_038                 5.398615e-03 3 1  ON 37
ci_039                 5.538618e-03 3 1  ON 38
ci_040                 4.632288e-03 3 1  ON 39
ci_041                 4.667224e-03 3 1  ON 40
ci_042                 4.683522e-03 3 1  ON 41
ci_043                 5.489632e-03 3 1  ON 42
ci_044                 5.111822e-03 3 1  ON 43
ci_045                 3.401542e-03 3 1  ON 44
ci_046                 3.533146e-03 3 1  ON 45
ci_047                -6.963194e-04 3 1  ON 46
ci_048                -5.916720e-04 3 1  ON 47
ci_049                 1.232859e-03 3 1  ON 48
ci_050                 1.661177e-03 3 1  ON 49
ci_051                -1.557992e-03 3 1  ON 50
ci_052                -1.709140e-03 3 1  ON 51
ci_053                -2.566585e-03 3 1  ON 52
ci_054                -2.274369e-03 3 1  ON 53
ci_055                -1.522676e-03 3 1  ON 54
ci_056                -1.510405e-03 3 1  ON 55
ci_057                -1.642341e-03 3 1  ON 56
ci_058                -1.436493e-03 3 1  ON 57
ci_059                 5.144597e-04 3 1  ON 58
ci_060                 5.921198e-04 3 1  ON 59
ci_061                -2.351061e-04 3 1  ON 60
ci_062                -7.260322e-04 3 1  ON 61
ci_063                -1.234433e-03 3 1  ON 62
ci_064                -9.188674e-04 3 1  ON 63
ci_065                -2.240626e-03 3 1  ON 64
ci_066                -2.963157e-03 3 1  ON 65
ci_067                -2.559299e-03 3 1  ON 66
ci_068                -2.683055e-03 3 1  ON 67
ci_069                -7.963575e-04 3 1  ON 68
ci_070                -2.918385e-04 3 1  ON 69
ci_071                -2.217779e-03 3 1  ON 70
ci_072                -1.608502e-03 3 1  ON 71
ci_073                 5.317647e-04 3 1  ON 72
ci_074                 2.542986e-04 3 1  ON 73
ci_075                -2.817869e-04 3 1  ON 74
ci_076                 2.509479e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6767
    reference variance = 0.415917
====================================================
  Execution time = 2.5616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1744e-01
  Total weights = 1.9551e+06
  Execution time = 3.6486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.102041
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499548590042
                                         uncertainty =       0.003487485645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499548590042
                                         uncertainty =       0.003487485645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499759328
  error estimate for blocks of size 2^( 2) =       0.000517924499
  error estimate for blocks of size 2^( 3) =       0.000534320763
  error estimate for blocks of size 2^( 4) =       0.000545400036
  error estimate for blocks of size 2^( 5) =       0.000553374048
  error estimate for blocks of size 2^( 6) =       0.000556905893
  error estimate for blocks of size 2^( 7) =       0.000558498334

      target function =                  N/A
              le_mean =     -22.668850237660
             les_mean =     514.406860401123
             stat err =       0.000553544578
             autocorr =       1.226827164708
              std dev =       0.706766419766
             le_variance =       0.499518772108

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.045504
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500014922492
                                         uncertainty =       0.003630158400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500014922492
                                         uncertainty =       0.003630158400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499992845
  error estimate for blocks of size 2^( 2) =       0.000518137582
  error estimate for blocks of size 2^( 3) =       0.000534506582
  error estimate for blocks of size 2^( 4) =       0.000545592822
  error estimate for blocks of size 2^( 5) =       0.000553475427
  error estimate for blocks of size 2^( 6) =       0.000556978632
  error estimate for blocks of size 2^( 7) =       0.000558537051

      target function =                  N/A
              le_mean =     -22.668853477533
             les_mean =     514.409212165979
             stat err =       0.000553645983
             autocorr =       1.226130588845
              std dev =       0.707096662539
             le_variance =       0.499985690173

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.104938
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500128069649
                                         uncertainty =       0.003697617051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500128069649
                                         uncertainty =       0.003697617051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500049631
  error estimate for blocks of size 2^( 2) =       0.000518213349
  error estimate for blocks of size 2^( 3) =       0.000534571433
  error estimate for blocks of size 2^( 4) =       0.000545641862
  error estimate for blocks of size 2^( 5) =       0.000553530618
  error estimate for blocks of size 2^( 6) =       0.000557012371
  error estimate for blocks of size 2^( 7) =       0.000558588381

      target function =                  N/A
              le_mean =     -22.668865366832
             les_mean =     514.438025477077
             stat err =       0.000553693308
             autocorr =       1.226061702905
              std dev =       0.707176969758
             le_variance =       0.500099266556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499753963329
                                         uncertainty =       0.003526165431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499753963329
                                         uncertainty =       0.003526165431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499862125
  error estimate for blocks of size 2^( 2) =       0.000518016210
  error estimate for blocks of size 2^( 3) =       0.000534400718
  error estimate for blocks of size 2^( 4) =       0.000545473319
  error estimate for blocks of size 2^( 5) =       0.000553425019
  error estimate for blocks of size 2^( 6) =       0.000556955426
  error estimate for blocks of size 2^( 7) =       0.000558611756

      target function =                  N/A
              le_mean =     -22.668819961200
             les_mean =     514.695349131512
             stat err =       0.000553616380
             autocorr =       1.226640786044
              std dev =       0.706911795892
             le_variance =       0.499724287172


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668850237660        initial
     6.2500e-02     6.2500e-01             4.2653e-03       -22.668853477533
     2.5000e-01     2.5000e+00             1.5658e-03       -22.668865366832  <--
     1.0000e+00     1.0000e+01             4.6764e-04       -22.668819961200

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.3906e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -7.060218e-01 3 1  ON 0
ci_002                -7.039595e-01 3 1  ON 1
ci_003                -4.578129e-02 3 1  ON 2
ci_004                -4.506153e-02 3 1  ON 3
ci_005                 1.655601e-02 3 1  ON 4
ci_006                 1.641260e-02 3 1  ON 5
ci_007                 1.360696e-02 3 1  ON 6
ci_008                 1.306460e-02 3 1  ON 7
ci_009                -1.236648e-02 3 1  ON 8
ci_010                -1.227642e-02 3 1  ON 9
ci_011                -8.868695e-03 3 1  ON 10
ci_012                -9.213214e-03 3 1  ON 11
ci_013                 1.058120e-02 3 1  ON 12
ci_014                 1.006270e-02 3 1  ON 13
ci_015                 1.253494e-02 3 1  ON 14
ci_016                 1.387543e-02 3 1  ON 15
ci_017                 1.067306e-02 3 1  ON 16
ci_018                 1.097193e-02 3 1  ON 17
ci_019                -6.431317e-04 3 1  ON 18
ci_020                 6.524965e-05 3 1  ON 19
ci_021                -7.757207e-03 3 1  ON 20
ci_022                -8.129475e-03 3 1  ON 21
ci_023                 8.258647e-03 3 1  ON 22
ci_024                 7.652924e-03 3 1  ON 23
ci_025                 4.210476e-03 3 1  ON 24
ci_026                 3.101052e-03 3 1  ON 25
ci_027                 6.766107e-03 3 1  ON 26
ci_028                 6.662643e-03 3 1  ON 27
ci_029                -5.114329e-03 3 1  ON 28
ci_030                -5.302960e-03 3 1  ON 29
ci_031                -7.937054e-03 3 1  ON 30
ci_032                -7.811149e-03 3 1  ON 31
ci_033                 4.177143e-03 3 1  ON 32
ci_034                 4.389166e-03 3 1  ON 33
ci_035                 1.001004e-03 3 1  ON 34
ci_036                 1.704035e-03 3 1  ON 35
ci_037                 5.018123e-03 3 1  ON 36
ci_038                 5.398615e-03 3 1  ON 37
ci_039                 5.538618e-03 3 1  ON 38
ci_040                 4.632288e-03 3 1  ON 39
ci_041                 4.667224e-03 3 1  ON 40
ci_042                 4.683522e-03 3 1  ON 41
ci_043                 5.489632e-03 3 1  ON 42
ci_044                 5.111822e-03 3 1  ON 43
ci_045                 3.401542e-03 3 1  ON 44
ci_046                 3.533146e-03 3 1  ON 45
ci_047                -6.963194e-04 3 1  ON 46
ci_048                -5.916720e-04 3 1  ON 47
ci_049                 1.232859e-03 3 1  ON 48
ci_050                 1.661177e-03 3 1  ON 49
ci_051                -1.557992e-03 3 1  ON 50
ci_052                -1.709140e-03 3 1  ON 51
ci_053                -2.566585e-03 3 1  ON 52
ci_054                -2.274369e-03 3 1  ON 53
ci_055                -1.522676e-03 3 1  ON 54
ci_056                -1.510405e-03 3 1  ON 55
ci_057                -1.642341e-03 3 1  ON 56
ci_058                -1.436493e-03 3 1  ON 57
ci_059                 5.144597e-04 3 1  ON 58
ci_060                 5.921198e-04 3 1  ON 59
ci_061                -2.351061e-04 3 1  ON 60
ci_062                -7.260322e-04 3 1  ON 61
ci_063                -1.234433e-03 3 1  ON 62
ci_064                -9.188674e-04 3 1  ON 63
ci_065                -2.240626e-03 3 1  ON 64
ci_066                -2.963157e-03 3 1  ON 65
ci_067                -2.559299e-03 3 1  ON 66
ci_068                -2.683055e-03 3 1  ON 67
ci_069                -7.963575e-04 3 1  ON 68
ci_070                -2.918385e-04 3 1  ON 69
ci_071                -2.217779e-03 3 1  ON 70
ci_072                -1.608502e-03 3 1  ON 71
ci_073                 5.317647e-04 3 1  ON 72
ci_074                 2.542986e-04 3 1  ON 73
ci_075                -2.817869e-04 3 1  ON 74
ci_076                 2.509479e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8757e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2689e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.6934
    reference variance = 0.483013
====================================================
  Execution time = 2.6387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1060e-01
  Total weights = 1.955000324e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499660924874
                                         uncertainty =       0.002895593902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499660924874
                                         uncertainty =       0.002895593902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499835392
  error estimate for blocks of size 2^( 2) =       0.000518185513
  error estimate for blocks of size 2^( 3) =       0.000534062145
  error estimate for blocks of size 2^( 4) =       0.000545203691
  error estimate for blocks of size 2^( 5) =       0.000552516124
  error estimate for blocks of size 2^( 6) =       0.000554435016
  error estimate for blocks of size 2^( 7) =       0.000558740184

      target function =                  N/A
              le_mean =     -22.669576686511
             les_mean =     514.420309788332
             stat err =       0.000552723754
             autocorr =       1.222819202654
              std dev =       0.706873990445
             le_variance =       0.499670838367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266957668651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669576686587       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669591799649       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669594343590       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669598933627       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669598912539       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669598982038       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 2.992691e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669576686587       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669584893500       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669585279619       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669586053974       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.087209e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669576686587       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669579588744       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669579532913       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669579623349       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.274217e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1211e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -7.063331e-01 3 1  ON 0
ci_002                -7.038135e-01 3 1  ON 1
ci_003                -4.469408e-02 3 1  ON 2
ci_004                -4.463996e-02 3 1  ON 3
ci_005                 1.649737e-02 3 1  ON 4
ci_006                 1.605735e-02 3 1  ON 5
ci_007                 1.354928e-02 3 1  ON 6
ci_008                 1.260286e-02 3 1  ON 7
ci_009                -1.183177e-02 3 1  ON 8
ci_010                -1.197696e-02 3 1  ON 9
ci_011                -8.524574e-03 3 1  ON 10
ci_012                -8.945352e-03 3 1  ON 11
ci_013                 1.056954e-02 3 1  ON 12
ci_014                 9.812328e-03 3 1  ON 13
ci_015                 1.245202e-02 3 1  ON 14
ci_016                 1.343420e-02 3 1  ON 15
ci_017                 1.025928e-02 3 1  ON 16
ci_018                 1.087225e-02 3 1  ON 17
ci_019                -1.007102e-03 3 1  ON 18
ci_020                -6.666907e-04 3 1  ON 19
ci_021                -7.768892e-03 3 1  ON 20
ci_022                -8.128480e-03 3 1  ON 21
ci_023                 7.934342e-03 3 1  ON 22
ci_024                 7.548746e-03 3 1  ON 23
ci_025                 3.728984e-03 3 1  ON 24
ci_026                 3.710549e-03 3 1  ON 25
ci_027                 6.750109e-03 3 1  ON 26
ci_028                 6.870211e-03 3 1  ON 27
ci_029                -5.091445e-03 3 1  ON 28
ci_030                -5.148719e-03 3 1  ON 29
ci_031                -8.059039e-03 3 1  ON 30
ci_032                -7.036149e-03 3 1  ON 31
ci_033                 4.306298e-03 3 1  ON 32
ci_034                 4.011760e-03 3 1  ON 33
ci_035                 8.168984e-04 3 1  ON 34
ci_036                 1.410686e-03 3 1  ON 35
ci_037                 5.823152e-03 3 1  ON 36
ci_038                 5.180728e-03 3 1  ON 37
ci_039                 5.436810e-03 3 1  ON 38
ci_040                 5.212102e-03 3 1  ON 39
ci_041                 4.644376e-03 3 1  ON 40
ci_042                 4.722453e-03 3 1  ON 41
ci_043                 5.442264e-03 3 1  ON 42
ci_044                 5.554680e-03 3 1  ON 43
ci_045                 3.476604e-03 3 1  ON 44
ci_046                 2.979325e-03 3 1  ON 45
ci_047                -6.129928e-04 3 1  ON 46
ci_048                -7.725636e-04 3 1  ON 47
ci_049                 9.261068e-04 3 1  ON 48
ci_050                 1.546259e-03 3 1  ON 49
ci_051                -2.270419e-03 3 1  ON 50
ci_052                -1.587062e-03 3 1  ON 51
ci_053                -2.337877e-03 3 1  ON 52
ci_054                -2.805596e-03 3 1  ON 53
ci_055                -1.034516e-03 3 1  ON 54
ci_056                -1.400175e-03 3 1  ON 55
ci_057                -1.518324e-03 3 1  ON 56
ci_058                -1.156742e-03 3 1  ON 57
ci_059                 5.355012e-05 3 1  ON 58
ci_060                 4.248013e-04 3 1  ON 59
ci_061                 4.480302e-04 3 1  ON 60
ci_062                -5.563155e-05 3 1  ON 61
ci_063                -1.182647e-03 3 1  ON 62
ci_064                -1.360043e-03 3 1  ON 63
ci_065                -2.613766e-03 3 1  ON 64
ci_066                -2.540747e-03 3 1  ON 65
ci_067                -2.511025e-03 3 1  ON 66
ci_068                -2.746472e-03 3 1  ON 67
ci_069                -7.360828e-04 3 1  ON 68
ci_070                -1.364608e-04 3 1  ON 69
ci_071                -3.102742e-03 3 1  ON 70
ci_072                -2.106602e-03 3 1  ON 71
ci_073                 5.084592e-04 3 1  ON 72
ci_074                -6.333085e-05 3 1  ON 73
ci_075                -2.151686e-04 3 1  ON 74
ci_076                -1.308120e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.6691
    reference variance = 0.333421
====================================================
  Execution time = 2.5883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1015e-01
  Total weights = 1.9555e+06
  Execution time = 3.6363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495217723930
                                         uncertainty =       0.002682730793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495217723930
                                         uncertainty =       0.002682730793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497585784
  error estimate for blocks of size 2^( 2) =       0.000515827892
  error estimate for blocks of size 2^( 3) =       0.000531854331
  error estimate for blocks of size 2^( 4) =       0.000543377206
  error estimate for blocks of size 2^( 5) =       0.000550951095
  error estimate for blocks of size 2^( 6) =       0.000554269058
  error estimate for blocks of size 2^( 7) =       0.000556875694

      target function =                  N/A
              le_mean =     -22.670480725304
             les_mean =     514.478127530584
             stat err =       0.000551368263
             autocorr =       1.227856463675
              std dev =       0.703692564357
             le_variance =       0.495183225132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494381823480
                                         uncertainty =       0.002623131081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494381823480
                                         uncertainty =       0.002623131081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497163683
  error estimate for blocks of size 2^( 2) =       0.000515423776
  error estimate for blocks of size 2^( 3) =       0.000531467312
  error estimate for blocks of size 2^( 4) =       0.000542978851
  error estimate for blocks of size 2^( 5) =       0.000550597581
  error estimate for blocks of size 2^( 6) =       0.000553890953
  error estimate for blocks of size 2^( 7) =       0.000556487123

      target function =                  N/A
              le_mean =     -22.670481625456
             les_mean =     514.466526386587
             stat err =       0.000550988627
             autocorr =       1.228249161950
              std dev =       0.703095622565
             le_variance =       0.494343454471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494467162940
                                         uncertainty =       0.002627160893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494467162940
                                         uncertainty =       0.002627160893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497206283
  error estimate for blocks of size 2^( 2) =       0.000515466065
  error estimate for blocks of size 2^( 3) =       0.000531517343
  error estimate for blocks of size 2^( 4) =       0.000543058043
  error estimate for blocks of size 2^( 5) =       0.000550676050
  error estimate for blocks of size 2^( 6) =       0.000553943368
  error estimate for blocks of size 2^( 7) =       0.000556523693

      target function =                  N/A
              le_mean =     -22.670487485899
             les_mean =     514.516328309069
             stat err =       0.000551050288
             autocorr =       1.228313574498
              std dev =       0.703155869253
             le_variance =       0.494428176465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495064400377
                                         uncertainty =       0.002669400708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495064400377
                                         uncertainty =       0.002669400708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497508328
  error estimate for blocks of size 2^( 2) =       0.000515759247
  error estimate for blocks of size 2^( 3) =       0.000531788667
  error estimate for blocks of size 2^( 4) =       0.000543305366
  error estimate for blocks of size 2^( 5) =       0.000550862267
  error estimate for blocks of size 2^( 6) =       0.000554190011
  error estimate for blocks of size 2^( 7) =       0.000556786627

      target function =                  N/A
              le_mean =     -22.670477909727
             les_mean =     514.503146785012
             stat err =       0.000551286068
             autocorr =       1.227872644645
              std dev =       0.703583024852
             le_variance =       0.495029072859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670480725304        initial
     6.2500e-02     6.2500e-01             2.9927e-03       -22.670481625456
     2.5000e-01     2.5000e+00             1.0872e-03       -22.670487485899  <--
     1.0000e+00     1.0000e+01             3.2742e-04       -22.670477909727

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.4122e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -7.063331e-01 3 1  ON 0
ci_002                -7.038135e-01 3 1  ON 1
ci_003                -4.469408e-02 3 1  ON 2
ci_004                -4.463996e-02 3 1  ON 3
ci_005                 1.649737e-02 3 1  ON 4
ci_006                 1.605735e-02 3 1  ON 5
ci_007                 1.354928e-02 3 1  ON 6
ci_008                 1.260286e-02 3 1  ON 7
ci_009                -1.183177e-02 3 1  ON 8
ci_010                -1.197696e-02 3 1  ON 9
ci_011                -8.524574e-03 3 1  ON 10
ci_012                -8.945352e-03 3 1  ON 11
ci_013                 1.056954e-02 3 1  ON 12
ci_014                 9.812328e-03 3 1  ON 13
ci_015                 1.245202e-02 3 1  ON 14
ci_016                 1.343420e-02 3 1  ON 15
ci_017                 1.025928e-02 3 1  ON 16
ci_018                 1.087225e-02 3 1  ON 17
ci_019                -1.007102e-03 3 1  ON 18
ci_020                -6.666907e-04 3 1  ON 19
ci_021                -7.768892e-03 3 1  ON 20
ci_022                -8.128480e-03 3 1  ON 21
ci_023                 7.934342e-03 3 1  ON 22
ci_024                 7.548746e-03 3 1  ON 23
ci_025                 3.728984e-03 3 1  ON 24
ci_026                 3.710549e-03 3 1  ON 25
ci_027                 6.750109e-03 3 1  ON 26
ci_028                 6.870211e-03 3 1  ON 27
ci_029                -5.091445e-03 3 1  ON 28
ci_030                -5.148719e-03 3 1  ON 29
ci_031                -8.059039e-03 3 1  ON 30
ci_032                -7.036149e-03 3 1  ON 31
ci_033                 4.306298e-03 3 1  ON 32
ci_034                 4.011760e-03 3 1  ON 33
ci_035                 8.168984e-04 3 1  ON 34
ci_036                 1.410686e-03 3 1  ON 35
ci_037                 5.823152e-03 3 1  ON 36
ci_038                 5.180728e-03 3 1  ON 37
ci_039                 5.436810e-03 3 1  ON 38
ci_040                 5.212102e-03 3 1  ON 39
ci_041                 4.644376e-03 3 1  ON 40
ci_042                 4.722453e-03 3 1  ON 41
ci_043                 5.442264e-03 3 1  ON 42
ci_044                 5.554680e-03 3 1  ON 43
ci_045                 3.476604e-03 3 1  ON 44
ci_046                 2.979325e-03 3 1  ON 45
ci_047                -6.129928e-04 3 1  ON 46
ci_048                -7.725636e-04 3 1  ON 47
ci_049                 9.261068e-04 3 1  ON 48
ci_050                 1.546259e-03 3 1  ON 49
ci_051                -2.270419e-03 3 1  ON 50
ci_052                -1.587062e-03 3 1  ON 51
ci_053                -2.337877e-03 3 1  ON 52
ci_054                -2.805596e-03 3 1  ON 53
ci_055                -1.034516e-03 3 1  ON 54
ci_056                -1.400175e-03 3 1  ON 55
ci_057                -1.518324e-03 3 1  ON 56
ci_058                -1.156742e-03 3 1  ON 57
ci_059                 5.355012e-05 3 1  ON 58
ci_060                 4.248013e-04 3 1  ON 59
ci_061                 4.480302e-04 3 1  ON 60
ci_062                -5.563155e-05 3 1  ON 61
ci_063                -1.182647e-03 3 1  ON 62
ci_064                -1.360043e-03 3 1  ON 63
ci_065                -2.613766e-03 3 1  ON 64
ci_066                -2.540747e-03 3 1  ON 65
ci_067                -2.511025e-03 3 1  ON 66
ci_068                -2.746472e-03 3 1  ON 67
ci_069                -7.360828e-04 3 1  ON 68
ci_070                -1.364608e-04 3 1  ON 69
ci_071                -3.102742e-03 3 1  ON 70
ci_072                -2.106602e-03 3 1  ON 71
ci_073                 5.084592e-04 3 1  ON 72
ci_074                -6.333085e-05 3 1  ON 73
ci_075                -2.151686e-04 3 1  ON 74
ci_076                -1.308120e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5340e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6484
    reference variance = 0.503613
====================================================
  Execution time = 2.6220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1001e-01
  Total weights = 1.955149674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495665255073
                                         uncertainty =       0.002515235986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495665255073
                                         uncertainty =       0.002515235986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497830859
  error estimate for blocks of size 2^( 2) =       0.000515854775
  error estimate for blocks of size 2^( 3) =       0.000532227172
  error estimate for blocks of size 2^( 4) =       0.000544001186
  error estimate for blocks of size 2^( 5) =       0.000551785066
  error estimate for blocks of size 2^( 6) =       0.000557116553
  error estimate for blocks of size 2^( 7) =       0.000556560398

      target function =                  N/A
              le_mean =     -22.669532185416
             les_mean =     514.417695933650
             stat err =       0.000552365801
             autocorr =       1.231090374078
              std dev =       0.704039153185
             le_variance =       0.495671129218


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266953218542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669532185504       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669559760322       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669564844708       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669567310933       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669567292939       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669567533796       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669567394610       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 3.896969e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669532185504       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669547410140       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669548566894       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669549027417       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.456711e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669532185504       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669537639383       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669537801485       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669537884119       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.194886e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1025e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -7.061773e-01 3 1  ON 0
ci_002                -7.041045e-01 3 1  ON 1
ci_003                -4.323737e-02 3 1  ON 2
ci_004                -4.421070e-02 3 1  ON 3
ci_005                 1.653945e-02 3 1  ON 4
ci_006                 1.666617e-02 3 1  ON 5
ci_007                 1.316675e-02 3 1  ON 6
ci_008                 1.301767e-02 3 1  ON 7
ci_009                -1.096103e-02 3 1  ON 8
ci_010                -1.255032e-02 3 1  ON 9
ci_011                -8.541331e-03 3 1  ON 10
ci_012                -9.128278e-03 3 1  ON 11
ci_013                 1.026357e-02 3 1  ON 12
ci_014                 9.370142e-03 3 1  ON 13
ci_015                 1.232933e-02 3 1  ON 14
ci_016                 1.295614e-02 3 1  ON 15
ci_017                 1.056277e-02 3 1  ON 16
ci_018                 1.107321e-02 3 1  ON 17
ci_019                -1.315235e-03 3 1  ON 18
ci_020                -1.040946e-03 3 1  ON 19
ci_021                -7.820780e-03 3 1  ON 20
ci_022                -8.922030e-03 3 1  ON 21
ci_023                 7.487891e-03 3 1  ON 22
ci_024                 7.872544e-03 3 1  ON 23
ci_025                 3.599499e-03 3 1  ON 24
ci_026                 3.382744e-03 3 1  ON 25
ci_027                 5.845700e-03 3 1  ON 26
ci_028                 6.578450e-03 3 1  ON 27
ci_029                -5.162118e-03 3 1  ON 28
ci_030                -5.740370e-03 3 1  ON 29
ci_031                -7.985123e-03 3 1  ON 30
ci_032                -6.543604e-03 3 1  ON 31
ci_033                 5.045500e-03 3 1  ON 32
ci_034                 4.235675e-03 3 1  ON 33
ci_035                 7.194048e-04 3 1  ON 34
ci_036                 1.123641e-03 3 1  ON 35
ci_037                 5.678629e-03 3 1  ON 36
ci_038                 5.027401e-03 3 1  ON 37
ci_039                 5.017561e-03 3 1  ON 38
ci_040                 5.540956e-03 3 1  ON 39
ci_041                 5.237008e-03 3 1  ON 40
ci_042                 4.994500e-03 3 1  ON 41
ci_043                 4.949263e-03 3 1  ON 42
ci_044                 5.193129e-03 3 1  ON 43
ci_045                 2.898789e-03 3 1  ON 44
ci_046                 3.233388e-03 3 1  ON 45
ci_047                -1.620041e-04 3 1  ON 46
ci_048                -5.133923e-04 3 1  ON 47
ci_049                 9.017706e-04 3 1  ON 48
ci_050                 1.949243e-03 3 1  ON 49
ci_051                -1.484434e-03 3 1  ON 50
ci_052                -1.366431e-03 3 1  ON 51
ci_053                -2.454057e-03 3 1  ON 52
ci_054                -2.593299e-03 3 1  ON 53
ci_055                -1.624890e-03 3 1  ON 54
ci_056                -1.533294e-03 3 1  ON 55
ci_057                -1.048793e-03 3 1  ON 56
ci_058                -1.276112e-03 3 1  ON 57
ci_059                -1.617001e-04 3 1  ON 58
ci_060                -2.056385e-04 3 1  ON 59
ci_061                 2.241243e-04 3 1  ON 60
ci_062                 6.577424e-04 3 1  ON 61
ci_063                -1.579567e-04 3 1  ON 62
ci_064                -1.247063e-03 3 1  ON 63
ci_065                -2.881716e-03 3 1  ON 64
ci_066                -3.134830e-03 3 1  ON 65
ci_067                -2.520803e-03 3 1  ON 66
ci_068                -2.172072e-03 3 1  ON 67
ci_069                -3.311877e-04 3 1  ON 68
ci_070                -6.361711e-04 3 1  ON 69
ci_071                -3.095363e-03 3 1  ON 70
ci_072                -1.775189e-03 3 1  ON 71
ci_073                -1.911721e-04 3 1  ON 72
ci_074                 6.734487e-04 3 1  ON 73
ci_075                -4.220143e-04 3 1  ON 74
ci_076                -5.957389e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7037
    reference variance = 0.380442
====================================================
  Execution time = 2.5496e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0553e-01
  Total weights = 1.9550e+06
  Execution time = 3.6356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496854315928
                                         uncertainty =       0.004193555951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496854315928
                                         uncertainty =       0.004193555951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498390057
  error estimate for blocks of size 2^( 2) =       0.000516967699
  error estimate for blocks of size 2^( 3) =       0.000534003643
  error estimate for blocks of size 2^( 4) =       0.000544966509
  error estimate for blocks of size 2^( 5) =       0.000553127908
  error estimate for blocks of size 2^( 6) =       0.000555193730
  error estimate for blocks of size 2^( 7) =       0.000555013989

      target function =                  N/A
              le_mean =     -22.669153479663
             les_mean =     514.497603149390
             stat err =       0.000552075534
             autocorr =       1.227038706967
              std dev =       0.704829978230
             le_variance =       0.496785298212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493171941442
                                         uncertainty =       0.002356832489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493171941442
                                         uncertainty =       0.002356832489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496540981
  error estimate for blocks of size 2^( 2) =       0.000515189230
  error estimate for blocks of size 2^( 3) =       0.000532216330
  error estimate for blocks of size 2^( 4) =       0.000543243726
  error estimate for blocks of size 2^( 5) =       0.000551209950
  error estimate for blocks of size 2^( 6) =       0.000553085813
  error estimate for blocks of size 2^( 7) =       0.000553207859

      target function =                  N/A
              le_mean =     -22.669096061203
             les_mean =     514.399043630547
             stat err =       0.000550186837
             autocorr =       1.227750714678
              std dev =       0.702214989665
             le_variance =       0.493105891710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493088721423
                                         uncertainty =       0.002363226142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493088721423
                                         uncertainty =       0.002363226142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496499266
  error estimate for blocks of size 2^( 2) =       0.000515151072
  error estimate for blocks of size 2^( 3) =       0.000532182924
  error estimate for blocks of size 2^( 4) =       0.000543193725
  error estimate for blocks of size 2^( 5) =       0.000551156606
  error estimate for blocks of size 2^( 6) =       0.000553070798
  error estimate for blocks of size 2^( 7) =       0.000553207489

      target function =                  N/A
              le_mean =     -22.669090678249
             les_mean =     514.395297658732
             stat err =       0.000550157155
             autocorr =       1.227824537042
              std dev =       0.702155996223
             le_variance =       0.493023043032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559838075158
                                         uncertainty =       0.066072033441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559838075158
                                         uncertainty =       0.066072033441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528846220
  error estimate for blocks of size 2^( 2) =       0.000546460090
  error estimate for blocks of size 2^( 3) =       0.000562506273
  error estimate for blocks of size 2^( 4) =       0.000573346098
  error estimate for blocks of size 2^( 5) =       0.000580850518
  error estimate for blocks of size 2^( 6) =       0.000582553200
  error estimate for blocks of size 2^( 7) =       0.000583328678

      target function =                  N/A
              le_mean =     -22.669284704634
             les_mean =     536.398587169151
             stat err =       0.000580019623
             autocorr =       1.202891802020
              std dev =       0.747901496373
             le_variance =       0.559356648276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669153479663        initial
     6.2500e-02     6.2500e-01             3.8970e-03       -22.669096061203
     2.5000e-01     2.5000e+00             1.4567e-03       -22.669090678249
     1.0000e+00     1.0000e+01             4.1949e-04       -22.669284704634  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3741e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -7.063102e-01 3 1  ON 0
ci_002                -7.038754e-01 3 1  ON 1
ci_003                -4.427459e-02 3 1  ON 2
ci_004                -4.452194e-02 3 1  ON 3
ci_005                 1.651153e-02 3 1  ON 4
ci_006                 1.630258e-02 3 1  ON 5
ci_007                 1.342374e-02 3 1  ON 6
ci_008                 1.276026e-02 3 1  ON 7
ci_009                -1.152436e-02 3 1  ON 8
ci_010                -1.217079e-02 3 1  ON 9
ci_011                -8.533125e-03 3 1  ON 10
ci_012                -9.009201e-03 3 1  ON 11
ci_013                 1.045487e-02 3 1  ON 12
ci_014                 9.663437e-03 3 1  ON 13
ci_015                 1.241675e-02 3 1  ON 14
ci_016                 1.328525e-02 3 1  ON 15
ci_017                 1.034595e-02 3 1  ON 16
ci_018                 1.093764e-02 3 1  ON 17
ci_019                -1.109741e-03 3 1  ON 18
ci_020                -8.008933e-04 3 1  ON 19
ci_021                -7.786582e-03 3 1  ON 20
ci_022                -8.389105e-03 3 1  ON 21
ci_023                 7.766628e-03 3 1  ON 22
ci_024                 7.668697e-03 3 1  ON 23
ci_025                 3.688438e-03 3 1  ON 24
ci_026                 3.598312e-03 3 1  ON 25
ci_027                 6.378366e-03 3 1  ON 26
ci_028                 6.755870e-03 3 1  ON 27
ci_029                -5.126288e-03 3 1  ON 28
ci_030                -5.354700e-03 3 1  ON 29
ci_031                -8.037532e-03 3 1  ON 30
ci_032                -6.879968e-03 3 1  ON 31
ci_033                 4.557132e-03 3 1  ON 32
ci_034                 4.091875e-03 3 1  ON 33
ci_035                 7.803098e-04 3 1  ON 34
ci_036                 1.290601e-03 3 1  ON 35
ci_037                 5.777732e-03 3 1  ON 36
ci_038                 5.131529e-03 3 1  ON 37
ci_039                 5.265068e-03 3 1  ON 38
ci_040                 5.343457e-03 3 1  ON 39
ci_041                 4.863364e-03 3 1  ON 40
ci_042                 4.822078e-03 3 1  ON 41
ci_043                 5.271457e-03 3 1  ON 42
ci_044                 5.417050e-03 3 1  ON 43
ci_045                 3.289034e-03 3 1  ON 44
ci_046                 3.073595e-03 3 1  ON 45
ci_047                -4.289921e-04 3 1  ON 46
ci_048                -6.554636e-04 3 1  ON 47
ci_049                 9.204096e-04 3 1  ON 48
ci_050                 1.686474e-03 3 1  ON 49
ci_051                -2.001664e-03 3 1  ON 50
ci_052                -1.502315e-03 3 1  ON 51
ci_053                -2.378650e-03 3 1  ON 52
ci_054                -2.726982e-03 3 1  ON 53
ci_055                -1.227025e-03 3 1  ON 54
ci_056                -1.439298e-03 3 1  ON 55
ci_057                -1.348030e-03 3 1  ON 56
ci_058                -1.202031e-03 3 1  ON 57
ci_059                -3.971571e-05 3 1  ON 58
ci_060                 1.779349e-04 3 1  ON 59
ci_061                 3.646113e-04 3 1  ON 60
ci_062                 1.858694e-04 3 1  ON 61
ci_063                -8.278803e-04 3 1  ON 62
ci_064                -1.316341e-03 3 1  ON 63
ci_065                -2.718390e-03 3 1  ON 64
ci_066                -2.760562e-03 3 1  ON 65
ci_067                -2.523163e-03 3 1  ON 66
ci_068                -2.552556e-03 3 1  ON 67
ci_069                -5.922254e-04 3 1  ON 68
ci_070                -3.211261e-04 3 1  ON 69
ci_071                -3.097609e-03 3 1  ON 70
ci_072                -1.984363e-03 3 1  ON 71
ci_073                 2.254172e-04 3 1  ON 72
ci_074                 2.297940e-04 3 1  ON 73
ci_075                -2.891134e-04 3 1  ON 74
ci_076                -3.080886e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6337
    reference variance = 0.717068
====================================================
  Execution time = 2.6319e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0799e-01
  Total weights = 1.955517007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495383065710
                                         uncertainty =       0.002572907584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495383065710
                                         uncertainty =       0.002572907584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497657664
  error estimate for blocks of size 2^( 2) =       0.000515852328
  error estimate for blocks of size 2^( 3) =       0.000532254815
  error estimate for blocks of size 2^( 4) =       0.000543538513
  error estimate for blocks of size 2^( 5) =       0.000550477795
  error estimate for blocks of size 2^( 6) =       0.000554726698
  error estimate for blocks of size 2^( 7) =       0.000558913868

      target function =                  N/A
              le_mean =     -22.669862602008
             les_mean =     514.430662748728
             stat err =       0.000551914218
             autocorr =       1.229933897925
              std dev =       0.703794218176
             le_variance =       0.495326301538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266986260201e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669862602122       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669868803009       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669870466702       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669870759901       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.102145e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669862602122       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669864747023       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669864668831       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669864749363       residual = 1.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.155335e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669862602122       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669863195227       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669863103250       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669863124492       residual = 1.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 8.553162e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013354 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1055e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -7.063428e-01 3 1  ON 0
ci_002                -7.038844e-01 3 1  ON 1
ci_003                -4.403391e-02 3 1  ON 2
ci_004                -4.420647e-02 3 1  ON 3
ci_005                 1.642407e-02 3 1  ON 4
ci_006                 1.620046e-02 3 1  ON 5
ci_007                 1.311468e-02 3 1  ON 6
ci_008                 1.262660e-02 3 1  ON 7
ci_009                -1.177080e-02 3 1  ON 8
ci_010                -1.217200e-02 3 1  ON 9
ci_011                -8.640067e-03 3 1  ON 10
ci_012                -8.777166e-03 3 1  ON 11
ci_013                 1.026098e-02 3 1  ON 12
ci_014                 9.668766e-03 3 1  ON 13
ci_015                 1.218827e-02 3 1  ON 14
ci_016                 1.337279e-02 3 1  ON 15
ci_017                 1.025661e-02 3 1  ON 16
ci_018                 1.094202e-02 3 1  ON 17
ci_019                -1.305435e-03 3 1  ON 18
ci_020                -8.684410e-04 3 1  ON 19
ci_021                -7.885584e-03 3 1  ON 20
ci_022                -8.484385e-03 3 1  ON 21
ci_023                 7.951468e-03 3 1  ON 22
ci_024                 7.840399e-03 3 1  ON 23
ci_025                 3.830390e-03 3 1  ON 24
ci_026                 3.508995e-03 3 1  ON 25
ci_027                 6.591781e-03 3 1  ON 26
ci_028                 7.040101e-03 3 1  ON 27
ci_029                -5.146857e-03 3 1  ON 28
ci_030                -5.178549e-03 3 1  ON 29
ci_031                -7.993471e-03 3 1  ON 30
ci_032                -7.051820e-03 3 1  ON 31
ci_033                 4.704193e-03 3 1  ON 32
ci_034                 4.242756e-03 3 1  ON 33
ci_035                 8.656277e-04 3 1  ON 34
ci_036                 1.292122e-03 3 1  ON 35
ci_037                 5.755502e-03 3 1  ON 36
ci_038                 5.092134e-03 3 1  ON 37
ci_039                 5.271272e-03 3 1  ON 38
ci_040                 5.265239e-03 3 1  ON 39
ci_041                 4.829821e-03 3 1  ON 40
ci_042                 4.849605e-03 3 1  ON 41
ci_043                 5.211404e-03 3 1  ON 42
ci_044                 5.344809e-03 3 1  ON 43
ci_045                 3.338033e-03 3 1  ON 44
ci_046                 3.107534e-03 3 1  ON 45
ci_047                -5.574142e-04 3 1  ON 46
ci_048                -6.489784e-04 3 1  ON 47
ci_049                 8.606942e-04 3 1  ON 48
ci_050                 1.723140e-03 3 1  ON 49
ci_051                -1.896407e-03 3 1  ON 50
ci_052                -1.706137e-03 3 1  ON 51
ci_053                -2.231150e-03 3 1  ON 52
ci_054                -2.676396e-03 3 1  ON 53
ci_055                -1.256112e-03 3 1  ON 54
ci_056                -1.123764e-03 3 1  ON 55
ci_057                -1.295432e-03 3 1  ON 56
ci_058                -1.182048e-03 3 1  ON 57
ci_059                -1.007241e-04 3 1  ON 58
ci_060                 2.246600e-04 3 1  ON 59
ci_061                 2.794006e-04 3 1  ON 60
ci_062                 2.138978e-04 3 1  ON 61
ci_063                -5.281996e-04 3 1  ON 62
ci_064                -1.125880e-03 3 1  ON 63
ci_065                -2.775634e-03 3 1  ON 64
ci_066                -2.757875e-03 3 1  ON 65
ci_067                -2.691580e-03 3 1  ON 66
ci_068                -2.649585e-03 3 1  ON 67
ci_069                -6.353744e-04 3 1  ON 68
ci_070                -1.729683e-04 3 1  ON 69
ci_071                -2.818347e-03 3 1  ON 70
ci_072                -2.142785e-03 3 1  ON 71
ci_073                 1.129411e-04 3 1  ON 72
ci_074                 2.791996e-04 3 1  ON 73
ci_075                -3.869128e-04 3 1  ON 74
ci_076                -3.885565e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6251
    reference variance = 0.370627
====================================================
  Execution time = 2.5567e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1488e-01
  Total weights = 1.9554e+06
  Execution time = 3.6407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500410438789
                                         uncertainty =       0.003980310107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500410438789
                                         uncertainty =       0.003980310107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500186191
  error estimate for blocks of size 2^( 2) =       0.000518181539
  error estimate for blocks of size 2^( 3) =       0.000534063483
  error estimate for blocks of size 2^( 4) =       0.000545203348
  error estimate for blocks of size 2^( 5) =       0.000553378738
  error estimate for blocks of size 2^( 6) =       0.000557206927
  error estimate for blocks of size 2^( 7) =       0.000558889294

      target function =                  N/A
              le_mean =     -22.670073975521
             les_mean =     514.494402084791
             stat err =       0.000553669577
             autocorr =       1.225287281336
              std dev =       0.707370095070
             le_variance =       0.500372451399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500172030716
                                         uncertainty =       0.003913315484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500172030716
                                         uncertainty =       0.003913315484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500067570
  error estimate for blocks of size 2^( 2) =       0.000518076132
  error estimate for blocks of size 2^( 3) =       0.000533951482
  error estimate for blocks of size 2^( 4) =       0.000545088063
  error estimate for blocks of size 2^( 5) =       0.000553273021
  error estimate for blocks of size 2^( 6) =       0.000557079019
  error estimate for blocks of size 2^( 7) =       0.000558778640

      target function =                  N/A
              le_mean =     -22.670085291717
             les_mean =     514.462208684833
             stat err =       0.000553554686
             autocorr =       1.225359948234
              std dev =       0.707202339422
             le_variance =       0.500135148884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500228656596
                                         uncertainty =       0.003936066195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500228656596
                                         uncertainty =       0.003936066195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500095684
  error estimate for blocks of size 2^( 2) =       0.000518100583
  error estimate for blocks of size 2^( 3) =       0.000533976702
  error estimate for blocks of size 2^( 4) =       0.000545114663
  error estimate for blocks of size 2^( 5) =       0.000553295245
  error estimate for blocks of size 2^( 6) =       0.000557107867
  error estimate for blocks of size 2^( 7) =       0.000558798529

      target function =                  N/A
              le_mean =     -22.670079709736
             les_mean =     514.448652043756
             stat err =       0.000553579076
             autocorr =       1.225330152159
              std dev =       0.707242098256
             le_variance =       0.500191385546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500374377373
                                         uncertainty =       0.003973762206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500374377373
                                         uncertainty =       0.003973762206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500168224
  error estimate for blocks of size 2^( 2) =       0.000518166937
  error estimate for blocks of size 2^( 3) =       0.000534046789
  error estimate for blocks of size 2^( 4) =       0.000545184850
  error estimate for blocks of size 2^( 5) =       0.000553360861
  error estimate for blocks of size 2^( 6) =       0.000557190204
  error estimate for blocks of size 2^( 7) =       0.000558881012

      target function =                  N/A
              le_mean =     -22.670075592455
             les_mean =     514.497563638115
             stat err =       0.000553654232
             autocorr =       1.225307389849
              std dev =       0.707344685842
             le_variance =       0.500336504589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670073975521        initial
     2.5000e-01     2.5000e+00             1.1021e-03       -22.670085291717  <--
     1.0000e+00     1.0000e+01             3.1553e-04       -22.670079709736
     4.0000e+00     4.0000e+01             8.5532e-05       -22.670075592455

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.3814e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -7.064333e-01 3 1  ON 0
ci_002                -7.038929e-01 3 1  ON 1
ci_003                -4.343920e-02 3 1  ON 2
ci_004                -4.341979e-02 3 1  ON 3
ci_005                 1.628223e-02 3 1  ON 4
ci_006                 1.603976e-02 3 1  ON 5
ci_007                 1.251060e-02 3 1  ON 6
ci_008                 1.240587e-02 3 1  ON 7
ci_009                -1.226461e-02 3 1  ON 8
ci_010                -1.218381e-02 3 1  ON 9
ci_011                -8.881564e-03 3 1  ON 10
ci_012                -8.329929e-03 3 1  ON 11
ci_013                 9.915944e-03 3 1  ON 12
ci_014                 9.709171e-03 3 1  ON 13
ci_015                 1.170622e-02 3 1  ON 14
ci_016                 1.357450e-02 3 1  ON 15
ci_017                 1.006910e-02 3 1  ON 16
ci_018                 1.097190e-02 3 1  ON 17
ci_019                -1.718178e-03 3 1  ON 18
ci_020                -9.809477e-04 3 1  ON 19
ci_021                -8.077259e-03 3 1  ON 20
ci_022                -8.660161e-03 3 1  ON 21
ci_023                 8.260673e-03 3 1  ON 22
ci_024                 8.126235e-03 3 1  ON 23
ci_025                 4.149041e-03 3 1  ON 24
ci_026                 3.338647e-03 3 1  ON 25
ci_027                 6.894784e-03 3 1  ON 26
ci_028                 7.449897e-03 3 1  ON 27
ci_029                -5.209547e-03 3 1  ON 28
ci_030                -4.846323e-03 3 1  ON 29
ci_031                -7.898498e-03 3 1  ON 30
ci_032                -7.396531e-03 3 1  ON 31
ci_033                 4.979440e-03 3 1  ON 32
ci_034                 4.533906e-03 3 1  ON 33
ci_035                 9.791963e-04 3 1  ON 34
ci_036                 1.278627e-03 3 1  ON 35
ci_037                 5.693473e-03 3 1  ON 36
ci_038                 5.017250e-03 3 1  ON 37
ci_039                 5.277283e-03 3 1  ON 38
ci_040                 5.138199e-03 3 1  ON 39
ci_041                 4.775345e-03 3 1  ON 40
ci_042                 4.891185e-03 3 1  ON 41
ci_043                 5.108646e-03 3 1  ON 42
ci_044                 5.199111e-03 3 1  ON 43
ci_045                 3.419955e-03 3 1  ON 44
ci_046                 3.158493e-03 3 1  ON 45
ci_047                -7.392166e-04 3 1  ON 46
ci_048                -6.366048e-04 3 1  ON 47
ci_049                 7.526355e-04 3 1  ON 48
ci_050                 1.797467e-03 3 1  ON 49
ci_051                -1.698871e-03 3 1  ON 50
ci_052                -2.058059e-03 3 1  ON 51
ci_053                -1.942538e-03 3 1  ON 52
ci_054                -2.603314e-03 3 1  ON 53
ci_055                -1.307351e-03 3 1  ON 54
ci_056                -4.717769e-04 3 1  ON 55
ci_057                -1.200183e-03 3 1  ON 56
ci_058                -1.142995e-03 3 1  ON 57
ci_059                -1.799558e-04 3 1  ON 58
ci_060                 2.912122e-04 3 1  ON 59
ci_061                 9.055567e-05 3 1  ON 60
ci_062                 2.717751e-04 3 1  ON 61
ci_063                 2.311910e-05 3 1  ON 62
ci_064                -7.642805e-04 3 1  ON 63
ci_065                -2.892746e-03 3 1  ON 64
ci_066                -2.771474e-03 3 1  ON 65
ci_067                -3.006885e-03 3 1  ON 66
ci_068                -2.864036e-03 3 1  ON 67
ci_069                -7.066161e-04 3 1  ON 68
ci_070                 9.047619e-05 3 1  ON 69
ci_071                -2.297993e-03 3 1  ON 70
ci_072                -2.408197e-03 3 1  ON 71
ci_073                -5.195073e-05 3 1  ON 72
ci_074                 3.472572e-04 3 1  ON 73
ci_075                -5.547481e-04 3 1  ON 74
ci_076                -5.363108e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6391
    reference variance = 0.655459
====================================================
  Execution time = 2.6267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0662e-01
  Total weights = 1.954988977e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496577013309
                                         uncertainty =       0.002703094971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496577013309
                                         uncertainty =       0.002703094971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498263688
  error estimate for blocks of size 2^( 2) =       0.000516420013
  error estimate for blocks of size 2^( 3) =       0.000532496564
  error estimate for blocks of size 2^( 4) =       0.000543815054
  error estimate for blocks of size 2^( 5) =       0.000550758355
  error estimate for blocks of size 2^( 6) =       0.000553446011
  error estimate for blocks of size 2^( 7) =       0.000556641958

      target function =                  N/A
              le_mean =     -22.669757353799
             les_mean =     514.424514604423
             stat err =       0.000551165344
             autocorr =       1.223616509604
              std dev =       0.704651265838
             le_variance =       0.496533406447


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266975735380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669757353904       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669773163623       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669775747333       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669776428595       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669776674557       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 1.521194e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669757353904       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669765938866       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669766657772       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669766672964       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 7.885833e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669757353904       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669760389677       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669760499898       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669760493675       residual = 1.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.722064e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1611e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -7.064429e-01 3 1  ON 0
ci_002                -7.039797e-01 3 1  ON 1
ci_003                -4.305570e-02 3 1  ON 2
ci_004                -4.285151e-02 3 1  ON 3
ci_005                 1.618084e-02 3 1  ON 4
ci_006                 1.586735e-02 3 1  ON 5
ci_007                 1.232471e-02 3 1  ON 6
ci_008                 1.236876e-02 3 1  ON 7
ci_009                -1.163735e-02 3 1  ON 8
ci_010                -1.222356e-02 3 1  ON 9
ci_011                -8.671250e-03 3 1  ON 10
ci_012                -8.250876e-03 3 1  ON 11
ci_013                 9.966095e-03 3 1  ON 12
ci_014                 9.592211e-03 3 1  ON 13
ci_015                 1.175612e-02 3 1  ON 14
ci_016                 1.339229e-02 3 1  ON 15
ci_017                 9.802479e-03 3 1  ON 16
ci_018                 1.079241e-02 3 1  ON 17
ci_019                -1.897713e-03 3 1  ON 18
ci_020                -1.649439e-03 3 1  ON 19
ci_021                -7.988262e-03 3 1  ON 20
ci_022                -8.957517e-03 3 1  ON 21
ci_023                 8.327358e-03 3 1  ON 22
ci_024                 8.224743e-03 3 1  ON 23
ci_025                 4.492994e-03 3 1  ON 24
ci_026                 3.349077e-03 3 1  ON 25
ci_027                 6.847048e-03 3 1  ON 26
ci_028                 6.859613e-03 3 1  ON 27
ci_029                -4.621518e-03 3 1  ON 28
ci_030                -4.895821e-03 3 1  ON 29
ci_031                -8.032066e-03 3 1  ON 30
ci_032                -7.335763e-03 3 1  ON 31
ci_033                 4.796532e-03 3 1  ON 32
ci_034                 4.251195e-03 3 1  ON 33
ci_035                 1.116734e-03 3 1  ON 34
ci_036                 1.214667e-03 3 1  ON 35
ci_037                 5.684430e-03 3 1  ON 36
ci_038                 5.292762e-03 3 1  ON 37
ci_039                 5.678950e-03 3 1  ON 38
ci_040                 5.336207e-03 3 1  ON 39
ci_041                 5.131146e-03 3 1  ON 40
ci_042                 4.784668e-03 3 1  ON 41
ci_043                 5.065299e-03 3 1  ON 42
ci_044                 4.917977e-03 3 1  ON 43
ci_045                 2.939734e-03 3 1  ON 44
ci_046                 3.172286e-03 3 1  ON 45
ci_047                -8.209097e-04 3 1  ON 46
ci_048                -5.670062e-04 3 1  ON 47
ci_049                 1.087808e-03 3 1  ON 48
ci_050                 2.351081e-03 3 1  ON 49
ci_051                -1.932356e-03 3 1  ON 50
ci_052                -1.746370e-03 3 1  ON 51
ci_053                -2.266824e-03 3 1  ON 52
ci_054                -2.654223e-03 3 1  ON 53
ci_055                -1.396823e-03 3 1  ON 54
ci_056                -1.182462e-03 3 1  ON 55
ci_057                -1.479368e-03 3 1  ON 56
ci_058                -1.690672e-03 3 1  ON 57
ci_059                 1.057035e-04 3 1  ON 58
ci_060                -2.611928e-05 3 1  ON 59
ci_061                 5.368143e-04 3 1  ON 60
ci_062                -3.027740e-04 3 1  ON 61
ci_063                -9.621889e-05 3 1  ON 62
ci_064                -1.294883e-03 3 1  ON 63
ci_065                -2.796642e-03 3 1  ON 64
ci_066                -2.932068e-03 3 1  ON 65
ci_067                -2.218301e-03 3 1  ON 66
ci_068                -2.489450e-03 3 1  ON 67
ci_069                -2.866273e-04 3 1  ON 68
ci_070                 2.696783e-05 3 1  ON 69
ci_071                -2.329156e-03 3 1  ON 70
ci_072                -1.976429e-03 3 1  ON 71
ci_073                 2.931992e-04 3 1  ON 72
ci_074                 5.002875e-04 3 1  ON 73
ci_075                -5.218646e-04 3 1  ON 74
ci_076                -1.897676e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7113
    reference variance = 0.360713
====================================================
  Execution time = 2.5508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0821e-01
  Total weights = 1.9554e+06
  Execution time = 3.6401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497546190555
                                         uncertainty =       0.003372362069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497546190555
                                         uncertainty =       0.003372362069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498765526
  error estimate for blocks of size 2^( 2) =       0.000516418923
  error estimate for blocks of size 2^( 3) =       0.000532747601
  error estimate for blocks of size 2^( 4) =       0.000543902128
  error estimate for blocks of size 2^( 5) =       0.000550268451
  error estimate for blocks of size 2^( 6) =       0.000552572715
  error estimate for blocks of size 2^( 7) =       0.000552945963

      target function =                  N/A
              le_mean =     -22.669659550146
             les_mean =     514.440834508761
             stat err =       0.000549922314
             autocorr =       1.215653566933
              std dev =       0.705360971279
             le_variance =       0.497534099804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497329562221
                                         uncertainty =       0.003347784192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497329562221
                                         uncertainty =       0.003347784192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498654966
  error estimate for blocks of size 2^( 2) =       0.000516296832
  error estimate for blocks of size 2^( 3) =       0.000532602730
  error estimate for blocks of size 2^( 4) =       0.000543754482
  error estimate for blocks of size 2^( 5) =       0.000550097153
  error estimate for blocks of size 2^( 6) =       0.000552472270
  error estimate for blocks of size 2^( 7) =       0.000552804952

      target function =                  N/A
              le_mean =     -22.669651847641
             les_mean =     514.424469468070
             stat err =       0.000549782214
             autocorr =       1.215573085327
              std dev =       0.705204615855
             le_variance =       0.497313550224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497582839381
                                         uncertainty =       0.003334879580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497582839381
                                         uncertainty =       0.003334879580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498782544
  error estimate for blocks of size 2^( 2) =       0.000516423899
  error estimate for blocks of size 2^( 3) =       0.000532717441
  error estimate for blocks of size 2^( 4) =       0.000543869399
  error estimate for blocks of size 2^( 5) =       0.000550245620
  error estimate for blocks of size 2^( 6) =       0.000552634467
  error estimate for blocks of size 2^( 7) =       0.000552991123

      target function =                  N/A
              le_mean =     -22.669642746147
             les_mean =     514.847890923329
             stat err =       0.000549935152
             autocorr =       1.215627369384
              std dev =       0.705385038764
             le_variance =       0.497568052913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497411819943
                                         uncertainty =       0.003364837221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497411819943
                                         uncertainty =       0.003364837221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498698125
  error estimate for blocks of size 2^( 2) =       0.000516347823
  error estimate for blocks of size 2^( 3) =       0.000532675849
  error estimate for blocks of size 2^( 4) =       0.000543828503
  error estimate for blocks of size 2^( 5) =       0.000550185556
  error estimate for blocks of size 2^( 6) =       0.000552505190
  error estimate for blocks of size 2^( 7) =       0.000552873533

      target function =                  N/A
              le_mean =     -22.669653259175
             les_mean =     514.422755324724
             stat err =       0.000549848195
             autocorr =       1.215654432175
              std dev =       0.705265651612
             le_variance =       0.497399639343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669659550146        initial  <--
     6.2500e-02     6.2500e-01             1.5212e-03       -22.669651847641
     2.5000e-01     2.5000e+00             7.8858e-04       -22.669642746147
     1.0000e+00     1.0000e+01             2.7221e-04       -22.669653259175

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7839
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -7.064333e-01 3 1  ON 0
ci_002                -7.038929e-01 3 1  ON 1
ci_003                -4.343920e-02 3 1  ON 2
ci_004                -4.341979e-02 3 1  ON 3
ci_005                 1.628223e-02 3 1  ON 4
ci_006                 1.603976e-02 3 1  ON 5
ci_007                 1.251060e-02 3 1  ON 6
ci_008                 1.240587e-02 3 1  ON 7
ci_009                -1.226461e-02 3 1  ON 8
ci_010                -1.218381e-02 3 1  ON 9
ci_011                -8.881564e-03 3 1  ON 10
ci_012                -8.329929e-03 3 1  ON 11
ci_013                 9.915944e-03 3 1  ON 12
ci_014                 9.709171e-03 3 1  ON 13
ci_015                 1.170622e-02 3 1  ON 14
ci_016                 1.357450e-02 3 1  ON 15
ci_017                 1.006910e-02 3 1  ON 16
ci_018                 1.097190e-02 3 1  ON 17
ci_019                -1.718178e-03 3 1  ON 18
ci_020                -9.809477e-04 3 1  ON 19
ci_021                -8.077259e-03 3 1  ON 20
ci_022                -8.660161e-03 3 1  ON 21
ci_023                 8.260673e-03 3 1  ON 22
ci_024                 8.126235e-03 3 1  ON 23
ci_025                 4.149041e-03 3 1  ON 24
ci_026                 3.338647e-03 3 1  ON 25
ci_027                 6.894784e-03 3 1  ON 26
ci_028                 7.449897e-03 3 1  ON 27
ci_029                -5.209547e-03 3 1  ON 28
ci_030                -4.846323e-03 3 1  ON 29
ci_031                -7.898498e-03 3 1  ON 30
ci_032                -7.396531e-03 3 1  ON 31
ci_033                 4.979440e-03 3 1  ON 32
ci_034                 4.533906e-03 3 1  ON 33
ci_035                 9.791963e-04 3 1  ON 34
ci_036                 1.278627e-03 3 1  ON 35
ci_037                 5.693473e-03 3 1  ON 36
ci_038                 5.017250e-03 3 1  ON 37
ci_039                 5.277283e-03 3 1  ON 38
ci_040                 5.138199e-03 3 1  ON 39
ci_041                 4.775345e-03 3 1  ON 40
ci_042                 4.891185e-03 3 1  ON 41
ci_043                 5.108646e-03 3 1  ON 42
ci_044                 5.199111e-03 3 1  ON 43
ci_045                 3.419955e-03 3 1  ON 44
ci_046                 3.158493e-03 3 1  ON 45
ci_047                -7.392166e-04 3 1  ON 46
ci_048                -6.366048e-04 3 1  ON 47
ci_049                 7.526355e-04 3 1  ON 48
ci_050                 1.797467e-03 3 1  ON 49
ci_051                -1.698871e-03 3 1  ON 50
ci_052                -2.058059e-03 3 1  ON 51
ci_053                -1.942538e-03 3 1  ON 52
ci_054                -2.603314e-03 3 1  ON 53
ci_055                -1.307351e-03 3 1  ON 54
ci_056                -4.717769e-04 3 1  ON 55
ci_057                -1.200183e-03 3 1  ON 56
ci_058                -1.142995e-03 3 1  ON 57
ci_059                -1.799558e-04 3 1  ON 58
ci_060                 2.912122e-04 3 1  ON 59
ci_061                 9.055567e-05 3 1  ON 60
ci_062                 2.717751e-04 3 1  ON 61
ci_063                 2.311910e-05 3 1  ON 62
ci_064                -7.642805e-04 3 1  ON 63
ci_065                -2.892746e-03 3 1  ON 64
ci_066                -2.771474e-03 3 1  ON 65
ci_067                -3.006885e-03 3 1  ON 66
ci_068                -2.864036e-03 3 1  ON 67
ci_069                -7.066161e-04 3 1  ON 68
ci_070                 9.047619e-05 3 1  ON 69
ci_071                -2.297993e-03 3 1  ON 70
ci_072                -2.408197e-03 3 1  ON 71
ci_073                -5.195073e-05 3 1  ON 72
ci_074                 3.472572e-04 3 1  ON 73
ci_075                -5.547481e-04 3 1  ON 74
ci_076                -5.363108e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7029
    reference variance = 0.359435
====================================================
  Execution time = 2.6254e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.1350e-01
  Total weights = 1.955064974e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499613047832
                                         uncertainty =       0.003248412815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499613047832
                                         uncertainty =       0.003248412815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499868618
  error estimate for blocks of size 2^( 2) =       0.000518082674
  error estimate for blocks of size 2^( 3) =       0.000534436255
  error estimate for blocks of size 2^( 4) =       0.000546401557
  error estimate for blocks of size 2^( 5) =       0.000550810861
  error estimate for blocks of size 2^( 6) =       0.000553612333
  error estimate for blocks of size 2^( 7) =       0.000557123491

      target function =                  N/A
              le_mean =     -22.670618601284
             les_mean =     514.470451185420
             stat err =       0.000551987061
             autocorr =       1.219399603612
              std dev =       0.706920979292
             le_variance =       0.499737270963


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267061860128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670618601394       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670627264067       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670627558962       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670627535064       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 6.061390e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670618601394       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670621086427       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670621094770       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670621112020       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.606804e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670618601394       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670619246433       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670619243015       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670619250016       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 4.081235e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1016e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -7.064193e-01 3 1  ON 0
ci_002                -7.039360e-01 3 1  ON 1
ci_003                -4.327852e-02 3 1  ON 2
ci_004                -4.326264e-02 3 1  ON 3
ci_005                 1.630302e-02 3 1  ON 4
ci_006                 1.604148e-02 3 1  ON 5
ci_007                 1.251872e-02 3 1  ON 6
ci_008                 1.233450e-02 3 1  ON 7
ci_009                -1.215679e-02 3 1  ON 8
ci_010                -1.218288e-02 3 1  ON 9
ci_011                -8.841829e-03 3 1  ON 10
ci_012                -8.240987e-03 3 1  ON 11
ci_013                 9.772576e-03 3 1  ON 12
ci_014                 9.707762e-03 3 1  ON 13
ci_015                 1.176795e-02 3 1  ON 14
ci_016                 1.350023e-02 3 1  ON 15
ci_017                 1.015005e-02 3 1  ON 16
ci_018                 1.096631e-02 3 1  ON 17
ci_019                -1.769717e-03 3 1  ON 18
ci_020                -1.020479e-03 3 1  ON 19
ci_021                -8.071261e-03 3 1  ON 20
ci_022                -8.645877e-03 3 1  ON 21
ci_023                 8.332693e-03 3 1  ON 22
ci_024                 8.005087e-03 3 1  ON 23
ci_025                 4.063709e-03 3 1  ON 24
ci_026                 3.274228e-03 3 1  ON 25
ci_027                 6.897679e-03 3 1  ON 26
ci_028                 7.382852e-03 3 1  ON 27
ci_029                -5.139497e-03 3 1  ON 28
ci_030                -4.870945e-03 3 1  ON 29
ci_031                -7.880450e-03 3 1  ON 30
ci_032                -7.420012e-03 3 1  ON 31
ci_033                 4.988459e-03 3 1  ON 32
ci_034                 4.535900e-03 3 1  ON 33
ci_035                 9.465516e-04 3 1  ON 34
ci_036                 1.303011e-03 3 1  ON 35
ci_037                 5.668139e-03 3 1  ON 36
ci_038                 4.985256e-03 3 1  ON 37
ci_039                 5.286637e-03 3 1  ON 38
ci_040                 5.073670e-03 3 1  ON 39
ci_041                 4.848120e-03 3 1  ON 40
ci_042                 4.858039e-03 3 1  ON 41
ci_043                 5.131597e-03 3 1  ON 42
ci_044                 5.183585e-03 3 1  ON 43
ci_045                 3.411303e-03 3 1  ON 44
ci_046                 3.104557e-03 3 1  ON 45
ci_047                -7.438239e-04 3 1  ON 46
ci_048                -6.222911e-04 3 1  ON 47
ci_049                 8.096784e-04 3 1  ON 48
ci_050                 1.770982e-03 3 1  ON 49
ci_051                -1.752234e-03 3 1  ON 50
ci_052                -2.003819e-03 3 1  ON 51
ci_053                -1.931936e-03 3 1  ON 52
ci_054                -2.602716e-03 3 1  ON 53
ci_055                -1.391788e-03 3 1  ON 54
ci_056                -5.580597e-04 3 1  ON 55
ci_057                -1.204805e-03 3 1  ON 56
ci_058                -1.120216e-03 3 1  ON 57
ci_059                -1.830748e-04 3 1  ON 58
ci_060                 3.129099e-04 3 1  ON 59
ci_061                 1.431560e-04 3 1  ON 60
ci_062                 1.750023e-04 3 1  ON 61
ci_063                 1.075668e-04 3 1  ON 62
ci_064                -7.758382e-04 3 1  ON 63
ci_065                -2.808475e-03 3 1  ON 64
ci_066                -2.812330e-03 3 1  ON 65
ci_067                -2.862753e-03 3 1  ON 66
ci_068                -2.862212e-03 3 1  ON 67
ci_069                -6.405531e-04 3 1  ON 68
ci_070                 8.613517e-05 3 1  ON 69
ci_071                -2.309959e-03 3 1  ON 70
ci_072                -2.355295e-03 3 1  ON 71
ci_073                 1.314031e-05 3 1  ON 72
ci_074                 3.215458e-04 3 1  ON 73
ci_075                -5.651454e-04 3 1  ON 74
ci_076                -5.315540e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.5894
    reference variance = 0.474302
====================================================
  Execution time = 2.5533e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1650e-01
  Total weights = 1.9548e+06
  Execution time = 3.6436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498955789536
                                         uncertainty =       0.003021640809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498955789536
                                         uncertainty =       0.003021640809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499462620
  error estimate for blocks of size 2^( 2) =       0.000517077943
  error estimate for blocks of size 2^( 3) =       0.000532613316
  error estimate for blocks of size 2^( 4) =       0.000543849130
  error estimate for blocks of size 2^( 5) =       0.000549654707
  error estimate for blocks of size 2^( 6) =       0.000550729781
  error estimate for blocks of size 2^( 7) =       0.000554410185

      target function =                  N/A
              le_mean =     -22.669338967439
             les_mean =     514.417007817357
             stat err =       0.000549660951
             autocorr =       1.211110551515
              std dev =       0.706346811015
             le_variance =       0.498925817431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499002955920
                                         uncertainty =       0.003047905895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499002955920
                                         uncertainty =       0.003047905895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499486098
  error estimate for blocks of size 2^( 2) =       0.000517100060
  error estimate for blocks of size 2^( 3) =       0.000532637283
  error estimate for blocks of size 2^( 4) =       0.000543872842
  error estimate for blocks of size 2^( 5) =       0.000549667977
  error estimate for blocks of size 2^( 6) =       0.000550739548
  error estimate for blocks of size 2^( 7) =       0.000554421214

      target function =                  N/A
              le_mean =     -22.669340713341
             les_mean =     514.418900278438
             stat err =       0.000549675395
             autocorr =       1.211060345842
              std dev =       0.706380014328
             le_variance =       0.498972724642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498967441302
                                         uncertainty =       0.003034260466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498967441302
                                         uncertainty =       0.003034260466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499468395
  error estimate for blocks of size 2^( 2) =       0.000517082764
  error estimate for blocks of size 2^( 3) =       0.000532619668
  error estimate for blocks of size 2^( 4) =       0.000543856133
  error estimate for blocks of size 2^( 5) =       0.000549656165
  error estimate for blocks of size 2^( 6) =       0.000550728335
  error estimate for blocks of size 2^( 7) =       0.000554408545

      target function =                  N/A
              le_mean =     -22.669338850624
             les_mean =     514.415689080299
             stat err =       0.000549662294
             autocorr =       1.211088462899
              std dev =       0.706354978864
             le_variance =       0.498937356166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498955655652
                                         uncertainty =       0.003023075480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498955655652
                                         uncertainty =       0.003023075480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499462547
  error estimate for blocks of size 2^( 2) =       0.000517077782
  error estimate for blocks of size 2^( 3) =       0.000532613584
  error estimate for blocks of size 2^( 4) =       0.000543849066
  error estimate for blocks of size 2^( 5) =       0.000549653196
  error estimate for blocks of size 2^( 6) =       0.000550727366
  error estimate for blocks of size 2^( 7) =       0.000554406295

      target function =                  N/A
              le_mean =     -22.669339209333
             les_mean =     514.419298580816
             stat err =       0.000549658981
             autocorr =       1.211102225075
              std dev =       0.706346707676
             le_variance =       0.498925671445


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669338967439        initial
     6.2500e-01     6.2500e+00             6.0614e-04       -22.669340713341  <--
     2.5000e+00     2.5000e+01             1.6068e-04       -22.669338850624
     1.0000e+01     1.0000e+02             4.0812e-05       -22.669339209333

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.3774e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -7.063730e-01 3 1  ON 0
ci_002                -7.040592e-01 3 1  ON 1
ci_003                -4.283306e-02 3 1  ON 2
ci_004                -4.282891e-02 3 1  ON 3
ci_005                 1.634854e-02 3 1  ON 4
ci_006                 1.605002e-02 3 1  ON 5
ci_007                 1.254753e-02 3 1  ON 6
ci_008                 1.215786e-02 3 1  ON 7
ci_009                -1.189319e-02 3 1  ON 8
ci_010                -1.218686e-02 3 1  ON 9
ci_011                -8.752049e-03 3 1  ON 10
ci_012                -8.020544e-03 3 1  ON 11
ci_013                 9.424710e-03 3 1  ON 12
ci_014                 9.706921e-03 3 1  ON 13
ci_015                 1.192246e-02 3 1  ON 14
ci_016                 1.330452e-02 3 1  ON 15
ci_017                 1.035836e-02 3 1  ON 16
ci_018                 1.095338e-02 3 1  ON 17
ci_019                -1.895070e-03 3 1  ON 18
ci_020                -1.117000e-03 3 1  ON 19
ci_021                -8.057728e-03 3 1  ON 20
ci_022                -8.608701e-03 3 1  ON 21
ci_023                 8.497751e-03 3 1  ON 22
ci_024                 7.728689e-03 3 1  ON 23
ci_025                 3.853295e-03 3 1  ON 24
ci_026                 3.116326e-03 3 1  ON 25
ci_027                 6.901464e-03 3 1  ON 26
ci_028                 7.244729e-03 3 1  ON 27
ci_029                -4.970312e-03 3 1  ON 28
ci_030                -4.928535e-03 3 1  ON 29
ci_031                -7.836421e-03 3 1  ON 30
ci_032                -7.478228e-03 3 1  ON 31
ci_033                 5.011061e-03 3 1  ON 32
ci_034                 4.544031e-03 3 1  ON 33
ci_035                 8.737162e-04 3 1  ON 34
ci_036                 1.352352e-03 3 1  ON 35
ci_037                 5.594412e-03 3 1  ON 36
ci_038                 4.907729e-03 3 1  ON 37
ci_039                 5.304944e-03 3 1  ON 38
ci_040                 4.938697e-03 3 1  ON 39
ci_041                 5.011918e-03 3 1  ON 40
ci_042                 4.785270e-03 3 1  ON 41
ci_043                 5.191070e-03 3 1  ON 42
ci_044                 5.138987e-03 3 1  ON 43
ci_045                 3.389144e-03 3 1  ON 44
ci_046                 2.976596e-03 3 1  ON 45
ci_047                -7.533966e-04 3 1  ON 46
ci_048                -5.913899e-04 3 1  ON 47
ci_049                 9.478376e-04 3 1  ON 48
ci_050                 1.707826e-03 3 1  ON 49
ci_051                -1.878799e-03 3 1  ON 50
ci_052                -1.872272e-03 3 1  ON 51
ci_053                -1.913316e-03 3 1  ON 52
ci_054                -2.605512e-03 3 1  ON 53
ci_055                -1.601710e-03 3 1  ON 54
ci_056                -7.770848e-04 3 1  ON 55
ci_057                -1.213582e-03 3 1  ON 56
ci_058                -1.068255e-03 3 1  ON 57
ci_059                -1.924664e-04 3 1  ON 58
ci_060                 3.622706e-04 3 1  ON 59
ci_061                 2.746526e-04 3 1  ON 60
ci_062                -5.289992e-05 3 1  ON 61
ci_063                 3.062422e-04 3 1  ON 62
ci_064                -8.000525e-04 3 1  ON 63
ci_065                -2.611943e-03 3 1  ON 64
ci_066                -2.907020e-03 3 1  ON 65
ci_067                -2.507934e-03 3 1  ON 66
ci_068                -2.851765e-03 3 1  ON 67
ci_069                -4.873567e-04 3 1  ON 68
ci_070                 7.852675e-05 3 1  ON 69
ci_071                -2.334859e-03 3 1  ON 70
ci_072                -2.230938e-03 3 1  ON 71
ci_073                 1.509050e-04 3 1  ON 72
ci_074                 2.654667e-04 3 1  ON 73
ci_075                -5.923871e-04 3 1  ON 74
ci_076                -5.181595e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4797e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6775
    reference variance = 0.72834
====================================================
  Execution time = 2.6316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2199e-01
  Total weights = 1.954980525e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502090716443
                                         uncertainty =       0.009106741396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502090716443
                                         uncertainty =       0.009106741396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501031635
  error estimate for blocks of size 2^( 2) =       0.000519285889
  error estimate for blocks of size 2^( 3) =       0.000535952521
  error estimate for blocks of size 2^( 4) =       0.000547494930
  error estimate for blocks of size 2^( 5) =       0.000554192862
  error estimate for blocks of size 2^( 6) =       0.000558416290
  error estimate for blocks of size 2^( 7) =       0.000559342381

      target function =                  N/A
              le_mean =     -22.670331572225
             les_mean =     514.465926383716
             stat err =       0.000554861616
             autocorr =       1.226419558217
              std dev =       0.708565733932
             le_variance =       0.502065399302


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267033157222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670331572317       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670349561874       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670352166373       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670352451757       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670352558895       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.541866e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670331572317       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670338684891       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670339309332       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670339395449       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 4.587190e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670331572317       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670333652920       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670333802838       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670333839223       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.280130e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017519 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1115e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -7.065078e-01 3 1  ON 0
ci_002                -7.039302e-01 3 1  ON 1
ci_003                -4.237434e-02 3 1  ON 2
ci_004                -4.275425e-02 3 1  ON 3
ci_005                 1.623213e-02 3 1  ON 4
ci_006                 1.615126e-02 3 1  ON 5
ci_007                 1.260776e-02 3 1  ON 6
ci_008                 1.223759e-02 3 1  ON 7
ci_009                -1.206020e-02 3 1  ON 8
ci_010                -1.203929e-02 3 1  ON 9
ci_011                -8.653509e-03 3 1  ON 10
ci_012                -7.986077e-03 3 1  ON 11
ci_013                 9.735380e-03 3 1  ON 12
ci_014                 9.515830e-03 3 1  ON 13
ci_015                 1.216989e-02 3 1  ON 14
ci_016                 1.340512e-02 3 1  ON 15
ci_017                 1.076880e-02 3 1  ON 16
ci_018                 1.131345e-02 3 1  ON 17
ci_019                -2.211683e-03 3 1  ON 18
ci_020                -1.237322e-03 3 1  ON 19
ci_021                -7.986641e-03 3 1  ON 20
ci_022                -8.743930e-03 3 1  ON 21
ci_023                 8.362262e-03 3 1  ON 22
ci_024                 7.798059e-03 3 1  ON 23
ci_025                 4.072497e-03 3 1  ON 24
ci_026                 3.311468e-03 3 1  ON 25
ci_027                 7.043316e-03 3 1  ON 26
ci_028                 7.618643e-03 3 1  ON 27
ci_029                -4.694431e-03 3 1  ON 28
ci_030                -4.873022e-03 3 1  ON 29
ci_031                -7.731947e-03 3 1  ON 30
ci_032                -7.717505e-03 3 1  ON 31
ci_033                 4.760709e-03 3 1  ON 32
ci_034                 4.742510e-03 3 1  ON 33
ci_035                 8.005740e-04 3 1  ON 34
ci_036                 1.259188e-03 3 1  ON 35
ci_037                 5.564116e-03 3 1  ON 36
ci_038                 4.877417e-03 3 1  ON 37
ci_039                 5.484334e-03 3 1  ON 38
ci_040                 5.008828e-03 3 1  ON 39
ci_041                 5.025122e-03 3 1  ON 40
ci_042                 5.031114e-03 3 1  ON 41
ci_043                 5.036915e-03 3 1  ON 42
ci_044                 5.179508e-03 3 1  ON 43
ci_045                 3.373330e-03 3 1  ON 44
ci_046                 2.842151e-03 3 1  ON 45
ci_047                -7.207844e-04 3 1  ON 46
ci_048                -5.954151e-04 3 1  ON 47
ci_049                 1.088115e-03 3 1  ON 48
ci_050                 1.849076e-03 3 1  ON 49
ci_051                -1.873028e-03 3 1  ON 50
ci_052                -1.717115e-03 3 1  ON 51
ci_053                -1.896027e-03 3 1  ON 52
ci_054                -2.507043e-03 3 1  ON 53
ci_055                -1.274036e-03 3 1  ON 54
ci_056                -8.078601e-04 3 1  ON 55
ci_057                -1.245443e-03 3 1  ON 56
ci_058                -7.315718e-04 3 1  ON 57
ci_059                -3.973998e-05 3 1  ON 58
ci_060                 2.339046e-04 3 1  ON 59
ci_061                 1.504569e-04 3 1  ON 60
ci_062                -1.023543e-04 3 1  ON 61
ci_063                -1.282362e-04 3 1  ON 62
ci_064                -6.063269e-04 3 1  ON 63
ci_065                -2.793148e-03 3 1  ON 64
ci_066                -3.147973e-03 3 1  ON 65
ci_067                -2.409127e-03 3 1  ON 66
ci_068                -2.761804e-03 3 1  ON 67
ci_069                -5.566629e-04 3 1  ON 68
ci_070                -7.039615e-05 3 1  ON 69
ci_071                -2.093814e-03 3 1  ON 70
ci_072                -2.156200e-03 3 1  ON 71
ci_073                 7.054276e-05 3 1  ON 72
ci_074                 4.197551e-04 3 1  ON 73
ci_075                -8.713147e-04 3 1  ON 74
ci_076                -4.078055e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.5659
    reference variance = 0.279053
====================================================
  Execution time = 2.5593e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1454e-01
  Total weights = 1.9550e+06
  Execution time = 3.6304e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500908861578
                                         uncertainty =       0.003614260745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500908861578
                                         uncertainty =       0.003614260745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500406003
  error estimate for blocks of size 2^( 2) =       0.000518273935
  error estimate for blocks of size 2^( 3) =       0.000534128869
  error estimate for blocks of size 2^( 4) =       0.000546010640
  error estimate for blocks of size 2^( 5) =       0.000551793041
  error estimate for blocks of size 2^( 6) =       0.000556564335
  error estimate for blocks of size 2^( 7) =       0.000557256955

      target function =                  N/A
              le_mean =     -22.669212616068
             les_mean =     514.556603962061
             stat err =       0.000552906243
             autocorr =       1.220837792342
              std dev =       0.707680956043
             le_variance =       0.500812335546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500757159165
                                         uncertainty =       0.003584554772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500757159165
                                         uncertainty =       0.003584554772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500330231
  error estimate for blocks of size 2^( 2) =       0.000518198733
  error estimate for blocks of size 2^( 3) =       0.000534043384
  error estimate for blocks of size 2^( 4) =       0.000545917747
  error estimate for blocks of size 2^( 5) =       0.000551726172
  error estimate for blocks of size 2^( 6) =       0.000556429156
  error estimate for blocks of size 2^( 7) =       0.000557192345

      target function =                  N/A
              le_mean =     -22.669202233280
             les_mean =     514.425062131266
             stat err =       0.000552816355
             autocorr =       1.220810559801
              std dev =       0.707573798307
             le_variance =       0.500660680051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500670671472
                                         uncertainty =       0.003588861278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500670671472
                                         uncertainty =       0.003588861278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500287107
  error estimate for blocks of size 2^( 2) =       0.000518158724
  error estimate for blocks of size 2^( 3) =       0.000534005058
  error estimate for blocks of size 2^( 4) =       0.000545884250
  error estimate for blocks of size 2^( 5) =       0.000551685735
  error estimate for blocks of size 2^( 6) =       0.000556394351
  error estimate for blocks of size 2^( 7) =       0.000557138779

      target function =                  N/A
              le_mean =     -22.669205248124
             les_mean =     514.415620999898
             stat err =       0.000552775779
             autocorr =       1.220841794080
              std dev =       0.707512812347
             le_variance =       0.500574379634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500635722160
                                         uncertainty =       0.003617858792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500635722160
                                         uncertainty =       0.003617858792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500269799
  error estimate for blocks of size 2^( 2) =       0.000518142974
  error estimate for blocks of size 2^( 3) =       0.000533995411
  error estimate for blocks of size 2^( 4) =       0.000545883609
  error estimate for blocks of size 2^( 5) =       0.000551686424
  error estimate for blocks of size 2^( 6) =       0.000556399897
  error estimate for blocks of size 2^( 7) =       0.000557131472

      target function =                  N/A
              le_mean =     -22.669220832884
             les_mean =     514.411228419200
             stat err =       0.000552775350
             autocorr =       1.220924377091
              std dev =       0.707488335144
             le_variance =       0.500539744364


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669212616068        initial
     1.5625e-01     1.5625e+00             1.5419e-03       -22.669202233280
     6.2500e-01     6.2500e+00             4.5872e-04       -22.669205248124
     2.5000e+00     2.5000e+01             1.2801e-04       -22.669220832884  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.3814e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -7.064066e-01 3 1  ON 0
ci_002                -7.040260e-01 3 1  ON 1
ci_003                -4.271336e-02 3 1  ON 2
ci_004                -4.280976e-02 3 1  ON 3
ci_005                 1.631247e-02 3 1  ON 4
ci_006                 1.608275e-02 3 1  ON 5
ci_007                 1.256677e-02 3 1  ON 6
ci_008                 1.218236e-02 3 1  ON 7
ci_009                -1.194312e-02 3 1  ON 8
ci_010                -1.214392e-02 3 1  ON 9
ci_011                -8.725588e-03 3 1  ON 10
ci_012                -8.009782e-03 3 1  ON 11
ci_013                 9.516978e-03 3 1  ON 12
ci_014                 9.651341e-03 3 1  ON 13
ci_015                 1.199366e-02 3 1  ON 14
ci_016                 1.333492e-02 3 1  ON 15
ci_017                 1.047684e-02 3 1  ON 16
ci_018                 1.105808e-02 3 1  ON 17
ci_019                -1.982640e-03 3 1  ON 18
ci_020                -1.150867e-03 3 1  ON 19
ci_021                -8.037702e-03 3 1  ON 20
ci_022                -8.649790e-03 3 1  ON 21
ci_023                 8.456568e-03 3 1  ON 22
ci_024                 7.750464e-03 3 1  ON 23
ci_025                 3.913745e-03 3 1  ON 24
ci_026                 3.172060e-03 3 1  ON 25
ci_027                 6.946871e-03 3 1  ON 26
ci_028                 7.366289e-03 3 1  ON 27
ci_029                -4.889202e-03 3 1  ON 28
ci_030                -4.914943e-03 3 1  ON 29
ci_031                -7.805648e-03 3 1  ON 30
ci_032                -7.547630e-03 3 1  ON 31
ci_033                 4.938590e-03 3 1  ON 32
ci_034                 4.602369e-03 3 1  ON 33
ci_035                 8.504011e-04 3 1  ON 34
ci_036                 1.322821e-03 3 1  ON 35
ci_037                 5.582979e-03 3 1  ON 36
ci_038                 4.900332e-03 3 1  ON 37
ci_039                 5.362335e-03 3 1  ON 38
ci_040                 4.961889e-03 3 1  ON 39
ci_041                 5.016176e-03 3 1  ON 40
ci_042                 4.861319e-03 3 1  ON 41
ci_043                 5.145172e-03 3 1  ON 42
ci_044                 5.151087e-03 3 1  ON 43
ci_045                 3.384384e-03 3 1  ON 44
ci_046                 2.938960e-03 3 1  ON 45
ci_047                -7.419619e-04 3 1  ON 46
ci_048                -5.923851e-04 3 1  ON 47
ci_049                 9.889888e-04 3 1  ON 48
ci_050                 1.748682e-03 3 1  ON 49
ci_051                -1.875222e-03 3 1  ON 50
ci_052                -1.825510e-03 3 1  ON 51
ci_053                -1.908148e-03 3 1  ON 52
ci_054                -2.577330e-03 3 1  ON 53
ci_055                -1.506998e-03 3 1  ON 54
ci_056                -7.869938e-04 3 1  ON 55
ci_057                -1.222806e-03 3 1  ON 56
ci_058                -9.674048e-04 3 1  ON 57
ci_059                -1.438440e-04 3 1  ON 58
ci_060                 3.222373e-04 3 1  ON 59
ci_061                 2.378632e-04 3 1  ON 60
ci_062                -6.533858e-05 3 1  ON 61
ci_063                 1.782291e-04 3 1  ON 62
ci_064                -7.428348e-04 3 1  ON 63
ci_065                -2.663990e-03 3 1  ON 64
ci_066                -2.978752e-03 3 1  ON 65
ci_067                -2.477626e-03 3 1  ON 66
ci_068                -2.826282e-03 3 1  ON 67
ci_069                -5.091018e-04 3 1  ON 68
ci_070                 3.377783e-05 3 1  ON 69
ci_071                -2.263416e-03 3 1  ON 70
ci_072                -2.208461e-03 3 1  ON 71
ci_073                 1.260326e-04 3 1  ON 72
ci_074                 3.144160e-04 3 1  ON 73
ci_075                -6.759860e-04 3 1  ON 74
ci_076                -4.856534e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6735
    reference variance = 0.40325
====================================================
  Execution time = 2.6255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.0828e-01
  Total weights = 1.955142630e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495775828369
                                         uncertainty =       0.002694063052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495775828369
                                         uncertainty =       0.002694063052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497903521
  error estimate for blocks of size 2^( 2) =       0.000515749648
  error estimate for blocks of size 2^( 3) =       0.000531824846
  error estimate for blocks of size 2^( 4) =       0.000542875667
  error estimate for blocks of size 2^( 5) =       0.000550060366
  error estimate for blocks of size 2^( 6) =       0.000551177479
  error estimate for blocks of size 2^( 7) =       0.000552583391

      target function =                  N/A
              le_mean =     -22.670976140138
             les_mean =     514.481435122025
             stat err =       0.000549174226
             autocorr =       1.216549816739
              std dev =       0.704141912231
             le_variance =       0.495815832560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267097614014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670976140265       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670976710616       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670977065850       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670977168821       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 6.746499e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670976140265       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670976307061       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670976239466       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670976271841       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.975749e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670976140265       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670976183812       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670976152425       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670976161326       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 5.160024e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1001e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -7.064136e-01 3 1  ON 0
ci_002                -7.040445e-01 3 1  ON 1
ci_003                -4.254730e-02 3 1  ON 2
ci_004                -4.268500e-02 3 1  ON 3
ci_005                 1.624993e-02 3 1  ON 4
ci_006                 1.609119e-02 3 1  ON 5
ci_007                 1.256459e-02 3 1  ON 6
ci_008                 1.213373e-02 3 1  ON 7
ci_009                -1.188507e-02 3 1  ON 8
ci_010                -1.212414e-02 3 1  ON 9
ci_011                -8.744495e-03 3 1  ON 10
ci_012                -8.032026e-03 3 1  ON 11
ci_013                 9.512107e-03 3 1  ON 12
ci_014                 9.774010e-03 3 1  ON 13
ci_015                 1.203806e-02 3 1  ON 14
ci_016                 1.322538e-02 3 1  ON 15
ci_017                 1.036015e-02 3 1  ON 16
ci_018                 1.105965e-02 3 1  ON 17
ci_019                -2.043772e-03 3 1  ON 18
ci_020                -1.137357e-03 3 1  ON 19
ci_021                -8.078305e-03 3 1  ON 20
ci_022                -8.654163e-03 3 1  ON 21
ci_023                 8.559228e-03 3 1  ON 22
ci_024                 7.721953e-03 3 1  ON 23
ci_025                 3.903456e-03 3 1  ON 24
ci_026                 3.277147e-03 3 1  ON 25
ci_027                 6.864563e-03 3 1  ON 26
ci_028                 7.308383e-03 3 1  ON 27
ci_029                -4.832780e-03 3 1  ON 28
ci_030                -4.942020e-03 3 1  ON 29
ci_031                -7.780141e-03 3 1  ON 30
ci_032                -7.437635e-03 3 1  ON 31
ci_033                 4.998146e-03 3 1  ON 32
ci_034                 4.519014e-03 3 1  ON 33
ci_035                 8.633469e-04 3 1  ON 34
ci_036                 1.309645e-03 3 1  ON 35
ci_037                 5.522017e-03 3 1  ON 36
ci_038                 4.883617e-03 3 1  ON 37
ci_039                 5.304142e-03 3 1  ON 38
ci_040                 5.071345e-03 3 1  ON 39
ci_041                 5.001830e-03 3 1  ON 40
ci_042                 4.881105e-03 3 1  ON 41
ci_043                 5.060218e-03 3 1  ON 42
ci_044                 5.033491e-03 3 1  ON 43
ci_045                 3.354631e-03 3 1  ON 44
ci_046                 2.900664e-03 3 1  ON 45
ci_047                -7.428297e-04 3 1  ON 46
ci_048                -5.339402e-04 3 1  ON 47
ci_049                 1.090417e-03 3 1  ON 48
ci_050                 1.551107e-03 3 1  ON 49
ci_051                -1.784094e-03 3 1  ON 50
ci_052                -1.802701e-03 3 1  ON 51
ci_053                -1.947211e-03 3 1  ON 52
ci_054                -2.528031e-03 3 1  ON 53
ci_055                -1.537321e-03 3 1  ON 54
ci_056                -8.660115e-04 3 1  ON 55
ci_057                -1.267917e-03 3 1  ON 56
ci_058                -1.079929e-03 3 1  ON 57
ci_059                -1.284558e-04 3 1  ON 58
ci_060                 3.655274e-04 3 1  ON 59
ci_061                 1.690443e-04 3 1  ON 60
ci_062                -6.586494e-05 3 1  ON 61
ci_063                 4.703448e-05 3 1  ON 62
ci_064                -7.192078e-04 3 1  ON 63
ci_065                -2.612563e-03 3 1  ON 64
ci_066                -3.090428e-03 3 1  ON 65
ci_067                -2.414685e-03 3 1  ON 66
ci_068                -2.761450e-03 3 1  ON 67
ci_069                -4.407215e-04 3 1  ON 68
ci_070                 2.556887e-05 3 1  ON 69
ci_071                -2.214486e-03 3 1  ON 70
ci_072                -2.332607e-03 3 1  ON 71
ci_073                 1.998170e-04 3 1  ON 72
ci_074                 4.185126e-04 3 1  ON 73
ci_075                -7.862841e-04 3 1  ON 74
ci_076                -5.139306e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6224
    reference variance = 0.439649
====================================================
  Execution time = 2.5550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0638e-01
  Total weights = 1.9551e+06
  Execution time = 3.6332e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494320670381
                                         uncertainty =       0.002427523768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494320670381
                                         uncertainty =       0.002427523768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497143710
  error estimate for blocks of size 2^( 2) =       0.000515060303
  error estimate for blocks of size 2^( 3) =       0.000531580718
  error estimate for blocks of size 2^( 4) =       0.000542766250
  error estimate for blocks of size 2^( 5) =       0.000549838533
  error estimate for blocks of size 2^( 6) =       0.000553164559
  error estimate for blocks of size 2^( 7) =       0.000555228020

      target function =                  N/A
              le_mean =     -22.668950621982
             les_mean =     514.388013311367
             stat err =       0.000550249340
             autocorr =       1.225053806382
              std dev =       0.703067376462
             le_variance =       0.494303735845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494267607874
                                         uncertainty =       0.002414465651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494267607874
                                         uncertainty =       0.002414465651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497116530
  error estimate for blocks of size 2^( 2) =       0.000515043377
  error estimate for blocks of size 2^( 3) =       0.000531558542
  error estimate for blocks of size 2^( 4) =       0.000542740715
  error estimate for blocks of size 2^( 5) =       0.000549825554
  error estimate for blocks of size 2^( 6) =       0.000553169488
  error estimate for blocks of size 2^( 7) =       0.000555258491

      target function =                  N/A
              le_mean =     -22.668963518314
             les_mean =     514.431344683827
             stat err =       0.000550248562
             autocorr =       1.225184302940
              std dev =       0.703028938471
             le_variance =       0.494249688328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494262114757
                                         uncertainty =       0.002419473401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494262114757
                                         uncertainty =       0.002419473401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497113983
  error estimate for blocks of size 2^( 2) =       0.000515034012
  error estimate for blocks of size 2^( 3) =       0.000531553755
  error estimate for blocks of size 2^( 4) =       0.000542735286
  error estimate for blocks of size 2^( 5) =       0.000549810491
  error estimate for blocks of size 2^( 6) =       0.000553145380
  error estimate for blocks of size 2^( 7) =       0.000555222937

      target function =                  N/A
              le_mean =     -22.668954451635
             les_mean =     514.392944638204
             stat err =       0.000550228524
             autocorr =       1.225107621090
              std dev =       0.703025337211
             le_variance =       0.494244624761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494310680892
                                         uncertainty =       0.002426399781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494310680892
                                         uncertainty =       0.002426399781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497138650
  error estimate for blocks of size 2^( 2) =       0.000515055743
  error estimate for blocks of size 2^( 3) =       0.000531576251
  error estimate for blocks of size 2^( 4) =       0.000542761854
  error estimate for blocks of size 2^( 5) =       0.000549835538
  error estimate for blocks of size 2^( 6) =       0.000553163303
  error estimate for blocks of size 2^( 7) =       0.000555228328

      target function =                  N/A
              le_mean =     -22.668950693896
             les_mean =     514.391844072751
             stat err =       0.000550247256
             autocorr =       1.225069461465
              std dev =       0.703060220966
             le_variance =       0.494293674304


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668950621982        initial
     6.2500e-01     6.2500e+00             6.7465e-04       -22.668963518314  <--
     2.5000e+00     2.5000e+01             1.9757e-04       -22.668954451635
     1.0000e+01     1.0000e+02             5.1600e-05       -22.668950693896

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.3772e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -7.064277e-01 3 1  ON 0
ci_002                -7.040982e-01 3 1  ON 1
ci_003                -4.208439e-02 3 1  ON 2
ci_004                -4.233500e-02 3 1  ON 3
ci_005                 1.611331e-02 3 1  ON 4
ci_006                 1.610866e-02 3 1  ON 5
ci_007                 1.255514e-02 3 1  ON 6
ci_008                 1.201780e-02 3 1  ON 7
ci_009                -1.174430e-02 3 1  ON 8
ci_010                -1.208125e-02 3 1  ON 9
ci_011                -8.783307e-03 3 1  ON 10
ci_012                -8.078674e-03 3 1  ON 11
ci_013                 9.488881e-03 3 1  ON 12
ci_014                 1.007770e-02 3 1  ON 13
ci_015                 1.214908e-02 3 1  ON 14
ci_016                 1.295075e-02 3 1  ON 15
ci_017                 1.008369e-02 3 1  ON 16
ci_018                 1.105999e-02 3 1  ON 17
ci_019                -2.199840e-03 3 1  ON 18
ci_020                -1.107634e-03 3 1  ON 19
ci_021                -8.183883e-03 3 1  ON 20
ci_022                -8.669326e-03 3 1  ON 21
ci_023                 8.799130e-03 3 1  ON 22
ci_024                 7.655379e-03 3 1  ON 23
ci_025                 3.883122e-03 3 1  ON 24
ci_026                 3.535692e-03 3 1  ON 25
ci_027                 6.689010e-03 3 1  ON 26
ci_028                 7.184619e-03 3 1  ON 27
ci_029                -4.698238e-03 3 1  ON 28
ci_030                -5.003944e-03 3 1  ON 29
ci_031                -7.717064e-03 3 1  ON 30
ci_032                -7.169103e-03 3 1  ON 31
ci_033                 5.144464e-03 3 1  ON 32
ci_034                 4.319965e-03 3 1  ON 33
ci_035                 8.853057e-04 3 1  ON 34
ci_036                 1.282679e-03 3 1  ON 35
ci_037                 5.377243e-03 3 1  ON 36
ci_038                 4.853867e-03 3 1  ON 37
ci_039                 5.182126e-03 3 1  ON 38
ci_040                 5.304913e-03 3 1  ON 39
ci_041                 4.972047e-03 3 1  ON 40
ci_042                 4.924157e-03 3 1  ON 41
ci_043                 4.867974e-03 3 1  ON 42
ci_044                 4.763129e-03 3 1  ON 43
ci_045                 3.279325e-03 3 1  ON 44
ci_046                 2.817985e-03 3 1  ON 45
ci_047                -7.438250e-04 3 1  ON 46
ci_048                -4.122906e-04 3 1  ON 47
ci_049                 1.335683e-03 3 1  ON 48
ci_050                 1.074032e-03 3 1  ON 49
ci_051                -1.563143e-03 3 1  ON 50
ci_052                -1.738688e-03 3 1  ON 51
ci_053                -2.042268e-03 3 1  ON 52
ci_054                -2.415705e-03 3 1  ON 53
ci_055                -1.614438e-03 3 1  ON 54
ci_056                -1.066031e-03 3 1  ON 55
ci_057                -1.374451e-03 3 1  ON 56
ci_058                -1.339971e-03 3 1  ON 57
ci_059                -1.018137e-04 3 1  ON 58
ci_060                 4.494675e-04 3 1  ON 59
ci_061                 1.457649e-05 3 1  ON 60
ci_062                -6.693351e-05 3 1  ON 61
ci_063                -2.687185e-04 3 1  ON 62
ci_064                -6.577667e-04 3 1  ON 63
ci_065                -2.492839e-03 3 1  ON 64
ci_066                -3.346335e-03 3 1  ON 65
ci_067                -2.259446e-03 3 1  ON 66
ci_068                -2.601180e-03 3 1  ON 67
ci_069                -2.787310e-04 3 1  ON 68
ci_070                 8.448187e-06 3 1  ON 69
ci_071                -2.102409e-03 3 1  ON 70
ci_072                -2.621165e-03 3 1  ON 71
ci_073                 3.540521e-04 3 1  ON 72
ci_074                 6.343504e-04 3 1  ON 73
ci_075                -1.044274e-03 3 1  ON 74
ci_076                -5.728630e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4780e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6424
    reference variance = 0.446654
====================================================
  Execution time = 2.6611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2167e-01
  Total weights = 1.954982239e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505265764343
                                         uncertainty =       0.009899302251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505265764343
                                         uncertainty =       0.009899302251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502564801
  error estimate for blocks of size 2^( 2) =       0.000520410380
  error estimate for blocks of size 2^( 3) =       0.000536519763
  error estimate for blocks of size 2^( 4) =       0.000548531743
  error estimate for blocks of size 2^( 5) =       0.000555393685
  error estimate for blocks of size 2^( 6) =       0.000558217254
  error estimate for blocks of size 2^( 7) =       0.000562638319

      target function =                  N/A
              le_mean =     -22.670143231322
             les_mean =     514.457063283983
             stat err =       0.000556195250
             autocorr =       1.224814771741
              std dev =       0.710733957774
             le_variance =       0.505142758734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267014323132e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670143231445       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670173420314       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670173658100       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670174923053       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670175215042       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 4.749994e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670143231445       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670155455013       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670154247221       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670154134245       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 1.468914e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670143231445       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670146847463       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670146293257       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670146243219       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 4.427525e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020194 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1996e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -7.063713e-01 3 1  ON 0
ci_002                -7.042474e-01 3 1  ON 1
ci_003                -4.066507e-02 3 1  ON 2
ci_004                -4.163798e-02 3 1  ON 3
ci_005                 1.627302e-02 3 1  ON 4
ci_006                 1.685117e-02 3 1  ON 5
ci_007                 1.238946e-02 3 1  ON 6
ci_008                 1.327778e-02 3 1  ON 7
ci_009                -1.187671e-02 3 1  ON 8
ci_010                -1.213480e-02 3 1  ON 9
ci_011                -8.684399e-03 3 1  ON 10
ci_012                -7.960248e-03 3 1  ON 11
ci_013                 9.047038e-03 3 1  ON 12
ci_014                 9.524196e-03 3 1  ON 13
ci_015                 1.205892e-02 3 1  ON 14
ci_016                 1.287277e-02 3 1  ON 15
ci_017                 1.036309e-02 3 1  ON 16
ci_018                 1.123493e-02 3 1  ON 17
ci_019                -2.276451e-03 3 1  ON 18
ci_020                -2.245281e-03 3 1  ON 19
ci_021                -8.214472e-03 3 1  ON 20
ci_022                -8.688947e-03 3 1  ON 21
ci_023                 8.749063e-03 3 1  ON 22
ci_024                 7.857961e-03 3 1  ON 23
ci_025                 3.500436e-03 3 1  ON 24
ci_026                 2.776680e-03 3 1  ON 25
ci_027                 6.733290e-03 3 1  ON 26
ci_028                 7.465461e-03 3 1  ON 27
ci_029                -4.583335e-03 3 1  ON 28
ci_030                -4.959887e-03 3 1  ON 29
ci_031                -7.757872e-03 3 1  ON 30
ci_032                -7.332315e-03 3 1  ON 31
ci_033                 5.004397e-03 3 1  ON 32
ci_034                 4.149094e-03 3 1  ON 33
ci_035                 1.654831e-04 3 1  ON 34
ci_036                 1.375060e-03 3 1  ON 35
ci_037                 5.210361e-03 3 1  ON 36
ci_038                 5.829631e-03 3 1  ON 37
ci_039                 5.377897e-03 3 1  ON 38
ci_040                 5.808568e-03 3 1  ON 39
ci_041                 4.972555e-03 3 1  ON 40
ci_042                 4.950408e-03 3 1  ON 41
ci_043                 4.956216e-03 3 1  ON 42
ci_044                 4.873799e-03 3 1  ON 43
ci_045                 3.188632e-03 3 1  ON 44
ci_046                 2.797657e-03 3 1  ON 45
ci_047                -4.864917e-04 3 1  ON 46
ci_048                 1.881103e-04 3 1  ON 47
ci_049                 1.281729e-03 3 1  ON 48
ci_050                 1.123445e-03 3 1  ON 49
ci_051                -1.665984e-03 3 1  ON 50
ci_052                -6.452218e-04 3 1  ON 51
ci_053                -1.741779e-03 3 1  ON 52
ci_054                -2.538582e-03 3 1  ON 53
ci_055                -1.375300e-03 3 1  ON 54
ci_056                -1.340083e-03 3 1  ON 55
ci_057                -1.567211e-03 3 1  ON 56
ci_058                -1.498053e-03 3 1  ON 57
ci_059                -1.512219e-04 3 1  ON 58
ci_060                 9.016713e-04 3 1  ON 59
ci_061                -3.936759e-04 3 1  ON 60
ci_062                 4.256932e-05 3 1  ON 61
ci_063                -7.892626e-04 3 1  ON 62
ci_064                 6.653164e-04 3 1  ON 63
ci_065                -2.780106e-03 3 1  ON 64
ci_066                -3.385371e-03 3 1  ON 65
ci_067                -2.018387e-03 3 1  ON 66
ci_068                -3.043940e-03 3 1  ON 67
ci_069                 1.976066e-04 3 1  ON 68
ci_070                -8.231390e-05 3 1  ON 69
ci_071                -2.081856e-03 3 1  ON 70
ci_072                -1.152251e-03 3 1  ON 71
ci_073                 7.487427e-04 3 1  ON 72
ci_074                 8.039897e-04 3 1  ON 73
ci_075                -1.149183e-03 3 1  ON 74
ci_076                -5.841349e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7003
    reference variance = 0.488796
====================================================
  Execution time = 2.5506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1183e-01
  Total weights = 1.9552e+06
  Execution time = 3.6378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499299717317
                                         uncertainty =       0.004231122953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499299717317
                                         uncertainty =       0.004231122953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499651206
  error estimate for blocks of size 2^( 2) =       0.000517429563
  error estimate for blocks of size 2^( 3) =       0.000533320696
  error estimate for blocks of size 2^( 4) =       0.000545310414
  error estimate for blocks of size 2^( 5) =       0.000552924510
  error estimate for blocks of size 2^( 6) =       0.000557153342
  error estimate for blocks of size 2^( 7) =       0.000559669639

      target function =                  N/A
              le_mean =     -22.668968200534
             les_mean =     514.439284508347
             stat err =       0.000553764476
             autocorr =       1.228333524669
              std dev =       0.706613511896
             le_variance =       0.499302655194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511978986960
                                         uncertainty =       0.011938525765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511978986960
                                         uncertainty =       0.011938525765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505932242
  error estimate for blocks of size 2^( 2) =       0.000523459896
  error estimate for blocks of size 2^( 3) =       0.000539098328
  error estimate for blocks of size 2^( 4) =       0.000550894762
  error estimate for blocks of size 2^( 5) =       0.000558372772
  error estimate for blocks of size 2^( 6) =       0.000562555102
  error estimate for blocks of size 2^( 7) =       0.000565047699

      target function =                  N/A
              le_mean =     -22.668954298460
             les_mean =     515.270705009931
             stat err =       0.000559217584
             autocorr =       1.221734740074
              std dev =       0.715496238351
             le_variance =       0.511934867094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500152836076
                                         uncertainty =       0.004481999028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500152836076
                                         uncertainty =       0.004481999028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500078000
  error estimate for blocks of size 2^( 2) =       0.000517804505
  error estimate for blocks of size 2^( 3) =       0.000533652163
  error estimate for blocks of size 2^( 4) =       0.000545598673
  error estimate for blocks of size 2^( 5) =       0.000553205503
  error estimate for blocks of size 2^( 6) =       0.000557299383
  error estimate for blocks of size 2^( 7) =       0.000559997562

      target function =                  N/A
              le_mean =     -22.668979953180
             les_mean =     514.421247231252
             stat err =       0.000554025280
             autocorr =       1.227393066632
              std dev =       0.707217090074
             le_variance =       0.500156012493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499292746161
                                         uncertainty =       0.004266707567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499292746161
                                         uncertainty =       0.004266707567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499647783
  error estimate for blocks of size 2^( 2) =       0.000517415008
  error estimate for blocks of size 2^( 3) =       0.000533300812
  error estimate for blocks of size 2^( 4) =       0.000545285146
  error estimate for blocks of size 2^( 5) =       0.000552899349
  error estimate for blocks of size 2^( 6) =       0.000557106305
  error estimate for blocks of size 2^( 7) =       0.000559646232

      target function =                  N/A
              le_mean =     -22.668954953334
             les_mean =     514.399866872766
             stat err =       0.000553734258
             autocorr =       1.228216298479
              std dev =       0.706608671365
             le_variance =       0.499295814449


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668968200534        initial
     1.5625e-01     1.5625e+00             4.7500e-03       -22.668954298460
     6.2500e-01     6.2500e+00             1.4689e-03       -22.668979953180  <--
     2.5000e+00     2.5000e+01             4.4275e-04       -22.668954953334

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.3766e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -7.063713e-01 3 1  ON 0
ci_002                -7.042474e-01 3 1  ON 1
ci_003                -4.066507e-02 3 1  ON 2
ci_004                -4.163798e-02 3 1  ON 3
ci_005                 1.627302e-02 3 1  ON 4
ci_006                 1.685117e-02 3 1  ON 5
ci_007                 1.238946e-02 3 1  ON 6
ci_008                 1.327778e-02 3 1  ON 7
ci_009                -1.187671e-02 3 1  ON 8
ci_010                -1.213480e-02 3 1  ON 9
ci_011                -8.684399e-03 3 1  ON 10
ci_012                -7.960248e-03 3 1  ON 11
ci_013                 9.047038e-03 3 1  ON 12
ci_014                 9.524196e-03 3 1  ON 13
ci_015                 1.205892e-02 3 1  ON 14
ci_016                 1.287277e-02 3 1  ON 15
ci_017                 1.036309e-02 3 1  ON 16
ci_018                 1.123493e-02 3 1  ON 17
ci_019                -2.276451e-03 3 1  ON 18
ci_020                -2.245281e-03 3 1  ON 19
ci_021                -8.214472e-03 3 1  ON 20
ci_022                -8.688947e-03 3 1  ON 21
ci_023                 8.749063e-03 3 1  ON 22
ci_024                 7.857961e-03 3 1  ON 23
ci_025                 3.500436e-03 3 1  ON 24
ci_026                 2.776680e-03 3 1  ON 25
ci_027                 6.733290e-03 3 1  ON 26
ci_028                 7.465461e-03 3 1  ON 27
ci_029                -4.583335e-03 3 1  ON 28
ci_030                -4.959887e-03 3 1  ON 29
ci_031                -7.757872e-03 3 1  ON 30
ci_032                -7.332315e-03 3 1  ON 31
ci_033                 5.004397e-03 3 1  ON 32
ci_034                 4.149094e-03 3 1  ON 33
ci_035                 1.654831e-04 3 1  ON 34
ci_036                 1.375060e-03 3 1  ON 35
ci_037                 5.210361e-03 3 1  ON 36
ci_038                 5.829631e-03 3 1  ON 37
ci_039                 5.377897e-03 3 1  ON 38
ci_040                 5.808568e-03 3 1  ON 39
ci_041                 4.972555e-03 3 1  ON 40
ci_042                 4.950408e-03 3 1  ON 41
ci_043                 4.956216e-03 3 1  ON 42
ci_044                 4.873799e-03 3 1  ON 43
ci_045                 3.188632e-03 3 1  ON 44
ci_046                 2.797657e-03 3 1  ON 45
ci_047                -4.864917e-04 3 1  ON 46
ci_048                 1.881103e-04 3 1  ON 47
ci_049                 1.281729e-03 3 1  ON 48
ci_050                 1.123445e-03 3 1  ON 49
ci_051                -1.665984e-03 3 1  ON 50
ci_052                -6.452218e-04 3 1  ON 51
ci_053                -1.741779e-03 3 1  ON 52
ci_054                -2.538582e-03 3 1  ON 53
ci_055                -1.375300e-03 3 1  ON 54
ci_056                -1.340083e-03 3 1  ON 55
ci_057                -1.567211e-03 3 1  ON 56
ci_058                -1.498053e-03 3 1  ON 57
ci_059                -1.512219e-04 3 1  ON 58
ci_060                 9.016713e-04 3 1  ON 59
ci_061                -3.936759e-04 3 1  ON 60
ci_062                 4.256932e-05 3 1  ON 61
ci_063                -7.892626e-04 3 1  ON 62
ci_064                 6.653164e-04 3 1  ON 63
ci_065                -2.780106e-03 3 1  ON 64
ci_066                -3.385371e-03 3 1  ON 65
ci_067                -2.018387e-03 3 1  ON 66
ci_068                -3.043940e-03 3 1  ON 67
ci_069                 1.976066e-04 3 1  ON 68
ci_070                -8.231390e-05 3 1  ON 69
ci_071                -2.081856e-03 3 1  ON 70
ci_072                -1.152251e-03 3 1  ON 71
ci_073                 7.487427e-04 3 1  ON 72
ci_074                 8.039897e-04 3 1  ON 73
ci_075                -1.149183e-03 3 1  ON 74
ci_076                -5.841349e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6316
    reference variance = 0.547979
====================================================
  Execution time = 2.6457e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1212e-01
  Total weights = 1.954906620e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494931979604
                                         uncertainty =       0.002790097564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494931979604
                                         uncertainty =       0.002790097564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497459600
  error estimate for blocks of size 2^( 2) =       0.000515464657
  error estimate for blocks of size 2^( 3) =       0.000531471501
  error estimate for blocks of size 2^( 4) =       0.000542925982
  error estimate for blocks of size 2^( 5) =       0.000550389464
  error estimate for blocks of size 2^( 6) =       0.000553059855
  error estimate for blocks of size 2^( 7) =       0.000555321660

      target function =                  N/A
              le_mean =     -22.669688165683
             les_mean =     514.426878673773
             stat err =       0.000550424240
             autocorr =       1.224276379514
              std dev =       0.703514113242
             le_variance =       0.494932107531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266968816568e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669688165782       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669724247452       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669721803279       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669722178698       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669722215617       residual = 8.31e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.550030e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669688165782       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669702806884       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669702562749       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669702722632       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 6.008878e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669688165782       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669692501443       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669692593826       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669692634196       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.748612e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1224e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -7.063282e-01 3 1  ON 0
ci_002                -7.043650e-01 3 1  ON 1
ci_003                -4.031373e-02 3 1  ON 2
ci_004                -4.124953e-02 3 1  ON 3
ci_005                 1.622337e-02 3 1  ON 4
ci_006                 1.657776e-02 3 1  ON 5
ci_007                 1.228230e-02 3 1  ON 6
ci_008                 1.273642e-02 3 1  ON 7
ci_009                -1.204771e-02 3 1  ON 8
ci_010                -1.179498e-02 3 1  ON 9
ci_011                -8.314875e-03 3 1  ON 10
ci_012                -7.890541e-03 3 1  ON 11
ci_013                 9.121794e-03 3 1  ON 12
ci_014                 9.801013e-03 3 1  ON 13
ci_015                 1.224302e-02 3 1  ON 14
ci_016                 1.264518e-02 3 1  ON 15
ci_017                 1.069531e-02 3 1  ON 16
ci_018                 1.129175e-02 3 1  ON 17
ci_019                -2.421665e-03 3 1  ON 18
ci_020                -1.814214e-03 3 1  ON 19
ci_021                -8.444075e-03 3 1  ON 20
ci_022                -8.640366e-03 3 1  ON 21
ci_023                 8.448361e-03 3 1  ON 22
ci_024                 7.658491e-03 3 1  ON 23
ci_025                 3.163326e-03 3 1  ON 24
ci_026                 2.767619e-03 3 1  ON 25
ci_027                 6.372281e-03 3 1  ON 26
ci_028                 7.050785e-03 3 1  ON 27
ci_029                -4.946758e-03 3 1  ON 28
ci_030                -4.832608e-03 3 1  ON 29
ci_031                -8.061583e-03 3 1  ON 30
ci_032                -6.976849e-03 3 1  ON 31
ci_033                 4.713195e-03 3 1  ON 32
ci_034                 4.272331e-03 3 1  ON 33
ci_035                 3.613991e-04 3 1  ON 34
ci_036                 1.580621e-03 3 1  ON 35
ci_037                 5.000924e-03 3 1  ON 36
ci_038                 5.686303e-03 3 1  ON 37
ci_039                 5.595909e-03 3 1  ON 38
ci_040                 5.766135e-03 3 1  ON 39
ci_041                 5.039553e-03 3 1  ON 40
ci_042                 4.967749e-03 3 1  ON 41
ci_043                 5.319753e-03 3 1  ON 42
ci_044                 4.720980e-03 3 1  ON 43
ci_045                 3.394385e-03 3 1  ON 44
ci_046                 3.002973e-03 3 1  ON 45
ci_047                -4.409231e-04 3 1  ON 46
ci_048                -1.016836e-04 3 1  ON 47
ci_049                 1.294504e-03 3 1  ON 48
ci_050                 1.496250e-03 3 1  ON 49
ci_051                -1.613400e-03 3 1  ON 50
ci_052                -1.124121e-03 3 1  ON 51
ci_053                -2.342667e-03 3 1  ON 52
ci_054                -2.595352e-03 3 1  ON 53
ci_055                -1.481949e-03 3 1  ON 54
ci_056                -1.767947e-03 3 1  ON 55
ci_057                -1.630646e-03 3 1  ON 56
ci_058                -1.331895e-03 3 1  ON 57
ci_059                 1.924925e-04 3 1  ON 58
ci_060                 7.834069e-04 3 1  ON 59
ci_061                -3.278781e-04 3 1  ON 60
ci_062                -3.223183e-05 3 1  ON 61
ci_063                -8.317918e-04 3 1  ON 62
ci_064                 3.087492e-04 3 1  ON 63
ci_065                -2.641156e-03 3 1  ON 64
ci_066                -3.025545e-03 3 1  ON 65
ci_067                -2.184701e-03 3 1  ON 66
ci_068                -2.563033e-03 3 1  ON 67
ci_069                -4.773291e-05 3 1  ON 68
ci_070                -2.980924e-04 3 1  ON 69
ci_071                -2.136815e-03 3 1  ON 70
ci_072                -1.349246e-03 3 1  ON 71
ci_073                 4.869627e-04 3 1  ON 72
ci_074                 6.887314e-04 3 1  ON 73
ci_075                -1.346725e-03 3 1  ON 74
ci_076                -4.756491e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6553
    reference variance = 0.620821
====================================================
  Execution time = 2.5815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0775e-01
  Total weights = 1.9554e+06
  Execution time = 3.6445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496087215452
                                         uncertainty =       0.002346162076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496087215452
                                         uncertainty =       0.002346162076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498003213
  error estimate for blocks of size 2^( 2) =       0.000515667176
  error estimate for blocks of size 2^( 3) =       0.000531926007
  error estimate for blocks of size 2^( 4) =       0.000544248145
  error estimate for blocks of size 2^( 5) =       0.000550368356
  error estimate for blocks of size 2^( 6) =       0.000554995183
  error estimate for blocks of size 2^( 7) =       0.000554933753

      target function =                  N/A
              le_mean =     -22.669431838139
             les_mean =     514.414134595166
             stat err =       0.000551136359
             autocorr =       1.224768014220
              std dev =       0.704282898345
             le_variance =       0.496014400901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496143948982
                                         uncertainty =       0.002303776488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496143948982
                                         uncertainty =       0.002303776488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498031628
  error estimate for blocks of size 2^( 2) =       0.000515692509
  error estimate for blocks of size 2^( 3) =       0.000531943347
  error estimate for blocks of size 2^( 4) =       0.000544266201
  error estimate for blocks of size 2^( 5) =       0.000550353481
  error estimate for blocks of size 2^( 6) =       0.000554950353
  error estimate for blocks of size 2^( 7) =       0.000554911181

      target function =                  N/A
              le_mean =     -22.669423040957
             les_mean =     514.414784349744
             stat err =       0.000551120304
             autocorr =       1.224556913091
              std dev =       0.704323083006
             le_variance =       0.496071005255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496055655725
                                         uncertainty =       0.002309348883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496055655725
                                         uncertainty =       0.002309348883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497987294
  error estimate for blocks of size 2^( 2) =       0.000515651687
  error estimate for blocks of size 2^( 3) =       0.000531905080
  error estimate for blocks of size 2^( 4) =       0.000544228146
  error estimate for blocks of size 2^( 5) =       0.000550322725
  error estimate for blocks of size 2^( 6) =       0.000554920959
  error estimate for blocks of size 2^( 7) =       0.000554880570

      target function =                  N/A
              le_mean =     -22.669417947109
             les_mean =     514.412040273828
             stat err =       0.000551088100
             autocorr =       1.224631828370
              std dev =       0.704260384903
             le_variance =       0.495982689744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496046906562
                                         uncertainty =       0.002339535853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496046906562
                                         uncertainty =       0.002339535853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497982981
  error estimate for blocks of size 2^( 2) =       0.000515646372
  error estimate for blocks of size 2^( 3) =       0.000531904095
  error estimate for blocks of size 2^( 4) =       0.000544225881
  error estimate for blocks of size 2^( 5) =       0.000550339346
  error estimate for blocks of size 2^( 6) =       0.000554963710
  error estimate for blocks of size 2^( 7) =       0.000554904088

      target function =                  N/A
              le_mean =     -22.669425457708
             les_mean =     514.411374366676
             stat err =       0.000551108256
             autocorr =       1.224742626291
              std dev =       0.704254285479
             le_variance =       0.495974098616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669431838139        initial  <--
     1.5625e-01     1.5625e+00             1.5500e-03       -22.669423040957
     6.2500e-01     6.2500e+00             6.0089e-04       -22.669417947109
     2.5000e+00     2.5000e+01             1.7486e-04       -22.669425457708

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0955
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -7.063713e-01 3 1  ON 0
ci_002                -7.042474e-01 3 1  ON 1
ci_003                -4.066507e-02 3 1  ON 2
ci_004                -4.163798e-02 3 1  ON 3
ci_005                 1.627302e-02 3 1  ON 4
ci_006                 1.685117e-02 3 1  ON 5
ci_007                 1.238946e-02 3 1  ON 6
ci_008                 1.327778e-02 3 1  ON 7
ci_009                -1.187671e-02 3 1  ON 8
ci_010                -1.213480e-02 3 1  ON 9
ci_011                -8.684399e-03 3 1  ON 10
ci_012                -7.960248e-03 3 1  ON 11
ci_013                 9.047038e-03 3 1  ON 12
ci_014                 9.524196e-03 3 1  ON 13
ci_015                 1.205892e-02 3 1  ON 14
ci_016                 1.287277e-02 3 1  ON 15
ci_017                 1.036309e-02 3 1  ON 16
ci_018                 1.123493e-02 3 1  ON 17
ci_019                -2.276451e-03 3 1  ON 18
ci_020                -2.245281e-03 3 1  ON 19
ci_021                -8.214472e-03 3 1  ON 20
ci_022                -8.688947e-03 3 1  ON 21
ci_023                 8.749063e-03 3 1  ON 22
ci_024                 7.857961e-03 3 1  ON 23
ci_025                 3.500436e-03 3 1  ON 24
ci_026                 2.776680e-03 3 1  ON 25
ci_027                 6.733290e-03 3 1  ON 26
ci_028                 7.465461e-03 3 1  ON 27
ci_029                -4.583335e-03 3 1  ON 28
ci_030                -4.959887e-03 3 1  ON 29
ci_031                -7.757872e-03 3 1  ON 30
ci_032                -7.332315e-03 3 1  ON 31
ci_033                 5.004397e-03 3 1  ON 32
ci_034                 4.149094e-03 3 1  ON 33
ci_035                 1.654831e-04 3 1  ON 34
ci_036                 1.375060e-03 3 1  ON 35
ci_037                 5.210361e-03 3 1  ON 36
ci_038                 5.829631e-03 3 1  ON 37
ci_039                 5.377897e-03 3 1  ON 38
ci_040                 5.808568e-03 3 1  ON 39
ci_041                 4.972555e-03 3 1  ON 40
ci_042                 4.950408e-03 3 1  ON 41
ci_043                 4.956216e-03 3 1  ON 42
ci_044                 4.873799e-03 3 1  ON 43
ci_045                 3.188632e-03 3 1  ON 44
ci_046                 2.797657e-03 3 1  ON 45
ci_047                -4.864917e-04 3 1  ON 46
ci_048                 1.881103e-04 3 1  ON 47
ci_049                 1.281729e-03 3 1  ON 48
ci_050                 1.123445e-03 3 1  ON 49
ci_051                -1.665984e-03 3 1  ON 50
ci_052                -6.452218e-04 3 1  ON 51
ci_053                -1.741779e-03 3 1  ON 52
ci_054                -2.538582e-03 3 1  ON 53
ci_055                -1.375300e-03 3 1  ON 54
ci_056                -1.340083e-03 3 1  ON 55
ci_057                -1.567211e-03 3 1  ON 56
ci_058                -1.498053e-03 3 1  ON 57
ci_059                -1.512219e-04 3 1  ON 58
ci_060                 9.016713e-04 3 1  ON 59
ci_061                -3.936759e-04 3 1  ON 60
ci_062                 4.256932e-05 3 1  ON 61
ci_063                -7.892626e-04 3 1  ON 62
ci_064                 6.653164e-04 3 1  ON 63
ci_065                -2.780106e-03 3 1  ON 64
ci_066                -3.385371e-03 3 1  ON 65
ci_067                -2.018387e-03 3 1  ON 66
ci_068                -3.043940e-03 3 1  ON 67
ci_069                 1.976066e-04 3 1  ON 68
ci_070                -8.231390e-05 3 1  ON 69
ci_071                -2.081856e-03 3 1  ON 70
ci_072                -1.152251e-03 3 1  ON 71
ci_073                 7.487427e-04 3 1  ON 72
ci_074                 8.039897e-04 3 1  ON 73
ci_075                -1.149183e-03 3 1  ON 74
ci_076                -5.841349e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5326e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8305
    reference variance = 0.930809
====================================================
  Execution time = 2.6515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1264e-01
  Total weights = 1.955180300e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500700735414
                                         uncertainty =       0.003109240203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500700735414
                                         uncertainty =       0.003109240203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500357200
  error estimate for blocks of size 2^( 2) =       0.000518242694
  error estimate for blocks of size 2^( 3) =       0.000533860800
  error estimate for blocks of size 2^( 4) =       0.000545310732
  error estimate for blocks of size 2^( 5) =       0.000551948750
  error estimate for blocks of size 2^( 6) =       0.000554560428
  error estimate for blocks of size 2^( 7) =       0.000556909733

      target function =                  N/A
              le_mean =     -22.669728410936
             les_mean =     514.429228233827
             stat err =       0.000552182411
             autocorr =       1.217880930417
              std dev =       0.707611937800
             le_variance =       0.500714654517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266972841094e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669728411044       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669732342368       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669732435392       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669732452249       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.414395e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669728411044       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669729473237       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669729506478       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669729510661       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 6.518334e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669728411044       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669728682063       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669728691179       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669728692334       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 1.662846e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1261e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -7.063481e-01 3 1  ON 0
ci_002                -7.042806e-01 3 1  ON 1
ci_003                -4.062794e-02 3 1  ON 2
ci_004                -4.159844e-02 3 1  ON 3
ci_005                 1.626931e-02 3 1  ON 4
ci_006                 1.683115e-02 3 1  ON 5
ci_007                 1.236545e-02 3 1  ON 6
ci_008                 1.323537e-02 3 1  ON 7
ci_009                -1.187405e-02 3 1  ON 8
ci_010                -1.211234e-02 3 1  ON 9
ci_011                -8.657059e-03 3 1  ON 10
ci_012                -7.966173e-03 3 1  ON 11
ci_013                 9.049717e-03 3 1  ON 12
ci_014                 9.548709e-03 3 1  ON 13
ci_015                 1.205505e-02 3 1  ON 14
ci_016                 1.284552e-02 3 1  ON 15
ci_017                 1.035175e-02 3 1  ON 16
ci_018                 1.122298e-02 3 1  ON 17
ci_019                -2.292002e-03 3 1  ON 18
ci_020                -2.241500e-03 3 1  ON 19
ci_021                -8.239045e-03 3 1  ON 20
ci_022                -8.681898e-03 3 1  ON 21
ci_023                 8.694084e-03 3 1  ON 22
ci_024                 7.833568e-03 3 1  ON 23
ci_025                 3.493241e-03 3 1  ON 24
ci_026                 2.823543e-03 3 1  ON 25
ci_027                 6.673668e-03 3 1  ON 26
ci_028                 7.408576e-03 3 1  ON 27
ci_029                -4.588629e-03 3 1  ON 28
ci_030                -4.949799e-03 3 1  ON 29
ci_031                -7.741242e-03 3 1  ON 30
ci_032                -7.307371e-03 3 1  ON 31
ci_033                 4.973504e-03 3 1  ON 32
ci_034                 4.159348e-03 3 1  ON 33
ci_035                 2.228479e-04 3 1  ON 34
ci_036                 1.388262e-03 3 1  ON 35
ci_037                 5.205547e-03 3 1  ON 36
ci_038                 5.826732e-03 3 1  ON 37
ci_039                 5.380721e-03 3 1  ON 38
ci_040                 5.800103e-03 3 1  ON 39
ci_041                 4.993901e-03 3 1  ON 40
ci_042                 4.962592e-03 3 1  ON 41
ci_043                 4.950904e-03 3 1  ON 42
ci_044                 4.892449e-03 3 1  ON 43
ci_045                 3.123448e-03 3 1  ON 44
ci_046                 2.821035e-03 3 1  ON 45
ci_047                -5.003277e-04 3 1  ON 46
ci_048                 1.845956e-04 3 1  ON 47
ci_049                 1.298198e-03 3 1  ON 48
ci_050                 1.121326e-03 3 1  ON 49
ci_051                -1.678983e-03 3 1  ON 50
ci_052                -6.757930e-04 3 1  ON 51
ci_053                -1.801604e-03 3 1  ON 52
ci_054                -2.574487e-03 3 1  ON 53
ci_055                -1.363621e-03 3 1  ON 54
ci_056                -1.300351e-03 3 1  ON 55
ci_057                -1.542053e-03 3 1  ON 56
ci_058                -1.481280e-03 3 1  ON 57
ci_059                -1.319571e-04 3 1  ON 58
ci_060                 8.637533e-04 3 1  ON 59
ci_061                -4.043142e-04 3 1  ON 60
ci_062                 3.541084e-05 3 1  ON 61
ci_063                -8.098736e-04 3 1  ON 62
ci_064                 6.169203e-04 3 1  ON 63
ci_065                -2.789689e-03 3 1  ON 64
ci_066                -3.361095e-03 3 1  ON 65
ci_067                -2.023436e-03 3 1  ON 66
ci_068                -3.030708e-03 3 1  ON 67
ci_069                 2.011959e-04 3 1  ON 68
ci_070                -5.523261e-05 3 1  ON 69
ci_071                -2.078533e-03 3 1  ON 70
ci_072                -1.160593e-03 3 1  ON 71
ci_073                 7.378911e-04 3 1  ON 72
ci_074                 7.572644e-04 3 1  ON 73
ci_075                -1.129609e-03 3 1  ON 74
ci_076                -5.886071e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.5613
    reference variance = 0.465882
====================================================
  Execution time = 2.5605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1104e-01
  Total weights = 1.9552e+06
  Execution time = 3.6417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497554229397
                                         uncertainty =       0.003555733699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497554229397
                                         uncertainty =       0.003555733699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498717808
  error estimate for blocks of size 2^( 2) =       0.000517413563
  error estimate for blocks of size 2^( 3) =       0.000533191532
  error estimate for blocks of size 2^( 4) =       0.000544858199
  error estimate for blocks of size 2^( 5) =       0.000552099395
  error estimate for blocks of size 2^( 6) =       0.000556326121
  error estimate for blocks of size 2^( 7) =       0.000557659390

      target function =                  N/A
              le_mean =     -22.668547406613
             les_mean =     514.375282537539
             stat err =       0.000552735776
             autocorr =       1.228359245552
              std dev =       0.705293487775
             le_variance =       0.497438903898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497556328572
                                         uncertainty =       0.003567629954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497556328572
                                         uncertainty =       0.003567629954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498718880
  error estimate for blocks of size 2^( 2) =       0.000517416172
  error estimate for blocks of size 2^( 3) =       0.000533196717
  error estimate for blocks of size 2^( 4) =       0.000544863179
  error estimate for blocks of size 2^( 5) =       0.000552108400
  error estimate for blocks of size 2^( 6) =       0.000556343786
  error estimate for blocks of size 2^( 7) =       0.000557672323

      target function =                  N/A
              le_mean =     -22.668547617499
             les_mean =     514.374101813251
             stat err =       0.000552746922
             autocorr =       1.228403505929
              std dev =       0.705295003337
             le_variance =       0.497441041732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497552233374
                                         uncertainty =       0.003562032429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497552233374
                                         uncertainty =       0.003562032429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498716820
  error estimate for blocks of size 2^( 2) =       0.000517413377
  error estimate for blocks of size 2^( 3) =       0.000533192793
  error estimate for blocks of size 2^( 4) =       0.000544859453
  error estimate for blocks of size 2^( 5) =       0.000552102911
  error estimate for blocks of size 2^( 6) =       0.000556334396
  error estimate for blocks of size 2^( 7) =       0.000557665086

      target function =                  N/A
              le_mean =     -22.668547295243
             les_mean =     514.373837649317
             stat err =       0.000552740461
             autocorr =       1.228384936332
              std dev =       0.705292090634
             le_variance =       0.497436933110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497555155598
                                         uncertainty =       0.003556623077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497555155598
                                         uncertainty =       0.003556623077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498718273
  error estimate for blocks of size 2^( 2) =       0.000517414208
  error estimate for blocks of size 2^( 3) =       0.000533191476
  error estimate for blocks of size 2^( 4) =       0.000544856610
  error estimate for blocks of size 2^( 5) =       0.000552097497
  error estimate for blocks of size 2^( 6) =       0.000556322870
  error estimate for blocks of size 2^( 7) =       0.000557654960

      target function =                  N/A
              le_mean =     -22.668546257540
             les_mean =     514.651725100489
             stat err =       0.000552732984
             autocorr =       1.228344545281
              std dev =       0.705294145289
             le_variance =       0.497439831379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668547406613        initial
     1.5625e+00     1.5625e+01             2.4144e-04       -22.668547617499  <--
     6.2500e+00     6.2500e+01             6.5183e-05       -22.668547295243
     2.5000e+01     2.5000e+02             1.6628e-05       -22.668546257540

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 4.3870e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -7.062773e-01 3 1  ON 0
ci_002                -7.043789e-01 3 1  ON 1
ci_003                -4.052180e-02 3 1  ON 2
ci_004                -4.148383e-02 3 1  ON 3
ci_005                 1.626071e-02 3 1  ON 4
ci_006                 1.677943e-02 3 1  ON 5
ci_007                 1.230166e-02 3 1  ON 6
ci_008                 1.312168e-02 3 1  ON 7
ci_009                -1.186854e-02 3 1  ON 8
ci_010                -1.205169e-02 3 1  ON 9
ci_011                -8.579959e-03 3 1  ON 10
ci_012                -7.982827e-03 3 1  ON 11
ci_013                 9.056715e-03 3 1  ON 12
ci_014                 9.615709e-03 3 1  ON 13
ci_015                 1.204435e-02 3 1  ON 14
ci_016                 1.276917e-02 3 1  ON 15
ci_017                 1.032237e-02 3 1  ON 16
ci_018                 1.118947e-02 3 1  ON 17
ci_019                -2.335575e-03 3 1  ON 18
ci_020                -2.233141e-03 3 1  ON 19
ci_021                -8.309273e-03 3 1  ON 20
ci_022                -8.663956e-03 3 1  ON 21
ci_023                 8.547522e-03 3 1  ON 22
ci_024                 7.768818e-03 3 1  ON 23
ci_025                 3.474207e-03 3 1  ON 24
ci_026                 2.953618e-03 3 1  ON 25
ci_027                 6.521487e-03 3 1  ON 26
ci_028                 7.263441e-03 3 1  ON 27
ci_029                -4.602852e-03 3 1  ON 28
ci_030                -4.922988e-03 3 1  ON 29
ci_031                -7.693771e-03 3 1  ON 30
ci_032                -7.238396e-03 3 1  ON 31
ci_033                 4.890646e-03 3 1  ON 32
ci_034                 4.186915e-03 3 1  ON 33
ci_035                 3.682965e-04 3 1  ON 34
ci_036                 1.420971e-03 3 1  ON 35
ci_037                 5.192513e-03 3 1  ON 36
ci_038                 5.820247e-03 3 1  ON 37
ci_039                 5.388495e-03 3 1  ON 38
ci_040                 5.779030e-03 3 1  ON 39
ci_041                 5.050873e-03 3 1  ON 40
ci_042                 4.995436e-03 3 1  ON 41
ci_043                 4.935824e-03 3 1  ON 42
ci_044                 4.943486e-03 3 1  ON 43
ci_045                 2.947192e-03 3 1  ON 44
ci_046                 2.885019e-03 3 1  ON 45
ci_047                -5.343790e-04 3 1  ON 46
ci_048                 1.762797e-04 3 1  ON 47
ci_049                 1.342911e-03 3 1  ON 48
ci_050                 1.114801e-03 3 1  ON 49
ci_051                -1.713596e-03 3 1  ON 50
ci_052                -7.579154e-04 3 1  ON 51
ci_053                -1.966026e-03 3 1  ON 52
ci_054                -2.672759e-03 3 1  ON 53
ci_055                -1.331026e-03 3 1  ON 54
ci_056                -1.190295e-03 3 1  ON 55
ci_057                -1.474860e-03 3 1  ON 56
ci_058                -1.437102e-03 3 1  ON 57
ci_059                -8.131222e-05 3 1  ON 58
ci_060                 7.667082e-04 3 1  ON 59
ci_061                -4.347009e-04 3 1  ON 60
ci_062                 1.534307e-05 3 1  ON 61
ci_063                -8.658033e-04 3 1  ON 62
ci_064                 4.850702e-04 3 1  ON 63
ci_065                -2.815268e-03 3 1  ON 64
ci_066                -3.295754e-03 3 1  ON 65
ci_067                -2.037518e-03 3 1  ON 66
ci_068                -2.995289e-03 3 1  ON 67
ci_069                 2.112849e-04 3 1  ON 68
ci_070                 1.744670e-05 3 1  ON 69
ci_071                -2.068773e-03 3 1  ON 70
ci_072                -1.181698e-03 3 1  ON 71
ci_073                 7.095286e-04 3 1  ON 72
ci_074                 6.384125e-04 3 1  ON 73
ci_075                -1.076712e-03 3 1  ON 74
ci_076                -6.015189e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5138e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6911
    reference variance = 0.27734
====================================================
  Execution time = 2.6304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1157e-01
  Total weights = 1.954969770e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496995647458
                                         uncertainty =       0.002779255354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496995647458
                                         uncertainty =       0.002779255354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498585341
  error estimate for blocks of size 2^( 2) =       0.000516892970
  error estimate for blocks of size 2^( 3) =       0.000533339649
  error estimate for blocks of size 2^( 4) =       0.000545692138
  error estimate for blocks of size 2^( 5) =       0.000552431195
  error estimate for blocks of size 2^( 6) =       0.000554970722
  error estimate for blocks of size 2^( 7) =       0.000557281340

      target function =                  N/A
              le_mean =     -22.669580254341
             les_mean =     514.421436775916
             stat err =       0.000552593849
             autocorr =       1.228380974350
              std dev =       0.705106151026
             le_variance =       0.497174684214


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266958025434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669580254447       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669591640091       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669591956251       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669591923271       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 8.414463e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669580254447       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669583960560       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669584178538       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669584155461       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.951891e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669580254447       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669581256649       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669581329694       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669581327301       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.193298e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024293 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1043e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -7.062703e-01 3 1  ON 0
ci_002                -7.044011e-01 3 1  ON 1
ci_003                -4.045182e-02 3 1  ON 2
ci_004                -4.135002e-02 3 1  ON 3
ci_005                 1.618602e-02 3 1  ON 4
ci_006                 1.648424e-02 3 1  ON 5
ci_007                 1.241326e-02 3 1  ON 6
ci_008                 1.305392e-02 3 1  ON 7
ci_009                -1.201631e-02 3 1  ON 8
ci_010                -1.202018e-02 3 1  ON 9
ci_011                -8.547688e-03 3 1  ON 10
ci_012                -8.114767e-03 3 1  ON 11
ci_013                 9.036984e-03 3 1  ON 12
ci_014                 9.426110e-03 3 1  ON 13
ci_015                 1.216880e-02 3 1  ON 14
ci_016                 1.284881e-02 3 1  ON 15
ci_017                 1.027420e-02 3 1  ON 16
ci_018                 1.104143e-02 3 1  ON 17
ci_019                -2.342846e-03 3 1  ON 18
ci_020                -2.269591e-03 3 1  ON 19
ci_021                -8.397650e-03 3 1  ON 20
ci_022                -8.811128e-03 3 1  ON 21
ci_023                 8.613286e-03 3 1  ON 22
ci_024                 7.613909e-03 3 1  ON 23
ci_025                 3.487175e-03 3 1  ON 24
ci_026                 3.121284e-03 3 1  ON 25
ci_027                 6.592802e-03 3 1  ON 26
ci_028                 7.148883e-03 3 1  ON 27
ci_029                -4.550606e-03 3 1  ON 28
ci_030                -5.047579e-03 3 1  ON 29
ci_031                -7.695686e-03 3 1  ON 30
ci_032                -7.392153e-03 3 1  ON 31
ci_033                 4.941909e-03 3 1  ON 32
ci_034                 4.088181e-03 3 1  ON 33
ci_035                 5.699155e-04 3 1  ON 34
ci_036                 1.367739e-03 3 1  ON 35
ci_037                 5.176149e-03 3 1  ON 36
ci_038                 5.837843e-03 3 1  ON 37
ci_039                 5.332259e-03 3 1  ON 38
ci_040                 5.662068e-03 3 1  ON 39
ci_041                 5.072957e-03 3 1  ON 40
ci_042                 4.907245e-03 3 1  ON 41
ci_043                 4.968116e-03 3 1  ON 42
ci_044                 5.032102e-03 3 1  ON 43
ci_045                 2.992310e-03 3 1  ON 44
ci_046                 2.804039e-03 3 1  ON 45
ci_047                -5.767982e-04 3 1  ON 46
ci_048                 1.194188e-04 3 1  ON 47
ci_049                 1.380649e-03 3 1  ON 48
ci_050                 1.071480e-03 3 1  ON 49
ci_051                -1.720596e-03 3 1  ON 50
ci_052                -8.038439e-04 3 1  ON 51
ci_053                -2.189477e-03 3 1  ON 52
ci_054                -2.560000e-03 3 1  ON 53
ci_055                -1.486676e-03 3 1  ON 54
ci_056                -1.194831e-03 3 1  ON 55
ci_057                -1.497732e-03 3 1  ON 56
ci_058                -1.318150e-03 3 1  ON 57
ci_059                -1.049383e-04 3 1  ON 58
ci_060                 6.801829e-04 3 1  ON 59
ci_061                -3.614146e-04 3 1  ON 60
ci_062                -1.696746e-04 3 1  ON 61
ci_063                -8.939781e-04 3 1  ON 62
ci_064                 3.029753e-04 3 1  ON 63
ci_065                -2.893606e-03 3 1  ON 64
ci_066                -3.323124e-03 3 1  ON 65
ci_067                -1.963469e-03 3 1  ON 66
ci_068                -3.127324e-03 3 1  ON 67
ci_069                 1.859302e-04 3 1  ON 68
ci_070                -1.352194e-04 3 1  ON 69
ci_071                -2.238681e-03 3 1  ON 70
ci_072                -1.211262e-03 3 1  ON 71
ci_073                 5.792522e-04 3 1  ON 72
ci_074                 3.850267e-04 3 1  ON 73
ci_075                -1.002819e-03 3 1  ON 74
ci_076                -5.788200e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.9413
    reference variance = 3.11779
====================================================
  Execution time = 2.5645e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1189e-01
  Total weights = 1.9554e+06
  Execution time = 3.6467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499304387276
                                         uncertainty =       0.003571269139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499304387276
                                         uncertainty =       0.003571269139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499719799
  error estimate for blocks of size 2^( 2) =       0.000517478983
  error estimate for blocks of size 2^( 3) =       0.000533350563
  error estimate for blocks of size 2^( 4) =       0.000545335536
  error estimate for blocks of size 2^( 5) =       0.000552364890
  error estimate for blocks of size 2^( 6) =       0.000555763684
  error estimate for blocks of size 2^( 7) =       0.000559134007

      target function =                  N/A
              le_mean =     -22.668555357364
             les_mean =     514.398525236963
             stat err =       0.000553149529
             autocorr =       1.225270511638
              std dev =       0.706710516740
             le_variance =       0.499439754471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499149917953
                                         uncertainty =       0.003565211589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499149917953
                                         uncertainty =       0.003565211589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499641659
  error estimate for blocks of size 2^( 2) =       0.000517420372
  error estimate for blocks of size 2^( 3) =       0.000533291383
  error estimate for blocks of size 2^( 4) =       0.000545287921
  error estimate for blocks of size 2^( 5) =       0.000552302755
  error estimate for blocks of size 2^( 6) =       0.000555712051
  error estimate for blocks of size 2^( 7) =       0.000559095351

      target function =                  N/A
              le_mean =     -22.668556303852
             les_mean =     514.378333103510
             stat err =       0.000553099520
             autocorr =       1.225432175133
              std dev =       0.706600010563
             le_variance =       0.499283574928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499182136593
                                         uncertainty =       0.003567484041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499182136593
                                         uncertainty =       0.003567484041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499658153
  error estimate for blocks of size 2^( 2) =       0.000517430957
  error estimate for blocks of size 2^( 3) =       0.000533301702
  error estimate for blocks of size 2^( 4) =       0.000545293771
  error estimate for blocks of size 2^( 5) =       0.000552314609
  error estimate for blocks of size 2^( 6) =       0.000555719166
  error estimate for blocks of size 2^( 7) =       0.000559100797

      target function =                  N/A
              le_mean =     -22.668554423070
             les_mean =     514.377342561883
             stat err =       0.000553107086
             autocorr =       1.225384794878
              std dev =       0.706623337042
             le_variance =       0.499316540453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499277577101
                                         uncertainty =       0.003570446806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499277577101
                                         uncertainty =       0.003570446806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499706322
  error estimate for blocks of size 2^( 2) =       0.000517466979
  error estimate for blocks of size 2^( 3) =       0.000533338276
  error estimate for blocks of size 2^( 4) =       0.000545325360
  error estimate for blocks of size 2^( 5) =       0.000552353611
  error estimate for blocks of size 2^( 6) =       0.000555758602
  error estimate for blocks of size 2^( 7) =       0.000559136536

      target function =                  N/A
              le_mean =     -22.668555780989
             les_mean =     514.375842507868
             stat err =       0.000553143528
             autocorr =       1.225310010569
              std dev =       0.706691458117
             le_variance =       0.499412816976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668555357364        initial
     3.9062e-01     3.9062e+00             8.4145e-04       -22.668556303852  <--
     1.5625e+00     1.5625e+01             2.9519e-04       -22.668554423070
     6.2500e+00     6.2500e+01             8.1933e-05       -22.668555780989

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.3926e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -7.062663e-01 3 1  ON 0
ci_002                -7.044389e-01 3 1  ON 1
ci_003                -4.027131e-02 3 1  ON 2
ci_004                -4.099555e-02 3 1  ON 3
ci_005                 1.604626e-02 3 1  ON 4
ci_006                 1.593799e-02 3 1  ON 5
ci_007                 1.266527e-02 3 1  ON 6
ci_008                 1.292324e-02 3 1  ON 7
ci_009                -1.233945e-02 3 1  ON 8
ci_010                -1.197369e-02 3 1  ON 9
ci_011                -8.463379e-03 3 1  ON 10
ci_012                -8.429292e-03 3 1  ON 11
ci_013                 8.995283e-03 3 1  ON 12
ci_014                 8.989493e-03 3 1  ON 13
ci_015                 1.246433e-02 3 1  ON 14
ci_016                 1.303680e-02 3 1  ON 15
ci_017                 1.014190e-02 3 1  ON 16
ci_018                 1.069029e-02 3 1  ON 17
ci_019                -2.359430e-03 3 1  ON 18
ci_020                -2.376031e-03 3 1  ON 19
ci_021                -8.599676e-03 3 1  ON 20
ci_022                -9.132253e-03 3 1  ON 21
ci_023                 8.746512e-03 3 1  ON 22
ci_024                 7.307160e-03 3 1  ON 23
ci_025                 3.511743e-03 3 1  ON 24
ci_026                 3.513759e-03 3 1  ON 25
ci_027                 6.719545e-03 3 1  ON 26
ci_028                 6.957191e-03 3 1  ON 27
ci_029                -4.442340e-03 3 1  ON 28
ci_030                -5.306765e-03 3 1  ON 29
ci_031                -7.689177e-03 3 1  ON 30
ci_032                -7.722062e-03 3 1  ON 31
ci_033                 5.050910e-03 3 1  ON 32
ci_034                 3.878973e-03 3 1  ON 33
ci_035                 9.200559e-04 3 1  ON 34
ci_036                 1.263816e-03 3 1  ON 35
ci_037                 5.143037e-03 3 1  ON 36
ci_038                 5.860598e-03 3 1  ON 37
ci_039                 5.227875e-03 3 1  ON 38
ci_040                 5.461352e-03 3 1  ON 39
ci_041                 5.119818e-03 3 1  ON 40
ci_042                 4.743307e-03 3 1  ON 41
ci_043                 5.036451e-03 3 1  ON 42
ci_044                 5.212024e-03 3 1  ON 43
ci_045                 3.085893e-03 3 1  ON 44
ci_046                 2.639673e-03 3 1  ON 45
ci_047                -6.498528e-04 3 1  ON 46
ci_048                 2.058539e-05 3 1  ON 47
ci_049                 1.465749e-03 3 1  ON 48
ci_050                 9.791576e-04 3 1  ON 49
ci_051                -1.733758e-03 3 1  ON 50
ci_052                -8.988454e-04 3 1  ON 51
ci_053                -2.677521e-03 3 1  ON 52
ci_054                -2.284037e-03 3 1  ON 53
ci_055                -1.823267e-03 3 1  ON 54
ci_056                -1.193728e-03 3 1  ON 55
ci_057                -1.545759e-03 3 1  ON 56
ci_058                -1.074120e-03 3 1  ON 57
ci_059                -1.381562e-04 3 1  ON 58
ci_060                 5.330571e-04 3 1  ON 59
ci_061                -2.005991e-04 3 1  ON 60
ci_062                -5.500929e-04 3 1  ON 61
ci_063                -9.571257e-04 3 1  ON 62
ci_064                -1.112375e-04 3 1  ON 63
ci_065                -3.074996e-03 3 1  ON 64
ci_066                -3.358773e-03 3 1  ON 65
ci_067                -1.795830e-03 3 1  ON 66
ci_068                -3.414113e-03 3 1  ON 67
ci_069                 1.386456e-04 3 1  ON 68
ci_070                -4.531182e-04 3 1  ON 69
ci_071                -2.601428e-03 3 1  ON 70
ci_072                -1.263257e-03 3 1  ON 71
ci_073                 3.489691e-04 3 1  ON 72
ci_074                -6.190941e-05 3 1  ON 73
ci_075                -8.526499e-04 3 1  ON 74
ci_076                -5.271775e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6709
    reference variance = 0.653619
====================================================
  Execution time = 2.7198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0695e-01
  Total weights = 1.955193437e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.1056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494984642649
                                         uncertainty =       0.003518953285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494984642649
                                         uncertainty =       0.003518953285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497515083
  error estimate for blocks of size 2^( 2) =       0.000515674160
  error estimate for blocks of size 2^( 3) =       0.000531013484
  error estimate for blocks of size 2^( 4) =       0.000542118744
  error estimate for blocks of size 2^( 5) =       0.000549310658
  error estimate for blocks of size 2^( 6) =       0.000554530645
  error estimate for blocks of size 2^( 7) =       0.000555868648

      target function =                  N/A
              le_mean =     -22.669720407541
             les_mean =     514.423175635863
             stat err =       0.000550457174
             autocorr =       1.224149809054
              std dev =       0.703592577761
             le_variance =       0.495042515480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266972040754e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669720407637       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669732002807       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669731599670       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669731000475       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669731535971       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 4.484613e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669720407637       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669725675458       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669725648108       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669725591184       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.942818e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669720407637       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669722062749       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669722121881       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669722119988       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 5.955598e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2310e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -7.062417e-01 3 1  ON 0
ci_002                -7.045321e-01 3 1  ON 1
ci_003                -4.039725e-02 3 1  ON 2
ci_004                -4.030813e-02 3 1  ON 3
ci_005                 1.610441e-02 3 1  ON 4
ci_006                 1.559885e-02 3 1  ON 5
ci_007                 1.245887e-02 3 1  ON 6
ci_008                 1.239831e-02 3 1  ON 7
ci_009                -1.217132e-02 3 1  ON 8
ci_010                -1.210016e-02 3 1  ON 9
ci_011                -8.471469e-03 3 1  ON 10
ci_012                -8.307286e-03 3 1  ON 11
ci_013                 9.089540e-03 3 1  ON 12
ci_014                 7.879870e-03 3 1  ON 13
ci_015                 1.210661e-02 3 1  ON 14
ci_016                 1.291080e-02 3 1  ON 15
ci_017                 1.016837e-02 3 1  ON 16
ci_018                 1.109243e-02 3 1  ON 17
ci_019                -2.430562e-03 3 1  ON 18
ci_020                -2.632446e-03 3 1  ON 19
ci_021                -8.270706e-03 3 1  ON 20
ci_022                -9.491483e-03 3 1  ON 21
ci_023                 8.660529e-03 3 1  ON 22
ci_024                 7.599830e-03 3 1  ON 23
ci_025                 4.302177e-03 3 1  ON 24
ci_026                 4.274609e-03 3 1  ON 25
ci_027                 6.703204e-03 3 1  ON 26
ci_028                 6.777269e-03 3 1  ON 27
ci_029                -4.281829e-03 3 1  ON 28
ci_030                -5.230164e-03 3 1  ON 29
ci_031                -7.687429e-03 3 1  ON 30
ci_032                -7.490763e-03 3 1  ON 31
ci_033                 4.601162e-03 3 1  ON 32
ci_034                 3.824284e-03 3 1  ON 33
ci_035                 9.931769e-04 3 1  ON 34
ci_036                 1.725244e-03 3 1  ON 35
ci_037                 5.231315e-03 3 1  ON 36
ci_038                 5.208352e-03 3 1  ON 37
ci_039                 5.097751e-03 3 1  ON 38
ci_040                 5.696206e-03 3 1  ON 39
ci_041                 5.382303e-03 3 1  ON 40
ci_042                 4.941201e-03 3 1  ON 41
ci_043                 5.014074e-03 3 1  ON 42
ci_044                 5.400902e-03 3 1  ON 43
ci_045                 3.687961e-03 3 1  ON 44
ci_046                 2.731371e-03 3 1  ON 45
ci_047                -6.877302e-04 3 1  ON 46
ci_048                -2.796061e-04 3 1  ON 47
ci_049                 1.402493e-03 3 1  ON 48
ci_050                 8.794247e-04 3 1  ON 49
ci_051                -1.506446e-03 3 1  ON 50
ci_052                -1.122397e-03 3 1  ON 51
ci_053                -2.491980e-03 3 1  ON 52
ci_054                -3.047004e-03 3 1  ON 53
ci_055                -1.878324e-03 3 1  ON 54
ci_056                -1.145059e-03 3 1  ON 55
ci_057                -1.747967e-03 3 1  ON 56
ci_058                -1.063369e-03 3 1  ON 57
ci_059                -2.347850e-04 3 1  ON 58
ci_060                -1.705696e-04 3 1  ON 59
ci_061                -2.449627e-05 3 1  ON 60
ci_062                 5.918909e-05 3 1  ON 61
ci_063                -1.361192e-03 3 1  ON 62
ci_064                -2.054055e-03 3 1  ON 63
ci_065                -2.883315e-03 3 1  ON 64
ci_066                -2.848831e-03 3 1  ON 65
ci_067                -1.663240e-03 3 1  ON 66
ci_068                -3.102955e-03 3 1  ON 67
ci_069                 4.556118e-04 3 1  ON 68
ci_070                -4.446731e-04 3 1  ON 69
ci_071                -2.451652e-03 3 1  ON 70
ci_072                -8.209307e-04 3 1  ON 71
ci_073                 1.337122e-04 3 1  ON 72
ci_074                -6.983512e-04 3 1  ON 73
ci_075                -7.517319e-04 3 1  ON 74
ci_076                -4.604346e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6405
    reference variance = 0.376113
====================================================
  Execution time = 2.5673e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1031e-01
  Total weights = 1.9550e+06
  Execution time = 3.6485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497696586975
                                         uncertainty =       0.002697745564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497696586975
                                         uncertainty =       0.002697745564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498781946
  error estimate for blocks of size 2^( 2) =       0.000516415419
  error estimate for blocks of size 2^( 3) =       0.000531703992
  error estimate for blocks of size 2^( 4) =       0.000543503159
  error estimate for blocks of size 2^( 5) =       0.000549708096
  error estimate for blocks of size 2^( 6) =       0.000553067106
  error estimate for blocks of size 2^( 7) =       0.000553151878

      target function =                  N/A
              le_mean =     -22.670135793722
             les_mean =     514.469632485222
             stat err =       0.000549857559
             autocorr =       1.215287271976
              std dev =       0.705384192827
             le_variance =       0.497566859490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497579302421
                                         uncertainty =       0.002706808428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497579302421
                                         uncertainty =       0.002706808428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498724883
  error estimate for blocks of size 2^( 2) =       0.000516347492
  error estimate for blocks of size 2^( 3) =       0.000531643908
  error estimate for blocks of size 2^( 4) =       0.000543415399
  error estimate for blocks of size 2^( 5) =       0.000549606750
  error estimate for blocks of size 2^( 6) =       0.000552927177
  error estimate for blocks of size 2^( 7) =       0.000553040999

      target function =                  N/A
              le_mean =     -22.670135808262
             les_mean =     514.463751231111
             stat err =       0.000549747581
             autocorr =       1.215079180515
              std dev =       0.705303493762
             le_variance =       0.497453018313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497575052653
                                         uncertainty =       0.002706247441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497575052653
                                         uncertainty =       0.002706247441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498722615
  error estimate for blocks of size 2^( 2) =       0.000516338561
  error estimate for blocks of size 2^( 3) =       0.000531643193
  error estimate for blocks of size 2^( 4) =       0.000543425929
  error estimate for blocks of size 2^( 5) =       0.000549615352
  error estimate for blocks of size 2^( 6) =       0.000552938251
  error estimate for blocks of size 2^( 7) =       0.000553038022

      target function =                  N/A
              le_mean =     -22.670134682485
             les_mean =     514.496154066782
             stat err =       0.000549754389
             autocorr =       1.215120326319
              std dev =       0.705300285984
             le_variance =       0.497448493410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497464686904
                                         uncertainty =       0.002710847206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497464686904
                                         uncertainty =       0.002710847206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498666102
  error estimate for blocks of size 2^( 2) =       0.000516294974
  error estimate for blocks of size 2^( 3) =       0.000531598189
  error estimate for blocks of size 2^( 4) =       0.000543397236
  error estimate for blocks of size 2^( 5) =       0.000549595285
  error estimate for blocks of size 2^( 6) =       0.000552944475
  error estimate for blocks of size 2^( 7) =       0.000553042378

      target function =                  N/A
              le_mean =     -22.670128295752
             les_mean =     514.448992395324
             stat err =       0.000549744843
             autocorr =       1.215353551315
              std dev =       0.705220364901
             le_variance =       0.497335763071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670135793722        initial
     9.7656e-02     9.7656e-01             4.4846e-03       -22.670135808262  <--
     3.9062e-01     3.9062e+00             1.9428e-03       -22.670134682485
     1.5625e+00     1.5625e+01             5.9556e-04       -22.670128295752

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.3910e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -7.062009e-01 3 1  ON 0
ci_002                -7.046793e-01 3 1  ON 1
ci_003                -4.066735e-02 3 1  ON 2
ci_004                -3.897230e-02 3 1  ON 3
ci_005                 1.615663e-02 3 1  ON 4
ci_006                 1.528429e-02 3 1  ON 5
ci_007                 1.220011e-02 3 1  ON 6
ci_008                 1.182734e-02 3 1  ON 7
ci_009                -1.196834e-02 3 1  ON 8
ci_010                -1.226727e-02 3 1  ON 9
ci_011                -8.515333e-03 3 1  ON 10
ci_012                -8.179445e-03 3 1  ON 11
ci_013                 9.164169e-03 3 1  ON 12
ci_014                 6.146133e-03 3 1  ON 13
ci_015                 1.156928e-02 3 1  ON 14
ci_016                 1.273029e-02 3 1  ON 15
ci_017                 1.019753e-02 3 1  ON 16
ci_018                 1.166310e-02 3 1  ON 17
ci_019                -2.655920e-03 3 1  ON 18
ci_020                -3.141702e-03 3 1  ON 19
ci_021                -7.806684e-03 3 1  ON 20
ci_022                -1.003083e-02 3 1  ON 21
ci_023                 8.573643e-03 3 1  ON 22
ci_024                 7.903401e-03 3 1  ON 23
ci_025                 5.354764e-03 3 1  ON 24
ci_026                 5.341408e-03 3 1  ON 25
ci_027                 6.686576e-03 3 1  ON 26
ci_028                 6.601665e-03 3 1  ON 27
ci_029                -4.105450e-03 3 1  ON 28
ci_030                -5.196171e-03 3 1  ON 29
ci_031                -7.748264e-03 3 1  ON 30
ci_032                -7.110108e-03 3 1  ON 31
ci_033                 4.008583e-03 3 1  ON 32
ci_034                 3.764026e-03 3 1  ON 33
ci_035                 1.046194e-03 3 1  ON 34
ci_036                 2.045596e-03 3 1  ON 35
ci_037                 5.352093e-03 3 1  ON 36
ci_038                 4.342503e-03 3 1  ON 37
ci_039                 5.008392e-03 3 1  ON 38
ci_040                 5.907622e-03 3 1  ON 39
ci_041                 5.646291e-03 3 1  ON 40
ci_042                 5.138544e-03 3 1  ON 41
ci_043                 4.950768e-03 3 1  ON 42
ci_044                 5.627789e-03 3 1  ON 43
ci_045                 4.449125e-03 3 1  ON 44
ci_046                 2.838936e-03 3 1  ON 45
ci_047                -7.047689e-04 3 1  ON 46
ci_048                -4.954123e-04 3 1  ON 47
ci_049                 1.324670e-03 3 1  ON 48
ci_050                 7.561740e-04 3 1  ON 49
ci_051                -1.253018e-03 3 1  ON 50
ci_052                -1.417155e-03 3 1  ON 51
ci_053                -2.242208e-03 3 1  ON 52
ci_054                -3.922058e-03 3 1  ON 53
ci_055                -2.017668e-03 3 1  ON 54
ci_056                -1.091128e-03 3 1  ON 55
ci_057                -1.964706e-03 3 1  ON 56
ci_058                -1.076491e-03 3 1  ON 57
ci_059                -3.183425e-04 3 1  ON 58
ci_060                -7.386512e-04 3 1  ON 59
ci_061                 1.508853e-04 3 1  ON 60
ci_062                 7.820986e-04 3 1  ON 61
ci_063                -1.836019e-03 3 1  ON 62
ci_064                -4.595850e-03 3 1  ON 63
ci_065                -2.708260e-03 3 1  ON 64
ci_066                -2.296082e-03 3 1  ON 65
ci_067                -1.525781e-03 3 1  ON 66
ci_068                -2.792250e-03 3 1  ON 67
ci_069                 7.748831e-04 3 1  ON 68
ci_070                -4.211238e-04 3 1  ON 69
ci_071                -2.287114e-03 3 1  ON 70
ci_072                -2.675332e-04 3 1  ON 71
ci_073                -2.070050e-05 3 1  ON 72
ci_074                -1.225538e-03 3 1  ON 73
ci_075                -6.361046e-04 3 1  ON 74
ci_076                -4.248399e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6239e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7339
    reference variance = 0.547721
====================================================
  Execution time = 2.6511e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1846e-01
  Total weights = 1.955142533e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504126794655
                                         uncertainty =       0.004159297824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504126794655
                                         uncertainty =       0.004159297824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502074841
  error estimate for blocks of size 2^( 2) =       0.000519860227
  error estimate for blocks of size 2^( 3) =       0.000536103646
  error estimate for blocks of size 2^( 4) =       0.000546009085
  error estimate for blocks of size 2^( 5) =       0.000551092733
  error estimate for blocks of size 2^( 6) =       0.000556192958
  error estimate for blocks of size 2^( 7) =       0.000560326455

      target function =                  N/A
              le_mean =     -22.669712281267
             les_mean =     514.434310183088
             stat err =       0.000553405308
             autocorr =       1.214925708695
              std dev =       0.710041049226
             le_variance =       0.504158291587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266971228127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669712281393       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669767518724       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669770717781       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669771107773       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669771689405       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669770555191       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669770734144       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-02 is 3.385551e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669712281393       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669752679437       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669753757737       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669753605948       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669753697145       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 2.200090e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669712281393       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669731754116       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669731976391       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669731907581       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 9.191541e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027453 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1307e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -7.061730e-01 3 1  ON 0
ci_002                -7.048027e-01 3 1  ON 1
ci_003                -4.000183e-02 3 1  ON 2
ci_004                -3.774853e-02 3 1  ON 3
ci_005                 1.619777e-02 3 1  ON 4
ci_006                 1.490637e-02 3 1  ON 5
ci_007                 1.242210e-02 3 1  ON 6
ci_008                 1.180028e-02 3 1  ON 7
ci_009                -1.096479e-02 3 1  ON 8
ci_010                -1.300537e-02 3 1  ON 9
ci_011                -8.243116e-03 3 1  ON 10
ci_012                -8.873695e-03 3 1  ON 11
ci_013                 9.936299e-03 3 1  ON 12
ci_014                 8.346223e-03 3 1  ON 13
ci_015                 1.235273e-02 3 1  ON 14
ci_016                 1.265940e-02 3 1  ON 15
ci_017                 1.072295e-02 3 1  ON 16
ci_018                 1.079986e-02 3 1  ON 17
ci_019                -3.213481e-03 3 1  ON 18
ci_020                -2.414268e-03 3 1  ON 19
ci_021                -7.459745e-03 3 1  ON 20
ci_022                -9.109231e-03 3 1  ON 21
ci_023                 8.660810e-03 3 1  ON 22
ci_024                 7.495954e-03 3 1  ON 23
ci_025                 6.030603e-03 3 1  ON 24
ci_026                 4.560868e-03 3 1  ON 25
ci_027                 7.356746e-03 3 1  ON 26
ci_028                 7.498093e-03 3 1  ON 27
ci_029                -4.355873e-03 3 1  ON 28
ci_030                -5.775658e-03 3 1  ON 29
ci_031                -8.152134e-03 3 1  ON 30
ci_032                -7.345496e-03 3 1  ON 31
ci_033                 4.126892e-03 3 1  ON 32
ci_034                 4.333433e-03 3 1  ON 33
ci_035                 2.015244e-03 3 1  ON 34
ci_036                 2.332098e-03 3 1  ON 35
ci_037                 3.964612e-03 3 1  ON 36
ci_038                 4.738288e-03 3 1  ON 37
ci_039                 4.939085e-03 3 1  ON 38
ci_040                 5.150069e-03 3 1  ON 39
ci_041                 5.055605e-03 3 1  ON 40
ci_042                 6.300697e-03 3 1  ON 41
ci_043                 5.199283e-03 3 1  ON 42
ci_044                 5.254272e-03 3 1  ON 43
ci_045                 4.116002e-03 3 1  ON 44
ci_046                 2.955208e-03 3 1  ON 45
ci_047                -1.962081e-04 3 1  ON 46
ci_048                -7.942044e-04 3 1  ON 47
ci_049                 1.633997e-03 3 1  ON 48
ci_050                 1.603497e-03 3 1  ON 49
ci_051                -6.728127e-04 3 1  ON 50
ci_052                -1.072436e-03 3 1  ON 51
ci_053                -2.514846e-03 3 1  ON 52
ci_054                -3.268130e-03 3 1  ON 53
ci_055                -1.769913e-03 3 1  ON 54
ci_056                -2.316044e-03 3 1  ON 55
ci_057                -1.273619e-03 3 1  ON 56
ci_058                -2.174751e-03 3 1  ON 57
ci_059                -3.010035e-04 3 1  ON 58
ci_060                 9.727056e-05 3 1  ON 59
ci_061                 6.224430e-04 3 1  ON 60
ci_062                 5.357982e-04 3 1  ON 61
ci_063                -7.273386e-04 3 1  ON 62
ci_064                -2.792546e-03 3 1  ON 63
ci_065                -2.714261e-03 3 1  ON 64
ci_066                -2.659804e-03 3 1  ON 65
ci_067                -9.797834e-04 3 1  ON 66
ci_068                -3.495707e-03 3 1  ON 67
ci_069                 1.296347e-03 3 1  ON 68
ci_070                -1.285455e-04 3 1  ON 69
ci_071                -1.994852e-03 3 1  ON 70
ci_072                -4.880746e-04 3 1  ON 71
ci_073                 3.903538e-04 3 1  ON 72
ci_074                -3.637005e-04 3 1  ON 73
ci_075                -8.292706e-04 3 1  ON 74
ci_076                -5.782078e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6382
    reference variance = 0.543009
====================================================
  Execution time = 2.5673e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0530e-01
  Total weights = 1.9550e+06
  Execution time = 3.6375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492014913499
                                         uncertainty =       0.002413753458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492014913499
                                         uncertainty =       0.002413753458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496006163
  error estimate for blocks of size 2^( 2) =       0.000514055031
  error estimate for blocks of size 2^( 3) =       0.000530000094
  error estimate for blocks of size 2^( 4) =       0.000540480784
  error estimate for blocks of size 2^( 5) =       0.000547736171
  error estimate for blocks of size 2^( 6) =       0.000551145863
  error estimate for blocks of size 2^( 7) =       0.000553691616

      target function =                  N/A
              le_mean =     -22.669988662061
             les_mean =     514.449551819996
             stat err =       0.000548263609
             autocorr =       1.221812866827
              std dev =       0.701458643438
             le_variance =       0.492044228454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491909874262
                                         uncertainty =       0.002465943348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491909874262
                                         uncertainty =       0.002465943348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495946864
  error estimate for blocks of size 2^( 2) =       0.000513995103
  error estimate for blocks of size 2^( 3) =       0.000529949331
  error estimate for blocks of size 2^( 4) =       0.000540414652
  error estimate for blocks of size 2^( 5) =       0.000547620737
  error estimate for blocks of size 2^( 6) =       0.000550998017
  error estimate for blocks of size 2^( 7) =       0.000553407929

      target function =                  N/A
              le_mean =     -22.669981012130
             les_mean =     514.473282769589
             stat err =       0.000548110334
             autocorr =       1.221421843656
              std dev =       0.701374781749
             le_variance =       0.491926584474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492532556190
                                         uncertainty =       0.002489614501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492532556190
                                         uncertainty =       0.002489614501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496259456
  error estimate for blocks of size 2^( 2) =       0.000514303590
  error estimate for blocks of size 2^( 3) =       0.000530252238
  error estimate for blocks of size 2^( 4) =       0.000540700586
  error estimate for blocks of size 2^( 5) =       0.000547899723
  error estimate for blocks of size 2^( 6) =       0.000551316528
  error estimate for blocks of size 2^( 7) =       0.000553608619

      target function =                  N/A
              le_mean =     -22.670016670277
             les_mean =     514.464714205434
             stat err =       0.000548381364
             autocorr =       1.221090309047
              std dev =       0.701816853523
             le_variance =       0.492546895889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491649497205
                                         uncertainty =       0.002425145903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491649497205
                                         uncertainty =       0.002425145903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495818836
  error estimate for blocks of size 2^( 2) =       0.000513866604
  error estimate for blocks of size 2^( 3) =       0.000529822646
  error estimate for blocks of size 2^( 4) =       0.000540307792
  error estimate for blocks of size 2^( 5) =       0.000547539359
  error estimate for blocks of size 2^( 6) =       0.000550927469
  error estimate for blocks of size 2^( 7) =       0.000553428067

      target function =                  N/A
              le_mean =     -22.669967016669
             les_mean =     514.434172403629
             stat err =       0.000548050672
             autocorr =       1.221786680928
              std dev =       0.701193722086
             le_variance =       0.491672635892


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669988662061        initial
     2.4414e-02     2.4414e-01             3.3856e-03       -22.669981012130
     9.7656e-02     9.7656e-01             2.2001e-03       -22.670016670277  <--
     3.9062e-01     3.9062e+00             9.1915e-04       -22.669967016669

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.3926e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -7.061730e-01 3 1  ON 0
ci_002                -7.048027e-01 3 1  ON 1
ci_003                -4.000183e-02 3 1  ON 2
ci_004                -3.774853e-02 3 1  ON 3
ci_005                 1.619777e-02 3 1  ON 4
ci_006                 1.490637e-02 3 1  ON 5
ci_007                 1.242210e-02 3 1  ON 6
ci_008                 1.180028e-02 3 1  ON 7
ci_009                -1.096479e-02 3 1  ON 8
ci_010                -1.300537e-02 3 1  ON 9
ci_011                -8.243116e-03 3 1  ON 10
ci_012                -8.873695e-03 3 1  ON 11
ci_013                 9.936299e-03 3 1  ON 12
ci_014                 8.346223e-03 3 1  ON 13
ci_015                 1.235273e-02 3 1  ON 14
ci_016                 1.265940e-02 3 1  ON 15
ci_017                 1.072295e-02 3 1  ON 16
ci_018                 1.079986e-02 3 1  ON 17
ci_019                -3.213481e-03 3 1  ON 18
ci_020                -2.414268e-03 3 1  ON 19
ci_021                -7.459745e-03 3 1  ON 20
ci_022                -9.109231e-03 3 1  ON 21
ci_023                 8.660810e-03 3 1  ON 22
ci_024                 7.495954e-03 3 1  ON 23
ci_025                 6.030603e-03 3 1  ON 24
ci_026                 4.560868e-03 3 1  ON 25
ci_027                 7.356746e-03 3 1  ON 26
ci_028                 7.498093e-03 3 1  ON 27
ci_029                -4.355873e-03 3 1  ON 28
ci_030                -5.775658e-03 3 1  ON 29
ci_031                -8.152134e-03 3 1  ON 30
ci_032                -7.345496e-03 3 1  ON 31
ci_033                 4.126892e-03 3 1  ON 32
ci_034                 4.333433e-03 3 1  ON 33
ci_035                 2.015244e-03 3 1  ON 34
ci_036                 2.332098e-03 3 1  ON 35
ci_037                 3.964612e-03 3 1  ON 36
ci_038                 4.738288e-03 3 1  ON 37
ci_039                 4.939085e-03 3 1  ON 38
ci_040                 5.150069e-03 3 1  ON 39
ci_041                 5.055605e-03 3 1  ON 40
ci_042                 6.300697e-03 3 1  ON 41
ci_043                 5.199283e-03 3 1  ON 42
ci_044                 5.254272e-03 3 1  ON 43
ci_045                 4.116002e-03 3 1  ON 44
ci_046                 2.955208e-03 3 1  ON 45
ci_047                -1.962081e-04 3 1  ON 46
ci_048                -7.942044e-04 3 1  ON 47
ci_049                 1.633997e-03 3 1  ON 48
ci_050                 1.603497e-03 3 1  ON 49
ci_051                -6.728127e-04 3 1  ON 50
ci_052                -1.072436e-03 3 1  ON 51
ci_053                -2.514846e-03 3 1  ON 52
ci_054                -3.268130e-03 3 1  ON 53
ci_055                -1.769913e-03 3 1  ON 54
ci_056                -2.316044e-03 3 1  ON 55
ci_057                -1.273619e-03 3 1  ON 56
ci_058                -2.174751e-03 3 1  ON 57
ci_059                -3.010035e-04 3 1  ON 58
ci_060                 9.727056e-05 3 1  ON 59
ci_061                 6.224430e-04 3 1  ON 60
ci_062                 5.357982e-04 3 1  ON 61
ci_063                -7.273386e-04 3 1  ON 62
ci_064                -2.792546e-03 3 1  ON 63
ci_065                -2.714261e-03 3 1  ON 64
ci_066                -2.659804e-03 3 1  ON 65
ci_067                -9.797834e-04 3 1  ON 66
ci_068                -3.495707e-03 3 1  ON 67
ci_069                 1.296347e-03 3 1  ON 68
ci_070                -1.285455e-04 3 1  ON 69
ci_071                -1.994852e-03 3 1  ON 70
ci_072                -4.880746e-04 3 1  ON 71
ci_073                 3.903538e-04 3 1  ON 72
ci_074                -3.637005e-04 3 1  ON 73
ci_075                -8.292706e-04 3 1  ON 74
ci_076                -5.782078e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.5667
    reference variance = 0.56596
====================================================
  Execution time = 2.6391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1243e-01
  Total weights = 1.955112821e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8081e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496592697474
                                         uncertainty =       0.002564590056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496592697474
                                         uncertainty =       0.002564590056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498274883
  error estimate for blocks of size 2^( 2) =       0.000515559213
  error estimate for blocks of size 2^( 3) =       0.000531665043
  error estimate for blocks of size 2^( 4) =       0.000543780276
  error estimate for blocks of size 2^( 5) =       0.000551420948
  error estimate for blocks of size 2^( 6) =       0.000556033698
  error estimate for blocks of size 2^( 7) =       0.000559841019

      target function =                  N/A
              le_mean =     -22.668763864504
             les_mean =     514.385289736176
             stat err =       0.000552768985
             autocorr =       1.230691903891
              std dev =       0.704667097631
             le_variance =       0.496555718483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266876386450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668763864582       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668837457536       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668838695016       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668838353680       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668838264103       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668837281551       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668837147585       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668837781068       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-02 is 2.303701e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668763864582       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668818505058       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668818524167       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668818344855       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668818386680       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 1.465608e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668763864582       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668790779220       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668790880683       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668790894338       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 8.326898e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029362 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1205e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -7.066006e-01 3 1  ON 0
ci_002                -7.045211e-01 3 1  ON 1
ci_003                -3.890157e-02 3 1  ON 2
ci_004                -3.669207e-02 3 1  ON 3
ci_005                 1.606565e-02 3 1  ON 4
ci_006                 1.578706e-02 3 1  ON 5
ci_007                 1.278322e-02 3 1  ON 6
ci_008                 1.293463e-02 3 1  ON 7
ci_009                -1.105098e-02 3 1  ON 8
ci_010                -1.266497e-02 3 1  ON 9
ci_011                -8.930848e-03 3 1  ON 10
ci_012                -8.069068e-03 3 1  ON 11
ci_013                 9.578169e-03 3 1  ON 12
ci_014                 9.811831e-03 3 1  ON 13
ci_015                 1.214724e-02 3 1  ON 14
ci_016                 1.302883e-02 3 1  ON 15
ci_017                 1.174283e-02 3 1  ON 16
ci_018                 1.083120e-02 3 1  ON 17
ci_019                -2.841947e-03 3 1  ON 18
ci_020                -1.965845e-03 3 1  ON 19
ci_021                -6.407663e-03 3 1  ON 20
ci_022                -7.870605e-03 3 1  ON 21
ci_023                 8.333547e-03 3 1  ON 22
ci_024                 7.561731e-03 3 1  ON 23
ci_025                 4.856841e-03 3 1  ON 24
ci_026                 4.562480e-03 3 1  ON 25
ci_027                 6.955343e-03 3 1  ON 26
ci_028                 6.667724e-03 3 1  ON 27
ci_029                -4.936771e-03 3 1  ON 28
ci_030                -5.158039e-03 3 1  ON 29
ci_031                -7.930255e-03 3 1  ON 30
ci_032                -7.580089e-03 3 1  ON 31
ci_033                 4.570489e-03 3 1  ON 32
ci_034                 3.607294e-03 3 1  ON 33
ci_035                 1.186343e-03 3 1  ON 34
ci_036                 8.798286e-04 3 1  ON 35
ci_037                 4.701035e-03 3 1  ON 36
ci_038                 5.410758e-03 3 1  ON 37
ci_039                 5.797511e-03 3 1  ON 38
ci_040                 4.495776e-03 3 1  ON 39
ci_041                 4.536773e-03 3 1  ON 40
ci_042                 5.269695e-03 3 1  ON 41
ci_043                 4.804449e-03 3 1  ON 42
ci_044                 5.646175e-03 3 1  ON 43
ci_045                 3.968895e-03 3 1  ON 44
ci_046                 3.077854e-03 3 1  ON 45
ci_047                -7.686876e-04 3 1  ON 46
ci_048                -3.877222e-04 3 1  ON 47
ci_049                 1.609274e-03 3 1  ON 48
ci_050                 1.381262e-03 3 1  ON 49
ci_051                -1.557787e-03 3 1  ON 50
ci_052                -1.222824e-03 3 1  ON 51
ci_053                -2.072651e-03 3 1  ON 52
ci_054                -2.695322e-03 3 1  ON 53
ci_055                -3.222398e-04 3 1  ON 54
ci_056                -2.759278e-03 3 1  ON 55
ci_057                -1.919313e-03 3 1  ON 56
ci_058                -1.223558e-03 3 1  ON 57
ci_059                 2.500581e-04 3 1  ON 58
ci_060                 4.120118e-04 3 1  ON 59
ci_061                 4.830751e-04 3 1  ON 60
ci_062                 5.448280e-05 3 1  ON 61
ci_063                -1.206027e-04 3 1  ON 62
ci_064                -1.563692e-03 3 1  ON 63
ci_065                -1.261436e-03 3 1  ON 64
ci_066                -2.515724e-03 3 1  ON 65
ci_067                -1.584902e-03 3 1  ON 66
ci_068                -3.148612e-03 3 1  ON 67
ci_069                 2.029833e-04 3 1  ON 68
ci_070                -9.512294e-05 3 1  ON 69
ci_071                -2.517751e-03 3 1  ON 70
ci_072                -1.526825e-03 3 1  ON 71
ci_073                 3.933561e-04 3 1  ON 72
ci_074                 7.564473e-04 3 1  ON 73
ci_075                 3.376750e-04 3 1  ON 74
ci_076                -1.346836e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6217
    reference variance = 0.339175
====================================================
  Execution time = 2.5788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.0975e-01
  Total weights = 1.9551e+06
  Execution time = 3.6380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498544966864
                                         uncertainty =       0.003073683274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498544966864
                                         uncertainty =       0.003073683274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499220207
  error estimate for blocks of size 2^( 2) =       0.000517229278
  error estimate for blocks of size 2^( 3) =       0.000533309347
  error estimate for blocks of size 2^( 4) =       0.000544579689
  error estimate for blocks of size 2^( 5) =       0.000551318482
  error estimate for blocks of size 2^( 6) =       0.000555867260
  error estimate for blocks of size 2^( 7) =       0.000557157230

      target function =                  N/A
              le_mean =     -22.671183432256
             les_mean =     514.511752545057
             stat err =       0.000552230665
             autocorr =       1.223648626260
              std dev =       0.706003987208
             le_variance =       0.498441629953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498246260604
                                         uncertainty =       0.002989748633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498246260604
                                         uncertainty =       0.002989748633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499071666
  error estimate for blocks of size 2^( 2) =       0.000517071175
  error estimate for blocks of size 2^( 3) =       0.000533158974
  error estimate for blocks of size 2^( 4) =       0.000544424739
  error estimate for blocks of size 2^( 5) =       0.000551159396
  error estimate for blocks of size 2^( 6) =       0.000555650331
  error estimate for blocks of size 2^( 7) =       0.000557000587

      target function =                  N/A
              le_mean =     -22.671114216737
             les_mean =     514.506069860803
             stat err =       0.000552058763
             autocorr =       1.223614986749
              std dev =       0.705793919062
             le_variance =       0.498145056185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499892388016
                                         uncertainty =       0.003275339625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499892388016
                                         uncertainty =       0.003275339625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499893927
  error estimate for blocks of size 2^( 2) =       0.000517855338
  error estimate for blocks of size 2^( 3) =       0.000533940879
  error estimate for blocks of size 2^( 4) =       0.000545168223
  error estimate for blocks of size 2^( 5) =       0.000551885982
  error estimate for blocks of size 2^( 6) =       0.000556466111
  error estimate for blocks of size 2^( 7) =       0.000557881870

      target function =                  N/A
              le_mean =     -22.671133101251
             les_mean =     514.628411617200
             stat err =       0.000552850546
             autocorr =       1.223093800746
              std dev =       0.706956771324
             le_variance =       0.499787876521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.621978146549
                                         uncertainty =       0.123033386847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.621978146549
                                         uncertainty =       0.123033386847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000557542868
  error estimate for blocks of size 2^( 2) =       0.000573645184
  error estimate for blocks of size 2^( 3) =       0.000588271350
  error estimate for blocks of size 2^( 4) =       0.000598457207
  error estimate for blocks of size 2^( 5) =       0.000604455771
  error estimate for blocks of size 2^( 6) =       0.000608335753
  error estimate for blocks of size 2^( 7) =       0.000608712896

      target function =                  N/A
              le_mean =     -22.670890779745
             les_mean =     652.185619549635
             stat err =       0.000604990407
             autocorr =       1.177444505960
              std dev =       0.788484685022
             le_variance =       0.621708098514


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.671183432256        initial  <--
     2.4414e-02     2.4414e-01             2.3037e-03       -22.671114216737
     9.7656e-02     9.7656e-01             1.4656e-03       -22.671133101251
     3.9062e-01     3.9062e+00             8.3269e-04       -22.670890779745

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0577
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -7.061730e-01 3 1  ON 0
ci_002                -7.048027e-01 3 1  ON 1
ci_003                -4.000183e-02 3 1  ON 2
ci_004                -3.774853e-02 3 1  ON 3
ci_005                 1.619777e-02 3 1  ON 4
ci_006                 1.490637e-02 3 1  ON 5
ci_007                 1.242210e-02 3 1  ON 6
ci_008                 1.180028e-02 3 1  ON 7
ci_009                -1.096479e-02 3 1  ON 8
ci_010                -1.300537e-02 3 1  ON 9
ci_011                -8.243116e-03 3 1  ON 10
ci_012                -8.873695e-03 3 1  ON 11
ci_013                 9.936299e-03 3 1  ON 12
ci_014                 8.346223e-03 3 1  ON 13
ci_015                 1.235273e-02 3 1  ON 14
ci_016                 1.265940e-02 3 1  ON 15
ci_017                 1.072295e-02 3 1  ON 16
ci_018                 1.079986e-02 3 1  ON 17
ci_019                -3.213481e-03 3 1  ON 18
ci_020                -2.414268e-03 3 1  ON 19
ci_021                -7.459745e-03 3 1  ON 20
ci_022                -9.109231e-03 3 1  ON 21
ci_023                 8.660810e-03 3 1  ON 22
ci_024                 7.495954e-03 3 1  ON 23
ci_025                 6.030603e-03 3 1  ON 24
ci_026                 4.560868e-03 3 1  ON 25
ci_027                 7.356746e-03 3 1  ON 26
ci_028                 7.498093e-03 3 1  ON 27
ci_029                -4.355873e-03 3 1  ON 28
ci_030                -5.775658e-03 3 1  ON 29
ci_031                -8.152134e-03 3 1  ON 30
ci_032                -7.345496e-03 3 1  ON 31
ci_033                 4.126892e-03 3 1  ON 32
ci_034                 4.333433e-03 3 1  ON 33
ci_035                 2.015244e-03 3 1  ON 34
ci_036                 2.332098e-03 3 1  ON 35
ci_037                 3.964612e-03 3 1  ON 36
ci_038                 4.738288e-03 3 1  ON 37
ci_039                 4.939085e-03 3 1  ON 38
ci_040                 5.150069e-03 3 1  ON 39
ci_041                 5.055605e-03 3 1  ON 40
ci_042                 6.300697e-03 3 1  ON 41
ci_043                 5.199283e-03 3 1  ON 42
ci_044                 5.254272e-03 3 1  ON 43
ci_045                 4.116002e-03 3 1  ON 44
ci_046                 2.955208e-03 3 1  ON 45
ci_047                -1.962081e-04 3 1  ON 46
ci_048                -7.942044e-04 3 1  ON 47
ci_049                 1.633997e-03 3 1  ON 48
ci_050                 1.603497e-03 3 1  ON 49
ci_051                -6.728127e-04 3 1  ON 50
ci_052                -1.072436e-03 3 1  ON 51
ci_053                -2.514846e-03 3 1  ON 52
ci_054                -3.268130e-03 3 1  ON 53
ci_055                -1.769913e-03 3 1  ON 54
ci_056                -2.316044e-03 3 1  ON 55
ci_057                -1.273619e-03 3 1  ON 56
ci_058                -2.174751e-03 3 1  ON 57
ci_059                -3.010035e-04 3 1  ON 58
ci_060                 9.727056e-05 3 1  ON 59
ci_061                 6.224430e-04 3 1  ON 60
ci_062                 5.357982e-04 3 1  ON 61
ci_063                -7.273386e-04 3 1  ON 62
ci_064                -2.792546e-03 3 1  ON 63
ci_065                -2.714261e-03 3 1  ON 64
ci_066                -2.659804e-03 3 1  ON 65
ci_067                -9.797834e-04 3 1  ON 66
ci_068                -3.495707e-03 3 1  ON 67
ci_069                 1.296347e-03 3 1  ON 68
ci_070                -1.285455e-04 3 1  ON 69
ci_071                -1.994852e-03 3 1  ON 70
ci_072                -4.880746e-04 3 1  ON 71
ci_073                 3.903538e-04 3 1  ON 72
ci_074                -3.637005e-04 3 1  ON 73
ci_075                -8.292706e-04 3 1  ON 74
ci_076                -5.782078e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7278
    reference variance = 0.84265
====================================================
  Execution time = 2.6306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.0786e-01
  Total weights = 1.954918439e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496493398755
                                         uncertainty =       0.002634667446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496493398755
                                         uncertainty =       0.002634667446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498239224
  error estimate for blocks of size 2^( 2) =       0.000516094559
  error estimate for blocks of size 2^( 3) =       0.000532624453
  error estimate for blocks of size 2^( 4) =       0.000544201686
  error estimate for blocks of size 2^( 5) =       0.000550133319
  error estimate for blocks of size 2^( 6) =       0.000553324662
  error estimate for blocks of size 2^( 7) =       0.000556554543

      target function =                  N/A
              le_mean =     -22.670700236887
             les_mean =     514.468513912351
             stat err =       0.000551053552
             autocorr =       1.223240309614
              std dev =       0.704616667832
             le_variance =       0.496484648587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267070023689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670700237005       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670713213916       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670719185972       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670719239644       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670719273961       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.541767e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670700237005       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670705006971       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670707276943       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670707392185       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670707400022       residual = 7.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 5.403985e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670700237005       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670701588382       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670702256210       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670702295843       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670702298548       residual = 8.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 1.535101e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030977 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1078e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -7.061818e-01 3 1  ON 0
ci_002                -7.048020e-01 3 1  ON 1
ci_003                -3.976087e-02 3 1  ON 2
ci_004                -3.817712e-02 3 1  ON 3
ci_005                 1.608600e-02 3 1  ON 4
ci_006                 1.517245e-02 3 1  ON 5
ci_007                 1.255922e-02 3 1  ON 6
ci_008                 1.187693e-02 3 1  ON 7
ci_009                -1.097727e-02 3 1  ON 8
ci_010                -1.295642e-02 3 1  ON 9
ci_011                -8.219876e-03 3 1  ON 10
ci_012                -8.838670e-03 3 1  ON 11
ci_013                 9.710835e-03 3 1  ON 12
ci_014                 8.418939e-03 3 1  ON 13
ci_015                 1.184021e-02 3 1  ON 14
ci_016                 1.273963e-02 3 1  ON 15
ci_017                 1.112110e-02 3 1  ON 16
ci_018                 1.068970e-02 3 1  ON 17
ci_019                -3.211435e-03 3 1  ON 18
ci_020                -2.563063e-03 3 1  ON 19
ci_021                -7.603463e-03 3 1  ON 20
ci_022                -8.819068e-03 3 1  ON 21
ci_023                 8.526955e-03 3 1  ON 22
ci_024                 7.503203e-03 3 1  ON 23
ci_025                 5.881518e-03 3 1  ON 24
ci_026                 4.715486e-03 3 1  ON 25
ci_027                 6.965297e-03 3 1  ON 26
ci_028                 7.053410e-03 3 1  ON 27
ci_029                -4.328949e-03 3 1  ON 28
ci_030                -5.632602e-03 3 1  ON 29
ci_031                -8.145759e-03 3 1  ON 30
ci_032                -7.575180e-03 3 1  ON 31
ci_033                 4.185451e-03 3 1  ON 32
ci_034                 4.165033e-03 3 1  ON 33
ci_035                 1.865945e-03 3 1  ON 34
ci_036                 2.100129e-03 3 1  ON 35
ci_037                 4.133573e-03 3 1  ON 36
ci_038                 4.419225e-03 3 1  ON 37
ci_039                 5.080857e-03 3 1  ON 38
ci_040                 5.364628e-03 3 1  ON 39
ci_041                 5.171844e-03 3 1  ON 40
ci_042                 5.907182e-03 3 1  ON 41
ci_043                 5.325505e-03 3 1  ON 42
ci_044                 5.447006e-03 3 1  ON 43
ci_045                 4.006757e-03 3 1  ON 44
ci_046                 2.829115e-03 3 1  ON 45
ci_047                -2.775654e-04 3 1  ON 46
ci_048                -8.848119e-04 3 1  ON 47
ci_049                 1.511902e-03 3 1  ON 48
ci_050                 2.073509e-03 3 1  ON 49
ci_051                -9.684229e-04 3 1  ON 50
ci_052                -1.596467e-03 3 1  ON 51
ci_053                -2.603720e-03 3 1  ON 52
ci_054                -2.727732e-03 3 1  ON 53
ci_055                -1.280935e-03 3 1  ON 54
ci_056                -2.273594e-03 3 1  ON 55
ci_057                -1.448140e-03 3 1  ON 56
ci_058                -2.095160e-03 3 1  ON 57
ci_059                -3.109686e-04 3 1  ON 58
ci_060                 1.294976e-04 3 1  ON 59
ci_061                 5.154736e-04 3 1  ON 60
ci_062                 4.411408e-04 3 1  ON 61
ci_063                -7.086448e-04 3 1  ON 62
ci_064                -2.328419e-03 3 1  ON 63
ci_065                -2.835455e-03 3 1  ON 64
ci_066                -2.509248e-03 3 1  ON 65
ci_067                -1.421089e-03 3 1  ON 66
ci_068                -3.407130e-03 3 1  ON 67
ci_069                 1.042471e-03 3 1  ON 68
ci_070                 7.252841e-05 3 1  ON 69
ci_071                -1.930322e-03 3 1  ON 70
ci_072                -5.459318e-04 3 1  ON 71
ci_073                 3.299750e-04 3 1  ON 72
ci_074                -4.823828e-04 3 1  ON 73
ci_075                -8.858740e-04 3 1  ON 74
ci_076                -7.261168e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7202
    reference variance = 0.464218
====================================================
  Execution time = 2.5617e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0797e-01
  Total weights = 1.9554e+06
  Execution time = 3.6456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494601164686
                                         uncertainty =       0.002621036397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494601164686
                                         uncertainty =       0.002621036397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497230010
  error estimate for blocks of size 2^( 2) =       0.000515412316
  error estimate for blocks of size 2^( 3) =       0.000531543590
  error estimate for blocks of size 2^( 4) =       0.000542787679
  error estimate for blocks of size 2^( 5) =       0.000549172602
  error estimate for blocks of size 2^( 6) =       0.000553993103
  error estimate for blocks of size 2^( 7) =       0.000556056096

      target function =                  N/A
              le_mean =     -22.670473754052
             les_mean =     514.461011570076
             stat err =       0.000550502370
             autocorr =       1.225755137618
              std dev =       0.703189423137
             le_variance =       0.494475364812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519667330295
                                         uncertainty =       0.025559127226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519667330295
                                         uncertainty =       0.025559127226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509650651
  error estimate for blocks of size 2^( 2) =       0.000527327590
  error estimate for blocks of size 2^( 3) =       0.000543092286
  error estimate for blocks of size 2^( 4) =       0.000553948922
  error estimate for blocks of size 2^( 5) =       0.000560315677
  error estimate for blocks of size 2^( 6) =       0.000565688322
  error estimate for blocks of size 2^( 7) =       0.000567865796

      target function =                  N/A
              le_mean =     -22.670367188419
             les_mean =     514.583163092393
             stat err =       0.000561954679
             autocorr =       1.215786780761
              std dev =       0.720754863064
             le_variance =       0.519487572630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498284165198
                                         uncertainty =       0.004981662220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498284165198
                                         uncertainty =       0.004981662220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499073836
  error estimate for blocks of size 2^( 2) =       0.000517165622
  error estimate for blocks of size 2^( 3) =       0.000533245153
  error estimate for blocks of size 2^( 4) =       0.000544384595
  error estimate for blocks of size 2^( 5) =       0.000550763021
  error estimate for blocks of size 2^( 6) =       0.000555737510
  error estimate for blocks of size 2^( 7) =       0.000557820695

      target function =                  N/A
              le_mean =     -22.670438949421
             les_mean =     514.656236786078
             stat err =       0.000552176455
             autocorr =       1.224126116359
              std dev =       0.705796987917
             le_variance =       0.498149388153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494714674585
                                         uncertainty =       0.002665834822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494714674585
                                         uncertainty =       0.002665834822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497286839
  error estimate for blocks of size 2^( 2) =       0.000515464657
  error estimate for blocks of size 2^( 3) =       0.000531596676
  error estimate for blocks of size 2^( 4) =       0.000542833862
  error estimate for blocks of size 2^( 5) =       0.000549218704
  error estimate for blocks of size 2^( 6) =       0.000554048625
  error estimate for blocks of size 2^( 7) =       0.000556114870

      target function =                  N/A
              le_mean =     -22.670467888998
             les_mean =     514.458419274146
             stat err =       0.000550554015
             autocorr =       1.225704944303
              std dev =       0.703269791818
             le_variance =       0.494588400083


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670473754052        initial  <--
     2.4414e-01     2.4414e+00             1.5418e-03       -22.670367188419
     9.7656e-01     9.7656e+00             5.4040e-04       -22.670438949421
     3.9062e+00     3.9062e+01             1.5351e-04       -22.670467888998

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8538
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -7.061730e-01 3 1  ON 0
ci_002                -7.048027e-01 3 1  ON 1
ci_003                -4.000183e-02 3 1  ON 2
ci_004                -3.774853e-02 3 1  ON 3
ci_005                 1.619777e-02 3 1  ON 4
ci_006                 1.490637e-02 3 1  ON 5
ci_007                 1.242210e-02 3 1  ON 6
ci_008                 1.180028e-02 3 1  ON 7
ci_009                -1.096479e-02 3 1  ON 8
ci_010                -1.300537e-02 3 1  ON 9
ci_011                -8.243116e-03 3 1  ON 10
ci_012                -8.873695e-03 3 1  ON 11
ci_013                 9.936299e-03 3 1  ON 12
ci_014                 8.346223e-03 3 1  ON 13
ci_015                 1.235273e-02 3 1  ON 14
ci_016                 1.265940e-02 3 1  ON 15
ci_017                 1.072295e-02 3 1  ON 16
ci_018                 1.079986e-02 3 1  ON 17
ci_019                -3.213481e-03 3 1  ON 18
ci_020                -2.414268e-03 3 1  ON 19
ci_021                -7.459745e-03 3 1  ON 20
ci_022                -9.109231e-03 3 1  ON 21
ci_023                 8.660810e-03 3 1  ON 22
ci_024                 7.495954e-03 3 1  ON 23
ci_025                 6.030603e-03 3 1  ON 24
ci_026                 4.560868e-03 3 1  ON 25
ci_027                 7.356746e-03 3 1  ON 26
ci_028                 7.498093e-03 3 1  ON 27
ci_029                -4.355873e-03 3 1  ON 28
ci_030                -5.775658e-03 3 1  ON 29
ci_031                -8.152134e-03 3 1  ON 30
ci_032                -7.345496e-03 3 1  ON 31
ci_033                 4.126892e-03 3 1  ON 32
ci_034                 4.333433e-03 3 1  ON 33
ci_035                 2.015244e-03 3 1  ON 34
ci_036                 2.332098e-03 3 1  ON 35
ci_037                 3.964612e-03 3 1  ON 36
ci_038                 4.738288e-03 3 1  ON 37
ci_039                 4.939085e-03 3 1  ON 38
ci_040                 5.150069e-03 3 1  ON 39
ci_041                 5.055605e-03 3 1  ON 40
ci_042                 6.300697e-03 3 1  ON 41
ci_043                 5.199283e-03 3 1  ON 42
ci_044                 5.254272e-03 3 1  ON 43
ci_045                 4.116002e-03 3 1  ON 44
ci_046                 2.955208e-03 3 1  ON 45
ci_047                -1.962081e-04 3 1  ON 46
ci_048                -7.942044e-04 3 1  ON 47
ci_049                 1.633997e-03 3 1  ON 48
ci_050                 1.603497e-03 3 1  ON 49
ci_051                -6.728127e-04 3 1  ON 50
ci_052                -1.072436e-03 3 1  ON 51
ci_053                -2.514846e-03 3 1  ON 52
ci_054                -3.268130e-03 3 1  ON 53
ci_055                -1.769913e-03 3 1  ON 54
ci_056                -2.316044e-03 3 1  ON 55
ci_057                -1.273619e-03 3 1  ON 56
ci_058                -2.174751e-03 3 1  ON 57
ci_059                -3.010035e-04 3 1  ON 58
ci_060                 9.727056e-05 3 1  ON 59
ci_061                 6.224430e-04 3 1  ON 60
ci_062                 5.357982e-04 3 1  ON 61
ci_063                -7.273386e-04 3 1  ON 62
ci_064                -2.792546e-03 3 1  ON 63
ci_065                -2.714261e-03 3 1  ON 64
ci_066                -2.659804e-03 3 1  ON 65
ci_067                -9.797834e-04 3 1  ON 66
ci_068                -3.495707e-03 3 1  ON 67
ci_069                 1.296347e-03 3 1  ON 68
ci_070                -1.285455e-04 3 1  ON 69
ci_071                -1.994852e-03 3 1  ON 70
ci_072                -4.880746e-04 3 1  ON 71
ci_073                 3.903538e-04 3 1  ON 72
ci_074                -3.637005e-04 3 1  ON 73
ci_075                -8.292706e-04 3 1  ON 74
ci_076                -5.782078e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7432
    reference variance = 0.500281
====================================================
  Execution time = 2.8507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1363e-01
  Total weights = 1.954938667e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495267785816
                                         uncertainty =       0.003621668293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495267785816
                                         uncertainty =       0.003621668293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497773096
  error estimate for blocks of size 2^( 2) =       0.000515667965
  error estimate for blocks of size 2^( 3) =       0.000530956890
  error estimate for blocks of size 2^( 4) =       0.000542434842
  error estimate for blocks of size 2^( 5) =       0.000549055478
  error estimate for blocks of size 2^( 6) =       0.000552585580
  error estimate for blocks of size 2^( 7) =       0.000555467747

      target function =                  N/A
              le_mean =     -22.669851701546
             les_mean =     514.435808811354
             stat err =       0.000549885911
             autocorr =       1.220344215033
              std dev =       0.703957462727
             le_variance =       0.495556109329


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266985170155e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669851701663       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669855825011       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669856129552       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669856123241       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 2.697300e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669851701663       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669852784609       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669852866717       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669852865319       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 7.063208e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669851701663       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669851975865       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669851996807       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669851996476       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 1.787034e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3298e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -7.061754e-01 3 1  ON 0
ci_002                -7.048032e-01 3 1  ON 1
ci_003                -3.999452e-02 3 1  ON 2
ci_004                -3.772894e-02 3 1  ON 3
ci_005                 1.619264e-02 3 1  ON 4
ci_006                 1.491323e-02 3 1  ON 5
ci_007                 1.241449e-02 3 1  ON 6
ci_008                 1.180044e-02 3 1  ON 7
ci_009                -1.097402e-02 3 1  ON 8
ci_010                -1.302147e-02 3 1  ON 9
ci_011                -8.250744e-03 3 1  ON 10
ci_012                -8.872684e-03 3 1  ON 11
ci_013                 9.933252e-03 3 1  ON 12
ci_014                 8.360681e-03 3 1  ON 13
ci_015                 1.236903e-02 3 1  ON 14
ci_016                 1.266620e-02 3 1  ON 15
ci_017                 1.070001e-02 3 1  ON 16
ci_018                 1.080973e-02 3 1  ON 17
ci_019                -3.187618e-03 3 1  ON 18
ci_020                -2.430272e-03 3 1  ON 19
ci_021                -7.469802e-03 3 1  ON 20
ci_022                -9.105461e-03 3 1  ON 21
ci_023                 8.628600e-03 3 1  ON 22
ci_024                 7.511589e-03 3 1  ON 23
ci_025                 5.969729e-03 3 1  ON 24
ci_026                 4.568499e-03 3 1  ON 25
ci_027                 7.326991e-03 3 1  ON 26
ci_028                 7.449302e-03 3 1  ON 27
ci_029                -4.361202e-03 3 1  ON 28
ci_030                -5.755888e-03 3 1  ON 29
ci_031                -8.162561e-03 3 1  ON 30
ci_032                -7.353132e-03 3 1  ON 31
ci_033                 4.125600e-03 3 1  ON 32
ci_034                 4.334433e-03 3 1  ON 33
ci_035                 2.004833e-03 3 1  ON 34
ci_036                 2.322989e-03 3 1  ON 35
ci_037                 4.035244e-03 3 1  ON 36
ci_038                 4.770669e-03 3 1  ON 37
ci_039                 4.939597e-03 3 1  ON 38
ci_040                 5.157529e-03 3 1  ON 39
ci_041                 5.059572e-03 3 1  ON 40
ci_042                 6.247307e-03 3 1  ON 41
ci_043                 5.156395e-03 3 1  ON 42
ci_044                 5.249485e-03 3 1  ON 43
ci_045                 4.098236e-03 3 1  ON 44
ci_046                 2.978805e-03 3 1  ON 45
ci_047                -2.045540e-04 3 1  ON 46
ci_048                -7.891646e-04 3 1  ON 47
ci_049                 1.643046e-03 3 1  ON 48
ci_050                 1.616577e-03 3 1  ON 49
ci_051                -6.947708e-04 3 1  ON 50
ci_052                -1.071697e-03 3 1  ON 51
ci_053                -2.534884e-03 3 1  ON 52
ci_054                -3.257291e-03 3 1  ON 53
ci_055                -1.763257e-03 3 1  ON 54
ci_056                -2.315806e-03 3 1  ON 55
ci_057                -1.256033e-03 3 1  ON 56
ci_058                -2.176104e-03 3 1  ON 57
ci_059                -2.706367e-04 3 1  ON 58
ci_060                 9.518790e-05 3 1  ON 59
ci_061                 6.047307e-04 3 1  ON 60
ci_062                 5.209820e-04 3 1  ON 61
ci_063                -7.060655e-04 3 1  ON 62
ci_064                -2.750529e-03 3 1  ON 63
ci_065                -2.697204e-03 3 1  ON 64
ci_066                -2.672269e-03 3 1  ON 65
ci_067                -1.002118e-03 3 1  ON 66
ci_068                -3.458329e-03 3 1  ON 67
ci_069                 1.269801e-03 3 1  ON 68
ci_070                -1.026691e-04 3 1  ON 69
ci_071                -1.981929e-03 3 1  ON 70
ci_072                -5.248211e-04 3 1  ON 71
ci_073                 3.876008e-04 3 1  ON 72
ci_074                -3.426533e-04 3 1  ON 73
ci_075                -8.214463e-04 3 1  ON 74
ci_076                -5.761918e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.684
    reference variance = 0.48243
====================================================
  Execution time = 2.5702e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0728e-01
  Total weights = 1.9550e+06
  Execution time = 3.6580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493621866845
                                         uncertainty =       0.002974366822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493621866845
                                         uncertainty =       0.002974366822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496779771
  error estimate for blocks of size 2^( 2) =       0.000514521080
  error estimate for blocks of size 2^( 3) =       0.000529914578
  error estimate for blocks of size 2^( 4) =       0.000541084990
  error estimate for blocks of size 2^( 5) =       0.000547459841
  error estimate for blocks of size 2^( 6) =       0.000551274166
  error estimate for blocks of size 2^( 7) =       0.000552576547

      target function =                  N/A
              le_mean =     -22.669703986174
             les_mean =     514.422779592160
             stat err =       0.000548098886
             autocorr =       1.217278729346
              std dev =       0.702552689461
             le_variance =       0.493580281469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493619680757
                                         uncertainty =       0.002978913362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493619680757
                                         uncertainty =       0.002978913362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496778465
  error estimate for blocks of size 2^( 2) =       0.000514517050
  error estimate for blocks of size 2^( 3) =       0.000529909683
  error estimate for blocks of size 2^( 4) =       0.000541080747
  error estimate for blocks of size 2^( 5) =       0.000547459542
  error estimate for blocks of size 2^( 6) =       0.000551277717
  error estimate for blocks of size 2^( 7) =       0.000552575563

      target function =                  N/A
              le_mean =     -22.669704463113
             les_mean =     514.427388438490
             stat err =       0.000548098392
             autocorr =       1.217282935752
              std dev =       0.702550842429
             le_variance =       0.493577686198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493618229744
                                         uncertainty =       0.002976667581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493618229744
                                         uncertainty =       0.002976667581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496777834
  error estimate for blocks of size 2^( 2) =       0.000514517743
  error estimate for blocks of size 2^( 3) =       0.000529910891
  error estimate for blocks of size 2^( 4) =       0.000541081347
  error estimate for blocks of size 2^( 5) =       0.000547458037
  error estimate for blocks of size 2^( 6) =       0.000551274688
  error estimate for blocks of size 2^( 7) =       0.000552573764

      target function =                  N/A
              le_mean =     -22.669703854209
             les_mean =     514.423569327742
             stat err =       0.000548096959
             autocorr =       1.217279661848
              std dev =       0.702549950238
             le_variance =       0.493576432579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493621170794
                                         uncertainty =       0.002974651010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493621170794
                                         uncertainty =       0.002974651010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496779407
  error estimate for blocks of size 2^( 2) =       0.000514520549
  error estimate for blocks of size 2^( 3) =       0.000529914007
  error estimate for blocks of size 2^( 4) =       0.000541084430
  error estimate for blocks of size 2^( 5) =       0.000547459516
  error estimate for blocks of size 2^( 6) =       0.000551274133
  error estimate for blocks of size 2^( 7) =       0.000552576089

      target function =                  N/A
              le_mean =     -22.669703936817
             les_mean =     514.422755393940
             stat err =       0.000548098542
             autocorr =       1.217278983220
              std dev =       0.702552175133
             le_variance =       0.493579558784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669703986174        initial
     2.4414e+00     2.4414e+01             2.6973e-04       -22.669704463113  <--
     9.7656e+00     9.7656e+01             7.0632e-05       -22.669703854209
     3.9062e+01     3.9062e+02             1.7870e-05       -22.669703936817

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 4.3968e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -7.061821e-01 3 1  ON 0
ci_002                -7.048044e-01 3 1  ON 1
ci_003                -3.997284e-02 3 1  ON 2
ci_004                -3.767131e-02 3 1  ON 3
ci_005                 1.617916e-02 3 1  ON 4
ci_006                 1.493217e-02 3 1  ON 5
ci_007                 1.239330e-02 3 1  ON 6
ci_008                 1.180086e-02 3 1  ON 7
ci_009                -1.100016e-02 3 1  ON 8
ci_010                -1.306653e-02 3 1  ON 9
ci_011                -8.270609e-03 3 1  ON 10
ci_012                -8.869741e-03 3 1  ON 11
ci_013                 9.926181e-03 3 1  ON 12
ci_014                 8.403213e-03 3 1  ON 13
ci_015                 1.241531e-02 3 1  ON 14
ci_016                 1.268622e-02 3 1  ON 15
ci_017                 1.063529e-02 3 1  ON 16
ci_018                 1.083710e-02 3 1  ON 17
ci_019                -3.112670e-03 3 1  ON 18
ci_020                -2.476019e-03 3 1  ON 19
ci_021                -7.498803e-03 3 1  ON 20
ci_022                -9.094325e-03 3 1  ON 21
ci_023                 8.539363e-03 3 1  ON 22
ci_024                 7.555236e-03 3 1  ON 23
ci_025                 5.795848e-03 3 1  ON 24
ci_026                 4.590259e-03 3 1  ON 25
ci_027                 7.247196e-03 3 1  ON 26
ci_028                 7.317680e-03 3 1  ON 27
ci_029                -4.376651e-03 3 1  ON 28
ci_030                -5.700193e-03 3 1  ON 29
ci_031                -8.191933e-03 3 1  ON 30
ci_032                -7.375507e-03 3 1  ON 31
ci_033                 4.122360e-03 3 1  ON 32
ci_034                 4.336945e-03 3 1  ON 33
ci_035                 1.976872e-03 3 1  ON 34
ci_036                 2.298525e-03 3 1  ON 35
ci_037                 4.234342e-03 3 1  ON 36
ci_038                 4.862013e-03 3 1  ON 37
ci_039                 4.941240e-03 3 1  ON 38
ci_040                 5.178424e-03 3 1  ON 39
ci_041                 5.070724e-03 3 1  ON 40
ci_042                 6.100083e-03 3 1  ON 41
ci_043                 5.035349e-03 3 1  ON 42
ci_044                 5.236478e-03 3 1  ON 43
ci_045                 4.048273e-03 3 1  ON 44
ci_046                 3.045496e-03 3 1  ON 45
ci_047                -2.271258e-04 3 1  ON 46
ci_048                -7.759543e-04 3 1  ON 47
ci_049                 1.668314e-03 3 1  ON 48
ci_050                 1.653477e-03 3 1  ON 49
ci_051                -7.565344e-04 3 1  ON 50
ci_052                -1.068756e-03 3 1  ON 51
ci_053                -2.591106e-03 3 1  ON 52
ci_054                -3.227198e-03 3 1  ON 53
ci_055                -1.743319e-03 3 1  ON 54
ci_056                -2.315380e-03 3 1  ON 55
ci_057                -1.206866e-03 3 1  ON 56
ci_058                -2.179636e-03 3 1  ON 57
ci_059                -1.879277e-04 3 1  ON 58
ci_060                 8.910980e-05 3 1  ON 59
ci_061                 5.553159e-04 3 1  ON 60
ci_062                 4.795971e-04 3 1  ON 61
ci_063                -6.460370e-04 3 1  ON 62
ci_064                -2.631879e-03 3 1  ON 63
ci_065                -2.648899e-03 3 1  ON 64
ci_066                -2.708176e-03 3 1  ON 65
ci_067                -1.065321e-03 3 1  ON 66
ci_068                -3.352471e-03 3 1  ON 67
ci_069                 1.195186e-03 3 1  ON 68
ci_070                -3.001449e-05 3 1  ON 69
ci_071                -1.945230e-03 3 1  ON 70
ci_072                -6.276475e-04 3 1  ON 71
ci_073                 3.792705e-04 3 1  ON 72
ci_074                -2.855617e-04 3 1  ON 73
ci_075                -7.992432e-04 3 1  ON 74
ci_076                -5.707952e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7273e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6441
    reference variance = 0.377067
====================================================
  Execution time = 2.6305e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0377e-01
  Total weights = 1.955103847e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492231355048
                                         uncertainty =       0.002327883906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492231355048
                                         uncertainty =       0.002327883906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496157254
  error estimate for blocks of size 2^( 2) =       0.000513600573
  error estimate for blocks of size 2^( 3) =       0.000529689769
  error estimate for blocks of size 2^( 4) =       0.000541579171
  error estimate for blocks of size 2^( 5) =       0.000548183877
  error estimate for blocks of size 2^( 6) =       0.000552543440
  error estimate for blocks of size 2^( 7) =       0.000552763352

      target function =                  N/A
              le_mean =     -22.669273124067
             les_mean =     514.399712625827
             stat err =       0.000548767460
             autocorr =       1.223314187124
              std dev =       0.701672317158
             le_variance =       0.492344040666


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266927312407e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669273124141       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669284636832       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669284593618       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669284682612       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 5.257822e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669273124141       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669276597843       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669276632163       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669276633827       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 1.527593e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669273124141       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669274039939       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669274054016       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669274051940       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 4.029708e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033641 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1087e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -7.061629e-01 3 1  ON 0
ci_002                -7.048307e-01 3 1  ON 1
ci_003                -3.999416e-02 3 1  ON 2
ci_004                -3.768309e-02 3 1  ON 3
ci_005                 1.611009e-02 3 1  ON 4
ci_006                 1.504349e-02 3 1  ON 5
ci_007                 1.237704e-02 3 1  ON 6
ci_008                 1.179148e-02 3 1  ON 7
ci_009                -1.100823e-02 3 1  ON 8
ci_010                -1.297129e-02 3 1  ON 9
ci_011                -8.341378e-03 3 1  ON 10
ci_012                -8.798289e-03 3 1  ON 11
ci_013                 9.928783e-03 3 1  ON 12
ci_014                 8.421805e-03 3 1  ON 13
ci_015                 1.235687e-02 3 1  ON 14
ci_016                 1.266486e-02 3 1  ON 15
ci_017                 1.064026e-02 3 1  ON 16
ci_018                 1.087347e-02 3 1  ON 17
ci_019                -3.070258e-03 3 1  ON 18
ci_020                -2.522919e-03 3 1  ON 19
ci_021                -7.476702e-03 3 1  ON 20
ci_022                -9.004178e-03 3 1  ON 21
ci_023                 8.387642e-03 3 1  ON 22
ci_024                 7.698237e-03 3 1  ON 23
ci_025                 5.646200e-03 3 1  ON 24
ci_026                 4.629437e-03 3 1  ON 25
ci_027                 7.137681e-03 3 1  ON 26
ci_028                 7.334623e-03 3 1  ON 27
ci_029                -4.355143e-03 3 1  ON 28
ci_030                -5.660191e-03 3 1  ON 29
ci_031                -8.168711e-03 3 1  ON 30
ci_032                -7.360219e-03 3 1  ON 31
ci_033                 3.989874e-03 3 1  ON 32
ci_034                 4.342273e-03 3 1  ON 33
ci_035                 1.928758e-03 3 1  ON 34
ci_036                 2.192080e-03 3 1  ON 35
ci_037                 4.336089e-03 3 1  ON 36
ci_038                 4.872160e-03 3 1  ON 37
ci_039                 4.953364e-03 3 1  ON 38
ci_040                 5.191972e-03 3 1  ON 39
ci_041                 5.022566e-03 3 1  ON 40
ci_042                 6.039681e-03 3 1  ON 41
ci_043                 4.973302e-03 3 1  ON 42
ci_044                 5.179585e-03 3 1  ON 43
ci_045                 3.997707e-03 3 1  ON 44
ci_046                 2.973515e-03 3 1  ON 45
ci_047                -3.295644e-04 3 1  ON 46
ci_048                -7.377047e-04 3 1  ON 47
ci_049                 1.688490e-03 3 1  ON 48
ci_050                 1.656025e-03 3 1  ON 49
ci_051                -8.643960e-04 3 1  ON 50
ci_052                -1.152056e-03 3 1  ON 51
ci_053                -2.569831e-03 3 1  ON 52
ci_054                -3.212731e-03 3 1  ON 53
ci_055                -1.809059e-03 3 1  ON 54
ci_056                -2.310051e-03 3 1  ON 55
ci_057                -1.219396e-03 3 1  ON 56
ci_058                -2.174636e-03 3 1  ON 57
ci_059                -1.783006e-04 3 1  ON 58
ci_060                 9.340209e-05 3 1  ON 59
ci_061                 5.355934e-04 3 1  ON 60
ci_062                 5.176978e-04 3 1  ON 61
ci_063                -5.898204e-04 3 1  ON 62
ci_064                -2.575244e-03 3 1  ON 63
ci_065                -2.580401e-03 3 1  ON 64
ci_066                -2.790487e-03 3 1  ON 65
ci_067                -1.158634e-03 3 1  ON 66
ci_068                -3.305377e-03 3 1  ON 67
ci_069                 1.153859e-03 3 1  ON 68
ci_070                -4.739074e-05 3 1  ON 69
ci_071                -1.969150e-03 3 1  ON 70
ci_072                -7.804068e-04 3 1  ON 71
ci_073                 4.610835e-04 3 1  ON 72
ci_074                -2.134276e-04 3 1  ON 73
ci_075                -8.015649e-04 3 1  ON 74
ci_076                -5.739842e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6355
    reference variance = 0.412169
====================================================
  Execution time = 2.5777e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1041e-01
  Total weights = 1.9552e+06
  Execution time = 3.6370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499258654843
                                         uncertainty =       0.003232585216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499258654843
                                         uncertainty =       0.003232585216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499592556
  error estimate for blocks of size 2^( 2) =       0.000517622009
  error estimate for blocks of size 2^( 3) =       0.000532891702
  error estimate for blocks of size 2^( 4) =       0.000544234896
  error estimate for blocks of size 2^( 5) =       0.000550837469
  error estimate for blocks of size 2^( 6) =       0.000555324683
  error estimate for blocks of size 2^( 7) =       0.000557027823

      target function =                  N/A
              le_mean =     -22.668743562519
             les_mean =     514.382649726056
             stat err =       0.000551856218
             autocorr =       1.220168930244
              std dev =       0.706530568881
             le_variance =       0.499185444764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499152475090
                                         uncertainty =       0.003215669492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499152475090
                                         uncertainty =       0.003215669492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499539484
  error estimate for blocks of size 2^( 2) =       0.000517573738
  error estimate for blocks of size 2^( 3) =       0.000532847254
  error estimate for blocks of size 2^( 4) =       0.000544187466
  error estimate for blocks of size 2^( 5) =       0.000550781772
  error estimate for blocks of size 2^( 6) =       0.000555285355
  error estimate for blocks of size 2^( 7) =       0.000556958050

      target function =                  N/A
              le_mean =     -22.668742918468
             les_mean =     514.442483955487
             stat err =       0.000551803160
             autocorr =       1.220193551762
              std dev =       0.706455513050
             le_variance =       0.499079391918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499180006067
                                         uncertainty =       0.003222947276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499180006067
                                         uncertainty =       0.003222947276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499553241
  error estimate for blocks of size 2^( 2) =       0.000517585988
  error estimate for blocks of size 2^( 3) =       0.000532858802
  error estimate for blocks of size 2^( 4) =       0.000544204054
  error estimate for blocks of size 2^( 5) =       0.000550802443
  error estimate for blocks of size 2^( 6) =       0.000555296530
  error estimate for blocks of size 2^( 7) =       0.000556987575

      target function =                  N/A
              le_mean =     -22.668740143428
             les_mean =     514.382367010583
             stat err =       0.000551822650
             autocorr =       1.220212537828
              std dev =       0.706474969065
             le_variance =       0.499106881916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499246434925
                                         uncertainty =       0.003231212064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499246434925
                                         uncertainty =       0.003231212064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499586448
  error estimate for blocks of size 2^( 2) =       0.000517616306
  error estimate for blocks of size 2^( 3) =       0.000532886439
  error estimate for blocks of size 2^( 4) =       0.000544229885
  error estimate for blocks of size 2^( 5) =       0.000550831934
  error estimate for blocks of size 2^( 6) =       0.000555320175
  error estimate for blocks of size 2^( 7) =       0.000557021585

      target function =                  N/A
              le_mean =     -22.668742856599
             les_mean =     514.382477612962
             stat err =       0.000551850895
             autocorr =       1.220175228786
              std dev =       0.706521930328
             le_variance =       0.499173238034


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668743562519        initial  <--
     6.1035e-01     6.1035e+00             5.2578e-04       -22.668742918468
     2.4414e+00     2.4414e+01             1.5276e-04       -22.668740143428
     9.7656e+00     9.7656e+01             4.0297e-05       -22.668742856599

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0039
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -7.061821e-01 3 1  ON 0
ci_002                -7.048044e-01 3 1  ON 1
ci_003                -3.997284e-02 3 1  ON 2
ci_004                -3.767131e-02 3 1  ON 3
ci_005                 1.617916e-02 3 1  ON 4
ci_006                 1.493217e-02 3 1  ON 5
ci_007                 1.239330e-02 3 1  ON 6
ci_008                 1.180086e-02 3 1  ON 7
ci_009                -1.100016e-02 3 1  ON 8
ci_010                -1.306653e-02 3 1  ON 9
ci_011                -8.270609e-03 3 1  ON 10
ci_012                -8.869741e-03 3 1  ON 11
ci_013                 9.926181e-03 3 1  ON 12
ci_014                 8.403213e-03 3 1  ON 13
ci_015                 1.241531e-02 3 1  ON 14
ci_016                 1.268622e-02 3 1  ON 15
ci_017                 1.063529e-02 3 1  ON 16
ci_018                 1.083710e-02 3 1  ON 17
ci_019                -3.112670e-03 3 1  ON 18
ci_020                -2.476019e-03 3 1  ON 19
ci_021                -7.498803e-03 3 1  ON 20
ci_022                -9.094325e-03 3 1  ON 21
ci_023                 8.539363e-03 3 1  ON 22
ci_024                 7.555236e-03 3 1  ON 23
ci_025                 5.795848e-03 3 1  ON 24
ci_026                 4.590259e-03 3 1  ON 25
ci_027                 7.247196e-03 3 1  ON 26
ci_028                 7.317680e-03 3 1  ON 27
ci_029                -4.376651e-03 3 1  ON 28
ci_030                -5.700193e-03 3 1  ON 29
ci_031                -8.191933e-03 3 1  ON 30
ci_032                -7.375507e-03 3 1  ON 31
ci_033                 4.122360e-03 3 1  ON 32
ci_034                 4.336945e-03 3 1  ON 33
ci_035                 1.976872e-03 3 1  ON 34
ci_036                 2.298525e-03 3 1  ON 35
ci_037                 4.234342e-03 3 1  ON 36
ci_038                 4.862013e-03 3 1  ON 37
ci_039                 4.941240e-03 3 1  ON 38
ci_040                 5.178424e-03 3 1  ON 39
ci_041                 5.070724e-03 3 1  ON 40
ci_042                 6.100083e-03 3 1  ON 41
ci_043                 5.035349e-03 3 1  ON 42
ci_044                 5.236478e-03 3 1  ON 43
ci_045                 4.048273e-03 3 1  ON 44
ci_046                 3.045496e-03 3 1  ON 45
ci_047                -2.271258e-04 3 1  ON 46
ci_048                -7.759543e-04 3 1  ON 47
ci_049                 1.668314e-03 3 1  ON 48
ci_050                 1.653477e-03 3 1  ON 49
ci_051                -7.565344e-04 3 1  ON 50
ci_052                -1.068756e-03 3 1  ON 51
ci_053                -2.591106e-03 3 1  ON 52
ci_054                -3.227198e-03 3 1  ON 53
ci_055                -1.743319e-03 3 1  ON 54
ci_056                -2.315380e-03 3 1  ON 55
ci_057                -1.206866e-03 3 1  ON 56
ci_058                -2.179636e-03 3 1  ON 57
ci_059                -1.879277e-04 3 1  ON 58
ci_060                 8.910980e-05 3 1  ON 59
ci_061                 5.553159e-04 3 1  ON 60
ci_062                 4.795971e-04 3 1  ON 61
ci_063                -6.460370e-04 3 1  ON 62
ci_064                -2.631879e-03 3 1  ON 63
ci_065                -2.648899e-03 3 1  ON 64
ci_066                -2.708176e-03 3 1  ON 65
ci_067                -1.065321e-03 3 1  ON 66
ci_068                -3.352471e-03 3 1  ON 67
ci_069                 1.195186e-03 3 1  ON 68
ci_070                -3.001449e-05 3 1  ON 69
ci_071                -1.945230e-03 3 1  ON 70
ci_072                -6.276475e-04 3 1  ON 71
ci_073                 3.792705e-04 3 1  ON 72
ci_074                -2.855617e-04 3 1  ON 73
ci_075                -7.992432e-04 3 1  ON 74
ci_076                -5.707952e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5097e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6959
    reference variance = 0.506885
====================================================
  Execution time = 2.6287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0898e-01
  Total weights = 1.955394656e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496746472618
                                         uncertainty =       0.002747706234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496746472618
                                         uncertainty =       0.002747706234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498286798
  error estimate for blocks of size 2^( 2) =       0.000516392442
  error estimate for blocks of size 2^( 3) =       0.000532247475
  error estimate for blocks of size 2^( 4) =       0.000544605703
  error estimate for blocks of size 2^( 5) =       0.000550843367
  error estimate for blocks of size 2^( 6) =       0.000554217212
  error estimate for blocks of size 2^( 7) =       0.000556580271

      target function =                  N/A
              le_mean =     -22.670255665539
             les_mean =     514.449471098435
             stat err =       0.000551561638
             autocorr =       1.225263068998
              std dev =       0.704683948013
             le_variance =       0.496579466587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267025566554e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670255665640       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670256903247       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670256951007       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670256939747       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 9.768549e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670255665640       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670255981691       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670255994114       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670255991210       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+01 is 2.495413e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670255665640       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670255745079       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670255748217       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670255747486       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+01 is 6.272766e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1077e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -7.061871e-01 3 1  ON 0
ci_002                -7.048004e-01 3 1  ON 1
ci_003                -3.997161e-02 3 1  ON 2
ci_004                -3.767271e-02 3 1  ON 3
ci_005                 1.616849e-02 3 1  ON 4
ci_006                 1.494754e-02 3 1  ON 5
ci_007                 1.239668e-02 3 1  ON 6
ci_008                 1.178980e-02 3 1  ON 7
ci_009                -1.099068e-02 3 1  ON 8
ci_010                -1.305737e-02 3 1  ON 9
ci_011                -8.270629e-03 3 1  ON 10
ci_012                -8.862041e-03 3 1  ON 11
ci_013                 9.918782e-03 3 1  ON 12
ci_014                 8.410098e-03 3 1  ON 13
ci_015                 1.241646e-02 3 1  ON 14
ci_016                 1.268783e-02 3 1  ON 15
ci_017                 1.063033e-02 3 1  ON 16
ci_018                 1.084383e-02 3 1  ON 17
ci_019                -3.111568e-03 3 1  ON 18
ci_020                -2.476806e-03 3 1  ON 19
ci_021                -7.505876e-03 3 1  ON 20
ci_022                -9.085063e-03 3 1  ON 21
ci_023                 8.534637e-03 3 1  ON 22
ci_024                 7.555977e-03 3 1  ON 23
ci_025                 5.783709e-03 3 1  ON 24
ci_026                 4.587359e-03 3 1  ON 25
ci_027                 7.235422e-03 3 1  ON 26
ci_028                 7.313978e-03 3 1  ON 27
ci_029                -4.378467e-03 3 1  ON 28
ci_030                -5.685046e-03 3 1  ON 29
ci_031                -8.189694e-03 3 1  ON 30
ci_032                -7.384361e-03 3 1  ON 31
ci_033                 4.114060e-03 3 1  ON 32
ci_034                 4.341947e-03 3 1  ON 33
ci_035                 1.972515e-03 3 1  ON 34
ci_036                 2.285531e-03 3 1  ON 35
ci_037                 4.241191e-03 3 1  ON 36
ci_038                 4.864658e-03 3 1  ON 37
ci_039                 4.953860e-03 3 1  ON 38
ci_040                 5.182732e-03 3 1  ON 39
ci_041                 5.072606e-03 3 1  ON 40
ci_042                 6.089397e-03 3 1  ON 41
ci_043                 5.032135e-03 3 1  ON 42
ci_044                 5.238609e-03 3 1  ON 43
ci_045                 4.045542e-03 3 1  ON 44
ci_046                 3.052588e-03 3 1  ON 45
ci_047                -2.343809e-04 3 1  ON 46
ci_048                -7.700550e-04 3 1  ON 47
ci_049                 1.662429e-03 3 1  ON 48
ci_050                 1.646458e-03 3 1  ON 49
ci_051                -7.657142e-04 3 1  ON 50
ci_052                -1.075758e-03 3 1  ON 51
ci_053                -2.589827e-03 3 1  ON 52
ci_054                -3.218742e-03 3 1  ON 53
ci_055                -1.745854e-03 3 1  ON 54
ci_056                -2.309675e-03 3 1  ON 55
ci_057                -1.199363e-03 3 1  ON 56
ci_058                -2.176254e-03 3 1  ON 57
ci_059                -1.788666e-04 3 1  ON 58
ci_060                 8.605612e-05 3 1  ON 59
ci_061                 5.545849e-04 3 1  ON 60
ci_062                 4.762775e-04 3 1  ON 61
ci_063                -6.409455e-04 3 1  ON 62
ci_064                -2.608119e-03 3 1  ON 63
ci_065                -2.643461e-03 3 1  ON 64
ci_066                -2.683222e-03 3 1  ON 65
ci_067                -1.082125e-03 3 1  ON 66
ci_068                -3.341371e-03 3 1  ON 67
ci_069                 1.192480e-03 3 1  ON 68
ci_070                -2.660081e-05 3 1  ON 69
ci_071                -1.947626e-03 3 1  ON 70
ci_072                -6.336141e-04 3 1  ON 71
ci_073                 3.765218e-04 3 1  ON 72
ci_074                -2.929103e-04 3 1  ON 73
ci_075                -7.916540e-04 3 1  ON 74
ci_076                -5.650082e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7218
    reference variance = 0.472337
====================================================
  Execution time = 2.5500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0926e-01
  Total weights = 1.9552e+06
  Execution time = 3.6440e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494572599229
                                         uncertainty =       0.003633752768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494572599229
                                         uncertainty =       0.003633752768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497242694
  error estimate for blocks of size 2^( 2) =       0.000515078445
  error estimate for blocks of size 2^( 3) =       0.000530212591
  error estimate for blocks of size 2^( 4) =       0.000542126219
  error estimate for blocks of size 2^( 5) =       0.000548861041
  error estimate for blocks of size 2^( 6) =       0.000552295472
  error estimate for blocks of size 2^( 7) =       0.000554487490

      target function =                  N/A
              le_mean =     -22.669371826417
             les_mean =     514.409609164510
             stat err =       0.000549442556
             autocorr =       1.220977793242
              std dev =       0.703207361932
             le_variance =       0.494500593875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494561619743
                                         uncertainty =       0.003630789194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494561619743
                                         uncertainty =       0.003630789194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497237202
  error estimate for blocks of size 2^( 2) =       0.000515071765
  error estimate for blocks of size 2^( 3) =       0.000530206077
  error estimate for blocks of size 2^( 4) =       0.000542118664
  error estimate for blocks of size 2^( 5) =       0.000548851513
  error estimate for blocks of size 2^( 6) =       0.000552285560
  error estimate for blocks of size 2^( 7) =       0.000554472840

      target function =                  N/A
              le_mean =     -22.669372375295
             les_mean =     514.441536923353
             stat err =       0.000549432144
             autocorr =       1.220958491401
              std dev =       0.703199594927
             le_variance =       0.494489670306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494566285394
                                         uncertainty =       0.003632225036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494566285394
                                         uncertainty =       0.003632225036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497239535
  error estimate for blocks of size 2^( 2) =       0.000515075175
  error estimate for blocks of size 2^( 3) =       0.000530209666
  error estimate for blocks of size 2^( 4) =       0.000542123004
  error estimate for blocks of size 2^( 5) =       0.000548856372
  error estimate for blocks of size 2^( 6) =       0.000552290839
  error estimate for blocks of size 2^( 7) =       0.000554480515

      target function =                  N/A
              le_mean =     -22.669371856596
             les_mean =     514.409805045658
             stat err =       0.000549437683
             autocorr =       1.220971651419
              std dev =       0.703202894014
             le_variance =       0.494494310150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494571753455
                                         uncertainty =       0.003633557651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494571753455
                                         uncertainty =       0.003633557651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497242271
  error estimate for blocks of size 2^( 2) =       0.000515078011
  error estimate for blocks of size 2^( 3) =       0.000530212202
  error estimate for blocks of size 2^( 4) =       0.000542125793
  error estimate for blocks of size 2^( 5) =       0.000548860424
  error estimate for blocks of size 2^( 6) =       0.000552294856
  error estimate for blocks of size 2^( 7) =       0.000554486576

      target function =                  N/A
              le_mean =     -22.669371823516
             les_mean =     514.409611267892
             stat err =       0.000549441912
             autocorr =       1.220977012893
              std dev =       0.703206763316
             le_variance =       0.494499751973


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669371826417        initial
     6.1035e+00     6.1035e+01             9.7685e-05       -22.669372375295  <--
     2.4414e+01     2.4414e+02             2.4954e-05       -22.669371856596
     9.7656e+01     9.7656e+02             6.2728e-06       -22.669371823516

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 4.3740e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996795e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499192e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270676e-03 3 1  ON 10
ci_012                -8.839499e-03 3 1  ON 11
ci_013                 9.897142e-03 3 1  ON 12
ci_014                 8.430522e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108299e-03 3 1  ON 18
ci_020                -2.479067e-03 3 1  ON 19
ci_021                -7.526794e-03 3 1  ON 20
ci_022                -9.057726e-03 3 1  ON 21
ci_023                 8.520916e-03 3 1  ON 22
ci_024                 7.558117e-03 3 1  ON 23
ci_025                 5.748061e-03 3 1  ON 24
ci_026                 4.578842e-03 3 1  ON 25
ci_027                 7.201616e-03 3 1  ON 26
ci_028                 7.303320e-03 3 1  ON 27
ci_029                -4.383739e-03 3 1  ON 28
ci_030                -5.640867e-03 3 1  ON 29
ci_031                -8.182958e-03 3 1  ON 30
ci_032                -7.410466e-03 3 1  ON 31
ci_033                 4.089760e-03 3 1  ON 32
ci_034                 4.356571e-03 3 1  ON 33
ci_035                 1.959989e-03 3 1  ON 34
ci_036                 2.248305e-03 3 1  ON 35
ci_037                 4.261135e-03 3 1  ON 36
ci_038                 4.872383e-03 3 1  ON 37
ci_039                 4.990238e-03 3 1  ON 38
ci_040                 5.195085e-03 3 1  ON 39
ci_041                 5.078102e-03 3 1  ON 40
ci_042                 6.058367e-03 3 1  ON 41
ci_043                 5.022663e-03 3 1  ON 42
ci_044                 5.244665e-03 3 1  ON 43
ci_045                 4.037718e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551844e-04 3 1  ON 46
ci_048                -7.531022e-04 3 1  ON 47
ci_049                 1.645210e-03 3 1  ON 48
ci_050                 1.625923e-03 3 1  ON 49
ci_051                -7.925802e-04 3 1  ON 50
ci_052                -1.096106e-03 3 1  ON 51
ci_053                -2.586065e-03 3 1  ON 52
ci_054                -3.194041e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292984e-03 3 1  ON 55
ci_057                -1.177486e-03 3 1  ON 56
ci_058                -2.166397e-03 3 1  ON 57
ci_059                -1.527610e-04 3 1  ON 58
ci_060                 7.734760e-05 3 1  ON 59
ci_061                 5.523849e-04 3 1  ON 60
ci_062                 4.665825e-04 3 1  ON 61
ci_063                -6.261120e-04 3 1  ON 62
ci_064                -2.538533e-03 3 1  ON 63
ci_065                -2.627447e-03 3 1  ON 64
ci_066                -2.610491e-03 3 1  ON 65
ci_067                -1.131316e-03 3 1  ON 66
ci_068                -3.308904e-03 3 1  ON 67
ci_069                 1.184533e-03 3 1  ON 68
ci_070                -1.683561e-05 3 1  ON 69
ci_071                -1.954611e-03 3 1  ON 70
ci_072                -6.509043e-04 3 1  ON 71
ci_073                 3.685216e-04 3 1  ON 72
ci_074                -3.140064e-04 3 1  ON 73
ci_075                -7.695082e-04 3 1  ON 74
ci_076                -5.482234e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4824e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6586
    reference variance = 0.601873
====================================================
  Execution time = 2.6248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1042e-01
  Total weights = 1.954978674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499030985982
                                         uncertainty =       0.002991127078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499030985982
                                         uncertainty =       0.002991127078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499510397
  error estimate for blocks of size 2^( 2) =       0.000517435996
  error estimate for blocks of size 2^( 3) =       0.000533587300
  error estimate for blocks of size 2^( 4) =       0.000545792834
  error estimate for blocks of size 2^( 5) =       0.000551619734
  error estimate for blocks of size 2^( 6) =       0.000554388705
  error estimate for blocks of size 2^( 7) =       0.000558760302

      target function =                  N/A
              le_mean =     -22.669525688813
             les_mean =     514.417812330778
             stat err =       0.000552640394
             autocorr =       1.224041623130
              std dev =       0.706414378016
             le_variance =       0.499021273467


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266952568881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669525688890       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669530262573       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669530346167       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669530342825       residual = 5.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.609167e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669525688890       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669526929863       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669526948525       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669526946477       residual = 7.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 7.035452e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669525688890       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669526005895       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669526010439       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669526009858       residual = 8.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+01 is 1.794249e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1030e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -7.061980e-01 3 1  ON 0
ci_002                -7.047946e-01 3 1  ON 1
ci_003                -3.995277e-02 3 1  ON 2
ci_004                -3.768954e-02 3 1  ON 3
ci_005                 1.616464e-02 3 1  ON 4
ci_006                 1.501766e-02 3 1  ON 5
ci_007                 1.241474e-02 3 1  ON 6
ci_008                 1.179690e-02 3 1  ON 7
ci_009                -1.095125e-02 3 1  ON 8
ci_010                -1.298885e-02 3 1  ON 9
ci_011                -8.271112e-03 3 1  ON 10
ci_012                -8.824086e-03 3 1  ON 11
ci_013                 9.899318e-03 3 1  ON 12
ci_014                 8.435761e-03 3 1  ON 13
ci_015                 1.240836e-02 3 1  ON 14
ci_016                 1.267145e-02 3 1  ON 15
ci_017                 1.060608e-02 3 1  ON 16
ci_018                 1.088756e-02 3 1  ON 17
ci_019                -3.098998e-03 3 1  ON 18
ci_020                -2.503105e-03 3 1  ON 19
ci_021                -7.516644e-03 3 1  ON 20
ci_022                -9.051220e-03 3 1  ON 21
ci_023                 8.463171e-03 3 1  ON 22
ci_024                 7.599497e-03 3 1  ON 23
ci_025                 5.728114e-03 3 1  ON 24
ci_026                 4.563183e-03 3 1  ON 25
ci_027                 7.165580e-03 3 1  ON 26
ci_028                 7.273823e-03 3 1  ON 27
ci_029                -4.384125e-03 3 1  ON 28
ci_030                -5.632021e-03 3 1  ON 29
ci_031                -8.181593e-03 3 1  ON 30
ci_032                -7.444690e-03 3 1  ON 31
ci_033                 4.082948e-03 3 1  ON 32
ci_034                 4.333994e-03 3 1  ON 33
ci_035                 1.935129e-03 3 1  ON 34
ci_036                 2.199574e-03 3 1  ON 35
ci_037                 4.299394e-03 3 1  ON 36
ci_038                 4.885250e-03 3 1  ON 37
ci_039                 5.054017e-03 3 1  ON 38
ci_040                 5.192368e-03 3 1  ON 39
ci_041                 5.055755e-03 3 1  ON 40
ci_042                 6.033916e-03 3 1  ON 41
ci_043                 5.023145e-03 3 1  ON 42
ci_044                 5.245417e-03 3 1  ON 43
ci_045                 3.995561e-03 3 1  ON 44
ci_046                 3.093169e-03 3 1  ON 45
ci_047                -2.394396e-04 3 1  ON 46
ci_048                -7.365143e-04 3 1  ON 47
ci_049                 1.634201e-03 3 1  ON 48
ci_050                 1.642338e-03 3 1  ON 49
ci_051                -7.647866e-04 3 1  ON 50
ci_052                -1.105267e-03 3 1  ON 51
ci_053                -2.596042e-03 3 1  ON 52
ci_054                -3.183194e-03 3 1  ON 53
ci_055                -1.764864e-03 3 1  ON 54
ci_056                -2.303308e-03 3 1  ON 55
ci_057                -1.210895e-03 3 1  ON 56
ci_058                -2.159562e-03 3 1  ON 57
ci_059                -1.276624e-04 3 1  ON 58
ci_060                 1.075349e-04 3 1  ON 59
ci_061                 5.822188e-04 3 1  ON 60
ci_062                 4.167135e-04 3 1  ON 61
ci_063                -6.307262e-04 3 1  ON 62
ci_064                -2.505451e-03 3 1  ON 63
ci_065                -2.591686e-03 3 1  ON 64
ci_066                -2.540136e-03 3 1  ON 65
ci_067                -1.167371e-03 3 1  ON 66
ci_068                -3.243733e-03 3 1  ON 67
ci_069                 1.165225e-03 3 1  ON 68
ci_070                -2.032675e-05 3 1  ON 69
ci_071                -1.921126e-03 3 1  ON 70
ci_072                -6.789574e-04 3 1  ON 71
ci_073                 3.801876e-04 3 1  ON 72
ci_074                -2.744749e-04 3 1  ON 73
ci_075                -7.378675e-04 3 1  ON 74
ci_076                -5.477321e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7432
    reference variance = 0.567236
====================================================
  Execution time = 2.5583e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0995e-01
  Total weights = 1.9554e+06
  Execution time = 3.6444e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497449421910
                                         uncertainty =       0.002685972318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497449421910
                                         uncertainty =       0.002685972318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498779540
  error estimate for blocks of size 2^( 2) =       0.000516544009
  error estimate for blocks of size 2^( 3) =       0.000532636227
  error estimate for blocks of size 2^( 4) =       0.000544323059
  error estimate for blocks of size 2^( 5) =       0.000549480330
  error estimate for blocks of size 2^( 6) =       0.000553607278
  error estimate for blocks of size 2^( 7) =       0.000555891608

      target function =                  N/A
              le_mean =     -22.670134585127
             les_mean =     514.444980892323
             stat err =       0.000550825569
             autocorr =       1.219581765026
              std dev =       0.705380790391
             le_variance =       0.497562059452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497426341691
                                         uncertainty =       0.002677715418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497426341691
                                         uncertainty =       0.002677715418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498768065
  error estimate for blocks of size 2^( 2) =       0.000516530969
  error estimate for blocks of size 2^( 3) =       0.000532620969
  error estimate for blocks of size 2^( 4) =       0.000544300814
  error estimate for blocks of size 2^( 5) =       0.000549458305
  error estimate for blocks of size 2^( 6) =       0.000553583288
  error estimate for blocks of size 2^( 7) =       0.000555865417

      target function =                  N/A
              le_mean =     -22.670132349197
             les_mean =     514.446593795316
             stat err =       0.000550801956
             autocorr =       1.219533320728
              std dev =       0.705364561471
             le_variance =       0.497539164579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497434431142
                                         uncertainty =       0.002681510000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497434431142
                                         uncertainty =       0.002681510000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498772076
  error estimate for blocks of size 2^( 2) =       0.000516535661
  error estimate for blocks of size 2^( 3) =       0.000532626913
  error estimate for blocks of size 2^( 4) =       0.000544310100
  error estimate for blocks of size 2^( 5) =       0.000549467553
  error estimate for blocks of size 2^( 6) =       0.000553592222
  error estimate for blocks of size 2^( 7) =       0.000555875587

      target function =                  N/A
              le_mean =     -22.670132709914
             les_mean =     514.444941851653
             stat err =       0.000550811366
             autocorr =       1.219555372324
              std dev =       0.705370234313
             le_variance =       0.497547167455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497447175566
                                         uncertainty =       0.002685389301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497447175566
                                         uncertainty =       0.002685389301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498778421
  error estimate for blocks of size 2^( 2) =       0.000516542781
  error estimate for blocks of size 2^( 3) =       0.000532634880
  error estimate for blocks of size 2^( 4) =       0.000544321249
  error estimate for blocks of size 2^( 5) =       0.000549478537
  error estimate for blocks of size 2^( 6) =       0.000553605218
  error estimate for blocks of size 2^( 7) =       0.000555889370

      target function =                  N/A
              le_mean =     -22.670134306455
             les_mean =     514.444955426782
             stat err =       0.000550823594
             autocorr =       1.219578492967
              std dev =       0.705379207132
             le_variance =       0.497559825855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670134585127        initial  <--
     1.5259e+00     1.5259e+01             2.6092e-04       -22.670132349197
     6.1035e+00     6.1035e+01             7.0355e-05       -22.670132709914
     2.4414e+01     2.4414e+02             1.7942e-05       -22.670134306455

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8488
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996795e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499192e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270676e-03 3 1  ON 10
ci_012                -8.839499e-03 3 1  ON 11
ci_013                 9.897142e-03 3 1  ON 12
ci_014                 8.430522e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108299e-03 3 1  ON 18
ci_020                -2.479067e-03 3 1  ON 19
ci_021                -7.526794e-03 3 1  ON 20
ci_022                -9.057726e-03 3 1  ON 21
ci_023                 8.520916e-03 3 1  ON 22
ci_024                 7.558117e-03 3 1  ON 23
ci_025                 5.748061e-03 3 1  ON 24
ci_026                 4.578842e-03 3 1  ON 25
ci_027                 7.201616e-03 3 1  ON 26
ci_028                 7.303320e-03 3 1  ON 27
ci_029                -4.383739e-03 3 1  ON 28
ci_030                -5.640867e-03 3 1  ON 29
ci_031                -8.182958e-03 3 1  ON 30
ci_032                -7.410466e-03 3 1  ON 31
ci_033                 4.089760e-03 3 1  ON 32
ci_034                 4.356571e-03 3 1  ON 33
ci_035                 1.959989e-03 3 1  ON 34
ci_036                 2.248305e-03 3 1  ON 35
ci_037                 4.261135e-03 3 1  ON 36
ci_038                 4.872383e-03 3 1  ON 37
ci_039                 4.990238e-03 3 1  ON 38
ci_040                 5.195085e-03 3 1  ON 39
ci_041                 5.078102e-03 3 1  ON 40
ci_042                 6.058367e-03 3 1  ON 41
ci_043                 5.022663e-03 3 1  ON 42
ci_044                 5.244665e-03 3 1  ON 43
ci_045                 4.037718e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551844e-04 3 1  ON 46
ci_048                -7.531022e-04 3 1  ON 47
ci_049                 1.645210e-03 3 1  ON 48
ci_050                 1.625923e-03 3 1  ON 49
ci_051                -7.925802e-04 3 1  ON 50
ci_052                -1.096106e-03 3 1  ON 51
ci_053                -2.586065e-03 3 1  ON 52
ci_054                -3.194041e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292984e-03 3 1  ON 55
ci_057                -1.177486e-03 3 1  ON 56
ci_058                -2.166397e-03 3 1  ON 57
ci_059                -1.527610e-04 3 1  ON 58
ci_060                 7.734760e-05 3 1  ON 59
ci_061                 5.523849e-04 3 1  ON 60
ci_062                 4.665825e-04 3 1  ON 61
ci_063                -6.261120e-04 3 1  ON 62
ci_064                -2.538533e-03 3 1  ON 63
ci_065                -2.627447e-03 3 1  ON 64
ci_066                -2.610491e-03 3 1  ON 65
ci_067                -1.131316e-03 3 1  ON 66
ci_068                -3.308904e-03 3 1  ON 67
ci_069                 1.184533e-03 3 1  ON 68
ci_070                -1.683561e-05 3 1  ON 69
ci_071                -1.954611e-03 3 1  ON 70
ci_072                -6.509043e-04 3 1  ON 71
ci_073                 3.685216e-04 3 1  ON 72
ci_074                -3.140064e-04 3 1  ON 73
ci_075                -7.695082e-04 3 1  ON 74
ci_076                -5.482234e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7163
    reference variance = 0.8076
====================================================
  Execution time = 2.8075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0757e-01
  Total weights = 1.954717984e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492367868319
                                         uncertainty =       0.002516010328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492367868319
                                         uncertainty =       0.002516010328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496119614
  error estimate for blocks of size 2^( 2) =       0.000514206443
  error estimate for blocks of size 2^( 3) =       0.000530577142
  error estimate for blocks of size 2^( 4) =       0.000541675617
  error estimate for blocks of size 2^( 5) =       0.000549209983
  error estimate for blocks of size 2^( 6) =       0.000553731275
  error estimate for blocks of size 2^( 7) =       0.000552925566

      target function =                  N/A
              le_mean =     -22.670313462651
             les_mean =     514.450680260081
             stat err =       0.000549385610
             autocorr =       1.226257752815
              std dev =       0.701619086345
             le_variance =       0.492269342324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267031346265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670313462744       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670314151986       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670314143288       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670314146661       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 3.042642e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670313462744       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670313636528       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670313634463       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670313635285       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+01 is 7.711668e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670313462744       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670313506283       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670313505774       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670313505978       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+02 is 1.934606e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2866e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -7.062011e-01 3 1  ON 0
ci_002                -7.047897e-01 3 1  ON 1
ci_003                -3.996712e-02 3 1  ON 2
ci_004                -3.767808e-02 3 1  ON 3
ci_005                 1.613879e-02 3 1  ON 4
ci_006                 1.499731e-02 3 1  ON 5
ci_007                 1.240618e-02 3 1  ON 6
ci_008                 1.176104e-02 3 1  ON 7
ci_009                -1.096748e-02 3 1  ON 8
ci_010                -1.302727e-02 3 1  ON 9
ci_011                -8.273224e-03 3 1  ON 10
ci_012                -8.838559e-03 3 1  ON 11
ci_013                 9.897651e-03 3 1  ON 12
ci_014                 8.433915e-03 3 1  ON 13
ci_015                 1.241590e-02 3 1  ON 14
ci_016                 1.269544e-02 3 1  ON 15
ci_017                 1.061259e-02 3 1  ON 16
ci_018                 1.086510e-02 3 1  ON 17
ci_019                -3.106599e-03 3 1  ON 18
ci_020                -2.479267e-03 3 1  ON 19
ci_021                -7.527511e-03 3 1  ON 20
ci_022                -9.052077e-03 3 1  ON 21
ci_023                 8.524447e-03 3 1  ON 22
ci_024                 7.559862e-03 3 1  ON 23
ci_025                 5.745008e-03 3 1  ON 24
ci_026                 4.578551e-03 3 1  ON 25
ci_027                 7.198638e-03 3 1  ON 26
ci_028                 7.303334e-03 3 1  ON 27
ci_029                -4.387535e-03 3 1  ON 28
ci_030                -5.640194e-03 3 1  ON 29
ci_031                -8.178717e-03 3 1  ON 30
ci_032                -7.413663e-03 3 1  ON 31
ci_033                 4.086634e-03 3 1  ON 32
ci_034                 4.357348e-03 3 1  ON 33
ci_035                 1.957633e-03 3 1  ON 34
ci_036                 2.240594e-03 3 1  ON 35
ci_037                 4.261902e-03 3 1  ON 36
ci_038                 4.870480e-03 3 1  ON 37
ci_039                 4.995581e-03 3 1  ON 38
ci_040                 5.191803e-03 3 1  ON 39
ci_041                 5.078370e-03 3 1  ON 40
ci_042                 6.051169e-03 3 1  ON 41
ci_043                 5.022812e-03 3 1  ON 42
ci_044                 5.242436e-03 3 1  ON 43
ci_045                 4.034450e-03 3 1  ON 44
ci_046                 3.077588e-03 3 1  ON 45
ci_047                -2.535989e-04 3 1  ON 46
ci_048                -7.547995e-04 3 1  ON 47
ci_049                 1.642010e-03 3 1  ON 48
ci_050                 1.620255e-03 3 1  ON 49
ci_051                -7.967914e-04 3 1  ON 50
ci_052                -1.094949e-03 3 1  ON 51
ci_053                -2.585021e-03 3 1  ON 52
ci_054                -3.189714e-03 3 1  ON 53
ci_055                -1.751585e-03 3 1  ON 54
ci_056                -2.290780e-03 3 1  ON 55
ci_057                -1.178350e-03 3 1  ON 56
ci_058                -2.165169e-03 3 1  ON 57
ci_059                -1.506877e-04 3 1  ON 58
ci_060                 8.279981e-05 3 1  ON 59
ci_061                 5.487933e-04 3 1  ON 60
ci_062                 4.676916e-04 3 1  ON 61
ci_063                -6.268645e-04 3 1  ON 62
ci_064                -2.531933e-03 3 1  ON 63
ci_065                -2.630810e-03 3 1  ON 64
ci_066                -2.604960e-03 3 1  ON 65
ci_067                -1.131962e-03 3 1  ON 66
ci_068                -3.305915e-03 3 1  ON 67
ci_069                 1.178591e-03 3 1  ON 68
ci_070                -1.785746e-05 3 1  ON 69
ci_071                -1.958257e-03 3 1  ON 70
ci_072                -6.546768e-04 3 1  ON 71
ci_073                 3.693761e-04 3 1  ON 72
ci_074                -3.138915e-04 3 1  ON 73
ci_075                -7.692159e-04 3 1  ON 74
ci_076                -5.446795e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.6197
    reference variance = 0.26348
====================================================
  Execution time = 2.5567e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.1908e-01
  Total weights = 1.9552e+06
  Execution time = 3.6740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504731407494
                                         uncertainty =       0.004794965236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504731407494
                                         uncertainty =       0.004794965236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502306660
  error estimate for blocks of size 2^( 2) =       0.000520241784
  error estimate for blocks of size 2^( 3) =       0.000536343594
  error estimate for blocks of size 2^( 4) =       0.000547601718
  error estimate for blocks of size 2^( 5) =       0.000554580881
  error estimate for blocks of size 2^( 6) =       0.000558658940
  error estimate for blocks of size 2^( 7) =       0.000561271710

      target function =                  N/A
              le_mean =     -22.670508244035
             les_mean =     514.471037274103
             stat err =       0.000555528312
             autocorr =       1.223135362733
              std dev =       0.710368890358
             le_variance =       0.504623960388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504716930223
                                         uncertainty =       0.004788073707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504716930223
                                         uncertainty =       0.004788073707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502299728
  error estimate for blocks of size 2^( 2) =       0.000520234685
  error estimate for blocks of size 2^( 3) =       0.000536336588
  error estimate for blocks of size 2^( 4) =       0.000547594772
  error estimate for blocks of size 2^( 5) =       0.000554574302
  error estimate for blocks of size 2^( 6) =       0.000558652359
  error estimate for blocks of size 2^( 7) =       0.000561264708

      target function =                  N/A
              le_mean =     -22.670507640497
             les_mean =     514.470978653665
             stat err =       0.000555521535
             autocorr =       1.223139280966
              std dev =       0.710359087130
             le_variance =       0.504610032668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504724080393
                                         uncertainty =       0.004791500405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504724080393
                                         uncertainty =       0.004791500405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502303150
  error estimate for blocks of size 2^( 2) =       0.000520238190
  error estimate for blocks of size 2^( 3) =       0.000536340049
  error estimate for blocks of size 2^( 4) =       0.000547598204
  error estimate for blocks of size 2^( 5) =       0.000554577550
  error estimate for blocks of size 2^( 6) =       0.000558655616
  error estimate for blocks of size 2^( 7) =       0.000561268178

      target function =                  N/A
              le_mean =     -22.670507933257
             les_mean =     514.471008101992
             stat err =       0.000555524887
             autocorr =       1.223137373840
              std dev =       0.710363926805
             le_variance =       0.504616908506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504730485328
                                         uncertainty =       0.004794531179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504730485328
                                         uncertainty =       0.004794531179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502306218
  error estimate for blocks of size 2^( 2) =       0.000520241332
  error estimate for blocks of size 2^( 3) =       0.000536343148
  error estimate for blocks of size 2^( 4) =       0.000547601275
  error estimate for blocks of size 2^( 5) =       0.000554580461
  error estimate for blocks of size 2^( 6) =       0.000558658521
  error estimate for blocks of size 2^( 7) =       0.000561271264

      target function =                  N/A
              le_mean =     -22.670508204747
             les_mean =     514.471032794120
             stat err =       0.000555527880
             autocorr =       1.223135614429
              std dev =       0.710368265434
             le_variance =       0.504623072535


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670508244035        initial  <--
     1.5259e+01     1.5259e+02             3.0426e-05       -22.670507640497
     6.1035e+01     6.1035e+02             7.7117e-06       -22.670507933257
     2.4414e+02     2.4414e+03             1.9346e-06       -22.670508204747

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8302
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996795e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499192e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270676e-03 3 1  ON 10
ci_012                -8.839499e-03 3 1  ON 11
ci_013                 9.897142e-03 3 1  ON 12
ci_014                 8.430522e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108299e-03 3 1  ON 18
ci_020                -2.479067e-03 3 1  ON 19
ci_021                -7.526794e-03 3 1  ON 20
ci_022                -9.057726e-03 3 1  ON 21
ci_023                 8.520916e-03 3 1  ON 22
ci_024                 7.558117e-03 3 1  ON 23
ci_025                 5.748061e-03 3 1  ON 24
ci_026                 4.578842e-03 3 1  ON 25
ci_027                 7.201616e-03 3 1  ON 26
ci_028                 7.303320e-03 3 1  ON 27
ci_029                -4.383739e-03 3 1  ON 28
ci_030                -5.640867e-03 3 1  ON 29
ci_031                -8.182958e-03 3 1  ON 30
ci_032                -7.410466e-03 3 1  ON 31
ci_033                 4.089760e-03 3 1  ON 32
ci_034                 4.356571e-03 3 1  ON 33
ci_035                 1.959989e-03 3 1  ON 34
ci_036                 2.248305e-03 3 1  ON 35
ci_037                 4.261135e-03 3 1  ON 36
ci_038                 4.872383e-03 3 1  ON 37
ci_039                 4.990238e-03 3 1  ON 38
ci_040                 5.195085e-03 3 1  ON 39
ci_041                 5.078102e-03 3 1  ON 40
ci_042                 6.058367e-03 3 1  ON 41
ci_043                 5.022663e-03 3 1  ON 42
ci_044                 5.244665e-03 3 1  ON 43
ci_045                 4.037718e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551844e-04 3 1  ON 46
ci_048                -7.531022e-04 3 1  ON 47
ci_049                 1.645210e-03 3 1  ON 48
ci_050                 1.625923e-03 3 1  ON 49
ci_051                -7.925802e-04 3 1  ON 50
ci_052                -1.096106e-03 3 1  ON 51
ci_053                -2.586065e-03 3 1  ON 52
ci_054                -3.194041e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292984e-03 3 1  ON 55
ci_057                -1.177486e-03 3 1  ON 56
ci_058                -2.166397e-03 3 1  ON 57
ci_059                -1.527610e-04 3 1  ON 58
ci_060                 7.734760e-05 3 1  ON 59
ci_061                 5.523849e-04 3 1  ON 60
ci_062                 4.665825e-04 3 1  ON 61
ci_063                -6.261120e-04 3 1  ON 62
ci_064                -2.538533e-03 3 1  ON 63
ci_065                -2.627447e-03 3 1  ON 64
ci_066                -2.610491e-03 3 1  ON 65
ci_067                -1.131316e-03 3 1  ON 66
ci_068                -3.308904e-03 3 1  ON 67
ci_069                 1.184533e-03 3 1  ON 68
ci_070                -1.683561e-05 3 1  ON 69
ci_071                -1.954611e-03 3 1  ON 70
ci_072                -6.509043e-04 3 1  ON 71
ci_073                 3.685216e-04 3 1  ON 72
ci_074                -3.140064e-04 3 1  ON 73
ci_075                -7.695082e-04 3 1  ON 74
ci_076                -5.482234e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6702e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.5753
    reference variance = 0.280693
====================================================
  Execution time = 2.6475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1904e-01
  Total weights = 1.955193891e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507148653201
                                         uncertainty =       0.008292478773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507148653201
                                         uncertainty =       0.008292478773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503570697
  error estimate for blocks of size 2^( 2) =       0.000520733835
  error estimate for blocks of size 2^( 3) =       0.000536889469
  error estimate for blocks of size 2^( 4) =       0.000547692045
  error estimate for blocks of size 2^( 5) =       0.000554461719
  error estimate for blocks of size 2^( 6) =       0.000558363686
  error estimate for blocks of size 2^( 7) =       0.000560154102

      target function =                  N/A
              le_mean =     -22.669575889049
             les_mean =     514.428708927971
             stat err =       0.000555167888
             autocorr =       1.215423908290
              std dev =       0.712156508881
             le_variance =       0.507166893142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266957588905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669575889150       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669575953408       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669575958456       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669575958163       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+02 is 2.596841e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669575889150       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669575905229       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669575906497       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669575906423       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+02 is 6.500935e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669575889150       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669575893171       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669575893488       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669575893470       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+03 is 1.625787e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038926 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1279e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996799e-02 3 1  ON 2
ci_004                -3.767680e-02 3 1  ON 3
ci_005                 1.613766e-02 3 1  ON 4
ci_006                 1.499232e-02 3 1  ON 5
ci_007                 1.240676e-02 3 1  ON 6
ci_008                 1.175787e-02 3 1  ON 7
ci_009                -1.096310e-02 3 1  ON 8
ci_010                -1.303016e-02 3 1  ON 9
ci_011                -8.270684e-03 3 1  ON 10
ci_012                -8.839811e-03 3 1  ON 11
ci_013                 9.897115e-03 3 1  ON 12
ci_014                 8.430707e-03 3 1  ON 13
ci_015                 1.241979e-02 3 1  ON 14
ci_016                 1.269269e-02 3 1  ON 15
ci_017                 1.061568e-02 3 1  ON 16
ci_018                 1.086342e-02 3 1  ON 17
ci_019                -3.108150e-03 3 1  ON 18
ci_020                -2.479247e-03 3 1  ON 19
ci_021                -7.526587e-03 3 1  ON 20
ci_022                -9.057980e-03 3 1  ON 21
ci_023                 8.520786e-03 3 1  ON 22
ci_024                 7.558591e-03 3 1  ON 23
ci_025                 5.747735e-03 3 1  ON 24
ci_026                 4.578681e-03 3 1  ON 25
ci_027                 7.200984e-03 3 1  ON 26
ci_028                 7.303283e-03 3 1  ON 27
ci_029                -4.384240e-03 3 1  ON 28
ci_030                -5.640343e-03 3 1  ON 29
ci_031                -8.183013e-03 3 1  ON 30
ci_032                -7.409979e-03 3 1  ON 31
ci_033                 4.089215e-03 3 1  ON 32
ci_034                 4.356373e-03 3 1  ON 33
ci_035                 1.959798e-03 3 1  ON 34
ci_036                 2.247969e-03 3 1  ON 35
ci_037                 4.261346e-03 3 1  ON 36
ci_038                 4.872809e-03 3 1  ON 37
ci_039                 4.990695e-03 3 1  ON 38
ci_040                 5.195501e-03 3 1  ON 39
ci_041                 5.078199e-03 3 1  ON 40
ci_042                 6.058233e-03 3 1  ON 41
ci_043                 5.022906e-03 3 1  ON 42
ci_044                 5.244784e-03 3 1  ON 43
ci_045                 4.037572e-03 3 1  ON 44
ci_046                 3.073174e-03 3 1  ON 45
ci_047                -2.558345e-04 3 1  ON 46
ci_048                -7.529908e-04 3 1  ON 47
ci_049                 1.645214e-03 3 1  ON 48
ci_050                 1.625853e-03 3 1  ON 49
ci_051                -7.927652e-04 3 1  ON 50
ci_052                -1.096397e-03 3 1  ON 51
ci_053                -2.585943e-03 3 1  ON 52
ci_054                -3.193765e-03 3 1  ON 53
ci_055                -1.753402e-03 3 1  ON 54
ci_056                -2.292978e-03 3 1  ON 55
ci_057                -1.177433e-03 3 1  ON 56
ci_058                -2.166000e-03 3 1  ON 57
ci_059                -1.525827e-04 3 1  ON 58
ci_060                 7.754397e-05 3 1  ON 59
ci_061                 5.522130e-04 3 1  ON 60
ci_062                 4.665405e-04 3 1  ON 61
ci_063                -6.259092e-04 3 1  ON 62
ci_064                -2.538028e-03 3 1  ON 63
ci_065                -2.627400e-03 3 1  ON 64
ci_066                -2.610710e-03 3 1  ON 65
ci_067                -1.131738e-03 3 1  ON 66
ci_068                -3.308553e-03 3 1  ON 67
ci_069                 1.184297e-03 3 1  ON 68
ci_070                -1.693702e-05 3 1  ON 69
ci_071                -1.954661e-03 3 1  ON 70
ci_072                -6.512463e-04 3 1  ON 71
ci_073                 3.680220e-04 3 1  ON 72
ci_074                -3.138560e-04 3 1  ON 73
ci_075                -7.693747e-04 3 1  ON 74
ci_076                -5.481545e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6792
    reference variance = 0.386634
====================================================
  Execution time = 2.5550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.3335e-01
  Total weights = 1.9550e+06
  Execution time = 3.6503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497370560686
                                         uncertainty =       0.002726706137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497370560686
                                         uncertainty =       0.002726706137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498637423
  error estimate for blocks of size 2^( 2) =       0.000517263683
  error estimate for blocks of size 2^( 3) =       0.000533295813
  error estimate for blocks of size 2^( 4) =       0.000544216667
  error estimate for blocks of size 2^( 5) =       0.000551722798
  error estimate for blocks of size 2^( 6) =       0.000556092104
  error estimate for blocks of size 2^( 7) =       0.000558465710

      target function =                  N/A
              le_mean =     -22.669334637140
             les_mean =     514.432083048294
             stat err =       0.000552624319
             autocorr =       1.228259828001
              std dev =       0.705179805924
             le_variance =       0.497278558684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497369998629
                                         uncertainty =       0.002726718908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497369998629
                                         uncertainty =       0.002726718908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498637141
  error estimate for blocks of size 2^( 2) =       0.000517263365
  error estimate for blocks of size 2^( 3) =       0.000533295481
  error estimate for blocks of size 2^( 4) =       0.000544216376
  error estimate for blocks of size 2^( 5) =       0.000551722572
  error estimate for blocks of size 2^( 6) =       0.000556091849
  error estimate for blocks of size 2^( 7) =       0.000558465396

      target function =                  N/A
              le_mean =     -22.669334620839
             les_mean =     514.432091609492
             stat err =       0.000552624048
             autocorr =       1.228260011542
              std dev =       0.705179407090
             le_variance =       0.497277996184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497370279290
                                         uncertainty =       0.002726712547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497370279290
                                         uncertainty =       0.002726712547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498637282
  error estimate for blocks of size 2^( 2) =       0.000517263524
  error estimate for blocks of size 2^( 3) =       0.000533295647
  error estimate for blocks of size 2^( 4) =       0.000544216521
  error estimate for blocks of size 2^( 5) =       0.000551722685
  error estimate for blocks of size 2^( 6) =       0.000556091976
  error estimate for blocks of size 2^( 7) =       0.000558465553

      target function =                  N/A
              le_mean =     -22.669334628934
             les_mean =     514.432087335030
             stat err =       0.000552624184
             autocorr =       1.228259919938
              std dev =       0.705179606247
             le_variance =       0.497278277067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497370525463
                                         uncertainty =       0.002726706938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497370525463
                                         uncertainty =       0.002726706938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498637405
  error estimate for blocks of size 2^( 2) =       0.000517263663
  error estimate for blocks of size 2^( 3) =       0.000533295792
  error estimate for blocks of size 2^( 4) =       0.000544216649
  error estimate for blocks of size 2^( 5) =       0.000551722783
  error estimate for blocks of size 2^( 6) =       0.000556092088
  error estimate for blocks of size 2^( 7) =       0.000558465690

      target function =                  N/A
              le_mean =     -22.669334636109
             les_mean =     514.432083583281
             stat err =       0.000552624302
             autocorr =       1.228259839517
              std dev =       0.705179780930
             le_variance =       0.497278523433


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669334637140        initial  <--
     1.5259e+02     1.5259e+03             2.5968e-06       -22.669334620839
     6.1035e+02     6.1035e+03             6.5009e-07       -22.669334628934
     2.4414e+03     2.4414e+04             1.6258e-07       -22.669334636109

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8479
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996795e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499192e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270676e-03 3 1  ON 10
ci_012                -8.839499e-03 3 1  ON 11
ci_013                 9.897142e-03 3 1  ON 12
ci_014                 8.430522e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108299e-03 3 1  ON 18
ci_020                -2.479067e-03 3 1  ON 19
ci_021                -7.526794e-03 3 1  ON 20
ci_022                -9.057726e-03 3 1  ON 21
ci_023                 8.520916e-03 3 1  ON 22
ci_024                 7.558117e-03 3 1  ON 23
ci_025                 5.748061e-03 3 1  ON 24
ci_026                 4.578842e-03 3 1  ON 25
ci_027                 7.201616e-03 3 1  ON 26
ci_028                 7.303320e-03 3 1  ON 27
ci_029                -4.383739e-03 3 1  ON 28
ci_030                -5.640867e-03 3 1  ON 29
ci_031                -8.182958e-03 3 1  ON 30
ci_032                -7.410466e-03 3 1  ON 31
ci_033                 4.089760e-03 3 1  ON 32
ci_034                 4.356571e-03 3 1  ON 33
ci_035                 1.959989e-03 3 1  ON 34
ci_036                 2.248305e-03 3 1  ON 35
ci_037                 4.261135e-03 3 1  ON 36
ci_038                 4.872383e-03 3 1  ON 37
ci_039                 4.990238e-03 3 1  ON 38
ci_040                 5.195085e-03 3 1  ON 39
ci_041                 5.078102e-03 3 1  ON 40
ci_042                 6.058367e-03 3 1  ON 41
ci_043                 5.022663e-03 3 1  ON 42
ci_044                 5.244665e-03 3 1  ON 43
ci_045                 4.037718e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551844e-04 3 1  ON 46
ci_048                -7.531022e-04 3 1  ON 47
ci_049                 1.645210e-03 3 1  ON 48
ci_050                 1.625923e-03 3 1  ON 49
ci_051                -7.925802e-04 3 1  ON 50
ci_052                -1.096106e-03 3 1  ON 51
ci_053                -2.586065e-03 3 1  ON 52
ci_054                -3.194041e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292984e-03 3 1  ON 55
ci_057                -1.177486e-03 3 1  ON 56
ci_058                -2.166397e-03 3 1  ON 57
ci_059                -1.527610e-04 3 1  ON 58
ci_060                 7.734760e-05 3 1  ON 59
ci_061                 5.523849e-04 3 1  ON 60
ci_062                 4.665825e-04 3 1  ON 61
ci_063                -6.261120e-04 3 1  ON 62
ci_064                -2.538533e-03 3 1  ON 63
ci_065                -2.627447e-03 3 1  ON 64
ci_066                -2.610491e-03 3 1  ON 65
ci_067                -1.131316e-03 3 1  ON 66
ci_068                -3.308904e-03 3 1  ON 67
ci_069                 1.184533e-03 3 1  ON 68
ci_070                -1.683561e-05 3 1  ON 69
ci_071                -1.954611e-03 3 1  ON 70
ci_072                -6.509043e-04 3 1  ON 71
ci_073                 3.685216e-04 3 1  ON 72
ci_074                -3.140064e-04 3 1  ON 73
ci_075                -7.695082e-04 3 1  ON 74
ci_076                -5.482234e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5134e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.678
    reference variance = 0.43892
====================================================
  Execution time = 2.6288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.0731e-01
  Total weights = 1.955493047e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495289403316
                                         uncertainty =       0.002468262278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495289403316
                                         uncertainty =       0.002468262278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497680646
  error estimate for blocks of size 2^( 2) =       0.000515336059
  error estimate for blocks of size 2^( 3) =       0.000531556234
  error estimate for blocks of size 2^( 4) =       0.000542706868
  error estimate for blocks of size 2^( 5) =       0.000549245657
  error estimate for blocks of size 2^( 6) =       0.000551613608
  error estimate for blocks of size 2^( 7) =       0.000554099925

      target function =                  N/A
              le_mean =     -22.670831341403
             les_mean =     514.473899282613
             stat err =       0.000549416515
             autocorr =       1.218714321289
              std dev =       0.703826719417
             le_variance =       0.495372050966


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267083134140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670831341480       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670831346226       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670831346738       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670831346712       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+03 is 3.246081e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670831341480       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670831342667       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670831342795       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670831342788       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+03 is 8.115782e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670831341480       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670831341777       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670831341809       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670831341807       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+04 is 2.028982e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1024e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -7.062021e-01 3 1  ON 0
ci_002                -7.047887e-01 3 1  ON 1
ci_003                -3.996793e-02 3 1  ON 2
ci_004                -3.767678e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499197e-02 3 1  ON 5
ci_007                 1.240684e-02 3 1  ON 6
ci_008                 1.175752e-02 3 1  ON 7
ci_009                -1.096302e-02 3 1  ON 8
ci_010                -1.303023e-02 3 1  ON 9
ci_011                -8.270684e-03 3 1  ON 10
ci_012                -8.839489e-03 3 1  ON 11
ci_013                 9.897112e-03 3 1  ON 12
ci_014                 8.430563e-03 3 1  ON 13
ci_015                 1.241975e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061582e-02 3 1  ON 16
ci_018                 1.086353e-02 3 1  ON 17
ci_019                -3.108287e-03 3 1  ON 18
ci_020                -2.479084e-03 3 1  ON 19
ci_021                -7.526808e-03 3 1  ON 20
ci_022                -9.057745e-03 3 1  ON 21
ci_023                 8.520909e-03 3 1  ON 22
ci_024                 7.558131e-03 3 1  ON 23
ci_025                 5.748003e-03 3 1  ON 24
ci_026                 4.578843e-03 3 1  ON 25
ci_027                 7.201603e-03 3 1  ON 26
ci_028                 7.303306e-03 3 1  ON 27
ci_029                -4.383721e-03 3 1  ON 28
ci_030                -5.640866e-03 3 1  ON 29
ci_031                -8.182941e-03 3 1  ON 30
ci_032                -7.410464e-03 3 1  ON 31
ci_033                 4.089782e-03 3 1  ON 32
ci_034                 4.356560e-03 3 1  ON 33
ci_035                 1.959952e-03 3 1  ON 34
ci_036                 2.248272e-03 3 1  ON 35
ci_037                 4.261147e-03 3 1  ON 36
ci_038                 4.872347e-03 3 1  ON 37
ci_039                 4.990228e-03 3 1  ON 38
ci_040                 5.195097e-03 3 1  ON 39
ci_041                 5.078074e-03 3 1  ON 40
ci_042                 6.058308e-03 3 1  ON 41
ci_043                 5.022690e-03 3 1  ON 42
ci_044                 5.244657e-03 3 1  ON 43
ci_045                 4.037662e-03 3 1  ON 44
ci_046                 3.073310e-03 3 1  ON 45
ci_047                -2.551882e-04 3 1  ON 46
ci_048                -7.530788e-04 3 1  ON 47
ci_049                 1.645255e-03 3 1  ON 48
ci_050                 1.625933e-03 3 1  ON 49
ci_051                -7.925527e-04 3 1  ON 50
ci_052                -1.096140e-03 3 1  ON 51
ci_053                -2.586088e-03 3 1  ON 52
ci_054                -3.194017e-03 3 1  ON 53
ci_055                -1.753110e-03 3 1  ON 54
ci_056                -2.292965e-03 3 1  ON 55
ci_057                -1.177484e-03 3 1  ON 56
ci_058                -2.166376e-03 3 1  ON 57
ci_059                -1.527313e-04 3 1  ON 58
ci_060                 7.736801e-05 3 1  ON 59
ci_061                 5.523680e-04 3 1  ON 60
ci_062                 4.665653e-04 3 1  ON 61
ci_063                -6.261138e-04 3 1  ON 62
ci_064                -2.538469e-03 3 1  ON 63
ci_065                -2.627442e-03 3 1  ON 64
ci_066                -2.610439e-03 3 1  ON 65
ci_067                -1.131397e-03 3 1  ON 66
ci_068                -3.308907e-03 3 1  ON 67
ci_069                 1.184536e-03 3 1  ON 68
ci_070                -1.685343e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509293e-04 3 1  ON 71
ci_073                 3.684996e-04 3 1  ON 72
ci_074                -3.139589e-04 3 1  ON 73
ci_075                -7.694775e-04 3 1  ON 74
ci_076                -5.481989e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.6911
    reference variance = 0.592497
====================================================
  Execution time = 2.5643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0386e-01
  Total weights = 1.9554e+06
  Execution time = 3.6401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493396125427
                                         uncertainty =       0.002336759578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493396125427
                                         uncertainty =       0.002336759578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496710020
  error estimate for blocks of size 2^( 2) =       0.000514600575
  error estimate for blocks of size 2^( 3) =       0.000531285299
  error estimate for blocks of size 2^( 4) =       0.000543088450
  error estimate for blocks of size 2^( 5) =       0.000550471957
  error estimate for blocks of size 2^( 6) =       0.000553333242
  error estimate for blocks of size 2^( 7) =       0.000553336727

      target function =                  N/A
              le_mean =     -22.669921578817
             les_mean =     514.429207540853
             stat err =       0.000550057594
             autocorr =       1.226338851959
              std dev =       0.702454047008
             le_variance =       0.493441688157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493396103644
                                         uncertainty =       0.002336760225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493396103644
                                         uncertainty =       0.002336760225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496710009
  error estimate for blocks of size 2^( 2) =       0.000514600560
  error estimate for blocks of size 2^( 3) =       0.000531285286
  error estimate for blocks of size 2^( 4) =       0.000543088436
  error estimate for blocks of size 2^( 5) =       0.000550471944
  error estimate for blocks of size 2^( 6) =       0.000553333225
  error estimate for blocks of size 2^( 7) =       0.000553336716

      target function =                  N/A
              le_mean =     -22.669921578393
             les_mean =     514.429207636034
             stat err =       0.000550057580
             autocorr =       1.226338844091
              std dev =       0.702454031531
             le_variance =       0.493441666413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493396114532
                                         uncertainty =       0.002336759902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493396114532
                                         uncertainty =       0.002336759902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496710015
  error estimate for blocks of size 2^( 2) =       0.000514600568
  error estimate for blocks of size 2^( 3) =       0.000531285293
  error estimate for blocks of size 2^( 4) =       0.000543088443
  error estimate for blocks of size 2^( 5) =       0.000550471950
  error estimate for blocks of size 2^( 6) =       0.000553333233
  error estimate for blocks of size 2^( 7) =       0.000553336721

      target function =                  N/A
              le_mean =     -22.669921578604
             les_mean =     514.429207588297
             stat err =       0.000550057587
             autocorr =       1.226338848023
              std dev =       0.702454039266
             le_variance =       0.493441677282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493396124064
                                         uncertainty =       0.002336759618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493396124064
                                         uncertainty =       0.002336759618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496710019
  error estimate for blocks of size 2^( 2) =       0.000514600574
  error estimate for blocks of size 2^( 3) =       0.000531285298
  error estimate for blocks of size 2^( 4) =       0.000543088449
  error estimate for blocks of size 2^( 5) =       0.000550471956
  error estimate for blocks of size 2^( 6) =       0.000553333241
  error estimate for blocks of size 2^( 7) =       0.000553336726

      target function =                  N/A
              le_mean =     -22.669921578790
             les_mean =     514.429207546767
             stat err =       0.000550057593
             autocorr =       1.226338851463
              std dev =       0.702454046040
             le_variance =       0.493441686797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669921578817        initial  <--
     1.5259e+03     1.5259e+04             3.2461e-07       -22.669921578393
     6.1035e+03     6.1035e+04             8.1158e-08       -22.669921578604
     2.4414e+04     2.4414e+05             2.0290e-08       -22.669921578790

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8824
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996795e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499192e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270676e-03 3 1  ON 10
ci_012                -8.839499e-03 3 1  ON 11
ci_013                 9.897142e-03 3 1  ON 12
ci_014                 8.430522e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108299e-03 3 1  ON 18
ci_020                -2.479067e-03 3 1  ON 19
ci_021                -7.526794e-03 3 1  ON 20
ci_022                -9.057726e-03 3 1  ON 21
ci_023                 8.520916e-03 3 1  ON 22
ci_024                 7.558117e-03 3 1  ON 23
ci_025                 5.748061e-03 3 1  ON 24
ci_026                 4.578842e-03 3 1  ON 25
ci_027                 7.201616e-03 3 1  ON 26
ci_028                 7.303320e-03 3 1  ON 27
ci_029                -4.383739e-03 3 1  ON 28
ci_030                -5.640867e-03 3 1  ON 29
ci_031                -8.182958e-03 3 1  ON 30
ci_032                -7.410466e-03 3 1  ON 31
ci_033                 4.089760e-03 3 1  ON 32
ci_034                 4.356571e-03 3 1  ON 33
ci_035                 1.959989e-03 3 1  ON 34
ci_036                 2.248305e-03 3 1  ON 35
ci_037                 4.261135e-03 3 1  ON 36
ci_038                 4.872383e-03 3 1  ON 37
ci_039                 4.990238e-03 3 1  ON 38
ci_040                 5.195085e-03 3 1  ON 39
ci_041                 5.078102e-03 3 1  ON 40
ci_042                 6.058367e-03 3 1  ON 41
ci_043                 5.022663e-03 3 1  ON 42
ci_044                 5.244665e-03 3 1  ON 43
ci_045                 4.037718e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551844e-04 3 1  ON 46
ci_048                -7.531022e-04 3 1  ON 47
ci_049                 1.645210e-03 3 1  ON 48
ci_050                 1.625923e-03 3 1  ON 49
ci_051                -7.925802e-04 3 1  ON 50
ci_052                -1.096106e-03 3 1  ON 51
ci_053                -2.586065e-03 3 1  ON 52
ci_054                -3.194041e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292984e-03 3 1  ON 55
ci_057                -1.177486e-03 3 1  ON 56
ci_058                -2.166397e-03 3 1  ON 57
ci_059                -1.527610e-04 3 1  ON 58
ci_060                 7.734760e-05 3 1  ON 59
ci_061                 5.523849e-04 3 1  ON 60
ci_062                 4.665825e-04 3 1  ON 61
ci_063                -6.261120e-04 3 1  ON 62
ci_064                -2.538533e-03 3 1  ON 63
ci_065                -2.627447e-03 3 1  ON 64
ci_066                -2.610491e-03 3 1  ON 65
ci_067                -1.131316e-03 3 1  ON 66
ci_068                -3.308904e-03 3 1  ON 67
ci_069                 1.184533e-03 3 1  ON 68
ci_070                -1.683561e-05 3 1  ON 69
ci_071                -1.954611e-03 3 1  ON 70
ci_072                -6.509043e-04 3 1  ON 71
ci_073                 3.685216e-04 3 1  ON 72
ci_074                -3.140064e-04 3 1  ON 73
ci_075                -7.695082e-04 3 1  ON 74
ci_076                -5.482234e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4912e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6174
    reference variance = 0.334154
====================================================
  Execution time = 2.6490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0436e-01
  Total weights = 1.955131430e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492302379001
                                         uncertainty =       0.002290912843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492302379001
                                         uncertainty =       0.002290912843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496119307
  error estimate for blocks of size 2^( 2) =       0.000514008187
  error estimate for blocks of size 2^( 3) =       0.000530903966
  error estimate for blocks of size 2^( 4) =       0.000542745420
  error estimate for blocks of size 2^( 5) =       0.000548832002
  error estimate for blocks of size 2^( 6) =       0.000552673223
  error estimate for blocks of size 2^( 7) =       0.000557525754

      target function =                  N/A
              le_mean =     -22.670050440428
             les_mean =     514.435549353416
             stat err =       0.000550444100
             autocorr =       1.230989035808
              std dev =       0.701618653036
             le_variance =       0.492268734288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267005044043e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670050440534       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670050441242       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670050441311       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670050441317       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+04 is 3.896083e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670050440534       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670050440711       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670050440728       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670050440730       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+04 is 9.740277e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670050440534       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670050440578       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670050440582       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670050440583       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+05 is 2.435074e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1231e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499192e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303024e-02 3 1  ON 9
ci_011                -8.270678e-03 3 1  ON 10
ci_012                -8.839497e-03 3 1  ON 11
ci_013                 9.897140e-03 3 1  ON 12
ci_014                 8.430525e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108299e-03 3 1  ON 18
ci_020                -2.479066e-03 3 1  ON 19
ci_021                -7.526797e-03 3 1  ON 20
ci_022                -9.057724e-03 3 1  ON 21
ci_023                 8.520915e-03 3 1  ON 22
ci_024                 7.558116e-03 3 1  ON 23
ci_025                 5.748059e-03 3 1  ON 24
ci_026                 4.578842e-03 3 1  ON 25
ci_027                 7.201613e-03 3 1  ON 26
ci_028                 7.303316e-03 3 1  ON 27
ci_029                -4.383739e-03 3 1  ON 28
ci_030                -5.640863e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410469e-03 3 1  ON 31
ci_033                 4.089761e-03 3 1  ON 32
ci_034                 4.356572e-03 3 1  ON 33
ci_035                 1.959983e-03 3 1  ON 34
ci_036                 2.248298e-03 3 1  ON 35
ci_037                 4.261136e-03 3 1  ON 36
ci_038                 4.872382e-03 3 1  ON 37
ci_039                 4.990243e-03 3 1  ON 38
ci_040                 5.195089e-03 3 1  ON 39
ci_041                 5.078102e-03 3 1  ON 40
ci_042                 6.058363e-03 3 1  ON 41
ci_043                 5.022660e-03 3 1  ON 42
ci_044                 5.244665e-03 3 1  ON 43
ci_045                 4.037713e-03 3 1  ON 44
ci_046                 3.073318e-03 3 1  ON 45
ci_047                -2.551857e-04 3 1  ON 46
ci_048                -7.531023e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625922e-03 3 1  ON 49
ci_051                -7.925809e-04 3 1  ON 50
ci_052                -1.096106e-03 3 1  ON 51
ci_053                -2.586068e-03 3 1  ON 52
ci_054                -3.194039e-03 3 1  ON 53
ci_055                -1.753116e-03 3 1  ON 54
ci_056                -2.292985e-03 3 1  ON 55
ci_057                -1.177491e-03 3 1  ON 56
ci_058                -2.166392e-03 3 1  ON 57
ci_059                -1.527610e-04 3 1  ON 58
ci_060                 7.734819e-05 3 1  ON 59
ci_061                 5.523810e-04 3 1  ON 60
ci_062                 4.665796e-04 3 1  ON 61
ci_063                -6.261113e-04 3 1  ON 62
ci_064                -2.538523e-03 3 1  ON 63
ci_065                -2.627449e-03 3 1  ON 64
ci_066                -2.610489e-03 3 1  ON 65
ci_067                -1.131320e-03 3 1  ON 66
ci_068                -3.308903e-03 3 1  ON 67
ci_069                 1.184529e-03 3 1  ON 68
ci_070                -1.683668e-05 3 1  ON 69
ci_071                -1.954609e-03 3 1  ON 70
ci_072                -6.509073e-04 3 1  ON 71
ci_073                 3.685208e-04 3 1  ON 72
ci_074                -3.140043e-04 3 1  ON 73
ci_075                -7.695050e-04 3 1  ON 74
ci_076                -5.482213e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6049
    reference variance = 0.334775
====================================================
  Execution time = 2.5597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0528e-01
  Total weights = 1.9550e+06
  Execution time = 3.6304e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494438824107
                                         uncertainty =       0.002344114506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494438824107
                                         uncertainty =       0.002344114506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497215428
  error estimate for blocks of size 2^( 2) =       0.000515172216
  error estimate for blocks of size 2^( 3) =       0.000531384461
  error estimate for blocks of size 2^( 4) =       0.000543212473
  error estimate for blocks of size 2^( 5) =       0.000549929193
  error estimate for blocks of size 2^( 6) =       0.000553383356
  error estimate for blocks of size 2^( 7) =       0.000554512831

      target function =                  N/A
              le_mean =     -22.670377663106
             les_mean =     514.451298693349
             stat err =       0.000550259463
             autocorr =       1.224745490632
              std dev =       0.703168801251
             le_variance =       0.494446363053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494438821967
                                         uncertainty =       0.002344114610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494438821967
                                         uncertainty =       0.002344114610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497215427
  error estimate for blocks of size 2^( 2) =       0.000515172215
  error estimate for blocks of size 2^( 3) =       0.000531384459
  error estimate for blocks of size 2^( 4) =       0.000543212471
  error estimate for blocks of size 2^( 5) =       0.000549929191
  error estimate for blocks of size 2^( 6) =       0.000553383354
  error estimate for blocks of size 2^( 7) =       0.000554512828

      target function =                  N/A
              le_mean =     -22.670377662949
             les_mean =     514.451298688074
             stat err =       0.000550259461
             autocorr =       1.224745486873
              std dev =       0.703168799677
             le_variance =       0.494446360839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494438823037
                                         uncertainty =       0.002344114558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494438823037
                                         uncertainty =       0.002344114558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497215427
  error estimate for blocks of size 2^( 2) =       0.000515172215
  error estimate for blocks of size 2^( 3) =       0.000531384460
  error estimate for blocks of size 2^( 4) =       0.000543212472
  error estimate for blocks of size 2^( 5) =       0.000549929192
  error estimate for blocks of size 2^( 6) =       0.000553383355
  error estimate for blocks of size 2^( 7) =       0.000554512830

      target function =                  N/A
              le_mean =     -22.670377663028
             les_mean =     514.451298690709
             stat err =       0.000550259462
             autocorr =       1.224745488746
              std dev =       0.703168800464
             le_variance =       0.494446361946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494438823974
                                         uncertainty =       0.002344114512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494438823974
                                         uncertainty =       0.002344114512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497215428
  error estimate for blocks of size 2^( 2) =       0.000515172216
  error estimate for blocks of size 2^( 3) =       0.000531384461
  error estimate for blocks of size 2^( 4) =       0.000543212473
  error estimate for blocks of size 2^( 5) =       0.000549929193
  error estimate for blocks of size 2^( 6) =       0.000553383356
  error estimate for blocks of size 2^( 7) =       0.000554512831

      target function =                  N/A
              le_mean =     -22.670377663097
             les_mean =     514.451298693019
             stat err =       0.000550259463
             autocorr =       1.224745490396
              std dev =       0.703168801153
             le_variance =       0.494446362914


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670377663106        initial  <--
     1.5259e+04     1.5259e+05             3.8961e-08       -22.670377662949
     6.1035e+04     6.1035e+05             9.7403e-09       -22.670377663028
     2.4414e+05     2.4414e+06             2.4351e-09       -22.670377663097

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8153
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996795e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499192e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270676e-03 3 1  ON 10
ci_012                -8.839499e-03 3 1  ON 11
ci_013                 9.897142e-03 3 1  ON 12
ci_014                 8.430522e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108299e-03 3 1  ON 18
ci_020                -2.479067e-03 3 1  ON 19
ci_021                -7.526794e-03 3 1  ON 20
ci_022                -9.057726e-03 3 1  ON 21
ci_023                 8.520916e-03 3 1  ON 22
ci_024                 7.558117e-03 3 1  ON 23
ci_025                 5.748061e-03 3 1  ON 24
ci_026                 4.578842e-03 3 1  ON 25
ci_027                 7.201616e-03 3 1  ON 26
ci_028                 7.303320e-03 3 1  ON 27
ci_029                -4.383739e-03 3 1  ON 28
ci_030                -5.640867e-03 3 1  ON 29
ci_031                -8.182958e-03 3 1  ON 30
ci_032                -7.410466e-03 3 1  ON 31
ci_033                 4.089760e-03 3 1  ON 32
ci_034                 4.356571e-03 3 1  ON 33
ci_035                 1.959989e-03 3 1  ON 34
ci_036                 2.248305e-03 3 1  ON 35
ci_037                 4.261135e-03 3 1  ON 36
ci_038                 4.872383e-03 3 1  ON 37
ci_039                 4.990238e-03 3 1  ON 38
ci_040                 5.195085e-03 3 1  ON 39
ci_041                 5.078102e-03 3 1  ON 40
ci_042                 6.058367e-03 3 1  ON 41
ci_043                 5.022663e-03 3 1  ON 42
ci_044                 5.244665e-03 3 1  ON 43
ci_045                 4.037718e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551844e-04 3 1  ON 46
ci_048                -7.531022e-04 3 1  ON 47
ci_049                 1.645210e-03 3 1  ON 48
ci_050                 1.625923e-03 3 1  ON 49
ci_051                -7.925802e-04 3 1  ON 50
ci_052                -1.096106e-03 3 1  ON 51
ci_053                -2.586065e-03 3 1  ON 52
ci_054                -3.194041e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292984e-03 3 1  ON 55
ci_057                -1.177486e-03 3 1  ON 56
ci_058                -2.166397e-03 3 1  ON 57
ci_059                -1.527610e-04 3 1  ON 58
ci_060                 7.734760e-05 3 1  ON 59
ci_061                 5.523849e-04 3 1  ON 60
ci_062                 4.665825e-04 3 1  ON 61
ci_063                -6.261120e-04 3 1  ON 62
ci_064                -2.538533e-03 3 1  ON 63
ci_065                -2.627447e-03 3 1  ON 64
ci_066                -2.610491e-03 3 1  ON 65
ci_067                -1.131316e-03 3 1  ON 66
ci_068                -3.308904e-03 3 1  ON 67
ci_069                 1.184533e-03 3 1  ON 68
ci_070                -1.683561e-05 3 1  ON 69
ci_071                -1.954611e-03 3 1  ON 70
ci_072                -6.509043e-04 3 1  ON 71
ci_073                 3.685216e-04 3 1  ON 72
ci_074                -3.140064e-04 3 1  ON 73
ci_075                -7.695082e-04 3 1  ON 74
ci_076                -5.482234e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5052e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7031
    reference variance = 0.293189
====================================================
  Execution time = 2.8504e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5322e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0255e-01
  Total weights = 1.955494034e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491203193026
                                         uncertainty =       0.002229217443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491203193026
                                         uncertainty =       0.002229217443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495643266
  error estimate for blocks of size 2^( 2) =       0.000513697210
  error estimate for blocks of size 2^( 3) =       0.000529441718
  error estimate for blocks of size 2^( 4) =       0.000540204113
  error estimate for blocks of size 2^( 5) =       0.000545969811
  error estimate for blocks of size 2^( 6) =       0.000546725115
  error estimate for blocks of size 2^( 7) =       0.000552301932

      target function =                  N/A
              le_mean =     -22.669055606377
             les_mean =     514.388630056644
             stat err =       0.000546300243
             autocorr =       1.214854779911
              std dev =       0.700945428839
             le_variance =       0.491324494211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266905560638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669055606484       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669055606527       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669055606526       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669055606520       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+05 is 2.165839e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669055606484       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669055606495       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669055606495       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669055606495       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+05 is 5.414604e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669055606484       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669055606487       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669055606487       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669055606487       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+06 is 1.353651e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042875 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3389e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996795e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499192e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270676e-03 3 1  ON 10
ci_012                -8.839499e-03 3 1  ON 11
ci_013                 9.897141e-03 3 1  ON 12
ci_014                 8.430522e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108299e-03 3 1  ON 18
ci_020                -2.479066e-03 3 1  ON 19
ci_021                -7.526795e-03 3 1  ON 20
ci_022                -9.057725e-03 3 1  ON 21
ci_023                 8.520916e-03 3 1  ON 22
ci_024                 7.558117e-03 3 1  ON 23
ci_025                 5.748061e-03 3 1  ON 24
ci_026                 4.578842e-03 3 1  ON 25
ci_027                 7.201616e-03 3 1  ON 26
ci_028                 7.303319e-03 3 1  ON 27
ci_029                -4.383738e-03 3 1  ON 28
ci_030                -5.640867e-03 3 1  ON 29
ci_031                -8.182957e-03 3 1  ON 30
ci_032                -7.410466e-03 3 1  ON 31
ci_033                 4.089760e-03 3 1  ON 32
ci_034                 4.356571e-03 3 1  ON 33
ci_035                 1.959989e-03 3 1  ON 34
ci_036                 2.248305e-03 3 1  ON 35
ci_037                 4.261136e-03 3 1  ON 36
ci_038                 4.872384e-03 3 1  ON 37
ci_039                 4.990239e-03 3 1  ON 38
ci_040                 5.195085e-03 3 1  ON 39
ci_041                 5.078102e-03 3 1  ON 40
ci_042                 6.058366e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244665e-03 3 1  ON 43
ci_045                 4.037717e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551847e-04 3 1  ON 46
ci_048                -7.531022e-04 3 1  ON 47
ci_049                 1.645210e-03 3 1  ON 48
ci_050                 1.625923e-03 3 1  ON 49
ci_051                -7.925807e-04 3 1  ON 50
ci_052                -1.096106e-03 3 1  ON 51
ci_053                -2.586065e-03 3 1  ON 52
ci_054                -3.194041e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292984e-03 3 1  ON 55
ci_057                -1.177486e-03 3 1  ON 56
ci_058                -2.166397e-03 3 1  ON 57
ci_059                -1.527608e-04 3 1  ON 58
ci_060                 7.734789e-05 3 1  ON 59
ci_061                 5.523844e-04 3 1  ON 60
ci_062                 4.665823e-04 3 1  ON 61
ci_063                -6.261118e-04 3 1  ON 62
ci_064                -2.538533e-03 3 1  ON 63
ci_065                -2.627446e-03 3 1  ON 64
ci_066                -2.610491e-03 3 1  ON 65
ci_067                -1.131316e-03 3 1  ON 66
ci_068                -3.308904e-03 3 1  ON 67
ci_069                 1.184533e-03 3 1  ON 68
ci_070                -1.683579e-05 3 1  ON 69
ci_071                -1.954611e-03 3 1  ON 70
ci_072                -6.509046e-04 3 1  ON 71
ci_073                 3.685217e-04 3 1  ON 72
ci_074                -3.140064e-04 3 1  ON 73
ci_075                -7.695081e-04 3 1  ON 74
ci_076                -5.482232e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6832
    reference variance = 0.617511
====================================================
  Execution time = 2.5697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0579e-01
  Total weights = 1.9549e+06
  Execution time = 3.6417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494310147962
                                         uncertainty =       0.002312730214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494310147962
                                         uncertainty =       0.002312730214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497152854
  error estimate for blocks of size 2^( 2) =       0.000515269260
  error estimate for blocks of size 2^( 3) =       0.000531543090
  error estimate for blocks of size 2^( 4) =       0.000543442697
  error estimate for blocks of size 2^( 5) =       0.000549821998
  error estimate for blocks of size 2^( 6) =       0.000551661048
  error estimate for blocks of size 2^( 7) =       0.000553509689

      target function =                  N/A
              le_mean =     -22.669309401144
             les_mean =     514.403375548739
             stat err =       0.000549608858
             autocorr =       1.222158616169
              std dev =       0.703080308302
             le_variance =       0.494321919922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494310148135
                                         uncertainty =       0.002312730234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494310148135
                                         uncertainty =       0.002312730234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497152854
  error estimate for blocks of size 2^( 2) =       0.000515269260
  error estimate for blocks of size 2^( 3) =       0.000531543090
  error estimate for blocks of size 2^( 4) =       0.000543442697
  error estimate for blocks of size 2^( 5) =       0.000549821998
  error estimate for blocks of size 2^( 6) =       0.000551661048
  error estimate for blocks of size 2^( 7) =       0.000553509689

      target function =                  N/A
              le_mean =     -22.669309401171
             les_mean =     514.403375550409
             stat err =       0.000549608858
             autocorr =       1.222158616250
              std dev =       0.703080308424
             le_variance =       0.494321920093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494310148049
                                         uncertainty =       0.002312730224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494310148049
                                         uncertainty =       0.002312730224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497152854
  error estimate for blocks of size 2^( 2) =       0.000515269260
  error estimate for blocks of size 2^( 3) =       0.000531543090
  error estimate for blocks of size 2^( 4) =       0.000543442697
  error estimate for blocks of size 2^( 5) =       0.000549821998
  error estimate for blocks of size 2^( 6) =       0.000551661048
  error estimate for blocks of size 2^( 7) =       0.000553509689

      target function =                  N/A
              le_mean =     -22.669309401157
             les_mean =     514.403375549574
             stat err =       0.000549608858
             autocorr =       1.222158616204
              std dev =       0.703080308362
             le_variance =       0.494321920007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494310147973
                                         uncertainty =       0.002312730215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494310147973
                                         uncertainty =       0.002312730215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497152854
  error estimate for blocks of size 2^( 2) =       0.000515269260
  error estimate for blocks of size 2^( 3) =       0.000531543090
  error estimate for blocks of size 2^( 4) =       0.000543442697
  error estimate for blocks of size 2^( 5) =       0.000549821998
  error estimate for blocks of size 2^( 6) =       0.000551661048
  error estimate for blocks of size 2^( 7) =       0.000553509689

      target function =                  N/A
              le_mean =     -22.669309401146
             les_mean =     514.403375548843
             stat err =       0.000549608858
             autocorr =       1.222158616179
              std dev =       0.703080308309
             le_variance =       0.494321919932


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669309401144        initial
     1.5259e+05     1.5259e+06             2.1658e-09       -22.669309401171  <--
     6.1035e+05     6.1035e+06             5.4146e-10       -22.669309401157
     2.4414e+06     2.4414e+07             1.3537e-10       -22.669309401146

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 4.3918e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499192e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270677e-03 3 1  ON 10
ci_012                -8.839500e-03 3 1  ON 11
ci_013                 9.897141e-03 3 1  ON 12
ci_014                 8.430523e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108299e-03 3 1  ON 18
ci_020                -2.479065e-03 3 1  ON 19
ci_021                -7.526795e-03 3 1  ON 20
ci_022                -9.057725e-03 3 1  ON 21
ci_023                 8.520915e-03 3 1  ON 22
ci_024                 7.558117e-03 3 1  ON 23
ci_025                 5.748060e-03 3 1  ON 24
ci_026                 4.578841e-03 3 1  ON 25
ci_027                 7.201615e-03 3 1  ON 26
ci_028                 7.303318e-03 3 1  ON 27
ci_029                -4.383738e-03 3 1  ON 28
ci_030                -5.640866e-03 3 1  ON 29
ci_031                -8.182957e-03 3 1  ON 30
ci_032                -7.410465e-03 3 1  ON 31
ci_033                 4.089761e-03 3 1  ON 32
ci_034                 4.356572e-03 3 1  ON 33
ci_035                 1.959988e-03 3 1  ON 34
ci_036                 2.248303e-03 3 1  ON 35
ci_037                 4.261137e-03 3 1  ON 36
ci_038                 4.872384e-03 3 1  ON 37
ci_039                 4.990240e-03 3 1  ON 38
ci_040                 5.195085e-03 3 1  ON 39
ci_041                 5.078102e-03 3 1  ON 40
ci_042                 6.058365e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244665e-03 3 1  ON 43
ci_045                 4.037717e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551858e-04 3 1  ON 46
ci_048                -7.531022e-04 3 1  ON 47
ci_049                 1.645210e-03 3 1  ON 48
ci_050                 1.625922e-03 3 1  ON 49
ci_051                -7.925822e-04 3 1  ON 50
ci_052                -1.096105e-03 3 1  ON 51
ci_053                -2.586065e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753114e-03 3 1  ON 54
ci_056                -2.292984e-03 3 1  ON 55
ci_057                -1.177486e-03 3 1  ON 56
ci_058                -2.166397e-03 3 1  ON 57
ci_059                -1.527600e-04 3 1  ON 58
ci_060                 7.734876e-05 3 1  ON 59
ci_061                 5.523831e-04 3 1  ON 60
ci_062                 4.665817e-04 3 1  ON 61
ci_063                -6.261114e-04 3 1  ON 62
ci_064                -2.538532e-03 3 1  ON 63
ci_065                -2.627446e-03 3 1  ON 64
ci_066                -2.610490e-03 3 1  ON 65
ci_067                -1.131316e-03 3 1  ON 66
ci_068                -3.308904e-03 3 1  ON 67
ci_069                 1.184532e-03 3 1  ON 68
ci_070                -1.683634e-05 3 1  ON 69
ci_071                -1.954611e-03 3 1  ON 70
ci_072                -6.509057e-04 3 1  ON 71
ci_073                 3.685223e-04 3 1  ON 72
ci_074                -3.140064e-04 3 1  ON 73
ci_075                -7.695077e-04 3 1  ON 74
ci_076                -5.482227e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7313e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6572
    reference variance = 0.761267
====================================================
  Execution time = 2.6503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1465e-01
  Total weights = 1.954955864e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502273646477
                                         uncertainty =       0.003900597882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502273646477
                                         uncertainty =       0.003900597882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501161637
  error estimate for blocks of size 2^( 2) =       0.000518893380
  error estimate for blocks of size 2^( 3) =       0.000534666881
  error estimate for blocks of size 2^( 4) =       0.000544912780
  error estimate for blocks of size 2^( 5) =       0.000552680553
  error estimate for blocks of size 2^( 6) =       0.000555819829
  error estimate for blocks of size 2^( 7) =       0.000556131464

      target function =                  N/A
              le_mean =     -22.670207408336
             les_mean =     514.452958192693
             stat err =       0.000552386157
             autocorr =       1.214870354389
              std dev =       0.708749583590
             le_variance =       0.502325972239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267020740834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670207408441       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670207408687       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670207408699       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670207408698       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 8.575487e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670207408441       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670207408502       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670207408505       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670207408505       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+05 is 2.143884e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670207408441       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670207408456       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670207408457       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670207408457       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+05 is 5.359716e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1299e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499192e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270678e-03 3 1  ON 10
ci_012                -8.839501e-03 3 1  ON 11
ci_013                 9.897140e-03 3 1  ON 12
ci_014                 8.430525e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269264e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108300e-03 3 1  ON 18
ci_020                -2.479065e-03 3 1  ON 19
ci_021                -7.526796e-03 3 1  ON 20
ci_022                -9.057724e-03 3 1  ON 21
ci_023                 8.520914e-03 3 1  ON 22
ci_024                 7.558117e-03 3 1  ON 23
ci_025                 5.748059e-03 3 1  ON 24
ci_026                 4.578842e-03 3 1  ON 25
ci_027                 7.201616e-03 3 1  ON 26
ci_028                 7.303317e-03 3 1  ON 27
ci_029                -4.383740e-03 3 1  ON 28
ci_030                -5.640865e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410466e-03 3 1  ON 31
ci_033                 4.089763e-03 3 1  ON 32
ci_034                 4.356572e-03 3 1  ON 33
ci_035                 1.959986e-03 3 1  ON 34
ci_036                 2.248302e-03 3 1  ON 35
ci_037                 4.261139e-03 3 1  ON 36
ci_038                 4.872385e-03 3 1  ON 37
ci_039                 4.990239e-03 3 1  ON 38
ci_040                 5.195084e-03 3 1  ON 39
ci_041                 5.078100e-03 3 1  ON 40
ci_042                 6.058365e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244663e-03 3 1  ON 43
ci_045                 4.037717e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551850e-04 3 1  ON 46
ci_048                -7.531033e-04 3 1  ON 47
ci_049                 1.645210e-03 3 1  ON 48
ci_050                 1.625922e-03 3 1  ON 49
ci_051                -7.925826e-04 3 1  ON 50
ci_052                -1.096105e-03 3 1  ON 51
ci_053                -2.586067e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753114e-03 3 1  ON 54
ci_056                -2.292983e-03 3 1  ON 55
ci_057                -1.177488e-03 3 1  ON 56
ci_058                -2.166397e-03 3 1  ON 57
ci_059                -1.527603e-04 3 1  ON 58
ci_060                 7.734985e-05 3 1  ON 59
ci_061                 5.523825e-04 3 1  ON 60
ci_062                 4.665818e-04 3 1  ON 61
ci_063                -6.261105e-04 3 1  ON 62
ci_064                -2.538532e-03 3 1  ON 63
ci_065                -2.627444e-03 3 1  ON 64
ci_066                -2.610492e-03 3 1  ON 65
ci_067                -1.131318e-03 3 1  ON 66
ci_068                -3.308902e-03 3 1  ON 67
ci_069                 1.184532e-03 3 1  ON 68
ci_070                -1.683473e-05 3 1  ON 69
ci_071                -1.954613e-03 3 1  ON 70
ci_072                -6.509075e-04 3 1  ON 71
ci_073                 3.685229e-04 3 1  ON 72
ci_074                -3.140054e-04 3 1  ON 73
ci_075                -7.695069e-04 3 1  ON 74
ci_076                -5.482249e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6439
    reference variance = 0.317547
====================================================
  Execution time = 2.5684e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0400e-01
  Total weights = 1.9550e+06
  Execution time = 3.6376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493610841485
                                         uncertainty =       0.002446070330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493610841485
                                         uncertainty =       0.002446070330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496732754
  error estimate for blocks of size 2^( 2) =       0.000514484990
  error estimate for blocks of size 2^( 3) =       0.000530630529
  error estimate for blocks of size 2^( 4) =       0.000541844256
  error estimate for blocks of size 2^( 5) =       0.000548303456
  error estimate for blocks of size 2^( 6) =       0.000551646275
  error estimate for blocks of size 2^( 7) =       0.000555001624

      target function =                  N/A
              le_mean =     -22.669067316708
             les_mean =     514.390615759604
             stat err =       0.000549198903
             autocorr =       1.222401081940
              std dev =       0.702486198206
             le_variance =       0.493486858669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493610841863
                                         uncertainty =       0.002446070524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493610841863
                                         uncertainty =       0.002446070524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496732755
  error estimate for blocks of size 2^( 2) =       0.000514484990
  error estimate for blocks of size 2^( 3) =       0.000530630530
  error estimate for blocks of size 2^( 4) =       0.000541844257
  error estimate for blocks of size 2^( 5) =       0.000548303456
  error estimate for blocks of size 2^( 6) =       0.000551646275
  error estimate for blocks of size 2^( 7) =       0.000555001624

      target function =                  N/A
              le_mean =     -22.669067316758
             les_mean =     514.390615745049
             stat err =       0.000549198903
             autocorr =       1.222401081129
              std dev =       0.702486198480
             le_variance =       0.493486859055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493610841674
                                         uncertainty =       0.002446070427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493610841674
                                         uncertainty =       0.002446070427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496732755
  error estimate for blocks of size 2^( 2) =       0.000514484990
  error estimate for blocks of size 2^( 3) =       0.000530630529
  error estimate for blocks of size 2^( 4) =       0.000541844256
  error estimate for blocks of size 2^( 5) =       0.000548303456
  error estimate for blocks of size 2^( 6) =       0.000551646275
  error estimate for blocks of size 2^( 7) =       0.000555001624

      target function =                  N/A
              le_mean =     -22.669067316733
             les_mean =     514.390615752323
             stat err =       0.000549198903
             autocorr =       1.222401081541
              std dev =       0.702486198343
             le_variance =       0.493486858862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493610841509
                                         uncertainty =       0.002446070343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493610841509
                                         uncertainty =       0.002446070343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496732754
  error estimate for blocks of size 2^( 2) =       0.000514484990
  error estimate for blocks of size 2^( 3) =       0.000530630529
  error estimate for blocks of size 2^( 4) =       0.000541844256
  error estimate for blocks of size 2^( 5) =       0.000548303456
  error estimate for blocks of size 2^( 6) =       0.000551646275
  error estimate for blocks of size 2^( 7) =       0.000555001624

      target function =                  N/A
              le_mean =     -22.669067316711
             les_mean =     514.390615758694
             stat err =       0.000549198903
             autocorr =       1.222401081892
              std dev =       0.702486198223
             le_variance =       0.493486858693


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669067316708        initial
     3.8147e+04     3.8147e+05             8.5755e-09       -22.669067316758  <--
     1.5259e+05     1.5259e+06             2.1439e-09       -22.669067316733
     6.1035e+05     6.1035e+06             5.3597e-10       -22.669067316711

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 4.3923e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735311e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682989e-05 3 1  ON 69
ci_071                -1.954619e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482313e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5228e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6436
    reference variance = 0.327475
====================================================
  Execution time = 2.6243e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1918e-01
  Total weights = 1.955009185e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497643577380
                                         uncertainty =       0.002859497441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497643577380
                                         uncertainty =       0.002859497441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499051826
  error estimate for blocks of size 2^( 2) =       0.000517082527
  error estimate for blocks of size 2^( 3) =       0.000532800176
  error estimate for blocks of size 2^( 4) =       0.000544016740
  error estimate for blocks of size 2^( 5) =       0.000552164272
  error estimate for blocks of size 2^( 6) =       0.000555502603
  error estimate for blocks of size 2^( 7) =       0.000556582442

      target function =                  N/A
              le_mean =     -22.670003831953
             les_mean =     514.448248874176
             stat err =       0.000552066514
             autocorr =       1.223746641984
              std dev =       0.705765860834
             le_variance =       0.498105450318


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267000383195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670003832065       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670003831403       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670003831925       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670003831987       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670003831989       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+03 is 1.849940e-07

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670003832065       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670003831900       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670003832030       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670003832047       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670003832046       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 4.624943e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670003832065       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670003832024       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670003832057       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670003832058       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670003832060       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+05 is 1.156242e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045753 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1054e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767678e-02 3 1  ON 3
ci_005                 1.613775e-02 3 1  ON 4
ci_006                 1.499191e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175749e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303024e-02 3 1  ON 9
ci_011                -8.270673e-03 3 1  ON 10
ci_012                -8.839488e-03 3 1  ON 11
ci_013                 9.897135e-03 3 1  ON 12
ci_014                 8.430500e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061582e-02 3 1  ON 16
ci_018                 1.086354e-02 3 1  ON 17
ci_019                -3.108301e-03 3 1  ON 18
ci_020                -2.479076e-03 3 1  ON 19
ci_021                -7.526802e-03 3 1  ON 20
ci_022                -9.057727e-03 3 1  ON 21
ci_023                 8.520902e-03 3 1  ON 22
ci_024                 7.558122e-03 3 1  ON 23
ci_025                 5.748053e-03 3 1  ON 24
ci_026                 4.578830e-03 3 1  ON 25
ci_027                 7.201621e-03 3 1  ON 26
ci_028                 7.303316e-03 3 1  ON 27
ci_029                -4.383741e-03 3 1  ON 28
ci_030                -5.640850e-03 3 1  ON 29
ci_031                -8.182942e-03 3 1  ON 30
ci_032                -7.410466e-03 3 1  ON 31
ci_033                 4.089770e-03 3 1  ON 32
ci_034                 4.356569e-03 3 1  ON 33
ci_035                 1.959984e-03 3 1  ON 34
ci_036                 2.248318e-03 3 1  ON 35
ci_037                 4.261148e-03 3 1  ON 36
ci_038                 4.872368e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195096e-03 3 1  ON 39
ci_041                 5.078092e-03 3 1  ON 40
ci_042                 6.058379e-03 3 1  ON 41
ci_043                 5.022641e-03 3 1  ON 42
ci_044                 5.244648e-03 3 1  ON 43
ci_045                 4.037716e-03 3 1  ON 44
ci_046                 3.073310e-03 3 1  ON 45
ci_047                -2.551763e-04 3 1  ON 46
ci_048                -7.530959e-04 3 1  ON 47
ci_049                 1.645207e-03 3 1  ON 48
ci_050                 1.625914e-03 3 1  ON 49
ci_051                -7.925801e-04 3 1  ON 50
ci_052                -1.096114e-03 3 1  ON 51
ci_053                -2.586065e-03 3 1  ON 52
ci_054                -3.194037e-03 3 1  ON 53
ci_055                -1.753116e-03 3 1  ON 54
ci_056                -2.292981e-03 3 1  ON 55
ci_057                -1.177501e-03 3 1  ON 56
ci_058                -2.166390e-03 3 1  ON 57
ci_059                -1.527680e-04 3 1  ON 58
ci_060                 7.730686e-05 3 1  ON 59
ci_061                 5.523636e-04 3 1  ON 60
ci_062                 4.665632e-04 3 1  ON 61
ci_063                -6.261088e-04 3 1  ON 62
ci_064                -2.538550e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610496e-03 3 1  ON 65
ci_067                -1.131319e-03 3 1  ON 66
ci_068                -3.308878e-03 3 1  ON 67
ci_069                 1.184528e-03 3 1  ON 68
ci_070                -1.682655e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.508968e-04 3 1  ON 71
ci_073                 3.685474e-04 3 1  ON 72
ci_074                -3.139763e-04 3 1  ON 73
ci_075                -7.695249e-04 3 1  ON 74
ci_076                -5.482378e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7029
    reference variance = 0.369771
====================================================
  Execution time = 2.5552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1837e-01
  Total weights = 1.9549e+06
  Execution time = 3.6522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501895282200
                                         uncertainty =       0.004633786207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501895282200
                                         uncertainty =       0.004633786207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501114897
  error estimate for blocks of size 2^( 2) =       0.000519409548
  error estimate for blocks of size 2^( 3) =       0.000534973912
  error estimate for blocks of size 2^( 4) =       0.000546278825
  error estimate for blocks of size 2^( 5) =       0.000553014559
  error estimate for blocks of size 2^( 6) =       0.000555683760
  error estimate for blocks of size 2^( 7) =       0.000559971551

      target function =                  N/A
              le_mean =     -22.669467284705
             les_mean =     514.423112676892
             stat err =       0.000553737174
             autocorr =       1.221047988062
              std dev =       0.708683483660
             le_variance =       0.502232280012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501895275872
                                         uncertainty =       0.004633782286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501895275872
                                         uncertainty =       0.004633782286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501114894
  error estimate for blocks of size 2^( 2) =       0.000519409546
  error estimate for blocks of size 2^( 3) =       0.000534973913
  error estimate for blocks of size 2^( 4) =       0.000546278827
  error estimate for blocks of size 2^( 5) =       0.000553014563
  error estimate for blocks of size 2^( 6) =       0.000555683763
  error estimate for blocks of size 2^( 7) =       0.000559971548

      target function =                  N/A
              le_mean =     -22.669467284289
             les_mean =     514.423112760002
             stat err =       0.000553737175
             autocorr =       1.221048011386
              std dev =       0.708683479131
             le_variance =       0.502232273593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501895279036
                                         uncertainty =       0.004633784246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501895279036
                                         uncertainty =       0.004633784246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501114895
  error estimate for blocks of size 2^( 2) =       0.000519409547
  error estimate for blocks of size 2^( 3) =       0.000534973913
  error estimate for blocks of size 2^( 4) =       0.000546278826
  error estimate for blocks of size 2^( 5) =       0.000553014561
  error estimate for blocks of size 2^( 6) =       0.000555683762
  error estimate for blocks of size 2^( 7) =       0.000559971549

      target function =                  N/A
              le_mean =     -22.669467284497
             les_mean =     514.423112718362
             stat err =       0.000553737175
             autocorr =       1.221047999730
              std dev =       0.708683481395
             le_variance =       0.502232276802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501895281805
                                         uncertainty =       0.004633785962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501895281805
                                         uncertainty =       0.004633785962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501114897
  error estimate for blocks of size 2^( 2) =       0.000519409548
  error estimate for blocks of size 2^( 3) =       0.000534973912
  error estimate for blocks of size 2^( 4) =       0.000546278825
  error estimate for blocks of size 2^( 5) =       0.000553014559
  error estimate for blocks of size 2^( 6) =       0.000555683760
  error estimate for blocks of size 2^( 7) =       0.000559971551

      target function =                  N/A
              le_mean =     -22.669467284679
             les_mean =     514.423112682066
             stat err =       0.000553737174
             autocorr =       1.221047989531
              std dev =       0.708683483376
             le_variance =       0.502232279610


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669467284705        initial  <--
     9.5367e+03     9.5367e+04             1.8499e-07       -22.669467284289
     3.8147e+04     3.8147e+05             4.6249e-08       -22.669467284497
     1.5259e+05     1.5259e+06             1.1562e-08       -22.669467284679

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8471
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735311e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682989e-05 3 1  ON 69
ci_071                -1.954619e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482313e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4908e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7299
    reference variance = 0.417742
====================================================
  Execution time = 2.6314e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0614e-01
  Total weights = 1.955180055e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7440e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494854755770
                                         uncertainty =       0.003002249941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494854755770
                                         uncertainty =       0.003002249941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497391563
  error estimate for blocks of size 2^( 2) =       0.000514953372
  error estimate for blocks of size 2^( 3) =       0.000531579430
  error estimate for blocks of size 2^( 4) =       0.000543202844
  error estimate for blocks of size 2^( 5) =       0.000550085961
  error estimate for blocks of size 2^( 6) =       0.000553943377
  error estimate for blocks of size 2^( 7) =       0.000555353678

      target function =                  N/A
              le_mean =     -22.669786252226
             les_mean =     514.425349388147
             stat err =       0.000550646465
             autocorr =       1.225600366176
              std dev =       0.703417894586
             le_variance =       0.494796734423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266978625223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669786252315       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669786252430       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669786252428       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669786252445       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+04 is 4.680430e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669786252315       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669786252344       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669786252343       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669786252343       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+05 is 1.170109e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669786252315       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669786252322       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669786252322       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669786252322       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+06 is 2.925273e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047041 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1063e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839502e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430531e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558117e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201619e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356571e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248296e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990236e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244658e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073324e-03 3 1  ON 45
ci_047                -2.551828e-04 3 1  ON 46
ci_048                -7.531061e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925839e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586070e-03 3 1  ON 52
ci_054                -3.194041e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292981e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527607e-04 3 1  ON 58
ci_060                 7.735367e-05 3 1  ON 59
ci_061                 5.523803e-04 3 1  ON 60
ci_062                 4.665814e-04 3 1  ON 61
ci_063                -6.261078e-04 3 1  ON 62
ci_064                -2.538530e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610496e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682981e-05 3 1  ON 69
ci_071                -1.954619e-03 3 1  ON 70
ci_072                -6.509130e-04 3 1  ON 71
ci_073                 3.685250e-04 3 1  ON 72
ci_074                -3.140026e-04 3 1  ON 73
ci_075                -7.695040e-04 3 1  ON 74
ci_076                -5.482304e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.601
    reference variance = 0.582785
====================================================
  Execution time = 2.5760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0641e-01
  Total weights = 1.9550e+06
  Execution time = 3.6473e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495227051032
                                         uncertainty =       0.002462270418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495227051032
                                         uncertainty =       0.002462270418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497557863
  error estimate for blocks of size 2^( 2) =       0.000515860841
  error estimate for blocks of size 2^( 3) =       0.000531700855
  error estimate for blocks of size 2^( 4) =       0.000543586197
  error estimate for blocks of size 2^( 5) =       0.000548842432
  error estimate for blocks of size 2^( 6) =       0.000552008825
  error estimate for blocks of size 2^( 7) =       0.000554090510

      target function =                  N/A
              le_mean =     -22.669676836315
             les_mean =     514.420656433663
             stat err =       0.000549631991
             autocorr =       1.220272483145
              std dev =       0.703653077494
             le_variance =       0.495127653467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495227050343
                                         uncertainty =       0.002462270395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495227050343
                                         uncertainty =       0.002462270395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497557862
  error estimate for blocks of size 2^( 2) =       0.000515860840
  error estimate for blocks of size 2^( 3) =       0.000531700855
  error estimate for blocks of size 2^( 4) =       0.000543586197
  error estimate for blocks of size 2^( 5) =       0.000548842432
  error estimate for blocks of size 2^( 6) =       0.000552008825
  error estimate for blocks of size 2^( 7) =       0.000554090509

      target function =                  N/A
              le_mean =     -22.669676836271
             les_mean =     514.420656450409
             stat err =       0.000549631991
             autocorr =       1.220272483290
              std dev =       0.703653077005
             le_variance =       0.495127652778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495227050687
                                         uncertainty =       0.002462270406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495227050687
                                         uncertainty =       0.002462270406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497557863
  error estimate for blocks of size 2^( 2) =       0.000515860840
  error estimate for blocks of size 2^( 3) =       0.000531700855
  error estimate for blocks of size 2^( 4) =       0.000543586197
  error estimate for blocks of size 2^( 5) =       0.000548842432
  error estimate for blocks of size 2^( 6) =       0.000552008825
  error estimate for blocks of size 2^( 7) =       0.000554090510

      target function =                  N/A
              le_mean =     -22.669676836293
             les_mean =     514.420656442034
             stat err =       0.000549631991
             autocorr =       1.220272483213
              std dev =       0.703653077249
             le_variance =       0.495127653122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495227050989
                                         uncertainty =       0.002462270416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495227050989
                                         uncertainty =       0.002462270416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497557863
  error estimate for blocks of size 2^( 2) =       0.000515860841
  error estimate for blocks of size 2^( 3) =       0.000531700855
  error estimate for blocks of size 2^( 4) =       0.000543586197
  error estimate for blocks of size 2^( 5) =       0.000548842432
  error estimate for blocks of size 2^( 6) =       0.000552008825
  error estimate for blocks of size 2^( 7) =       0.000554090510

      target function =                  N/A
              le_mean =     -22.669676836313
             les_mean =     514.420656434709
             stat err =       0.000549631991
             autocorr =       1.220272483151
              std dev =       0.703653077464
             le_variance =       0.495127653424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669676836315        initial  <--
     9.5367e+04     9.5367e+05             4.6804e-09       -22.669676836271
     3.8147e+05     3.8147e+06             1.1701e-09       -22.669676836293
     1.5259e+06     1.5259e+07             2.9253e-10       -22.669676836313

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0480
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735311e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682989e-05 3 1  ON 69
ci_071                -1.954619e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482313e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5117e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7173
    reference variance = 0.354696
====================================================
  Execution time = 2.8222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0773e-01
  Total weights = 1.955295906e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493065872745
                                         uncertainty =       0.002509368840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493065872745
                                         uncertainty =       0.002509368840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496580489
  error estimate for blocks of size 2^( 2) =       0.000514659482
  error estimate for blocks of size 2^( 3) =       0.000530509316
  error estimate for blocks of size 2^( 4) =       0.000541984166
  error estimate for blocks of size 2^( 5) =       0.000551014877
  error estimate for blocks of size 2^( 6) =       0.000553852518
  error estimate for blocks of size 2^( 7) =       0.000558611711

      target function =                  N/A
              le_mean =     -22.669314818273
             les_mean =     514.405562398991
             stat err =       0.000551365818
             autocorr =       1.232821993228
              std dev =       0.702270862117
             le_variance =       0.493184363779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266931481827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669314818334       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669314818346       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669314818346       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669314818100       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+05 is 6.487036e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669314818334       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669314818337       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669314818337       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669314819137       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+06 is 1.621759e-10

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669314818334       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669314818335       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669314818335       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669314818335       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+07 is 4.054399e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2984e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430531e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586070e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735312e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261079e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682994e-05 3 1  ON 69
ci_071                -1.954619e-03 3 1  ON 70
ci_072                -6.509129e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140023e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482313e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6694
    reference variance = 0.458033
====================================================
  Execution time = 2.5745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1334e-01
  Total weights = 1.9553e+06
  Execution time = 3.7050e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497394979233
                                         uncertainty =       0.002759865860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497394979233
                                         uncertainty =       0.002759865860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498626850
  error estimate for blocks of size 2^( 2) =       0.000516593642
  error estimate for blocks of size 2^( 3) =       0.000532965002
  error estimate for blocks of size 2^( 4) =       0.000544638965
  error estimate for blocks of size 2^( 5) =       0.000550769794
  error estimate for blocks of size 2^( 6) =       0.000555469723
  error estimate for blocks of size 2^( 7) =       0.000554757825

      target function =                  N/A
              le_mean =     -22.669008960084
             les_mean =     514.397305584821
             stat err =       0.000551409077
             autocorr =       1.222915644465
              std dev =       0.705164853302
             le_variance =       0.497257470332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497394979286
                                         uncertainty =       0.002759865876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497394979286
                                         uncertainty =       0.002759865876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498626850
  error estimate for blocks of size 2^( 2) =       0.000516593642
  error estimate for blocks of size 2^( 3) =       0.000532965002
  error estimate for blocks of size 2^( 4) =       0.000544638965
  error estimate for blocks of size 2^( 5) =       0.000550769794
  error estimate for blocks of size 2^( 6) =       0.000555469723
  error estimate for blocks of size 2^( 7) =       0.000554757825

      target function =                  N/A
              le_mean =     -22.669008960084
             les_mean =     514.397305585320
             stat err =       0.000551409077
             autocorr =       1.222915644494
              std dev =       0.705164853339
             le_variance =       0.497257470385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497394979260
                                         uncertainty =       0.002759865868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497394979260
                                         uncertainty =       0.002759865868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498626850
  error estimate for blocks of size 2^( 2) =       0.000516593642
  error estimate for blocks of size 2^( 3) =       0.000532965002
  error estimate for blocks of size 2^( 4) =       0.000544638965
  error estimate for blocks of size 2^( 5) =       0.000550769794
  error estimate for blocks of size 2^( 6) =       0.000555469723
  error estimate for blocks of size 2^( 7) =       0.000554757825

      target function =                  N/A
              le_mean =     -22.669008960084
             les_mean =     514.397305585070
             stat err =       0.000551409077
             autocorr =       1.222915644485
              std dev =       0.705164853321
             le_variance =       0.497257470359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497394979236
                                         uncertainty =       0.002759865861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497394979236
                                         uncertainty =       0.002759865861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498626850
  error estimate for blocks of size 2^( 2) =       0.000516593642
  error estimate for blocks of size 2^( 3) =       0.000532965002
  error estimate for blocks of size 2^( 4) =       0.000544638965
  error estimate for blocks of size 2^( 5) =       0.000550769794
  error estimate for blocks of size 2^( 6) =       0.000555469723
  error estimate for blocks of size 2^( 7) =       0.000554757825

      target function =                  N/A
              le_mean =     -22.669008960084
             les_mean =     514.397305584852
             stat err =       0.000551409077
             autocorr =       1.222915644475
              std dev =       0.705164853304
             le_variance =       0.497257470335


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669008960084        initial  <--
     9.5367e+05     9.5367e+06             6.4870e-10       -22.669008960084
     3.8147e+06     3.8147e+07             1.6218e-10       -22.669008960084
     1.5259e+07     1.5259e+08             4.0544e-11       -22.669008960084

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0837
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735311e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682989e-05 3 1  ON 69
ci_071                -1.954619e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482313e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6844
    reference variance = 0.366929
====================================================
  Execution time = 2.6400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1708e-01
  Total weights = 1.955119772e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503771031655
                                         uncertainty =       0.011269631570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503771031655
                                         uncertainty =       0.011269631570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502025045
  error estimate for blocks of size 2^( 2) =       0.000520200205
  error estimate for blocks of size 2^( 3) =       0.000535976920
  error estimate for blocks of size 2^( 4) =       0.000547117335
  error estimate for blocks of size 2^( 5) =       0.000553886312
  error estimate for blocks of size 2^( 6) =       0.000556009948
  error estimate for blocks of size 2^( 7) =       0.000558151538

      target function =                  N/A
              le_mean =     -22.669566565797
             les_mean =     514.426332390373
             stat err =       0.000553791283
             autocorr =       1.216862378328
              std dev =       0.709970626998
             le_variance =       0.504058291199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266956656580e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669566565887       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669566565888       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669566565888       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669566565888       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+06 is 5.239870e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669566565887       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669566565887       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669566565887       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669566565887       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+07 is 1.309967e-11

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669566565887       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669566565887       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669566565887       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669566631949       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+08 is 3.274956e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1146e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735310e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682989e-05 3 1  ON 69
ci_071                -1.954619e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6685
    reference variance = 0.376003
====================================================
  Execution time = 2.5790e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1431e-01
  Total weights = 1.9555e+06
  Execution time = 3.6286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499431065622
                                         uncertainty =       0.002993586231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499431065622
                                         uncertainty =       0.002993586231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499691176
  error estimate for blocks of size 2^( 2) =       0.000517452082
  error estimate for blocks of size 2^( 3) =       0.000533122163
  error estimate for blocks of size 2^( 4) =       0.000544700553
  error estimate for blocks of size 2^( 5) =       0.000550479435
  error estimate for blocks of size 2^( 6) =       0.000554537445
  error estimate for blocks of size 2^( 7) =       0.000558609920

      target function =                  N/A
              le_mean =     -22.668601576281
             les_mean =     514.379808156481
             stat err =       0.000552081838
             autocorr =       1.220684865879
              std dev =       0.706670038331
             le_variance =       0.499382543075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499431065626
                                         uncertainty =       0.002993586232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499431065626
                                         uncertainty =       0.002993586232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499691176
  error estimate for blocks of size 2^( 2) =       0.000517452082
  error estimate for blocks of size 2^( 3) =       0.000533122163
  error estimate for blocks of size 2^( 4) =       0.000544700553
  error estimate for blocks of size 2^( 5) =       0.000550479435
  error estimate for blocks of size 2^( 6) =       0.000554537445
  error estimate for blocks of size 2^( 7) =       0.000558609920

      target function =                  N/A
              le_mean =     -22.668601576282
             les_mean =     514.379808156528
             stat err =       0.000552081838
             autocorr =       1.220684865883
              std dev =       0.706670038334
             le_variance =       0.499382543079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499431065624
                                         uncertainty =       0.002993586231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499431065624
                                         uncertainty =       0.002993586231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499691176
  error estimate for blocks of size 2^( 2) =       0.000517452082
  error estimate for blocks of size 2^( 3) =       0.000533122163
  error estimate for blocks of size 2^( 4) =       0.000544700553
  error estimate for blocks of size 2^( 5) =       0.000550479435
  error estimate for blocks of size 2^( 6) =       0.000554537445
  error estimate for blocks of size 2^( 7) =       0.000558609920

      target function =                  N/A
              le_mean =     -22.668601576281
             les_mean =     514.379808156504
             stat err =       0.000552081838
             autocorr =       1.220684865881
              std dev =       0.706670038332
             le_variance =       0.499382543076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499431065622
                                         uncertainty =       0.002993586231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499431065622
                                         uncertainty =       0.002993586231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499691176
  error estimate for blocks of size 2^( 2) =       0.000517452082
  error estimate for blocks of size 2^( 3) =       0.000533122163
  error estimate for blocks of size 2^( 4) =       0.000544700553
  error estimate for blocks of size 2^( 5) =       0.000550479435
  error estimate for blocks of size 2^( 6) =       0.000554537445
  error estimate for blocks of size 2^( 7) =       0.000558609920

      target function =                  N/A
              le_mean =     -22.668601576281
             les_mean =     514.379808156484
             stat err =       0.000552081838
             autocorr =       1.220684865874
              std dev =       0.706670038331
             le_variance =       0.499382543075


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668601576281        initial
     9.5367e+06     9.5367e+07             5.2399e-11       -22.668601576282  <--
     3.8147e+07     3.8147e+08             1.3100e-11       -22.668601576281
     1.5259e+08     1.5259e+09             3.2750e-12       -22.668601576281

*****************************************************************************
Applying the update for shift_i =   9.5367e+06     and shift_s =   9.5367e+07
*****************************************************************************

  Execution time = 4.3984e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.5966
    reference variance = 0.332133
====================================================
  Execution time = 2.6470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0895e-01
  Total weights = 1.955176933e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497089889509
                                         uncertainty =       0.002208340106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497089889509
                                         uncertainty =       0.002208340106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498487817
  error estimate for blocks of size 2^( 2) =       0.000516674708
  error estimate for blocks of size 2^( 3) =       0.000533060530
  error estimate for blocks of size 2^( 4) =       0.000544985115
  error estimate for blocks of size 2^( 5) =       0.000552705559
  error estimate for blocks of size 2^( 6) =       0.000556068763
  error estimate for blocks of size 2^( 7) =       0.000558369679

      target function =                  N/A
              le_mean =     -22.669602829823
             les_mean =     514.419839674724
             stat err =       0.000553032279
             autocorr =       1.230812405526
              std dev =       0.704968231005
             le_variance =       0.496980206726


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266960282982e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669602829943       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669602829945       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669602829945       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669602829945       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+06 is 2.344480e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669602829943       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669602829943       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669602829943       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669602829943       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+06 is 5.861205e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669602829943       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669602829943       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669602829943       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669602829311       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+07 is 1.465300e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1192e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735312e-05 3 1  ON 59
ci_061                 5.523806e-04 3 1  ON 60
ci_062                 4.665819e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509129e-04 3 1  ON 71
ci_073                 3.685248e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482313e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7167
    reference variance = 0.504397
====================================================
  Execution time = 2.5674e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1059e-01
  Total weights = 1.9553e+06
  Execution time = 3.6420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497663999167
                                         uncertainty =       0.002727265676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497663999167
                                         uncertainty =       0.002727265676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498874207
  error estimate for blocks of size 2^( 2) =       0.000516368717
  error estimate for blocks of size 2^( 3) =       0.000531816023
  error estimate for blocks of size 2^( 4) =       0.000543317741
  error estimate for blocks of size 2^( 5) =       0.000550520876
  error estimate for blocks of size 2^( 6) =       0.000554685028
  error estimate for blocks of size 2^( 7) =       0.000555729406

      target function =                  N/A
              le_mean =     -22.670033690971
             les_mean =     514.441020339562
             stat err =       0.000551063263
             autocorr =       1.220171330473
              std dev =       0.705514670129
             le_variance =       0.497750949767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497663999174
                                         uncertainty =       0.002727265678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497663999174
                                         uncertainty =       0.002727265678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498874207
  error estimate for blocks of size 2^( 2) =       0.000516368717
  error estimate for blocks of size 2^( 3) =       0.000531816023
  error estimate for blocks of size 2^( 4) =       0.000543317741
  error estimate for blocks of size 2^( 5) =       0.000550520876
  error estimate for blocks of size 2^( 6) =       0.000554685028
  error estimate for blocks of size 2^( 7) =       0.000555729406

      target function =                  N/A
              le_mean =     -22.670033690970
             les_mean =     514.441020339558
             stat err =       0.000551063263
             autocorr =       1.220171330435
              std dev =       0.705514670134
             le_variance =       0.497750949775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497663999170
                                         uncertainty =       0.002727265677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497663999170
                                         uncertainty =       0.002727265677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498874207
  error estimate for blocks of size 2^( 2) =       0.000516368717
  error estimate for blocks of size 2^( 3) =       0.000531816023
  error estimate for blocks of size 2^( 4) =       0.000543317741
  error estimate for blocks of size 2^( 5) =       0.000550520876
  error estimate for blocks of size 2^( 6) =       0.000554685028
  error estimate for blocks of size 2^( 7) =       0.000555729406

      target function =                  N/A
              le_mean =     -22.670033690971
             les_mean =     514.441020339560
             stat err =       0.000551063263
             autocorr =       1.220171330457
              std dev =       0.705514670132
             le_variance =       0.497750949772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497663999167
                                         uncertainty =       0.002727265676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497663999167
                                         uncertainty =       0.002727265676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498874207
  error estimate for blocks of size 2^( 2) =       0.000516368717
  error estimate for blocks of size 2^( 3) =       0.000531816023
  error estimate for blocks of size 2^( 4) =       0.000543317741
  error estimate for blocks of size 2^( 5) =       0.000550520876
  error estimate for blocks of size 2^( 6) =       0.000554685028
  error estimate for blocks of size 2^( 7) =       0.000555729406

      target function =                  N/A
              le_mean =     -22.670033690971
             les_mean =     514.441020339562
             stat err =       0.000551063263
             autocorr =       1.220171330479
              std dev =       0.705514670129
             le_variance =       0.497750949768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670033690971        initial  <--
     2.3842e+06     2.3842e+07             2.3445e-10       -22.670033690970
     9.5367e+06     9.5367e+07             5.8612e-11       -22.670033690971
     3.8147e+07     3.8147e+08             1.4653e-11       -22.670033690971

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9133
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5111e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.5992
    reference variance = 0.407917
====================================================
  Execution time = 2.6496e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0691e-01
  Total weights = 1.955142520e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7440e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492224959651
                                         uncertainty =       0.002573679818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492224959651
                                         uncertainty =       0.002573679818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496048024
  error estimate for blocks of size 2^( 2) =       0.000513920102
  error estimate for blocks of size 2^( 3) =       0.000530027919
  error estimate for blocks of size 2^( 4) =       0.000540913969
  error estimate for blocks of size 2^( 5) =       0.000547771445
  error estimate for blocks of size 2^( 6) =       0.000551837735
  error estimate for blocks of size 2^( 7) =       0.000555999348

      target function =                  N/A
              le_mean =     -22.668848487731
             les_mean =     514.383603008023
             stat err =       0.000549130624
             autocorr =       1.225473378845
              std dev =       0.701517842529
             le_variance =       0.492127283386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266884848773e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668848487818       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668848487818       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668848487818       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668848487818       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+07 is 2.087510e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668848487818       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668848487818       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668848487818       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668848487818       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+07 is 5.218774e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668848487818       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668848487818       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668848487818       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668848487818       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+08 is 1.304532e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1246e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6583
    reference variance = 0.300783
====================================================
  Execution time = 2.5780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0829e-01
  Total weights = 1.9554e+06
  Execution time = 3.6389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494557463915
                                         uncertainty =       0.002727984190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494557463915
                                         uncertainty =       0.002727984190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497204032
  error estimate for blocks of size 2^( 2) =       0.000515326900
  error estimate for blocks of size 2^( 3) =       0.000531067680
  error estimate for blocks of size 2^( 4) =       0.000543041339
  error estimate for blocks of size 2^( 5) =       0.000549896726
  error estimate for blocks of size 2^( 6) =       0.000554557707
  error estimate for blocks of size 2^( 7) =       0.000556706412

      target function =                  N/A
              le_mean =     -22.669380012440
             les_mean =     514.409083921327
             stat err =       0.000551050546
             autocorr =       1.228325847997
              std dev =       0.703152684769
             le_variance =       0.494423698099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494557463912
                                         uncertainty =       0.002727984190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494557463912
                                         uncertainty =       0.002727984190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497204032
  error estimate for blocks of size 2^( 2) =       0.000515326900
  error estimate for blocks of size 2^( 3) =       0.000531067680
  error estimate for blocks of size 2^( 4) =       0.000543041339
  error estimate for blocks of size 2^( 5) =       0.000549896726
  error estimate for blocks of size 2^( 6) =       0.000554557707
  error estimate for blocks of size 2^( 7) =       0.000556706412

      target function =                  N/A
              le_mean =     -22.669380012439
             les_mean =     514.409083921300
             stat err =       0.000551050546
             autocorr =       1.228325847995
              std dev =       0.703152684767
             le_variance =       0.494423698096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494557463914
                                         uncertainty =       0.002727984190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494557463914
                                         uncertainty =       0.002727984190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497204032
  error estimate for blocks of size 2^( 2) =       0.000515326900
  error estimate for blocks of size 2^( 3) =       0.000531067680
  error estimate for blocks of size 2^( 4) =       0.000543041339
  error estimate for blocks of size 2^( 5) =       0.000549896726
  error estimate for blocks of size 2^( 6) =       0.000554557707
  error estimate for blocks of size 2^( 7) =       0.000556706412

      target function =                  N/A
              le_mean =     -22.669380012440
             les_mean =     514.409083921314
             stat err =       0.000551050546
             autocorr =       1.228325847995
              std dev =       0.703152684768
             le_variance =       0.494423698097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494557463915
                                         uncertainty =       0.002727984190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494557463915
                                         uncertainty =       0.002727984190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497204032
  error estimate for blocks of size 2^( 2) =       0.000515326900
  error estimate for blocks of size 2^( 3) =       0.000531067680
  error estimate for blocks of size 2^( 4) =       0.000543041339
  error estimate for blocks of size 2^( 5) =       0.000549896726
  error estimate for blocks of size 2^( 6) =       0.000554557707
  error estimate for blocks of size 2^( 7) =       0.000556706412

      target function =                  N/A
              le_mean =     -22.669380012440
             les_mean =     514.409083921325
             stat err =       0.000551050546
             autocorr =       1.228325847997
              std dev =       0.703152684770
             le_variance =       0.494423698099


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669380012440        initial  <--
     2.3842e+07     2.3842e+08             2.0875e-11       -22.669380012439
     9.5367e+07     9.5367e+08             5.2188e-12       -22.669380012440
     3.8147e+08     3.8147e+09             1.3045e-12       -22.669380012440

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0127
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5265e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.5241
    reference variance = 0.327903
====================================================
  Execution time = 2.8062e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0309e-01
  Total weights = 1.955025144e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491369284512
                                         uncertainty =       0.002027943741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491369284512
                                         uncertainty =       0.002027943741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495643076
  error estimate for blocks of size 2^( 2) =       0.000513698811
  error estimate for blocks of size 2^( 3) =       0.000529141170
  error estimate for blocks of size 2^( 4) =       0.000540563097
  error estimate for blocks of size 2^( 5) =       0.000547912025
  error estimate for blocks of size 2^( 6) =       0.000552196717
  error estimate for blocks of size 2^( 7) =       0.000554080787

      target function =                  N/A
              le_mean =     -22.669317792522
             les_mean =     514.401057911415
             stat err =       0.000548688157
             autocorr =       1.225499347213
              std dev =       0.700945160676
             le_variance =       0.491324118276


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266931779252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669317792567       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669317792567       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669317792567       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669317792567       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+08 is 1.995564e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669317792567       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669317792567       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669317792567       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669317792567       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+08 is 4.988959e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669317792567       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669317792567       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669317792567       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669318890292       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+09 is 1.247277e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053630 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2846e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.6645
    reference variance = 0.712161
====================================================
  Execution time = 2.5968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0557e-01
  Total weights = 1.9556e+06
  Execution time = 3.6518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494492329782
                                         uncertainty =       0.002325348999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494492329782
                                         uncertainty =       0.002325348999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497221416
  error estimate for blocks of size 2^( 2) =       0.000515157174
  error estimate for blocks of size 2^( 3) =       0.000531122125
  error estimate for blocks of size 2^( 4) =       0.000542854072
  error estimate for blocks of size 2^( 5) =       0.000550415799
  error estimate for blocks of size 2^( 6) =       0.000553013870
  error estimate for blocks of size 2^( 7) =       0.000553898757

      target function =                  N/A
              le_mean =     -22.669787993256
             les_mean =     514.424858635505
             stat err =       0.000550045624
             autocorr =       1.223764290224
              std dev =       0.703177270173
             le_variance =       0.494458273287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494492329781
                                         uncertainty =       0.002325348999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494492329781
                                         uncertainty =       0.002325348999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497221416
  error estimate for blocks of size 2^( 2) =       0.000515157174
  error estimate for blocks of size 2^( 3) =       0.000531122125
  error estimate for blocks of size 2^( 4) =       0.000542854072
  error estimate for blocks of size 2^( 5) =       0.000550415799
  error estimate for blocks of size 2^( 6) =       0.000553013870
  error estimate for blocks of size 2^( 7) =       0.000553898757

      target function =                  N/A
              le_mean =     -22.669787993256
             les_mean =     514.424858635486
             stat err =       0.000550045624
             autocorr =       1.223764290214
              std dev =       0.703177270172
             le_variance =       0.494458273287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494492329781
                                         uncertainty =       0.002325348999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494492329781
                                         uncertainty =       0.002325348999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497221416
  error estimate for blocks of size 2^( 2) =       0.000515157174
  error estimate for blocks of size 2^( 3) =       0.000531122125
  error estimate for blocks of size 2^( 4) =       0.000542854072
  error estimate for blocks of size 2^( 5) =       0.000550415799
  error estimate for blocks of size 2^( 6) =       0.000553013870
  error estimate for blocks of size 2^( 7) =       0.000553898757

      target function =                  N/A
              le_mean =     -22.669787993256
             les_mean =     514.424858635496
             stat err =       0.000550045624
             autocorr =       1.223764290216
              std dev =       0.703177270172
             le_variance =       0.494458273287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494492329782
                                         uncertainty =       0.002325348999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494492329782
                                         uncertainty =       0.002325348999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497221416
  error estimate for blocks of size 2^( 2) =       0.000515157174
  error estimate for blocks of size 2^( 3) =       0.000531122125
  error estimate for blocks of size 2^( 4) =       0.000542854072
  error estimate for blocks of size 2^( 5) =       0.000550415799
  error estimate for blocks of size 2^( 6) =       0.000553013870
  error estimate for blocks of size 2^( 7) =       0.000553898757

      target function =                  N/A
              le_mean =     -22.669787993256
             les_mean =     514.424858635504
             stat err =       0.000550045624
             autocorr =       1.223764290214
              std dev =       0.703177270173
             le_variance =       0.494458273287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669787993256        initial  <--
     2.3842e+08     2.3842e+09             1.9956e-12       -22.669787993256
     9.5367e+08     9.5367e+09             4.9890e-13       -22.669787993256
     3.8147e+09     3.8147e+10             1.2473e-13       -22.669787993256

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2605
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.54
    reference variance = 1.00641
====================================================
  Execution time = 2.6432e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1455e-01
  Total weights = 1.955402283e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500739211091
                                         uncertainty =       0.004425705063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500739211091
                                         uncertainty =       0.004425705063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500326177
  error estimate for blocks of size 2^( 2) =       0.000518021816
  error estimate for blocks of size 2^( 3) =       0.000533474678
  error estimate for blocks of size 2^( 4) =       0.000545109675
  error estimate for blocks of size 2^( 5) =       0.000550619378
  error estimate for blocks of size 2^( 6) =       0.000553934495
  error estimate for blocks of size 2^( 7) =       0.000555777774

      target function =                  N/A
              le_mean =     -22.670290505104
             les_mean =     514.456617913506
             stat err =       0.000551360330
             autocorr =       1.214407891947
              std dev =       0.707568065025
             le_variance =       0.500652566644


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267029050510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670290505182       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670290505182       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670290505182       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670290505182       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+09 is 2.341491e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670290505182       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670290505182       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670290505182       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670286743506       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+09 is 5.855675e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670290505182       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670290505182       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670290505182       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670280858743       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+10 is 1.463238e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054957 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1222e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6814
    reference variance = 0.401217
====================================================
  Execution time = 2.5707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0916e-01
  Total weights = 1.9553e+06
  Execution time = 3.6424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497411406396
                                         uncertainty =       0.002550048215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497411406396
                                         uncertainty =       0.002550048215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498657259
  error estimate for blocks of size 2^( 2) =       0.000516328006
  error estimate for blocks of size 2^( 3) =       0.000531739031
  error estimate for blocks of size 2^( 4) =       0.000542809304
  error estimate for blocks of size 2^( 5) =       0.000549719426
  error estimate for blocks of size 2^( 6) =       0.000551738072
  error estimate for blocks of size 2^( 7) =       0.000554871037

      target function =                  N/A
              le_mean =     -22.669809134956
             les_mean =     514.429409538520
             stat err =       0.000549784460
             autocorr =       1.215571835775
              std dev =       0.705207858430
             le_variance =       0.497318123592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497411406396
                                         uncertainty =       0.002550048215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497411406396
                                         uncertainty =       0.002550048215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498657259
  error estimate for blocks of size 2^( 2) =       0.000516328006
  error estimate for blocks of size 2^( 3) =       0.000531739031
  error estimate for blocks of size 2^( 4) =       0.000542809304
  error estimate for blocks of size 2^( 5) =       0.000549719426
  error estimate for blocks of size 2^( 6) =       0.000551738072
  error estimate for blocks of size 2^( 7) =       0.000554871037

      target function =                  N/A
              le_mean =     -22.669809134956
             les_mean =     514.429409535853
             stat err =       0.000549784460
             autocorr =       1.215571835776
              std dev =       0.705207858430
             le_variance =       0.497318123592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497411406396
                                         uncertainty =       0.002550048215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497411406396
                                         uncertainty =       0.002550048215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498657259
  error estimate for blocks of size 2^( 2) =       0.000516328006
  error estimate for blocks of size 2^( 3) =       0.000531739031
  error estimate for blocks of size 2^( 4) =       0.000542809304
  error estimate for blocks of size 2^( 5) =       0.000549719426
  error estimate for blocks of size 2^( 6) =       0.000551738072
  error estimate for blocks of size 2^( 7) =       0.000554871037

      target function =                  N/A
              le_mean =     -22.669809134956
             les_mean =     514.429409537048
             stat err =       0.000549784460
             autocorr =       1.215571835776
              std dev =       0.705207858431
             le_variance =       0.497318123592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497411406396
                                         uncertainty =       0.002550048215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497411406396
                                         uncertainty =       0.002550048215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498657259
  error estimate for blocks of size 2^( 2) =       0.000516328006
  error estimate for blocks of size 2^( 3) =       0.000531739031
  error estimate for blocks of size 2^( 4) =       0.000542809304
  error estimate for blocks of size 2^( 5) =       0.000549719426
  error estimate for blocks of size 2^( 6) =       0.000551738072
  error estimate for blocks of size 2^( 7) =       0.000554871037

      target function =                  N/A
              le_mean =     -22.669809134956
             les_mean =     514.429409538509
             stat err =       0.000549784460
             autocorr =       1.215571835785
              std dev =       0.705207858430
             le_variance =       0.497318123592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669809134956        initial  <--
     2.3842e+09     2.3842e+10             2.3415e-13       -22.669809134956
     9.5367e+09     9.5367e+10             5.8557e-14       -22.669809134956
     3.8147e+10     3.8147e+11             1.4632e-14       -22.669809134956

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9700
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5199e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6082
    reference variance = 0.619634
====================================================
  Execution time = 2.6321e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0810e-01
  Total weights = 1.955039020e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496128251319
                                         uncertainty =       0.002786979836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496128251319
                                         uncertainty =       0.002786979836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498059925
  error estimate for blocks of size 2^( 2) =       0.000516319882
  error estimate for blocks of size 2^( 3) =       0.000532071339
  error estimate for blocks of size 2^( 4) =       0.000543453783
  error estimate for blocks of size 2^( 5) =       0.000550800208
  error estimate for blocks of size 2^( 6) =       0.000553884291
  error estimate for blocks of size 2^( 7) =       0.000554604123

      target function =                  N/A
              le_mean =     -22.670066617920
             les_mean =     514.440016569265
             stat err =       0.000550685601
             autocorr =       1.222486987663
              std dev =       0.704363100556
             le_variance =       0.496127377425


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267006661792e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670066618015       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670066618015       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670066618015       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670066618015       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+10 is 1.671770e-14

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670066618015       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670066618015       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670066618015       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670066618015       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670066618015       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670038930905       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670060825852       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670088434957       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669559604020       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669315107311       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.667917783046       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670018006407       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.667737363743       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.671600957228       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.672083425552       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.701377772433       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.651867232457       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.666344234472       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.678707331215       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.681353814537       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.697962289610       residual = 9.59e-03           smallest_sin_value = 9.99e-01
davidson iteration   21:   krylov dim =  22   energy =     -22.656476541255       residual = 1.31e-02           smallest_sin_value = 9.95e-01
davidson iteration   22 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+10 is 4.158736e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670066618015       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670066618015       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670066618015       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670183876931       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669866990468       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669910751262       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669891372049       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669315984211       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669964586599       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.600375320273       residual = 2.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+11 is 1.046343e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1069e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6378
    reference variance = 0.645653
====================================================
  Execution time = 2.5760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0435e-01
  Total weights = 1.9550e+06
  Execution time = 3.6327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489555067276
                                         uncertainty =       0.002274741711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489555067276
                                         uncertainty =       0.002274741711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494734521
  error estimate for blocks of size 2^( 2) =       0.000512509883
  error estimate for blocks of size 2^( 3) =       0.000528326764
  error estimate for blocks of size 2^( 4) =       0.000539990683
  error estimate for blocks of size 2^( 5) =       0.000544300097
  error estimate for blocks of size 2^( 6) =       0.000547610108
  error estimate for blocks of size 2^( 7) =       0.000551954061

      target function =                  N/A
              le_mean =     -22.668850084770
             les_mean =     514.381116159232
             stat err =       0.000545963737
             autocorr =       1.217820178953
              std dev =       0.699660269140
             le_variance =       0.489524492213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489555067276
                                         uncertainty =       0.002274741711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489555067276
                                         uncertainty =       0.002274741711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494734521
  error estimate for blocks of size 2^( 2) =       0.000512509883
  error estimate for blocks of size 2^( 3) =       0.000528326764
  error estimate for blocks of size 2^( 4) =       0.000539990683
  error estimate for blocks of size 2^( 5) =       0.000544300097
  error estimate for blocks of size 2^( 6) =       0.000547610108
  error estimate for blocks of size 2^( 7) =       0.000551954061

      target function =                  N/A
              le_mean =     -22.668850084770
             les_mean =     514.381116159232
             stat err =       0.000545963737
             autocorr =       1.217820178952
              std dev =       0.699660269140
             le_variance =       0.489524492213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489555067276
                                         uncertainty =       0.002274741711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489555067276
                                         uncertainty =       0.002274741711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494734521
  error estimate for blocks of size 2^( 2) =       0.000512509883
  error estimate for blocks of size 2^( 3) =       0.000528326764
  error estimate for blocks of size 2^( 4) =       0.000539990683
  error estimate for blocks of size 2^( 5) =       0.000544300097
  error estimate for blocks of size 2^( 6) =       0.000547610108
  error estimate for blocks of size 2^( 7) =       0.000551954061

      target function =                  N/A
              le_mean =     -22.668850084770
             les_mean =     514.381116159232
             stat err =       0.000545963737
             autocorr =       1.217820178953
              std dev =       0.699660269140
             le_variance =       0.489524492213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489555067276
                                         uncertainty =       0.002274741711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489555067276
                                         uncertainty =       0.002274741711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494734521
  error estimate for blocks of size 2^( 2) =       0.000512509883
  error estimate for blocks of size 2^( 3) =       0.000528326764
  error estimate for blocks of size 2^( 4) =       0.000539990683
  error estimate for blocks of size 2^( 5) =       0.000544300097
  error estimate for blocks of size 2^( 6) =       0.000547610108
  error estimate for blocks of size 2^( 7) =       0.000551954061

      target function =                  N/A
              le_mean =     -22.668850084770
             les_mean =     514.381116159232
             stat err =       0.000545963737
             autocorr =       1.217820178957
              std dev =       0.699660269140
             le_variance =       0.489524492213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668850084770        initial  <--
     2.3842e+10     2.3842e+11             1.6718e-14       -22.668850084770
     9.5367e+10     9.5367e+11             4.1587e-15       -22.668850084770
     3.8147e+11     3.8147e+12             1.0463e-15       -22.668850084770

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0016
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5077e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6936
    reference variance = 0.461949
====================================================
  Execution time = 2.6418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0498e-01
  Total weights = 1.954848293e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495019835502
                                         uncertainty =       0.002094494794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495019835502
                                         uncertainty =       0.002094494794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497510999
  error estimate for blocks of size 2^( 2) =       0.000515345041
  error estimate for blocks of size 2^( 3) =       0.000531450441
  error estimate for blocks of size 2^( 4) =       0.000543143039
  error estimate for blocks of size 2^( 5) =       0.000549895619
  error estimate for blocks of size 2^( 6) =       0.000555292330
  error estimate for blocks of size 2^( 7) =       0.000556877229

      target function =                  N/A
              le_mean =     -22.669588610466
             les_mean =     514.415231696714
             stat err =       0.000551302054
             autocorr =       1.227930675271
              std dev =       0.703586801995
             le_variance =       0.495034387941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266958861047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669588610570       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669588610570       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669588610570       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669406045637       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669588610570       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+11 is 1.931379e-15

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669588610570       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669588610570       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669588610570       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669588610570       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669588610570       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670366630176       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670284506464       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669513176148       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669656113677       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.665418789583       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670436423402       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669238601698       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.666964867249       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.668696942685       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.734817250074       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.664341559176       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.692164190661       residual = 1.64e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -21.311676290452       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -23.164076240286       residual = 1.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -23.315060497349       residual = 6.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.055423595863       residual = 3.35e+03           smallest_sin_value = 1.00e+00
davidson iteration   21 stopping due to too large eigenvalue change
davidson solver did not converge after         21 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+11 is 4.872675e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669588610570       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669588610570       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669588610570       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669588610570       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669588610570       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.671012838034       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.650930293085       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.676086107893       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.672189483630       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.672296937557       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.665328617508       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.656045963042       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.457237657354       residual = 6.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   13 stopping due to too large eigenvalue change
davidson solver did not converge after         13 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+12 is 1.218169e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072811 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1248e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7061
    reference variance = 0.413291
====================================================
  Execution time = 2.5678e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1556e-01
  Total weights = 1.9554e+06
  Execution time = 3.6391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498670513572
                                         uncertainty =       0.003282453086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498670513572
                                         uncertainty =       0.003282453086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499314207
  error estimate for blocks of size 2^( 2) =       0.000516860758
  error estimate for blocks of size 2^( 3) =       0.000533285101
  error estimate for blocks of size 2^( 4) =       0.000544850614
  error estimate for blocks of size 2^( 5) =       0.000550837764
  error estimate for blocks of size 2^( 6) =       0.000554403182
  error estimate for blocks of size 2^( 7) =       0.000556540981

      target function =                  N/A
              le_mean =     -22.669329336941
             les_mean =     514.414057493439
             stat err =       0.000551658135
             autocorr =       1.220652956158
              std dev =       0.706136923829
             le_variance =       0.498629355194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498670513572
                                         uncertainty =       0.003282453086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498670513572
                                         uncertainty =       0.003282453086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499314207
  error estimate for blocks of size 2^( 2) =       0.000516860758
  error estimate for blocks of size 2^( 3) =       0.000533285101
  error estimate for blocks of size 2^( 4) =       0.000544850614
  error estimate for blocks of size 2^( 5) =       0.000550837764
  error estimate for blocks of size 2^( 6) =       0.000554403182
  error estimate for blocks of size 2^( 7) =       0.000556540981

      target function =                  N/A
              le_mean =     -22.669329336941
             les_mean =     514.414057493439
             stat err =       0.000551658135
             autocorr =       1.220652956154
              std dev =       0.706136923829
             le_variance =       0.498629355194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498670513572
                                         uncertainty =       0.003282453086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498670513572
                                         uncertainty =       0.003282453086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499314207
  error estimate for blocks of size 2^( 2) =       0.000516860758
  error estimate for blocks of size 2^( 3) =       0.000533285101
  error estimate for blocks of size 2^( 4) =       0.000544850614
  error estimate for blocks of size 2^( 5) =       0.000550837764
  error estimate for blocks of size 2^( 6) =       0.000554403182
  error estimate for blocks of size 2^( 7) =       0.000556540981

      target function =                  N/A
              le_mean =     -22.669329336941
             les_mean =     514.414057493439
             stat err =       0.000551658135
             autocorr =       1.220652956158
              std dev =       0.706136923829
             le_variance =       0.498629355194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498670513572
                                         uncertainty =       0.003282453086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498670513572
                                         uncertainty =       0.003282453086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499314207
  error estimate for blocks of size 2^( 2) =       0.000516860758
  error estimate for blocks of size 2^( 3) =       0.000533285101
  error estimate for blocks of size 2^( 4) =       0.000544850614
  error estimate for blocks of size 2^( 5) =       0.000550837764
  error estimate for blocks of size 2^( 6) =       0.000554403182
  error estimate for blocks of size 2^( 7) =       0.000556540981

      target function =                  N/A
              le_mean =     -22.669329336941
             les_mean =     514.414057493439
             stat err =       0.000551658135
             autocorr =       1.220652956154
              std dev =       0.706136923829
             le_variance =       0.498629355194


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669329336941        initial  <--
     2.3842e+11     2.3842e+12             1.9314e-15       -22.669329336941
     9.5367e+11     9.5367e+12             4.8727e-16       -22.669329336941
     3.8147e+12     3.8147e+13             1.2182e-16       -22.669329336941

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9234
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6486
    reference variance = 0.388939
====================================================
  Execution time = 2.8351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1026e-01
  Total weights = 1.955409565e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496371601754
                                         uncertainty =       0.003225851277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496371601754
                                         uncertainty =       0.003225851277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498183187
  error estimate for blocks of size 2^( 2) =       0.000515904803
  error estimate for blocks of size 2^( 3) =       0.000531670358
  error estimate for blocks of size 2^( 4) =       0.000543366098
  error estimate for blocks of size 2^( 5) =       0.000550219529
  error estimate for blocks of size 2^( 6) =       0.000552888457
  error estimate for blocks of size 2^( 7) =       0.000554531892

      target function =                  N/A
              le_mean =     -22.668736361256
             les_mean =     514.381863296224
             stat err =       0.000550251494
             autocorr =       1.219956448366
              std dev =       0.704537419973
             le_variance =       0.496372976142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266873636126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668736361358       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668736361358       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668736361358       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669764588415       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668736361358       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668736361358       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+12 is 1.635194e-16

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668736361358       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668736361358       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668736361358       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668736361358       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074310 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3095e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.767
    reference variance = 0.587058
====================================================
  Execution time = 2.5933e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0912e-01
  Total weights = 1.9550e+06
  Execution time = 3.6495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496342535163
                                         uncertainty =       0.002806693413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496342535163
                                         uncertainty =       0.002806693413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498193500
  error estimate for blocks of size 2^( 2) =       0.000515654902
  error estimate for blocks of size 2^( 3) =       0.000531336024
  error estimate for blocks of size 2^( 4) =       0.000542130415
  error estimate for blocks of size 2^( 5) =       0.000548741786
  error estimate for blocks of size 2^( 6) =       0.000551651627
  error estimate for blocks of size 2^( 7) =       0.000551346847

      target function =                  N/A
              le_mean =     -22.669811878459
             les_mean =     514.429490413278
             stat err =       0.000548467669
             autocorr =       1.212009293632
              std dev =       0.704552004061
             le_variance =       0.496393526427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496342535163
                                         uncertainty =       0.002806693413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496342535163
                                         uncertainty =       0.002806693413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498193500
  error estimate for blocks of size 2^( 2) =       0.000515654902
  error estimate for blocks of size 2^( 3) =       0.000531336024
  error estimate for blocks of size 2^( 4) =       0.000542130415
  error estimate for blocks of size 2^( 5) =       0.000548741786
  error estimate for blocks of size 2^( 6) =       0.000551651627
  error estimate for blocks of size 2^( 7) =       0.000551346847

      target function =                  N/A
              le_mean =     -22.669811878459
             les_mean =     514.429490413278
             stat err =       0.000548467669
             autocorr =       1.212009293633
              std dev =       0.704552004061
             le_variance =       0.496393526427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496342535163
                                         uncertainty =       0.002806693413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496342535163
                                         uncertainty =       0.002806693413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498193500
  error estimate for blocks of size 2^( 2) =       0.000515654902
  error estimate for blocks of size 2^( 3) =       0.000531336024
  error estimate for blocks of size 2^( 4) =       0.000542130415
  error estimate for blocks of size 2^( 5) =       0.000548741786
  error estimate for blocks of size 2^( 6) =       0.000551651627
  error estimate for blocks of size 2^( 7) =       0.000551346847

      target function =                  N/A
              le_mean =     -22.669811878459
             les_mean =     514.429490413278
             stat err =       0.000548467669
             autocorr =       1.212009293632
              std dev =       0.704552004061
             le_variance =       0.496393526427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496342535163
                                         uncertainty =       0.002806693413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496342535163
                                         uncertainty =       0.002806693413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498193500
  error estimate for blocks of size 2^( 2) =       0.000515654902
  error estimate for blocks of size 2^( 3) =       0.000531336024
  error estimate for blocks of size 2^( 4) =       0.000542130415
  error estimate for blocks of size 2^( 5) =       0.000548741786
  error estimate for blocks of size 2^( 6) =       0.000551651627
  error estimate for blocks of size 2^( 7) =       0.000551346847

      target function =                  N/A
              le_mean =     -22.669811878459
             les_mean =     514.429490413278
             stat err =       0.000548467669
             autocorr =       1.212009293632
              std dev =       0.704552004061
             le_variance =       0.496393526427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669811878459        initial  <--
     2.3842e+12     2.3842e+13             1.6352e-16       -22.669811878459
     9.5367e+12     9.5367e+13             0.0000e+00       -22.669811878459
     3.8147e+13     3.8147e+14             0.0000e+00       -22.669811878459

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2230
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7324e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.6587
    reference variance = 0.374686
====================================================
  Execution time = 2.6366e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0787e-01
  Total weights = 1.954949864e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492097252999
                                         uncertainty =       0.003460998453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492097252999
                                         uncertainty =       0.003460998453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496000251
  error estimate for blocks of size 2^( 2) =       0.000514135739
  error estimate for blocks of size 2^( 3) =       0.000530437980
  error estimate for blocks of size 2^( 4) =       0.000541594053
  error estimate for blocks of size 2^( 5) =       0.000545878729
  error estimate for blocks of size 2^( 6) =       0.000548855346
  error estimate for blocks of size 2^( 7) =       0.000548786413

      target function =                  N/A
              le_mean =     -22.668705972641
             les_mean =     514.378101987461
             stat err =       0.000546278635
             autocorr =       1.213010719276
              std dev =       0.701450281847
             le_variance =       0.492032497904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266870597264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668705972718       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668705972718       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668705972718       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668705972718       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+13 is 2.287692e-17

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668705972718       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668705972718       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668705972718       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+13 is 5.503241e-18

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668705972718       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668705972718       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668705972718       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668705972718       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.602696082317       residual = 4.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.686312874028       residual = 4.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.895417551652       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.554499322497       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.452016230585       residual = 9.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.139957450016       residual = 1.88e+04           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+14 is 1.443022e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076632 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1114e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.6222
    reference variance = 0.419991
====================================================
  Execution time = 2.5631e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.1679e-01
  Total weights = 1.9548e+06
  Execution time = 3.6606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499352961802
                                         uncertainty =       0.004143162055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499352961802
                                         uncertainty =       0.004143162055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499662361
  error estimate for blocks of size 2^( 2) =       0.000517594433
  error estimate for blocks of size 2^( 3) =       0.000533527464
  error estimate for blocks of size 2^( 4) =       0.000544282856
  error estimate for blocks of size 2^( 5) =       0.000551914074
  error estimate for blocks of size 2^( 6) =       0.000556025360
  error estimate for blocks of size 2^( 7) =       0.000556845126

      target function =                  N/A
              le_mean =     -22.671084009450
             les_mean =     514.494836617396
             stat err =       0.000552266854
             autocorr =       1.221644052028
              std dev =       0.706629287873
             le_variance =       0.499324950480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499352961802
                                         uncertainty =       0.004143162055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499352961802
                                         uncertainty =       0.004143162055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499662361
  error estimate for blocks of size 2^( 2) =       0.000517594433
  error estimate for blocks of size 2^( 3) =       0.000533527464
  error estimate for blocks of size 2^( 4) =       0.000544282856
  error estimate for blocks of size 2^( 5) =       0.000551914074
  error estimate for blocks of size 2^( 6) =       0.000556025360
  error estimate for blocks of size 2^( 7) =       0.000556845126

      target function =                  N/A
              le_mean =     -22.671084009450
             les_mean =     514.494836617396
             stat err =       0.000552266854
             autocorr =       1.221644052028
              std dev =       0.706629287873
             le_variance =       0.499324950480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499352961802
                                         uncertainty =       0.004143162055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499352961802
                                         uncertainty =       0.004143162055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499662361
  error estimate for blocks of size 2^( 2) =       0.000517594433
  error estimate for blocks of size 2^( 3) =       0.000533527464
  error estimate for blocks of size 2^( 4) =       0.000544282856
  error estimate for blocks of size 2^( 5) =       0.000551914074
  error estimate for blocks of size 2^( 6) =       0.000556025360
  error estimate for blocks of size 2^( 7) =       0.000556845126

      target function =                  N/A
              le_mean =     -22.671084009450
             les_mean =     514.494836617396
             stat err =       0.000552266854
             autocorr =       1.221644052029
              std dev =       0.706629287873
             le_variance =       0.499324950480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499352961802
                                         uncertainty =       0.004143162055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499352961802
                                         uncertainty =       0.004143162055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499662361
  error estimate for blocks of size 2^( 2) =       0.000517594433
  error estimate for blocks of size 2^( 3) =       0.000533527464
  error estimate for blocks of size 2^( 4) =       0.000544282856
  error estimate for blocks of size 2^( 5) =       0.000551914074
  error estimate for blocks of size 2^( 6) =       0.000556025360
  error estimate for blocks of size 2^( 7) =       0.000556845126

      target function =                  N/A
              le_mean =     -22.671084009450
             les_mean =     514.494836617396
             stat err =       0.000552266854
             autocorr =       1.221644052026
              std dev =       0.706629287873
             le_variance =       0.499324950480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.671084009450        initial  <--
     2.3842e+13     2.3842e+14             2.2877e-17       -22.671084009450
     9.5367e+13     9.5367e+14             5.5032e-18       -22.671084009450
     3.8147e+14     3.8147e+15             1.4430e-18       -22.671084009450

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9540
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6171
    reference variance = 0.407895
====================================================
  Execution time = 2.6284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1043e-01
  Total weights = 1.955154777e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494773041732
                                         uncertainty =       0.003071499582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494773041732
                                         uncertainty =       0.003071499582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497355180
  error estimate for blocks of size 2^( 2) =       0.000515300501
  error estimate for blocks of size 2^( 3) =       0.000531811123
  error estimate for blocks of size 2^( 4) =       0.000542897428
  error estimate for blocks of size 2^( 5) =       0.000550313797
  error estimate for blocks of size 2^( 6) =       0.000553628286
  error estimate for blocks of size 2^( 7) =       0.000556384488

      target function =                  N/A
              le_mean =     -22.669932291084
             les_mean =     514.436264817818
             stat err =       0.000550806000
             autocorr =       1.226490062430
              std dev =       0.703366440853
             le_variance =       0.494724350118


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266993229108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669932291176       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669932291176       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669932291176       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669932291176       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669932291176       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669932291176       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077666 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1029e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7241
    reference variance = 1.07139
====================================================
  Execution time = 2.5788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0286e-01
  Total weights = 1.9551e+06
  Execution time = 3.6523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493144597091
                                         uncertainty =       0.002375026102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493144597091
                                         uncertainty =       0.002375026102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496571231
  error estimate for blocks of size 2^( 2) =       0.000514382191
  error estimate for blocks of size 2^( 3) =       0.000530284437
  error estimate for blocks of size 2^( 4) =       0.000541617125
  error estimate for blocks of size 2^( 5) =       0.000548470271
  error estimate for blocks of size 2^( 6) =       0.000551672930
  error estimate for blocks of size 2^( 7) =       0.000554884216

      target function =                  N/A
              le_mean =     -22.669816861976
             les_mean =     514.423454875405
             stat err =       0.000549161136
             autocorr =       1.223028220393
              std dev =       0.702257770154
             le_variance =       0.493165975741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493144597091
                                         uncertainty =       0.002375026102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493144597091
                                         uncertainty =       0.002375026102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496571231
  error estimate for blocks of size 2^( 2) =       0.000514382191
  error estimate for blocks of size 2^( 3) =       0.000530284437
  error estimate for blocks of size 2^( 4) =       0.000541617125
  error estimate for blocks of size 2^( 5) =       0.000548470271
  error estimate for blocks of size 2^( 6) =       0.000551672930
  error estimate for blocks of size 2^( 7) =       0.000554884216

      target function =                  N/A
              le_mean =     -22.669816861976
             les_mean =     514.423454875405
             stat err =       0.000549161136
             autocorr =       1.223028220393
              std dev =       0.702257770154
             le_variance =       0.493165975741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493144597091
                                         uncertainty =       0.002375026102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493144597091
                                         uncertainty =       0.002375026102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496571231
  error estimate for blocks of size 2^( 2) =       0.000514382191
  error estimate for blocks of size 2^( 3) =       0.000530284437
  error estimate for blocks of size 2^( 4) =       0.000541617125
  error estimate for blocks of size 2^( 5) =       0.000548470271
  error estimate for blocks of size 2^( 6) =       0.000551672930
  error estimate for blocks of size 2^( 7) =       0.000554884216

      target function =                  N/A
              le_mean =     -22.669816861976
             les_mean =     514.423454875405
             stat err =       0.000549161136
             autocorr =       1.223028220393
              std dev =       0.702257770154
             le_variance =       0.493165975741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493144597091
                                         uncertainty =       0.002375026102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493144597091
                                         uncertainty =       0.002375026102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496571231
  error estimate for blocks of size 2^( 2) =       0.000514382191
  error estimate for blocks of size 2^( 3) =       0.000530284437
  error estimate for blocks of size 2^( 4) =       0.000541617125
  error estimate for blocks of size 2^( 5) =       0.000548470271
  error estimate for blocks of size 2^( 6) =       0.000551672930
  error estimate for blocks of size 2^( 7) =       0.000554884216

      target function =                  N/A
              le_mean =     -22.669816861976
             les_mean =     514.423454875405
             stat err =       0.000549161136
             autocorr =       1.223028220393
              std dev =       0.702257770154
             le_variance =       0.493165975741


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669816861976        initial  <--
     2.3842e+14     2.3842e+15             0.0000e+00       -22.669816861976
     9.5367e+14     9.5367e+15             0.0000e+00       -22.669816861976
     3.8147e+15     3.8147e+16             0.0000e+00       -22.669816861976

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0669
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5103e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7408
    reference variance = 0.400875
====================================================
  Execution time = 2.6420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1425e-01
  Total weights = 1.955011965e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500618510242
                                         uncertainty =       0.002390279637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500618510242
                                         uncertainty =       0.002390279637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500315776
  error estimate for blocks of size 2^( 2) =       0.000518460647
  error estimate for blocks of size 2^( 3) =       0.000534330759
  error estimate for blocks of size 2^( 4) =       0.000545722473
  error estimate for blocks of size 2^( 5) =       0.000551929318
  error estimate for blocks of size 2^( 6) =       0.000554810436
  error estimate for blocks of size 2^( 7) =       0.000555692892

      target function =                  N/A
              le_mean =     -22.668485348792
             les_mean =     514.374480450135
             stat err =       0.000552038780
             autocorr =       1.217449008199
              std dev =       0.707553355957
             le_variance =       0.500631751526


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266848534879e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668485348876       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668485348876       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668485348876       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668485348876       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668485348876       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668485348876       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1184e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.6818
    reference variance = 0.616533
====================================================
  Execution time = 2.5779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0916e-01
  Total weights = 1.9551e+06
  Execution time = 3.6349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495187982174
                                         uncertainty =       0.003704139251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495187982174
                                         uncertainty =       0.003704139251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497618479
  error estimate for blocks of size 2^( 2) =       0.000515707984
  error estimate for blocks of size 2^( 3) =       0.000531676635
  error estimate for blocks of size 2^( 4) =       0.000542894957
  error estimate for blocks of size 2^( 5) =       0.000549660214
  error estimate for blocks of size 2^( 6) =       0.000554369932
  error estimate for blocks of size 2^( 7) =       0.000552298048

      target function =                  N/A
              le_mean =     -22.669085660504
             les_mean =     514.396608455076
             stat err =       0.000549805788
             autocorr =       1.220746856965
              std dev =       0.703738802550
             le_variance =       0.495248302214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495187982174
                                         uncertainty =       0.003704139251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495187982174
                                         uncertainty =       0.003704139251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497618479
  error estimate for blocks of size 2^( 2) =       0.000515707984
  error estimate for blocks of size 2^( 3) =       0.000531676635
  error estimate for blocks of size 2^( 4) =       0.000542894957
  error estimate for blocks of size 2^( 5) =       0.000549660214
  error estimate for blocks of size 2^( 6) =       0.000554369932
  error estimate for blocks of size 2^( 7) =       0.000552298048

      target function =                  N/A
              le_mean =     -22.669085660504
             les_mean =     514.396608455076
             stat err =       0.000549805788
             autocorr =       1.220746856965
              std dev =       0.703738802550
             le_variance =       0.495248302214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495187982174
                                         uncertainty =       0.003704139251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495187982174
                                         uncertainty =       0.003704139251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497618479
  error estimate for blocks of size 2^( 2) =       0.000515707984
  error estimate for blocks of size 2^( 3) =       0.000531676635
  error estimate for blocks of size 2^( 4) =       0.000542894957
  error estimate for blocks of size 2^( 5) =       0.000549660214
  error estimate for blocks of size 2^( 6) =       0.000554369932
  error estimate for blocks of size 2^( 7) =       0.000552298048

      target function =                  N/A
              le_mean =     -22.669085660504
             les_mean =     514.396608455076
             stat err =       0.000549805788
             autocorr =       1.220746856965
              std dev =       0.703738802550
             le_variance =       0.495248302214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495187982174
                                         uncertainty =       0.003704139251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495187982174
                                         uncertainty =       0.003704139251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497618479
  error estimate for blocks of size 2^( 2) =       0.000515707984
  error estimate for blocks of size 2^( 3) =       0.000531676635
  error estimate for blocks of size 2^( 4) =       0.000542894957
  error estimate for blocks of size 2^( 5) =       0.000549660214
  error estimate for blocks of size 2^( 6) =       0.000554369932
  error estimate for blocks of size 2^( 7) =       0.000552298048

      target function =                  N/A
              le_mean =     -22.669085660504
             les_mean =     514.396608455076
             stat err =       0.000549805788
             autocorr =       1.220746856965
              std dev =       0.703738802550
             le_variance =       0.495248302214


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669085660504        initial  <--
     2.3842e+15     2.3842e+16             0.0000e+00       -22.669085660504
     9.5367e+15     9.5367e+16             0.0000e+00       -22.669085660504
     3.8147e+16     3.8147e+17             0.0000e+00       -22.669085660504

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0131
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6996
    reference variance = 0.474075
====================================================
  Execution time = 2.8058e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1009e-01
  Total weights = 1.955059962e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496406095650
                                         uncertainty =       0.003176690531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496406095650
                                         uncertainty =       0.003176690531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498219214
  error estimate for blocks of size 2^( 2) =       0.000515992463
  error estimate for blocks of size 2^( 3) =       0.000532181879
  error estimate for blocks of size 2^( 4) =       0.000543881709
  error estimate for blocks of size 2^( 5) =       0.000550568664
  error estimate for blocks of size 2^( 6) =       0.000554060950
  error estimate for blocks of size 2^( 7) =       0.000556603439

      target function =                  N/A
              le_mean =     -22.669475389793
             les_mean =     514.415205720203
             stat err =       0.000551278691
             autocorr =       1.224338386231
              std dev =       0.704588369585
             le_variance =       0.496444770555


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266947538979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669475389887       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669475389887       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669475389887       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669475389887       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669475389887       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669475389887       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082507 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2858e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.5493
    reference variance = 0.371708
====================================================
  Execution time = 2.5718e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0593e-01
  Total weights = 1.9553e+06
  Execution time = 3.6476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492676478683
                                         uncertainty =       0.002205779050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492676478683
                                         uncertainty =       0.002205779050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496315198
  error estimate for blocks of size 2^( 2) =       0.000514441352
  error estimate for blocks of size 2^( 3) =       0.000530646952
  error estimate for blocks of size 2^( 4) =       0.000542653517
  error estimate for blocks of size 2^( 5) =       0.000549570500
  error estimate for blocks of size 2^( 6) =       0.000553196357
  error estimate for blocks of size 2^( 7) =       0.000557628366

      target function =                  N/A
              le_mean =     -22.669665109954
             les_mean =     514.419649740731
             stat err =       0.000550762185
             autocorr =       1.231439498674
              std dev =       0.701895684851
             le_variance =       0.492657552412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492676478683
                                         uncertainty =       0.002205779050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492676478683
                                         uncertainty =       0.002205779050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496315198
  error estimate for blocks of size 2^( 2) =       0.000514441352
  error estimate for blocks of size 2^( 3) =       0.000530646952
  error estimate for blocks of size 2^( 4) =       0.000542653517
  error estimate for blocks of size 2^( 5) =       0.000549570500
  error estimate for blocks of size 2^( 6) =       0.000553196357
  error estimate for blocks of size 2^( 7) =       0.000557628366

      target function =                  N/A
              le_mean =     -22.669665109954
             les_mean =     514.419649740731
             stat err =       0.000550762185
             autocorr =       1.231439498674
              std dev =       0.701895684851
             le_variance =       0.492657552412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492676478683
                                         uncertainty =       0.002205779050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492676478683
                                         uncertainty =       0.002205779050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496315198
  error estimate for blocks of size 2^( 2) =       0.000514441352
  error estimate for blocks of size 2^( 3) =       0.000530646952
  error estimate for blocks of size 2^( 4) =       0.000542653517
  error estimate for blocks of size 2^( 5) =       0.000549570500
  error estimate for blocks of size 2^( 6) =       0.000553196357
  error estimate for blocks of size 2^( 7) =       0.000557628366

      target function =                  N/A
              le_mean =     -22.669665109954
             les_mean =     514.419649740731
             stat err =       0.000550762185
             autocorr =       1.231439498674
              std dev =       0.701895684851
             le_variance =       0.492657552412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492676478683
                                         uncertainty =       0.002205779050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492676478683
                                         uncertainty =       0.002205779050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496315198
  error estimate for blocks of size 2^( 2) =       0.000514441352
  error estimate for blocks of size 2^( 3) =       0.000530646952
  error estimate for blocks of size 2^( 4) =       0.000542653517
  error estimate for blocks of size 2^( 5) =       0.000549570500
  error estimate for blocks of size 2^( 6) =       0.000553196357
  error estimate for blocks of size 2^( 7) =       0.000557628366

      target function =                  N/A
              le_mean =     -22.669665109954
             les_mean =     514.419649740731
             stat err =       0.000550762185
             autocorr =       1.231439498674
              std dev =       0.701895684851
             le_variance =       0.492657552412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669665109954        initial  <--
     2.3842e+16     2.3842e+17             0.0000e+00       -22.669665109954
     9.5367e+16     9.5367e+17             0.0000e+00       -22.669665109954
     3.8147e+17     3.8147e+18             0.0000e+00       -22.669665109954

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0107
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6884e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7096
    reference variance = 0.294736
====================================================
  Execution time = 2.6490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0697e-01
  Total weights = 1.955379879e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495851212059
                                         uncertainty =       0.002730696102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495851212059
                                         uncertainty =       0.002730696102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497890234
  error estimate for blocks of size 2^( 2) =       0.000515480591
  error estimate for blocks of size 2^( 3) =       0.000531100132
  error estimate for blocks of size 2^( 4) =       0.000542254162
  error estimate for blocks of size 2^( 5) =       0.000548938762
  error estimate for blocks of size 2^( 6) =       0.000553017441
  error estimate for blocks of size 2^( 7) =       0.000553829491

      target function =                  N/A
              le_mean =     -22.669549944797
             les_mean =     514.415461776360
             stat err =       0.000549509964
             autocorr =       1.218102759379
              std dev =       0.704123122185
             le_variance =       0.495789371195


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266954994480e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669549944880       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669549944880       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669549944880       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669549944880       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669549944880       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669549944880       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1248e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.6945
    reference variance = 0.355977
====================================================
  Execution time = 2.5743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0582e-01
  Total weights = 1.9555e+06
  Execution time = 3.6417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495420129257
                                         uncertainty =       0.002521193399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495420129257
                                         uncertainty =       0.002521193399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497727698
  error estimate for blocks of size 2^( 2) =       0.000515572929
  error estimate for blocks of size 2^( 3) =       0.000531245859
  error estimate for blocks of size 2^( 4) =       0.000542781940
  error estimate for blocks of size 2^( 5) =       0.000550437825
  error estimate for blocks of size 2^( 6) =       0.000553151644
  error estimate for blocks of size 2^( 7) =       0.000555993472

      target function =                  N/A
              le_mean =     -22.670023386316
             les_mean =     514.435778594996
             stat err =       0.000550591220
             autocorr =       1.223699958512
              std dev =       0.703893260475
             le_variance =       0.495465722142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495420129257
                                         uncertainty =       0.002521193399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495420129257
                                         uncertainty =       0.002521193399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497727698
  error estimate for blocks of size 2^( 2) =       0.000515572929
  error estimate for blocks of size 2^( 3) =       0.000531245859
  error estimate for blocks of size 2^( 4) =       0.000542781940
  error estimate for blocks of size 2^( 5) =       0.000550437825
  error estimate for blocks of size 2^( 6) =       0.000553151644
  error estimate for blocks of size 2^( 7) =       0.000555993472

      target function =                  N/A
              le_mean =     -22.670023386316
             les_mean =     514.435778594996
             stat err =       0.000550591220
             autocorr =       1.223699958512
              std dev =       0.703893260475
             le_variance =       0.495465722142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495420129257
                                         uncertainty =       0.002521193399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495420129257
                                         uncertainty =       0.002521193399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497727698
  error estimate for blocks of size 2^( 2) =       0.000515572929
  error estimate for blocks of size 2^( 3) =       0.000531245859
  error estimate for blocks of size 2^( 4) =       0.000542781940
  error estimate for blocks of size 2^( 5) =       0.000550437825
  error estimate for blocks of size 2^( 6) =       0.000553151644
  error estimate for blocks of size 2^( 7) =       0.000555993472

      target function =                  N/A
              le_mean =     -22.670023386316
             les_mean =     514.435778594996
             stat err =       0.000550591220
             autocorr =       1.223699958512
              std dev =       0.703893260475
             le_variance =       0.495465722142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495420129257
                                         uncertainty =       0.002521193399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495420129257
                                         uncertainty =       0.002521193399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497727698
  error estimate for blocks of size 2^( 2) =       0.000515572929
  error estimate for blocks of size 2^( 3) =       0.000531245859
  error estimate for blocks of size 2^( 4) =       0.000542781940
  error estimate for blocks of size 2^( 5) =       0.000550437825
  error estimate for blocks of size 2^( 6) =       0.000553151644
  error estimate for blocks of size 2^( 7) =       0.000555993472

      target function =                  N/A
              le_mean =     -22.670023386316
             les_mean =     514.435778594996
             stat err =       0.000550591220
             autocorr =       1.223699958512
              std dev =       0.703893260475
             le_variance =       0.495465722142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670023386316        initial  <--
     2.3842e+17     2.3842e+18             0.0000e+00       -22.670023386316
     9.5367e+17     9.5367e+18             0.0000e+00       -22.670023386316
     3.8147e+18     3.8147e+19             0.0000e+00       -22.670023386316

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0431
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6613
    reference variance = 0.242862
====================================================
  Execution time = 2.6499e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0335e-01
  Total weights = 1.955130576e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492981778437
                                         uncertainty =       0.002191597801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492981778437
                                         uncertainty =       0.002191597801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496457219
  error estimate for blocks of size 2^( 2) =       0.000514904594
  error estimate for blocks of size 2^( 3) =       0.000530946016
  error estimate for blocks of size 2^( 4) =       0.000542974865
  error estimate for blocks of size 2^( 5) =       0.000550314931
  error estimate for blocks of size 2^( 6) =       0.000554725761
  error estimate for blocks of size 2^( 7) =       0.000559046033

      target function =                  N/A
              le_mean =     -22.669623243747
             les_mean =     514.415166662266
             stat err =       0.000551765397
             autocorr =       1.235222696369
              std dev =       0.702096531681
             le_variance =       0.492939539799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266962324375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669623243841       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669623243841       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669623243841       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669623243841       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669623243841       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669623243841       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1278e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6108
    reference variance = 0.538363
====================================================
  Execution time = 2.5680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0397e-01
  Total weights = 1.9554e+06
  Execution time = 3.6436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491375188897
                                         uncertainty =       0.002361803630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491375188897
                                         uncertainty =       0.002361803630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495645342
  error estimate for blocks of size 2^( 2) =       0.000513594064
  error estimate for blocks of size 2^( 3) =       0.000530567000
  error estimate for blocks of size 2^( 4) =       0.000542215462
  error estimate for blocks of size 2^( 5) =       0.000548677470
  error estimate for blocks of size 2^( 6) =       0.000552165271
  error estimate for blocks of size 2^( 7) =       0.000552741645

      target function =                  N/A
              le_mean =     -22.669879314425
             les_mean =     514.427398896649
             stat err =       0.000548949962
             autocorr =       1.226657901981
              std dev =       0.700948364862
             le_variance =       0.491328610203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491375188897
                                         uncertainty =       0.002361803630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491375188897
                                         uncertainty =       0.002361803630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495645342
  error estimate for blocks of size 2^( 2) =       0.000513594064
  error estimate for blocks of size 2^( 3) =       0.000530567000
  error estimate for blocks of size 2^( 4) =       0.000542215462
  error estimate for blocks of size 2^( 5) =       0.000548677470
  error estimate for blocks of size 2^( 6) =       0.000552165271
  error estimate for blocks of size 2^( 7) =       0.000552741645

      target function =                  N/A
              le_mean =     -22.669879314425
             les_mean =     514.427398896649
             stat err =       0.000548949962
             autocorr =       1.226657901981
              std dev =       0.700948364862
             le_variance =       0.491328610203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491375188897
                                         uncertainty =       0.002361803630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491375188897
                                         uncertainty =       0.002361803630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495645342
  error estimate for blocks of size 2^( 2) =       0.000513594064
  error estimate for blocks of size 2^( 3) =       0.000530567000
  error estimate for blocks of size 2^( 4) =       0.000542215462
  error estimate for blocks of size 2^( 5) =       0.000548677470
  error estimate for blocks of size 2^( 6) =       0.000552165271
  error estimate for blocks of size 2^( 7) =       0.000552741645

      target function =                  N/A
              le_mean =     -22.669879314425
             les_mean =     514.427398896649
             stat err =       0.000548949962
             autocorr =       1.226657901981
              std dev =       0.700948364862
             le_variance =       0.491328610203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491375188897
                                         uncertainty =       0.002361803630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491375188897
                                         uncertainty =       0.002361803630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495645342
  error estimate for blocks of size 2^( 2) =       0.000513594064
  error estimate for blocks of size 2^( 3) =       0.000530567000
  error estimate for blocks of size 2^( 4) =       0.000542215462
  error estimate for blocks of size 2^( 5) =       0.000548677470
  error estimate for blocks of size 2^( 6) =       0.000552165271
  error estimate for blocks of size 2^( 7) =       0.000552741645

      target function =                  N/A
              le_mean =     -22.669879314425
             les_mean =     514.427398896649
             stat err =       0.000548949962
             autocorr =       1.226657901981
              std dev =       0.700948364862
             le_variance =       0.491328610203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669879314425        initial  <--
     2.3842e+18     2.3842e+19             0.0000e+00       -22.669879314425
     9.5367e+18     9.5367e+19             0.0000e+00       -22.669879314425
     3.8147e+19     3.8147e+20             0.0000e+00       -22.669879314425

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9554
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7679
    reference variance = 0.663359
====================================================
  Execution time = 2.6241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0793e-01
  Total weights = 1.954779074e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495073884443
                                         uncertainty =       0.002538087377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495073884443
                                         uncertainty =       0.002538087377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497477016
  error estimate for blocks of size 2^( 2) =       0.000515581482
  error estimate for blocks of size 2^( 3) =       0.000532318616
  error estimate for blocks of size 2^( 4) =       0.000542257887
  error estimate for blocks of size 2^( 5) =       0.000547762032
  error estimate for blocks of size 2^( 6) =       0.000549804545
  error estimate for blocks of size 2^( 7) =       0.000554296331

      target function =                  N/A
              le_mean =     -22.669080990728
             les_mean =     514.395167495243
             stat err =       0.000548530199
             autocorr =       1.215780134856
              std dev =       0.703538742918
             le_variance =       0.494966762787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266908099073e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669080990811       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669080990811       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669080990811       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669080990811       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669080990811       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669080990811       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0970e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6722
    reference variance = 0.293624
====================================================
  Execution time = 2.5890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0636e-01
  Total weights = 1.9553e+06
  Execution time = 3.6466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493895280129
                                         uncertainty =       0.002665384910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493895280129
                                         uncertainty =       0.002665384910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496910559
  error estimate for blocks of size 2^( 2) =       0.000514857747
  error estimate for blocks of size 2^( 3) =       0.000531879197
  error estimate for blocks of size 2^( 4) =       0.000543145354
  error estimate for blocks of size 2^( 5) =       0.000550632441
  error estimate for blocks of size 2^( 6) =       0.000552544695
  error estimate for blocks of size 2^( 7) =       0.000553956128

      target function =                  N/A
              le_mean =     -22.670256203494
             les_mean =     514.446879030407
             stat err =       0.000550069655
             autocorr =       1.225402956813
              std dev =       0.702737651647
             le_variance =       0.493840207043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493895280129
                                         uncertainty =       0.002665384910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493895280129
                                         uncertainty =       0.002665384910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496910559
  error estimate for blocks of size 2^( 2) =       0.000514857747
  error estimate for blocks of size 2^( 3) =       0.000531879197
  error estimate for blocks of size 2^( 4) =       0.000543145354
  error estimate for blocks of size 2^( 5) =       0.000550632441
  error estimate for blocks of size 2^( 6) =       0.000552544695
  error estimate for blocks of size 2^( 7) =       0.000553956128

      target function =                  N/A
              le_mean =     -22.670256203494
             les_mean =     514.446879030407
             stat err =       0.000550069655
             autocorr =       1.225402956813
              std dev =       0.702737651647
             le_variance =       0.493840207043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493895280129
                                         uncertainty =       0.002665384910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493895280129
                                         uncertainty =       0.002665384910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496910559
  error estimate for blocks of size 2^( 2) =       0.000514857747
  error estimate for blocks of size 2^( 3) =       0.000531879197
  error estimate for blocks of size 2^( 4) =       0.000543145354
  error estimate for blocks of size 2^( 5) =       0.000550632441
  error estimate for blocks of size 2^( 6) =       0.000552544695
  error estimate for blocks of size 2^( 7) =       0.000553956128

      target function =                  N/A
              le_mean =     -22.670256203494
             les_mean =     514.446879030407
             stat err =       0.000550069655
             autocorr =       1.225402956813
              std dev =       0.702737651647
             le_variance =       0.493840207043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493895280129
                                         uncertainty =       0.002665384910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493895280129
                                         uncertainty =       0.002665384910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496910559
  error estimate for blocks of size 2^( 2) =       0.000514857747
  error estimate for blocks of size 2^( 3) =       0.000531879197
  error estimate for blocks of size 2^( 4) =       0.000543145354
  error estimate for blocks of size 2^( 5) =       0.000550632441
  error estimate for blocks of size 2^( 6) =       0.000552544695
  error estimate for blocks of size 2^( 7) =       0.000553956128

      target function =                  N/A
              le_mean =     -22.670256203494
             les_mean =     514.446879030407
             stat err =       0.000550069655
             autocorr =       1.225402956813
              std dev =       0.702737651647
             le_variance =       0.493840207043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670256203494        initial  <--
     2.3842e+19     2.3842e+20             0.0000e+00       -22.670256203494
     9.5367e+19     9.5367e+20             0.0000e+00       -22.670256203494
     3.8147e+20     3.8147e+21             0.0000e+00       -22.670256203494

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1577
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5144e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7649
    reference variance = 0.396744
====================================================
  Execution time = 2.8167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1341e-01
  Total weights = 1.955147442e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498289939968
                                         uncertainty =       0.002625411298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498289939968
                                         uncertainty =       0.002625411298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499126675
  error estimate for blocks of size 2^( 2) =       0.000516768008
  error estimate for blocks of size 2^( 3) =       0.000532231780
  error estimate for blocks of size 2^( 4) =       0.000542974730
  error estimate for blocks of size 2^( 5) =       0.000549680920
  error estimate for blocks of size 2^( 6) =       0.000550709673
  error estimate for blocks of size 2^( 7) =       0.000553123928

      target function =                  N/A
              le_mean =     -22.669516789263
             les_mean =     514.420396523324
             stat err =       0.000549122313
             autocorr =       1.210365732951
              std dev =       0.705871713811
             le_variance =       0.498254876358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266951678926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669516789362       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669516789362       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669516789362       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669516789362       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669516789362       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669516789362       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2926e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6069
    reference variance = 0.463449
====================================================
  Execution time = 2.5556e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1203e-01
  Total weights = 1.9552e+06
  Execution time = 3.6534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499152605397
                                         uncertainty =       0.002242183631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499152605397
                                         uncertainty =       0.002242183631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499563323
  error estimate for blocks of size 2^( 2) =       0.000517236653
  error estimate for blocks of size 2^( 3) =       0.000533255109
  error estimate for blocks of size 2^( 4) =       0.000544661558
  error estimate for blocks of size 2^( 5) =       0.000550430190
  error estimate for blocks of size 2^( 6) =       0.000552855592
  error estimate for blocks of size 2^( 7) =       0.000555021946

      target function =                  N/A
              le_mean =     -22.670181273582
             les_mean =     514.449145620059
             stat err =       0.000550742321
             autocorr =       1.215390426013
              std dev =       0.706489225970
             le_variance =       0.499127026411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499152605397
                                         uncertainty =       0.002242183631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499152605397
                                         uncertainty =       0.002242183631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499563323
  error estimate for blocks of size 2^( 2) =       0.000517236653
  error estimate for blocks of size 2^( 3) =       0.000533255109
  error estimate for blocks of size 2^( 4) =       0.000544661558
  error estimate for blocks of size 2^( 5) =       0.000550430190
  error estimate for blocks of size 2^( 6) =       0.000552855592
  error estimate for blocks of size 2^( 7) =       0.000555021946

      target function =                  N/A
              le_mean =     -22.670181273582
             les_mean =     514.449145620059
             stat err =       0.000550742321
             autocorr =       1.215390426013
              std dev =       0.706489225970
             le_variance =       0.499127026411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499152605397
                                         uncertainty =       0.002242183631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499152605397
                                         uncertainty =       0.002242183631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499563323
  error estimate for blocks of size 2^( 2) =       0.000517236653
  error estimate for blocks of size 2^( 3) =       0.000533255109
  error estimate for blocks of size 2^( 4) =       0.000544661558
  error estimate for blocks of size 2^( 5) =       0.000550430190
  error estimate for blocks of size 2^( 6) =       0.000552855592
  error estimate for blocks of size 2^( 7) =       0.000555021946

      target function =                  N/A
              le_mean =     -22.670181273582
             les_mean =     514.449145620059
             stat err =       0.000550742321
             autocorr =       1.215390426013
              std dev =       0.706489225970
             le_variance =       0.499127026411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499152605397
                                         uncertainty =       0.002242183631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499152605397
                                         uncertainty =       0.002242183631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499563323
  error estimate for blocks of size 2^( 2) =       0.000517236653
  error estimate for blocks of size 2^( 3) =       0.000533255109
  error estimate for blocks of size 2^( 4) =       0.000544661558
  error estimate for blocks of size 2^( 5) =       0.000550430190
  error estimate for blocks of size 2^( 6) =       0.000552855592
  error estimate for blocks of size 2^( 7) =       0.000555021946

      target function =                  N/A
              le_mean =     -22.670181273582
             les_mean =     514.449145620059
             stat err =       0.000550742321
             autocorr =       1.215390426013
              std dev =       0.706489225970
             le_variance =       0.499127026411


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670181273582        initial  <--
     2.3842e+20     2.3842e+21             0.0000e+00       -22.670181273582
     9.5367e+20     9.5367e+21             0.0000e+00       -22.670181273582
     3.8147e+21     3.8147e+22             0.0000e+00       -22.670181273582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8559
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.6613
    reference variance = 0.477484
====================================================
  Execution time = 2.6334e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0440e-01
  Total weights = 1.955097253e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494130929626
                                         uncertainty =       0.002674544287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494130929626
                                         uncertainty =       0.002674544287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497110975
  error estimate for blocks of size 2^( 2) =       0.000515173980
  error estimate for blocks of size 2^( 3) =       0.000531444821
  error estimate for blocks of size 2^( 4) =       0.000542843226
  error estimate for blocks of size 2^( 5) =       0.000550521169
  error estimate for blocks of size 2^( 6) =       0.000555026056
  error estimate for blocks of size 2^( 7) =       0.000557038498

      target function =                  N/A
              le_mean =     -22.669924733136
             les_mean =     514.429884405492
             stat err =       0.000551357237
             autocorr =       1.230153927582
              std dev =       0.703021082193
             le_variance =       0.494238642008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266992473314e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669924733231       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669924733231       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669924733231       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669924733231       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669924733231       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669924733231       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1128e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7664
    reference variance = 0.411117
====================================================
  Execution time = 2.5681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1313e-01
  Total weights = 1.9552e+06
  Execution time = 3.6466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499928852751
                                         uncertainty =       0.003082254370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499928852751
                                         uncertainty =       0.003082254370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499965388
  error estimate for blocks of size 2^( 2) =       0.000518161136
  error estimate for blocks of size 2^( 3) =       0.000534688921
  error estimate for blocks of size 2^( 4) =       0.000546326490
  error estimate for blocks of size 2^( 5) =       0.000551997476
  error estimate for blocks of size 2^( 6) =       0.000557716029
  error estimate for blocks of size 2^( 7) =       0.000558353628

      target function =                  N/A
              le_mean =     -22.669107080399
             les_mean =     514.401541105552
             stat err =       0.000553598406
             autocorr =       1.226054516789
              std dev =       0.707057833049
             le_variance =       0.499930779276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499928852751
                                         uncertainty =       0.003082254370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499928852751
                                         uncertainty =       0.003082254370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499965388
  error estimate for blocks of size 2^( 2) =       0.000518161136
  error estimate for blocks of size 2^( 3) =       0.000534688921
  error estimate for blocks of size 2^( 4) =       0.000546326490
  error estimate for blocks of size 2^( 5) =       0.000551997476
  error estimate for blocks of size 2^( 6) =       0.000557716029
  error estimate for blocks of size 2^( 7) =       0.000558353628

      target function =                  N/A
              le_mean =     -22.669107080399
             les_mean =     514.401541105552
             stat err =       0.000553598406
             autocorr =       1.226054516789
              std dev =       0.707057833049
             le_variance =       0.499930779276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499928852751
                                         uncertainty =       0.003082254370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499928852751
                                         uncertainty =       0.003082254370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499965388
  error estimate for blocks of size 2^( 2) =       0.000518161136
  error estimate for blocks of size 2^( 3) =       0.000534688921
  error estimate for blocks of size 2^( 4) =       0.000546326490
  error estimate for blocks of size 2^( 5) =       0.000551997476
  error estimate for blocks of size 2^( 6) =       0.000557716029
  error estimate for blocks of size 2^( 7) =       0.000558353628

      target function =                  N/A
              le_mean =     -22.669107080399
             les_mean =     514.401541105552
             stat err =       0.000553598406
             autocorr =       1.226054516789
              std dev =       0.707057833049
             le_variance =       0.499930779276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499928852751
                                         uncertainty =       0.003082254370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499928852751
                                         uncertainty =       0.003082254370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499965388
  error estimate for blocks of size 2^( 2) =       0.000518161136
  error estimate for blocks of size 2^( 3) =       0.000534688921
  error estimate for blocks of size 2^( 4) =       0.000546326490
  error estimate for blocks of size 2^( 5) =       0.000551997476
  error estimate for blocks of size 2^( 6) =       0.000557716029
  error estimate for blocks of size 2^( 7) =       0.000558353628

      target function =                  N/A
              le_mean =     -22.669107080399
             les_mean =     514.401541105552
             stat err =       0.000553598406
             autocorr =       1.226054516789
              std dev =       0.707057833049
             le_variance =       0.499930779276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669107080399        initial  <--
     2.3842e+21     2.3842e+22             0.0000e+00       -22.669107080399
     9.5367e+21     9.5367e+22             0.0000e+00       -22.669107080399
     3.8147e+22     3.8147e+23             0.0000e+00       -22.669107080399

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9549
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5089e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.5656
    reference variance = 0.430982
====================================================
  Execution time = 2.6423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1433e-01
  Total weights = 1.955305962e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500104021045
                                         uncertainty =       0.003494234388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500104021045
                                         uncertainty =       0.003494234388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500034873
  error estimate for blocks of size 2^( 2) =       0.000517742166
  error estimate for blocks of size 2^( 3) =       0.000533710808
  error estimate for blocks of size 2^( 4) =       0.000545555387
  error estimate for blocks of size 2^( 5) =       0.000553185602
  error estimate for blocks of size 2^( 6) =       0.000554841679
  error estimate for blocks of size 2^( 7) =       0.000560241846

      target function =                  N/A
              le_mean =     -22.669483500971
             les_mean =     514.419812822169
             stat err =       0.000553456129
             autocorr =       1.225083851751
              std dev =       0.707156098412
             le_variance =       0.500069747522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266948350097e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669483501066       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669483501066       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669483501066       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669483501066       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669483501066       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669483501066       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1220e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6607
    reference variance = 0.365514
====================================================
  Execution time = 2.5674e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1289e-01
  Total weights = 1.9551e+06
  Execution time = 3.6409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494625798443
                                         uncertainty =       0.002877687557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494625798443
                                         uncertainty =       0.002877687557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497321518
  error estimate for blocks of size 2^( 2) =       0.000515280435
  error estimate for blocks of size 2^( 3) =       0.000531869431
  error estimate for blocks of size 2^( 4) =       0.000543664523
  error estimate for blocks of size 2^( 5) =       0.000550335808
  error estimate for blocks of size 2^( 6) =       0.000552759076
  error estimate for blocks of size 2^( 7) =       0.000555801946

      target function =                  N/A
              le_mean =     -22.670045529959
             les_mean =     514.443858935134
             stat err =       0.000550640338
             autocorr =       1.225918350705
              std dev =       0.703318835070
             le_variance =       0.494657383765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494625798443
                                         uncertainty =       0.002877687557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494625798443
                                         uncertainty =       0.002877687557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497321518
  error estimate for blocks of size 2^( 2) =       0.000515280435
  error estimate for blocks of size 2^( 3) =       0.000531869431
  error estimate for blocks of size 2^( 4) =       0.000543664523
  error estimate for blocks of size 2^( 5) =       0.000550335808
  error estimate for blocks of size 2^( 6) =       0.000552759076
  error estimate for blocks of size 2^( 7) =       0.000555801946

      target function =                  N/A
              le_mean =     -22.670045529959
             les_mean =     514.443858935134
             stat err =       0.000550640338
             autocorr =       1.225918350705
              std dev =       0.703318835070
             le_variance =       0.494657383765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494625798443
                                         uncertainty =       0.002877687557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494625798443
                                         uncertainty =       0.002877687557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497321518
  error estimate for blocks of size 2^( 2) =       0.000515280435
  error estimate for blocks of size 2^( 3) =       0.000531869431
  error estimate for blocks of size 2^( 4) =       0.000543664523
  error estimate for blocks of size 2^( 5) =       0.000550335808
  error estimate for blocks of size 2^( 6) =       0.000552759076
  error estimate for blocks of size 2^( 7) =       0.000555801946

      target function =                  N/A
              le_mean =     -22.670045529959
             les_mean =     514.443858935134
             stat err =       0.000550640338
             autocorr =       1.225918350705
              std dev =       0.703318835070
             le_variance =       0.494657383765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494625798443
                                         uncertainty =       0.002877687557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494625798443
                                         uncertainty =       0.002877687557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497321518
  error estimate for blocks of size 2^( 2) =       0.000515280435
  error estimate for blocks of size 2^( 3) =       0.000531869431
  error estimate for blocks of size 2^( 4) =       0.000543664523
  error estimate for blocks of size 2^( 5) =       0.000550335808
  error estimate for blocks of size 2^( 6) =       0.000552759076
  error estimate for blocks of size 2^( 7) =       0.000555801946

      target function =                  N/A
              le_mean =     -22.670045529959
             les_mean =     514.443858935134
             stat err =       0.000550640338
             autocorr =       1.225918350705
              std dev =       0.703318835070
             le_variance =       0.494657383765


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670045529959        initial  <--
     2.3842e+22     2.3842e+23             0.0000e+00       -22.670045529959
     9.5367e+22     9.5367e+23             0.0000e+00       -22.670045529959
     3.8147e+23     3.8147e+24             0.0000e+00       -22.670045529959

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9178
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5149e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.6616
    reference variance = 0.472308
====================================================
  Execution time = 2.6313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0875e-01
  Total weights = 1.954894259e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495154811921
                                         uncertainty =       0.002430473610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495154811921
                                         uncertainty =       0.002430473610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497538997
  error estimate for blocks of size 2^( 2) =       0.000515291830
  error estimate for blocks of size 2^( 3) =       0.000531659338
  error estimate for blocks of size 2^( 4) =       0.000542347519
  error estimate for blocks of size 2^( 5) =       0.000549008263
  error estimate for blocks of size 2^( 6) =       0.000553242661
  error estimate for blocks of size 2^( 7) =       0.000552117636

      target function =                  N/A
              le_mean =     -22.669888432115
             les_mean =     514.432587169630
             stat err =       0.000549179020
             autocorr =       1.218354363263
              std dev =       0.703626396808
             le_variance =       0.495090106284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266988843212e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+23, overlap shift 2.3842e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669888432214       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669888432214       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+23, overlap shift 9.5367e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669888432214       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669888432214       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+24, overlap shift 3.8147e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669888432214       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669888432214       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099279 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1089e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.7727
    reference variance = 0.741407
====================================================
  Execution time = 2.5835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1941e-01
  Total weights = 1.9552e+06
  Execution time = 3.6564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504364965060
                                         uncertainty =       0.003818958157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504364965060
                                         uncertainty =       0.003818958157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502254865
  error estimate for blocks of size 2^( 2) =       0.000520123929
  error estimate for blocks of size 2^( 3) =       0.000536405694
  error estimate for blocks of size 2^( 4) =       0.000547979420
  error estimate for blocks of size 2^( 5) =       0.000554873394
  error estimate for blocks of size 2^( 6) =       0.000560145678
  error estimate for blocks of size 2^( 7) =       0.000561761375

      target function =                  N/A
              le_mean =     -22.669996826184
             les_mean =     514.448167530235
             stat err =       0.000556189967
             autocorr =       1.226303579759
              std dev =       0.710295642092
             le_variance =       0.504519899175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504364965060
                                         uncertainty =       0.003818958157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504364965060
                                         uncertainty =       0.003818958157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502254865
  error estimate for blocks of size 2^( 2) =       0.000520123929
  error estimate for blocks of size 2^( 3) =       0.000536405694
  error estimate for blocks of size 2^( 4) =       0.000547979420
  error estimate for blocks of size 2^( 5) =       0.000554873394
  error estimate for blocks of size 2^( 6) =       0.000560145678
  error estimate for blocks of size 2^( 7) =       0.000561761375

      target function =                  N/A
              le_mean =     -22.669996826184
             les_mean =     514.448167530235
             stat err =       0.000556189967
             autocorr =       1.226303579759
              std dev =       0.710295642092
             le_variance =       0.504519899175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504364965060
                                         uncertainty =       0.003818958157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504364965060
                                         uncertainty =       0.003818958157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502254865
  error estimate for blocks of size 2^( 2) =       0.000520123929
  error estimate for blocks of size 2^( 3) =       0.000536405694
  error estimate for blocks of size 2^( 4) =       0.000547979420
  error estimate for blocks of size 2^( 5) =       0.000554873394
  error estimate for blocks of size 2^( 6) =       0.000560145678
  error estimate for blocks of size 2^( 7) =       0.000561761375

      target function =                  N/A
              le_mean =     -22.669996826184
             les_mean =     514.448167530235
             stat err =       0.000556189967
             autocorr =       1.226303579759
              std dev =       0.710295642092
             le_variance =       0.504519899175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504364965060
                                         uncertainty =       0.003818958157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504364965060
                                         uncertainty =       0.003818958157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502254865
  error estimate for blocks of size 2^( 2) =       0.000520123929
  error estimate for blocks of size 2^( 3) =       0.000536405694
  error estimate for blocks of size 2^( 4) =       0.000547979420
  error estimate for blocks of size 2^( 5) =       0.000554873394
  error estimate for blocks of size 2^( 6) =       0.000560145678
  error estimate for blocks of size 2^( 7) =       0.000561761375

      target function =                  N/A
              le_mean =     -22.669996826184
             les_mean =     514.448167530235
             stat err =       0.000556189967
             autocorr =       1.226303579759
              std dev =       0.710295642092
             le_variance =       0.504519899175


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669996826184        initial  <--
     2.3842e+23     2.3842e+24             0.0000e+00       -22.669996826184
     9.5367e+23     9.5367e+24             0.0000e+00       -22.669996826184
     3.8147e+24     3.8147e+25             0.0000e+00       -22.669996826184

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1448
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.653
    reference variance = 0.384759
====================================================
  Execution time = 2.8140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0420e-01
  Total weights = 1.955040036e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492422432418
                                         uncertainty =       0.002486699193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492422432418
                                         uncertainty =       0.002486699193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496160966
  error estimate for blocks of size 2^( 2) =       0.000514455655
  error estimate for blocks of size 2^( 3) =       0.000530412626
  error estimate for blocks of size 2^( 4) =       0.000542334030
  error estimate for blocks of size 2^( 5) =       0.000548511567
  error estimate for blocks of size 2^( 6) =       0.000551081828
  error estimate for blocks of size 2^( 7) =       0.000554167358

      target function =                  N/A
              le_mean =     -22.669926860836
             les_mean =     514.429788854338
             stat err =       0.000549023696
             autocorr =       1.224438534236
              std dev =       0.701677567397
             le_variance =       0.492351408588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266992686084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+24, overlap shift 2.3842e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669926860890       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669926860890       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669926860890       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669926860890       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+24 is 2.253128e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+24, overlap shift 9.5367e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669926860890       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669926860890       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669926860890       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669926860890       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+24 is 5.606361e-29

solving harmonic davidson linear method for identity shift 3.8147e+25, overlap shift 3.8147e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669926860890       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669926860890       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669926860890       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669926860890       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+25 is 1.401590e-29

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100731 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2973e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7284
    reference variance = 0.534635
====================================================
  Execution time = 2.5739e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0895e-01
  Total weights = 1.9552e+06
  Execution time = 3.6462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492844652605
                                         uncertainty =       0.002561637200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492844652605
                                         uncertainty =       0.002561637200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496416879
  error estimate for blocks of size 2^( 2) =       0.000515070701
  error estimate for blocks of size 2^( 3) =       0.000530664155
  error estimate for blocks of size 2^( 4) =       0.000542617724
  error estimate for blocks of size 2^( 5) =       0.000548982588
  error estimate for blocks of size 2^( 6) =       0.000552489232
  error estimate for blocks of size 2^( 7) =       0.000555404557

      target function =                  N/A
              le_mean =     -22.668996133641
             les_mean =     514.392333466815
             stat err =       0.000549873525
             autocorr =       1.226966035007
              std dev =       0.702039483037
             le_variance =       0.492859435744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492844652605
                                         uncertainty =       0.002561637200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492844652605
                                         uncertainty =       0.002561637200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496416879
  error estimate for blocks of size 2^( 2) =       0.000515070701
  error estimate for blocks of size 2^( 3) =       0.000530664155
  error estimate for blocks of size 2^( 4) =       0.000542617724
  error estimate for blocks of size 2^( 5) =       0.000548982588
  error estimate for blocks of size 2^( 6) =       0.000552489232
  error estimate for blocks of size 2^( 7) =       0.000555404557

      target function =                  N/A
              le_mean =     -22.668996133641
             les_mean =     514.392333466815
             stat err =       0.000549873525
             autocorr =       1.226966035007
              std dev =       0.702039483037
             le_variance =       0.492859435744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492844652605
                                         uncertainty =       0.002561637200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492844652605
                                         uncertainty =       0.002561637200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496416879
  error estimate for blocks of size 2^( 2) =       0.000515070701
  error estimate for blocks of size 2^( 3) =       0.000530664155
  error estimate for blocks of size 2^( 4) =       0.000542617724
  error estimate for blocks of size 2^( 5) =       0.000548982588
  error estimate for blocks of size 2^( 6) =       0.000552489232
  error estimate for blocks of size 2^( 7) =       0.000555404557

      target function =                  N/A
              le_mean =     -22.668996133641
             les_mean =     514.392333466815
             stat err =       0.000549873525
             autocorr =       1.226966035007
              std dev =       0.702039483037
             le_variance =       0.492859435744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492844652605
                                         uncertainty =       0.002561637200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492844652605
                                         uncertainty =       0.002561637200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496416879
  error estimate for blocks of size 2^( 2) =       0.000515070701
  error estimate for blocks of size 2^( 3) =       0.000530664155
  error estimate for blocks of size 2^( 4) =       0.000542617724
  error estimate for blocks of size 2^( 5) =       0.000548982588
  error estimate for blocks of size 2^( 6) =       0.000552489232
  error estimate for blocks of size 2^( 7) =       0.000555404557

      target function =                  N/A
              le_mean =     -22.668996133641
             les_mean =     514.392333466815
             stat err =       0.000549873525
             autocorr =       1.226966035007
              std dev =       0.702039483037
             le_variance =       0.492859435744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668996133641        initial  <--
     2.3842e+24     2.3842e+25             2.2531e-28       -22.668996133641
     9.5367e+24     9.5367e+25             5.6064e-29       -22.668996133641
     3.8147e+25     3.8147e+26             1.4016e-29       -22.668996133641

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9978
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.5846
    reference variance = 0.336163
====================================================
  Execution time = 2.6390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1724e-01
  Total weights = 1.955109300e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500458097268
                                         uncertainty =       0.003272462149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500458097268
                                         uncertainty =       0.003272462149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500202197
  error estimate for blocks of size 2^( 2) =       0.000517860667
  error estimate for blocks of size 2^( 3) =       0.000533762880
  error estimate for blocks of size 2^( 4) =       0.000544881156
  error estimate for blocks of size 2^( 5) =       0.000552702414
  error estimate for blocks of size 2^( 6) =       0.000555055954
  error estimate for blocks of size 2^( 7) =       0.000553592409

      target function =                  N/A
              le_mean =     -22.669325474521
             les_mean =     514.415562450242
             stat err =       0.000551557983
             autocorr =       1.215881245773
              std dev =       0.707392731351
             le_variance =       0.500404476368


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266932547452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+25, overlap shift 2.3842e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669325474592       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669325474592       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+25, overlap shift 9.5367e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669325474592       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669325474592       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+26, overlap shift 3.8147e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669325474592       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669325474592       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1147e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.6029
    reference variance = 0.364774
====================================================
  Execution time = 2.5671e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0770e-01
  Total weights = 1.9548e+06
  Execution time = 3.6596e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496441419840
                                         uncertainty =       0.004295342844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496441419840
                                         uncertainty =       0.004295342844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498170093
  error estimate for blocks of size 2^( 2) =       0.000516417928
  error estimate for blocks of size 2^( 3) =       0.000532532270
  error estimate for blocks of size 2^( 4) =       0.000543488721
  error estimate for blocks of size 2^( 5) =       0.000550227496
  error estimate for blocks of size 2^( 6) =       0.000554025010
  error estimate for blocks of size 2^( 7) =       0.000557191306

      target function =                  N/A
              le_mean =     -22.669745523182
             les_mean =     514.425065043520
             stat err =       0.000551233133
             autocorr =       1.224377454720
              std dev =       0.704518902466
             le_variance =       0.496346883932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496441419840
                                         uncertainty =       0.004295342844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496441419840
                                         uncertainty =       0.004295342844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498170093
  error estimate for blocks of size 2^( 2) =       0.000516417928
  error estimate for blocks of size 2^( 3) =       0.000532532270
  error estimate for blocks of size 2^( 4) =       0.000543488721
  error estimate for blocks of size 2^( 5) =       0.000550227496
  error estimate for blocks of size 2^( 6) =       0.000554025010
  error estimate for blocks of size 2^( 7) =       0.000557191306

      target function =                  N/A
              le_mean =     -22.669745523182
             les_mean =     514.425065043520
             stat err =       0.000551233133
             autocorr =       1.224377454720
              std dev =       0.704518902466
             le_variance =       0.496346883932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496441419840
                                         uncertainty =       0.004295342844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496441419840
                                         uncertainty =       0.004295342844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498170093
  error estimate for blocks of size 2^( 2) =       0.000516417928
  error estimate for blocks of size 2^( 3) =       0.000532532270
  error estimate for blocks of size 2^( 4) =       0.000543488721
  error estimate for blocks of size 2^( 5) =       0.000550227496
  error estimate for blocks of size 2^( 6) =       0.000554025010
  error estimate for blocks of size 2^( 7) =       0.000557191306

      target function =                  N/A
              le_mean =     -22.669745523182
             les_mean =     514.425065043520
             stat err =       0.000551233133
             autocorr =       1.224377454720
              std dev =       0.704518902466
             le_variance =       0.496346883932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496441419840
                                         uncertainty =       0.004295342844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496441419840
                                         uncertainty =       0.004295342844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498170093
  error estimate for blocks of size 2^( 2) =       0.000516417928
  error estimate for blocks of size 2^( 3) =       0.000532532270
  error estimate for blocks of size 2^( 4) =       0.000543488721
  error estimate for blocks of size 2^( 5) =       0.000550227496
  error estimate for blocks of size 2^( 6) =       0.000554025010
  error estimate for blocks of size 2^( 7) =       0.000557191306

      target function =                  N/A
              le_mean =     -22.669745523182
             les_mean =     514.425065043520
             stat err =       0.000551233133
             autocorr =       1.224377454720
              std dev =       0.704518902466
             le_variance =       0.496346883932


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669745523182        initial  <--
     2.3842e+25     2.3842e+26             0.0000e+00       -22.669745523182
     9.5367e+25     9.5367e+26             0.0000e+00       -22.669745523182
     3.8147e+26     3.8147e+27             0.0000e+00       -22.669745523182

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0351
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5188e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.6707
    reference variance = 0.386907
====================================================
  Execution time = 2.6306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1068e-01
  Total weights = 1.955290809e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8153e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496372355925
                                         uncertainty =       0.002835830654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496372355925
                                         uncertainty =       0.002835830654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498160326
  error estimate for blocks of size 2^( 2) =       0.000516137282
  error estimate for blocks of size 2^( 3) =       0.000532576664
  error estimate for blocks of size 2^( 4) =       0.000543521473
  error estimate for blocks of size 2^( 5) =       0.000549951895
  error estimate for blocks of size 2^( 6) =       0.000553149298
  error estimate for blocks of size 2^( 7) =       0.000555572357

      target function =                  N/A
              le_mean =     -22.669590257735
             les_mean =     514.421002151463
             stat err =       0.000550548756
             autocorr =       1.221387009908
              std dev =       0.704505089653
             le_variance =       0.496327421347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266959025774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+26, overlap shift 2.3842e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669590257846       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669590257846       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+26, overlap shift 9.5367e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669590257846       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669590257846       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+27, overlap shift 3.8147e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669590257846       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669590257846       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102997 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1126e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.6129
    reference variance = 0.286722
====================================================
  Execution time = 2.5788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0429e-01
  Total weights = 1.9551e+06
  Execution time = 3.6518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492795106583
                                         uncertainty =       0.002696899679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492795106583
                                         uncertainty =       0.002696899679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496412243
  error estimate for blocks of size 2^( 2) =       0.000514824261
  error estimate for blocks of size 2^( 3) =       0.000530649547
  error estimate for blocks of size 2^( 4) =       0.000541960900
  error estimate for blocks of size 2^( 5) =       0.000550621113
  error estimate for blocks of size 2^( 6) =       0.000554624503
  error estimate for blocks of size 2^( 7) =       0.000556841385

      target function =                  N/A
              le_mean =     -22.670472128236
             les_mean =     514.454598529463
             stat err =       0.000551011975
             autocorr =       1.232074893546
              std dev =       0.702032926077
             le_variance =       0.492850229297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492795106583
                                         uncertainty =       0.002696899679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492795106583
                                         uncertainty =       0.002696899679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496412243
  error estimate for blocks of size 2^( 2) =       0.000514824261
  error estimate for blocks of size 2^( 3) =       0.000530649547
  error estimate for blocks of size 2^( 4) =       0.000541960900
  error estimate for blocks of size 2^( 5) =       0.000550621113
  error estimate for blocks of size 2^( 6) =       0.000554624503
  error estimate for blocks of size 2^( 7) =       0.000556841385

      target function =                  N/A
              le_mean =     -22.670472128236
             les_mean =     514.454598529463
             stat err =       0.000551011975
             autocorr =       1.232074893546
              std dev =       0.702032926077
             le_variance =       0.492850229297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492795106583
                                         uncertainty =       0.002696899679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492795106583
                                         uncertainty =       0.002696899679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496412243
  error estimate for blocks of size 2^( 2) =       0.000514824261
  error estimate for blocks of size 2^( 3) =       0.000530649547
  error estimate for blocks of size 2^( 4) =       0.000541960900
  error estimate for blocks of size 2^( 5) =       0.000550621113
  error estimate for blocks of size 2^( 6) =       0.000554624503
  error estimate for blocks of size 2^( 7) =       0.000556841385

      target function =                  N/A
              le_mean =     -22.670472128236
             les_mean =     514.454598529463
             stat err =       0.000551011975
             autocorr =       1.232074893546
              std dev =       0.702032926077
             le_variance =       0.492850229297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492795106583
                                         uncertainty =       0.002696899679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492795106583
                                         uncertainty =       0.002696899679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496412243
  error estimate for blocks of size 2^( 2) =       0.000514824261
  error estimate for blocks of size 2^( 3) =       0.000530649547
  error estimate for blocks of size 2^( 4) =       0.000541960900
  error estimate for blocks of size 2^( 5) =       0.000550621113
  error estimate for blocks of size 2^( 6) =       0.000554624503
  error estimate for blocks of size 2^( 7) =       0.000556841385

      target function =                  N/A
              le_mean =     -22.670472128236
             les_mean =     514.454598529463
             stat err =       0.000551011975
             autocorr =       1.232074893546
              std dev =       0.702032926077
             le_variance =       0.492850229297


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670472128236        initial  <--
     2.3842e+26     2.3842e+27             0.0000e+00       -22.670472128236
     9.5367e+26     9.5367e+27             0.0000e+00       -22.670472128236
     3.8147e+27     3.8147e+28             0.0000e+00       -22.670472128236

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1532
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5285e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7092
    reference variance = 0.39341
====================================================
  Execution time = 2.6392e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2076e-01
  Total weights = 1.955148098e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502387805868
                                         uncertainty =       0.005283142044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502387805868
                                         uncertainty =       0.005283142044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501210205
  error estimate for blocks of size 2^( 2) =       0.000518650856
  error estimate for blocks of size 2^( 3) =       0.000534211875
  error estimate for blocks of size 2^( 4) =       0.000545271739
  error estimate for blocks of size 2^( 5) =       0.000553918927
  error estimate for blocks of size 2^( 6) =       0.000560117326
  error estimate for blocks of size 2^( 7) =       0.000562137306

      target function =                  N/A
              le_mean =     -22.669690368669
             les_mean =     514.435624916726
             stat err =       0.000555361325
             autocorr =       1.227754273033
              std dev =       0.708818269494
             le_variance =       0.502423339169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266969036867e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+27, overlap shift 2.3842e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669690368752       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669690368752       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669690368752       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669690368755       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+27 is 2.197379e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+27, overlap shift 9.5367e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669690368752       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669690368752       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669690368752       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669690368755       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+27 is 5.493447e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+28, overlap shift 3.8147e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669690368752       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669690368752       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669690368752       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+28 is 1.260092e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1181e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7118
    reference variance = 0.416437
====================================================
  Execution time = 2.5539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0351e-01
  Total weights = 1.9551e+06
  Execution time = 3.6544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492728519502
                                         uncertainty =       0.002363757104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492728519502
                                         uncertainty =       0.002363757104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496339715
  error estimate for blocks of size 2^( 2) =       0.000514446456
  error estimate for blocks of size 2^( 3) =       0.000530101497
  error estimate for blocks of size 2^( 4) =       0.000540989351
  error estimate for blocks of size 2^( 5) =       0.000547515928
  error estimate for blocks of size 2^( 6) =       0.000551462993
  error estimate for blocks of size 2^( 7) =       0.000552883919

      target function =                  N/A
              le_mean =     -22.668892681667
             les_mean =     514.382209587573
             stat err =       0.000548213048
             autocorr =       1.219946209633
              std dev =       0.701930356127
             le_variance =       0.492706224852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492728519502
                                         uncertainty =       0.002363757104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492728519502
                                         uncertainty =       0.002363757104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496339715
  error estimate for blocks of size 2^( 2) =       0.000514446456
  error estimate for blocks of size 2^( 3) =       0.000530101497
  error estimate for blocks of size 2^( 4) =       0.000540989351
  error estimate for blocks of size 2^( 5) =       0.000547515928
  error estimate for blocks of size 2^( 6) =       0.000551462993
  error estimate for blocks of size 2^( 7) =       0.000552883919

      target function =                  N/A
              le_mean =     -22.668892681667
             les_mean =     514.382209587573
             stat err =       0.000548213048
             autocorr =       1.219946209633
              std dev =       0.701930356127
             le_variance =       0.492706224852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492728519502
                                         uncertainty =       0.002363757104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492728519502
                                         uncertainty =       0.002363757104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496339715
  error estimate for blocks of size 2^( 2) =       0.000514446456
  error estimate for blocks of size 2^( 3) =       0.000530101497
  error estimate for blocks of size 2^( 4) =       0.000540989351
  error estimate for blocks of size 2^( 5) =       0.000547515928
  error estimate for blocks of size 2^( 6) =       0.000551462993
  error estimate for blocks of size 2^( 7) =       0.000552883919

      target function =                  N/A
              le_mean =     -22.668892681667
             les_mean =     514.382209587573
             stat err =       0.000548213048
             autocorr =       1.219946209633
              std dev =       0.701930356127
             le_variance =       0.492706224852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492728519502
                                         uncertainty =       0.002363757104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492728519502
                                         uncertainty =       0.002363757104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496339715
  error estimate for blocks of size 2^( 2) =       0.000514446456
  error estimate for blocks of size 2^( 3) =       0.000530101497
  error estimate for blocks of size 2^( 4) =       0.000540989351
  error estimate for blocks of size 2^( 5) =       0.000547515928
  error estimate for blocks of size 2^( 6) =       0.000551462993
  error estimate for blocks of size 2^( 7) =       0.000552883919

      target function =                  N/A
              le_mean =     -22.668892681667
             les_mean =     514.382209587573
             stat err =       0.000548213048
             autocorr =       1.219946209633
              std dev =       0.701930356127
             le_variance =       0.492706224852


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668892681667        initial  <--
     2.3842e+27     2.3842e+28             2.1974e-31       -22.668892681667
     9.5367e+27     9.5367e+28             5.4934e-32       -22.668892681667
     3.8147e+28     3.8147e+29             1.2601e-32       -22.668892681667

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8516
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5039e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6635
    reference variance = 0.484653
====================================================
  Execution time = 2.8265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0856e-01
  Total weights = 1.955002494e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495569406789
                                         uncertainty =       0.002494592431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495569406789
                                         uncertainty =       0.002494592431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497747683
  error estimate for blocks of size 2^( 2) =       0.000515773897
  error estimate for blocks of size 2^( 3) =       0.000531854826
  error estimate for blocks of size 2^( 4) =       0.000542864810
  error estimate for blocks of size 2^( 5) =       0.000549936896
  error estimate for blocks of size 2^( 6) =       0.000553232514
  error estimate for blocks of size 2^( 7) =       0.000552954320

      target function =                  N/A
              le_mean =     -22.669969270115
             les_mean =     514.436066630840
             stat err =       0.000549747135
             autocorr =       1.219852880159
              std dev =       0.703921523335
             le_variance =       0.495505511015


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266996927011e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+28, overlap shift 2.3842e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669969270185       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669969270185       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+28, overlap shift 9.5367e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669969270185       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669969270185       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+29, overlap shift 3.8147e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669969270185       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669969270185       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105722 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3063e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7159
    reference variance = 0.709397
====================================================
  Execution time = 2.5414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0625e-01
  Total weights = 1.9549e+06
  Execution time = 3.6594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494853325052
                                         uncertainty =       0.002171834317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494853325052
                                         uncertainty =       0.002171834317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497495656
  error estimate for blocks of size 2^( 2) =       0.000515808188
  error estimate for blocks of size 2^( 3) =       0.000532741724
  error estimate for blocks of size 2^( 4) =       0.000543788675
  error estimate for blocks of size 2^( 5) =       0.000551317655
  error estimate for blocks of size 2^( 6) =       0.000554038136
  error estimate for blocks of size 2^( 7) =       0.000555918424

      target function =                  N/A
              le_mean =     -22.669334009940
             les_mean =     514.404953769779
             stat err =       0.000551265722
             autocorr =       1.227844565109
              std dev =       0.703565103847
             le_variance =       0.495003855351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494853325052
                                         uncertainty =       0.002171834317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494853325052
                                         uncertainty =       0.002171834317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497495656
  error estimate for blocks of size 2^( 2) =       0.000515808188
  error estimate for blocks of size 2^( 3) =       0.000532741724
  error estimate for blocks of size 2^( 4) =       0.000543788675
  error estimate for blocks of size 2^( 5) =       0.000551317655
  error estimate for blocks of size 2^( 6) =       0.000554038136
  error estimate for blocks of size 2^( 7) =       0.000555918424

      target function =                  N/A
              le_mean =     -22.669334009940
             les_mean =     514.404953769779
             stat err =       0.000551265722
             autocorr =       1.227844565109
              std dev =       0.703565103847
             le_variance =       0.495003855351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494853325052
                                         uncertainty =       0.002171834317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494853325052
                                         uncertainty =       0.002171834317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497495656
  error estimate for blocks of size 2^( 2) =       0.000515808188
  error estimate for blocks of size 2^( 3) =       0.000532741724
  error estimate for blocks of size 2^( 4) =       0.000543788675
  error estimate for blocks of size 2^( 5) =       0.000551317655
  error estimate for blocks of size 2^( 6) =       0.000554038136
  error estimate for blocks of size 2^( 7) =       0.000555918424

      target function =                  N/A
              le_mean =     -22.669334009940
             les_mean =     514.404953769779
             stat err =       0.000551265722
             autocorr =       1.227844565109
              std dev =       0.703565103847
             le_variance =       0.495003855351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494853325052
                                         uncertainty =       0.002171834317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494853325052
                                         uncertainty =       0.002171834317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497495656
  error estimate for blocks of size 2^( 2) =       0.000515808188
  error estimate for blocks of size 2^( 3) =       0.000532741724
  error estimate for blocks of size 2^( 4) =       0.000543788675
  error estimate for blocks of size 2^( 5) =       0.000551317655
  error estimate for blocks of size 2^( 6) =       0.000554038136
  error estimate for blocks of size 2^( 7) =       0.000555918424

      target function =                  N/A
              le_mean =     -22.669334009940
             les_mean =     514.404953769779
             stat err =       0.000551265722
             autocorr =       1.227844565109
              std dev =       0.703565103847
             le_variance =       0.495003855351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669334009940        initial  <--
     2.3842e+28     2.3842e+29             0.0000e+00       -22.669334009940
     9.5367e+28     9.5367e+29             0.0000e+00       -22.669334009940
     3.8147e+29     3.8147e+30             0.0000e+00       -22.669334009940

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7287
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6797e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.6475
    reference variance = 0.332516
====================================================
  Execution time = 2.6028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0780e-01
  Total weights = 1.955191923e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496467448550
                                         uncertainty =       0.003243975832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496467448550
                                         uncertainty =       0.003243975832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498181915
  error estimate for blocks of size 2^( 2) =       0.000516051204
  error estimate for blocks of size 2^( 3) =       0.000531897610
  error estimate for blocks of size 2^( 4) =       0.000542800915
  error estimate for blocks of size 2^( 5) =       0.000549206059
  error estimate for blocks of size 2^( 6) =       0.000550867194
  error estimate for blocks of size 2^( 7) =       0.000554525157

      target function =                  N/A
              le_mean =     -22.669364741852
             les_mean =     514.407899106807
             stat err =       0.000549349831
             autocorr =       1.215967801344
              std dev =       0.704535620838
             le_variance =       0.496370441030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266936474185e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+29, overlap shift 2.3842e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669364741922       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669364741922       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669364742003       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+29 is 1.661147e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+29, overlap shift 9.5367e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669364741922       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669364741922       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669364741922       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+29 is 4.152868e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+30, overlap shift 3.8147e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669364741922       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669364741922       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669364742003       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+30 is 1.038217e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0825e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7009
    reference variance = 0.246874
====================================================
  Execution time = 2.5215e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1244e-01
  Total weights = 1.9549e+06
  Execution time = 3.6662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498440590677
                                         uncertainty =       0.002627184252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498440590677
                                         uncertainty =       0.002627184252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499170473
  error estimate for blocks of size 2^( 2) =       0.000517235133
  error estimate for blocks of size 2^( 3) =       0.000533026250
  error estimate for blocks of size 2^( 4) =       0.000545227789
  error estimate for blocks of size 2^( 5) =       0.000549872066
  error estimate for blocks of size 2^( 6) =       0.000553706692
  error estimate for blocks of size 2^( 7) =       0.000557028140

      target function =                  N/A
              le_mean =     -22.669664279544
             les_mean =     514.426120409448
             stat err =       0.000551458672
             autocorr =       1.220472967780
              std dev =       0.705933652841
             le_variance =       0.498342322213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498440590677
                                         uncertainty =       0.002627184252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498440590677
                                         uncertainty =       0.002627184252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499170473
  error estimate for blocks of size 2^( 2) =       0.000517235133
  error estimate for blocks of size 2^( 3) =       0.000533026250
  error estimate for blocks of size 2^( 4) =       0.000545227789
  error estimate for blocks of size 2^( 5) =       0.000549872066
  error estimate for blocks of size 2^( 6) =       0.000553706692
  error estimate for blocks of size 2^( 7) =       0.000557028140

      target function =                  N/A
              le_mean =     -22.669664279544
             les_mean =     514.426120409448
             stat err =       0.000551458672
             autocorr =       1.220472967780
              std dev =       0.705933652841
             le_variance =       0.498342322213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498440590677
                                         uncertainty =       0.002627184252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498440590677
                                         uncertainty =       0.002627184252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499170473
  error estimate for blocks of size 2^( 2) =       0.000517235133
  error estimate for blocks of size 2^( 3) =       0.000533026250
  error estimate for blocks of size 2^( 4) =       0.000545227789
  error estimate for blocks of size 2^( 5) =       0.000549872066
  error estimate for blocks of size 2^( 6) =       0.000553706692
  error estimate for blocks of size 2^( 7) =       0.000557028140

      target function =                  N/A
              le_mean =     -22.669664279544
             les_mean =     514.426120409448
             stat err =       0.000551458672
             autocorr =       1.220472967780
              std dev =       0.705933652841
             le_variance =       0.498342322213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498440590677
                                         uncertainty =       0.002627184252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498440590677
                                         uncertainty =       0.002627184252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499170473
  error estimate for blocks of size 2^( 2) =       0.000517235133
  error estimate for blocks of size 2^( 3) =       0.000533026250
  error estimate for blocks of size 2^( 4) =       0.000545227789
  error estimate for blocks of size 2^( 5) =       0.000549872066
  error estimate for blocks of size 2^( 6) =       0.000553706692
  error estimate for blocks of size 2^( 7) =       0.000557028140

      target function =                  N/A
              le_mean =     -22.669664279544
             les_mean =     514.426120409448
             stat err =       0.000551458672
             autocorr =       1.220472967780
              std dev =       0.705933652841
             le_variance =       0.498342322213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669664279544        initial  <--
     2.3842e+29     2.3842e+30             1.6611e-33       -22.669664279544
     9.5367e+29     9.5367e+30             4.1529e-34       -22.669664279544
     3.8147e+30     3.8147e+31             1.0382e-34       -22.669664279544

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5634
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4404e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.6338
    reference variance = 0.509782
====================================================
  Execution time = 2.5955e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0674e-01
  Total weights = 1.955187132e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492802710258
                                         uncertainty =       0.002625740861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492802710258
                                         uncertainty =       0.002625740861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496365016
  error estimate for blocks of size 2^( 2) =       0.000514650994
  error estimate for blocks of size 2^( 3) =       0.000531002426
  error estimate for blocks of size 2^( 4) =       0.000542619172
  error estimate for blocks of size 2^( 5) =       0.000549849973
  error estimate for blocks of size 2^( 6) =       0.000553229793
  error estimate for blocks of size 2^( 7) =       0.000556733979

      target function =                  N/A
              le_mean =     -22.668883645078
             les_mean =     514.385029912922
             stat err =       0.000550608229
             autocorr =       1.230504104264
              std dev =       0.701966137279
             le_variance =       0.492756457887


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266888364508e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+30, overlap shift 2.3842e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668883645128       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668883645128       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+30, overlap shift 9.5367e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668883645128       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668883645128       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+31, overlap shift 3.8147e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668883645128       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668883645128       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0699e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.5894
    reference variance = 0.385349
====================================================
  Execution time = 2.5545e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1043e-01
  Total weights = 1.9551e+06
  Execution time = 3.6544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496860056587
                                         uncertainty =       0.002951632233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496860056587
                                         uncertainty =       0.002951632233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498424949
  error estimate for blocks of size 2^( 2) =       0.000516495363
  error estimate for blocks of size 2^( 3) =       0.000532932346
  error estimate for blocks of size 2^( 4) =       0.000545090866
  error estimate for blocks of size 2^( 5) =       0.000552710849
  error estimate for blocks of size 2^( 6) =       0.000556719135
  error estimate for blocks of size 2^( 7) =       0.000559684420

      target function =                  N/A
              le_mean =     -22.670468336162
             les_mean =     514.460565825954
             stat err =       0.000553551317
             autocorr =       1.233434896890
              std dev =       0.704879322384
             le_variance =       0.496854859124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496860056587
                                         uncertainty =       0.002951632233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496860056587
                                         uncertainty =       0.002951632233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498424949
  error estimate for blocks of size 2^( 2) =       0.000516495363
  error estimate for blocks of size 2^( 3) =       0.000532932346
  error estimate for blocks of size 2^( 4) =       0.000545090866
  error estimate for blocks of size 2^( 5) =       0.000552710849
  error estimate for blocks of size 2^( 6) =       0.000556719135
  error estimate for blocks of size 2^( 7) =       0.000559684420

      target function =                  N/A
              le_mean =     -22.670468336162
             les_mean =     514.460565825954
             stat err =       0.000553551317
             autocorr =       1.233434896890
              std dev =       0.704879322384
             le_variance =       0.496854859124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496860056587
                                         uncertainty =       0.002951632233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496860056587
                                         uncertainty =       0.002951632233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498424949
  error estimate for blocks of size 2^( 2) =       0.000516495363
  error estimate for blocks of size 2^( 3) =       0.000532932346
  error estimate for blocks of size 2^( 4) =       0.000545090866
  error estimate for blocks of size 2^( 5) =       0.000552710849
  error estimate for blocks of size 2^( 6) =       0.000556719135
  error estimate for blocks of size 2^( 7) =       0.000559684420

      target function =                  N/A
              le_mean =     -22.670468336162
             les_mean =     514.460565825954
             stat err =       0.000553551317
             autocorr =       1.233434896890
              std dev =       0.704879322384
             le_variance =       0.496854859124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496860056587
                                         uncertainty =       0.002951632233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496860056587
                                         uncertainty =       0.002951632233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498424949
  error estimate for blocks of size 2^( 2) =       0.000516495363
  error estimate for blocks of size 2^( 3) =       0.000532932346
  error estimate for blocks of size 2^( 4) =       0.000545090866
  error estimate for blocks of size 2^( 5) =       0.000552710849
  error estimate for blocks of size 2^( 6) =       0.000556719135
  error estimate for blocks of size 2^( 7) =       0.000559684420

      target function =                  N/A
              le_mean =     -22.670468336162
             les_mean =     514.460565825954
             stat err =       0.000553551317
             autocorr =       1.233434896890
              std dev =       0.704879322384
             le_variance =       0.496854859124


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670468336162        initial  <--
     2.3842e+30     2.3842e+31             0.0000e+00       -22.670468336162
     9.5367e+30     9.5367e+31             0.0000e+00       -22.670468336162
     3.8147e+31     3.8147e+32             0.0000e+00       -22.670468336162

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8057
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4510e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6083
    reference variance = 0.387903
====================================================
  Execution time = 2.5949e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0221e-01
  Total weights = 1.955288234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490830800355
                                         uncertainty =       0.002518772518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490830800355
                                         uncertainty =       0.002518772518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495427457
  error estimate for blocks of size 2^( 2) =       0.000513631617
  error estimate for blocks of size 2^( 3) =       0.000529353427
  error estimate for blocks of size 2^( 4) =       0.000540863618
  error estimate for blocks of size 2^( 5) =       0.000547719156
  error estimate for blocks of size 2^( 6) =       0.000550848176
  error estimate for blocks of size 2^( 7) =       0.000551252131

      target function =                  N/A
              le_mean =     -22.668982699639
             les_mean =     514.384988864973
             stat err =       0.000547670770
             autocorr =       1.222021883066
              std dev =       0.700640228258
             le_variance =       0.490896729454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266898269964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+31, overlap shift 2.3842e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668982699706       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668982699706       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+31 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+31, overlap shift 9.5367e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668982699706       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668982699706       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+32, overlap shift 3.8147e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668982699706       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668982699706       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+32 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0702e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.5548
    reference variance = 1.36946
====================================================
  Execution time = 2.6052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1352e-01
  Total weights = 1.9548e+06
  Execution time = 3.6595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497601903406
                                         uncertainty =       0.002838876245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497601903406
                                         uncertainty =       0.002838876245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498799374
  error estimate for blocks of size 2^( 2) =       0.000516861362
  error estimate for blocks of size 2^( 3) =       0.000532298806
  error estimate for blocks of size 2^( 4) =       0.000544726629
  error estimate for blocks of size 2^( 5) =       0.000550553349
  error estimate for blocks of size 2^( 6) =       0.000555194522
  error estimate for blocks of size 2^( 7) =       0.000557834542

      target function =                  N/A
              le_mean =     -22.669702017257
             les_mean =     514.428904966311
             stat err =       0.000552077261
             autocorr =       1.225033372840
              std dev =       0.705408839066
             le_variance =       0.497601630232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497601903406
                                         uncertainty =       0.002838876245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497601903406
                                         uncertainty =       0.002838876245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498799374
  error estimate for blocks of size 2^( 2) =       0.000516861362
  error estimate for blocks of size 2^( 3) =       0.000532298806
  error estimate for blocks of size 2^( 4) =       0.000544726629
  error estimate for blocks of size 2^( 5) =       0.000550553349
  error estimate for blocks of size 2^( 6) =       0.000555194522
  error estimate for blocks of size 2^( 7) =       0.000557834542

      target function =                  N/A
              le_mean =     -22.669702017257
             les_mean =     514.428904966311
             stat err =       0.000552077261
             autocorr =       1.225033372840
              std dev =       0.705408839066
             le_variance =       0.497601630232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497601903406
                                         uncertainty =       0.002838876245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497601903406
                                         uncertainty =       0.002838876245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498799374
  error estimate for blocks of size 2^( 2) =       0.000516861362
  error estimate for blocks of size 2^( 3) =       0.000532298806
  error estimate for blocks of size 2^( 4) =       0.000544726629
  error estimate for blocks of size 2^( 5) =       0.000550553349
  error estimate for blocks of size 2^( 6) =       0.000555194522
  error estimate for blocks of size 2^( 7) =       0.000557834542

      target function =                  N/A
              le_mean =     -22.669702017257
             les_mean =     514.428904966311
             stat err =       0.000552077261
             autocorr =       1.225033372840
              std dev =       0.705408839066
             le_variance =       0.497601630232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497601903406
                                         uncertainty =       0.002838876245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497601903406
                                         uncertainty =       0.002838876245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498799374
  error estimate for blocks of size 2^( 2) =       0.000516861362
  error estimate for blocks of size 2^( 3) =       0.000532298806
  error estimate for blocks of size 2^( 4) =       0.000544726629
  error estimate for blocks of size 2^( 5) =       0.000550553349
  error estimate for blocks of size 2^( 6) =       0.000555194522
  error estimate for blocks of size 2^( 7) =       0.000557834542

      target function =                  N/A
              le_mean =     -22.669702017257
             les_mean =     514.428904966311
             stat err =       0.000552077261
             autocorr =       1.225033372840
              std dev =       0.705408839066
             le_variance =       0.497601630232


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669702017257        initial  <--
     2.3842e+31     2.3842e+32             0.0000e+00       -22.669702017257
     9.5367e+31     9.5367e+32             0.0000e+00       -22.669702017257
     3.8147e+32     3.8147e+33             0.0000e+00       -22.669702017257

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3059
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5014e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7284
    reference variance = 0.48445
====================================================
  Execution time = 2.7784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0578e-01
  Total weights = 1.955341004e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493625745794
                                         uncertainty =       0.002878436880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493625745794
                                         uncertainty =       0.002878436880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496777182
  error estimate for blocks of size 2^( 2) =       0.000514815852
  error estimate for blocks of size 2^( 3) =       0.000531522659
  error estimate for blocks of size 2^( 4) =       0.000543016605
  error estimate for blocks of size 2^( 5) =       0.000550589596
  error estimate for blocks of size 2^( 6) =       0.000554210544
  error estimate for blocks of size 2^( 7) =       0.000556491952

      target function =                  N/A
              le_mean =     -22.669523752446
             les_mean =     514.413090165893
             stat err =       0.000551077174
             autocorr =       1.230556523173
              std dev =       0.702549027677
             le_variance =       0.493575136289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266952375245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+32, overlap shift 2.3842e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669523752557       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669523752557       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669523752557       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669523753226       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+32 is 1.708289e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+32, overlap shift 9.5367e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669523752557       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669523752557       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669523752557       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669523753226       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+32 is 4.270722e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+33, overlap shift 3.8147e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669523752557       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669523752557       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+33 is 1.049004e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113997 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2604e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.6835
    reference variance = 0.592292
====================================================
  Execution time = 2.5261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1067e-01
  Total weights = 1.9553e+06
  Execution time = 3.6669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497236864259
                                         uncertainty =       0.002236755713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497236864259
                                         uncertainty =       0.002236755713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498641080
  error estimate for blocks of size 2^( 2) =       0.000516583033
  error estimate for blocks of size 2^( 3) =       0.000531953478
  error estimate for blocks of size 2^( 4) =       0.000543130560
  error estimate for blocks of size 2^( 5) =       0.000550882460
  error estimate for blocks of size 2^( 6) =       0.000554250062
  error estimate for blocks of size 2^( 7) =       0.000555153955

      target function =                  N/A
              le_mean =     -22.669151644436
             les_mean =     514.401104411530
             stat err =       0.000550854259
             autocorr =       1.220386274504
              std dev =       0.705184978070
             le_variance =       0.497285853295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497236864259
                                         uncertainty =       0.002236755713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497236864259
                                         uncertainty =       0.002236755713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498641080
  error estimate for blocks of size 2^( 2) =       0.000516583033
  error estimate for blocks of size 2^( 3) =       0.000531953478
  error estimate for blocks of size 2^( 4) =       0.000543130560
  error estimate for blocks of size 2^( 5) =       0.000550882460
  error estimate for blocks of size 2^( 6) =       0.000554250062
  error estimate for blocks of size 2^( 7) =       0.000555153955

      target function =                  N/A
              le_mean =     -22.669151644436
             les_mean =     514.401104411530
             stat err =       0.000550854259
             autocorr =       1.220386274504
              std dev =       0.705184978070
             le_variance =       0.497285853295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497236864259
                                         uncertainty =       0.002236755713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497236864259
                                         uncertainty =       0.002236755713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498641080
  error estimate for blocks of size 2^( 2) =       0.000516583033
  error estimate for blocks of size 2^( 3) =       0.000531953478
  error estimate for blocks of size 2^( 4) =       0.000543130560
  error estimate for blocks of size 2^( 5) =       0.000550882460
  error estimate for blocks of size 2^( 6) =       0.000554250062
  error estimate for blocks of size 2^( 7) =       0.000555153955

      target function =                  N/A
              le_mean =     -22.669151644436
             les_mean =     514.401104411530
             stat err =       0.000550854259
             autocorr =       1.220386274504
              std dev =       0.705184978070
             le_variance =       0.497285853295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497236864259
                                         uncertainty =       0.002236755713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497236864259
                                         uncertainty =       0.002236755713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498641080
  error estimate for blocks of size 2^( 2) =       0.000516583033
  error estimate for blocks of size 2^( 3) =       0.000531953478
  error estimate for blocks of size 2^( 4) =       0.000543130560
  error estimate for blocks of size 2^( 5) =       0.000550882460
  error estimate for blocks of size 2^( 6) =       0.000554250062
  error estimate for blocks of size 2^( 7) =       0.000555153955

      target function =                  N/A
              le_mean =     -22.669151644436
             les_mean =     514.401104411530
             stat err =       0.000550854259
             autocorr =       1.220386274504
              std dev =       0.705184978070
             le_variance =       0.497285853295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669151644436        initial  <--
     2.3842e+32     2.3842e+33             1.7083e-36       -22.669151644436
     9.5367e+32     9.5367e+33             4.2707e-37       -22.669151644436
     3.8147e+33     3.8147e+34             1.0490e-37       -22.669151644436

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5627
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6173e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.6976
    reference variance = 0.398862
====================================================
  Execution time = 2.6006e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0202e-01
  Total weights = 1.955116883e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493050844778
                                         uncertainty =       0.002712095259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493050844778
                                         uncertainty =       0.002712095259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496455862
  error estimate for blocks of size 2^( 2) =       0.000514459532
  error estimate for blocks of size 2^( 3) =       0.000530627452
  error estimate for blocks of size 2^( 4) =       0.000542626829
  error estimate for blocks of size 2^( 5) =       0.000550151540
  error estimate for blocks of size 2^( 6) =       0.000552425933
  error estimate for blocks of size 2^( 7) =       0.000554610429

      target function =                  N/A
              le_mean =     -22.669022549518
             les_mean =     514.386607824890
             stat err =       0.000549953683
             autocorr =       1.227131044380
              std dev =       0.702094613262
             le_variance =       0.492936845971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266902254952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+33, overlap shift 2.3842e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669022549601       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669022549601       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669022549601       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+33 is 2.124283e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+33, overlap shift 9.5367e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669022549601       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669022549601       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669022549642       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+33 is 5.310708e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+34, overlap shift 3.8147e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669022549601       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669022549601       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669022549642       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+34 is 1.327677e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115383 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0750e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.5984
    reference variance = 0.74239
====================================================
  Execution time = 2.5286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1325e-01
  Total weights = 1.9554e+06
  Execution time = 3.6728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496857902063
                                         uncertainty =       0.002679219394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496857902063
                                         uncertainty =       0.002679219394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498381265
  error estimate for blocks of size 2^( 2) =       0.000516041771
  error estimate for blocks of size 2^( 3) =       0.000532040482
  error estimate for blocks of size 2^( 4) =       0.000544031373
  error estimate for blocks of size 2^( 5) =       0.000551105498
  error estimate for blocks of size 2^( 6) =       0.000553897401
  error estimate for blocks of size 2^( 7) =       0.000555910884

      target function =                  N/A
              le_mean =     -22.670045078787
             les_mean =     514.444191826326
             stat err =       0.000551236289
             autocorr =       1.223354108341
              std dev =       0.704817544105
             le_variance =       0.496767770478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496857902063
                                         uncertainty =       0.002679219394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496857902063
                                         uncertainty =       0.002679219394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498381265
  error estimate for blocks of size 2^( 2) =       0.000516041771
  error estimate for blocks of size 2^( 3) =       0.000532040482
  error estimate for blocks of size 2^( 4) =       0.000544031373
  error estimate for blocks of size 2^( 5) =       0.000551105498
  error estimate for blocks of size 2^( 6) =       0.000553897401
  error estimate for blocks of size 2^( 7) =       0.000555910884

      target function =                  N/A
              le_mean =     -22.670045078787
             les_mean =     514.444191826326
             stat err =       0.000551236289
             autocorr =       1.223354108341
              std dev =       0.704817544105
             le_variance =       0.496767770478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496857902063
                                         uncertainty =       0.002679219394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496857902063
                                         uncertainty =       0.002679219394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498381265
  error estimate for blocks of size 2^( 2) =       0.000516041771
  error estimate for blocks of size 2^( 3) =       0.000532040482
  error estimate for blocks of size 2^( 4) =       0.000544031373
  error estimate for blocks of size 2^( 5) =       0.000551105498
  error estimate for blocks of size 2^( 6) =       0.000553897401
  error estimate for blocks of size 2^( 7) =       0.000555910884

      target function =                  N/A
              le_mean =     -22.670045078787
             les_mean =     514.444191826326
             stat err =       0.000551236289
             autocorr =       1.223354108341
              std dev =       0.704817544105
             le_variance =       0.496767770478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496857902063
                                         uncertainty =       0.002679219394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496857902063
                                         uncertainty =       0.002679219394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498381265
  error estimate for blocks of size 2^( 2) =       0.000516041771
  error estimate for blocks of size 2^( 3) =       0.000532040482
  error estimate for blocks of size 2^( 4) =       0.000544031373
  error estimate for blocks of size 2^( 5) =       0.000551105498
  error estimate for blocks of size 2^( 6) =       0.000553897401
  error estimate for blocks of size 2^( 7) =       0.000555910884

      target function =                  N/A
              le_mean =     -22.670045078787
             les_mean =     514.444191826326
             stat err =       0.000551236289
             autocorr =       1.223354108341
              std dev =       0.704817544105
             le_variance =       0.496767770478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670045078787        initial  <--
     2.3842e+33     2.3842e+34             2.1243e-37       -22.670045078787
     9.5367e+33     9.5367e+34             5.3107e-38       -22.670045078787
     3.8147e+34     3.8147e+35             1.3277e-38       -22.670045078787

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6016
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4357e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.6705
    reference variance = 0.402544
====================================================
  Execution time = 2.5885e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1173e-01
  Total weights = 1.955106189e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499048363200
                                         uncertainty =       0.003239199945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499048363200
                                         uncertainty =       0.003239199945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499493969
  error estimate for blocks of size 2^( 2) =       0.000517451519
  error estimate for blocks of size 2^( 3) =       0.000532948700
  error estimate for blocks of size 2^( 4) =       0.000544256347
  error estimate for blocks of size 2^( 5) =       0.000550453159
  error estimate for blocks of size 2^( 6) =       0.000554875261
  error estimate for blocks of size 2^( 7) =       0.000559078739

      target function =                  N/A
              le_mean =     -22.670301958828
             les_mean =     514.454322856687
             stat err =       0.000552165876
             autocorr =       1.222020890261
              std dev =       0.706391145405
             le_variance =       0.498988450307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267030195883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+34, overlap shift 2.3842e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670301958916       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670301958916       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+34, overlap shift 9.5367e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670301958916       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670301958916       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+35, overlap shift 3.8147e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670301958916       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670301958916       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0689e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.7132
    reference variance = 0.287273
====================================================
  Execution time = 2.5348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0738e-01
  Total weights = 1.9553e+06
  Execution time = 3.6602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497075258301
                                         uncertainty =       0.003061582957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497075258301
                                         uncertainty =       0.003061582957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498560742
  error estimate for blocks of size 2^( 2) =       0.000516413550
  error estimate for blocks of size 2^( 3) =       0.000533358279
  error estimate for blocks of size 2^( 4) =       0.000545295415
  error estimate for blocks of size 2^( 5) =       0.000552201484
  error estimate for blocks of size 2^( 6) =       0.000556850399
  error estimate for blocks of size 2^( 7) =       0.000560030075

      target function =                  N/A
              le_mean =     -22.669994257173
             les_mean =     514.436023517948
             stat err =       0.000553594343
             autocorr =       1.232954731964
              std dev =       0.705071362832
             le_variance =       0.497125626685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497075258301
                                         uncertainty =       0.003061582957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497075258301
                                         uncertainty =       0.003061582957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498560742
  error estimate for blocks of size 2^( 2) =       0.000516413550
  error estimate for blocks of size 2^( 3) =       0.000533358279
  error estimate for blocks of size 2^( 4) =       0.000545295415
  error estimate for blocks of size 2^( 5) =       0.000552201484
  error estimate for blocks of size 2^( 6) =       0.000556850399
  error estimate for blocks of size 2^( 7) =       0.000560030075

      target function =                  N/A
              le_mean =     -22.669994257173
             les_mean =     514.436023517948
             stat err =       0.000553594343
             autocorr =       1.232954731964
              std dev =       0.705071362832
             le_variance =       0.497125626685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497075258301
                                         uncertainty =       0.003061582957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497075258301
                                         uncertainty =       0.003061582957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498560742
  error estimate for blocks of size 2^( 2) =       0.000516413550
  error estimate for blocks of size 2^( 3) =       0.000533358279
  error estimate for blocks of size 2^( 4) =       0.000545295415
  error estimate for blocks of size 2^( 5) =       0.000552201484
  error estimate for blocks of size 2^( 6) =       0.000556850399
  error estimate for blocks of size 2^( 7) =       0.000560030075

      target function =                  N/A
              le_mean =     -22.669994257173
             les_mean =     514.436023517948
             stat err =       0.000553594343
             autocorr =       1.232954731964
              std dev =       0.705071362832
             le_variance =       0.497125626685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497075258301
                                         uncertainty =       0.003061582957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497075258301
                                         uncertainty =       0.003061582957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498560742
  error estimate for blocks of size 2^( 2) =       0.000516413550
  error estimate for blocks of size 2^( 3) =       0.000533358279
  error estimate for blocks of size 2^( 4) =       0.000545295415
  error estimate for blocks of size 2^( 5) =       0.000552201484
  error estimate for blocks of size 2^( 6) =       0.000556850399
  error estimate for blocks of size 2^( 7) =       0.000560030075

      target function =                  N/A
              le_mean =     -22.669994257173
             les_mean =     514.436023517948
             stat err =       0.000553594343
             autocorr =       1.232954731964
              std dev =       0.705071362832
             le_variance =       0.497125626685


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669994257173        initial  <--
     2.3842e+34     2.3842e+35             0.0000e+00       -22.669994257173
     9.5367e+34     9.5367e+35             0.0000e+00       -22.669994257173
     3.8147e+35     3.8147e+36             0.0000e+00       -22.669994257173

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6133
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.563
    reference variance = 0.522097
====================================================
  Execution time = 2.5983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0725e-01
  Total weights = 1.955134649e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493546476421
                                         uncertainty =       0.002487624232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493546476421
                                         uncertainty =       0.002487624232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496778753
  error estimate for blocks of size 2^( 2) =       0.000515136372
  error estimate for blocks of size 2^( 3) =       0.000530989633
  error estimate for blocks of size 2^( 4) =       0.000542785069
  error estimate for blocks of size 2^( 5) =       0.000549156130
  error estimate for blocks of size 2^( 6) =       0.000550635417
  error estimate for blocks of size 2^( 7) =       0.000551404491

      target function =                  N/A
              le_mean =     -22.670007728918
             les_mean =     514.436501475738
             stat err =       0.000548495277
             autocorr =       1.219045059309
              std dev =       0.702551249614
             le_variance =       0.493578258334


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267000772892e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+35, overlap shift 2.3842e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670007729020       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670007729020       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+35, overlap shift 9.5367e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670007729020       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670007729020       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+36, overlap shift 3.8147e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670007729020       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670007729020       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0758e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.6422
    reference variance = 0.417315
====================================================
  Execution time = 2.5347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0749e-01
  Total weights = 1.9548e+06
  Execution time = 3.6733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496302735100
                                         uncertainty =       0.002613452019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496302735100
                                         uncertainty =       0.002613452019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498142391
  error estimate for blocks of size 2^( 2) =       0.000516381728
  error estimate for blocks of size 2^( 3) =       0.000532231814
  error estimate for blocks of size 2^( 4) =       0.000543741668
  error estimate for blocks of size 2^( 5) =       0.000550330223
  error estimate for blocks of size 2^( 6) =       0.000553611922
  error estimate for blocks of size 2^( 7) =       0.000553201973

      target function =                  N/A
              le_mean =     -22.668733153122
             les_mean =     514.378951411105
             stat err =       0.000550221446
             autocorr =       1.220023023306
              std dev =       0.704479725527
             le_variance =       0.496291683679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496302735100
                                         uncertainty =       0.002613452019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496302735100
                                         uncertainty =       0.002613452019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498142391
  error estimate for blocks of size 2^( 2) =       0.000516381728
  error estimate for blocks of size 2^( 3) =       0.000532231814
  error estimate for blocks of size 2^( 4) =       0.000543741668
  error estimate for blocks of size 2^( 5) =       0.000550330223
  error estimate for blocks of size 2^( 6) =       0.000553611922
  error estimate for blocks of size 2^( 7) =       0.000553201973

      target function =                  N/A
              le_mean =     -22.668733153122
             les_mean =     514.378951411105
             stat err =       0.000550221446
             autocorr =       1.220023023306
              std dev =       0.704479725527
             le_variance =       0.496291683679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496302735100
                                         uncertainty =       0.002613452019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496302735100
                                         uncertainty =       0.002613452019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498142391
  error estimate for blocks of size 2^( 2) =       0.000516381728
  error estimate for blocks of size 2^( 3) =       0.000532231814
  error estimate for blocks of size 2^( 4) =       0.000543741668
  error estimate for blocks of size 2^( 5) =       0.000550330223
  error estimate for blocks of size 2^( 6) =       0.000553611922
  error estimate for blocks of size 2^( 7) =       0.000553201973

      target function =                  N/A
              le_mean =     -22.668733153122
             les_mean =     514.378951411105
             stat err =       0.000550221446
             autocorr =       1.220023023306
              std dev =       0.704479725527
             le_variance =       0.496291683679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496302735100
                                         uncertainty =       0.002613452019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496302735100
                                         uncertainty =       0.002613452019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498142391
  error estimate for blocks of size 2^( 2) =       0.000516381728
  error estimate for blocks of size 2^( 3) =       0.000532231814
  error estimate for blocks of size 2^( 4) =       0.000543741668
  error estimate for blocks of size 2^( 5) =       0.000550330223
  error estimate for blocks of size 2^( 6) =       0.000553611922
  error estimate for blocks of size 2^( 7) =       0.000553201973

      target function =                  N/A
              le_mean =     -22.668733153122
             les_mean =     514.378951411105
             stat err =       0.000550221446
             autocorr =       1.220023023306
              std dev =       0.704479725527
             le_variance =       0.496291683679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668733153122        initial  <--
     2.3842e+35     2.3842e+36             0.0000e+00       -22.668733153122
     9.5367e+35     9.5367e+36             0.0000e+00       -22.668733153122
     3.8147e+36     3.8147e+37             0.0000e+00       -22.668733153122

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6418
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.7785
    reference variance = 0.620032
====================================================
  Execution time = 2.7907e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0427e-01
  Total weights = 1.955044123e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492192955127
                                         uncertainty =       0.002322086534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492192955127
                                         uncertainty =       0.002322086534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496123482
  error estimate for blocks of size 2^( 2) =       0.000514290691
  error estimate for blocks of size 2^( 3) =       0.000530506860
  error estimate for blocks of size 2^( 4) =       0.000541284665
  error estimate for blocks of size 2^( 5) =       0.000547935686
  error estimate for blocks of size 2^( 6) =       0.000551063168
  error estimate for blocks of size 2^( 7) =       0.000552641776

      target function =                  N/A
              le_mean =     -22.669964070631
             les_mean =     514.431542035502
             stat err =       0.000548231324
             autocorr =       1.221091268591
              std dev =       0.701624556516
             le_variance =       0.492277018306


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266996407063e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+36, overlap shift 2.3842e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669964070728       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669964070728       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+36, overlap shift 9.5367e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669964070728       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669964070728       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+37, overlap shift 3.8147e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669964070728       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669964070728       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2692e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.7575
    reference variance = 0.504024
====================================================
  Execution time = 2.5294e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1545e-01
  Total weights = 1.9549e+06
  Execution time = 3.6548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500997017956
                                         uncertainty =       0.003787512330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500997017956
                                         uncertainty =       0.003787512330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500495277
  error estimate for blocks of size 2^( 2) =       0.000518876031
  error estimate for blocks of size 2^( 3) =       0.000534899932
  error estimate for blocks of size 2^( 4) =       0.000546657144
  error estimate for blocks of size 2^( 5) =       0.000553840371
  error estimate for blocks of size 2^( 6) =       0.000558154344
  error estimate for blocks of size 2^( 7) =       0.000559267995

      target function =                  N/A
              le_mean =     -22.670176911819
             les_mean =     514.452374410311
             stat err =       0.000554479963
             autocorr =       1.227359383787
              std dev =       0.707807208640
             le_variance =       0.500991044602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500997017956
                                         uncertainty =       0.003787512330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500997017956
                                         uncertainty =       0.003787512330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500495277
  error estimate for blocks of size 2^( 2) =       0.000518876031
  error estimate for blocks of size 2^( 3) =       0.000534899932
  error estimate for blocks of size 2^( 4) =       0.000546657144
  error estimate for blocks of size 2^( 5) =       0.000553840371
  error estimate for blocks of size 2^( 6) =       0.000558154344
  error estimate for blocks of size 2^( 7) =       0.000559267995

      target function =                  N/A
              le_mean =     -22.670176911819
             les_mean =     514.452374410311
             stat err =       0.000554479963
             autocorr =       1.227359383787
              std dev =       0.707807208640
             le_variance =       0.500991044602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500997017956
                                         uncertainty =       0.003787512330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500997017956
                                         uncertainty =       0.003787512330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500495277
  error estimate for blocks of size 2^( 2) =       0.000518876031
  error estimate for blocks of size 2^( 3) =       0.000534899932
  error estimate for blocks of size 2^( 4) =       0.000546657144
  error estimate for blocks of size 2^( 5) =       0.000553840371
  error estimate for blocks of size 2^( 6) =       0.000558154344
  error estimate for blocks of size 2^( 7) =       0.000559267995

      target function =                  N/A
              le_mean =     -22.670176911819
             les_mean =     514.452374410311
             stat err =       0.000554479963
             autocorr =       1.227359383787
              std dev =       0.707807208640
             le_variance =       0.500991044602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500997017956
                                         uncertainty =       0.003787512330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500997017956
                                         uncertainty =       0.003787512330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500495277
  error estimate for blocks of size 2^( 2) =       0.000518876031
  error estimate for blocks of size 2^( 3) =       0.000534899932
  error estimate for blocks of size 2^( 4) =       0.000546657144
  error estimate for blocks of size 2^( 5) =       0.000553840371
  error estimate for blocks of size 2^( 6) =       0.000558154344
  error estimate for blocks of size 2^( 7) =       0.000559267995

      target function =                  N/A
              le_mean =     -22.670176911819
             les_mean =     514.452374410311
             stat err =       0.000554479963
             autocorr =       1.227359383787
              std dev =       0.707807208640
             le_variance =       0.500991044602


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670176911819        initial  <--
     2.3842e+36     2.3842e+37             0.0000e+00       -22.670176911819
     9.5367e+36     9.5367e+37             0.0000e+00       -22.670176911819
     3.8147e+37     3.8147e+38             0.0000e+00       -22.670176911819

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5827
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6280e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.599
    reference variance = 0.402163
====================================================
  Execution time = 2.6115e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0756e-01
  Total weights = 1.955010123e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497241387168
                                         uncertainty =       0.002754992828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497241387168
                                         uncertainty =       0.002754992828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498585606
  error estimate for blocks of size 2^( 2) =       0.000516521956
  error estimate for blocks of size 2^( 3) =       0.000532658246
  error estimate for blocks of size 2^( 4) =       0.000543759494
  error estimate for blocks of size 2^( 5) =       0.000550101665
  error estimate for blocks of size 2^( 6) =       0.000554229740
  error estimate for blocks of size 2^( 7) =       0.000553191588

      target function =                  N/A
              le_mean =     -22.669748449033
             les_mean =     514.425059331084
             stat err =       0.000550320622
             autocorr =       1.218293987003
              std dev =       0.705106526667
             le_variance =       0.497175213949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266974844903e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+37, overlap shift 2.3842e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669748449141       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669748449141       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+37, overlap shift 9.5367e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669748449141       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669748449141       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+38, overlap shift 3.8147e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669748449141       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669748449141       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0912e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.7826
    reference variance = 0.373819
====================================================
  Execution time = 2.5366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1016e-01
  Total weights = 1.9553e+06
  Execution time = 3.6654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498678206288
                                         uncertainty =       0.002811874074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498678206288
                                         uncertainty =       0.002811874074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499341742
  error estimate for blocks of size 2^( 2) =       0.000516908609
  error estimate for blocks of size 2^( 3) =       0.000532866989
  error estimate for blocks of size 2^( 4) =       0.000543479250
  error estimate for blocks of size 2^( 5) =       0.000549825117
  error estimate for blocks of size 2^( 6) =       0.000552431950
  error estimate for blocks of size 2^( 7) =       0.000556331643

      target function =                  N/A
              le_mean =     -22.669417429094
             les_mean =     514.412646671766
             stat err =       0.000550516990
             autocorr =       1.215474100364
              std dev =       0.706175863679
             le_variance =       0.498684350442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498678206288
                                         uncertainty =       0.002811874074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498678206288
                                         uncertainty =       0.002811874074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499341742
  error estimate for blocks of size 2^( 2) =       0.000516908609
  error estimate for blocks of size 2^( 3) =       0.000532866989
  error estimate for blocks of size 2^( 4) =       0.000543479250
  error estimate for blocks of size 2^( 5) =       0.000549825117
  error estimate for blocks of size 2^( 6) =       0.000552431950
  error estimate for blocks of size 2^( 7) =       0.000556331643

      target function =                  N/A
              le_mean =     -22.669417429094
             les_mean =     514.412646671766
             stat err =       0.000550516990
             autocorr =       1.215474100364
              std dev =       0.706175863679
             le_variance =       0.498684350442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498678206288
                                         uncertainty =       0.002811874074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498678206288
                                         uncertainty =       0.002811874074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499341742
  error estimate for blocks of size 2^( 2) =       0.000516908609
  error estimate for blocks of size 2^( 3) =       0.000532866989
  error estimate for blocks of size 2^( 4) =       0.000543479250
  error estimate for blocks of size 2^( 5) =       0.000549825117
  error estimate for blocks of size 2^( 6) =       0.000552431950
  error estimate for blocks of size 2^( 7) =       0.000556331643

      target function =                  N/A
              le_mean =     -22.669417429094
             les_mean =     514.412646671766
             stat err =       0.000550516990
             autocorr =       1.215474100364
              std dev =       0.706175863679
             le_variance =       0.498684350442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498678206288
                                         uncertainty =       0.002811874074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498678206288
                                         uncertainty =       0.002811874074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499341742
  error estimate for blocks of size 2^( 2) =       0.000516908609
  error estimate for blocks of size 2^( 3) =       0.000532866989
  error estimate for blocks of size 2^( 4) =       0.000543479250
  error estimate for blocks of size 2^( 5) =       0.000549825117
  error estimate for blocks of size 2^( 6) =       0.000552431950
  error estimate for blocks of size 2^( 7) =       0.000556331643

      target function =                  N/A
              le_mean =     -22.669417429094
             les_mean =     514.412646671766
             stat err =       0.000550516990
             autocorr =       1.215474100364
              std dev =       0.706175863679
             le_variance =       0.498684350442


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669417429094        initial  <--
     2.3842e+37     2.3842e+38             0.0000e+00       -22.669417429094
     9.5367e+37     9.5367e+38             0.0000e+00       -22.669417429094
     3.8147e+38     3.8147e+39             0.0000e+00       -22.669417429094

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6635
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.6827
    reference variance = 0.635163
====================================================
  Execution time = 2.5930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.3403e-01
  Total weights = 1.954991785e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514385510948
                                         uncertainty =       0.012864728434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514385510948
                                         uncertainty =       0.012864728434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507147151
  error estimate for blocks of size 2^( 2) =       0.000524609894
  error estimate for blocks of size 2^( 3) =       0.000540692843
  error estimate for blocks of size 2^( 4) =       0.000552247474
  error estimate for blocks of size 2^( 5) =       0.000558418047
  error estimate for blocks of size 2^( 6) =       0.000561059314
  error estimate for blocks of size 2^( 7) =       0.000565908465

      target function =                  N/A
              le_mean =     -22.670366402978
             les_mean =     514.479540892075
             stat err =       0.000559408325
             autocorr =       1.216717821854
              std dev =       0.717214379614
             le_variance =       0.514396466325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267036640298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+38, overlap shift 2.3842e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670366403118       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670366403118       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+38, overlap shift 9.5367e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670366403118       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670366403118       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+39, overlap shift 3.8147e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670366403118       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670366403118       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0722e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.7989
    reference variance = 1.19281
====================================================
  Execution time = 2.5332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.0572e-01
  Total weights = 1.9549e+06
  Execution time = 3.6581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495087396331
                                         uncertainty =       0.002438773855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495087396331
                                         uncertainty =       0.002438773855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497547905
  error estimate for blocks of size 2^( 2) =       0.000515898682
  error estimate for blocks of size 2^( 3) =       0.000532554157
  error estimate for blocks of size 2^( 4) =       0.000544070246
  error estimate for blocks of size 2^( 5) =       0.000548063462
  error estimate for blocks of size 2^( 6) =       0.000551484180
  error estimate for blocks of size 2^( 7) =       0.000555550900

      target function =                  N/A
              le_mean =     -22.670511453641
             les_mean =     514.457814532929
             stat err =       0.000549792197
             autocorr =       1.221032829531
              std dev =       0.703638994480
             le_variance =       0.495107834552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495087396331
                                         uncertainty =       0.002438773855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495087396331
                                         uncertainty =       0.002438773855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497547905
  error estimate for blocks of size 2^( 2) =       0.000515898682
  error estimate for blocks of size 2^( 3) =       0.000532554157
  error estimate for blocks of size 2^( 4) =       0.000544070246
  error estimate for blocks of size 2^( 5) =       0.000548063462
  error estimate for blocks of size 2^( 6) =       0.000551484180
  error estimate for blocks of size 2^( 7) =       0.000555550900

      target function =                  N/A
              le_mean =     -22.670511453641
             les_mean =     514.457814532929
             stat err =       0.000549792197
             autocorr =       1.221032829531
              std dev =       0.703638994480
             le_variance =       0.495107834552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495087396331
                                         uncertainty =       0.002438773855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495087396331
                                         uncertainty =       0.002438773855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497547905
  error estimate for blocks of size 2^( 2) =       0.000515898682
  error estimate for blocks of size 2^( 3) =       0.000532554157
  error estimate for blocks of size 2^( 4) =       0.000544070246
  error estimate for blocks of size 2^( 5) =       0.000548063462
  error estimate for blocks of size 2^( 6) =       0.000551484180
  error estimate for blocks of size 2^( 7) =       0.000555550900

      target function =                  N/A
              le_mean =     -22.670511453641
             les_mean =     514.457814532929
             stat err =       0.000549792197
             autocorr =       1.221032829531
              std dev =       0.703638994480
             le_variance =       0.495107834552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495087396331
                                         uncertainty =       0.002438773855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495087396331
                                         uncertainty =       0.002438773855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497547905
  error estimate for blocks of size 2^( 2) =       0.000515898682
  error estimate for blocks of size 2^( 3) =       0.000532554157
  error estimate for blocks of size 2^( 4) =       0.000544070246
  error estimate for blocks of size 2^( 5) =       0.000548063462
  error estimate for blocks of size 2^( 6) =       0.000551484180
  error estimate for blocks of size 2^( 7) =       0.000555550900

      target function =                  N/A
              le_mean =     -22.670511453641
             les_mean =     514.457814532929
             stat err =       0.000549792197
             autocorr =       1.221032829531
              std dev =       0.703638994480
             le_variance =       0.495107834552


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670511453641        initial  <--
     2.3842e+38     2.3842e+39             0.0000e+00       -22.670511453641
     9.5367e+38     9.5367e+39             0.0000e+00       -22.670511453641
     3.8147e+39     3.8147e+40             0.0000e+00       -22.670511453641

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6243
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4352e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.6917
    reference variance = 0.4307
====================================================
  Execution time = 2.6264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0692e-01
  Total weights = 1.955458392e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496048767509
                                         uncertainty =       0.002517336012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496048767509
                                         uncertainty =       0.002517336012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498009185
  error estimate for blocks of size 2^( 2) =       0.000516242756
  error estimate for blocks of size 2^( 3) =       0.000532207442
  error estimate for blocks of size 2^( 4) =       0.000544048082
  error estimate for blocks of size 2^( 5) =       0.000551354904
  error estimate for blocks of size 2^( 6) =       0.000555448900
  error estimate for blocks of size 2^( 7) =       0.000553406845

      target function =                  N/A
              le_mean =     -22.669151626147
             les_mean =     514.397357623767
             stat err =       0.000551064683
             autocorr =       1.224420100995
              std dev =       0.704291344084
             le_variance =       0.496026297351


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266915162615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+39, overlap shift 2.3842e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669151626234       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669151626234       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+39, overlap shift 9.5367e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669151626234       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669151626234       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+40, overlap shift 3.8147e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669151626234       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669151626234       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1060e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.7275
    reference variance = 0.345389
====================================================
  Execution time = 2.5447e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0921e-01
  Total weights = 1.9556e+06
  Execution time = 3.6537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493555016867
                                         uncertainty =       0.002764021878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493555016867
                                         uncertainty =       0.002764021878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496774826
  error estimate for blocks of size 2^( 2) =       0.000514769409
  error estimate for blocks of size 2^( 3) =       0.000530950079
  error estimate for blocks of size 2^( 4) =       0.000542774493
  error estimate for blocks of size 2^( 5) =       0.000548885344
  error estimate for blocks of size 2^( 6) =       0.000552922727
  error estimate for blocks of size 2^( 7) =       0.000555109429

      target function =                  N/A
              le_mean =     -22.669179257388
             les_mean =     514.400902431005
             stat err =       0.000549922998
             autocorr =       1.225418988886
              std dev =       0.702545696011
             le_variance =       0.493570454983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493555016867
                                         uncertainty =       0.002764021878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493555016867
                                         uncertainty =       0.002764021878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496774826
  error estimate for blocks of size 2^( 2) =       0.000514769409
  error estimate for blocks of size 2^( 3) =       0.000530950079
  error estimate for blocks of size 2^( 4) =       0.000542774493
  error estimate for blocks of size 2^( 5) =       0.000548885344
  error estimate for blocks of size 2^( 6) =       0.000552922727
  error estimate for blocks of size 2^( 7) =       0.000555109429

      target function =                  N/A
              le_mean =     -22.669179257388
             les_mean =     514.400902431005
             stat err =       0.000549922998
             autocorr =       1.225418988886
              std dev =       0.702545696011
             le_variance =       0.493570454983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493555016867
                                         uncertainty =       0.002764021878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493555016867
                                         uncertainty =       0.002764021878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496774826
  error estimate for blocks of size 2^( 2) =       0.000514769409
  error estimate for blocks of size 2^( 3) =       0.000530950079
  error estimate for blocks of size 2^( 4) =       0.000542774493
  error estimate for blocks of size 2^( 5) =       0.000548885344
  error estimate for blocks of size 2^( 6) =       0.000552922727
  error estimate for blocks of size 2^( 7) =       0.000555109429

      target function =                  N/A
              le_mean =     -22.669179257388
             les_mean =     514.400902431005
             stat err =       0.000549922998
             autocorr =       1.225418988886
              std dev =       0.702545696011
             le_variance =       0.493570454983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493555016867
                                         uncertainty =       0.002764021878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493555016867
                                         uncertainty =       0.002764021878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496774826
  error estimate for blocks of size 2^( 2) =       0.000514769409
  error estimate for blocks of size 2^( 3) =       0.000530950079
  error estimate for blocks of size 2^( 4) =       0.000542774493
  error estimate for blocks of size 2^( 5) =       0.000548885344
  error estimate for blocks of size 2^( 6) =       0.000552922727
  error estimate for blocks of size 2^( 7) =       0.000555109429

      target function =                  N/A
              le_mean =     -22.669179257388
             les_mean =     514.400902431005
             stat err =       0.000549922998
             autocorr =       1.225418988886
              std dev =       0.702545696011
             le_variance =       0.493570454983


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669179257388        initial  <--
     2.3842e+39     2.3842e+40             0.0000e+00       -22.669179257388
     9.5367e+39     9.5367e+40             0.0000e+00       -22.669179257388
     3.8147e+40     3.8147e+41             0.0000e+00       -22.669179257388

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6872
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7013
    reference variance = 0.304632
====================================================
  Execution time = 2.8096e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0568e-01
  Total weights = 1.955206785e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493120509129
                                         uncertainty =       0.002468733138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493120509129
                                         uncertainty =       0.002468733138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496551592
  error estimate for blocks of size 2^( 2) =       0.000514101579
  error estimate for blocks of size 2^( 3) =       0.000529893452
  error estimate for blocks of size 2^( 4) =       0.000541260955
  error estimate for blocks of size 2^( 5) =       0.000547291590
  error estimate for blocks of size 2^( 6) =       0.000550933406
  error estimate for blocks of size 2^( 7) =       0.000553434724

      target function =                  N/A
              le_mean =     -22.669632122189
             les_mean =     514.417905051306
             stat err =       0.000548230169
             autocorr =       1.218981473570
              std dev =       0.702229995400
             le_variance =       0.493126966439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266963212219e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+40, overlap shift 2.3842e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669632122265       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669632122265       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669632122265       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669632122265       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+40 is 1.778648e-44

solving harmonic davidson linear method for identity shift 9.5367e+40, overlap shift 9.5367e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669632122265       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669632122265       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669631958008       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+40 is 4.470576e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+41, overlap shift 3.8147e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669632122265       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669632122265       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669632122265       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669632122265       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+41 is 1.111655e-45

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2904e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7815
    reference variance = 0.526985
====================================================
  Execution time = 2.5406e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0150e-01
  Total weights = 1.9554e+06
  Execution time = 3.6439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490782451419
                                         uncertainty =       0.002536333646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490782451419
                                         uncertainty =       0.002536333646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495346703
  error estimate for blocks of size 2^( 2) =       0.000513064517
  error estimate for blocks of size 2^( 3) =       0.000529195226
  error estimate for blocks of size 2^( 4) =       0.000541366150
  error estimate for blocks of size 2^( 5) =       0.000548824202
  error estimate for blocks of size 2^( 6) =       0.000552364761
  error estimate for blocks of size 2^( 7) =       0.000554567098

      target function =                  N/A
              le_mean =     -22.668928797718
             les_mean =     514.381833219592
             stat err =       0.000549280553
             autocorr =       1.229617095575
              std dev =       0.700526025729
             le_variance =       0.490736712723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490782451419
                                         uncertainty =       0.002536333646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490782451419
                                         uncertainty =       0.002536333646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495346703
  error estimate for blocks of size 2^( 2) =       0.000513064517
  error estimate for blocks of size 2^( 3) =       0.000529195226
  error estimate for blocks of size 2^( 4) =       0.000541366150
  error estimate for blocks of size 2^( 5) =       0.000548824202
  error estimate for blocks of size 2^( 6) =       0.000552364761
  error estimate for blocks of size 2^( 7) =       0.000554567098

      target function =                  N/A
              le_mean =     -22.668928797718
             les_mean =     514.381833219592
             stat err =       0.000549280553
             autocorr =       1.229617095575
              std dev =       0.700526025729
             le_variance =       0.490736712723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490782451419
                                         uncertainty =       0.002536333646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490782451419
                                         uncertainty =       0.002536333646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495346703
  error estimate for blocks of size 2^( 2) =       0.000513064517
  error estimate for blocks of size 2^( 3) =       0.000529195226
  error estimate for blocks of size 2^( 4) =       0.000541366150
  error estimate for blocks of size 2^( 5) =       0.000548824202
  error estimate for blocks of size 2^( 6) =       0.000552364761
  error estimate for blocks of size 2^( 7) =       0.000554567098

      target function =                  N/A
              le_mean =     -22.668928797718
             les_mean =     514.381833219592
             stat err =       0.000549280553
             autocorr =       1.229617095575
              std dev =       0.700526025729
             le_variance =       0.490736712723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490782451419
                                         uncertainty =       0.002536333646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490782451419
                                         uncertainty =       0.002536333646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495346703
  error estimate for blocks of size 2^( 2) =       0.000513064517
  error estimate for blocks of size 2^( 3) =       0.000529195226
  error estimate for blocks of size 2^( 4) =       0.000541366150
  error estimate for blocks of size 2^( 5) =       0.000548824202
  error estimate for blocks of size 2^( 6) =       0.000552364761
  error estimate for blocks of size 2^( 7) =       0.000554567098

      target function =                  N/A
              le_mean =     -22.668928797718
             les_mean =     514.381833219592
             stat err =       0.000549280553
             autocorr =       1.229617095575
              std dev =       0.700526025729
             le_variance =       0.490736712723


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668928797718        initial  <--
     2.3842e+40     2.3842e+41             1.7786e-44       -22.668928797718
     9.5367e+40     9.5367e+41             4.4706e-45       -22.668928797718
     3.8147e+41     3.8147e+42             1.1117e-45       -22.668928797718

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6814
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6590e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.6477
    reference variance = 0.395011
====================================================
  Execution time = 2.6210e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0813e-01
  Total weights = 1.955187911e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493296738997
                                         uncertainty =       0.002333316209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493296738997
                                         uncertainty =       0.002333316209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496627964
  error estimate for blocks of size 2^( 2) =       0.000514716588
  error estimate for blocks of size 2^( 3) =       0.000530826101
  error estimate for blocks of size 2^( 4) =       0.000542193049
  error estimate for blocks of size 2^( 5) =       0.000549138559
  error estimate for blocks of size 2^( 6) =       0.000550695681
  error estimate for blocks of size 2^( 7) =       0.000550344143

      target function =                  N/A
              le_mean =     -22.669947019722
             les_mean =     514.434624867773
             stat err =       0.000548092858
             autocorr =       1.217996235907
              std dev =       0.702338001606
             le_variance =       0.493278668500


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266994701972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+41, overlap shift 2.3842e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669947019813       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669947019813       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+41, overlap shift 9.5367e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669947019813       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669947019813       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+42, overlap shift 3.8147e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669947019813       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669947019813       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1000e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.6373
    reference variance = 0.484375
====================================================
  Execution time = 2.6317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0202e-01
  Total weights = 1.9551e+06
  Execution time = 3.6322e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491649265124
                                         uncertainty =       0.002617681934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491649265124
                                         uncertainty =       0.002617681934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495827113
  error estimate for blocks of size 2^( 2) =       0.000514068733
  error estimate for blocks of size 2^( 3) =       0.000530427686
  error estimate for blocks of size 2^( 4) =       0.000542223066
  error estimate for blocks of size 2^( 5) =       0.000550577286
  error estimate for blocks of size 2^( 6) =       0.000557505145
  error estimate for blocks of size 2^( 7) =       0.000561187737

      target function =                  N/A
              le_mean =     -22.668064736722
             les_mean =     514.343183670593
             stat err =       0.000552873308
             autocorr =       1.243342287281
              std dev =       0.701205427542
             le_variance =       0.491689051615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491649265124
                                         uncertainty =       0.002617681934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491649265124
                                         uncertainty =       0.002617681934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495827113
  error estimate for blocks of size 2^( 2) =       0.000514068733
  error estimate for blocks of size 2^( 3) =       0.000530427686
  error estimate for blocks of size 2^( 4) =       0.000542223066
  error estimate for blocks of size 2^( 5) =       0.000550577286
  error estimate for blocks of size 2^( 6) =       0.000557505145
  error estimate for blocks of size 2^( 7) =       0.000561187737

      target function =                  N/A
              le_mean =     -22.668064736722
             les_mean =     514.343183670593
             stat err =       0.000552873308
             autocorr =       1.243342287281
              std dev =       0.701205427542
             le_variance =       0.491689051615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491649265124
                                         uncertainty =       0.002617681934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491649265124
                                         uncertainty =       0.002617681934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495827113
  error estimate for blocks of size 2^( 2) =       0.000514068733
  error estimate for blocks of size 2^( 3) =       0.000530427686
  error estimate for blocks of size 2^( 4) =       0.000542223066
  error estimate for blocks of size 2^( 5) =       0.000550577286
  error estimate for blocks of size 2^( 6) =       0.000557505145
  error estimate for blocks of size 2^( 7) =       0.000561187737

      target function =                  N/A
              le_mean =     -22.668064736722
             les_mean =     514.343183670593
             stat err =       0.000552873308
             autocorr =       1.243342287281
              std dev =       0.701205427542
             le_variance =       0.491689051615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491649265124
                                         uncertainty =       0.002617681934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491649265124
                                         uncertainty =       0.002617681934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495827113
  error estimate for blocks of size 2^( 2) =       0.000514068733
  error estimate for blocks of size 2^( 3) =       0.000530427686
  error estimate for blocks of size 2^( 4) =       0.000542223066
  error estimate for blocks of size 2^( 5) =       0.000550577286
  error estimate for blocks of size 2^( 6) =       0.000557505145
  error estimate for blocks of size 2^( 7) =       0.000561187737

      target function =                  N/A
              le_mean =     -22.668064736722
             les_mean =     514.343183670593
             stat err =       0.000552873308
             autocorr =       1.243342287281
              std dev =       0.701205427542
             le_variance =       0.491689051615


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668064736722        initial  <--
     2.3842e+41     2.3842e+42             0.0000e+00       -22.668064736722
     9.5367e+41     9.5367e+42             0.0000e+00       -22.668064736722
     3.8147e+42     3.8147e+43             0.0000e+00       -22.668064736722

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5204
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5526e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.7067
    reference variance = 0.285054
====================================================
  Execution time = 2.5888e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1264e-01
  Total weights = 1.955323834e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498601909996
                                         uncertainty =       0.002697144460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498601909996
                                         uncertainty =       0.002697144460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499260944
  error estimate for blocks of size 2^( 2) =       0.000517603688
  error estimate for blocks of size 2^( 3) =       0.000533639589
  error estimate for blocks of size 2^( 4) =       0.000544900158
  error estimate for blocks of size 2^( 5) =       0.000552153037
  error estimate for blocks of size 2^( 6) =       0.000556643799
  error estimate for blocks of size 2^( 7) =       0.000557144805

      target function =                  N/A
              le_mean =     -22.669358302831
             les_mean =     514.412446831410
             stat err =       0.000552710450
             autocorr =       1.225575763062
              std dev =       0.706061598460
             le_variance =       0.498522980819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266935830283e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+42, overlap shift 2.3842e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669358302869       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669358302869       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+42, overlap shift 9.5367e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669358302869       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669358302869       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+43, overlap shift 3.8147e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669358302869       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669358302869       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0697e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.6583
    reference variance = 0.253906
====================================================
  Execution time = 2.5607e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0950e-01
  Total weights = 1.9554e+06
  Execution time = 3.6476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497256703437
                                         uncertainty =       0.002702525688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497256703437
                                         uncertainty =       0.002702525688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498722352
  error estimate for blocks of size 2^( 2) =       0.000516574741
  error estimate for blocks of size 2^( 3) =       0.000532783828
  error estimate for blocks of size 2^( 4) =       0.000544899457
  error estimate for blocks of size 2^( 5) =       0.000551502620
  error estimate for blocks of size 2^( 6) =       0.000555789294
  error estimate for blocks of size 2^( 7) =       0.000556529840

      target function =                  N/A
              le_mean =     -22.669100794373
             les_mean =     514.397626577073
             stat err =       0.000552180303
             autocorr =       1.225869259444
              std dev =       0.705299914276
             le_variance =       0.497447969077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497256703437
                                         uncertainty =       0.002702525688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497256703437
                                         uncertainty =       0.002702525688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498722352
  error estimate for blocks of size 2^( 2) =       0.000516574741
  error estimate for blocks of size 2^( 3) =       0.000532783828
  error estimate for blocks of size 2^( 4) =       0.000544899457
  error estimate for blocks of size 2^( 5) =       0.000551502620
  error estimate for blocks of size 2^( 6) =       0.000555789294
  error estimate for blocks of size 2^( 7) =       0.000556529840

      target function =                  N/A
              le_mean =     -22.669100794373
             les_mean =     514.397626577073
             stat err =       0.000552180303
             autocorr =       1.225869259444
              std dev =       0.705299914276
             le_variance =       0.497447969077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497256703437
                                         uncertainty =       0.002702525688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497256703437
                                         uncertainty =       0.002702525688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498722352
  error estimate for blocks of size 2^( 2) =       0.000516574741
  error estimate for blocks of size 2^( 3) =       0.000532783828
  error estimate for blocks of size 2^( 4) =       0.000544899457
  error estimate for blocks of size 2^( 5) =       0.000551502620
  error estimate for blocks of size 2^( 6) =       0.000555789294
  error estimate for blocks of size 2^( 7) =       0.000556529840

      target function =                  N/A
              le_mean =     -22.669100794373
             les_mean =     514.397626577073
             stat err =       0.000552180303
             autocorr =       1.225869259444
              std dev =       0.705299914276
             le_variance =       0.497447969077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497256703437
                                         uncertainty =       0.002702525688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497256703437
                                         uncertainty =       0.002702525688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498722352
  error estimate for blocks of size 2^( 2) =       0.000516574741
  error estimate for blocks of size 2^( 3) =       0.000532783828
  error estimate for blocks of size 2^( 4) =       0.000544899457
  error estimate for blocks of size 2^( 5) =       0.000551502620
  error estimate for blocks of size 2^( 6) =       0.000555789294
  error estimate for blocks of size 2^( 7) =       0.000556529840

      target function =                  N/A
              le_mean =     -22.669100794373
             les_mean =     514.397626577073
             stat err =       0.000552180303
             autocorr =       1.225869259444
              std dev =       0.705299914276
             le_variance =       0.497447969077


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669100794373        initial  <--
     2.3842e+42     2.3842e+43             0.0000e+00       -22.669100794373
     9.5367e+42     9.5367e+43             0.0000e+00       -22.669100794373
     3.8147e+43     3.8147e+44             0.0000e+00       -22.669100794373

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8808
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4583e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.5922
    reference variance = 0.394105
====================================================
  Execution time = 2.5983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1468e-01
  Total weights = 1.955041259e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494914565767
                                         uncertainty =       0.002604445742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494914565767
                                         uncertainty =       0.002604445742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497424361
  error estimate for blocks of size 2^( 2) =       0.000515417726
  error estimate for blocks of size 2^( 3) =       0.000531737574
  error estimate for blocks of size 2^( 4) =       0.000542534377
  error estimate for blocks of size 2^( 5) =       0.000549697111
  error estimate for blocks of size 2^( 6) =       0.000554348985
  error estimate for blocks of size 2^( 7) =       0.000557244320

      target function =                  N/A
              le_mean =     -22.668413547476
             les_mean =     514.371654305146
             stat err =       0.000550956198
             autocorr =       1.226817735651
              std dev =       0.703464276934
             le_variance =       0.494861988922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266841354748e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+43, overlap shift 2.3842e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668413547573       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668413547573       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+43, overlap shift 9.5367e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668413547573       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668413547573       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+44, overlap shift 3.8147e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668413547573       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668413547573       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126658 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0758e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.6853
    reference variance = 0.334606
====================================================
  Execution time = 2.5240e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0988e-01
  Total weights = 1.9552e+06
  Execution time = 3.6476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497179573819
                                         uncertainty =       0.002921171607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497179573819
                                         uncertainty =       0.002921171607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498546590
  error estimate for blocks of size 2^( 2) =       0.000516381411
  error estimate for blocks of size 2^( 3) =       0.000532270142
  error estimate for blocks of size 2^( 4) =       0.000543251753
  error estimate for blocks of size 2^( 5) =       0.000549353080
  error estimate for blocks of size 2^( 6) =       0.000552062488
  error estimate for blocks of size 2^( 7) =       0.000554140686

      target function =                  N/A
              le_mean =     -22.669021044649
             les_mean =     514.394392035340
             stat err =       0.000549702002
             autocorr =       1.215746805434
              std dev =       0.705051349042
             le_variance =       0.497097404786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497179573819
                                         uncertainty =       0.002921171607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497179573819
                                         uncertainty =       0.002921171607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498546590
  error estimate for blocks of size 2^( 2) =       0.000516381411
  error estimate for blocks of size 2^( 3) =       0.000532270142
  error estimate for blocks of size 2^( 4) =       0.000543251753
  error estimate for blocks of size 2^( 5) =       0.000549353080
  error estimate for blocks of size 2^( 6) =       0.000552062488
  error estimate for blocks of size 2^( 7) =       0.000554140686

      target function =                  N/A
              le_mean =     -22.669021044649
             les_mean =     514.394392035340
             stat err =       0.000549702002
             autocorr =       1.215746805434
              std dev =       0.705051349042
             le_variance =       0.497097404786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497179573819
                                         uncertainty =       0.002921171607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497179573819
                                         uncertainty =       0.002921171607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498546590
  error estimate for blocks of size 2^( 2) =       0.000516381411
  error estimate for blocks of size 2^( 3) =       0.000532270142
  error estimate for blocks of size 2^( 4) =       0.000543251753
  error estimate for blocks of size 2^( 5) =       0.000549353080
  error estimate for blocks of size 2^( 6) =       0.000552062488
  error estimate for blocks of size 2^( 7) =       0.000554140686

      target function =                  N/A
              le_mean =     -22.669021044649
             les_mean =     514.394392035340
             stat err =       0.000549702002
             autocorr =       1.215746805434
              std dev =       0.705051349042
             le_variance =       0.497097404786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497179573819
                                         uncertainty =       0.002921171607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497179573819
                                         uncertainty =       0.002921171607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498546590
  error estimate for blocks of size 2^( 2) =       0.000516381411
  error estimate for blocks of size 2^( 3) =       0.000532270142
  error estimate for blocks of size 2^( 4) =       0.000543251753
  error estimate for blocks of size 2^( 5) =       0.000549353080
  error estimate for blocks of size 2^( 6) =       0.000552062488
  error estimate for blocks of size 2^( 7) =       0.000554140686

      target function =                  N/A
              le_mean =     -22.669021044649
             les_mean =     514.394392035340
             stat err =       0.000549702002
             autocorr =       1.215746805434
              std dev =       0.705051349042
             le_variance =       0.497097404786


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669021044649        initial  <--
     2.3842e+43     2.3842e+44             0.0000e+00       -22.669021044649
     9.5367e+43     9.5367e+44             0.0000e+00       -22.669021044649
     3.8147e+44     3.8147e+45             0.0000e+00       -22.669021044649

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5148
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4278e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.6661
    reference variance = 0.447322
====================================================
  Execution time = 2.7948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0920e-01
  Total weights = 1.955385533e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497916240931
                                         uncertainty =       0.003203666985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497916240931
                                         uncertainty =       0.003203666985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498916770
  error estimate for blocks of size 2^( 2) =       0.000517030536
  error estimate for blocks of size 2^( 3) =       0.000533047130
  error estimate for blocks of size 2^( 4) =       0.000544498924
  error estimate for blocks of size 2^( 5) =       0.000550883412
  error estimate for blocks of size 2^( 6) =       0.000555777446
  error estimate for blocks of size 2^( 7) =       0.000558058484

      target function =                  N/A
              le_mean =     -22.669945501179
             les_mean =     514.435629307759
             stat err =       0.000552304566
             autocorr =       1.225465429700
              std dev =       0.705574862222
             le_variance =       0.497835886200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266994550118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+44, overlap shift 2.3842e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669945501256       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669945501256       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+44, overlap shift 9.5367e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669945501256       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669945501256       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+45, overlap shift 3.8147e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669945501256       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669945501256       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2750e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.712
    reference variance = 0.415596
====================================================
  Execution time = 2.5271e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1454e-01
  Total weights = 1.9551e+06
  Execution time = 3.6300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499785601302
                                         uncertainty =       0.003359887849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499785601302
                                         uncertainty =       0.003359887849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499873391
  error estimate for blocks of size 2^( 2) =       0.000518248484
  error estimate for blocks of size 2^( 3) =       0.000534440226
  error estimate for blocks of size 2^( 4) =       0.000546162832
  error estimate for blocks of size 2^( 5) =       0.000552207747
  error estimate for blocks of size 2^( 6) =       0.000554256194
  error estimate for blocks of size 2^( 7) =       0.000555602809

      target function =                  N/A
              le_mean =     -22.669923638534
             les_mean =     514.439978661748
             stat err =       0.000552057396
             autocorr =       1.219687085772
              std dev =       0.706927729406
             le_variance =       0.499746814603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499785601302
                                         uncertainty =       0.003359887849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499785601302
                                         uncertainty =       0.003359887849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499873391
  error estimate for blocks of size 2^( 2) =       0.000518248484
  error estimate for blocks of size 2^( 3) =       0.000534440226
  error estimate for blocks of size 2^( 4) =       0.000546162832
  error estimate for blocks of size 2^( 5) =       0.000552207747
  error estimate for blocks of size 2^( 6) =       0.000554256194
  error estimate for blocks of size 2^( 7) =       0.000555602809

      target function =                  N/A
              le_mean =     -22.669923638534
             les_mean =     514.439978661748
             stat err =       0.000552057396
             autocorr =       1.219687085772
              std dev =       0.706927729406
             le_variance =       0.499746814603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499785601302
                                         uncertainty =       0.003359887849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499785601302
                                         uncertainty =       0.003359887849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499873391
  error estimate for blocks of size 2^( 2) =       0.000518248484
  error estimate for blocks of size 2^( 3) =       0.000534440226
  error estimate for blocks of size 2^( 4) =       0.000546162832
  error estimate for blocks of size 2^( 5) =       0.000552207747
  error estimate for blocks of size 2^( 6) =       0.000554256194
  error estimate for blocks of size 2^( 7) =       0.000555602809

      target function =                  N/A
              le_mean =     -22.669923638534
             les_mean =     514.439978661748
             stat err =       0.000552057396
             autocorr =       1.219687085772
              std dev =       0.706927729406
             le_variance =       0.499746814603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499785601302
                                         uncertainty =       0.003359887849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499785601302
                                         uncertainty =       0.003359887849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499873391
  error estimate for blocks of size 2^( 2) =       0.000518248484
  error estimate for blocks of size 2^( 3) =       0.000534440226
  error estimate for blocks of size 2^( 4) =       0.000546162832
  error estimate for blocks of size 2^( 5) =       0.000552207747
  error estimate for blocks of size 2^( 6) =       0.000554256194
  error estimate for blocks of size 2^( 7) =       0.000555602809

      target function =                  N/A
              le_mean =     -22.669923638534
             les_mean =     514.439978661748
             stat err =       0.000552057396
             autocorr =       1.219687085772
              std dev =       0.706927729406
             le_variance =       0.499746814603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669923638534        initial  <--
     2.3842e+44     2.3842e+45             0.0000e+00       -22.669923638534
     9.5367e+44     9.5367e+45             0.0000e+00       -22.669923638534
     3.8147e+45     3.8147e+46             0.0000e+00       -22.669923638534

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4986
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6255e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.6184
    reference variance = 0.345794
====================================================
  Execution time = 2.5906e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1663e-01
  Total weights = 1.954935844e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501281775903
                                         uncertainty =       0.003478242035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501281775903
                                         uncertainty =       0.003478242035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500683006
  error estimate for blocks of size 2^( 2) =       0.000518467063
  error estimate for blocks of size 2^( 3) =       0.000534940460
  error estimate for blocks of size 2^( 4) =       0.000546021203
  error estimate for blocks of size 2^( 5) =       0.000552567614
  error estimate for blocks of size 2^( 6) =       0.000556189267
  error estimate for blocks of size 2^( 7) =       0.000555928727

      target function =                  N/A
              le_mean =     -22.669076750542
             les_mean =     514.403672633536
             stat err =       0.000552676703
             autocorr =       1.218474972819
              std dev =       0.708072698163
             le_variance =       0.501366945884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266907675054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+45, overlap shift 2.3842e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669076750658       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669076750658       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+45, overlap shift 9.5367e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669076750658       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669076750658       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+46, overlap shift 3.8147e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669076750658       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669076750658       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0688e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.5783
    reference variance = 0.602549
====================================================
  Execution time = 2.5410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0764e-01
  Total weights = 1.9555e+06
  Execution time = 3.6360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495450457884
                                         uncertainty =       0.002856840353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495450457884
                                         uncertainty =       0.002856840353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497694127
  error estimate for blocks of size 2^( 2) =       0.000515959394
  error estimate for blocks of size 2^( 3) =       0.000532081138
  error estimate for blocks of size 2^( 4) =       0.000543558463
  error estimate for blocks of size 2^( 5) =       0.000549985570
  error estimate for blocks of size 2^( 6) =       0.000553734969
  error estimate for blocks of size 2^( 7) =       0.000556827289

      target function =                  N/A
              le_mean =     -22.669083699096
             les_mean =     514.394999483249
             stat err =       0.000551026573
             autocorr =       1.225801233883
              std dev =       0.703845783716
             le_variance =       0.495398887255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495450457884
                                         uncertainty =       0.002856840353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495450457884
                                         uncertainty =       0.002856840353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497694127
  error estimate for blocks of size 2^( 2) =       0.000515959394
  error estimate for blocks of size 2^( 3) =       0.000532081138
  error estimate for blocks of size 2^( 4) =       0.000543558463
  error estimate for blocks of size 2^( 5) =       0.000549985570
  error estimate for blocks of size 2^( 6) =       0.000553734969
  error estimate for blocks of size 2^( 7) =       0.000556827289

      target function =                  N/A
              le_mean =     -22.669083699096
             les_mean =     514.394999483249
             stat err =       0.000551026573
             autocorr =       1.225801233883
              std dev =       0.703845783716
             le_variance =       0.495398887255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495450457884
                                         uncertainty =       0.002856840353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495450457884
                                         uncertainty =       0.002856840353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497694127
  error estimate for blocks of size 2^( 2) =       0.000515959394
  error estimate for blocks of size 2^( 3) =       0.000532081138
  error estimate for blocks of size 2^( 4) =       0.000543558463
  error estimate for blocks of size 2^( 5) =       0.000549985570
  error estimate for blocks of size 2^( 6) =       0.000553734969
  error estimate for blocks of size 2^( 7) =       0.000556827289

      target function =                  N/A
              le_mean =     -22.669083699096
             les_mean =     514.394999483249
             stat err =       0.000551026573
             autocorr =       1.225801233883
              std dev =       0.703845783716
             le_variance =       0.495398887255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495450457884
                                         uncertainty =       0.002856840353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495450457884
                                         uncertainty =       0.002856840353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497694127
  error estimate for blocks of size 2^( 2) =       0.000515959394
  error estimate for blocks of size 2^( 3) =       0.000532081138
  error estimate for blocks of size 2^( 4) =       0.000543558463
  error estimate for blocks of size 2^( 5) =       0.000549985570
  error estimate for blocks of size 2^( 6) =       0.000553734969
  error estimate for blocks of size 2^( 7) =       0.000556827289

      target function =                  N/A
              le_mean =     -22.669083699096
             les_mean =     514.394999483249
             stat err =       0.000551026573
             autocorr =       1.225801233883
              std dev =       0.703845783716
             le_variance =       0.495398887255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669083699096        initial  <--
     2.3842e+45     2.3842e+46             0.0000e+00       -22.669083699096
     9.5367e+45     9.5367e+46             0.0000e+00       -22.669083699096
     3.8147e+46     3.8147e+47             0.0000e+00       -22.669083699096

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6461
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4340e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.5962
    reference variance = 0.418091
====================================================
  Execution time = 2.5935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0969e-01
  Total weights = 1.954970529e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497325750520
                                         uncertainty =       0.003405442891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497325750520
                                         uncertainty =       0.003405442891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498697643
  error estimate for blocks of size 2^( 2) =       0.000516573817
  error estimate for blocks of size 2^( 3) =       0.000531947918
  error estimate for blocks of size 2^( 4) =       0.000543403882
  error estimate for blocks of size 2^( 5) =       0.000550786487
  error estimate for blocks of size 2^( 6) =       0.000554522545
  error estimate for blocks of size 2^( 7) =       0.000556578426

      target function =                  N/A
              le_mean =     -22.669546736261
             les_mean =     514.418038818807
             stat err =       0.000551322835
             autocorr =       1.222186072996
              std dev =       0.705264969761
             le_variance =       0.497398677572


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266954673626e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+46, overlap shift 2.3842e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669546736371       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669546736371       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+46, overlap shift 9.5367e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669546736371       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669546736371       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+47, overlap shift 3.8147e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669546736371       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669546736371       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0702e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.7888
    reference variance = 0.930996
====================================================
  Execution time = 2.5149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0376e-01
  Total weights = 1.9549e+06
  Execution time = 3.6461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493746112120
                                         uncertainty =       0.002855735974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493746112120
                                         uncertainty =       0.002855735974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496856964
  error estimate for blocks of size 2^( 2) =       0.000514883134
  error estimate for blocks of size 2^( 3) =       0.000530621465
  error estimate for blocks of size 2^( 4) =       0.000541642420
  error estimate for blocks of size 2^( 5) =       0.000547432281
  error estimate for blocks of size 2^( 6) =       0.000550519458
  error estimate for blocks of size 2^( 7) =       0.000552966801

      target function =                  N/A
              le_mean =     -22.669898675715
             les_mean =     514.428067944501
             stat err =       0.000548140240
             autocorr =       1.217084155056
              std dev =       0.702661857085
             le_variance =       0.493733685403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493746112120
                                         uncertainty =       0.002855735974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493746112120
                                         uncertainty =       0.002855735974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496856964
  error estimate for blocks of size 2^( 2) =       0.000514883134
  error estimate for blocks of size 2^( 3) =       0.000530621465
  error estimate for blocks of size 2^( 4) =       0.000541642420
  error estimate for blocks of size 2^( 5) =       0.000547432281
  error estimate for blocks of size 2^( 6) =       0.000550519458
  error estimate for blocks of size 2^( 7) =       0.000552966801

      target function =                  N/A
              le_mean =     -22.669898675715
             les_mean =     514.428067944501
             stat err =       0.000548140240
             autocorr =       1.217084155056
              std dev =       0.702661857085
             le_variance =       0.493733685403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493746112120
                                         uncertainty =       0.002855735974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493746112120
                                         uncertainty =       0.002855735974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496856964
  error estimate for blocks of size 2^( 2) =       0.000514883134
  error estimate for blocks of size 2^( 3) =       0.000530621465
  error estimate for blocks of size 2^( 4) =       0.000541642420
  error estimate for blocks of size 2^( 5) =       0.000547432281
  error estimate for blocks of size 2^( 6) =       0.000550519458
  error estimate for blocks of size 2^( 7) =       0.000552966801

      target function =                  N/A
              le_mean =     -22.669898675715
             les_mean =     514.428067944501
             stat err =       0.000548140240
             autocorr =       1.217084155056
              std dev =       0.702661857085
             le_variance =       0.493733685403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493746112120
                                         uncertainty =       0.002855735974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493746112120
                                         uncertainty =       0.002855735974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496856964
  error estimate for blocks of size 2^( 2) =       0.000514883134
  error estimate for blocks of size 2^( 3) =       0.000530621465
  error estimate for blocks of size 2^( 4) =       0.000541642420
  error estimate for blocks of size 2^( 5) =       0.000547432281
  error estimate for blocks of size 2^( 6) =       0.000550519458
  error estimate for blocks of size 2^( 7) =       0.000552966801

      target function =                  N/A
              le_mean =     -22.669898675715
             les_mean =     514.428067944501
             stat err =       0.000548140240
             autocorr =       1.217084155056
              std dev =       0.702661857085
             le_variance =       0.493733685403


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669898675715        initial  <--
     2.3842e+46     2.3842e+47             0.0000e+00       -22.669898675715
     9.5367e+46     9.5367e+47             0.0000e+00       -22.669898675715
     3.8147e+47     3.8147e+48             0.0000e+00       -22.669898675715

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.3931
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4101e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.7107
    reference variance = 0.376533
====================================================
  Execution time = 2.6026e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0839e-01
  Total weights = 1.954908647e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494928408580
                                         uncertainty =       0.002471857668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494928408580
                                         uncertainty =       0.002471857668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497566240
  error estimate for blocks of size 2^( 2) =       0.000514805188
  error estimate for blocks of size 2^( 3) =       0.000529984252
  error estimate for blocks of size 2^( 4) =       0.000540943656
  error estimate for blocks of size 2^( 5) =       0.000547316589
  error estimate for blocks of size 2^( 6) =       0.000554005817
  error estimate for blocks of size 2^( 7) =       0.000555646201

      target function =                  N/A
              le_mean =     -22.669227370472
             les_mean =     514.402259609952
             stat err =       0.000549478066
             autocorr =       1.219548035063
              std dev =       0.703664924259
             le_variance =       0.495144325632


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266922737047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+47, overlap shift 2.3842e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669227370567       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669227370567       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.625000000000       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669227370567       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+47 is 3.698172e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+47, overlap shift 9.5367e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669227370567       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669227370567       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669227370567       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.625000000000       residual = 5.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+47 is 9.244772e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+48, overlap shift 3.8147e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669227370567       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669227370567       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.500000000000       residual = 5.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669227370567       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+48 is 2.311358e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0794e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.7182
    reference variance = 0.387507
====================================================
  Execution time = 2.5228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1260e-01
  Total weights = 1.9547e+06
  Execution time = 3.6409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959872015
                                         uncertainty =       0.002554034754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959872015
                                         uncertainty =       0.002554034754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499526382
  error estimate for blocks of size 2^( 2) =       0.000517422112
  error estimate for blocks of size 2^( 3) =       0.000533340129
  error estimate for blocks of size 2^( 4) =       0.000543897640
  error estimate for blocks of size 2^( 5) =       0.000549745352
  error estimate for blocks of size 2^( 6) =       0.000551719847
  error estimate for blocks of size 2^( 7) =       0.000551667061

      target function =                  N/A
              le_mean =     -22.669514270176
             les_mean =     514.419474185203
             stat err =       0.000549257475
             autocorr =       1.209024472510
              std dev =       0.706436984302
             le_variance =       0.499053212790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959872015
                                         uncertainty =       0.002554034754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959872015
                                         uncertainty =       0.002554034754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499526382
  error estimate for blocks of size 2^( 2) =       0.000517422112
  error estimate for blocks of size 2^( 3) =       0.000533340129
  error estimate for blocks of size 2^( 4) =       0.000543897640
  error estimate for blocks of size 2^( 5) =       0.000549745352
  error estimate for blocks of size 2^( 6) =       0.000551719847
  error estimate for blocks of size 2^( 7) =       0.000551667061

      target function =                  N/A
              le_mean =     -22.669514270176
             les_mean =     514.419474185203
             stat err =       0.000549257475
             autocorr =       1.209024472510
              std dev =       0.706436984302
             le_variance =       0.499053212790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959872015
                                         uncertainty =       0.002554034754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959872015
                                         uncertainty =       0.002554034754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499526382
  error estimate for blocks of size 2^( 2) =       0.000517422112
  error estimate for blocks of size 2^( 3) =       0.000533340129
  error estimate for blocks of size 2^( 4) =       0.000543897640
  error estimate for blocks of size 2^( 5) =       0.000549745352
  error estimate for blocks of size 2^( 6) =       0.000551719847
  error estimate for blocks of size 2^( 7) =       0.000551667061

      target function =                  N/A
              le_mean =     -22.669514270176
             les_mean =     514.419474185203
             stat err =       0.000549257475
             autocorr =       1.209024472510
              std dev =       0.706436984302
             le_variance =       0.499053212790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959872015
                                         uncertainty =       0.002554034754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498959872015
                                         uncertainty =       0.002554034754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499526382
  error estimate for blocks of size 2^( 2) =       0.000517422112
  error estimate for blocks of size 2^( 3) =       0.000533340129
  error estimate for blocks of size 2^( 4) =       0.000543897640
  error estimate for blocks of size 2^( 5) =       0.000549745352
  error estimate for blocks of size 2^( 6) =       0.000551719847
  error estimate for blocks of size 2^( 7) =       0.000551667061

      target function =                  N/A
              le_mean =     -22.669514270176
             les_mean =     514.419474185203
             stat err =       0.000549257475
             autocorr =       1.209024472510
              std dev =       0.706436984302
             le_variance =       0.499053212790


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669514270176        initial  <--
     2.3842e+47     2.3842e+48             3.6982e-51       -22.669514270176
     9.5367e+47     9.5367e+48             9.2448e-52       -22.669514270176
     3.8147e+48     3.8147e+49             2.3114e-52       -22.669514270176

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4802
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4280e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.6083
    reference variance = 0.408396
====================================================
  Execution time = 2.7791e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0924e-01
  Total weights = 1.954855676e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495611645918
                                         uncertainty =       0.002646012435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495611645918
                                         uncertainty =       0.002646012435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497793093
  error estimate for blocks of size 2^( 2) =       0.000515857827
  error estimate for blocks of size 2^( 3) =       0.000532478727
  error estimate for blocks of size 2^( 4) =       0.000544075780
  error estimate for blocks of size 2^( 5) =       0.000550956286
  error estimate for blocks of size 2^( 6) =       0.000554118310
  error estimate for blocks of size 2^( 7) =       0.000555154355

      target function =                  N/A
              le_mean =     -22.670272412798
             les_mean =     514.450488275927
             stat err =       0.000551076183
             autocorr =       1.225534524192
              std dev =       0.703985743287
             le_variance =       0.495595926752


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267027241280e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+48, overlap shift 2.3842e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670272412875       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670272412875       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+48, overlap shift 9.5367e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670272412875       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670272412875       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+49, overlap shift 3.8147e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670272412875       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670272412875       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2574e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.6026
    reference variance = 0.850235
====================================================
  Execution time = 2.5327e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0958e-01
  Total weights = 1.9552e+06
  Execution time = 3.6385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497635483340
                                         uncertainty =       0.002880298963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497635483340
                                         uncertainty =       0.002880298963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498804976
  error estimate for blocks of size 2^( 2) =       0.000516695107
  error estimate for blocks of size 2^( 3) =       0.000532331128
  error estimate for blocks of size 2^( 4) =       0.000544294864
  error estimate for blocks of size 2^( 5) =       0.000550502157
  error estimate for blocks of size 2^( 6) =       0.000554933263
  error estimate for blocks of size 2^( 7) =       0.000556144296

      target function =                  N/A
              le_mean =     -22.669875375286
             les_mean =     514.432827145510
             stat err =       0.000551468645
             autocorr =       1.222306423355
              std dev =       0.705416762691
             le_variance =       0.497612809086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497635483340
                                         uncertainty =       0.002880298963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497635483340
                                         uncertainty =       0.002880298963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498804976
  error estimate for blocks of size 2^( 2) =       0.000516695107
  error estimate for blocks of size 2^( 3) =       0.000532331128
  error estimate for blocks of size 2^( 4) =       0.000544294864
  error estimate for blocks of size 2^( 5) =       0.000550502157
  error estimate for blocks of size 2^( 6) =       0.000554933263
  error estimate for blocks of size 2^( 7) =       0.000556144296

      target function =                  N/A
              le_mean =     -22.669875375286
             les_mean =     514.432827145510
             stat err =       0.000551468645
             autocorr =       1.222306423355
              std dev =       0.705416762691
             le_variance =       0.497612809086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497635483340
                                         uncertainty =       0.002880298963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497635483340
                                         uncertainty =       0.002880298963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498804976
  error estimate for blocks of size 2^( 2) =       0.000516695107
  error estimate for blocks of size 2^( 3) =       0.000532331128
  error estimate for blocks of size 2^( 4) =       0.000544294864
  error estimate for blocks of size 2^( 5) =       0.000550502157
  error estimate for blocks of size 2^( 6) =       0.000554933263
  error estimate for blocks of size 2^( 7) =       0.000556144296

      target function =                  N/A
              le_mean =     -22.669875375286
             les_mean =     514.432827145510
             stat err =       0.000551468645
             autocorr =       1.222306423355
              std dev =       0.705416762691
             le_variance =       0.497612809086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497635483340
                                         uncertainty =       0.002880298963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497635483340
                                         uncertainty =       0.002880298963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498804976
  error estimate for blocks of size 2^( 2) =       0.000516695107
  error estimate for blocks of size 2^( 3) =       0.000532331128
  error estimate for blocks of size 2^( 4) =       0.000544294864
  error estimate for blocks of size 2^( 5) =       0.000550502157
  error estimate for blocks of size 2^( 6) =       0.000554933263
  error estimate for blocks of size 2^( 7) =       0.000556144296

      target function =                  N/A
              le_mean =     -22.669875375286
             les_mean =     514.432827145510
             stat err =       0.000551468645
             autocorr =       1.222306423355
              std dev =       0.705416762691
             le_variance =       0.497612809086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669875375286        initial  <--
     2.3842e+48     2.3842e+49             0.0000e+00       -22.669875375286
     9.5367e+48     9.5367e+49             0.0000e+00       -22.669875375286
     3.8147e+49     3.8147e+50             0.0000e+00       -22.669875375286

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5863
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6166e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.6337
    reference variance = 0.345587
====================================================
  Execution time = 2.6003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0690e-01
  Total weights = 1.955233929e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495038882917
                                         uncertainty =       0.002955622171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495038882917
                                         uncertainty =       0.002955622171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497513337
  error estimate for blocks of size 2^( 2) =       0.000515302203
  error estimate for blocks of size 2^( 3) =       0.000531067924
  error estimate for blocks of size 2^( 4) =       0.000541826395
  error estimate for blocks of size 2^( 5) =       0.000548677416
  error estimate for blocks of size 2^( 6) =       0.000552396110
  error estimate for blocks of size 2^( 7) =       0.000550437265

      target function =                  N/A
              le_mean =     -22.670058434692
             les_mean =     514.438448558958
             stat err =       0.000548334296
             autocorr =       1.214734496981
              std dev =       0.703590108745
             le_variance =       0.495039041124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267005843469e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+49, overlap shift 2.3842e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670058434792       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670058434792       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.000000000000       residual = 9.02e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+49 is 1.789169e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+49, overlap shift 9.5367e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670058434792       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670058434792       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670058434792       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.000000000000       residual = 9.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+49 is 4.893585e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+50, overlap shift 3.8147e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670058434792       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670058434792       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -24.000000000000       residual = 3.55e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+50 is 1.118231e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0773e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.6471
    reference variance = 0.24136
====================================================
  Execution time = 2.5450e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1195e-01
  Total weights = 1.9550e+06
  Execution time = 3.6371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498680541236
                                         uncertainty =       0.003532052294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498680541236
                                         uncertainty =       0.003532052294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499310613
  error estimate for blocks of size 2^( 2) =       0.000517568539
  error estimate for blocks of size 2^( 3) =       0.000533578428
  error estimate for blocks of size 2^( 4) =       0.000544072416
  error estimate for blocks of size 2^( 5) =       0.000551345339
  error estimate for blocks of size 2^( 6) =       0.000554300391
  error estimate for blocks of size 2^( 7) =       0.000555497312

      target function =                  N/A
              le_mean =     -22.668665070123
             les_mean =     514.380321282211
             stat err =       0.000551303865
             autocorr =       1.219103222402
              std dev =       0.706131840770
             le_variance =       0.498622176549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498680541236
                                         uncertainty =       0.003532052294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498680541236
                                         uncertainty =       0.003532052294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499310613
  error estimate for blocks of size 2^( 2) =       0.000517568539
  error estimate for blocks of size 2^( 3) =       0.000533578428
  error estimate for blocks of size 2^( 4) =       0.000544072416
  error estimate for blocks of size 2^( 5) =       0.000551345339
  error estimate for blocks of size 2^( 6) =       0.000554300391
  error estimate for blocks of size 2^( 7) =       0.000555497312

      target function =                  N/A
              le_mean =     -22.668665070123
             les_mean =     514.380321282211
             stat err =       0.000551303865
             autocorr =       1.219103222402
              std dev =       0.706131840770
             le_variance =       0.498622176549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498680541236
                                         uncertainty =       0.003532052294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498680541236
                                         uncertainty =       0.003532052294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499310613
  error estimate for blocks of size 2^( 2) =       0.000517568539
  error estimate for blocks of size 2^( 3) =       0.000533578428
  error estimate for blocks of size 2^( 4) =       0.000544072416
  error estimate for blocks of size 2^( 5) =       0.000551345339
  error estimate for blocks of size 2^( 6) =       0.000554300391
  error estimate for blocks of size 2^( 7) =       0.000555497312

      target function =                  N/A
              le_mean =     -22.668665070123
             les_mean =     514.380321282211
             stat err =       0.000551303865
             autocorr =       1.219103222402
              std dev =       0.706131840770
             le_variance =       0.498622176549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498680541236
                                         uncertainty =       0.003532052294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498680541236
                                         uncertainty =       0.003532052294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499310613
  error estimate for blocks of size 2^( 2) =       0.000517568539
  error estimate for blocks of size 2^( 3) =       0.000533578428
  error estimate for blocks of size 2^( 4) =       0.000544072416
  error estimate for blocks of size 2^( 5) =       0.000551345339
  error estimate for blocks of size 2^( 6) =       0.000554300391
  error estimate for blocks of size 2^( 7) =       0.000555497312

      target function =                  N/A
              le_mean =     -22.668665070123
             les_mean =     514.380321282211
             stat err =       0.000551303865
             autocorr =       1.219103222402
              std dev =       0.706131840770
             le_variance =       0.498622176549


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668665070123        initial  <--
     2.3842e+49     2.3842e+50             1.7892e-53       -22.668665070123
     9.5367e+49     9.5367e+50             4.8936e-54       -22.668665070123
     3.8147e+50     3.8147e+51             1.1182e-54       -22.668665070123

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6938
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4472e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.6657
    reference variance = 0.353877
====================================================
  Execution time = 2.5966e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0893e-01
  Total weights = 1.955109956e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494779668705
                                         uncertainty =       0.002838253985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494779668705
                                         uncertainty =       0.002838253985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497393896
  error estimate for blocks of size 2^( 2) =       0.000515566385
  error estimate for blocks of size 2^( 3) =       0.000531609614
  error estimate for blocks of size 2^( 4) =       0.000542078796
  error estimate for blocks of size 2^( 5) =       0.000548600927
  error estimate for blocks of size 2^( 6) =       0.000551645292
  error estimate for blocks of size 2^( 7) =       0.000554626184

      target function =                  N/A
              le_mean =     -22.669211076657
             les_mean =     514.402059771004
             stat err =       0.000549237800
             autocorr =       1.219326282163
              std dev =       0.703421193236
             le_variance =       0.494801375094


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266921107666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+50, overlap shift 2.3842e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669211076744       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669211076744       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+50, overlap shift 9.5367e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669211076744       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669211076744       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+51, overlap shift 3.8147e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669211076744       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669211076744       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135274 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0715e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.6315
    reference variance = 0.314733
====================================================
  Execution time = 2.5169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1401e-01
  Total weights = 1.9552e+06
  Execution time = 3.6457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501877031585
                                         uncertainty =       0.005405295261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501877031585
                                         uncertainty =       0.005405295261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500930305
  error estimate for blocks of size 2^( 2) =       0.000518649194
  error estimate for blocks of size 2^( 3) =       0.000534861430
  error estimate for blocks of size 2^( 4) =       0.000545251106
  error estimate for blocks of size 2^( 5) =       0.000552003361
  error estimate for blocks of size 2^( 6) =       0.000555582638
  error estimate for blocks of size 2^( 7) =       0.000558107234

      target function =                  N/A
              le_mean =     -22.669897971359
             les_mean =     514.438288601824
             stat err =       0.000552736085
             autocorr =       1.217533794215
              std dev =       0.708422430603
             le_variance =       0.501862340182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501877031585
                                         uncertainty =       0.005405295261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501877031585
                                         uncertainty =       0.005405295261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500930305
  error estimate for blocks of size 2^( 2) =       0.000518649194
  error estimate for blocks of size 2^( 3) =       0.000534861430
  error estimate for blocks of size 2^( 4) =       0.000545251106
  error estimate for blocks of size 2^( 5) =       0.000552003361
  error estimate for blocks of size 2^( 6) =       0.000555582638
  error estimate for blocks of size 2^( 7) =       0.000558107234

      target function =                  N/A
              le_mean =     -22.669897971359
             les_mean =     514.438288601824
             stat err =       0.000552736085
             autocorr =       1.217533794215
              std dev =       0.708422430603
             le_variance =       0.501862340182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501877031585
                                         uncertainty =       0.005405295261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501877031585
                                         uncertainty =       0.005405295261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500930305
  error estimate for blocks of size 2^( 2) =       0.000518649194
  error estimate for blocks of size 2^( 3) =       0.000534861430
  error estimate for blocks of size 2^( 4) =       0.000545251106
  error estimate for blocks of size 2^( 5) =       0.000552003361
  error estimate for blocks of size 2^( 6) =       0.000555582638
  error estimate for blocks of size 2^( 7) =       0.000558107234

      target function =                  N/A
              le_mean =     -22.669897971359
             les_mean =     514.438288601824
             stat err =       0.000552736085
             autocorr =       1.217533794215
              std dev =       0.708422430603
             le_variance =       0.501862340182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501877031585
                                         uncertainty =       0.005405295261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501877031585
                                         uncertainty =       0.005405295261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500930305
  error estimate for blocks of size 2^( 2) =       0.000518649194
  error estimate for blocks of size 2^( 3) =       0.000534861430
  error estimate for blocks of size 2^( 4) =       0.000545251106
  error estimate for blocks of size 2^( 5) =       0.000552003361
  error estimate for blocks of size 2^( 6) =       0.000555582638
  error estimate for blocks of size 2^( 7) =       0.000558107234

      target function =                  N/A
              le_mean =     -22.669897971359
             les_mean =     514.438288601824
             stat err =       0.000552736085
             autocorr =       1.217533794215
              std dev =       0.708422430603
             le_variance =       0.501862340182


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669897971359        initial  <--
     2.3842e+50     2.3842e+51             0.0000e+00       -22.669897971359
     9.5367e+50     9.5367e+51             0.0000e+00       -22.669897971359
     3.8147e+51     3.8147e+52             0.0000e+00       -22.669897971359

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4928
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4214e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.6281
    reference variance = 0.533567
====================================================
  Execution time = 2.6134e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1303e-01
  Total weights = 1.955039034e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498722335697
                                         uncertainty =       0.004470024248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498722335697
                                         uncertainty =       0.004470024248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499332329
  error estimate for blocks of size 2^( 2) =       0.000517402512
  error estimate for blocks of size 2^( 3) =       0.000533413635
  error estimate for blocks of size 2^( 4) =       0.000545177247
  error estimate for blocks of size 2^( 5) =       0.000551529177
  error estimate for blocks of size 2^( 6) =       0.000555162251
  error estimate for blocks of size 2^( 7) =       0.000555712651

      target function =                  N/A
              le_mean =     -22.668865721928
             les_mean =     514.390504200307
             stat err =       0.000551895332
             autocorr =       1.221614192882
              std dev =       0.706162552413
             le_variance =       0.498665550431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266886572193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+51, overlap shift 2.3842e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668865722051       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668865722051       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+51, overlap shift 9.5367e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668865722051       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668865722051       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+52, overlap shift 3.8147e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668865722051       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668865722051       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136351 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0873e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.6351
    reference variance = 0.449576
====================================================
  Execution time = 2.5233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1483e-01
  Total weights = 1.9555e+06
  Execution time = 3.6357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498061307568
                                         uncertainty =       0.003140928475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498061307568
                                         uncertainty =       0.003140928475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498982570
  error estimate for blocks of size 2^( 2) =       0.000516957783
  error estimate for blocks of size 2^( 3) =       0.000533447052
  error estimate for blocks of size 2^( 4) =       0.000544899505
  error estimate for blocks of size 2^( 5) =       0.000552316906
  error estimate for blocks of size 2^( 6) =       0.000555439568
  error estimate for blocks of size 2^( 7) =       0.000561203664

      target function =                  N/A
              le_mean =     -22.669129621950
             les_mean =     514.404270191459
             stat err =       0.000553464911
             autocorr =       1.230295496313
              std dev =       0.705667917542
             le_variance =       0.497967209848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498061307568
                                         uncertainty =       0.003140928475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498061307568
                                         uncertainty =       0.003140928475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498982570
  error estimate for blocks of size 2^( 2) =       0.000516957783
  error estimate for blocks of size 2^( 3) =       0.000533447052
  error estimate for blocks of size 2^( 4) =       0.000544899505
  error estimate for blocks of size 2^( 5) =       0.000552316906
  error estimate for blocks of size 2^( 6) =       0.000555439568
  error estimate for blocks of size 2^( 7) =       0.000561203664

      target function =                  N/A
              le_mean =     -22.669129621950
             les_mean =     514.404270191459
             stat err =       0.000553464911
             autocorr =       1.230295496313
              std dev =       0.705667917542
             le_variance =       0.497967209848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498061307568
                                         uncertainty =       0.003140928475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498061307568
                                         uncertainty =       0.003140928475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498982570
  error estimate for blocks of size 2^( 2) =       0.000516957783
  error estimate for blocks of size 2^( 3) =       0.000533447052
  error estimate for blocks of size 2^( 4) =       0.000544899505
  error estimate for blocks of size 2^( 5) =       0.000552316906
  error estimate for blocks of size 2^( 6) =       0.000555439568
  error estimate for blocks of size 2^( 7) =       0.000561203664

      target function =                  N/A
              le_mean =     -22.669129621950
             les_mean =     514.404270191459
             stat err =       0.000553464911
             autocorr =       1.230295496313
              std dev =       0.705667917542
             le_variance =       0.497967209848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498061307568
                                         uncertainty =       0.003140928475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498061307568
                                         uncertainty =       0.003140928475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498982570
  error estimate for blocks of size 2^( 2) =       0.000516957783
  error estimate for blocks of size 2^( 3) =       0.000533447052
  error estimate for blocks of size 2^( 4) =       0.000544899505
  error estimate for blocks of size 2^( 5) =       0.000552316906
  error estimate for blocks of size 2^( 6) =       0.000555439568
  error estimate for blocks of size 2^( 7) =       0.000561203664

      target function =                  N/A
              le_mean =     -22.669129621950
             les_mean =     514.404270191459
             stat err =       0.000553464911
             autocorr =       1.230295496313
              std dev =       0.705667917542
             le_variance =       0.497967209848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669129621950        initial  <--
     2.3842e+51     2.3842e+52             0.0000e+00       -22.669129621950
     9.5367e+51     9.5367e+52             0.0000e+00       -22.669129621950
     3.8147e+52     3.8147e+53             0.0000e+00       -22.669129621950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4513
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.5969
    reference variance = 0.333367
====================================================
  Execution time = 2.7982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1109e-01
  Total weights = 1.954982553e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496656729311
                                         uncertainty =       0.002912423165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496656729311
                                         uncertainty =       0.002912423165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498317661
  error estimate for blocks of size 2^( 2) =       0.000516768556
  error estimate for blocks of size 2^( 3) =       0.000532665719
  error estimate for blocks of size 2^( 4) =       0.000543663350
  error estimate for blocks of size 2^( 5) =       0.000550899889
  error estimate for blocks of size 2^( 6) =       0.000553854951
  error estimate for blocks of size 2^( 7) =       0.000557171587

      target function =                  N/A
              le_mean =     -22.669615635728
             les_mean =     514.422566615689
             stat err =       0.000551397444
             autocorr =       1.224382006502
              std dev =       0.704727594668
             le_variance =       0.496640982687


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266961563573e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+52, overlap shift 2.3842e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669615635856       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669615635856       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.750000000000       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+52 is 1.887721e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+52, overlap shift 9.5367e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669615635856       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669615635856       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+52 is 4.719303e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+53, overlap shift 3.8147e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669615635856       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669615635856       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -23.000000000000       residual = 2.20e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+53 is 1.179826e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137611 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2725e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.597
    reference variance = 0.344011
====================================================
  Execution time = 2.5257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0753e-01
  Total weights = 1.9553e+06
  Execution time = 3.6382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496761415386
                                         uncertainty =       0.003295598857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496761415386
                                         uncertainty =       0.003295598857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498344037
  error estimate for blocks of size 2^( 2) =       0.000516142558
  error estimate for blocks of size 2^( 3) =       0.000532160471
  error estimate for blocks of size 2^( 4) =       0.000543288381
  error estimate for blocks of size 2^( 5) =       0.000550433767
  error estimate for blocks of size 2^( 6) =       0.000553265930
  error estimate for blocks of size 2^( 7) =       0.000556717618

      target function =                  N/A
              le_mean =     -22.669178892204
             les_mean =     514.399196760862
             stat err =       0.000550926424
             autocorr =       1.222161713958
              std dev =       0.704764895263
             le_variance =       0.496693557596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496761415386
                                         uncertainty =       0.003295598857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496761415386
                                         uncertainty =       0.003295598857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498344037
  error estimate for blocks of size 2^( 2) =       0.000516142558
  error estimate for blocks of size 2^( 3) =       0.000532160471
  error estimate for blocks of size 2^( 4) =       0.000543288381
  error estimate for blocks of size 2^( 5) =       0.000550433767
  error estimate for blocks of size 2^( 6) =       0.000553265930
  error estimate for blocks of size 2^( 7) =       0.000556717618

      target function =                  N/A
              le_mean =     -22.669178892204
             les_mean =     514.399196760862
             stat err =       0.000550926424
             autocorr =       1.222161713958
              std dev =       0.704764895263
             le_variance =       0.496693557596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496761415386
                                         uncertainty =       0.003295598857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496761415386
                                         uncertainty =       0.003295598857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498344037
  error estimate for blocks of size 2^( 2) =       0.000516142558
  error estimate for blocks of size 2^( 3) =       0.000532160471
  error estimate for blocks of size 2^( 4) =       0.000543288381
  error estimate for blocks of size 2^( 5) =       0.000550433767
  error estimate for blocks of size 2^( 6) =       0.000553265930
  error estimate for blocks of size 2^( 7) =       0.000556717618

      target function =                  N/A
              le_mean =     -22.669178892204
             les_mean =     514.399196760862
             stat err =       0.000550926424
             autocorr =       1.222161713958
              std dev =       0.704764895263
             le_variance =       0.496693557596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496761415386
                                         uncertainty =       0.003295598857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496761415386
                                         uncertainty =       0.003295598857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498344037
  error estimate for blocks of size 2^( 2) =       0.000516142558
  error estimate for blocks of size 2^( 3) =       0.000532160471
  error estimate for blocks of size 2^( 4) =       0.000543288381
  error estimate for blocks of size 2^( 5) =       0.000550433767
  error estimate for blocks of size 2^( 6) =       0.000553265930
  error estimate for blocks of size 2^( 7) =       0.000556717618

      target function =                  N/A
              le_mean =     -22.669178892204
             les_mean =     514.399196760862
             stat err =       0.000550926424
             autocorr =       1.222161713958
              std dev =       0.704764895263
             le_variance =       0.496693557596


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669178892204        initial  <--
     2.3842e+52     2.3842e+53             1.8877e-56       -22.669178892204
     9.5367e+52     9.5367e+53             4.7193e-57       -22.669178892204
     3.8147e+53     3.8147e+54             1.1798e-57       -22.669178892204

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4811
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.8197
    reference variance = 0.624807
====================================================
  Execution time = 2.6150e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1432e-01
  Total weights = 1.954989013e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497246796242
                                         uncertainty =       0.003240885293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497246796242
                                         uncertainty =       0.003240885293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498592164
  error estimate for blocks of size 2^( 2) =       0.000516930148
  error estimate for blocks of size 2^( 3) =       0.000533823990
  error estimate for blocks of size 2^( 4) =       0.000544967170
  error estimate for blocks of size 2^( 5) =       0.000553253486
  error estimate for blocks of size 2^( 6) =       0.000555745132
  error estimate for blocks of size 2^( 7) =       0.000556967467

      target function =                  N/A
              le_mean =     -22.669651905833
             les_mean =     514.427439898912
             stat err =       0.000552733314
             autocorr =       1.228967460966
              std dev =       0.705115799968
             le_variance =       0.497188291365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266965190583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+53, overlap shift 2.3842e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669651905967       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669651905967       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+53, overlap shift 9.5367e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669651905967       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669651905967       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+54, overlap shift 3.8147e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669651905967       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669651905967       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0953e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.7167
    reference variance = 0.593117
====================================================
  Execution time = 2.5495e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1197e-01
  Total weights = 1.9551e+06
  Execution time = 3.6295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496423697099
                                         uncertainty =       0.004209649791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496423697099
                                         uncertainty =       0.004209649791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498206243
  error estimate for blocks of size 2^( 2) =       0.000516032908
  error estimate for blocks of size 2^( 3) =       0.000532623661
  error estimate for blocks of size 2^( 4) =       0.000544616108
  error estimate for blocks of size 2^( 5) =       0.000551591202
  error estimate for blocks of size 2^( 6) =       0.000554359223
  error estimate for blocks of size 2^( 7) =       0.000554780653

      target function =                  N/A
              le_mean =     -22.669533115503
             les_mean =     514.419704281484
             stat err =       0.000551336797
             autocorr =       1.224660262276
              std dev =       0.704570026061
             le_variance =       0.496418921623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496423697099
                                         uncertainty =       0.004209649791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496423697099
                                         uncertainty =       0.004209649791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498206243
  error estimate for blocks of size 2^( 2) =       0.000516032908
  error estimate for blocks of size 2^( 3) =       0.000532623661
  error estimate for blocks of size 2^( 4) =       0.000544616108
  error estimate for blocks of size 2^( 5) =       0.000551591202
  error estimate for blocks of size 2^( 6) =       0.000554359223
  error estimate for blocks of size 2^( 7) =       0.000554780653

      target function =                  N/A
              le_mean =     -22.669533115503
             les_mean =     514.419704281484
             stat err =       0.000551336797
             autocorr =       1.224660262276
              std dev =       0.704570026061
             le_variance =       0.496418921623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496423697099
                                         uncertainty =       0.004209649791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496423697099
                                         uncertainty =       0.004209649791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498206243
  error estimate for blocks of size 2^( 2) =       0.000516032908
  error estimate for blocks of size 2^( 3) =       0.000532623661
  error estimate for blocks of size 2^( 4) =       0.000544616108
  error estimate for blocks of size 2^( 5) =       0.000551591202
  error estimate for blocks of size 2^( 6) =       0.000554359223
  error estimate for blocks of size 2^( 7) =       0.000554780653

      target function =                  N/A
              le_mean =     -22.669533115503
             les_mean =     514.419704281484
             stat err =       0.000551336797
             autocorr =       1.224660262276
              std dev =       0.704570026061
             le_variance =       0.496418921623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496423697099
                                         uncertainty =       0.004209649791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496423697099
                                         uncertainty =       0.004209649791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498206243
  error estimate for blocks of size 2^( 2) =       0.000516032908
  error estimate for blocks of size 2^( 3) =       0.000532623661
  error estimate for blocks of size 2^( 4) =       0.000544616108
  error estimate for blocks of size 2^( 5) =       0.000551591202
  error estimate for blocks of size 2^( 6) =       0.000554359223
  error estimate for blocks of size 2^( 7) =       0.000554780653

      target function =                  N/A
              le_mean =     -22.669533115503
             les_mean =     514.419704281484
             stat err =       0.000551336797
             autocorr =       1.224660262276
              std dev =       0.704570026061
             le_variance =       0.496418921623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669533115503        initial  <--
     2.3842e+53     2.3842e+54             0.0000e+00       -22.669533115503
     9.5367e+53     9.5367e+54             0.0000e+00       -22.669533115503
     3.8147e+54     3.8147e+55             0.0000e+00       -22.669533115503

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7357
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4694e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.6029
    reference variance = 0.326426
====================================================
  Execution time = 2.5935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1021e-01
  Total weights = 1.955455461e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498490475536
                                         uncertainty =       0.003308101784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498490475536
                                         uncertainty =       0.003308101784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499214766
  error estimate for blocks of size 2^( 2) =       0.000516495312
  error estimate for blocks of size 2^( 3) =       0.000531760050
  error estimate for blocks of size 2^( 4) =       0.000543677027
  error estimate for blocks of size 2^( 5) =       0.000550028572
  error estimate for blocks of size 2^( 6) =       0.000554123475
  error estimate for blocks of size 2^( 7) =       0.000554603260

      target function =                  N/A
              le_mean =     -22.669534944409
             les_mean =     514.418022453283
             stat err =       0.000550608084
             autocorr =       1.216494977386
              std dev =       0.705996293158
             le_variance =       0.498430765953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266953494441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+54, overlap shift 2.3842e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669534944494       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669534944494       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669534944494       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+54 is 2.328998e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+54, overlap shift 9.5367e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669534944494       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669534944494       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+54 is 5.718532e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+55, overlap shift 3.8147e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669534944494       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669534944494       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669534944494       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+55 is 1.455624e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0745e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.7255
    reference variance = 0.766198
====================================================
  Execution time = 2.5499e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1669e-01
  Total weights = 1.9550e+06
  Execution time = 3.6401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502106100559
                                         uncertainty =       0.003760078154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502106100559
                                         uncertainty =       0.003760078154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501031051
  error estimate for blocks of size 2^( 2) =       0.000518580870
  error estimate for blocks of size 2^( 3) =       0.000534690779
  error estimate for blocks of size 2^( 4) =       0.000546978270
  error estimate for blocks of size 2^( 5) =       0.000554638979
  error estimate for blocks of size 2^( 6) =       0.000557361762
  error estimate for blocks of size 2^( 7) =       0.000558654399

      target function =                  N/A
              le_mean =     -22.670174484551
             les_mean =     514.453501262747
             stat err =       0.000554408353
             autocorr =       1.224419524025
              std dev =       0.708564907412
             le_variance =       0.502064228015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502106100559
                                         uncertainty =       0.003760078154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502106100559
                                         uncertainty =       0.003760078154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501031051
  error estimate for blocks of size 2^( 2) =       0.000518580870
  error estimate for blocks of size 2^( 3) =       0.000534690779
  error estimate for blocks of size 2^( 4) =       0.000546978270
  error estimate for blocks of size 2^( 5) =       0.000554638979
  error estimate for blocks of size 2^( 6) =       0.000557361762
  error estimate for blocks of size 2^( 7) =       0.000558654399

      target function =                  N/A
              le_mean =     -22.670174484551
             les_mean =     514.453501262747
             stat err =       0.000554408353
             autocorr =       1.224419524025
              std dev =       0.708564907412
             le_variance =       0.502064228015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502106100559
                                         uncertainty =       0.003760078154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502106100559
                                         uncertainty =       0.003760078154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501031051
  error estimate for blocks of size 2^( 2) =       0.000518580870
  error estimate for blocks of size 2^( 3) =       0.000534690779
  error estimate for blocks of size 2^( 4) =       0.000546978270
  error estimate for blocks of size 2^( 5) =       0.000554638979
  error estimate for blocks of size 2^( 6) =       0.000557361762
  error estimate for blocks of size 2^( 7) =       0.000558654399

      target function =                  N/A
              le_mean =     -22.670174484551
             les_mean =     514.453501262747
             stat err =       0.000554408353
             autocorr =       1.224419524025
              std dev =       0.708564907412
             le_variance =       0.502064228015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502106100559
                                         uncertainty =       0.003760078154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502106100559
                                         uncertainty =       0.003760078154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501031051
  error estimate for blocks of size 2^( 2) =       0.000518580870
  error estimate for blocks of size 2^( 3) =       0.000534690779
  error estimate for blocks of size 2^( 4) =       0.000546978270
  error estimate for blocks of size 2^( 5) =       0.000554638979
  error estimate for blocks of size 2^( 6) =       0.000557361762
  error estimate for blocks of size 2^( 7) =       0.000558654399

      target function =                  N/A
              le_mean =     -22.670174484551
             les_mean =     514.453501262747
             stat err =       0.000554408353
             autocorr =       1.224419524025
              std dev =       0.708564907412
             le_variance =       0.502064228015


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670174484551        initial  <--
     2.3842e+54     2.3842e+55             2.3290e-58       -22.670174484551
     9.5367e+54     9.5367e+55             5.7185e-59       -22.670174484551
     3.8147e+55     3.8147e+56             1.4556e-59       -22.670174484551

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7800
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4531e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.6772
    reference variance = 0.712767
====================================================
  Execution time = 2.5877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5230e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1586e-01
  Total weights = 1.954886426e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501881883887
                                         uncertainty =       0.003744405597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501881883887
                                         uncertainty =       0.003744405597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501027428
  error estimate for blocks of size 2^( 2) =       0.000518697034
  error estimate for blocks of size 2^( 3) =       0.000535275147
  error estimate for blocks of size 2^( 4) =       0.000546633779
  error estimate for blocks of size 2^( 5) =       0.000553220573
  error estimate for blocks of size 2^( 6) =       0.000556534279
  error estimate for blocks of size 2^( 7) =       0.000558898486

      target function =                  N/A
              le_mean =     -22.669116067566
             les_mean =     514.404679574789
             stat err =       0.000553821779
             autocorr =       1.221847652176
              std dev =       0.708559783623
             le_variance =       0.502056966968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266911606757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+55, overlap shift 2.3842e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669116067687       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669116067687       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669116067687       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669116067687       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+55 is 2.099807e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+55, overlap shift 9.5367e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669116067687       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669116067687       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669116067687       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669116067687       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+55 is 5.249517e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+56, overlap shift 3.8147e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669116067687       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669116067687       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669116067687       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669116067687       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+56 is 1.312379e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0679e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.7063
    reference variance = 0.420511
====================================================
  Execution time = 2.5376e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0799e-01
  Total weights = 1.9552e+06
  Execution time = 3.6364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495210591411
                                         uncertainty =       0.002648362276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495210591411
                                         uncertainty =       0.002648362276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497647663
  error estimate for blocks of size 2^( 2) =       0.000515842868
  error estimate for blocks of size 2^( 3) =       0.000532006363
  error estimate for blocks of size 2^( 4) =       0.000543155590
  error estimate for blocks of size 2^( 5) =       0.000550177759
  error estimate for blocks of size 2^( 6) =       0.000554148223
  error estimate for blocks of size 2^( 7) =       0.000554280276

      target function =                  N/A
              le_mean =     -22.669719779758
             les_mean =     514.424184682171
             stat err =       0.000550440462
             autocorr =       1.223423345196
              std dev =       0.703780074167
             le_variance =       0.495306392795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495210591411
                                         uncertainty =       0.002648362276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495210591411
                                         uncertainty =       0.002648362276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497647663
  error estimate for blocks of size 2^( 2) =       0.000515842868
  error estimate for blocks of size 2^( 3) =       0.000532006363
  error estimate for blocks of size 2^( 4) =       0.000543155590
  error estimate for blocks of size 2^( 5) =       0.000550177759
  error estimate for blocks of size 2^( 6) =       0.000554148223
  error estimate for blocks of size 2^( 7) =       0.000554280276

      target function =                  N/A
              le_mean =     -22.669719779758
             les_mean =     514.424184682171
             stat err =       0.000550440462
             autocorr =       1.223423345196
              std dev =       0.703780074167
             le_variance =       0.495306392795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495210591411
                                         uncertainty =       0.002648362276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495210591411
                                         uncertainty =       0.002648362276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497647663
  error estimate for blocks of size 2^( 2) =       0.000515842868
  error estimate for blocks of size 2^( 3) =       0.000532006363
  error estimate for blocks of size 2^( 4) =       0.000543155590
  error estimate for blocks of size 2^( 5) =       0.000550177759
  error estimate for blocks of size 2^( 6) =       0.000554148223
  error estimate for blocks of size 2^( 7) =       0.000554280276

      target function =                  N/A
              le_mean =     -22.669719779758
             les_mean =     514.424184682171
             stat err =       0.000550440462
             autocorr =       1.223423345196
              std dev =       0.703780074167
             le_variance =       0.495306392795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495210591411
                                         uncertainty =       0.002648362276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495210591411
                                         uncertainty =       0.002648362276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497647663
  error estimate for blocks of size 2^( 2) =       0.000515842868
  error estimate for blocks of size 2^( 3) =       0.000532006363
  error estimate for blocks of size 2^( 4) =       0.000543155590
  error estimate for blocks of size 2^( 5) =       0.000550177759
  error estimate for blocks of size 2^( 6) =       0.000554148223
  error estimate for blocks of size 2^( 7) =       0.000554280276

      target function =                  N/A
              le_mean =     -22.669719779758
             les_mean =     514.424184682171
             stat err =       0.000550440462
             autocorr =       1.223423345196
              std dev =       0.703780074167
             le_variance =       0.495306392795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669719779758        initial  <--
     2.3842e+55     2.3842e+56             2.0998e-59       -22.669719779758
     9.5367e+55     9.5367e+56             5.2495e-60       -22.669719779758
     3.8147e+56     3.8147e+57             1.3124e-60       -22.669719779758

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5938
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4278e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.6789
    reference variance = 0.324581
====================================================
  Execution time = 2.7742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0635e-01
  Total weights = 1.955259669e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493823550345
                                         uncertainty =       0.002535926098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493823550345
                                         uncertainty =       0.002535926098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496880038
  error estimate for blocks of size 2^( 2) =       0.000514386166
  error estimate for blocks of size 2^( 3) =       0.000530795918
  error estimate for blocks of size 2^( 4) =       0.000541728797
  error estimate for blocks of size 2^( 5) =       0.000548627329
  error estimate for blocks of size 2^( 6) =       0.000552313911
  error estimate for blocks of size 2^( 7) =       0.000555810460

      target function =                  N/A
              le_mean =     -22.669118845506
             les_mean =     514.395303975866
             stat err =       0.000549620124
             autocorr =       1.223551216654
              std dev =       0.702694488461
             le_variance =       0.493779544114


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266911884551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+56, overlap shift 2.3842e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669118845599       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669118845599       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+56, overlap shift 9.5367e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669118845599       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669118845599       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+57, overlap shift 3.8147e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669118845599       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669118845599       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2525e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.6745
    reference variance = 0.441577
====================================================
  Execution time = 2.5356e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0493e-01
  Total weights = 1.9549e+06
  Execution time = 3.6416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493099097616
                                         uncertainty =       0.002625732655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493099097616
                                         uncertainty =       0.002625732655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496519315
  error estimate for blocks of size 2^( 2) =       0.000514089447
  error estimate for blocks of size 2^( 3) =       0.000529973182
  error estimate for blocks of size 2^( 4) =       0.000540743112
  error estimate for blocks of size 2^( 5) =       0.000546723038
  error estimate for blocks of size 2^( 6) =       0.000550776092
  error estimate for blocks of size 2^( 7) =       0.000550477318

      target function =                  N/A
              le_mean =     -22.669582022562
             les_mean =     514.414877259378
             stat err =       0.000547179890
             autocorr =       1.214473269939
              std dev =       0.702184349118
             le_variance =       0.493062860147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493099097616
                                         uncertainty =       0.002625732655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493099097616
                                         uncertainty =       0.002625732655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496519315
  error estimate for blocks of size 2^( 2) =       0.000514089447
  error estimate for blocks of size 2^( 3) =       0.000529973182
  error estimate for blocks of size 2^( 4) =       0.000540743112
  error estimate for blocks of size 2^( 5) =       0.000546723038
  error estimate for blocks of size 2^( 6) =       0.000550776092
  error estimate for blocks of size 2^( 7) =       0.000550477318

      target function =                  N/A
              le_mean =     -22.669582022562
             les_mean =     514.414877259378
             stat err =       0.000547179890
             autocorr =       1.214473269939
              std dev =       0.702184349118
             le_variance =       0.493062860147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493099097616
                                         uncertainty =       0.002625732655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493099097616
                                         uncertainty =       0.002625732655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496519315
  error estimate for blocks of size 2^( 2) =       0.000514089447
  error estimate for blocks of size 2^( 3) =       0.000529973182
  error estimate for blocks of size 2^( 4) =       0.000540743112
  error estimate for blocks of size 2^( 5) =       0.000546723038
  error estimate for blocks of size 2^( 6) =       0.000550776092
  error estimate for blocks of size 2^( 7) =       0.000550477318

      target function =                  N/A
              le_mean =     -22.669582022562
             les_mean =     514.414877259378
             stat err =       0.000547179890
             autocorr =       1.214473269939
              std dev =       0.702184349118
             le_variance =       0.493062860147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493099097616
                                         uncertainty =       0.002625732655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493099097616
                                         uncertainty =       0.002625732655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496519315
  error estimate for blocks of size 2^( 2) =       0.000514089447
  error estimate for blocks of size 2^( 3) =       0.000529973182
  error estimate for blocks of size 2^( 4) =       0.000540743112
  error estimate for blocks of size 2^( 5) =       0.000546723038
  error estimate for blocks of size 2^( 6) =       0.000550776092
  error estimate for blocks of size 2^( 7) =       0.000550477318

      target function =                  N/A
              le_mean =     -22.669582022562
             les_mean =     514.414877259378
             stat err =       0.000547179890
             autocorr =       1.214473269939
              std dev =       0.702184349118
             le_variance =       0.493062860147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669582022562        initial  <--
     2.3842e+56     2.3842e+57             0.0000e+00       -22.669582022562
     9.5367e+56     9.5367e+57             0.0000e+00       -22.669582022562
     3.8147e+57     3.8147e+58             0.0000e+00       -22.669582022562

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5961
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6127e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.711
    reference variance = 0.479678
====================================================
  Execution time = 2.5911e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0502e-01
  Total weights = 1.955130496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493110991330
                                         uncertainty =       0.002767476310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493110991330
                                         uncertainty =       0.002767476310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496615330
  error estimate for blocks of size 2^( 2) =       0.000514427368
  error estimate for blocks of size 2^( 3) =       0.000530355369
  error estimate for blocks of size 2^( 4) =       0.000541548198
  error estimate for blocks of size 2^( 5) =       0.000548636585
  error estimate for blocks of size 2^( 6) =       0.000553213434
  error estimate for blocks of size 2^( 7) =       0.000556409933

      target function =                  N/A
              le_mean =     -22.668739028875
             les_mean =     514.376744177451
             stat err =       0.000549952037
             autocorr =       1.226335744805
              std dev =       0.702320135099
             le_variance =       0.493253572165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266873902888e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+57, overlap shift 2.3842e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668739028976       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668739028976       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+57, overlap shift 9.5367e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668739028976       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668739028976       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+58, overlap shift 3.8147e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668739028976       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668739028976       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143863 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0655e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6332
    reference variance = 0.539456
====================================================
  Execution time = 2.5406e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0752e-01
  Total weights = 1.9554e+06
  Execution time = 3.6353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495125335620
                                         uncertainty =       0.002372990611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495125335620
                                         uncertainty =       0.002372990611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497536221
  error estimate for blocks of size 2^( 2) =       0.000515527489
  error estimate for blocks of size 2^( 3) =       0.000531663618
  error estimate for blocks of size 2^( 4) =       0.000542241917
  error estimate for blocks of size 2^( 5) =       0.000548215743
  error estimate for blocks of size 2^( 6) =       0.000551320895
  error estimate for blocks of size 2^( 7) =       0.000552796438

      target function =                  N/A
              le_mean =     -22.670115307364
             les_mean =     514.441644111517
             stat err =       0.000548643748
             autocorr =       1.215994085090
              std dev =       0.703622471981
             le_variance =       0.495084583077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495125335620
                                         uncertainty =       0.002372990611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495125335620
                                         uncertainty =       0.002372990611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497536221
  error estimate for blocks of size 2^( 2) =       0.000515527489
  error estimate for blocks of size 2^( 3) =       0.000531663618
  error estimate for blocks of size 2^( 4) =       0.000542241917
  error estimate for blocks of size 2^( 5) =       0.000548215743
  error estimate for blocks of size 2^( 6) =       0.000551320895
  error estimate for blocks of size 2^( 7) =       0.000552796438

      target function =                  N/A
              le_mean =     -22.670115307364
             les_mean =     514.441644111517
             stat err =       0.000548643748
             autocorr =       1.215994085090
              std dev =       0.703622471981
             le_variance =       0.495084583077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495125335620
                                         uncertainty =       0.002372990611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495125335620
                                         uncertainty =       0.002372990611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497536221
  error estimate for blocks of size 2^( 2) =       0.000515527489
  error estimate for blocks of size 2^( 3) =       0.000531663618
  error estimate for blocks of size 2^( 4) =       0.000542241917
  error estimate for blocks of size 2^( 5) =       0.000548215743
  error estimate for blocks of size 2^( 6) =       0.000551320895
  error estimate for blocks of size 2^( 7) =       0.000552796438

      target function =                  N/A
              le_mean =     -22.670115307364
             les_mean =     514.441644111517
             stat err =       0.000548643748
             autocorr =       1.215994085090
              std dev =       0.703622471981
             le_variance =       0.495084583077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495125335620
                                         uncertainty =       0.002372990611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495125335620
                                         uncertainty =       0.002372990611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497536221
  error estimate for blocks of size 2^( 2) =       0.000515527489
  error estimate for blocks of size 2^( 3) =       0.000531663618
  error estimate for blocks of size 2^( 4) =       0.000542241917
  error estimate for blocks of size 2^( 5) =       0.000548215743
  error estimate for blocks of size 2^( 6) =       0.000551320895
  error estimate for blocks of size 2^( 7) =       0.000552796438

      target function =                  N/A
              le_mean =     -22.670115307364
             les_mean =     514.441644111517
             stat err =       0.000548643748
             autocorr =       1.215994085090
              std dev =       0.703622471981
             le_variance =       0.495084583077


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670115307364        initial  <--
     2.3842e+57     2.3842e+58             0.0000e+00       -22.670115307364
     9.5367e+57     9.5367e+58             0.0000e+00       -22.670115307364
     3.8147e+58     3.8147e+59             0.0000e+00       -22.670115307364

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6539
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4315e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.6178
    reference variance = 0.288777
====================================================
  Execution time = 2.5865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0884e-01
  Total weights = 1.955391247e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495486407679
                                         uncertainty =       0.002235628547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495486407679
                                         uncertainty =       0.002235628547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497810792
  error estimate for blocks of size 2^( 2) =       0.000516023064
  error estimate for blocks of size 2^( 3) =       0.000532864124
  error estimate for blocks of size 2^( 4) =       0.000543894427
  error estimate for blocks of size 2^( 5) =       0.000549895327
  error estimate for blocks of size 2^( 6) =       0.000552621649
  error estimate for blocks of size 2^( 7) =       0.000556108679

      target function =                  N/A
              le_mean =     -22.670218228059
             les_mean =     514.447639380359
             stat err =       0.000550630021
             autocorr =       1.223463892443
              std dev =       0.704010773528
             le_variance =       0.495631169244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267021822806e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+58, overlap shift 2.3842e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670218228158       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670218228158       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670218228158       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670218228158       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+58 is 1.520693e-62

solving harmonic davidson linear method for identity shift 9.5367e+58, overlap shift 9.5367e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670218228158       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670218228158       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670218228158       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+58 is 3.884538e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+59, overlap shift 3.8147e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670218228158       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670218228158       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0604e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.7152
    reference variance = 0.611756
====================================================
  Execution time = 2.5316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1336e-01
  Total weights = 1.9551e+06
  Execution time = 3.6467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495063565385
                                         uncertainty =       0.002914485889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495063565385
                                         uncertainty =       0.002914485889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497497871
  error estimate for blocks of size 2^( 2) =       0.000515185438
  error estimate for blocks of size 2^( 3) =       0.000530792191
  error estimate for blocks of size 2^( 4) =       0.000542418852
  error estimate for blocks of size 2^( 5) =       0.000547235894
  error estimate for blocks of size 2^( 6) =       0.000550533365
  error estimate for blocks of size 2^( 7) =       0.000551865634

      target function =                  N/A
              le_mean =     -22.669872686651
             les_mean =     514.436492530432
             stat err =       0.000548013436
             autocorr =       1.213388737356
              std dev =       0.703568237016
             le_variance =       0.495008264138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495063565385
                                         uncertainty =       0.002914485889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495063565385
                                         uncertainty =       0.002914485889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497497871
  error estimate for blocks of size 2^( 2) =       0.000515185438
  error estimate for blocks of size 2^( 3) =       0.000530792191
  error estimate for blocks of size 2^( 4) =       0.000542418852
  error estimate for blocks of size 2^( 5) =       0.000547235894
  error estimate for blocks of size 2^( 6) =       0.000550533365
  error estimate for blocks of size 2^( 7) =       0.000551865634

      target function =                  N/A
              le_mean =     -22.669872686651
             les_mean =     514.436492530432
             stat err =       0.000548013436
             autocorr =       1.213388737356
              std dev =       0.703568237016
             le_variance =       0.495008264138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495063565385
                                         uncertainty =       0.002914485889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495063565385
                                         uncertainty =       0.002914485889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497497871
  error estimate for blocks of size 2^( 2) =       0.000515185438
  error estimate for blocks of size 2^( 3) =       0.000530792191
  error estimate for blocks of size 2^( 4) =       0.000542418852
  error estimate for blocks of size 2^( 5) =       0.000547235894
  error estimate for blocks of size 2^( 6) =       0.000550533365
  error estimate for blocks of size 2^( 7) =       0.000551865634

      target function =                  N/A
              le_mean =     -22.669872686651
             les_mean =     514.436492530432
             stat err =       0.000548013436
             autocorr =       1.213388737356
              std dev =       0.703568237016
             le_variance =       0.495008264138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495063565385
                                         uncertainty =       0.002914485889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495063565385
                                         uncertainty =       0.002914485889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497497871
  error estimate for blocks of size 2^( 2) =       0.000515185438
  error estimate for blocks of size 2^( 3) =       0.000530792191
  error estimate for blocks of size 2^( 4) =       0.000542418852
  error estimate for blocks of size 2^( 5) =       0.000547235894
  error estimate for blocks of size 2^( 6) =       0.000550533365
  error estimate for blocks of size 2^( 7) =       0.000551865634

      target function =                  N/A
              le_mean =     -22.669872686651
             les_mean =     514.436492530432
             stat err =       0.000548013436
             autocorr =       1.213388737356
              std dev =       0.703568237016
             le_variance =       0.495008264138


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669872686651        initial  <--
     2.3842e+58     2.3842e+59             1.5207e-62       -22.669872686651
     9.5367e+58     9.5367e+59             3.8845e-63       -22.669872686651
     3.8147e+59     3.8147e+60             0.0000e+00       -22.669872686651

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6093
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4221e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.6571
    reference variance = 0.504994
====================================================
  Execution time = 2.6764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0719e-01
  Total weights = 1.954793714e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495018312292
                                         uncertainty =       0.003014794485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495018312292
                                         uncertainty =       0.003014794485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497457817
  error estimate for blocks of size 2^( 2) =       0.000515346548
  error estimate for blocks of size 2^( 3) =       0.000531358853
  error estimate for blocks of size 2^( 4) =       0.000542510043
  error estimate for blocks of size 2^( 5) =       0.000548636367
  error estimate for blocks of size 2^( 6) =       0.000549863765
  error estimate for blocks of size 2^( 7) =       0.000552701709

      target function =                  N/A
              le_mean =     -22.668500579903
             les_mean =     514.368110410099
             stat err =       0.000548427971
             autocorr =       1.215420827256
              std dev =       0.703511591149
             le_variance =       0.494928558881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266850057990e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+59, overlap shift 2.3842e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668500579988       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668500579988       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+59, overlap shift 9.5367e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668500579988       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668500579988       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+60, overlap shift 3.8147e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668500579988       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668500579988       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1576e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.6636
    reference variance = 0.338185
====================================================
  Execution time = 2.6040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0938e-01
  Total weights = 1.9550e+06
  Execution time = 3.6431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494901515888
                                         uncertainty =       0.002287720080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494901515888
                                         uncertainty =       0.002287720080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497421567
  error estimate for blocks of size 2^( 2) =       0.000515358763
  error estimate for blocks of size 2^( 3) =       0.000531410477
  error estimate for blocks of size 2^( 4) =       0.000543303463
  error estimate for blocks of size 2^( 5) =       0.000550851408
  error estimate for blocks of size 2^( 6) =       0.000553514711
  error estimate for blocks of size 2^( 7) =       0.000556364090

      target function =                  N/A
              le_mean =     -22.668925557710
             les_mean =     514.389564998285
             stat err =       0.000551008418
             autocorr =       1.227064083797
              std dev =       0.703460326822
             le_variance =       0.494856431412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494901515888
                                         uncertainty =       0.002287720080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494901515888
                                         uncertainty =       0.002287720080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497421567
  error estimate for blocks of size 2^( 2) =       0.000515358763
  error estimate for blocks of size 2^( 3) =       0.000531410477
  error estimate for blocks of size 2^( 4) =       0.000543303463
  error estimate for blocks of size 2^( 5) =       0.000550851408
  error estimate for blocks of size 2^( 6) =       0.000553514711
  error estimate for blocks of size 2^( 7) =       0.000556364090

      target function =                  N/A
              le_mean =     -22.668925557710
             les_mean =     514.389564998285
             stat err =       0.000551008418
             autocorr =       1.227064083797
              std dev =       0.703460326822
             le_variance =       0.494856431412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494901515888
                                         uncertainty =       0.002287720080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494901515888
                                         uncertainty =       0.002287720080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497421567
  error estimate for blocks of size 2^( 2) =       0.000515358763
  error estimate for blocks of size 2^( 3) =       0.000531410477
  error estimate for blocks of size 2^( 4) =       0.000543303463
  error estimate for blocks of size 2^( 5) =       0.000550851408
  error estimate for blocks of size 2^( 6) =       0.000553514711
  error estimate for blocks of size 2^( 7) =       0.000556364090

      target function =                  N/A
              le_mean =     -22.668925557710
             les_mean =     514.389564998285
             stat err =       0.000551008418
             autocorr =       1.227064083797
              std dev =       0.703460326822
             le_variance =       0.494856431412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494901515888
                                         uncertainty =       0.002287720080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494901515888
                                         uncertainty =       0.002287720080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497421567
  error estimate for blocks of size 2^( 2) =       0.000515358763
  error estimate for blocks of size 2^( 3) =       0.000531410477
  error estimate for blocks of size 2^( 4) =       0.000543303463
  error estimate for blocks of size 2^( 5) =       0.000550851408
  error estimate for blocks of size 2^( 6) =       0.000553514711
  error estimate for blocks of size 2^( 7) =       0.000556364090

      target function =                  N/A
              le_mean =     -22.668925557710
             les_mean =     514.389564998285
             stat err =       0.000551008418
             autocorr =       1.227064083797
              std dev =       0.703460326822
             le_variance =       0.494856431412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668925557710        initial  <--
     2.3842e+59     2.3842e+60             0.0000e+00       -22.668925557710
     9.5367e+59     9.5367e+60             0.0000e+00       -22.668925557710
     3.8147e+60     3.8147e+61             0.0000e+00       -22.668925557710

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2819
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5864e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.6569
    reference variance = 0.561839
====================================================
  Execution time = 2.8544e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1341e-01
  Total weights = 1.955269797e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495116931305
                                         uncertainty =       0.002721480559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495116931305
                                         uncertainty =       0.002721480559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497496573
  error estimate for blocks of size 2^( 2) =       0.000515268176
  error estimate for blocks of size 2^( 3) =       0.000530836143
  error estimate for blocks of size 2^( 4) =       0.000542698531
  error estimate for blocks of size 2^( 5) =       0.000550369160
  error estimate for blocks of size 2^( 6) =       0.000552536616
  error estimate for blocks of size 2^( 7) =       0.000556120833

      target function =                  N/A
              le_mean =     -22.669088123528
             les_mean =     514.400970401427
             stat err =       0.000550431285
             autocorr =       1.224125749436
              std dev =       0.703566400600
             le_variance =       0.495005680053


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266908812353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+60, overlap shift 2.3842e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669088123672       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669088123672       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+60, overlap shift 9.5367e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669088123672       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669088123672       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+61, overlap shift 3.8147e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669088123672       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669088123672       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150470 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3348e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.5897
    reference variance = 0.312072
====================================================
  Execution time = 2.6014e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0887e-01
  Total weights = 1.9549e+06
  Execution time = 3.6707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497156703196
                                         uncertainty =       0.003125822035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497156703196
                                         uncertainty =       0.003125822035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498564930
  error estimate for blocks of size 2^( 2) =       0.000516773544
  error estimate for blocks of size 2^( 3) =       0.000532805333
  error estimate for blocks of size 2^( 4) =       0.000544222812
  error estimate for blocks of size 2^( 5) =       0.000553155529
  error estimate for blocks of size 2^( 6) =       0.000555188634
  error estimate for blocks of size 2^( 7) =       0.000556918093

      target function =                  N/A
              le_mean =     -22.668953134244
             les_mean =     514.390302362730
             stat err =       0.000552371267
             autocorr =       1.227492100263
              std dev =       0.705077286380
             le_variance =       0.497133979768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497156703196
                                         uncertainty =       0.003125822035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497156703196
                                         uncertainty =       0.003125822035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498564930
  error estimate for blocks of size 2^( 2) =       0.000516773544
  error estimate for blocks of size 2^( 3) =       0.000532805333
  error estimate for blocks of size 2^( 4) =       0.000544222812
  error estimate for blocks of size 2^( 5) =       0.000553155529
  error estimate for blocks of size 2^( 6) =       0.000555188634
  error estimate for blocks of size 2^( 7) =       0.000556918093

      target function =                  N/A
              le_mean =     -22.668953134244
             les_mean =     514.390302362730
             stat err =       0.000552371267
             autocorr =       1.227492100263
              std dev =       0.705077286380
             le_variance =       0.497133979768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497156703196
                                         uncertainty =       0.003125822035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497156703196
                                         uncertainty =       0.003125822035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498564930
  error estimate for blocks of size 2^( 2) =       0.000516773544
  error estimate for blocks of size 2^( 3) =       0.000532805333
  error estimate for blocks of size 2^( 4) =       0.000544222812
  error estimate for blocks of size 2^( 5) =       0.000553155529
  error estimate for blocks of size 2^( 6) =       0.000555188634
  error estimate for blocks of size 2^( 7) =       0.000556918093

      target function =                  N/A
              le_mean =     -22.668953134244
             les_mean =     514.390302362730
             stat err =       0.000552371267
             autocorr =       1.227492100263
              std dev =       0.705077286380
             le_variance =       0.497133979768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497156703196
                                         uncertainty =       0.003125822035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497156703196
                                         uncertainty =       0.003125822035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498564930
  error estimate for blocks of size 2^( 2) =       0.000516773544
  error estimate for blocks of size 2^( 3) =       0.000532805333
  error estimate for blocks of size 2^( 4) =       0.000544222812
  error estimate for blocks of size 2^( 5) =       0.000553155529
  error estimate for blocks of size 2^( 6) =       0.000555188634
  error estimate for blocks of size 2^( 7) =       0.000556918093

      target function =                  N/A
              le_mean =     -22.668953134244
             les_mean =     514.390302362730
             stat err =       0.000552371267
             autocorr =       1.227492100263
              std dev =       0.705077286380
             le_variance =       0.497133979768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668953134244        initial  <--
     2.3842e+60     2.3842e+61             0.0000e+00       -22.668953134244
     9.5367e+60     9.5367e+61             0.0000e+00       -22.668953134244
     3.8147e+61     3.8147e+62             0.0000e+00       -22.668953134244

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3123
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7675e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.7238
    reference variance = 0.317126
====================================================
  Execution time = 2.6679e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1058e-01
  Total weights = 1.955560819e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497133783088
                                         uncertainty =       0.002820712713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497133783088
                                         uncertainty =       0.002820712713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498560030
  error estimate for blocks of size 2^( 2) =       0.000516695638
  error estimate for blocks of size 2^( 3) =       0.000532795044
  error estimate for blocks of size 2^( 4) =       0.000543390736
  error estimate for blocks of size 2^( 5) =       0.000550848844
  error estimate for blocks of size 2^( 6) =       0.000555152199
  error estimate for blocks of size 2^( 7) =       0.000557182278

      target function =                  N/A
              le_mean =     -22.669925858815
             les_mean =     514.436115922744
             stat err =       0.000551643514
             autocorr =       1.224283844115
              std dev =       0.705070355477
             le_variance =       0.497124206172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266992585881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+61, overlap shift 2.3842e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669925858938       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669925858938       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+61 is 2.203684e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+61, overlap shift 9.5367e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669925858938       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669925858938       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+61 is 5.509210e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+62, overlap shift 3.8147e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669925858938       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669925858938       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+62 is 1.377303e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1496e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.7072
    reference variance = 0.414425
====================================================
  Execution time = 2.6880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0560e-01
  Total weights = 1.9550e+06
  Execution time = 3.6538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495139152301
                                         uncertainty =       0.002828878355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495139152301
                                         uncertainty =       0.002828878355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497507669
  error estimate for blocks of size 2^( 2) =       0.000515546046
  error estimate for blocks of size 2^( 3) =       0.000532028925
  error estimate for blocks of size 2^( 4) =       0.000543010648
  error estimate for blocks of size 2^( 5) =       0.000550562817
  error estimate for blocks of size 2^( 6) =       0.000553408337
  error estimate for blocks of size 2^( 7) =       0.000552629883

      target function =                  N/A
              le_mean =     -22.669329481441
             les_mean =     514.404094825433
             stat err =       0.000549902921
             autocorr =       1.221722278669
              std dev =       0.703582093177
             le_variance =       0.495027761839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495139152301
                                         uncertainty =       0.002828878355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495139152301
                                         uncertainty =       0.002828878355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497507669
  error estimate for blocks of size 2^( 2) =       0.000515546046
  error estimate for blocks of size 2^( 3) =       0.000532028925
  error estimate for blocks of size 2^( 4) =       0.000543010648
  error estimate for blocks of size 2^( 5) =       0.000550562817
  error estimate for blocks of size 2^( 6) =       0.000553408337
  error estimate for blocks of size 2^( 7) =       0.000552629883

      target function =                  N/A
              le_mean =     -22.669329481441
             les_mean =     514.404094825433
             stat err =       0.000549902921
             autocorr =       1.221722278669
              std dev =       0.703582093177
             le_variance =       0.495027761839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495139152301
                                         uncertainty =       0.002828878355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495139152301
                                         uncertainty =       0.002828878355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497507669
  error estimate for blocks of size 2^( 2) =       0.000515546046
  error estimate for blocks of size 2^( 3) =       0.000532028925
  error estimate for blocks of size 2^( 4) =       0.000543010648
  error estimate for blocks of size 2^( 5) =       0.000550562817
  error estimate for blocks of size 2^( 6) =       0.000553408337
  error estimate for blocks of size 2^( 7) =       0.000552629883

      target function =                  N/A
              le_mean =     -22.669329481441
             les_mean =     514.404094825433
             stat err =       0.000549902921
             autocorr =       1.221722278669
              std dev =       0.703582093177
             le_variance =       0.495027761839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495139152301
                                         uncertainty =       0.002828878355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495139152301
                                         uncertainty =       0.002828878355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497507669
  error estimate for blocks of size 2^( 2) =       0.000515546046
  error estimate for blocks of size 2^( 3) =       0.000532028925
  error estimate for blocks of size 2^( 4) =       0.000543010648
  error estimate for blocks of size 2^( 5) =       0.000550562817
  error estimate for blocks of size 2^( 6) =       0.000553408337
  error estimate for blocks of size 2^( 7) =       0.000552629883

      target function =                  N/A
              le_mean =     -22.669329481441
             les_mean =     514.404094825433
             stat err =       0.000549902921
             autocorr =       1.221722278669
              std dev =       0.703582093177
             le_variance =       0.495027761839


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669329481441        initial  <--
     2.3842e+61     2.3842e+62             2.2037e-65       -22.669329481441
     9.5367e+61     9.5367e+62             5.5092e-66       -22.669329481441
     3.8147e+62     3.8147e+63             1.3773e-66       -22.669329481441

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1631
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6675e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.724
    reference variance = 0.429608
====================================================
  Execution time = 2.6590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1248e-01
  Total weights = 1.955211415e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498041929803
                                         uncertainty =       0.002807048191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498041929803
                                         uncertainty =       0.002807048191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499026870
  error estimate for blocks of size 2^( 2) =       0.000517299616
  error estimate for blocks of size 2^( 3) =       0.000533208259
  error estimate for blocks of size 2^( 4) =       0.000543951361
  error estimate for blocks of size 2^( 5) =       0.000550618799
  error estimate for blocks of size 2^( 6) =       0.000554839053
  error estimate for blocks of size 2^( 7) =       0.000555781538

      target function =                  N/A
              le_mean =     -22.670181271233
             les_mean =     514.449599378809
             stat err =       0.000551297688
             autocorr =       1.220462612461
              std dev =       0.705730568245
             le_variance =       0.498055634955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267018127123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+62, overlap shift 2.3842e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670181271323       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670181271323       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+62, overlap shift 9.5367e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670181271323       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670181271323       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+63, overlap shift 3.8147e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670181271323       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670181271323       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1392e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7185
    reference variance = 0.400708
====================================================
  Execution time = 2.5823e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0692e-01
  Total weights = 1.9552e+06
  Execution time = 3.6343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496135007569
                                         uncertainty =       0.002593841668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496135007569
                                         uncertainty =       0.002593841668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498059704
  error estimate for blocks of size 2^( 2) =       0.000516216597
  error estimate for blocks of size 2^( 3) =       0.000532296619
  error estimate for blocks of size 2^( 4) =       0.000543664147
  error estimate for blocks of size 2^( 5) =       0.000550107141
  error estimate for blocks of size 2^( 6) =       0.000555556344
  error estimate for blocks of size 2^( 7) =       0.000562078002

      target function =                  N/A
              le_mean =     -22.669963458690
             les_mean =     514.434163207735
             stat err =       0.000552851408
             autocorr =       1.232122894791
              std dev =       0.704362788875
             le_variance =       0.496126938351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496135007569
                                         uncertainty =       0.002593841668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496135007569
                                         uncertainty =       0.002593841668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498059704
  error estimate for blocks of size 2^( 2) =       0.000516216597
  error estimate for blocks of size 2^( 3) =       0.000532296619
  error estimate for blocks of size 2^( 4) =       0.000543664147
  error estimate for blocks of size 2^( 5) =       0.000550107141
  error estimate for blocks of size 2^( 6) =       0.000555556344
  error estimate for blocks of size 2^( 7) =       0.000562078002

      target function =                  N/A
              le_mean =     -22.669963458690
             les_mean =     514.434163207735
             stat err =       0.000552851408
             autocorr =       1.232122894791
              std dev =       0.704362788875
             le_variance =       0.496126938351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496135007569
                                         uncertainty =       0.002593841668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496135007569
                                         uncertainty =       0.002593841668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498059704
  error estimate for blocks of size 2^( 2) =       0.000516216597
  error estimate for blocks of size 2^( 3) =       0.000532296619
  error estimate for blocks of size 2^( 4) =       0.000543664147
  error estimate for blocks of size 2^( 5) =       0.000550107141
  error estimate for blocks of size 2^( 6) =       0.000555556344
  error estimate for blocks of size 2^( 7) =       0.000562078002

      target function =                  N/A
              le_mean =     -22.669963458690
             les_mean =     514.434163207735
             stat err =       0.000552851408
             autocorr =       1.232122894791
              std dev =       0.704362788875
             le_variance =       0.496126938351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496135007569
                                         uncertainty =       0.002593841668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496135007569
                                         uncertainty =       0.002593841668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498059704
  error estimate for blocks of size 2^( 2) =       0.000516216597
  error estimate for blocks of size 2^( 3) =       0.000532296619
  error estimate for blocks of size 2^( 4) =       0.000543664147
  error estimate for blocks of size 2^( 5) =       0.000550107141
  error estimate for blocks of size 2^( 6) =       0.000555556344
  error estimate for blocks of size 2^( 7) =       0.000562078002

      target function =                  N/A
              le_mean =     -22.669963458690
             les_mean =     514.434163207735
             stat err =       0.000552851408
             autocorr =       1.232122894791
              std dev =       0.704362788875
             le_variance =       0.496126938351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669963458690        initial  <--
     2.3842e+62     2.3842e+63             0.0000e+00       -22.669963458690
     9.5367e+62     9.5367e+63             0.0000e+00       -22.669963458690
     3.8147e+63     3.8147e+64             0.0000e+00       -22.669963458690

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0514
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5460e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6576
    reference variance = 0.399881
====================================================
  Execution time = 2.6576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0715e-01
  Total weights = 1.955229069e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494331150691
                                         uncertainty =       0.003741112303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494331150691
                                         uncertainty =       0.003741112303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497107389
  error estimate for blocks of size 2^( 2) =       0.000515102451
  error estimate for blocks of size 2^( 3) =       0.000530800395
  error estimate for blocks of size 2^( 4) =       0.000542301976
  error estimate for blocks of size 2^( 5) =       0.000548240077
  error estimate for blocks of size 2^( 6) =       0.000551163277
  error estimate for blocks of size 2^( 7) =       0.000554526229

      target function =                  N/A
              le_mean =     -22.668724842198
             les_mean =     514.378232167454
             stat err =       0.000549057890
             autocorr =       1.219932595246
              std dev =       0.703016012144
             le_variance =       0.494231513330


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266872484220e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+63, overlap shift 2.3842e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668724842298       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668724842298       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+63, overlap shift 9.5367e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668724842298       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668724842298       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+64, overlap shift 3.8147e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668724842298       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668724842298       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162970 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1327e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6678
    reference variance = 0.215652
====================================================
  Execution time = 2.6560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1362e-01
  Total weights = 1.9555e+06
  Execution time = 3.6432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497047594772
                                         uncertainty =       0.002488302975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497047594772
                                         uncertainty =       0.002488302975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498480866
  error estimate for blocks of size 2^( 2) =       0.000516786932
  error estimate for blocks of size 2^( 3) =       0.000532960318
  error estimate for blocks of size 2^( 4) =       0.000542367968
  error estimate for blocks of size 2^( 5) =       0.000549900779
  error estimate for blocks of size 2^( 6) =       0.000553981721
  error estimate for blocks of size 2^( 7) =       0.000558697591

      target function =                  N/A
              le_mean =     -22.670070664889
             les_mean =     514.445719189770
             stat err =       0.000551237015
             autocorr =       1.222868499905
              std dev =       0.704958401814
             le_variance =       0.496966348289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497047594772
                                         uncertainty =       0.002488302975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497047594772
                                         uncertainty =       0.002488302975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498480866
  error estimate for blocks of size 2^( 2) =       0.000516786932
  error estimate for blocks of size 2^( 3) =       0.000532960318
  error estimate for blocks of size 2^( 4) =       0.000542367968
  error estimate for blocks of size 2^( 5) =       0.000549900779
  error estimate for blocks of size 2^( 6) =       0.000553981721
  error estimate for blocks of size 2^( 7) =       0.000558697591

      target function =                  N/A
              le_mean =     -22.670070664889
             les_mean =     514.445719189770
             stat err =       0.000551237015
             autocorr =       1.222868499905
              std dev =       0.704958401814
             le_variance =       0.496966348289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497047594772
                                         uncertainty =       0.002488302975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497047594772
                                         uncertainty =       0.002488302975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498480866
  error estimate for blocks of size 2^( 2) =       0.000516786932
  error estimate for blocks of size 2^( 3) =       0.000532960318
  error estimate for blocks of size 2^( 4) =       0.000542367968
  error estimate for blocks of size 2^( 5) =       0.000549900779
  error estimate for blocks of size 2^( 6) =       0.000553981721
  error estimate for blocks of size 2^( 7) =       0.000558697591

      target function =                  N/A
              le_mean =     -22.670070664889
             les_mean =     514.445719189770
             stat err =       0.000551237015
             autocorr =       1.222868499905
              std dev =       0.704958401814
             le_variance =       0.496966348289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497047594772
                                         uncertainty =       0.002488302975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497047594772
                                         uncertainty =       0.002488302975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498480866
  error estimate for blocks of size 2^( 2) =       0.000516786932
  error estimate for blocks of size 2^( 3) =       0.000532960318
  error estimate for blocks of size 2^( 4) =       0.000542367968
  error estimate for blocks of size 2^( 5) =       0.000549900779
  error estimate for blocks of size 2^( 6) =       0.000553981721
  error estimate for blocks of size 2^( 7) =       0.000558697591

      target function =                  N/A
              le_mean =     -22.670070664889
             les_mean =     514.445719189770
             stat err =       0.000551237015
             autocorr =       1.222868499905
              std dev =       0.704958401814
             le_variance =       0.496966348289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670070664889        initial  <--
     2.3842e+63     2.3842e+64             0.0000e+00       -22.670070664889
     9.5367e+63     9.5367e+64             0.0000e+00       -22.670070664889
     3.8147e+64     3.8147e+65             0.0000e+00       -22.670070664889

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.4558
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7808e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.7437
    reference variance = 0.357687
====================================================
  Execution time = 2.6652e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0695e-01
  Total weights = 1.955289052e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494695566728
                                         uncertainty =       0.002862636225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494695566728
                                         uncertainty =       0.002862636225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497376165
  error estimate for blocks of size 2^( 2) =       0.000515349830
  error estimate for blocks of size 2^( 3) =       0.000531602372
  error estimate for blocks of size 2^( 4) =       0.000543641771
  error estimate for blocks of size 2^( 5) =       0.000549307636
  error estimate for blocks of size 2^( 6) =       0.000553754008
  error estimate for blocks of size 2^( 7) =       0.000557457426

      target function =                  N/A
              le_mean =     -22.669790365635
             les_mean =     514.426343494414
             stat err =       0.000551040210
             autocorr =       1.227429744371
              std dev =       0.703396118190
             le_variance =       0.494766099084


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266979036563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+64, overlap shift 2.3842e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669790365704       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669790365704       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669790365704       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+64 is 1.473620e-68

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+64, overlap shift 9.5367e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669790365704       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669790365704       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669790365704       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+64 is 3.784885e-69

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+65, overlap shift 3.8147e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669790365704       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669790365704       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+65 is 9.210123e-70

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1474e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.7203
    reference variance = 0.353435
====================================================
  Execution time = 2.5892e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0770e-01
  Total weights = 1.9549e+06
  Execution time = 3.6609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496014330467
                                         uncertainty =       0.003020827710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496014330467
                                         uncertainty =       0.003020827710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498068419
  error estimate for blocks of size 2^( 2) =       0.000516120116
  error estimate for blocks of size 2^( 3) =       0.000532192158
  error estimate for blocks of size 2^( 4) =       0.000543360099
  error estimate for blocks of size 2^( 5) =       0.000549106378
  error estimate for blocks of size 2^( 6) =       0.000554162800
  error estimate for blocks of size 2^( 7) =       0.000554289812

      target function =                  N/A
              le_mean =     -22.668965270035
             les_mean =     514.389683261725
             stat err =       0.000550229772
             autocorr =       1.220422374090
              std dev =       0.704375112926
             le_variance =       0.496144299709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496014330467
                                         uncertainty =       0.003020827710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496014330467
                                         uncertainty =       0.003020827710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498068419
  error estimate for blocks of size 2^( 2) =       0.000516120116
  error estimate for blocks of size 2^( 3) =       0.000532192158
  error estimate for blocks of size 2^( 4) =       0.000543360099
  error estimate for blocks of size 2^( 5) =       0.000549106378
  error estimate for blocks of size 2^( 6) =       0.000554162800
  error estimate for blocks of size 2^( 7) =       0.000554289812

      target function =                  N/A
              le_mean =     -22.668965270035
             les_mean =     514.389683261725
             stat err =       0.000550229772
             autocorr =       1.220422374090
              std dev =       0.704375112926
             le_variance =       0.496144299709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496014330467
                                         uncertainty =       0.003020827710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496014330467
                                         uncertainty =       0.003020827710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498068419
  error estimate for blocks of size 2^( 2) =       0.000516120116
  error estimate for blocks of size 2^( 3) =       0.000532192158
  error estimate for blocks of size 2^( 4) =       0.000543360099
  error estimate for blocks of size 2^( 5) =       0.000549106378
  error estimate for blocks of size 2^( 6) =       0.000554162800
  error estimate for blocks of size 2^( 7) =       0.000554289812

      target function =                  N/A
              le_mean =     -22.668965270035
             les_mean =     514.389683261725
             stat err =       0.000550229772
             autocorr =       1.220422374090
              std dev =       0.704375112926
             le_variance =       0.496144299709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496014330467
                                         uncertainty =       0.003020827710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496014330467
                                         uncertainty =       0.003020827710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498068419
  error estimate for blocks of size 2^( 2) =       0.000516120116
  error estimate for blocks of size 2^( 3) =       0.000532192158
  error estimate for blocks of size 2^( 4) =       0.000543360099
  error estimate for blocks of size 2^( 5) =       0.000549106378
  error estimate for blocks of size 2^( 6) =       0.000554162800
  error estimate for blocks of size 2^( 7) =       0.000554289812

      target function =                  N/A
              le_mean =     -22.668965270035
             les_mean =     514.389683261725
             stat err =       0.000550229772
             autocorr =       1.220422374090
              std dev =       0.704375112926
             le_variance =       0.496144299709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668965270035        initial  <--
     2.3842e+64     2.3842e+65             1.4736e-68       -22.668965270035
     9.5367e+64     9.5367e+65             3.7849e-69       -22.668965270035
     3.8147e+65     3.8147e+66             9.2101e-70       -22.668965270035

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2303
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5710e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.624
    reference variance = 0.361298
====================================================
  Execution time = 2.6672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0989e-01
  Total weights = 1.954947883e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498321049429
                                         uncertainty =       0.003603568650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498321049429
                                         uncertainty =       0.003603568650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499557359
  error estimate for blocks of size 2^( 2) =       0.000517789417
  error estimate for blocks of size 2^( 3) =       0.000533714786
  error estimate for blocks of size 2^( 4) =       0.000545311524
  error estimate for blocks of size 2^( 5) =       0.000551501256
  error estimate for blocks of size 2^( 6) =       0.000553326348
  error estimate for blocks of size 2^( 7) =       0.000558982027

      target function =                  N/A
              le_mean =     -22.668095743719
             les_mean =     514.352455674885
             stat err =       0.000552280289
             autocorr =       1.222217127977
              std dev =       0.706480791614
             le_variance =       0.499115108919


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266809574372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+65, overlap shift 2.3842e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668095743783       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668095743783       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+65, overlap shift 9.5367e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668095743783       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668095743783       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+66, overlap shift 3.8147e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668095743783       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668095743783       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165358 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1447e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.6891
    reference variance = 0.385837
====================================================
  Execution time = 2.5966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1253e-01
  Total weights = 1.9551e+06
  Execution time = 3.6410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501386446407
                                         uncertainty =       0.005876285944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501386446407
                                         uncertainty =       0.005876285944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500670735
  error estimate for blocks of size 2^( 2) =       0.000518233151
  error estimate for blocks of size 2^( 3) =       0.000534640748
  error estimate for blocks of size 2^( 4) =       0.000545425664
  error estimate for blocks of size 2^( 5) =       0.000552411990
  error estimate for blocks of size 2^( 6) =       0.000555882990
  error estimate for blocks of size 2^( 7) =       0.000558813507

      target function =                  N/A
              le_mean =     -22.669900840050
             les_mean =     514.436932179187
             stat err =       0.000553133538
             autocorr =       1.220549982366
              std dev =       0.708055344147
             le_variance =       0.501342370375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501386446407
                                         uncertainty =       0.005876285944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501386446407
                                         uncertainty =       0.005876285944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500670735
  error estimate for blocks of size 2^( 2) =       0.000518233151
  error estimate for blocks of size 2^( 3) =       0.000534640748
  error estimate for blocks of size 2^( 4) =       0.000545425664
  error estimate for blocks of size 2^( 5) =       0.000552411990
  error estimate for blocks of size 2^( 6) =       0.000555882990
  error estimate for blocks of size 2^( 7) =       0.000558813507

      target function =                  N/A
              le_mean =     -22.669900840050
             les_mean =     514.436932179187
             stat err =       0.000553133538
             autocorr =       1.220549982366
              std dev =       0.708055344147
             le_variance =       0.501342370375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501386446407
                                         uncertainty =       0.005876285944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501386446407
                                         uncertainty =       0.005876285944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500670735
  error estimate for blocks of size 2^( 2) =       0.000518233151
  error estimate for blocks of size 2^( 3) =       0.000534640748
  error estimate for blocks of size 2^( 4) =       0.000545425664
  error estimate for blocks of size 2^( 5) =       0.000552411990
  error estimate for blocks of size 2^( 6) =       0.000555882990
  error estimate for blocks of size 2^( 7) =       0.000558813507

      target function =                  N/A
              le_mean =     -22.669900840050
             les_mean =     514.436932179187
             stat err =       0.000553133538
             autocorr =       1.220549982366
              std dev =       0.708055344147
             le_variance =       0.501342370375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501386446407
                                         uncertainty =       0.005876285944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501386446407
                                         uncertainty =       0.005876285944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500670735
  error estimate for blocks of size 2^( 2) =       0.000518233151
  error estimate for blocks of size 2^( 3) =       0.000534640748
  error estimate for blocks of size 2^( 4) =       0.000545425664
  error estimate for blocks of size 2^( 5) =       0.000552411990
  error estimate for blocks of size 2^( 6) =       0.000555882990
  error estimate for blocks of size 2^( 7) =       0.000558813507

      target function =                  N/A
              le_mean =     -22.669900840050
             les_mean =     514.436932179187
             stat err =       0.000553133538
             autocorr =       1.220549982366
              std dev =       0.708055344147
             le_variance =       0.501342370375


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669900840050        initial  <--
     2.3842e+65     2.3842e+66             0.0000e+00       -22.669900840050
     9.5367e+65     9.5367e+66             0.0000e+00       -22.669900840050
     3.8147e+66     3.8147e+67             0.0000e+00       -22.669900840050

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2498
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5702e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.5784
    reference variance = 0.594794
====================================================
  Execution time = 2.6790e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1564e-01
  Total weights = 1.954888745e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495853783422
                                         uncertainty =       0.002368970489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495853783422
                                         uncertainty =       0.002368970489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497944793
  error estimate for blocks of size 2^( 2) =       0.000515386236
  error estimate for blocks of size 2^( 3) =       0.000532030650
  error estimate for blocks of size 2^( 4) =       0.000542562249
  error estimate for blocks of size 2^( 5) =       0.000548249137
  error estimate for blocks of size 2^( 6) =       0.000551716225
  error estimate for blocks of size 2^( 7) =       0.000552413810

      target function =                  N/A
              le_mean =     -22.669878057463
             les_mean =     514.439013292144
             stat err =       0.000548735355
             autocorr =       1.214404852732
              std dev =       0.704200280231
             le_variance =       0.495898034678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266987805746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+66, overlap shift 2.3842e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669878057579       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669878057579       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+66, overlap shift 9.5367e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669878057579       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669878057579       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+67, overlap shift 3.8147e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669878057579       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669878057579       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1594e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.5549
    reference variance = 0.421298
====================================================
  Execution time = 2.5988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0627e-01
  Total weights = 1.9553e+06
  Execution time = 3.6449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495058937529
                                         uncertainty =       0.002499039303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495058937529
                                         uncertainty =       0.002499039303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497497645
  error estimate for blocks of size 2^( 2) =       0.000515477454
  error estimate for blocks of size 2^( 3) =       0.000531829294
  error estimate for blocks of size 2^( 4) =       0.000543826535
  error estimate for blocks of size 2^( 5) =       0.000550873222
  error estimate for blocks of size 2^( 6) =       0.000551822919
  error estimate for blocks of size 2^( 7) =       0.000555274849

      target function =                  N/A
              le_mean =     -22.669373588461
             les_mean =     514.406772898823
             stat err =       0.000550449381
             autocorr =       1.224200961329
              std dev =       0.703567917329
             le_variance =       0.495007814294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495058937529
                                         uncertainty =       0.002499039303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495058937529
                                         uncertainty =       0.002499039303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497497645
  error estimate for blocks of size 2^( 2) =       0.000515477454
  error estimate for blocks of size 2^( 3) =       0.000531829294
  error estimate for blocks of size 2^( 4) =       0.000543826535
  error estimate for blocks of size 2^( 5) =       0.000550873222
  error estimate for blocks of size 2^( 6) =       0.000551822919
  error estimate for blocks of size 2^( 7) =       0.000555274849

      target function =                  N/A
              le_mean =     -22.669373588461
             les_mean =     514.406772898823
             stat err =       0.000550449381
             autocorr =       1.224200961329
              std dev =       0.703567917329
             le_variance =       0.495007814294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495058937529
                                         uncertainty =       0.002499039303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495058937529
                                         uncertainty =       0.002499039303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497497645
  error estimate for blocks of size 2^( 2) =       0.000515477454
  error estimate for blocks of size 2^( 3) =       0.000531829294
  error estimate for blocks of size 2^( 4) =       0.000543826535
  error estimate for blocks of size 2^( 5) =       0.000550873222
  error estimate for blocks of size 2^( 6) =       0.000551822919
  error estimate for blocks of size 2^( 7) =       0.000555274849

      target function =                  N/A
              le_mean =     -22.669373588461
             les_mean =     514.406772898823
             stat err =       0.000550449381
             autocorr =       1.224200961329
              std dev =       0.703567917329
             le_variance =       0.495007814294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495058937529
                                         uncertainty =       0.002499039303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495058937529
                                         uncertainty =       0.002499039303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497497645
  error estimate for blocks of size 2^( 2) =       0.000515477454
  error estimate for blocks of size 2^( 3) =       0.000531829294
  error estimate for blocks of size 2^( 4) =       0.000543826535
  error estimate for blocks of size 2^( 5) =       0.000550873222
  error estimate for blocks of size 2^( 6) =       0.000551822919
  error estimate for blocks of size 2^( 7) =       0.000555274849

      target function =                  N/A
              le_mean =     -22.669373588461
             les_mean =     514.406772898823
             stat err =       0.000550449381
             autocorr =       1.224200961329
              std dev =       0.703567917329
             le_variance =       0.495007814294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669373588461        initial  <--
     2.3842e+66     2.3842e+67             0.0000e+00       -22.669373588461
     9.5367e+66     9.5367e+67             0.0000e+00       -22.669373588461
     3.8147e+67     3.8147e+68             0.0000e+00       -22.669373588461

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2186
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5818e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.651
    reference variance = 0.328408
====================================================
  Execution time = 2.6708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1677e-01
  Total weights = 1.955003713e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502649546358
                                         uncertainty =       0.005464218687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502649546358
                                         uncertainty =       0.005464218687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501286350
  error estimate for blocks of size 2^( 2) =       0.000518996217
  error estimate for blocks of size 2^( 3) =       0.000535198666
  error estimate for blocks of size 2^( 4) =       0.000547602816
  error estimate for blocks of size 2^( 5) =       0.000554419322
  error estimate for blocks of size 2^( 6) =       0.000559078128
  error estimate for blocks of size 2^( 7) =       0.000560491303

      target function =                  N/A
              le_mean =     -22.669752480677
             les_mean =     514.434451971846
             stat err =       0.000555397892
             autocorr =       1.227542948712
              std dev =       0.708925955012
             le_variance =       0.502576009689


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266975248068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+67, overlap shift 2.3842e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669752480785       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669752480785       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+67, overlap shift 9.5367e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669752480785       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669752480785       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+68, overlap shift 3.8147e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669752480785       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669752480785       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1499e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.6953
    reference variance = 0.737281
====================================================
  Execution time = 2.5905e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0911e-01
  Total weights = 1.9548e+06
  Execution time = 3.6441e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498297401883
                                         uncertainty =       0.002526580425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498297401883
                                         uncertainty =       0.002526580425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499130707
  error estimate for blocks of size 2^( 2) =       0.000517276462
  error estimate for blocks of size 2^( 3) =       0.000533217242
  error estimate for blocks of size 2^( 4) =       0.000544716324
  error estimate for blocks of size 2^( 5) =       0.000551533142
  error estimate for blocks of size 2^( 6) =       0.000555572230
  error estimate for blocks of size 2^( 7) =       0.000557747220

      target function =                  N/A
              le_mean =     -22.669749078950
             les_mean =     514.426629433311
             stat err =       0.000552392229
             autocorr =       1.224803850857
              std dev =       0.705877415408
             le_variance =       0.498262925583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498297401883
                                         uncertainty =       0.002526580425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498297401883
                                         uncertainty =       0.002526580425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499130707
  error estimate for blocks of size 2^( 2) =       0.000517276462
  error estimate for blocks of size 2^( 3) =       0.000533217242
  error estimate for blocks of size 2^( 4) =       0.000544716324
  error estimate for blocks of size 2^( 5) =       0.000551533142
  error estimate for blocks of size 2^( 6) =       0.000555572230
  error estimate for blocks of size 2^( 7) =       0.000557747220

      target function =                  N/A
              le_mean =     -22.669749078950
             les_mean =     514.426629433311
             stat err =       0.000552392229
             autocorr =       1.224803850857
              std dev =       0.705877415408
             le_variance =       0.498262925583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498297401883
                                         uncertainty =       0.002526580425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498297401883
                                         uncertainty =       0.002526580425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499130707
  error estimate for blocks of size 2^( 2) =       0.000517276462
  error estimate for blocks of size 2^( 3) =       0.000533217242
  error estimate for blocks of size 2^( 4) =       0.000544716324
  error estimate for blocks of size 2^( 5) =       0.000551533142
  error estimate for blocks of size 2^( 6) =       0.000555572230
  error estimate for blocks of size 2^( 7) =       0.000557747220

      target function =                  N/A
              le_mean =     -22.669749078950
             les_mean =     514.426629433311
             stat err =       0.000552392229
             autocorr =       1.224803850857
              std dev =       0.705877415408
             le_variance =       0.498262925583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498297401883
                                         uncertainty =       0.002526580425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498297401883
                                         uncertainty =       0.002526580425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499130707
  error estimate for blocks of size 2^( 2) =       0.000517276462
  error estimate for blocks of size 2^( 3) =       0.000533217242
  error estimate for blocks of size 2^( 4) =       0.000544716324
  error estimate for blocks of size 2^( 5) =       0.000551533142
  error estimate for blocks of size 2^( 6) =       0.000555572230
  error estimate for blocks of size 2^( 7) =       0.000557747220

      target function =                  N/A
              le_mean =     -22.669749078950
             les_mean =     514.426629433311
             stat err =       0.000552392229
             autocorr =       1.224803850857
              std dev =       0.705877415408
             le_variance =       0.498262925583


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669749078950        initial  <--
     2.3842e+67     2.3842e+68             0.0000e+00       -22.669749078950
     9.5367e+67     9.5367e+68             0.0000e+00       -22.669749078950
     3.8147e+68     3.8147e+69             0.0000e+00       -22.669749078950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.8833
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9388e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.6211
    reference variance = 0.8347
====================================================
  Execution time = 2.6793e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1631e-01
  Total weights = 1.955311540e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501724115378
                                         uncertainty =       0.003204732082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501724115378
                                         uncertainty =       0.003204732082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500843230
  error estimate for blocks of size 2^( 2) =       0.000519095050
  error estimate for blocks of size 2^( 3) =       0.000535678430
  error estimate for blocks of size 2^( 4) =       0.000546993438
  error estimate for blocks of size 2^( 5) =       0.000552778213
  error estimate for blocks of size 2^( 6) =       0.000556233512
  error estimate for blocks of size 2^( 7) =       0.000557022992

      target function =                  N/A
              le_mean =     -22.669476826446
             les_mean =     514.421491015320
             stat err =       0.000553257039
             autocorr =       1.220254112904
              std dev =       0.708299288547
             le_variance =       0.501687882157


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266947682645e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+68, overlap shift 2.3842e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669476826544       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669476826544       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+68, overlap shift 9.5367e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669476826544       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669476826544       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+69, overlap shift 3.8147e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669476826544       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669476826544       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1583e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.7441
    reference variance = 0.431835
====================================================
  Execution time = 2.5969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1111e-01
  Total weights = 1.9555e+06
  Execution time = 3.6516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499856773341
                                         uncertainty =       0.003546214557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499856773341
                                         uncertainty =       0.003546214557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500022771
  error estimate for blocks of size 2^( 2) =       0.000517848316
  error estimate for blocks of size 2^( 3) =       0.000534155729
  error estimate for blocks of size 2^( 4) =       0.000546367426
  error estimate for blocks of size 2^( 5) =       0.000552731456
  error estimate for blocks of size 2^( 6) =       0.000556044721
  error estimate for blocks of size 2^( 7) =       0.000559949976

      target function =                  N/A
              le_mean =     -22.670239002082
             les_mean =     514.450846699806
             stat err =       0.000553773395
             autocorr =       1.226548171994
              std dev =       0.707138983792
             le_variance =       0.500045542398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499856773341
                                         uncertainty =       0.003546214557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499856773341
                                         uncertainty =       0.003546214557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500022771
  error estimate for blocks of size 2^( 2) =       0.000517848316
  error estimate for blocks of size 2^( 3) =       0.000534155729
  error estimate for blocks of size 2^( 4) =       0.000546367426
  error estimate for blocks of size 2^( 5) =       0.000552731456
  error estimate for blocks of size 2^( 6) =       0.000556044721
  error estimate for blocks of size 2^( 7) =       0.000559949976

      target function =                  N/A
              le_mean =     -22.670239002082
             les_mean =     514.450846699806
             stat err =       0.000553773395
             autocorr =       1.226548171994
              std dev =       0.707138983792
             le_variance =       0.500045542398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499856773341
                                         uncertainty =       0.003546214557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499856773341
                                         uncertainty =       0.003546214557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500022771
  error estimate for blocks of size 2^( 2) =       0.000517848316
  error estimate for blocks of size 2^( 3) =       0.000534155729
  error estimate for blocks of size 2^( 4) =       0.000546367426
  error estimate for blocks of size 2^( 5) =       0.000552731456
  error estimate for blocks of size 2^( 6) =       0.000556044721
  error estimate for blocks of size 2^( 7) =       0.000559949976

      target function =                  N/A
              le_mean =     -22.670239002082
             les_mean =     514.450846699806
             stat err =       0.000553773395
             autocorr =       1.226548171994
              std dev =       0.707138983792
             le_variance =       0.500045542398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499856773341
                                         uncertainty =       0.003546214557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499856773341
                                         uncertainty =       0.003546214557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500022771
  error estimate for blocks of size 2^( 2) =       0.000517848316
  error estimate for blocks of size 2^( 3) =       0.000534155729
  error estimate for blocks of size 2^( 4) =       0.000546367426
  error estimate for blocks of size 2^( 5) =       0.000552731456
  error estimate for blocks of size 2^( 6) =       0.000556044721
  error estimate for blocks of size 2^( 7) =       0.000559949976

      target function =                  N/A
              le_mean =     -22.670239002082
             les_mean =     514.450846699806
             stat err =       0.000553773395
             autocorr =       1.226548171994
              std dev =       0.707138983792
             le_variance =       0.500045542398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670239002082        initial  <--
     2.3842e+68     2.3842e+69             0.0000e+00       -22.670239002082
     9.5367e+68     9.5367e+69             0.0000e+00       -22.670239002082
     3.8147e+69     3.8147e+70             0.0000e+00       -22.670239002082

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2947
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5884e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7331
    reference variance = 0.387898
====================================================
  Execution time = 2.6623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0568e-01
  Total weights = 1.954746166e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494432926739
                                         uncertainty =       0.002465944348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494432926739
                                         uncertainty =       0.002465944348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497205026
  error estimate for blocks of size 2^( 2) =       0.000515349691
  error estimate for blocks of size 2^( 3) =       0.000531085507
  error estimate for blocks of size 2^( 4) =       0.000542409117
  error estimate for blocks of size 2^( 5) =       0.000548307667
  error estimate for blocks of size 2^( 6) =       0.000552601547
  error estimate for blocks of size 2^( 7) =       0.000553666650

      target function =                  N/A
              le_mean =     -22.669825189158
             les_mean =     514.426655732815
             stat err =       0.000549246245
             autocorr =       1.220290342048
              std dev =       0.703154090367
             le_variance =       0.494425674800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266982518916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+69, overlap shift 2.3842e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669825189243       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669825189243       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+69, overlap shift 9.5367e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669825189243       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669825189243       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+70, overlap shift 3.8147e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669825189243       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669825189243       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1424e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7542
    reference variance = 0.502746
====================================================
  Execution time = 2.5892e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1028e-01
  Total weights = 1.9549e+06
  Execution time = 3.6445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496296161664
                                         uncertainty =       0.003816567323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496296161664
                                         uncertainty =       0.003816567323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498092268
  error estimate for blocks of size 2^( 2) =       0.000516045828
  error estimate for blocks of size 2^( 3) =       0.000532529869
  error estimate for blocks of size 2^( 4) =       0.000543740668
  error estimate for blocks of size 2^( 5) =       0.000549193039
  error estimate for blocks of size 2^( 6) =       0.000552014486
  error estimate for blocks of size 2^( 7) =       0.000552836206

      target function =                  N/A
              le_mean =     -22.669839481743
             les_mean =     514.431902356080
             stat err =       0.000549446100
             autocorr =       1.216831908702
              std dev =       0.704408840596
             le_variance =       0.496191814710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496296161664
                                         uncertainty =       0.003816567323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496296161664
                                         uncertainty =       0.003816567323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498092268
  error estimate for blocks of size 2^( 2) =       0.000516045828
  error estimate for blocks of size 2^( 3) =       0.000532529869
  error estimate for blocks of size 2^( 4) =       0.000543740668
  error estimate for blocks of size 2^( 5) =       0.000549193039
  error estimate for blocks of size 2^( 6) =       0.000552014486
  error estimate for blocks of size 2^( 7) =       0.000552836206

      target function =                  N/A
              le_mean =     -22.669839481743
             les_mean =     514.431902356080
             stat err =       0.000549446100
             autocorr =       1.216831908702
              std dev =       0.704408840596
             le_variance =       0.496191814710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496296161664
                                         uncertainty =       0.003816567323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496296161664
                                         uncertainty =       0.003816567323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498092268
  error estimate for blocks of size 2^( 2) =       0.000516045828
  error estimate for blocks of size 2^( 3) =       0.000532529869
  error estimate for blocks of size 2^( 4) =       0.000543740668
  error estimate for blocks of size 2^( 5) =       0.000549193039
  error estimate for blocks of size 2^( 6) =       0.000552014486
  error estimate for blocks of size 2^( 7) =       0.000552836206

      target function =                  N/A
              le_mean =     -22.669839481743
             les_mean =     514.431902356080
             stat err =       0.000549446100
             autocorr =       1.216831908702
              std dev =       0.704408840596
             le_variance =       0.496191814710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496296161664
                                         uncertainty =       0.003816567323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496296161664
                                         uncertainty =       0.003816567323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498092268
  error estimate for blocks of size 2^( 2) =       0.000516045828
  error estimate for blocks of size 2^( 3) =       0.000532529869
  error estimate for blocks of size 2^( 4) =       0.000543740668
  error estimate for blocks of size 2^( 5) =       0.000549193039
  error estimate for blocks of size 2^( 6) =       0.000552014486
  error estimate for blocks of size 2^( 7) =       0.000552836206

      target function =                  N/A
              le_mean =     -22.669839481743
             les_mean =     514.431902356080
             stat err =       0.000549446100
             autocorr =       1.216831908702
              std dev =       0.704408840596
             le_variance =       0.496191814710


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669839481743        initial  <--
     2.3842e+69     2.3842e+70             0.0000e+00       -22.669839481743
     9.5367e+69     9.5367e+70             0.0000e+00       -22.669839481743
     3.8147e+70     3.8147e+71             0.0000e+00       -22.669839481743

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1542
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.6234
    reference variance = 0.321841
====================================================
  Execution time = 2.6730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1766e-01
  Total weights = 1.954860075e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499924142808
                                         uncertainty =       0.004162958586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499924142808
                                         uncertainty =       0.004162958586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499977285
  error estimate for blocks of size 2^( 2) =       0.000517671608
  error estimate for blocks of size 2^( 3) =       0.000533581713
  error estimate for blocks of size 2^( 4) =       0.000545133976
  error estimate for blocks of size 2^( 5) =       0.000551391873
  error estimate for blocks of size 2^( 6) =       0.000554807645
  error estimate for blocks of size 2^( 7) =       0.000554390946

      target function =                  N/A
              le_mean =     -22.669234184377
             les_mean =     514.411834840272
             stat err =       0.000551431110
             autocorr =       1.216415598903
              std dev =       0.707074657071
             le_variance =       0.499954570672


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266923418438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+70, overlap shift 2.3842e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669234184460       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669234184460       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+70 is 6.917970e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+70, overlap shift 9.5367e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669234184460       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669234184460       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+70 is 1.729493e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+71, overlap shift 3.8147e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669234184460       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669234184460       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+71 is 4.323731e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170851 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1476e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.7538
    reference variance = 0.329752
====================================================
  Execution time = 2.6009e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0744e-01
  Total weights = 1.9550e+06
  Execution time = 3.6372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495944847336
                                         uncertainty =       0.002538327602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495944847336
                                         uncertainty =       0.002538327602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497964862
  error estimate for blocks of size 2^( 2) =       0.000515554905
  error estimate for blocks of size 2^( 3) =       0.000531326606
  error estimate for blocks of size 2^( 4) =       0.000542452186
  error estimate for blocks of size 2^( 5) =       0.000551496540
  error estimate for blocks of size 2^( 6) =       0.000556410700
  error estimate for blocks of size 2^( 7) =       0.000558745618

      target function =                  N/A
              le_mean =     -22.669399432020
             les_mean =     514.409108895031
             stat err =       0.000552276261
             autocorr =       1.230029010320
              std dev =       0.704228661416
             le_variance =       0.495938007559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495944847336
                                         uncertainty =       0.002538327602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495944847336
                                         uncertainty =       0.002538327602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497964862
  error estimate for blocks of size 2^( 2) =       0.000515554905
  error estimate for blocks of size 2^( 3) =       0.000531326606
  error estimate for blocks of size 2^( 4) =       0.000542452186
  error estimate for blocks of size 2^( 5) =       0.000551496540
  error estimate for blocks of size 2^( 6) =       0.000556410700
  error estimate for blocks of size 2^( 7) =       0.000558745618

      target function =                  N/A
              le_mean =     -22.669399432020
             les_mean =     514.409108895031
             stat err =       0.000552276261
             autocorr =       1.230029010320
              std dev =       0.704228661416
             le_variance =       0.495938007559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495944847336
                                         uncertainty =       0.002538327602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495944847336
                                         uncertainty =       0.002538327602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497964862
  error estimate for blocks of size 2^( 2) =       0.000515554905
  error estimate for blocks of size 2^( 3) =       0.000531326606
  error estimate for blocks of size 2^( 4) =       0.000542452186
  error estimate for blocks of size 2^( 5) =       0.000551496540
  error estimate for blocks of size 2^( 6) =       0.000556410700
  error estimate for blocks of size 2^( 7) =       0.000558745618

      target function =                  N/A
              le_mean =     -22.669399432020
             les_mean =     514.409108895031
             stat err =       0.000552276261
             autocorr =       1.230029010320
              std dev =       0.704228661416
             le_variance =       0.495938007559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495944847336
                                         uncertainty =       0.002538327602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495944847336
                                         uncertainty =       0.002538327602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497964862
  error estimate for blocks of size 2^( 2) =       0.000515554905
  error estimate for blocks of size 2^( 3) =       0.000531326606
  error estimate for blocks of size 2^( 4) =       0.000542452186
  error estimate for blocks of size 2^( 5) =       0.000551496540
  error estimate for blocks of size 2^( 6) =       0.000556410700
  error estimate for blocks of size 2^( 7) =       0.000558745618

      target function =                  N/A
              le_mean =     -22.669399432020
             les_mean =     514.409108895031
             stat err =       0.000552276261
             autocorr =       1.230029010320
              std dev =       0.704228661416
             le_variance =       0.495938007559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669399432020        initial  <--
     2.3842e+70     2.3842e+71             6.9180e-74       -22.669399432020
     9.5367e+70     9.5367e+71             1.7295e-74       -22.669399432020
     3.8147e+71     3.8147e+72             4.3237e-75       -22.669399432020

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2372
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5719e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.6856
    reference variance = 0.512042
====================================================
  Execution time = 2.6573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0790e-01
  Total weights = 1.954958255e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496427770186
                                         uncertainty =       0.002815435435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496427770186
                                         uncertainty =       0.002815435435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498240098
  error estimate for blocks of size 2^( 2) =       0.000515613536
  error estimate for blocks of size 2^( 3) =       0.000531575092
  error estimate for blocks of size 2^( 4) =       0.000542408568
  error estimate for blocks of size 2^( 5) =       0.000550379170
  error estimate for blocks of size 2^( 6) =       0.000553760663
  error estimate for blocks of size 2^( 7) =       0.000555036879

      target function =                  N/A
              le_mean =     -22.668450992664
             les_mean =     514.366570143391
             stat err =       0.000550396320
             autocorr =       1.220319893570
              std dev =       0.704617903522
             le_variance =       0.496486389964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266845099266e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+71, overlap shift 2.3842e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668450992741       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668450992741       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+71, overlap shift 9.5367e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668450992741       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668450992741       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+72, overlap shift 3.8147e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668450992741       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668450992741       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171943 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1360e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.6868
    reference variance = 0.509691
====================================================
  Execution time = 2.5763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0510e-01
  Total weights = 1.9551e+06
  Execution time = 3.6499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493811577345
                                         uncertainty =       0.003088007478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493811577345
                                         uncertainty =       0.003088007478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496897844
  error estimate for blocks of size 2^( 2) =       0.000514737856
  error estimate for blocks of size 2^( 3) =       0.000531342553
  error estimate for blocks of size 2^( 4) =       0.000542896160
  error estimate for blocks of size 2^( 5) =       0.000551288870
  error estimate for blocks of size 2^( 6) =       0.000554716291
  error estimate for blocks of size 2^( 7) =       0.000556911028

      target function =                  N/A
              le_mean =     -22.669969342270
             les_mean =     514.432612756648
             stat err =       0.000551453087
             autocorr =       1.231637548055
              std dev =       0.702719669474
             le_variance =       0.493814933866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493811577345
                                         uncertainty =       0.003088007478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493811577345
                                         uncertainty =       0.003088007478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496897844
  error estimate for blocks of size 2^( 2) =       0.000514737856
  error estimate for blocks of size 2^( 3) =       0.000531342553
  error estimate for blocks of size 2^( 4) =       0.000542896160
  error estimate for blocks of size 2^( 5) =       0.000551288870
  error estimate for blocks of size 2^( 6) =       0.000554716291
  error estimate for blocks of size 2^( 7) =       0.000556911028

      target function =                  N/A
              le_mean =     -22.669969342270
             les_mean =     514.432612756648
             stat err =       0.000551453087
             autocorr =       1.231637548055
              std dev =       0.702719669474
             le_variance =       0.493814933866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493811577345
                                         uncertainty =       0.003088007478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493811577345
                                         uncertainty =       0.003088007478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496897844
  error estimate for blocks of size 2^( 2) =       0.000514737856
  error estimate for blocks of size 2^( 3) =       0.000531342553
  error estimate for blocks of size 2^( 4) =       0.000542896160
  error estimate for blocks of size 2^( 5) =       0.000551288870
  error estimate for blocks of size 2^( 6) =       0.000554716291
  error estimate for blocks of size 2^( 7) =       0.000556911028

      target function =                  N/A
              le_mean =     -22.669969342270
             les_mean =     514.432612756648
             stat err =       0.000551453087
             autocorr =       1.231637548055
              std dev =       0.702719669474
             le_variance =       0.493814933866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493811577345
                                         uncertainty =       0.003088007478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493811577345
                                         uncertainty =       0.003088007478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496897844
  error estimate for blocks of size 2^( 2) =       0.000514737856
  error estimate for blocks of size 2^( 3) =       0.000531342553
  error estimate for blocks of size 2^( 4) =       0.000542896160
  error estimate for blocks of size 2^( 5) =       0.000551288870
  error estimate for blocks of size 2^( 6) =       0.000554716291
  error estimate for blocks of size 2^( 7) =       0.000556911028

      target function =                  N/A
              le_mean =     -22.669969342270
             les_mean =     514.432612756648
             stat err =       0.000551453087
             autocorr =       1.231637548055
              std dev =       0.702719669474
             le_variance =       0.493814933866


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669969342270        initial  <--
     2.3842e+71     2.3842e+72             0.0000e+00       -22.669969342270
     9.5367e+71     9.5367e+72             0.0000e+00       -22.669969342270
     3.8147e+72     3.8147e+73             0.0000e+00       -22.669969342270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2036
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6570e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.6656
    reference variance = 0.334248
====================================================
  Execution time = 2.6710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0822e-01
  Total weights = 1.954971427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497211332177
                                         uncertainty =       0.003302948752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497211332177
                                         uncertainty =       0.003302948752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498673995
  error estimate for blocks of size 2^( 2) =       0.000516459218
  error estimate for blocks of size 2^( 3) =       0.000532486637
  error estimate for blocks of size 2^( 4) =       0.000543981152
  error estimate for blocks of size 2^( 5) =       0.000549707955
  error estimate for blocks of size 2^( 6) =       0.000553324201
  error estimate for blocks of size 2^( 7) =       0.000556298821

      target function =                  N/A
              le_mean =     -22.670149343891
             les_mean =     514.443890265758
             stat err =       0.000550828032
             autocorr =       1.220108983380
              std dev =       0.705231527530
             le_variance =       0.497351507423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267014934389e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+72, overlap shift 2.3842e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670149344006       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670149344006       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+72, overlap shift 9.5367e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670149344006       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670149344006       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+73, overlap shift 3.8147e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670149344006       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670149344006       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1456e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.6326
    reference variance = 0.372003
====================================================
  Execution time = 2.5757e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0811e-01
  Total weights = 1.9554e+06
  Execution time = 3.6405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496042516000
                                         uncertainty =       0.002950420888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496042516000
                                         uncertainty =       0.002950420888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498022306
  error estimate for blocks of size 2^( 2) =       0.000515794583
  error estimate for blocks of size 2^( 3) =       0.000531741724
  error estimate for blocks of size 2^( 4) =       0.000544431048
  error estimate for blocks of size 2^( 5) =       0.000552307231
  error estimate for blocks of size 2^( 6) =       0.000556382142
  error estimate for blocks of size 2^( 7) =       0.000558693310

      target function =                  N/A
              le_mean =     -22.669147130668
             les_mean =     514.398337039072
             stat err =       0.000552953433
             autocorr =       1.232762820938
              std dev =       0.704309899066
             le_variance =       0.496052433922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496042516000
                                         uncertainty =       0.002950420888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496042516000
                                         uncertainty =       0.002950420888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498022306
  error estimate for blocks of size 2^( 2) =       0.000515794583
  error estimate for blocks of size 2^( 3) =       0.000531741724
  error estimate for blocks of size 2^( 4) =       0.000544431048
  error estimate for blocks of size 2^( 5) =       0.000552307231
  error estimate for blocks of size 2^( 6) =       0.000556382142
  error estimate for blocks of size 2^( 7) =       0.000558693310

      target function =                  N/A
              le_mean =     -22.669147130668
             les_mean =     514.398337039072
             stat err =       0.000552953433
             autocorr =       1.232762820938
              std dev =       0.704309899066
             le_variance =       0.496052433922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496042516000
                                         uncertainty =       0.002950420888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496042516000
                                         uncertainty =       0.002950420888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498022306
  error estimate for blocks of size 2^( 2) =       0.000515794583
  error estimate for blocks of size 2^( 3) =       0.000531741724
  error estimate for blocks of size 2^( 4) =       0.000544431048
  error estimate for blocks of size 2^( 5) =       0.000552307231
  error estimate for blocks of size 2^( 6) =       0.000556382142
  error estimate for blocks of size 2^( 7) =       0.000558693310

      target function =                  N/A
              le_mean =     -22.669147130668
             les_mean =     514.398337039072
             stat err =       0.000552953433
             autocorr =       1.232762820938
              std dev =       0.704309899066
             le_variance =       0.496052433922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496042516000
                                         uncertainty =       0.002950420888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496042516000
                                         uncertainty =       0.002950420888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498022306
  error estimate for blocks of size 2^( 2) =       0.000515794583
  error estimate for blocks of size 2^( 3) =       0.000531741724
  error estimate for blocks of size 2^( 4) =       0.000544431048
  error estimate for blocks of size 2^( 5) =       0.000552307231
  error estimate for blocks of size 2^( 6) =       0.000556382142
  error estimate for blocks of size 2^( 7) =       0.000558693310

      target function =                  N/A
              le_mean =     -22.669147130668
             les_mean =     514.398337039072
             stat err =       0.000552953433
             autocorr =       1.232762820938
              std dev =       0.704309899066
             le_variance =       0.496052433922


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669147130668        initial  <--
     2.3842e+72     2.3842e+73             0.0000e+00       -22.669147130668
     9.5367e+72     9.5367e+73             0.0000e+00       -22.669147130668
     3.8147e+73     3.8147e+74             0.0000e+00       -22.669147130668

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9837
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -7.062022e-01 3 1  ON 0
ci_002                -7.047886e-01 3 1  ON 1
ci_003                -3.996794e-02 3 1  ON 2
ci_004                -3.767679e-02 3 1  ON 3
ci_005                 1.613776e-02 3 1  ON 4
ci_006                 1.499193e-02 3 1  ON 5
ci_007                 1.240682e-02 3 1  ON 6
ci_008                 1.175750e-02 3 1  ON 7
ci_009                -1.096300e-02 3 1  ON 8
ci_010                -1.303025e-02 3 1  ON 9
ci_011                -8.270682e-03 3 1  ON 10
ci_012                -8.839503e-03 3 1  ON 11
ci_013                 9.897139e-03 3 1  ON 12
ci_014                 8.430530e-03 3 1  ON 13
ci_015                 1.241977e-02 3 1  ON 14
ci_016                 1.269265e-02 3 1  ON 15
ci_017                 1.061583e-02 3 1  ON 16
ci_018                 1.086356e-02 3 1  ON 17
ci_019                -3.108303e-03 3 1  ON 18
ci_020                -2.479064e-03 3 1  ON 19
ci_021                -7.526799e-03 3 1  ON 20
ci_022                -9.057722e-03 3 1  ON 21
ci_023                 8.520911e-03 3 1  ON 22
ci_024                 7.558118e-03 3 1  ON 23
ci_025                 5.748056e-03 3 1  ON 24
ci_026                 4.578844e-03 3 1  ON 25
ci_027                 7.201618e-03 3 1  ON 26
ci_028                 7.303313e-03 3 1  ON 27
ci_029                -4.383746e-03 3 1  ON 28
ci_030                -5.640860e-03 3 1  ON 29
ci_031                -8.182956e-03 3 1  ON 30
ci_032                -7.410467e-03 3 1  ON 31
ci_033                 4.089766e-03 3 1  ON 32
ci_034                 4.356570e-03 3 1  ON 33
ci_035                 1.959979e-03 3 1  ON 34
ci_036                 2.248297e-03 3 1  ON 35
ci_037                 4.261145e-03 3 1  ON 36
ci_038                 4.872387e-03 3 1  ON 37
ci_039                 4.990237e-03 3 1  ON 38
ci_040                 5.195083e-03 3 1  ON 39
ci_041                 5.078095e-03 3 1  ON 40
ci_042                 6.058364e-03 3 1  ON 41
ci_043                 5.022664e-03 3 1  ON 42
ci_044                 5.244659e-03 3 1  ON 43
ci_045                 4.037715e-03 3 1  ON 44
ci_046                 3.073323e-03 3 1  ON 45
ci_047                -2.551824e-04 3 1  ON 46
ci_048                -7.531064e-04 3 1  ON 47
ci_049                 1.645211e-03 3 1  ON 48
ci_050                 1.625924e-03 3 1  ON 49
ci_051                -7.925837e-04 3 1  ON 50
ci_052                -1.096103e-03 3 1  ON 51
ci_053                -2.586071e-03 3 1  ON 52
ci_054                -3.194040e-03 3 1  ON 53
ci_055                -1.753115e-03 3 1  ON 54
ci_056                -2.292982e-03 3 1  ON 55
ci_057                -1.177493e-03 3 1  ON 56
ci_058                -2.166396e-03 3 1  ON 57
ci_059                -1.527613e-04 3 1  ON 58
ci_060                 7.735309e-05 3 1  ON 59
ci_061                 5.523807e-04 3 1  ON 60
ci_062                 4.665820e-04 3 1  ON 61
ci_063                -6.261080e-04 3 1  ON 62
ci_064                -2.538531e-03 3 1  ON 63
ci_065                -2.627438e-03 3 1  ON 64
ci_066                -2.610497e-03 3 1  ON 65
ci_067                -1.131322e-03 3 1  ON 66
ci_068                -3.308897e-03 3 1  ON 67
ci_069                 1.184530e-03 3 1  ON 68
ci_070                -1.682990e-05 3 1  ON 69
ci_071                -1.954618e-03 3 1  ON 70
ci_072                -6.509128e-04 3 1  ON 71
ci_073                 3.685249e-04 3 1  ON 72
ci_074                -3.140022e-04 3 1  ON 73
ci_075                -7.695044e-04 3 1  ON 74
ci_076                -5.482312e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5445e+01 secs
  Total Execution time = 7.5481e+03 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
